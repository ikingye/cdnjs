import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import*as React from"react";import PropTypes from"prop-types";import{Transition}from"react-transition-group";import{elementAcceptingRef}from"@material-ui/utils";import debounce from"../utils/debounce";import useForkRef from"../utils/useForkRef";import useTheme from"../styles/useTheme";import{duration}from"../styles/transitions";import{reflow,getTransitionProps}from"../transitions/utils";import{ownerWindow}from"../utils";function getTranslateValue(e,t){const n=t.getBoundingClientRect(),r=ownerWindow(t);let o;if(t.fakeTransform)o=t.fakeTransform;else{const e=r.getComputedStyle(t);o=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("transform")}let i=0,s=0;if(o&&"none"!==o&&"string"==typeof o){const e=o.split("(")[1].split(")")[0].split(",");i=parseInt(e[4],10),s=parseInt(e[5],10)}return"left"===e?`translateX(${r.innerWidth}px) translateX(${i-n.left}px)`:"right"===e?`translateX(-${n.left+n.width-i}px)`:"up"===e?`translateY(${r.innerHeight}px) translateY(${s-n.top}px)`:`translateY(-${n.top+n.height-s}px)`}export function setTranslateValue(e,t){const n=getTranslateValue(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)};const defaultTimeout={enter:duration.enteringScreen,exit:duration.leavingScreen},Slide=React.forwardRef(function(e,t){const{children:n,direction:r="down",in:o,onEnter:i,onEntered:s,onEntering:a,onExit:p,onExited:l,onExiting:u,style:c,timeout:f=defaultTimeout,TransitionComponent:m=Transition}=e,d=_objectWithoutPropertiesLoose(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),T=useTheme(),y=React.useRef(null),g=useForkRef(n.ref,y),x=useForkRef(g,t),E=e=>t=>{e&&(void 0===t?e(y.current):e(y.current,t))},b=E((e,t)=>{setTranslateValue(r,e),reflow(e),i&&i(e,t)}),P=E((e,t)=>{const n=getTransitionProps({timeout:f,style:c},{mode:"enter"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.transition=T.transitions.create("transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",a&&a(e,t)}),h=E(s),w=E(u),R=E(e=>{const t=getTransitionProps({timeout:f,style:c},{mode:"exit"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},t,{easing:T.transitions.easing.sharp})),e.style.transition=T.transitions.create("transform",_extends({},t,{easing:T.transitions.easing.sharp})),setTranslateValue(r,e),p&&p(e)}),k=E(e=>{e.style.webkitTransition="",e.style.transition="",l&&l(e)}),_=React.useCallback(()=>{y.current&&setTranslateValue(r,y.current)},[r]);return React.useEffect(()=>{if(o||"down"===r||"right"===r)return;const e=debounce(()=>{y.current&&setTranslateValue(r,y.current)}),t=ownerWindow(y.current);return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[r,o]),React.useEffect(()=>{o||_()},[o,_]),React.createElement(m,_extends({nodeRef:y,onEnter:b,onEntered:h,onEntering:P,onExit:R,onExited:k,onExiting:w,appear:!0,in:o,timeout:f},d),(e,t)=>React.cloneElement(n,_extends({ref:x,style:_extends({visibility:"exited"!==e||o?void 0:"hidden"},c,n.props.style)},t)))});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:elementAcceptingRef,direction:PropTypes.oneOf(["down","left","right","up"]),in:PropTypes.bool,onEnter:PropTypes.func,onEntered:PropTypes.func,onEntering:PropTypes.func,onExit:PropTypes.func,onExited:PropTypes.func,onExiting:PropTypes.func,style:PropTypes.object,timeout:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})])});export default Slide;