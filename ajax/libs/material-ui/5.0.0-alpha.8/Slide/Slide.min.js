"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.setTranslateValue=setTranslateValue,exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactTransitionGroup=require("react-transition-group"),_utils=require("@material-ui/utils"),_debounce=_interopRequireDefault(require("../utils/debounce")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useTheme=_interopRequireDefault(require("../styles/useTheme")),_transitions=require("../styles/transitions"),_utils2=require("../transitions/utils"),_utils3=require("../utils");function getTranslateValue(e,t){var n,r,i,o=t.getBoundingClientRect(),a=(0,_utils3.ownerWindow)(t),s=0,u=0;return(r=t.fakeTransform?t.fakeTransform:(n=a.getComputedStyle(t)).getPropertyValue("-webkit-transform")||n.getPropertyValue("transform"))&&"none"!==r&&"string"==typeof r&&(i=r.split("(")[1].split(")")[0].split(","),s=parseInt(i[4],10),u=parseInt(i[5],10)),"left"===e?"translateX(".concat(a.innerWidth,"px) translateX(").concat(s-o.left,"px)"):"right"===e?"translateX(-".concat(o.left+o.width-s,"px)"):"up"===e?"translateY(".concat(a.innerHeight,"px) translateY(").concat(u-o.top,"px)"):"translateY(-".concat(o.top+o.height-u,"px)")}function setTranslateValue(e,t){var n=getTranslateValue(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)}var defaultTimeout={enter:_transitions.duration.enteringScreen,exit:_transitions.duration.leavingScreen},Slide=React.forwardRef(function(e,t){function n(t){return function(e){t&&(void 0===e?t(E.current):t(E.current,e))}}var r=e.children,i=e.direction,o=void 0===i?"down":i,a=e.in,s=e.onEnter,u=e.onEntered,l=e.onEntering,p=e.onExit,f=e.onExited,d=e.onExiting,c=e.style,_=e.timeout,T=void 0===_?defaultTimeout:_,y=e.TransitionComponent,m=void 0===y?_reactTransitionGroup.Transition:y,g=(0,_objectWithoutProperties2.default)(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),x=(0,_useTheme.default)(),E=React.useRef(null),b=(0,_useForkRef.default)(r.ref,E),R=(0,_useForkRef.default)(b,t),h=n(function(e,t){setTranslateValue(o,e),(0,_utils2.reflow)(e),s&&s(e,t)}),q=n(function(e,t){var n=(0,_utils2.getTransitionProps)({timeout:T,style:c},{mode:"enter"});e.style.webkitTransition=x.transitions.create("-webkit-transform",(0,_extends2.default)({},n,{easing:x.transitions.easing.easeOut})),e.style.transition=x.transitions.create("transform",(0,_extends2.default)({},n,{easing:x.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",l&&l(e,t)}),v=n(u),w=n(d),k=n(function(e){var t=(0,_utils2.getTransitionProps)({timeout:T,style:c},{mode:"exit"});e.style.webkitTransition=x.transitions.create("-webkit-transform",(0,_extends2.default)({},t,{easing:x.transitions.easing.sharp})),e.style.transition=x.transitions.create("transform",(0,_extends2.default)({},t,{easing:x.transitions.easing.sharp})),setTranslateValue(o,e),p&&p(e)}),V=n(function(e){e.style.webkitTransition="",e.style.transition="",f&&f(e)}),D=React.useCallback(function(){E.current&&setTranslateValue(o,E.current)},[o]);return React.useEffect(function(){if(!a&&"down"!==o&&"right"!==o){var e=(0,_debounce.default)(function(){E.current&&setTranslateValue(o,E.current)}),t=(0,_utils3.ownerWindow)(E.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}}},[o,a]),React.useEffect(function(){a||D()},[a,D]),React.createElement(m,(0,_extends2.default)({nodeRef:E,onEnter:h,onEntered:v,onEntering:q,onExit:k,onExited:V,onExiting:w,appear:!0,in:a,timeout:T},g),function(e,t){return React.cloneElement(r,(0,_extends2.default)({ref:R,style:(0,_extends2.default)({visibility:"exited"!==e||a?void 0:"hidden"},c,r.props.style)},t))})});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:_utils.elementAcceptingRef,direction:_propTypes.default.oneOf(["down","left","right","up"]),in:_propTypes.default.bool,onEnter:_propTypes.default.func,onEntered:_propTypes.default.func,onEntering:_propTypes.default.func,onExit:_propTypes.default.func,onExited:_propTypes.default.func,onExiting:_propTypes.default.func,style:_propTypes.default.object,timeout:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.shape({appear:_propTypes.default.number,enter:_propTypes.default.number,exit:_propTypes.default.number})])});var _default=Slide;exports.default=Slide;