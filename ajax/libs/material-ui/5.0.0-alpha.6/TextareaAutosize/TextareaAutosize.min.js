"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_debounce=_interopRequireDefault(require("../utils/debounce")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_utils=require("../utils");function getStyleValue(e,t){return parseInt(e[t],10)||0}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=React.forwardRef(function(d,e){var t=d.onChange,f=d.maxRows,r=d.minRows,c=void 0===r?1:r,a=d.style,u=d.value,o=(0,_objectWithoutProperties2.default)(d,["onChange","maxRows","minRows","style","value"]),n=React.useRef(null!=u).current,y=React.useRef(null),l=(0,_useForkRef.default)(e,y),h=React.useRef(null),_=React.useRef(0),i=React.useState({}),s=i[0],R=i[1],p=React.useCallback(function(){var e=y.current,t=(0,_utils.ownerWindow)(e).getComputedStyle(e),r=h.current;r.style.width=t.width,r.value=e.value||d.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var a=t["box-sizing"],u=getStyleValue(t,"padding-bottom")+getStyleValue(t,"padding-top"),o=getStyleValue(t,"border-bottom-width")+getStyleValue(t,"border-top-width"),n=r.scrollHeight-u;r.value="x";var l=r.scrollHeight-u,i=n;c&&(i=Math.max(Number(c)*l,i)),f&&(i=Math.min(Number(f)*l,i));var s=(i=Math.max(i,l))+("border-box"===a?u+o:0),p=Math.abs(i-n)<=1;R(function(e){return _.current<20&&(0<s&&1<Math.abs((e.outerHeightStyle||0)-s)||e.overflow!==p)?(_.current+=1,{overflow:p,outerHeightStyle:s}):("production"!==process.env.NODE_ENV&&20===_.current&&console.error(["Material-UI: Too many re-renders. The layout is unstable.","TextareaAutosize limits the number of renders to prevent an infinite loop."].join("\n")),e)})},[f,c,d.placeholder]);React.useEffect(function(){var e=(0,_debounce.default)(function(){_.current=0,p()}),t=(0,_utils.ownerWindow)(y.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}},[p]),useEnhancedEffect(function(){p()}),React.useEffect(function(){_.current=0},[u]);return React.createElement(React.Fragment,null,React.createElement("textarea",(0,_extends2.default)({value:u,onChange:function(e){_.current=0,n||p(),t&&t(e)},ref:l,rows:c,style:(0,_extends2.default)({height:s.outerHeightStyle,overflow:s.overflow?"hidden":null},a)},o)),React.createElement("textarea",{"aria-hidden":!0,className:d.className,readOnly:!0,ref:h,tabIndex:-1,style:(0,_extends2.default)({},styles.shadow,a)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:_propTypes.default.string,maxRows:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),minRows:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),onChange:_propTypes.default.func,placeholder:_propTypes.default.string,style:_propTypes.default.object,value:_propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.string),_propTypes.default.number,_propTypes.default.string])});var _default=TextareaAutosize;exports.default=TextareaAutosize;