"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),_utils=require("@material-ui/utils"),React=_interopRequireWildcard(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_capitalize=_interopRequireDefault(require("../utils/capitalize")),_Menu=_interopRequireDefault(require("../Menu/Menu")),_utils2=require("../InputBase/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useControlled3=_interopRequireDefault(require("../utils/useControlled"));function areEqualValues(e,t){return"object"===(0,_typeof2.default)(t)&&null!==t?e===t:String(e)===String(t)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}var SelectInput=React.forwardRef(function(e,t){var r=e["aria-label"],a=e.autoFocus,n=e.autoWidth,l=e.children,o=e.classes,u=e.className,i=e.defaultValue,p=e.disabled,s=e.displayEmpty,c=e.IconComponent,d=e.inputRef,f=e.labelId,y=e.MenuProps,_=void 0===y?{}:y,v=e.multiple,m=e.name,b=e.onBlur,R=e.onChange,h=e.onClose,T=e.onFocus,q=e.onOpen,E=e.open,D=e.readOnly,g=e.renderValue,x=e.SelectDisplayProps,I=void 0===x?{}:x,P=e.tabIndex,C=(e.type,e.value),O=e.variant,M=void 0===O?"standard":O,S=(0,_objectWithoutProperties2.default)(e,["aria-label","autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"]),j=(0,_useControlled3.default)({controlled:C,default:i,name:"Select"}),w=(0,_slicedToArray2.default)(j,2),F=w[0],N=w[1],V=React.useRef(null),W=React.useState(null),A=W[0],k=W[1],B=React.useRef(null!=E).current,U=React.useState(),L=U[0],K=U[1],z=React.useState(!1),H=z[0],Y=z[1],G=(0,_useForkRef.default)(t,d);React.useImperativeHandle(G,function(){return{focus:function(){A.focus()},node:V.current,value:F}},[A,F]),React.useEffect(function(){a&&A&&A.focus()},[a,A]),React.useEffect(function(){if(A){var e=(0,_ownerDocument.default)(A).getElementById(f);if(e){var t=function(){getSelection().isCollapsed&&A.focus()};return e.addEventListener("click",t),function(){e.removeEventListener("click",t)}}}},[f,A]);function J(e,t){e?q&&q(t):h&&h(t),B||(K(n?null:A.clientWidth),Y(e))}var Q,X,Z=React.Children.toArray(l),$=null!==A&&(B?E:H);delete S["aria-invalid"];var ee=[],te=!1,re=!1;((0,_utils2.isFilled)({value:F})||s)&&(g?Q=g(F):te=!0);var ae=Z.map(function(t){if(!React.isValidElement(t))return null;var e,a;if("production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(t)&&console.error(["Material-UI: The Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),v){if(!Array.isArray(F))throw new Error("production"!==process.env.NODE_ENV?"Material-UI: The `value` prop must be an array when using the `Select` component with `multiple`.":(0,_utils.formatMuiErrorMessage)(2));(e=F.some(function(e){return areEqualValues(e,t.props.value)}))&&te&&ee.push(t.props.children)}else(e=areEqualValues(F,t.props.value))&&te&&(X=t.props.children);return e&&(re=!0),React.cloneElement(t,{"aria-selected":e?"true":void 0,onClick:function(e){var t,r;v?(t=Array.isArray(F)?F.slice():[],-1===(r=F.indexOf(a.props.value))?t.push(a.props.value):t.splice(r,1)):t=a.props.value,a.props.onClick&&a.props.onClick(e),F!==t&&(N(t),R&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:t,name:m}}),R(e,a))),v||J(!1,e)},onKeyUp:function(e){" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:e,value:void 0,"data-value":(a=t).props.value})});"production"!==process.env.NODE_ENV&&React.useEffect(function(){var e;re||v||""===F||(e=Z.map(function(e){return e.props.value}),console.warn(["Material-UI: You have provided an out-of-range value `".concat(F,"` for the select ").concat(m?'(name="'.concat(m,'") '):"","component."),"Consider providing a value that matches one of the available options or ''.","The available values are ".concat(e.filter(function(e){return null!=e}).map(function(e){return"`".concat(e,"`")}).join(", ")||'""',".")].join("\n")))},[re,Z,v,m,F]),te&&(Q=v?ee.join(", "):X);var ne,le=L;!n&&B&&A&&(le=A.clientWidth),ne=void 0!==P?P:p?null:0;var oe=I.id||(m?"mui-component-select-".concat(m):void 0);return React.createElement(React.Fragment,null,React.createElement("div",(0,_extends2.default)({className:(0,_clsx.default)(o.root,o.select,o.selectMenu,o[M],u,p&&o.disabled),ref:k,tabIndex:ne,role:"button","aria-disabled":p?"true":void 0,"aria-expanded":$?"true":void 0,"aria-haspopup":"listbox","aria-label":r,"aria-labelledby":[f,oe].filter(Boolean).join(" ")||void 0,onKeyDown:function(e){D||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),J(!0,e))},onMouseDown:p||D?null:function(e){0===e.button&&(e.preventDefault(),A.focus(),J(!0,e))},onBlur:function(e){!$&&b&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:F,name:m}}),b(e))},onFocus:T},I,{id:oe}),isEmpty(Q)?React.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):Q),React.createElement("input",(0,_extends2.default)({value:Array.isArray(F)?F.join(","):F,name:m,ref:V,"aria-hidden":!0,onChange:function(e){var t,r=Z.map(function(e){return e.props.value}).indexOf(e.target.value);-1!==r&&(t=Z[r],N(t.props.value),R&&R(e,t))},tabIndex:-1,className:o.nativeInput,autoFocus:a},S)),React.createElement(c,{className:(0,_clsx.default)(o.icon,o["icon".concat((0,_capitalize.default)(M))],$&&o.iconOpen,p&&o.disabled)}),React.createElement(_Menu.default,(0,_extends2.default)({id:"menu-".concat(m||""),anchorEl:A,open:$,onClose:function(e){J(!1,e)}},_,{MenuListProps:(0,_extends2.default)({"aria-labelledby":f,role:"listbox",disableListWrap:!0},_.MenuListProps),PaperProps:(0,_extends2.default)({},_.PaperProps,{style:(0,_extends2.default)({minWidth:le},null!=_.PaperProps?_.PaperProps.style:null)})}),ae))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={"aria-label":_propTypes.default.string,autoFocus:_propTypes.default.bool,autoWidth:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object.isRequired,className:_propTypes.default.string,defaultValue:_propTypes.default.any,disabled:_propTypes.default.bool,displayEmpty:_propTypes.default.bool,IconComponent:_propTypes.default.elementType.isRequired,inputRef:_utils.refType,labelId:_propTypes.default.string,MenuProps:_propTypes.default.object,multiple:_propTypes.default.bool,name:_propTypes.default.string,onBlur:_propTypes.default.func,onChange:_propTypes.default.func,onClose:_propTypes.default.func,onFocus:_propTypes.default.func,onOpen:_propTypes.default.func,open:_propTypes.default.bool,readOnly:_propTypes.default.bool,renderValue:_propTypes.default.func,SelectDisplayProps:_propTypes.default.object,tabIndex:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),type:_propTypes.default.any,value:_propTypes.default.any,variant:_propTypes.default.oneOf(["standard","outlined","filled"])});var _default=SelectInput;exports.default=SelectInput;