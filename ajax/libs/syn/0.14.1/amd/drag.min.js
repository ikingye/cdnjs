define(["require","exports","module","./synthetic"],function(e,t,n){function m(e,t){var n,r=e.clientX,o=e.clientY;return null==e?null:(f.support.elementFromPage&&(r+=(n=f.helpers.scrollOffset(t)).left,o+=n.top),t.document.elementFromPoint(Math.round(r),Math.round(o)))}var f=e("./synthetic"),E={html5drag:!1,focusWindow:null,dragAndDrop:function(e,t,n,r,o){this.currentDataTransferItem=null,this.focusWindow=e,this._mouseOver(t),this._mouseEnter(t),this._mouseMove(t),this._mouseDown(t),this._dragStart(t),this._drag(t),this._dragEnter(t),this._dragOver(t),E.startMove(t,n,r,function(){E._dragLeave(t),E._dragEnd(t),E._mouseOut(t),E._mouseLeave(t),E._drop(n),E._dragEnd(n),E._mouseOver(n),E._mouseEnter(n),E._mouseMove(n),E._mouseOut(n),E._mouseLeave(n),o(),E.cleanup()})},_dragStart:function(e,t){this.createAndDispatchEvent(e,"dragstart",t)},_drag:function(e,t){this.createAndDispatchEvent(e,"drag",t)},_dragEnter:function(e,t){this.createAndDispatchEvent(e,"dragenter",t)},_dragOver:function(e,t){this.createAndDispatchEvent(e,"dragover",t)},_dragLeave:function(e,t){this.createAndDispatchEvent(e,"dragleave",t)},_drop:function(e,t){this.createAndDispatchEvent(e,"drop",t)},_dragEnd:function(e,t){this.createAndDispatchEvent(e,"dragend",t)},_mouseDown:function(e,t){this.createAndDispatchEvent(e,"mousedown",t)},_mouseMove:function(e,t){this.createAndDispatchEvent(e,"mousemove",t)},_mouseEnter:function(e,t){this.createAndDispatchEvent(e,"mouseenter",t)},_mouseOver:function(e,t){this.createAndDispatchEvent(e,"mouseover",t)},_mouseOut:function(e,t){this.createAndDispatchEvent(e,"mouseout",t)},_mouseLeave:function(e,t){this.createAndDispatchEvent(e,"mouseleave",t)},createAndDispatchEvent:function(e,t,n){var r;e&&(r=m(e,this.focusWindow),f.trigger(r,t,n))},getDataTransferObject:function(){return this.currentDataTransferItem?this.currentDataTransferItem:this.currentDataTransferItem=this.createDataTransferObject()},cleanup:function(){this.currentDataTransferItem=null,this.focusWindow=null},createDataTransferObject:function(){return{dropEffect:"none",effectAllowed:"uninitialized",files:[],items:[],types:[],data:[],setData:function(e,t){var n={};n.dataFlavor=e,n.val=t,this.data.push(n)},getData:function(e){for(var t=0;t<this.data.length;t++){var n=this.data[t];if(n.dataFlavor===e)return n.val}}}},startMove:function(o,a,i,s){function u(){var e=new Date,t=f.helpers.scrollOffset(l),n=(0===g?0:e-c)/i,r={clientX:d*n+o.clientX,clientY:p*n+o.clientY};g++,n<1?(f.helpers.extend(v.style,{left:r.clientX+t.left+2+"px",top:r.clientY+t.top+2+"px"}),h=E.mouseMove(r,h),f.schedule(u,15)):(h=E.mouseMove(a,h),l.document.body.removeChild(v),s())}var c=new Date,d=a.clientX-o.clientX,p=a.clientY-o.clientY,l=this.focusWindow,h=o,v=l.document.createElement("div"),g=0;f.helpers.extend(v.style,{height:"5px",width:"5px",backgroundColor:"red",position:"absolute",zIndex:19999,fontSize:"1px"}),l.document.body.appendChild(v),u()},mouseMove:function(e,t){var n=m(e,this.focusWindow),r=m(t,this.focusWindow),o=f.helpers.extend({},e);return n!==r&&(o.relatedTarget=n,this._dragLeave(t,o),o.relatedTarget=r,this._dragEnter(e,o)),this._dragOver(e,o),e}};function r(e,t,n){var r=f.create.mouse.event(e,t,n);return r.dataTransfer=E.getDataTransferObject(),f.dispatch(r,n,e,!1)}f.create.dragstart={event:r},f.create.dragenter={event:r},f.create.dragover={event:r},f.create.dragleave={event:r},f.create.drag={event:r},f.create.drop={event:r},f.create.dragend={event:r},function e(){var t;document.body?(t=document.createElement("div"),document.body.appendChild(t),f.helpers.extend(t.style,{width:"100px",height:"10000px",backgroundColor:"blue",position:"absolute",top:"10px",left:"0px",zIndex:19999}),document.body.scrollTop=11,document.elementFromPoint&&(document.elementFromPoint(3,1)===t?f.support.elementFromClient=!0:f.support.elementFromPage=!0,document.body.removeChild(t),document.body.scrollTop=0)):f.schedule(e,1)}();function _(e,t,n){var r,o=m(e,t);return n!==o&&o&&n&&((r=f.helpers.extend({},e)).relatedTarget=o,f.support.pointerEvents&&(f.trigger(n,"pointerout",r),f.trigger(n,"pointerleave",r)),f.trigger(n,"mouseout",r),f.trigger(n,"mouseleave",r),r.relatedTarget=n,f.support.pointerEvents&&(f.trigger(o,"pointerover",r),f.trigger(o,"pointerenter",r)),f.trigger(o,"mouseover",r),f.trigger(o,"mouseenter",r)),f.support.pointerEvents&&f.trigger(o||t,"pointermove",e),f.support.touchEvents&&f.trigger(o||t,"touchmove",e),E.html5drag&&f.support.pointerEvents||f.trigger(o||t,"mousemove",e),o}function p(e,t,n){var r=m(t,n);return f.trigger(r||n,e,t),r}function l(o,a,i,s,u){function c(){var e=new Date,t=f.helpers.scrollOffset(o),n=(0===g?0:e-d)/s,r={clientX:p*n+a.clientX,clientY:l*n+a.clientY};g++,n<1?(f.helpers.extend(v.style,{left:r.clientX+t.left+2+"px",top:r.clientY+t.top+2+"px"}),h=_(r,o,h),f.schedule(c,15)):(h=_(i,o,h),o.document.body.removeChild(v),u())}var d=new Date,p=i.clientX-a.clientX,l=i.clientY-a.clientY,h=m(a,o),v=o.document.createElement("div"),g=0;f.helpers.extend(v.style,{height:"5px",width:"5px",backgroundColor:"red",position:"absolute",zIndex:19999,fontSize:"1px"}),o.document.body.appendChild(v),c()}function c(e){var t=f.jquery()(e),n=t.offset();return{pageX:n.left+t.outerWidth()/2,pageY:n.top+t.outerHeight()/2}}function h(e,t,n){var r,o,a,i=/(\d+)[x ](\d+)/,s=/(\d+)X(\d+)/,u=/([+-]\d+)[xX ]([+-]\d+)/;return"string"==typeof e&&u.test(e)&&n&&(r=c(n),o=e.match(u),e={pageX:r.pageX+parseInt(o[1]),pageY:r.pageY+parseInt(o[2])}),"string"==typeof e&&i.test(e)&&(o=e.match(i),e={pageX:parseInt(o[1]),pageY:parseInt(o[2])}),"string"==typeof e&&s.test(e)&&(o=e.match(s),e={clientX:parseInt(o[1]),clientY:parseInt(o[2])}),"string"==typeof e&&(e=f.jquery()(e,t.document)[0]),e.nodeName&&(e=c(e)),null!=e.pageX&&(a=f.helpers.scrollOffset(t),e={clientX:e.pageX-a.left,clientY:e.pageY-a.top}),e}function v(e,t,n){var r,o,a;e.clientY<0&&(a=(o=(r=f.helpers.scrollOffset(n)).top+e.clientY-100)-r.top,0<o||(o=0,a=-r.top),e.clientY=e.clientY-a,t.clientY=t.clientY-a,f.helpers.scrollOffset(n,{top:o,left:r.left}))}f.helpers.extend(f.init.prototype,{_move:function(e,t,n){var r=f.helpers.getWindow(e),o=h(t.from||e,r,e),a=h(t.to||t,r,e);E.html5drag=f.support.pointerEvents,!1!==t.adjust&&v(o,a,r),l(r,o,a,t.duration||500,n)},_drag:function(e,t,n){var r,o,a,i,s,u=f.helpers.getWindow(e),c=h(t.from||e,u,e),d=h(t.to||t,u,e);!1!==t.adjust&&v(c,d,u),E.html5drag=e.draggable,E.html5drag?E.dragAndDrop(u,c,d,t.duration||500,n):(r=u,o=c,a=d,i=t.duration||500,s=n,f.support.pointerEvents&&(p("pointerover",o,r),p("pointerenter",o,r)),p("mouseover",o,r),p("mouseenter",o,r),f.support.pointerEvents&&p("pointermove",o,r),p("mousemove",o,r),f.support.pointerEvents&&p("pointerdown",o,r),f.support.touchEvents&&p("touchstart",o,r),p("mousedown",o,r),l(r,o,a,i,function(){f.support.pointerEvents&&p("pointerup",a,r),f.support.touchEvents&&p("touchend",a,r),p("mouseup",a,r),f.support.pointerEvents&&p("pointerleave",a,r),p("mouseleave",a,r),s()}))}})});