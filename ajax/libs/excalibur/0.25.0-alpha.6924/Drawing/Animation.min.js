var __extends=this&&this.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function r(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();import*as Effects from"./SpriteEffects";import{Vector}from"../Algebra";import{Engine}from"../Engine";import*as Util from"../Util/Util";import{Configurable}from"../Configurable";var AnimationImpl=function(){function t(t,i,e,r){this.sprites=[],this.currentFrame=0,this._oldTime=Date.now(),this.anchor=Vector.Zero,this.rotation=0,this.scale=Vector.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0;var s=t;if(t&&!(t instanceof Engine)){var o=t;s=o.engine,i=o.sprites,e=o.speed,r=o.loop}this.sprites=i,this.speed=e,this._engine=s,null!=r&&(this.loop=r),i&&i[0]&&(this.drawHeight=i[0]?i[0].drawHeight:0,this.drawWidth=i[0]?i[0].drawWidth:0,this.width=i[0]?i[0].width:0,this.height=i[0]?i[0].height:0,this.freezeFrame=i.length-1)}return t.prototype.opacity=function(t){this.addEffect(new Effects.Opacity(t))},t.prototype.grayscale=function(){this.addEffect(new Effects.Grayscale)},t.prototype.invert=function(){this.addEffect(new Effects.Invert)},t.prototype.fill=function(t){this.addEffect(new Effects.Fill(t))},t.prototype.colorize=function(t){this.addEffect(new Effects.Colorize(t))},t.prototype.lighten=function(t){void 0===t&&(t=.1),this.addEffect(new Effects.Lighten(t))},t.prototype.darken=function(t){void 0===t&&(t=.1),this.addEffect(new Effects.Darken(t))},t.prototype.saturate=function(t){void 0===t&&(t=.1),this.addEffect(new Effects.Saturate(t))},t.prototype.desaturate=function(t){void 0===t&&(t=.1),this.addEffect(new Effects.Desaturate(t))},t.prototype.addEffect=function(t){for(var i in this.sprites)this.sprites[i].addEffect(t)},t.prototype.removeEffect=function(t){for(var i in this.sprites)this.sprites[i].removeEffect(t)},t.prototype.clearEffects=function(){for(var t in this.sprites)this.sprites[t].clearEffects()},t.prototype._setAnchor=function(t){for(var i in this.sprites)this.sprites[i].anchor.setTo(t.x,t.y)},t.prototype._setRotation=function(t){for(var i in this.sprites)this.sprites[i].rotation=t},t.prototype._setScale=function(t){for(var i in this.sprites)this.sprites[i].scale=t},t.prototype.reset=function(){this.currentFrame=0},t.prototype.isDone=function(){return!this.loop&&this.currentFrame>=this.sprites.length},t.prototype.tick=function(){var t=Date.now();t-this._oldTime>this.speed&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._oldTime=t)},t.prototype._updateValues=function(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)},t.prototype.skip=function(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length},t.prototype.draw=function(t,i,e){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:i,y:e,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}):this._drawWithOptions(t)},t.prototype._drawWithOptions=function(t){var i;this.tick(),this._updateValues(),this.currentFrame<this.sprites.length&&(i=this.sprites[this.currentFrame]).draw(t),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(i=this.sprites[Util.clamp(this.freezeFrame,0,this.sprites.length-1)]).draw(t),i&&(this.drawWidth=i.drawWidth,this.drawHeight=i.drawHeight)},t.prototype.play=function(t,i){this.reset(),this._engine.playAnimation(this,t,i)},t}();export{AnimationImpl};var Animation=function(t){function i(i,e,r,s){return t.call(this,i,e,r,s)||this}return __extends(i,t),i}(Configurable(AnimationImpl));export{Animation};