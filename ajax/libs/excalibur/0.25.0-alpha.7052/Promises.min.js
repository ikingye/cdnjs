export var PromiseState;!function(t){t[t.Resolved=0]="Resolved",t[t.Rejected=1]="Rejected",t[t.Pending=2]="Pending"}(PromiseState||(PromiseState={}));var Promise=function(){function t(){this._state=PromiseState.Pending,this._successCallbacks=[],this._rejectCallback=function(){}}return t.resolve=function(e){return(new t).resolve(e)},t.reject=function(e){return(new t).reject(e)},t.join=function(){var e=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(var r=0;r<arguments.length;r++)e[r-0]=arguments[r];else 1===arguments.length&&Array.isArray(arguments[0])&&(e=arguments[0]);var n=new t;if(!e||!e.length)return n.resolve();var s=e.length,i=0,a=0,o=[];return e.forEach(function(t){t.then(function(){(i+=1)===s?n.resolve():i+a+o.length===s&&n.reject(o)},function(){i+(a+=1)+o.length===s&&n.reject(o)}).error(function(t){o.push(t),o.length+i+a===s&&n.reject(o)})}),n},t.prototype.then=function(t,e){if(t&&(this._successCallbacks.push(t),this.state()===PromiseState.Resolved))try{t.call(this,this._value)}catch(t){this._handleError(t)}if(e&&(this._rejectCallback=e,this.state()===PromiseState.Rejected))try{e.call(this,this._value)}catch(t){this._handleError(t)}return this},t.prototype.error=function(t){return t&&(this._errorCallback=t),this},t.prototype.resolve=function(t){var e=this;if(this._state!==PromiseState.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=t;try{this._state=PromiseState.Resolved,this._successCallbacks.forEach(function(t){t.call(e,e._value)})}catch(t){this._handleError(t)}return this},t.prototype.reject=function(t){if(this._state!==PromiseState.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=t;try{this._state=PromiseState.Rejected,this._rejectCallback.call(this,this._value)}catch(t){this._handleError(t)}return this},t.prototype.state=function(){return this._state},t.prototype._handleError=function(t){if(!this._errorCallback)throw t;this._errorCallback.call(this,t)},t}();export{Promise};