var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();import{Logger}from"../Util/Log";import{Class}from"../Class";import*as Events from"../Events";export var Keys;!function(e){e[e.Num1=97]="Num1",e[e.Num2=98]="Num2",e[e.Num3=99]="Num3",e[e.Num4=100]="Num4",e[e.Num5=101]="Num5",e[e.Num6=102]="Num6",e[e.Num7=103]="Num7",e[e.Num8=104]="Num8",e[e.Num9=105]="Num9",e[e.Num0=96]="Num0",e[e.Numlock=144]="Numlock",e[e.Semicolon=186]="Semicolon",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Shift=16]="Shift",e[e.Alt=18]="Alt",e[e.Up=38]="Up",e[e.Down=40]="Down",e[e.Left=37]="Left",e[e.Right=39]="Right",e[e.Space=32]="Space",e[e.Esc=27]="Esc"}(Keys||(Keys={}));var KeyEvent=function(e){function t(t){var n=e.call(this)||this;return n.key=t,n}return __extends(t,e),t}(Events.GameEvent);export{KeyEvent};var Keyboard=function(e){function t(){var t=e.call(this)||this;return t._keys=[],t._keysUp=[],t._keysDown=[],t}return __extends(t,e),t.prototype.on=function(t,n){e.prototype.on.call(this,t,n)},t.prototype.init=function(e){var t=this;if(!e)try{var n=function(){};window.top.addEventListener("blur",n),window.top.removeEventListener("blur",n),e=window.top}catch(t){e=window,Logger.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}e.addEventListener("blur",function(){t._keys.length=0}),e.addEventListener("keyup",function(e){var n=t._normalizeKeyCode(e.keyCode),o=t._keys.indexOf(n);t._keys.splice(o,1),t._keysUp.push(n);var r=new KeyEvent(n);t.eventDispatcher.emit("up",r),t.eventDispatcher.emit("release",r)}),e.addEventListener("keydown",function(e){var n=t._normalizeKeyCode(e.keyCode);if(-1===t._keys.indexOf(n)){t._keys.push(n),t._keysDown.push(n);var o=new KeyEvent(n);t.eventDispatcher.emit("down",o),t.eventDispatcher.emit("press",o)}})},t.prototype.update=function(){this._keysDown.length=0,this._keysUp.length=0;for(var e=0;e<this._keys.length;e++)this.eventDispatcher.emit("hold",new KeyEvent(this._keys[e]))},t.prototype.getKeys=function(){return this._keys},t.prototype.wasPressed=function(e){return this._keysDown.indexOf(e)>-1},t.prototype.isHeld=function(e){return this._keys.indexOf(e)>-1},t.prototype.wasReleased=function(e){return this._keysUp.indexOf(e)>-1},t.prototype._normalizeKeyCode=function(e){switch(e){case 59:return Keys.Semicolon;default:return e}},t}(Class);export{Keyboard};