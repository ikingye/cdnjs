import{GameEvent,SubscribeEvent,UnsubscribeEvent}from"./Events";var EventDispatcher=function(){function e(e){this._handlers={},this._wiredEventDispatchers=[],this._target=e}return e.prototype.clear=function(){this._handlers={},this._wiredEventDispatchers=[]},e.prototype.emit=function(e,t){if(e){e=e.toLowerCase();var s,i,r=this._target;if(t||(t=new GameEvent),t.target=r,this._handlers[e])for(s=0,i=this._handlers[e].length;s<i;s++)this._handlers[e][s].call(r,t);for(s=0,i=this._wiredEventDispatchers.length;s<i;s++)this._wiredEventDispatchers[s].emit(e,t)}},e.prototype.on=function(e,t){e=e.toLowerCase(),this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push(t),"unsubscribe"!==e&&"subscribe"!==e&&this.emit("subscribe",new SubscribeEvent(e,t))},e.prototype.off=function(e,t){e=e.toLowerCase();var s=this._handlers[e];if(s)if(t){var i=s.indexOf(t);this._handlers[e].splice(i,1)}else this._handlers[e].length=0;"unsubscribe"!==e&&"subscribe"!==e&&this.emit("unsubscribe",new UnsubscribeEvent(e,t))},e.prototype.once=function(e,t){var s=this;this.on(e,function(i){var r=i||new GameEvent;r.target=r.target||s._target,s.off(e,t),t.call(r.target,r)})},e.prototype.wire=function(e){e._wiredEventDispatchers.push(this)},e.prototype.unwire=function(e){var t=e._wiredEventDispatchers.indexOf(this);t>-1&&e._wiredEventDispatchers.splice(t,1)},e}();export{EventDispatcher};