"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Linker=void 0;const Utils_1=require("../../../../Utils");class Linker{constructor(i){this.container=i}isEnabled(i){return i.particlesOptions.links.enable}reset(){}interact(i){var t;const s=this.container,n=i.particlesOptions.links,e=n.opacity,o=null!==(t=i.linksDistance)&&void 0!==t?t:s.retina.linksDistance,l=s.canvas.size,r=n.warp,a=i.getPosition(),c=r?new Utils_1.CircleWarp(a.x,a.y,o,l):new Utils_1.Circle(a.x,a.y,o),p=s.particles.quadTree.query(c);for(const t of p){const c=t.particlesOptions.links;if(i===t||!c.enable||n.id!==c.id)continue;const p=t.getPosition();let d=Utils_1.Utils.getDistance(a,p);if(r&&d>o){const i={x:p.x-l.width,y:p.y};if((d=Utils_1.Utils.getDistance(a,i))>o){const i={x:p.x-l.width,y:p.y-l.height};if((d=Utils_1.Utils.getDistance(a,i))>o){const i={x:p.x,y:p.y-l.height};d=Utils_1.Utils.getDistance(a,i)}}}if(d>o)return;const U=e-d*e/o;if(U>0){const n=i.particlesOptions.links;let e=void 0!==n.id?s.particles.linksColors[n.id]:s.particles.linksColor;if(!e){const i=n.color,t="string"==typeof i?i:i.value;e=t===Utils_1.Constants.randomColorValue?n.consent?Utils_1.ColorUtils.colorToRgb({value:t}):n.blink?Utils_1.Constants.randomColorValue:Utils_1.Constants.midColorValue:Utils_1.ColorUtils.colorToRgb({value:t}),void 0!==n.id?s.particles.linksColors[n.id]=e:s.particles.linksColor=e}-1===t.links.map(i=>i.destination).indexOf(i)&&-1===i.links.map(i=>i.destination).indexOf(t)&&i.links.push({destination:t,opacity:U})}}}}exports.Linker=Linker;