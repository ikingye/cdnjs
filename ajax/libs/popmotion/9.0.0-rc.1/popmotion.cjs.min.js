"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var styleValueTypes=require("style-value-types"),heyListen=require("hey-listen"),sync=require("framesync"),sync__default=_interopDefault(sync),SpringAnimator=function(){function t(t){this.isComplete=!1,this.updateOptions(t);var r,e=this.options,n=e.velocity,o=e.from,i=e.to,a=e.damping,s=e.stiffness,u=e.mass,c=n?-n/1e3:0,p=i-o,f=a/(2*Math.sqrt(s*u)),l=Math.sqrt(s/u)/1e3;f<1?this.resolveSpring=function(t){var e=Math.exp(-f*l*t),r=l*Math.sqrt(1-f*f);return i-e*((c+f*l*p)/r*Math.sin(r*t)+p*Math.cos(r*t))}:1==f?this.resolveSpring=function(t){var e=Math.exp(-l*t);return i-e*(1+l*t)}:(r=l*Math.sqrt(f*f-1),this.resolveSpring=function(t){var e=Math.exp(-f*l*t);return i-e*((c+f*l*p)*Math.sinh(r*t)+r*p*Math.cosh(r*t))/r})}return t.prototype.update=function(t){var e=this.resolveSpring(t),r=this.options,n=r.velocity,o=r.restSpeed,i=r.restDelta,a=r.to,s=Math.abs(n)<=o,u=Math.abs(a-e)<=i;return this.isComplete=s&&u,this.isComplete?a:e},t.prototype.updateOptions=function(t){var e=t.from,r=void 0===e?0:e,n=t.to,o=void 0===n?0:n,i=t.velocity,a=void 0===i?0:i,s=t.stiffness,u=void 0===s?100:s,c=t.damping,p=void 0===c?10:c,f=t.mass,l=void 0===f?1:f,m=t.restSpeed,v=void 0===m?.005:m,y=t.restDelta,d=void 0===y?.5:y;this.options={from:r,to:o,velocity:a,stiffness:u,damping:p,mass:l,restSpeed:v,restDelta:d}},t.needsInterpolation=!0,t.uniqueOptionKeys=new Set(["stiffness","damping","mass","restSpeed","restDelta"]),t}(),progress=function(t,e,r){var n=e-t;return 0==n?1:(r-t)/n},mix=function(t,e,r){return-r*t+r*e+t},__assign=function(){return(__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},mixLinearColor=function(t,e,r){var n=t*t,o=e*e;return Math.sqrt(Math.max(0,r*(o-n)+n))},colorTypes=[styleValueTypes.hex,styleValueTypes.rgba,styleValueTypes.hsla],getColorType=function(e){return colorTypes.find(function(t){return t.test(e)})},notAnimatable=function(t){return"'"+t+"' is not an animatable color. Use the equivalent color code instead."},mixColor=function(t,e){var r=getColorType(t),n=getColorType(e);heyListen.invariant(!!r,notAnimatable(t)),heyListen.invariant(!!n,notAnimatable(e)),heyListen.invariant(r.transform===n.transform,"Both colors must be hex/RGBA, OR both must be HSLA.");var o=r.parse(t),i=n.parse(e),a=__assign({},o),s=r===styleValueTypes.hsla?mix:mixLinearColor;return function(t){for(var e in a)"alpha"!==e&&(a[e]=s(o[e],i[e],t));return a.alpha=mix(o.alpha,i.alpha,t),r.transform(a)}},zeroPoint={x:0,y:0,z:0},isNum=function(t){return"number"==typeof t},combineFunctions=function(e,r){return function(t){return r(e(t))}},pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce(combineFunctions)},__assign$1=function(){return(__assign$1=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__spreadArrays=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};function getMixer(e,r){return isNum(e)?function(t){return mix(e,r,t)}:(styleValueTypes.color.test(e)?mixColor:mixComplex)(e,r)}var mixArray=function(t,r){var n=__spreadArrays(t),o=n.length,i=t.map(function(t,e){return getMixer(t,r[e])});return function(t){for(var e=0;e<o;e++)n[e]=i[e](t);return n}},mixObject=function(t,e){var r=__assign$1(__assign$1({},t),e),n={};for(var o in r)void 0!==t[o]&&void 0!==e[o]&&(n[o]=getMixer(t[o],e[o]));return function(t){for(var e in n)r[e]=n[e](t);return r}};function analyse(t){for(var e=styleValueTypes.complex.parse(t),r=e.length,n=0,o=0,i=0,a=0;a<r;a++)n||"number"==typeof e[a]?n++:void 0!==e[a].hue?i++:o++;return{parsed:e,numNumbers:n,numRGB:o,numHSL:i}}var mixComplex=function(t,e){var r=styleValueTypes.complex.createTransformer(e),n=analyse(t),o=analyse(e);return heyListen.invariant(n.numHSL===o.numHSL&&n.numRGB===o.numRGB&&n.numNumbers>=o.numNumbers,"Complex values '"+t+"' and '"+e+"' too different to mix. Ensure all colors are of the same type."),pipe(mixArray(n.parsed,o.parsed),r)},clamp=function(t,e,r){return Math.min(Math.max(r,t),e)},mixNumber=function(e,r){return function(t){return mix(e,r,t)}};function detectMixerFactory(t){return"number"==typeof t?mixNumber:"string"==typeof t?styleValueTypes.color.test(t)?mixColor:mixComplex:Array.isArray(t)?mixArray:"object"==typeof t?mixObject:void 0}function createMixers(t,e,r){for(var n=[],o=r||detectMixerFactory(t[0]),i=t.length-1,a=0;a<i;a++){var s,u=o(t[a],t[a+1]);e&&(s=Array.isArray(e)?e[a]:e,u=pipe(s,u)),n.push(u)}return n}function fastInterpolate(t,e){var r=t[0],n=t[1],o=e[0];return function(t){return o(progress(r,n,t))}}function slowInterpolate(i,a){var s=i.length,u=s-1;return function(t){var e=0,r=!1;if(t<=i[0]?r=!0:t>=i[u]&&(e=u-1,r=!0),!r){for(var n=1;n<s&&!(i[n]>t||n===u);n++);e=n-1}var o=progress(i[e],i[e+1],t);return a[e](o)}}function interpolate(e,t,r){var n=void 0===r?{}:r,o=n.clamp,i=void 0===o||o,a=n.ease,s=n.mixer,u=e.length;heyListen.invariant(u===t.length,"Both input and output ranges must be the same length"),heyListen.invariant(!a||!Array.isArray(a)||a.length===u-1,"Array of easing functions must be of length `input.length - 1`, as it applies to the transitions **between** the defined values."),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var c=createMixers(t,a,s),p=(2===u?fastInterpolate:slowInterpolate)(e,c);return i?function(t){return p(clamp(e[0],e[u-1],t))}:p}var reverseEasing=function(e){return function(t){return 1-e(1-t)}},mirrorEasing=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},createExpoIn=function(e){return function(t){return Math.pow(t,e)}},createBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}},createAnticipate=function(t){var e=createBackIn(t);return function(t){return(t*=2)<1?.5*e(t):.5*(2-Math.pow(2,-10*(t-1)))}},DEFAULT_OVERSHOOT_STRENGTH=1.525,BOUNCE_FIRST_THRESHOLD=4/11,BOUNCE_SECOND_THRESHOLD=8/11,BOUNCE_THIRD_THRESHOLD=.9,linear=function(t){return t},easeIn=createExpoIn(2),easeOut=reverseEasing(easeIn),easeInOut=mirrorEasing(easeIn),circIn=function(t){return 1-Math.sin(Math.acos(t))},circOut=reverseEasing(circIn),circInOut=mirrorEasing(circOut),backIn=createBackIn(DEFAULT_OVERSHOOT_STRENGTH),backOut=reverseEasing(backIn),backInOut=mirrorEasing(backIn),anticipate=createAnticipate(DEFAULT_OVERSHOOT_STRENGTH),ca=4356/361,cb=35442/1805,cc=16061/1805,bounceOut=function(t){var e=t*t;return t<BOUNCE_FIRST_THRESHOLD?7.5625*e:t<BOUNCE_SECOND_THRESHOLD?9.075*e-9.9*t+3.4:t<BOUNCE_THIRD_THRESHOLD?ca*e-cb*t+cc:10.8*t*t-20.52*t+10.72},bounceIn=function(t){return 1-bounceOut(1-t)},bounceInOut=function(t){return t<.5?.5*(1-bounceOut(1-2*t)):.5*bounceOut(2*t-1)+.5};function defaultEasing(t,e){return t.map(function(){return e||easeInOut}).splice(0,t.length-1)}function defaultOffset(t){var r=t.length;return t.map(function(t,e){return 0!==e?e/(r-1):0})}function convertOffsetToTimes(t,e){return t.map(function(t){return t*e})}var KeyframesAnimator=function(){function t(t){this.isComplete=!1,this.updateOptions(t);var e=this.options,r=e.from,n=e.to,o=e.duration,i=this.options,a=i.ease,s=i.offset,u=Array.isArray(n)?n:[r,n],a=Array.isArray(a)?a:defaultEasing(u),c=convertOffsetToTimes(s=s||defaultOffset(u),o);this.interpolator=interpolate(c,u,{ease:a})}return t.prototype.update=function(t){var e=this.options.duration;return this.isComplete=e<=t,this.interpolator(t)},t.prototype.updateOptions=function(t){var e=t.from,r=void 0===e?0:e,n=t.to,o=void 0===n?1:n,i=t.ease,a=t.offset,s=t.duration,u=void 0===s?300:s;this.options={from:r,to:o,ease:i,offset:a,duration:u}},t.needsInterpolation=!1,t.uniqueOptionKeys=new Set(["duration","ease"]),t}(),DecayAnimator=function(){function t(t){this.isComplete=!1,this.updateOptions(t);var e=this.options,r=e.power,n=e.velocity,o=e.modifyTarget,i=e.from,a=r*n,s=i+a,u=void 0===o?s:o(s);u!==s&&(a=u-i),this.target=u,this.amplitude=a}return t.prototype.update=function(t){var e=this.options,r=e.timeConstant,n=e.restDelta,o=-this.amplitude*Math.exp(-t/r);return this.isComplete=!(n<o||o<-n),this.isComplete?this.target:this.target+o},t.prototype.updateOptions=function(t){var e=void 0===t?{}:t,r=e.velocity,n=void 0===r?0:r,o=e.from,i=void 0===o?0:o,a=e.power,s=void 0===a?.8:a,u=e.timeConstant,c=void 0===u?350:u,p=e.restDelta,f=void 0===p?.5:p,l=e.modifyTarget;this.options={velocity:n,from:i,power:s,timeConstant:c,restDelta:f,modifyTarget:l}},t.needsInterpolation=!0,t.uniqueOptionKeys=new Set(["power","timeConstant","modifyTarget"]),t}(),animators=[KeyframesAnimator,SpringAnimator,DecayAnimator],numAnimators=animators.length;function detectAnimationFromOptions(t){for(var e in t)for(var r=0;r<numAnimators;r++){var n=animators[r];if(n.uniqueOptionKeys.has(e))return n}}var __assign$2=function(){return(__assign$2=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__rest=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},framesync=function(r){function t(t){var e=t.delta;return r(e)}return sync__default.update(t,!0,!0),function(){return sync.cancelSync.update(t)}};function animate(t){var r,n,e=t.from,o=t.to,i=t.autoplay,a=void 0===i||i,s=t.driver,u=void 0===s?framesync:s,c=t.elapsed,p=void 0===c?0:c,f=t.repeat,l=void 0===f?0:f,m=t.repeatType,v=void 0===m?"loop":m,y=(t.repeatDelay,t.onPlay),d=t.onComplete,h=t.onRepeat,x=t.onUpdate,g=__rest(t,["from","to","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onComplete","onRepeat","onUpdate"]),O=0,b=g.duration,S=!0,I=detectAnimationFromOptions(g);I.needsInterpolation&&(n=interpolate([0,100],[e,o],{clamp:!1}),e=0,o=100);var T=new I(__assign$2(__assign$2({},g),{from:e,to:o}));function M(t){S||(t=-t),p+=t;var e=T.update(p);n&&(e=n(e)),x(e),(S?T.isComplete:p<=0)&&(O<l?function(){0===O&&void 0===b&&(b=p),O++;var t=p-b;"loop"===v?p=t:(p=b-t,S=O%2==0),h&&h()}():(r(),d&&d()))}function _(){y&&y(),r=u(M)}return a&&_(),{play:_,pause:function(){},resume:function(){},reverse:function(){},seek:function(){},stop:r}}var radiansToDegrees=function(t){return 180*t/Math.PI},angle=function(t,e){return void 0===e&&(e=zeroPoint),radiansToDegrees(Math.atan2(e.y-t.y,e.x-t.x))},applyOffset=function(e,r){var n=!0;return void 0===r&&(r=e,n=!1),function(t){return n?t-e+r:(e=t,n=!0,r)}},identity=function(t){return t},attract=function(i){return void 0===i&&(i=identity),function(t,e,r){var n=e-r,o=-(0-t+1)*(0-i(Math.abs(n)));return n<=0?e+o:e-o}},attractLinear=attract(),attractExpo=attract(Math.sqrt),degreesToRadians=function(t){return t*Math.PI/180},isPoint=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},isPoint3D=function(t){return isPoint(t)&&t.hasOwnProperty("z")},distance1D=function(t,e){return Math.abs(t-e)},distance=function(t,e){if(void 0===e&&(e=zeroPoint),isNum(t)&&isNum(e))return distance1D(t,e);if(isPoint(t)&&isPoint(e)){var r=distance1D(t.x,e.x),n=distance1D(t.y,e.y),o=isPoint3D(t)&&isPoint3D(e)?distance1D(t.z,e.z):0;return Math.sqrt(Math.pow(r,2)+Math.pow(n,2)+Math.pow(o,2))}return 0},pointFromVector=function(t,e,r){return e=degreesToRadians(e),{x:r*Math.cos(e)+t.x,y:r*Math.sin(e)+t.y}},toDecimal=function(t,e){return void 0===e&&(e=2),e=Math.pow(10,e),Math.round(t*e)/e},smoothFrame=function(t,e,r,n){return void 0===n&&(n=0),toDecimal(t+r*(e-t)/Math.max(n,r))},smooth=function(o){void 0===o&&(o=50);var i=0,a=0;return function(t){var e=sync.getFrameData().timestamp,r=e!==a?e-a:0,n=r?smoothFrame(i,t,r,o):i;return a=e,i=n}},snap=function(o){if("number"==typeof o)return function(t){return Math.round(t/o)*o};var i=0,a=o.length;return function(t){var e=Math.abs(o[0]-t);for(i=1;i<a;i++){var r=o[i],n=Math.abs(r-t);if(0===n)return r;if(e<n)return o[i-1];if(i===a-1)return r;e=n}}},velocityPerFrame=function(t,e){return isNum(t)?t/(1e3/e):0},velocityPerSecond=function(t,e){return e?t*(1e3/e):0},wrap=function(t,e,r){var n=e-t;return((r-t)%n+n)%n+t},a=function(t,e){return 1-3*e+3*t},b=function(t,e){return 3*e-6*t},c=function(t){return 3*t},calcBezier=function(t,e,r){return((a(e,r)*t+b(e,r))*t+c(e))*t},getSlope=function(t,e,r){return 3*a(e,r)*t*t+2*b(e,r)*t+c(e)},subdivisionPrecision=1e-7,subdivisionMaxIterations=10;function binarySubdivide(t,e,r,n,o){for(var i,a,s=0;0<(i=calcBezier(a=e+(r-e)/2,n,o)-t)?r=a:e=a,Math.abs(i)>subdivisionPrecision&&++s<subdivisionMaxIterations;);return a}var newtonIterations=8,newtonMinSlope=.001;function newtonRaphsonIterate(t,e,r,n){for(var o=0;o<newtonIterations;++o){var i=getSlope(e,r,n);if(0===i)return e;e-=(calcBezier(e,r,n)-t)/i}return e}var kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1);function cubicBezier(a,e,s,r){if(a===e&&s===r)return linear;for(var u=new Float32Array(kSplineTableSize),t=0;t<kSplineTableSize;++t)u[t]=calcBezier(t*kSampleStepSize,a,s);return function(t){return 0===t||1===t?t:calcBezier(function(t){for(var e=0,r=1,n=kSplineTableSize-1;r!==n&&u[r]<=t;++r)e+=kSampleStepSize;var o=e+(t-u[--r])/(u[r+1]-u[r])*kSampleStepSize,i=getSlope(o,a,s);return newtonMinSlope<=i?newtonRaphsonIterate(t,o,a,s):0===i?o:binarySubdivide(t,e,e+kSampleStepSize,a,s)}(t),e,r)}}var steps=function(n,o){return void 0===o&&(o="end"),function(t){var e=(t="end"===o?Math.min(t,.999):Math.max(t,.001))*n,r="end"===o?Math.floor(e):Math.ceil(e);return clamp(0,1,r/n)}};exports.DecayAnimator=DecayAnimator,exports.KeyframesAnimator=KeyframesAnimator,exports.SpringAnimator=SpringAnimator,exports.angle=angle,exports.animate=animate,exports.anticipate=anticipate,exports.applyOffset=applyOffset,exports.attract=attract,exports.attractExpo=attractExpo,exports.attractLinear=attractLinear,exports.backIn=backIn,exports.backInOut=backInOut,exports.backOut=backOut,exports.bounceIn=bounceIn,exports.bounceInOut=bounceInOut,exports.bounceOut=bounceOut,exports.circIn=circIn,exports.circInOut=circInOut,exports.circOut=circOut,exports.clamp=clamp,exports.createAnticipate=createAnticipate,exports.createBackIn=createBackIn,exports.createExpoIn=createExpoIn,exports.cubicBezier=cubicBezier,exports.degreesToRadians=degreesToRadians,exports.distance=distance,exports.easeIn=easeIn,exports.easeInOut=easeInOut,exports.easeOut=easeOut,exports.interpolate=interpolate,exports.isPoint=isPoint,exports.isPoint3D=isPoint3D,exports.linear=linear,exports.mirrorEasing=mirrorEasing,exports.mix=mix,exports.mixColor=mixColor,exports.mixComplex=mixComplex,exports.pipe=pipe,exports.pointFromVector=pointFromVector,exports.progress=progress,exports.radiansToDegrees=radiansToDegrees,exports.reverseEasing=reverseEasing,exports.smooth=smooth,exports.smoothFrame=smoothFrame,exports.snap=snap,exports.steps=steps,exports.toDecimal=toDecimal,exports.velocityPerFrame=velocityPerFrame,exports.velocityPerSecond=velocityPerSecond,exports.wrap=wrap;