"use strict";exports.__esModule=!0,exports.default=void 0;var _ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),_arrayFindIndex=_interopRequireDefault(require("array-find-index")),_invariant=_interopRequireDefault(require("fbjs/lib/invariant"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}var isPrefixed=_ExecutionEnvironment.canUseDOM&&!document.hasOwnProperty("hidden")&&document.hasOwnProperty("webkitHidden"),EVENT_TYPES=["change","memoryWarning"],VISIBILITY_CHANGE_EVENT=isPrefixed?"webkitvisibilitychange":"visibilitychange",VISIBILITY_STATE_PROPERTY=isPrefixed?"webkitVisibilityState":"visibilityState",AppStates={BACKGROUND:"background",ACTIVE:"active"},listeners=[],AppState=function(){function r(){}return r.addEventListener=function(e,n){var t;r.isAvailable&&((0,_invariant.default)(-1!==EVENT_TYPES.indexOf(e),'Trying to subscribe to unknown event: "%s"',e),"change"===e&&(t=function(){return n(r.currentState)},listeners.push([n,t]),document.addEventListener(VISIBILITY_CHANGE_EVENT,t,!1)))},r.removeEventListener=function(e,n){var t,i;r.isAvailable&&((0,_invariant.default)(-1!==EVENT_TYPES.indexOf(e),'Trying to remove listener for unknown event: "%s"',e),"change"===e&&(t=(0,_arrayFindIndex.default)(listeners,function(e){return e[0]===n}),(0,_invariant.default)(-1!==t,"Trying to remove AppState listener for unregistered handler"),i=listeners[t][1],document.removeEventListener(VISIBILITY_CHANGE_EVENT,i,!1),listeners.splice(t,1)))},_createClass(r,null,[{key:"currentState",get:function(){if(!r.isAvailable)return AppStates.ACTIVE;switch(document[VISIBILITY_STATE_PROPERTY]){case"hidden":case"prerender":case"unloaded":return AppStates.BACKGROUND;default:return AppStates.ACTIVE}}}]),r}();(exports.default=AppState).isAvailable=_ExecutionEnvironment.canUseDOM&&document[VISIBILITY_STATE_PROPERTY],module.exports=exports.default;