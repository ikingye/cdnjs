import React,{useRef,useCallback,useEffect}from"react";import{canUseDOM}from"fbjs/lib/ExecutionEnvironment";import View from"../View";import createElement from"../createElement";import StyleSheet from"../StyleSheet";var FocusBracket=function(){return createElement("div",{accessible:!0,accessibilityRole:"none",importantForAccessibility:"no-hide-descendants",style:styles.focusBracket,tabIndex:0})};function attemptFocus(e){try{e.focus()}catch(e){}return document.activeElement===e}function focusFirstDescendant(e){for(var t=0;t<e.childNodes.length;t++){var c=e.childNodes[t];if(attemptFocus(c)||focusFirstDescendant(c))return!0}return!1}function focusLastDescendant(e){for(var t=e.childNodes.length-1;t>=0;t--){var c=e.childNodes[t];if(attemptFocus(c)||focusLastDescendant(c))return!0}return!1}var ModalFocusTrap=function(e){var t=e.active,c=e.children,n=useRef(),r=useRef({trapFocusInProgress:!1,lastFocusedElement:null}),s=useCallback(function(){if(n.current&&!r.current.trapFocusInProgress&&t){try{if(r.current.trapFocusInProgress=!0,document.activeElement instanceof Node&&!n.current.contains(document.activeElement)){var e=focusFirstDescendant(n.current);r.current.lastFocusedElement===document.activeElement&&(e=focusLastDescendant(n.current)),!e&&document.activeElement&&document.activeElement.blur()}}finally{r.current.trapFocusInProgress=!1}r.current.lastFocusedElement=document.activeElement}},[t]);return useEffect(function(){if(canUseDOM)return document.addEventListener("focus",s,!0),s(),function(){document.removeEventListener("focus",s,!0)}},[s]),React.createElement(React.Fragment,null,React.createElement(FocusBracket,null),React.createElement(View,{ref:n},c),React.createElement(FocusBracket,null))};export default ModalFocusTrap;var styles=StyleSheet.create({focusBracket:{outlineStyle:"none"}});