import React,{forwardRef,useCallback,useMemo,useEffect,useState}from"react";import ModalPortal from"./ModalPortal";import ModalAnimation from"./ModalAnimation";import ModalContent from"./ModalContent";import ModalFocusTrap from"./ModalFocusTrap";var uniqueModalIdentifier=0,activeModalStack=[],activeModalListeners={};function notifyActiveModalListeners(){if(activeModalStack.length>0){var e=activeModalStack[activeModalStack.length-1];activeModalStack.forEach(function(t){null!=activeModalListeners[t]&&activeModalListeners[t](t===e)})}}function addActiveModal(e,t){removeActiveModal(e),activeModalStack.push(e),activeModalListeners[e]=t,notifyActiveModalListeners()}function removeActiveModal(e){null!=activeModalListeners[e]&&(activeModalListeners[e](!1),delete activeModalListeners[e]);var t=activeModalStack.indexOf(e);-1!==t&&(activeModalStack.splice(t,1),notifyActiveModalListeners())}var Modal=forwardRef(function(e,t){var a=e.visible,o=void 0!==a&&a,i=e.animationType,n=void 0===i?"none":i,l=e.transparent,c=void 0!==l&&l,r=e.children,d=e.onShow,s=e.onDismiss,M=e.onRequestClose,v=useState(!1),u=v[0],f=v[1],m=useMemo(function(){return uniqueModalIdentifier++},[]),p=useCallback(function(){removeActiveModal(m),s&&s()},[m,s]),A=useCallback(function(){addActiveModal(m,f),d&&d()},[m,d]);return useEffect(function(){return function(){return removeActiveModal(m)}},[m]),React.createElement(ModalPortal,null,React.createElement(ModalAnimation,{animationType:n,onDismiss:p,onShow:A,visible:o},React.createElement(ModalFocusTrap,{active:u},React.createElement(ModalContent,{active:u,onRequestClose:M,ref:t,transparent:c},r))))});export default Modal;