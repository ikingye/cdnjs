"use strict";function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}import AnimatedNode from"./AnimatedNode";import AnimatedWithChildren from"./AnimatedWithChildren";import NativeAnimatedHelper from"../NativeAnimatedHelper";import invariant from"fbjs/lib/invariant";import normalizeColor from"normalize-css-color";var linear=function(t){return t};function createInterpolation(t){if(t.outputRange&&"string"==typeof t.outputRange[0])return createInterpolationFromStringOutputRange(t);var e=t.outputRange;checkInfiniteRange("outputRange",e);var n=t.inputRange;checkInfiniteRange("inputRange",n),checkValidInputRange(n),invariant(n.length===e.length,"inputRange ("+n.length+") and outputRange ("+e.length+") must have the same length");var r=t.easing||linear,a="extend";void 0!==t.extrapolateLeft?a=t.extrapolateLeft:void 0!==t.extrapolate&&(a=t.extrapolate);var i="extend";return void 0!==t.extrapolateRight?i=t.extrapolateRight:void 0!==t.extrapolate&&(i=t.extrapolate),function(t){invariant("number"==typeof t,"Cannot interpolation an input which is not a number");var o=findRange(t,n);return interpolate(t,n[o],n[o+1],e[o],e[o+1],r,a,i)}}function interpolate(t,e,n,r,a,i,o,p){var u=t;if(u<e){if("identity"===o)return u;"clamp"===o&&(u=e)}if(u>n){if("identity"===p)return u;"clamp"===p&&(u=n)}return r===a?r:e===n?t<=e?r:a:(e===-1/0?u=-u:n===1/0?u-=e:u=(u-e)/(n-e),u=i(u),r===-1/0?u=-u:a===1/0?u+=r:u=u*(a-r)+r,u)}function colorToRgba(t){var e=normalizeColor(t);return null===e?t:"rgba("+((4278190080&(e=e||0))>>>24)+", "+((16711680&e)>>>16)+", "+((65280&e)>>>8)+", "+(255&e)/255+")"}var stringShapeRegex=/[+-]?(?:\d+\.?\d*|\.\d+)(?:[eE][+-]?\d+)?/g;function createInterpolationFromStringOutputRange(t){var e=t.outputRange;invariant(e.length>=2,"Bad output range"),checkPattern(e=e.map(colorToRgba));var n=e[0].match(stringShapeRegex).map(function(){return[]});e.forEach(function(t){t.match(stringShapeRegex).forEach(function(t,e){n[e].push(+t)})});var r=e[0].match(stringShapeRegex).map(function(e,r){return createInterpolation(_objectSpread({},t,{outputRange:n[r]}))}),a=isRgbOrRgba(e[0]);return function(t){var n=0;return e[0].replace(stringShapeRegex,function(){var e=+r[n++](t);return a&&(e=n<4?Math.round(e):Math.round(1e3*e)/1e3),String(e)})}}function isRgbOrRgba(t){return"string"==typeof t&&t.startsWith("rgb")}function checkPattern(t){for(var e=t[0].replace(stringShapeRegex,""),n=1;n<t.length;++n)invariant(e===t[n].replace(stringShapeRegex,""),"invalid pattern "+t[0]+" and "+t[n])}function findRange(t,e){var n;for(n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}function checkValidInputRange(t){invariant(t.length>=2,"inputRange must have at least 2 elements");for(var e=1;e<t.length;++e)invariant(t[e]>=t[e-1],"inputRange must be monotonically non-decreasing "+t)}function checkInfiniteRange(t,e){invariant(e.length>=2,t+" must have at least 2 elements"),invariant(2!==e.length||e[0]!==-1/0||e[1]!==1/0,t+"cannot be ]-infinity;+infinity[ "+e)}var AnimatedInterpolation=function(t){function e(e,n){var r;return(r=t.call(this)||this)._parent=e,r._config=n,r._interpolation=createInterpolation(n),r}_inheritsLoose(e,t);var n=e.prototype;return n.__makeNative=function(){this._parent.__makeNative(),t.prototype.__makeNative.call(this)},n.__getValue=function(){var t=this._parent.__getValue();return invariant("number"==typeof t,"Cannot interpolate an input which is not a number."),this._interpolation(t)},n.interpolate=function(t){return new e(this,t)},n.__attach=function(){this._parent.__addChild(this)},n.__detach=function(){this._parent.__removeChild(this),t.prototype.__detach.call(this)},n.__transformDataType=function(t){return t.map(NativeAnimatedHelper.transformDataType)},n.__getNativeConfig=function(){return"production"!==process.env.NODE_ENV&&NativeAnimatedHelper.validateInterpolation(this._config),{inputRange:this._config.inputRange,outputRange:this.__transformDataType(this._config.outputRange),extrapolateLeft:this._config.extrapolateLeft||this._config.extrapolate||"extend",extrapolateRight:this._config.extrapolateRight||this._config.extrapolate||"extend",type:"interpolation"}},e}(AnimatedWithChildren);AnimatedInterpolation.__createInterpolation=createInterpolation;export default AnimatedInterpolation;