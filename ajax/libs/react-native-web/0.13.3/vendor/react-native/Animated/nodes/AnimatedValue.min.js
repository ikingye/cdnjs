"use strict";function _inheritsLoose(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i}import AnimatedInterpolation from"./AnimatedInterpolation";import AnimatedWithChildren from"./AnimatedWithChildren";import InteractionManager from"../../../../exports/InteractionManager";import NativeAnimatedHelper from"../NativeAnimatedHelper";var NativeAnimatedAPI=NativeAnimatedHelper.API;function _flush(t){var i=new Set;!function t(e){"function"==typeof e.update?i.add(e):e.__getChildren().forEach(t)}(t),i.forEach(function(t){return t.update()})}var AnimatedValue=function(t){function i(i){var e;return(e=t.call(this)||this)._startingValue=e._value=i,e._offset=0,e._animation=null,e}_inheritsLoose(i,t);var e=i.prototype;return e.__detach=function(){this.stopAnimation(),t.prototype.__detach.call(this)},e.__getValue=function(){return this._value+this._offset},e.setValue=function(t){this._animation&&(this._animation.stop(),this._animation=null),this._updateValue(t,!this.__isNative),this.__isNative&&NativeAnimatedAPI.setAnimatedNodeValue(this.__getNativeTag(),t)},e.setOffset=function(t){this._offset=t,this.__isNative&&NativeAnimatedAPI.setAnimatedNodeOffset(this.__getNativeTag(),t)},e.flattenOffset=function(){this._value+=this._offset,this._offset=0,this.__isNative&&NativeAnimatedAPI.flattenAnimatedNodeOffset(this.__getNativeTag())},e.extractOffset=function(){this._offset+=this._value,this._value=0,this.__isNative&&NativeAnimatedAPI.extractAnimatedNodeOffset(this.__getNativeTag())},e.stopAnimation=function(t){this.stopTracking(),this._animation&&this._animation.stop(),this._animation=null,t&&t(this.__getValue())},e.resetAnimation=function(t){this.stopAnimation(t),this._value=this._startingValue},e._onAnimatedValueUpdateReceived=function(t){this._updateValue(t,!1)},e.interpolate=function(t){return new AnimatedInterpolation(this,t)},e.animate=function(t,i){var e=this,n=null;t.__isInteraction&&(n=InteractionManager.createInteractionHandle());var a=this._animation;this._animation&&this._animation.stop(),this._animation=t,t.start(this._value,function(t){e._updateValue(t,!0)},function(t){e._animation=null,null!==n&&InteractionManager.clearInteractionHandle(n),i&&i(t)},a,this)},e.stopTracking=function(){this._tracking&&this._tracking.__detach(),this._tracking=null},e.track=function(t){this.stopTracking(),this._tracking=t},e._updateValue=function(i,e){this._value=i,e&&_flush(this),t.prototype.__callListeners.call(this,this.__getValue())},e.__getNativeConfig=function(){return{type:"value",value:this._value,offset:this._offset}},i}(AnimatedWithChildren);export default AnimatedValue;