"use strict";import InteractionManager from"../../../exports/InteractionManager";import TouchHistoryMath from"../TouchHistoryMath";var currentCentroidXOfTouchesChangedAfter=TouchHistoryMath.currentCentroidXOfTouchesChangedAfter,currentCentroidYOfTouchesChangedAfter=TouchHistoryMath.currentCentroidYOfTouchesChangedAfter,previousCentroidXOfTouchesChangedAfter=TouchHistoryMath.previousCentroidXOfTouchesChangedAfter,previousCentroidYOfTouchesChangedAfter=TouchHistoryMath.previousCentroidYOfTouchesChangedAfter,currentCentroidX=TouchHistoryMath.currentCentroidX,currentCentroidY=TouchHistoryMath.currentCentroidY,PanResponder={_initializeGestureState:function(e){e.moveX=0,e.moveY=0,e.x0=0,e.y0=0,e.dx=0,e.dy=0,e.vx=0,e.vy=0,e.numberActiveTouches=0,e._accountsForMovesUpTo=0},_updateGestureStateOnMove:function(e,n){e.numberActiveTouches=n.numberActiveTouches,e.moveX=currentCentroidXOfTouchesChangedAfter(n,e._accountsForMovesUpTo),e.moveY=currentCentroidYOfTouchesChangedAfter(n,e._accountsForMovesUpTo);var o=e._accountsForMovesUpTo,t=previousCentroidXOfTouchesChangedAfter(n,o),r=currentCentroidXOfTouchesChangedAfter(n,o),a=previousCentroidYOfTouchesChangedAfter(n,o),u=currentCentroidYOfTouchesChangedAfter(n,o),c=e.dx+(r-t),s=e.dy+(u-a),d=n.mostRecentTimeStamp-e._accountsForMovesUpTo;e.vx=(c-e.dx)/d,e.vy=(s-e.dy)/d,e.dx=c,e.dy=s,e._accountsForMovesUpTo=n.mostRecentTimeStamp},create:function(e){var n={handle:null},o={stateID:Math.random(),moveX:0,moveY:0,x0:0,y0:0,dx:0,dy:0,vx:0,vy:0,numberActiveTouches:0,_accountsForMovesUpTo:0};return{panHandlers:{onStartShouldSetResponder:function(n){return null!=e.onStartShouldSetPanResponder&&e.onStartShouldSetPanResponder(n,o)},onMoveShouldSetResponder:function(n){return null!=e.onMoveShouldSetPanResponder&&e.onMoveShouldSetPanResponder(n,o)},onStartShouldSetResponderCapture:function(n){return 1===n.nativeEvent.touches.length&&PanResponder._initializeGestureState(o),o.numberActiveTouches=n.touchHistory.numberActiveTouches,null!=e.onStartShouldSetPanResponderCapture&&e.onStartShouldSetPanResponderCapture(n,o)},onMoveShouldSetResponderCapture:function(n){var t=n.touchHistory;return o._accountsForMovesUpTo!==t.mostRecentTimeStamp&&(PanResponder._updateGestureStateOnMove(o,t),!!e.onMoveShouldSetPanResponderCapture&&e.onMoveShouldSetPanResponderCapture(n,o))},onResponderGrant:function(t){return n.handle||(n.handle=InteractionManager.createInteractionHandle()),o.x0=currentCentroidX(t.touchHistory),o.y0=currentCentroidY(t.touchHistory),o.dx=0,o.dy=0,e.onPanResponderGrant&&e.onPanResponderGrant(t,o),null==e.onShouldBlockNativeResponder||e.onShouldBlockNativeResponder(t,o)},onResponderReject:function(t){clearInteractionHandle(n,e.onPanResponderReject,t,o)},onResponderRelease:function(t){clearInteractionHandle(n,e.onPanResponderRelease,t,o),PanResponder._initializeGestureState(o)},onResponderStart:function(n){var t=n.touchHistory;o.numberActiveTouches=t.numberActiveTouches,e.onPanResponderStart&&e.onPanResponderStart(n,o)},onResponderMove:function(n){var t=n.touchHistory;o._accountsForMovesUpTo!==t.mostRecentTimeStamp&&(PanResponder._updateGestureStateOnMove(o,t),e.onPanResponderMove&&e.onPanResponderMove(n,o))},onResponderEnd:function(t){var r=t.touchHistory;o.numberActiveTouches=r.numberActiveTouches,clearInteractionHandle(n,e.onPanResponderEnd,t,o)},onResponderTerminate:function(t){clearInteractionHandle(n,e.onPanResponderTerminate,t,o),PanResponder._initializeGestureState(o)},onResponderTerminationRequest:function(n){return null==e.onPanResponderTerminationRequest||e.onPanResponderTerminationRequest(n,o)}},getInteractionHandle:function(){return n.handle}}}};function clearInteractionHandle(e,n,o,t){e.handle&&(InteractionManager.clearInteractionHandle(e.handle),e.handle=null),n&&n(o,t)}export default PanResponder;