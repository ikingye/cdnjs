import{Inject,forwardRef,ChangeDetectorRef,Component,ViewEncapsulation,ChangeDetectionStrategy,Input,EventEmitter,ElementRef,Output,ContentChildren,NgModule}from"@angular/core";import{trigger,state,style,transition,animate}from"@angular/animations";import{CommonModule}from"@angular/common";import{PrimeTemplate,SharedModule}from"primeng/api";import{Subject}from"rxjs";var __read=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a},__spread=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},OrganizationChartNode=function(){function e(e,t){var n=this;this.cd=t,this.chart=e,this.subscription=this.chart.selectionSource$.subscribe(function(){n.cd.markForCheck()})}return Object.defineProperty(e.prototype,"leaf",{get:function(){return 0!=this.node.leaf&&!(this.node.children&&this.node.children.length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colspan",{get:function(){return this.node.children&&this.node.children.length?2*this.node.children.length:null},enumerable:!1,configurable:!0}),e.prototype.onNodeClick=function(e,t){this.chart.onNodeClick(e,t)},e.prototype.toggleNode=function(e,t){t.expanded=!t.expanded,t.expanded?this.chart.onNodeExpand.emit({originalEvent:e,node:this.node}):this.chart.onNodeCollapse.emit({originalEvent:e,node:this.node}),e.preventDefault()},e.prototype.isSelected=function(){return this.chart.isSelected(this.node)},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:Inject,args:[forwardRef(function(){return OrganizationChart})]}]},{type:ChangeDetectorRef}]},e.decorators=[{type:Component,args:[{selector:"[pOrganizationChartNode]",template:'\n        <tbody *ngIf="node">\n            <tr>\n                <td [attr.colspan]="colspan">\n                    <div [class]="node.styleClass" [ngClass]="{\'p-organizationchart-node-content\': true, \'p-organizationchart-selectable-node\': chart.selectionMode && node.selectable !== false,\'p-highlight\':isSelected()}"\n                        (click)="onNodeClick($event,node)">\n                        <div *ngIf="!chart.getTemplateForNode(node)">{{node.label}}</div>\n                        <div *ngIf="chart.getTemplateForNode(node)">\n                            <ng-container *ngTemplateOutlet="chart.getTemplateForNode(node); context: {$implicit: node}"></ng-container>\n                        </div>\n                        <a *ngIf="!leaf" tabindex="0" class="p-node-toggler" (click)="toggleNode($event, node)" (keydown.enter)="toggleNode($event, node)">\n                            <i class="p-node-toggler-icon pi" [ngClass]="{\'pi-chevron-down\': node.expanded, \'pi-chevron-up\': !node.expanded}"></i>\n                        </a>\n                    </div>\n                </td>\n            </tr>\n            <tr [ngClass]="!leaf&&node.expanded ? \'p-organizationchart-node-visible\' : \'p-organizationchart-node-hidden\'" class="p-organizationchart-lines" [@childState]="\'in\'">\n                <td [attr.colspan]="colspan">\n                    <div class="p-organizationchart-line-down"></div>\n                </td>\n            </tr>\n            <tr [ngClass]="!leaf&&node.expanded ? \'p-organizationchart-node-visible\' : \'p-organizationchart-node-hidden\'" class="p-organizationchart-lines" [@childState]="\'in\'">\n                <ng-container *ngIf="node.children && node.children.length === 1">\n                    <td [attr.colspan]="colspan">\n                        <div class="p-organizationchart-line-down"></div>\n                    </td>\n                </ng-container>\n                <ng-container *ngIf="node.children && node.children.length > 1">\n                    <ng-template ngFor let-child [ngForOf]="node.children" let-first="first" let-last="last">\n                        <td class="p-organizationchart-line-left" [ngClass]="{\'p-organizationchart-line-top\':!first}">&nbsp;</td>\n                        <td class="p-organizationchart-line-right" [ngClass]="{\'p-organizationchart-line-top\':!last}">&nbsp;</td>\n                    </ng-template>\n                </ng-container>\n            </tr>\n            <tr [ngClass]="!leaf&&node.expanded ? \'p-organizationchart-node-visible\' : \'p-organizationchart-node-hidden\'" class="p-organizationchart-nodes" [@childState]="\'in\'">\n                <td *ngFor="let child of node.children" colspan="2">\n                    <table class="p-organizationchart-table" pOrganizationChartNode [node]="child"></table>\n                </td>\n            </tr>\n        </tbody>\n    ',animations:[trigger("childState",[state("in",style({opacity:1})),transition("void => *",[style({opacity:0}),animate(150)]),transition("* => void",[animate(150,style({opacity:0}))])])],encapsulation:ViewEncapsulation.None,changeDetection:ChangeDetectionStrategy.OnPush,styles:[".p-organizationchart-table{border-spacing:0;border-collapse:separate;margin:0 auto}.p-organizationchart-table>tbody>tr>td{text-align:center;vertical-align:top;padding:0 .75rem}.p-organizationchart-node-content{display:inline-block;position:relative}.p-organizationchart-node-content .p-node-toggler{position:absolute;bottom:-.75rem;margin-left:-.75rem;z-index:2;left:50%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;width:1.5rem;height:1.5rem}.p-organizationchart-node-content .p-node-toggler .p-node-toggler-icon{position:relative;top:.25rem}.p-organizationchart-line-down{margin:0 auto;height:20px;width:1px}.p-organizationchart-line-left,.p-organizationchart-line-right{border-radius:0}.p-organizationchart-selectable-node{cursor:pointer}.p-organizationchart .p-organizationchart-node-hidden{display:none}.p-organizationchart-preservespace .p-organizationchart-node-hidden{visibility:hidden;display:inherit}"]}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:Inject,args:[forwardRef(function(){return OrganizationChart})]}]},{type:ChangeDetectorRef}]},e.propDecorators={node:[{type:Input}],root:[{type:Input}],first:[{type:Input}],last:[{type:Input}]},e}(),OrganizationChart=function(){function e(e,t){this.el=e,this.cd=t,this.preserveSpace=!0,this.selectionChange=new EventEmitter,this.onNodeSelect=new EventEmitter,this.onNodeUnselect=new EventEmitter,this.onNodeExpand=new EventEmitter,this.onNodeCollapse=new EventEmitter,this.selectionSource=new Subject,this.selectionSource$=this.selectionSource.asObservable()}return Object.defineProperty(e.prototype,"selection",{get:function(){return this._selection},set:function(e){this._selection=e,this.initialized&&this.selectionSource.next()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.value&&this.value.length?this.value[0]:null},enumerable:!1,configurable:!0}),e.prototype.ngAfterContentInit=function(){var e=this;this.templates.length&&(this.templateMap={}),this.templates.forEach(function(t){e.templateMap[t.getType()]=t.template}),this.initialized=!0},e.prototype.getTemplateForNode=function(e){return this.templateMap?e.type?this.templateMap[e.type]:this.templateMap.default:null},e.prototype.onNodeClick=function(e,t){var n=e.target;if((!n.className||-1===n.className.indexOf("p-node-toggler")&&-1===n.className.indexOf("p-node-toggler-icon"))&&this.selectionMode){if(!1===t.selectable)return;var o=this.findIndexInSelection(t),i=o>=0;"single"===this.selectionMode?i?(this.selection=null,this.onNodeUnselect.emit({originalEvent:e,node:t})):(this.selection=t,this.onNodeSelect.emit({originalEvent:e,node:t})):"multiple"===this.selectionMode&&(i?(this.selection=this.selection.filter(function(e,t){return t!=o}),this.onNodeUnselect.emit({originalEvent:e,node:t})):(this.selection=__spread(this.selection||[],[t]),this.onNodeSelect.emit({originalEvent:e,node:t}))),this.selectionChange.emit(this.selection),this.selectionSource.next()}},e.prototype.findIndexInSelection=function(e){var t=-1;if(this.selectionMode&&this.selection)if("single"===this.selectionMode)t=this.selection==e?0:-1;else if("multiple"===this.selectionMode)for(var n=0;n<this.selection.length;n++)if(this.selection[n]==e){t=n;break}return t},e.prototype.isSelected=function(e){return-1!=this.findIndexInSelection(e)},e.ctorParameters=function(){return[{type:ElementRef},{type:ChangeDetectorRef}]},e.decorators=[{type:Component,args:[{selector:"p-organizationChart",template:'\n        <div [ngStyle]="style" [class]="styleClass" [ngClass]="{\'p-organizationchart p-component\': true, \'p-organizationchart-preservespace\': preserveSpace}">\n            <table class="p-organizationchart-table" pOrganizationChartNode [node]="root" *ngIf="root"></table>\n        </div>\n    ',changeDetection:ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:ElementRef},{type:ChangeDetectorRef}]},e.propDecorators={value:[{type:Input}],style:[{type:Input}],styleClass:[{type:Input}],selectionMode:[{type:Input}],preserveSpace:[{type:Input}],selection:[{type:Input}],selectionChange:[{type:Output}],onNodeSelect:[{type:Output}],onNodeUnselect:[{type:Output}],onNodeExpand:[{type:Output}],onNodeCollapse:[{type:Output}],templates:[{type:ContentChildren,args:[PrimeTemplate]}]},e}(),OrganizationChartModule=function(){function e(){}return e.decorators=[{type:NgModule,args:[{imports:[CommonModule],exports:[OrganizationChart,SharedModule],declarations:[OrganizationChart,OrganizationChartNode]}]}],e}();export{OrganizationChart,OrganizationChartModule,OrganizationChartNode};