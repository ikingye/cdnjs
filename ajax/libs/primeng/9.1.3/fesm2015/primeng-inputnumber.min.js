import{forwardRef,EventEmitter,ElementRef,Input,ViewChild,Output,Component,ChangeDetectionStrategy,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";import{InputTextModule}from"primeng/inputtext";import{ButtonModule}from"primeng/button";import{NG_VALUE_ACCESSOR}from"@angular/forms";var __decorate=this&&this.__decorate||function(t,e,n,i){var u,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(u=t[s])&&(r=(o<3?u(r):o>3?u(e,n,r):u(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const INPUTNUMBER_VALUE_ACCESSOR={provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(()=>InputNumber),multi:!0};let InputNumber=class{constructor(t){this.el=t,this.showButtons=!1,this.format=!0,this.buttonLayout="stacked",this.useGrouping=!0,this.incrementButtonIcon="pi pi-chevron-up",this.decrementButtonIcon="pi pi-chevron-down",this.mode="decimal",this.step=1,this.onFocus=new EventEmitter,this.onBlur=new EventEmitter,this.onModelChange=(()=>{}),this.onModelTouched=(()=>{})}ngOnInit(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const t=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),e=new Map(t.map((t,e)=>[t,e]));this._numeral=new RegExp(`[${t.join("")}]`,"g"),this._decimal=this.getDecimalExpression(),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._suffix=new RegExp(`[${this.suffix||""}]`,"g"),this._prefix=new RegExp(`[${this.prefix||""}]`,"g"),this._index=(t=>e.get(t))}formatValue(t){if(null!=t){if(this.format){let e=new Intl.NumberFormat(this.locale,this.getOptions()).format(t);return this.prefix&&(e=this.prefix+e),this.suffix&&(e+=this.suffix),e}return t}return""}formattedValue(){return this.formatValue(this.value)}onInput(t){this.isSpecialChar&&(t.target.value=this.lastValue),this.isSpecialChar=!1}onInputKeyDown(t){if(this.lastValue=t.target.value,t.shiftKey||t.altKey)return void(this.isSpecialChar=!0);let e=t.target.selectionStart,n=t.target.selectionEnd,i=t.target.value;switch(t.altKey&&t.preventDefault(),t.which){case 38:this.spin(t,1),t.preventDefault();break;case 40:this.spin(t,-1),t.preventDefault();break;case 37:this.isNumeralChar(i.charAt(e-1))||t.preventDefault();break;case 39:this.isNumeralChar(i.charAt(e))||t.preventDefault();break;case 8:{t.preventDefault();let u=null;if(e===n){let n=i.charAt(e-1),o=i.search(this._decimal);this._decimal.lastIndex=0,this.isNumeralChar(n)&&(this._group.test(n)?(this._group.lastIndex=0,u=i.slice(0,e-2)+i.slice(e-1)):this._decimal.test(n)?(this._decimal.lastIndex=0,this.input.nativeElement.setSelectionRange(e-1,e-1)):u=o>0&&e>o?i.slice(0,e-1)+"0"+i.slice(e):i.slice(0,e-1)+i.slice(e)),null!=u&&this.updateValue(t,u,"delete-single")}else u=this.deleteRange(i,e,n),this.updateValue(t,u,"delete-range");break}}}onInputKeyPress(t){t.preventDefault();let e=t.which||t.keyCode,n=String.fromCharCode(e);(48<=e&&e<=57||this.isMinusSign(n))&&this.insert(t,n)}onPaste(t){t.preventDefault();let e=(t.clipboardData||window.clipboardData).getData("Text");if(e){let n=this.parseValue(e);null!=n&&this.insert(t,n.toString())}}onInputClick(){this.initCursor()}onInputFocus(t){this.focused=!0,this.onFocus.emit(t)}onInputBlur(t){this.focused=!1;let e=this.validateValue(this.parseValue(this.input.nativeElement.value));this.input.nativeElement.value=this.formatValue(e),this.input.nativeElement.setAttribute("aria-valuenow",e),this.updateModel(t,e),this.onBlur.emit(t)}onUpButtonMouseDown(t){this.input.nativeElement.focus(),this.repeat(t,null,1),t.preventDefault()}onUpButtonMouseUp(){this.clearTimer()}onUpButtonMouseLeave(){this.clearTimer()}onUpButtonKeyDown(t){32!==t.keyCode&&13!==t.keyCode||this.repeat(t,null,1)}onUpButtonKeyUp(){this.clearTimer()}onDownButtonMouseDown(t){this.input.nativeElement.focus(),this.repeat(t,null,-1),t.preventDefault()}onDownButtonMouseUp(){this.clearTimer()}onDownButtonMouseLeave(){this.clearTimer()}onDownButtonKeyUp(){this.clearTimer()}onDownButtonKeyDown(t){32!==t.keyCode&&13!==t.keyCode||this.repeat(t,null,-1)}spin(t,e){let n=this.step*e,i=this.parseValue(this.input.nativeElement.value)||0,u=this.validateValue(i+n);this.maxlength&&this.maxlength<this.formatValue(u).length||(this.updateInput(u,"spin"),this.updateModel(t,u))}repeat(t,e,n){let i=e||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(t,40,n)},i),this.spin(t,n)}clearTimer(){this.timer&&clearInterval(this.timer)}insert(t,e){let n,i=this.input.nativeElement.selectionStart,u=this.input.nativeElement.selectionEnd,o=this.input.nativeElement.value.trim(),r=this.numberFormat.resolvedOptions().maximumFractionDigits,s=o.search(this._decimal);this._decimal.lastIndex=0,s>0&&i>s?i+e.length-(s+1)<=r&&(n=o.slice(0,i)+e+o.slice(i+e.length),this.updateValue(t,n,"insert")):(n=this.insertText(o,e,i,u),this.updateValue(t,n,"insert"))}insertText(t,e,n,i){let u;return u=i-n===t.length?e:0===n?e+t.slice(i):i===t.length?t.slice(0,n)+e:t.slice(0,n)+e+t.slice(i)}initCursor(){let t=this.input.nativeElement.selectionStart,e=this.input.nativeElement.value,n=e.length,i=null,u=e.charAt(t);if(this.isNumeralChar(u))return;let o=t-1;for(;o>=0;){if(u=e.charAt(o),this.isNumeralChar(u)){i=o;break}o--}if(null!==i)this.input.nativeElement.setSelectionRange(i+1,i+1);else{for(o=t+1;o<n;){if(u=e.charAt(o),this.isNumeralChar(u)){i=o;break}o++}null!==i&&this.input.nativeElement.setSelectionRange(i,i)}}updateInput(t,e){let n=this.input.nativeElement.value.length;if(0===n)this.input.nativeElement.value=this.formatValue(t),this.input.nativeElement.setSelectionRange(0,0),this.initCursor(),this.input.nativeElement.setSelectionRange(this.input.nativeElement.selectionStart+1,this.input.nativeElement.selectionStart+1);else{let i=this.input.nativeElement.selectionEnd,u=this.input.nativeElement.selectionEnd,o=this.formatValue(t);if(this.maxlength&&this.maxlength<o.length)return;this.input.nativeElement.value=this.formatValue(t);let r=this.input.nativeElement.value.length;r===n?"insert"===e?this.input.nativeElement.setSelectionRange(u+1,u+1):"delete-single"===e?this.input.nativeElement.setSelectionRange(u-1,u-1):"delete-range"===e?this.input.nativeElement.setSelectionRange(i,i):"spin"===e&&this.input.nativeElement.setSelectionRange(i,u):(u+=r-n,this.input.nativeElement.setSelectionRange(u,u))}this.input.nativeElement.setAttribute("aria-valuenow",t)}updateModel(t,e){this.value=e,this.onModelChange(e)}updateValue(t,e,n){if(null!=e){let t=this.parseValue(e);this.updateInput(t,n)}}validateValue(t){return null!==this.min&&t<this.min?this.min:null!==this.max&&t>this.max?this.max:t}deleteRange(t,e,n){let i;return i=n-e===t.length?"":0===e?t.slice(n):n===t.length?t.slice(0,e):t.slice(0,e)+t.slice(n)}isNumeralChar(t){return!(1!==t.length||!(this._numeral.test(t)||this._decimal.test(t)||this._group.test(t)||this._minusSign.test(t)))&&(this.resetRegex(),!0)}isMinusSign(t){return!!this._minusSign.test(t)&&(this._minusSign.lastIndex=0,!0)}parseValue(t){let e=t.trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._suffix,"").replace(this._prefix,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(e){let t=+e;return isNaN(t)?null:t}return null}writeValue(t){this.value=t}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}}getDecimalExpression(){const t=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${t.format(1.1).trim().replace(this._numeral,"")}]`,"g")}getGroupingExpression(){const t=new Intl.NumberFormat(this.locale,{useGrouping:!0});return new RegExp(`[${t.format(1e3).trim().replace(this._numeral,"")}]`,"g")}getMinusSignExpression(){const t=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${t.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){const t=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay});return new RegExp(`[${t.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._decimal,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}filled(){return null!=this.value&&this.value.toString().length>0}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}};InputNumber.ctorParameters=(()=>[{type:ElementRef}]),__decorate([Input()],InputNumber.prototype,"showButtons",void 0),__decorate([Input()],InputNumber.prototype,"format",void 0),__decorate([Input()],InputNumber.prototype,"buttonLayout",void 0),__decorate([Input()],InputNumber.prototype,"prefix",void 0),__decorate([Input()],InputNumber.prototype,"locale",void 0),__decorate([Input()],InputNumber.prototype,"suffix",void 0),__decorate([Input()],InputNumber.prototype,"localeMatcher",void 0),__decorate([Input()],InputNumber.prototype,"currency",void 0),__decorate([Input()],InputNumber.prototype,"currencyDisplay",void 0),__decorate([Input()],InputNumber.prototype,"useGrouping",void 0),__decorate([Input()],InputNumber.prototype,"disabled",void 0),__decorate([Input()],InputNumber.prototype,"inputId",void 0),__decorate([Input()],InputNumber.prototype,"styleClass",void 0),__decorate([Input()],InputNumber.prototype,"placeholder",void 0),__decorate([Input()],InputNumber.prototype,"size",void 0),__decorate([Input()],InputNumber.prototype,"maxlength",void 0),__decorate([Input()],InputNumber.prototype,"tabindex",void 0),__decorate([Input()],InputNumber.prototype,"title",void 0),__decorate([Input()],InputNumber.prototype,"ariaLabel",void 0),__decorate([Input()],InputNumber.prototype,"ariaRequired",void 0),__decorate([Input()],InputNumber.prototype,"name",void 0),__decorate([Input()],InputNumber.prototype,"required",void 0),__decorate([Input()],InputNumber.prototype,"autocomplete",void 0),__decorate([Input()],InputNumber.prototype,"min",void 0),__decorate([Input()],InputNumber.prototype,"max",void 0),__decorate([Input()],InputNumber.prototype,"minFractionDigits",void 0),__decorate([Input()],InputNumber.prototype,"maxFractionDigits",void 0),__decorate([Input()],InputNumber.prototype,"incrementButtonClass",void 0),__decorate([Input()],InputNumber.prototype,"decrementButtonClass",void 0),__decorate([Input()],InputNumber.prototype,"incrementButtonIcon",void 0),__decorate([Input()],InputNumber.prototype,"decrementButtonIcon",void 0),__decorate([Input()],InputNumber.prototype,"mode",void 0),__decorate([Input()],InputNumber.prototype,"step",void 0),__decorate([ViewChild("input")],InputNumber.prototype,"input",void 0),__decorate([Output()],InputNumber.prototype,"onFocus",void 0),__decorate([Output()],InputNumber.prototype,"onBlur",void 0);let InputNumberModule=class{};InputNumberModule=__decorate([NgModule({imports:[CommonModule,InputTextModule,ButtonModule],exports:[InputNumber=__decorate([Component({selector:"p-inputNumber",template:'\n        <span [ngClass]="{\'ui-inputnumber ui-widget\': true, \'ui-inputwrapper-filled\': this.filled(), \'ui-inputwrapper-focus\': this.focused,\n                \'ui-inputnumber-buttons-stacked\': this.showButtons && this.buttonLayout === \'stacked\', \'ui-inputnumber-buttons-horizontal\': this.showButtons && this.buttonLayout === \'horizontal\',\n                \'ui-inputnumber-buttons-vertical\': this.showButtons && this.buttonLayout === \'vertical\'}">\n            <input #input class="ui-inputnumber-input" pInputText [value]="formattedValue()" [attr.placeholder]="placeholder" [attr.title]="title" [attr.id]="inputId"\n                [attr.size]="size" [attr.name]="name" [attr.autocomplete]="autocomplete" [attr.maxlength]="maxlength" [attr.tabindex]="tabindex" [attr.aria-label]="ariaLabel"\n                [attr.aria-required]="ariaRequired" [disabled]="disabled" [attr.required]="required" [attr.aria-valumin]="min" [attr.aria-valuemax]="max"\n                (input)="onInput($event)" (keydown)="onInputKeyDown($event)" (keypress)="onInputKeyPress($event)" (paste)="onPaste($event)" (click)="onInputClick()"\n                (focus)="onInputFocus($event)" (blur)="onInputBlur($event)">\n            <span class="ui-inputnumber-button-group" *ngIf="showButtons && buttonLayout === \'stacked\'">\n                <button type="button" pButton [ngClass]="{\'ui-inputnumber-button ui-inputnumber-button-up\': true}" [class]="incrementButtonClass" [icon]="incrementButtonIcon" [disabled]="disabled"\n                    (mousedown)="this.onUpButtonMouseDown($event)" (mouseup)="onUpButtonMouseUp()" (mouseleave)="onUpButtonMouseLeave()" (keydown)="onUpButtonKeyDown($event)" (keyup)="onUpButtonKeyUp()"></button>\n                <button type="button" pButton [ngClass]="{\'ui-inputnumber-button ui-inputnumber-button-down\': true}" [class]="decrementButtonClass" [icon]="decrementButtonIcon" [disabled]="disabled"\n                    (mousedown)="this.onDownButtonMouseDown($event)" (mouseup)="onDownButtonMouseUp()" (mouseleave)="onDownButtonMouseLeave()" (keydown)="onDownButtonKeyDown($event)" (keyup)="onDownButtonKeyUp()"></button>\n            </span>\n            <button type="button" pButton [ngClass]="{\'ui-inputnumber-button ui-inputnumber-button-up\': true}" [class]="incrementButtonClass" [icon]="incrementButtonIcon" *ngIf="showButtons && buttonLayout !== \'stacked\'" [disabled]="disabled"\n                (mousedown)="this.onUpButtonMouseDown($event)" (mouseup)="onUpButtonMouseUp()" (mouseleave)="onUpButtonMouseLeave()" (keydown)="onUpButtonKeyDown($event)" (keyup)="onUpButtonKeyUp()"></button>\n            <button type="button" pButton [ngClass]="{\'ui-inputnumber-button ui-inputnumber-button-down\': true}" [class]="decrementButtonClass" [icon]="decrementButtonIcon" *ngIf="showButtons && buttonLayout !== \'stacked\'" [disabled]="disabled"\n                (mousedown)="this.onDownButtonMouseDown($event)" (mouseup)="onDownButtonMouseUp()" (mouseleave)="onDownButtonMouseLeave()" (keydown)="onDownButtonKeyDown($event)" (keyup)="onDownButtonKeyUp()"></button>\n        </span>\n    ',changeDetection:ChangeDetectionStrategy.Default,providers:[INPUTNUMBER_VALUE_ACCESSOR]})],InputNumber)],declarations:[InputNumber]})],InputNumberModule);export{INPUTNUMBER_VALUE_ACCESSOR,InputNumber,InputNumberModule};