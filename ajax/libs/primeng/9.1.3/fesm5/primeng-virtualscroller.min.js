import{EventEmitter,ElementRef,Input,ContentChild,ContentChildren,ViewChild,Output,Component,ChangeDetectionStrategy,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";import{Header,Footer,PrimeTemplate,SharedModule}from"primeng/api";import{CdkVirtualScrollViewport,ScrollingModule}from"@angular/cdk/scrolling";var __decorate=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(l=(i<3?n(l):i>3?n(t,o,l):n(t,o))||l);return i>3&&l&&Object.defineProperty(t,o,l),l},VirtualScroller=function(){function e(e){this.el=e,this.trackBy=function(e,t){return t},this.onLazyLoad=new EventEmitter,this._totalRecords=0,this.page=0,this._first=0,this.loadedPages=[]}return Object.defineProperty(e.prototype,"totalRecords",{get:function(){return this._totalRecords},set:function(e){this._totalRecords=e,console.log("totalRecords is deprecated, provide a value with the length of virtual items instead.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this._first},set:function(e){this._first=e,console.log("first property is deprecated, use scrollToIndex function to scroll a specific item.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return this._cache},set:function(e){this._cache=e,console.log("cache is deprecated as it is always on.")},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){var e=this;this.templates.forEach(function(t){switch(t.getType()){case"item":e.itemTemplate=t.template;break;case"loadingItem":e.loadingItemTemplate=t.template;break;default:e.itemTemplate=t.template}})},e.prototype.onScrollIndexChange=function(e){var t=this;this.lazy&&this.createPageRange(Math.floor(e/this.rows)).forEach(function(e){return t.loadPage(e)})},e.prototype.createPageRange=function(e){var t=[];return 0!==e&&t.push(e-1),t.push(e),e!==Math.ceil(this.value.length/this.rows)-1&&t.push(e+1),t},e.prototype.loadPage=function(e){this.loadedPages.includes(e)||(this.onLazyLoad.emit({first:this.rows*e,rows:this.rows}),this.loadedPages.push(e))},e.prototype.getBlockableElement=function(){return this.el.nativeElement.children[0]},e.prototype.scrollTo=function(e,t){this.scrollToIndex(e,t)},e.prototype.scrollToIndex=function(e,t){this.viewport&&this.viewport.scrollToIndex(e,t)},e.prototype.clearCache=function(){this.loadedPages=[]},e.prototype.ngOnChanges=function(e){e.value&&(this.lazy||this.clearCache())},e.ctorParameters=function(){return[{type:ElementRef}]},__decorate([Input()],e.prototype,"value",void 0),__decorate([Input()],e.prototype,"itemSize",void 0),__decorate([Input()],e.prototype,"style",void 0),__decorate([Input()],e.prototype,"styleClass",void 0),__decorate([Input()],e.prototype,"scrollHeight",void 0),__decorate([Input()],e.prototype,"lazy",void 0),__decorate([Input()],e.prototype,"rows",void 0),__decorate([Input()],e.prototype,"minBufferPx",void 0),__decorate([Input()],e.prototype,"maxBufferPx",void 0),__decorate([Input()],e.prototype,"trackBy",void 0),__decorate([ContentChild(Header)],e.prototype,"header",void 0),__decorate([ContentChild(Footer)],e.prototype,"footer",void 0),__decorate([ContentChildren(PrimeTemplate)],e.prototype,"templates",void 0),__decorate([ViewChild(CdkVirtualScrollViewport)],e.prototype,"viewport",void 0),__decorate([Output()],e.prototype,"onLazyLoad",void 0),__decorate([Input()],e.prototype,"totalRecords",null),__decorate([Input()],e.prototype,"first",null),__decorate([Input()],e.prototype,"cache",null),e=__decorate([Component({selector:"p-virtualScroller",template:'\n        <div [ngClass]="\'ui-virtualscroller ui-widget\'" [ngStyle]="style" [class]="styleClass">\n            <div class="ui-virtualscroller-header ui-widget-header ui-corner-top" *ngIf="header">\n                <ng-content select="p-header"></ng-content>\n            </div>\n            <div #content class="ui-virtualscroller-content ui-widget-content">\n                <div class="ui-virtualscroller-list">\n                    <cdk-virtual-scroll-viewport #viewport [ngStyle]="{\'height\': scrollHeight}" [itemSize]="itemSize" [minBufferPx]="minBufferPx" [maxBufferPx]="maxBufferPx" (scrolledIndexChange)="onScrollIndexChange($event)">\n                        <ng-container *cdkVirtualFor="let item of value; trackBy: trackBy; let i = index; let c = count; let f = first; let l = last; let e = even; let o = odd; ">\n                            <div [ngStyle]="{\'height\': itemSize + \'px\'}" class="ui-virtualscroller-item">\n                                <ng-container *ngTemplateOutlet="item ? itemTemplate : loadingItemTemplate; context: {$implicit: item, index: i, count: c, first: f, last: l, even: e, odd: o}"></ng-container>\n                            </div>\n                        </ng-container>\n                    </cdk-virtual-scroll-viewport>\n                </div>\n            </div>\n            <div class="ui-virtualscroller-footer ui-widget-header ui-corner-bottom" *ngIf="footer">\n                <ng-content select="p-footer"></ng-content>\n            </div>\n        </div>\n    ',changeDetection:ChangeDetectionStrategy.Default})],e)}(),VirtualScrollerModule=function(){function e(){}return e=__decorate([NgModule({imports:[CommonModule,ScrollingModule],exports:[VirtualScroller,SharedModule,ScrollingModule],declarations:[VirtualScroller]})],e)}();export{VirtualScroller,VirtualScrollerModule};