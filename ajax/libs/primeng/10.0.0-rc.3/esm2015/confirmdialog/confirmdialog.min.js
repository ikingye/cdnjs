import{NgModule,Component,ElementRef,OnDestroy,Input,EventEmitter,Renderer2,ContentChild,NgZone,ViewChild,ChangeDetectorRef,ChangeDetectionStrategy,ViewEncapsulation,ContentChildren,QueryList,TemplateRef,AfterContentInit}from"@angular/core";import{trigger,style,transition,animate,useAnimation,animation}from"@angular/animations";import{CommonModule}from"@angular/common";import{DomHandler}from"primeng/dom";import{Footer,SharedModule,PrimeTemplate}from"primeng/api";import{ButtonModule}from"primeng/button";import{ConfirmationService}from"primeng/api";const showAnimation=animation([style({transform:"{{transform}}",opacity:0}),animate("{{transition}}",style({transform:"none",opacity:1}))]),hideAnimation=animation([animate("{{transition}}",style({transform:"{{transform}}",opacity:0}))]);export class ConfirmDialog{constructor(t,e,i,n,o){this.el=t,this.renderer=e,this.confirmationService=i,this.zone=n,this.cd=o,this.acceptIcon="pi pi-check",this.acceptLabel="Yes",this.acceptVisible=!0,this.rejectIcon="pi pi-times",this.rejectLabel="No",this.rejectVisible=!0,this.closeOnEscape=!0,this.blockScroll=!0,this.closable=!0,this.autoZIndex=!0,this.baseZIndex=0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.focusTrap=!0,this.defaultFocus="accept",this._position="center",this.transformOptions="scale(0.7)",this.subscription=this.confirmationService.requireConfirmation$.subscribe(t=>{t?t.key===this.key&&(this.confirmation=t,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll},this.confirmation.accept&&(this.confirmation.acceptEvent=new EventEmitter,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new EventEmitter,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(t){this._visible=t,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(t){switch(this._position=t,t){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"footerTemplate":this.footerTemplate=t.template}})}option(t){const e=this.confirmationOptions||this;if(e.hasOwnProperty(t))return e[t]}onAnimationStart(t){switch(t.toState){case"visible":this.container=t.element,this.wrapper=this.container.parentElement,this.contentContainer=DomHandler.findSingle(this.container,".p-dialog-content");const e=this.getElementToFocus();e&&e.focus(),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality()}}onAnimationEnd(t){switch(t.toState){case"void":this.onOverlayHide()}}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":return DomHandler.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return DomHandler.findSingle(this.container,".p-confirm-dialog-reject");case"close":return DomHandler.findSingle(this.container,".p-dialog-header-close");case"none":return null;default:return DomHandler.findSingle(this.container,".p-confirm-dialog-accept")}}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):DomHandler.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&DomHandler.addClass(document.body,"p-overflow-hidden")}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&DomHandler.removeClass(document.body,"p-overflow-hidden"),this.container&&this.cd.detectChanges()}close(t){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(),this.hide(),t.preventDefault()}hide(){this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(this.container.style.zIndex=String(this.baseZIndex+ ++DomHandler.zindex),this.wrapper.style.zIndex=String(this.baseZIndex+(DomHandler.zindex-1)))}getMaskClass(){let t={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return t[this.getPositionClass().toString()]=!0,t}getPositionClass(){const t=["left","right","top","topleft","topright","bottom","bottomleft","bottomright"].find(t=>t===this.position);return t?`p-dialog-${t}`:""}bindGlobalListeners(){(this.closeOnEscape&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen("document","keydown",t=>{if(27==t.which&&this.closeOnEscape&&this.closable&&parseInt(this.container.style.zIndex)===DomHandler.zindex+this.baseZIndex&&this.visible&&this.close(t),9===t.which&&this.focusTrap){t.preventDefault();let e=DomHandler.getFocusableElements(this.container);if(e&&e.length>0)if(document.activeElement){let i=e.indexOf(document.activeElement);t.shiftKey?-1==i||0===i?e[e.length-1].focus():e[i-1].focus():-1==i||i===e.length-1?e[0].focus():e[i+1].focus()}else e[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}onOverlayHide(){this.disableModality(),this.unbindGlobalListeners(),this.container=null}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe()}accept(){this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide()}reject(){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(),this.hide()}};ConfirmDialog.ctorParameters=(()=>[{type:ElementRef},{type:Renderer2},{type:ConfirmationService},{type:NgZone},{type:ChangeDetectorRef}]),ConfirmDialog.decorators=[{type:Component,args:[{selector:"p-confirmDialog",template:'\n        <div [class]="maskStyleClass" [ngClass]="getMaskClass()" *ngIf="maskVisible">\n            <div [ngClass]="{\'p-dialog p-confirm-dialog p-component\':true,\'p-dialog-rtl\':rtl}" [ngStyle]="style" [class]="styleClass" (mousedown)="moveOnTop()"\n                [@animation]="{value: \'visible\', params: {transform: transformOptions, transition: transitionOptions}}" (@animation.start)="onAnimationStart($event)" (@animation.done)="onAnimationEnd($event)" *ngIf="visible">\n                <div class="p-dialog-header">\n                    <span class="p-dialog-title" *ngIf="option(\'header\')">{{option(\'header\')}}</span>\n                    <div class="p-dialog-header-icons">\n                        <button *ngIf="closable" type="button" [ngClass]="{\'p-dialog-header-icon p-dialog-header-close p-link\':true}" (click)="close($event)" (keydown.enter)="close($event)">\n                            <span class="pi pi-times"></span>\n                        </button>\n                    </div>\n                </div>\n                <div #content class="p-dialog-content">\n                    <i [ngClass]="\'p-confirm-dialog-icon\'" [class]="option(\'icon\')" *ngIf="option(\'icon\')"></i>\n                    <span class="p-confirm-dialog-message" [innerHTML]="option(\'message\')"></span>\n                </div>\n                <div class="p-dialog-footer" *ngIf="footer || footerTemplate">\n                    <ng-content select="p-footer"></ng-content>\n                    <ng-container *ngTemplateOutlet="footerTemplate"></ng-container>\n                </div>\n                <div class="p-dialog-footer" *ngIf="!footer">\n                    <button type="button" pButton [icon]="option(\'acceptIcon\')" [label]="option(\'acceptLabel\')" (click)="accept()" [ngClass]="\'p-confirm-dialog-accept\'" [class]="option(\'acceptButtonStyleClass\')" *ngIf="option(\'acceptVisible\')"></button>\n                    <button type="button" pButton [icon]="option(\'rejectIcon\')" [label]="option(\'rejectLabel\')" (click)="reject()" [ngClass]="\'p-confirm-dialog-reject\'" [class]="option(\'rejectButtonStyleClass\')" *ngIf="option(\'rejectVisible\')"></button>\n                </div>\n            </div>\n        </div>\n    ',animations:[trigger("animation",[transition("void => visible",[useAnimation(showAnimation)]),transition("visible => void",[useAnimation(hideAnimation)])])],changeDetection:ChangeDetectionStrategy.OnPush,encapsulation:ViewEncapsulation.None,styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;pointer-events:none;background-color:transparent;transition-property:background-color}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;pointer-events:auto;max-height:90%;-ms-transform:scale(1);transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto}.p-dialog-header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.p-dialog-title{list-style:outside}.p-dialog .p-dialog-header-icons{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.p-dialog .p-dialog-header-icon{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;position:relative}.p-dialog-mask.p-dialog-mask-leave{background-color:transparent}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-bottom .p-dialog,.p-dialog-bottomleft .p-dialog,.p-dialog-bottomright .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top .p-dialog,.p-dialog-topleft .p-dialog,.p-dialog-topright .p-dialog{margin:.75rem;transform:translate3d(0,0,0)}.p-dialog-maximized{transition:none;-ms-transform:none;transform:none;width:100vw!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{-ms-flex-positive:1;flex-grow:1}.p-dialog-left{-ms-flex-pack:start;justify-content:flex-start}.p-dialog-right{-ms-flex-pack:end;justify-content:flex-end}.p-dialog-top{-ms-flex-align:start;align-items:flex-start}.p-dialog-topleft{-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:start;align-items:flex-start}.p-dialog-topright{-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:start;align-items:flex-start}.p-dialog-bottom{-ms-flex-align:end;align-items:flex-end}.p-dialog-bottomleft{-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:end;align-items:flex-end}.p-dialog-bottomright{-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}"]}]}],ConfirmDialog.ctorParameters=(()=>[{type:ElementRef},{type:Renderer2},{type:ConfirmationService},{type:NgZone},{type:ChangeDetectorRef}]),ConfirmDialog.propDecorators={header:[{type:Input}],icon:[{type:Input}],message:[{type:Input}],style:[{type:Input}],styleClass:[{type:Input}],maskStyleClass:[{type:Input}],acceptIcon:[{type:Input}],acceptLabel:[{type:Input}],acceptVisible:[{type:Input}],rejectIcon:[{type:Input}],rejectLabel:[{type:Input}],rejectVisible:[{type:Input}],acceptButtonStyleClass:[{type:Input}],rejectButtonStyleClass:[{type:Input}],closeOnEscape:[{type:Input}],blockScroll:[{type:Input}],rtl:[{type:Input}],closable:[{type:Input}],appendTo:[{type:Input}],key:[{type:Input}],autoZIndex:[{type:Input}],baseZIndex:[{type:Input}],transitionOptions:[{type:Input}],focusTrap:[{type:Input}],defaultFocus:[{type:Input}],visible:[{type:Input}],position:[{type:Input}],footer:[{type:ContentChild,args:[Footer]}],contentViewChild:[{type:ViewChild,args:["content"]}],templates:[{type:ContentChildren,args:[PrimeTemplate]}]};export class ConfirmDialogModule{};ConfirmDialogModule.decorators=[{type:NgModule,args:[{imports:[CommonModule,ButtonModule],exports:[ConfirmDialog,ButtonModule,SharedModule],declarations:[ConfirmDialog]}]}];