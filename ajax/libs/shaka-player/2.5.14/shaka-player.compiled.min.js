!function(){var e="undefined"!=typeof window?window:global,t={};if(function(f,e,t){var n,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},c=(void 0===f||f!==this)&&void 0!==e&&null!=e?e:this;function u(){u=function(){},c.Symbol||(c.Symbol=r)}var i,r=(i=0,function(e){return"jscomp_symbol_"+(e||"")+i++});function l(){u();var e=(e=c.Symbol.iterator)||(c.Symbol.iterator=c.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&o(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return a(this)}}),l=function(){}}function a(e){var t=0;return d(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})}function d(e){return l(),(e={next:e})[c.Symbol.iterator]=function(){return this},e}function Y(e){l();var t=e[Symbol.iterator];return t?t.call(e):a(e)}function s(e,t){if(t){for(var n=c,i=e.split("."),r=0;r<i.length-1;r++){var a=i[r];a in n||(n[a]={}),n=n[a]}(a=t(r=n[i=i[i.length-1]]))!=r&&null!=a&&o(n,i,{configurable:!0,writable:!0,value:a})}}function h(t){function r(e){return t.next(e)}function a(e){return t.throw(e)}return new Promise(function(n,i){!function e(t){t.done?n(t.value):Promise.resolve(t.value).then(r,a).then(e,i)}(t.next())})}function $(e){return h(e())}s("Promise",function(e){function s(e){this.b=0,this.g=void 0,this.a=[];var t=this.c();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function t(){this.a=null}function u(t){return t instanceof s?t:new s(function(e){e(t)})}if(e)return e;t.prototype.b=function(e){null==this.a&&(this.a=[],this.f()),this.a.push(e)},t.prototype.f=function(){var e=this;this.c(function(){e.h()})};var n=c.setTimeout;t.prototype.c=function(e){n(e,0)},t.prototype.h=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.g(e)}}}this.a=null},t.prototype.g=function(e){this.c(function(){throw e})},s.prototype.c=function(){function e(t){return function(e){i||(i=!0,t.call(n,e))}}var n=this,i=!1;return{resolve:e(this.u),reject:e(this.f)}},s.prototype.u=function(e){if(e===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof s)this.v(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.o(e):this.h(e)}},s.prototype.o=function(e){var t=void 0;try{t=e.then}catch(e){return void this.f(e)}"function"==typeof t?this.F(t,e):this.h(e)},s.prototype.f=function(e){this.i(2,e)},s.prototype.h=function(e){this.i(1,e)},s.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.g=t,this.l()},s.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)r.b(this.a[e]);this.a=null}};var r=new t;return s.prototype.v=function(e){var t=this.c();e.kc(t.resolve,t.reject)},s.prototype.F=function(e,t){var n=this.c();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},s.prototype.then=function(e,t){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(e){r(e)}}:e}var i,r,a=new s(function(e,t){i=e,r=t});return this.kc(n(e,i),n(t,r)),a},s.prototype.catch=function(e){return this.then(void 0,e)},s.prototype.kc=function(e,t){function n(){switch(i.b){case 1:e(i.g);break;case 2:t(i.g);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?r.b(n):this.a.push(n)},s.resolve=u,s.reject=function(n){return new s(function(e,t){t(n)})},s.race=function(r){return new s(function(e,t){for(var n=Y(r),i=n.next();!i.done;i=n.next())u(i.value).kc(e,t)})},s.all=function(e){var a=Y(e),o=a.next();return o.done?u([]):new s(function(n,e){function t(t){return function(e){i[t]=e,0==--r&&n(i)}}for(var i=[],r=0;i.push(void 0),r++,u(o.value).kc(t(i.length-1),e),!(o=a.next()).done;);})},s}),s("Promise.prototype.finally",function(e){return e||function(t){return this.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.resolve(t()).then(function(){throw e})})}});var p,m,g="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)p=Object.setPrototypeOf;else{e:{var v={};try{v.__proto__={Ne:!0},m=v.Ne;break e}catch(e){}m=!1}p=m?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var y=p;function b(e,t){if(e.prototype=g(t.prototype),e.prototype.constructor=e,y)y(e,t);else for(var n in t){var i;"prototype"!=n&&(Object.defineProperties?(i=Object.getOwnPropertyDescriptor(t,n))&&Object.defineProperty(e,n,i):e[n]=t[n])}e.Dg=t.prototype}function w(){this.g=!1,this.c=null,this.s=void 0,this.j=1,this.b=this.f=0,this.i=this.a=null}function T(e){if(e.g)throw new TypeError("Generator is already running");e.g=!0}function S(e,t){e.a={Yd:t,ie:!0},e.j=e.f||e.b}function J(e,t,n){return e.j=n,{value:t}}function K(e){e.j=0}function Q(e,t,n){e.f=t,null!=n&&(e.b=n)}function D(e,t){e.f=0,e.b=t||0}function Z(e,t){e.j=t,e.f=0}function ee(e){e.f=0;var t=e.a.Yd;return e.a=null,t}function U(e){e.i=[e.a],e.f=0,e.b=0}function _(e,t){var n=e.i.splice(0)[0];(n=e.a=e.a||n)?n.ie?e.j=e.f||e.b:null!=n.C&&e.b<n.C?(e.j=n.C,e.a=null):e.j=e.b:e.j=t}function E(e){this.a=new w,this.b=e}function x(t,e,n,i){try{var r=e.call(t.a.c,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return t.a.g=!1,r;var a=r.value}catch(e){return t.a.c=null,S(t.a,e),k(t)}return t.a.c=null,i.call(t.a,a),k(t)}function k(t){for(;t.a.j;)try{var e=t.b(t.a);if(e)return t.a.g=!1,{value:e.value,done:!1}}catch(e){t.a.s=void 0,S(t.a,e)}if(t.a.g=!1,t.a.a){if(e=t.a.a,t.a.a=null,e.ie)throw e.Yd;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function A(t){this.next=function(e){return T(t.a),e=t.a.c?x(t,t.a.c.next,e,t.a.h):(t.a.h(e),k(t))},this.throw=function(e){return T(t.a),e=t.a.c?x(t,t.a.c.throw,e,t.a.h):(S(t.a,e),k(t))},this.return=function(e){return function(e,t){T(e.a);var n=e.a.c;return n?x(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),k(e))}(t,e)},l(),this[Symbol.iterator]=function(){return this}}function te(e,t){return A.prototype=e.prototype,new A(new E(t))}function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function I(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var a=e[r];if(t.call(n,a,r,e))return{fe:r,Ie:a}}return{fe:-1,Ie:void 0}}function P(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}w.prototype.h=function(e){this.s=e},w.prototype.return=function(e){this.a={return:e},this.j=this.b},w.prototype.C=function(e){this.j=e},s("WeakMap",function(i){function e(e){if(this.a=(a+=Math.random()+1).toString(),e){u(),l(),e=Y(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){M(e,r)||o(e,r,{value:{}})}function t(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(i&&Object.seal)try{var e=Object.seal({}),t=Object.seal({}),n=new i([[e,2],[t,3]]);return 2!=n.get(e)||3!=n.get(t)?void 0:(n.delete(e),n.set(t,4),!n.has(e)&&4==n.get(t))}catch(e){return}}())return i;var r="$jscomp_hidden_"+Math.random();t("freeze"),t("preventExtensions"),t("seal");var a=0;return e.prototype.set=function(e,t){if(n(e),!M(e,r))throw Error("WeakMap key fail: "+e);return e[r][this.a]=t,this},e.prototype.get=function(e){return M(e,r)?e[r][this.a]:void 0},e.prototype.has=function(e){return M(e,r)&&M(e[r],this.a)},e.prototype.delete=function(e){return!(!M(e,r)||!M(e[r],this.a))&&delete e[r][this.a]},e}),s("Map",function(r){function n(){var e={};return e.Ja=e.next=e.head=e}function e(e,t){var n=e.a;return d(function(){if(n){for(;n.head!=e.a;)n=n.Ja;if(n.next!=n.head)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function i(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++s,o.set(t,n)):n="p_"+t;var i=e.b[n];if(i&&M(e.b,n))for(var r=0;r<i.length;r++){var a=i[r];if(t!=t&&a.key!=a.key||t===a.key)return{id:n,list:i,index:r,ba:a}}return{id:n,list:i,index:-1,ba:void 0}}function t(e){if(this.b={},this.a=n(),this.size=0,e){e=Y(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}if(function(){if(r&&"function"==typeof r&&r.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new r(Y([[e,"s"]]));if("s"!=t.get(e)||1!=t.size||t.get({x:4})||t.set({x:4},"t")!=t||2!=t.size)return;var n=t.entries(),i=n.next();return i.done||i.value[0]!=e||"s"!=i.value[1]?void 0:!((i=n.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!n.next().done)}catch(e){return}}())return r;u(),l();var o=new WeakMap;t.prototype.set=function(e,t){var n=i(this,e);return n.list||(n.list=this.b[n.id]=[]),n.ba?n.ba.value=t:(n.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:e,value:t},n.list.push(n.ba),this.a.Ja.next=n.ba,this.a.Ja=n.ba,this.size++),this},t.prototype.delete=function(e){return!(!(e=i(this,e)).ba||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.b[e.id],e.ba.Ja.next=e.ba.next,e.ba.next.Ja=e.ba.Ja,e.ba.head=null,this.size--,!0)},t.prototype.clear=function(){this.b={},this.a=this.a.Ja=n(),this.size=0},t.prototype.has=function(e){return!!i(this,e).ba},t.prototype.get=function(e){return(e=i(this,e).ba)&&e.value},t.prototype.entries=function(){return e(this,function(e){return[e.key,e.value]})},t.prototype.keys=function(){return e(this,function(e){return e.key})},t.prototype.values=function(){return e(this,function(e){return e.value})},t.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},t.prototype[Symbol.iterator]=t.prototype.entries;var s=0;return t}),s("Set",function(r){function e(e){if(this.a=new Map,e){e=Y(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.a.size}return function(){if(r&&"function"==typeof r&&r.prototype.entries&&"function"==typeof Object.seal)try{var e=Object.seal({x:4}),t=new r(Y([e]));if(!t.has(e)||1!=t.size||t.add(e)!=t||1!=t.size||t.add({x:4})!=t||2!=t.size)return;var n=t.entries(),i=n.next();return i.done||i.value[0]!=e||i.value[1]!=e?void 0:!(i=n.next()).done&&i.value[0]!=e&&4==i.value[0].x&&i.value[1]==i.value[0]&&n.next().done}catch(e){return}}()?r:(u(),l(),e.prototype.add=function(e){return this.a.set(e,e),this.size=this.a.size,this},e.prototype.delete=function(e){return e=this.a.delete(e),this.size=this.a.size,e},e.prototype.clear=function(){this.a.clear(),this.size=0},e.prototype.has=function(e){return this.a.has(e)},e.prototype.entries=function(){return this.a.entries()},e.prototype.keys=e.prototype.values=function(){return this.a.values()},e.prototype[Symbol.iterator]=e.prototype.values,e.prototype.forEach=function(t,n){var i=this;this.a.forEach(function(e){return t.call(n,e,e,i)})},e)}),s("Array.prototype.findIndex",function(e){return e||function(e,t){return I(this,e,t).fe}}),s("Array.prototype.keys",function(e){return e||function(){return function(t,n){l(),t instanceof String&&(t+="");var i=0,r={next:function(){if(i<t.length){var e=i++;return{value:n(e,t[e]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}(this,function(e){return e})}}),s("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),s("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length,r=t||0;for(r<0&&(r=Math.max(r+i,0));r<i;r++){var a=n[r];if(a===e||Object.is(a,e))return!0}return!1}}),s("String.prototype.includes",function(e){return e||function(e,t){return-1!==P(this,e,"includes").indexOf(e,t||0)}}),s("Array.from",function(e){return e||function(e,t,n){l(),t=null!=t?t:function(e){return e};var i=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)i.push(t.call(n,r.value));else{r=e.length;for(var a=0;a<r;a++)i.push(t.call(n,e[a]))}return i}}),s("String.prototype.startsWith",function(e){return e||function(e,t){for(var n=P(this,e,"startsWith"),i=n.length,r=e.length,a=Math.max(0,Math.min(0|t,n.length)),o=0;o<r&&a<i;)if(n[a++]!=e[o++])return!1;return r<=o}}),s("Array.prototype.find",function(e){return e||function(e,t){return I(this,e,t).Ie}});var C="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)M(i,r)&&(e[r]=i[r])}return e};s("Object.assign",function(e){return e||C});var N=this;function R(e,t){var n,i=e.split("."),r=N;i[0]in r||!r.execScript||r.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length||void 0===t?r=r[n]?r[n]:r[n]={}:r[n]=t}function L(e,i){function t(){}t.prototype=i.prototype,e.Dg=i.prototype,e.prototype=new t,(e.prototype.constructor=e).Og=function(e,t,n){return i.prototype[t].apply(e,Array.prototype.slice.call(arguments,2))}}function O(e){this.c=Math.exp(Math.log(.5)/e),this.b=this.a=0}function j(e,t,n){var i=Math.pow(e.c,t);n=n*(1-i)+i*e.a,isNaN(n)||(e.a=n,e.b+=t)}function B(e){return e.a/(1-Math.pow(e.c,e.b))}function F(){this.b=new O(2),this.c=new O(5),this.a=0}N.a=!0,F.prototype.getBandwidthEstimate=function(e){return this.a<128e3?e:Math.min(B(this.b),B(this.c))};var ne={mb:0,jc:function(){},Z:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},D:function(){},J:function(){}};f.console&&f.console.log.bind&&(ne.Z=console.warn.bind(console),ne.jc=console.error.bind(console),1<=ne.mb&&(ne.error=console.error.bind(console)),2<=ne.mb&&(ne.m=console.warn.bind(console)),3<=ne.mb&&(ne.info=console.info.bind(console)),4<=ne.mb&&(ne.debug=console.log.bind(console)),5<=ne.mb&&(ne.D=console.debug.bind(console)),6<=ne.mb&&(ne.J=console.debug.bind(console)));var H=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function ie(e){var t;e instanceof ie?(V(this,e.xa),this.jb=e.jb,this.wa=e.wa,q(this,e.Jb),this.la=e.la,G(this,e.a.clone()),this.Xa=e.Xa):e&&(t=String(e).match(H))?(V(this,t[1]||"",!0),this.jb=W(t[2]||""),this.wa=W(t[3]||"",!0),q(this,t[4]),this.la=W(t[5]||"",!0),G(this,t[6]||"",!0),this.Xa=W(t[7]||"")):this.a=new ce(null)}function V(e,t,n){e.xa=n?W(t,!0):t,e.xa&&(e.xa=e.xa.replace(/:$/,""))}function q(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.Jb=t}else e.Jb=null}function G(e,t,n){t instanceof ce?e.a=t:(n||(t=z(t,se)),e.a=new ce(t))}function W(e,t){return e?(t?decodeURI:decodeURIComponent)(e):""}function z(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,X),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function X(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(n=ie.prototype).xa="",n.jb="",n.wa="",n.Jb=null,n.la="",n.Xa="",n.toString=function(){var e,t=[],n=this.xa;return n&&t.push(z(n,re,!0),":"),(n=this.wa)&&(t.push("//"),(e=this.jb)&&t.push(z(e,re,!0),"@"),t.push(encodeURIComponent(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.Jb)&&t.push(":",String(n))),(n=this.la)&&(this.wa&&"/"!=n.charAt(0)&&t.push("/"),t.push(z(n,"/"==n.charAt(0)?oe:ae,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.Xa)&&t.push("#",z(n,ue)),t.join("")},n.resolve=function(e){var t=this.clone();"data"===t.xa&&(t=new ie);var n=!!e.xa;n?V(t,e.xa):n=!!e.jb,n?t.jb=e.jb:n=!!e.wa,n?t.wa=e.wa:n=null!=e.Jb;var i,r=e.la;if(n)q(t,e.Jb);else if(n=!!e.la){if("/"!=r.charAt(0)&&(this.wa&&!this.la?r="/"+r:-1!=(i=t.la.lastIndexOf("/"))&&(r=t.la.substr(0,i+1)+r)),".."==r||"."==r)r="";else if(-1!=r.indexOf("./")||-1!=r.indexOf("/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var a=[],o=0;o<r.length;){var s=r[o++];"."==s?i&&o==r.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),i&&o==r.length&&a.push("")):(a.push(s),i=!0)}r=a.join("/")}}return n?t.la=r:n=""!==e.a.toString(),n?G(t,e.a.clone()):n=!!e.Xa,n&&(t.Xa=e.Xa),t},n.clone=function(){return new ie(this)};var re=/[#\/\?@]/g,ae=/[#\?:]/g,oe=/[#\?]/g,se=/[#\?@]/g,ue=/#/g;function ce(e){this.a=e||null}function le(e){this.b=e,this.a=null}function de(e){this.b=e,this.a=null}function fe(e,t){var n=pe();this.i=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.f=null==e.baseDelay?n.baseDelay:e.baseDelay,this.h=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.g=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.a=0,this.b=this.f,(this.c=void 0!==t&&t)&&(this.a=1)}function he(i){return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:if(i.a>=i.i){if(!i.c)return e.return(Promise.reject());i.a=1,i.b=i.f}return(t=i.a,i.a++,0==t)?e.return():(n=i.b*(1+(2*Math.random()-1)*i.h),J(e,new Promise(function(e){new de(e).R(n/1e3)}),2));case 2:i.b*=i.g,K(e)}})})}function pe(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}}function me(e,t,n,i){for(var r=[],a=3;a<arguments.length;++a)r[a-3]=arguments[a];this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1}function ge(){var n,i,e=new Promise(function(e,t){n=e,i=t});return e.resolve=n,e.reject=i,e}function ve(e,t){this.promise=e,this.me=t,this.a=!1}function ye(e){return new ve(Promise.reject(e),function(){return Promise.resolve()})}function be(){var e=Promise.reject(new me(2,7,7001));return e.catch(function(){}),new ve(e,function(){return Promise.resolve()})}function we(e){return new ve(Promise.resolve(e),function(){return Promise.resolve()})}function Te(e){return new ve(e,function(){return e.catch(function(){})})}function Se(e){return new ve(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function Ee(e,t){for(var n in t=void 0===t?{}:t)this[n]=t[n];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=f.performance&&f.performance.now?f.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.a=!1}function xe(){this.a={}}function ke(){this.Sc=new xe,this.gc=this}function Ae(e){var a=new Set;return function e(t){switch(typeof t){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return t;default:if(!t||t.buffer&&t.buffer.constructor==ArrayBuffer)return t;if(a.has(t))return null;var n=t.constructor==Array;if(t.constructor!=Object&&!n)return null;a.add(t);var i,r=n?[]:{};for(i in t)r[i]=e(t[i]);return n&&(r.length=t.length),r}}(e)}function Me(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function Ie(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function Pe(e,t,n){if(n=n||Me,e.length!=t.length)return!1;t=t.slice();for(var i={},r=(e=Y(e)).next();!r.done;i={item:i.item},r=e.next()){if(i.item=r.value,-1==(r=t.findIndex(function(t){return function(e){return n(t.item,e)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Ce(){this.a=[]}function Ne(e,t){e.a.push(t.finally(function(){Ie(e.a,t)}))}function Re(e){ke.call(this),this.f=!1,this.g=new Ce,this.a=new Set,this.b=new Set,this.c=e||null}(n=ce.prototype).ja=null,n.nc=null,n.add=function(e,t){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var n=this.a.split("&"),i=0;i<n.length;i++){var r,a=n[i].indexOf("="),o=null;0<=a?(r=n[i].substring(0,a),o=n[i].substring(a+1)):r=n[i],r=decodeURIComponent(r.replace(/\+/g," ")),o=o||"",this.add(r,decodeURIComponent(o.replace(/\+/g," ")))}return this.a=null,(n=this.ja.hasOwnProperty(e)&&this.ja[e])||(this.ja[e]=n=[]),n.push(t),this.nc++,this},n.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var e,t=[];for(e in this.ja)for(var n=encodeURIComponent(e),i=this.ja[e],r=0;r<i.length;r++){var a=n;""!==i[r]&&(a+="="+encodeURIComponent(i[r])),t.push(a)}return this.a=t.join("&")},n.clone=function(){var e=new ce;if(e.a=this.a,this.ja){var t,n={};for(t in this.ja)n[t]=this.ja[t].concat();e.ja=n,e.nc=this.nc}return e},le.prototype.R=function(e){var t=this;this.stop();var n=!0,i=null;return this.a=function(){f.clearTimeout(i),n=!1},i=f.setTimeout(function(){n&&t.b()},1e3*e),this},le.prototype.stop=function(){this.a&&(this.a(),this.a=null)},R("shaka.util.Timer",de),de.prototype.tickNow=de.prototype.Gc=function(){return this.stop(),this.b(),this},de.prototype.tickAfter=de.prototype.R=function(e){var t=this;return this.stop(),this.a=new le(function(){t.b()}).R(e),this},de.prototype.tickEvery=de.prototype.Ra=function(e){var t=this;return this.stop(),this.a=new le(function(){t.a.R(e),t.b()}).R(e),this},de.prototype.stop=de.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)},R("shaka.util.Error",me),me.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},me.Severity={RECOVERABLE:1,CRITICAL:2},me.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},me.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013},ge.prototype.resolve=function(){},ge.prototype.reject=function(){},R("shaka.util.AbortableOperation",ve),ve.failed=ye,ve.aborted=be,ve.completed=we,ve.notAbortable=Te,ve.prototype.abort=ve.prototype.abort=function(){return this.a=!0,this.me()},ve.all=Se,ve.prototype.finally=ve.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},ve.prototype.chain=ve.prototype.Y=function(i,r){function e(n){return function(e){var t;o.a&&n?s.reject(u):(t=n?i:r)?a=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then(function(){},function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(t,e,s):(n?s.resolve:s.reject)(e)}}function a(){return s.reject(u),o.abort()}var o=this,s=new ge,u=new me(2,7,7001);return this.promise.then(e(!0),e(!1)),new ve(s,function(){return a()})},Ee.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ee.prototype.stopImmediatePropagation=function(){this.a=!0},Ee.prototype.stopPropagation=function(){},(n=xe.prototype).push=function(e,t){this.a.hasOwnProperty(e)?this.a[e].push(t):this.a[e]=[t]},n.get=function(e){return(e=this.a[e])?e.slice():null},n.getAll=function(){var e,t=[];for(e in this.a)t.push.apply(t,this.a[e]);return t},n.remove=function(e,t){var n=this.a[e];if(n)for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i)},n.forEach=function(e){for(var t in this.a)e(t,this.a[t])},ke.prototype.addEventListener=function(e,t){this.Sc.push(e,t)},ke.prototype.removeEventListener=function(e,t){this.Sc.remove(e,t)},ke.prototype.dispatchEvent=function(e){for(var t=this.Sc.get(e.type)||[],n=0;n<t.length;++n){e.target=this.gc,e.currentTarget=this.gc;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(e){ne.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.a)break}return e.defaultPrevented},Ce.prototype.destroy=function(){var t=[];return this.a.forEach(function(e){e.promise.catch(function(){}),t.push(e.abort())}),this.a=[],Promise.all(t)},L(Re,ke),R("shaka.net.NetworkingEngine",Re),Re.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},Re.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var De={};function Ue(e,t,n){n=n||3;var i=De[e];(!i||n>=i.priority)&&(De[e]={priority:n,cg:t})}function _e(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function Le(){this.a=0}function Oe(e,t,n){ve.call(this,e,t),this.b=n}function je(){}function Ke(){this.a=new xe}function Be(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.a=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),function(e){var t=Fe;if(null==t){t=!1;try{var n={},i={get:function(){return!(t=!0)}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}Fe=t}return t}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.a)}Re.registerScheme=Ue,Re.unregisterScheme=function(e){delete De[e]},Re.prototype.registerRequestFilter=Re.prototype.eg=function(e){this.a.add(e)},Re.prototype.unregisterRequestFilter=Re.prototype.Fg=function(e){this.a.delete(e)},Re.prototype.clearAllRequestFilters=Re.prototype.Ve=function(){this.a.clear()},Re.prototype.registerResponseFilter=Re.prototype.fg=function(e){this.b.add(e)},Re.prototype.unregisterResponseFilter=Re.prototype.Gg=function(e){this.b.delete(e)},Re.prototype.clearAllResponseFilters=Re.prototype.We=function(){this.b.clear()},Re.defaultRetryParameters=pe,Re.makeRequest=_e,Re.prototype.destroy=Re.prototype.destroy=function(){return this.f=!0,this.a.clear(),this.b.clear(),this.g.destroy()},Re.prototype.request=Re.prototype.request=function(i,e){var r=this,t=new Le;if(this.f){var n=Promise.reject(new me(2,7,7001));return n.catch(function(){}),new Oe(n,function(){return Promise.resolve()},t)}e.method=e.method||"GET",e.headers=e.headers||{},e.retryParameters=e.retryParameters?Ae(e.retryParameters):pe(),e.uris=Ae(e.uris);var a=(n=function(e,t,n){for(var i=we(void 0),r={},a=(e=Y(e.a)).next();!a.done;r={Ad:r.Ad},a=e.next())r.Ad=a.value,i=i.Y(function(e){return function(){return e.Ad(t,n)}}(r));return i.Y(void 0,function(e){if(e&&7001==e.code)throw e;throw new me(2,1,1006,e)})}(this,i,e)).Y(function(){return function t(i,r,n,a,o,s,u){var e=new ie(n.uris[o]),c=e.xa,l=!1;c||(c=location.protocol,c=c.slice(0,-1),V(e,c),n.uris[o]=e.toString());c=c.toLowerCase();var d=(c=De[c])?c.cg:null;if(!d)return ye(new me(2,1,1e3,e));var f;return Te(he(a)).Y(function(){return i.f?be():(f=Date.now(),d(n.uris[o],n,r,function(e,t,n){i.c&&1==r&&(i.c(e,t),l=!0,u.a=n)}))}).Y(function(e){return null==e.timeMs&&(e.timeMs=Date.now()-f),{response:e,Df:l}},function(e){if(e&&7001==e.code)throw e;if(i.f)return be();if(e&&1==e.severity)return i.dispatchEvent(new Ee("retry",{error:e instanceof me?e:null})),o=(o+1)%n.uris.length,t(i,r,n,a,o,e,u);throw e||s})}(r,i,e,new fe(e.retryParameters,!1),0,null,t)}),o=a.Y(function(e){return function(e,t,n){for(var i=we(void 0),r=(e=Y(e.b)).next();!r.done;r=e.next())i=i.Y(r.value.bind(null,t,n.response));return i.Y(function(){return n},function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof me&&(t=e.severity),new me(t,1,1007,e)})}(r,i,e)}),s=Date.now(),u=0;n.promise.then(function(){u=Date.now()-s},function(){});var c=0;return a.promise.then(function(){c=Date.now()},function(){}),n=new Oe((n=o.Y(function(e){var t=Date.now()-c,n=e.response;return n.timeMs+=u,n.timeMs+=t,e.Df||!r.c||n.fromCache||1!=i||r.c(n.timeMs,n.data.byteLength),n},function(e){throw e&&(e.severity=2),e})).promise,n.me,t),Ne(this.g,n),n},Re.NumBytesRemainingClass=Le,b(Oe,ve),(Re.PendingRequest=Oe).all=Se,Oe.notAbortable=Te,Oe.completed=we,Oe.aborted=be,Oe.failed=ye,R("shaka.util.IReleasable",je),je.prototype.release=function(){},R("shaka.util.EventManager",Ke),Ke.prototype.release=Ke.prototype.release=function(){this.hb(),this.a=null},Ke.prototype.listen=Ke.prototype.B=function(e,t,n,i){this.a&&(e=new Be(e,t,n,i),this.a.push(t,e))},Ke.prototype.listenOnce=Ke.prototype.ua=function(n,i,r,e){var a=this;this.B(n,i,function e(t){a.pa(n,i,e),r(t)},e)},Ke.prototype.unlisten=Ke.prototype.pa=function(e,t,n){if(this.a)for(var i=this.a.get(t)||[],r=(i=Y(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.pa(),this.a.remove(t,r))},Ke.prototype.removeAll=Ke.prototype.hb=function(){if(this.a){for(var e=this.a.getAll(),t=(e=Y(e)).next();!t.done;t=e.next())t.value.pa();this.a.a={}}},Be.prototype.unlisten=Be.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a),this.listener=this.target=null,this.a=!1};var Fe=void 0;function He(e){return new ie(e=ut(e)).wa}function Ve(e,t,n){function i(e){new DataView(r.buffer).setUint32(a,e.byteLength,!0),a+=4,r.set(e,a),a+=e.byteLength}if(!n||!n.byteLength)throw new me(2,6,6015);t="string"==typeof t?new Uint8Array(lt(t,!0)):new Uint8Array(t),e=lt(e=ut(e),!0);var r=new Uint8Array(12+e.byteLength+t.byteLength+n.byteLength),a=0;return i(new Uint8Array(e)),i(t),i(new Uint8Array(n)),r}function qe(e,t){for(var n=[],i=Y(e),r=i.next();!r.done;r=i.next())n.push(t(r.value));return n}function Ge(e,t){for(var n=Y(e),i=n.next();!i.done;i=n.next())if(!t(i.value))return!1;return!0}function We(t){var n=new Map;return Object.keys(t).forEach(function(e){n.set(e,t[e])}),n}function ze(e){var n={};return e.forEach(function(e,t){n[t]=e}),n}function Xe(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function Ye(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}R("shaka.util.FairPlayUtils.defaultGetContentId",He),R("shaka.util.FairPlayUtils.initDataTransform",Ve);var $e=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function Je(){return!(!f.MediaSource||!MediaSource.isTypeSupported)}function Qe(e){return""!=it().canPlayType(e)}function Ze(){return nt("Tizen")}function et(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!Ze()}function tt(){if(!et())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return(e=e||navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function nt(e){return(navigator.userAgent||"").includes(e)}function it(){return at||(rt=rt||new de(function(){at=null}),(at=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(at=document.createElement("video")),rt.R(1),at)}var rt=null,at=null;function ot(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=dt(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new me(2,2,2004)}}function st(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw ne.error("Data has an incorrect length, must be even."),new me(2,2,2004);var i=e instanceof ArrayBuffer?e:((n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),n.buffer);e=Math.floor(e.byteLength/2),n=new Uint16Array(e),i=new DataView(i);for(var r=0;r<e;r++)n[r]=i.getUint16(2*r,t);return dt(n)}function ut(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return ot(t);if(254==t[0]&&255==t[1])return st(t.subarray(2),!1);if(255==t[0]&&254==t[1])return st(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&e[t]<=126}.bind(null,t);if(ne.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return st(e,!1);if(0==t[1]&&0==t[3])return st(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return ot(e);throw new me(2,2,2003)}function ct(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function lt(e,t){for(var n=new Uint8Array(2*e.length),i=new DataView(n.buffer),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n.buffer}function dt(e){if(!ft){function t(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}for(var n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(t(n.size)){ft=function(i){return function(e){for(var t="",n=0;n<e.length;n+=i.size)t+=String.fromCharCode.apply(null,e.subarray(n,n+i.size));return t}}(n);break}}return ft(e)}R("shaka.util.StringUtils.fromUTF8",ot),R("shaka.util.StringUtils.fromUTF16",st),R("shaka.util.StringUtils.fromBytesAutoDetect",ut),R("shaka.util.StringUtils.toUTF8",ct),R("shaka.util.StringUtils.toUTF16",lt);var ft=null;R("shaka.util.StringUtils.resetFromCharCode",function(){ft=null});var ht={Hc:function(e,t){var n=dt(e);return t=null==t||t,n=f.btoa(n).replace(/\+/g,"-").replace(/\//g,"_"),t?n:n.replace(/=*$/,"")}};function pt(t,e){var i=this;e=void 0===e?1:e,this.F=t,this.v=new Set,this.h=this.l=null,this.V=!1,this.K=0,this.a=null,this.i=new Ke,this.b=new Map,this.u=[],this.o=new ge,this.f=null,this.g=function(e){i.o.reject(e),t.onError(e)},this.sa=new Map,this.$=new Map,this.T=new de(function(){return t=(e=i).sa,(n=e.$).clear(),t.forEach(function(e,t){return n.set(t,e)}),(t=Array.from(n.values())).length&&t.every(function(e){return"expired"==e})&&e.g(new me(2,6,6014)),void e.F.yc(ze(n));var e,t,n}),this.c=!1,this.qa=new ge,this.G=!1,this.H=[],this.ra=!1,this.ea=new de(function(){var r;(r=i).b.forEach(function(e,t){var n=e.rd,i=t.expiration;isNaN(i)&&(i=1/0),i!=n&&(r.F.onExpirationUpdated(t.sessionId,i),e.rd=i)})}).Ra(e),this.o.catch(function(){})}function mt(e,t,n){return e.u=n,e.G=0<n.length,gt(e,t)}function gt(e,t){var n=function(e){if(0==(e=We(e.f.clearKeys)).size)return null;var r=[],a=[];e.forEach(function(e,t){var n=ht.Yc(t),i=ht.Yc(e),n={kty:"oct",kid:ht.Hc(n,!1),k:ht.Hc(i,!1)};r.push(n),a.push(n.kid)}),e=JSON.stringify({keys:r});var t=JSON.stringify({kids:a});return t=[{initData:new Uint8Array(ct(t)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+f.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t,keyIds:[]}}(e);if(n)for(var i=Y(t),r=i.next();!r.done;r=i.next())r.value.drmInfos=[n];for((n=t.some(function(e){return 0<e.drmInfos.length}))||function(e,t){var n=[];t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var i=Y(e),r=i.next();!r.done;r=i.next())r.value.drmInfos=n}(t,r=We(e.f.servers)),r=(i=Y(t)).next();!r.done;r=i.next())for(var a=(r=Y(r.value.drmInfos)).next();!a.done;a=r.next())Dt(a.value,We(e.f.servers),We(e.f.advanced||{}));return(r=function(e,t){for(var n=new Set,i=Y(t),r=i.next();!r.done;r=i.next()){var a=Y(r.value.drmInfos);for(r=a.next();!r.done;r=a.next())n.add(r.value)}for(i=Y(n),r=i.next();!r.done;r=i.next())Dt(r.value,We(e.f.servers),We(e.f.advanced||{}));a=e.G?"required":"optional";var o=e.G?["persistent-license"]:["temporary"];for(i=new Map,n=Y(n),r=n.next();!r.done;r=n.next())r=r.value,i.set(r.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:a,sessionTypes:o,label:r.keySystem,drmInfos:[]});for(n=Y(t),r=n.next();!r.done;r=n.next()){r=r.value,a=r.audio,o=r.video;var s=a?Xe(a.mimeType,a.codecs):"",u=o?Xe(o.mimeType,o.codecs):"",c=Y(r.drmInfos);for(r=c.next();!r.done;r=c.next()){r=r.value;var l=i.get(r.keySystem);l.drmInfos.push(r),r.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),r.persistentStateRequired&&(l.persistentState="required"),a&&l.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:s}),o&&l.videoCapabilities.push({robustness:r.videoRobustness||"",contentType:u})}}return i}(e,t)).size?(r=Et(e,r),n?r:r.catch(function(){})):(e.V=!0,Promise.resolve())}function vt(n){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:if(n.l&&n.a&&n.a.serverCertificate&&n.a.serverCertificate.length)return Q(e,3),J(e,n.l.setServerCertificate(n.a.serverCertificate),5);e.C(0);break;case 5:e.s||ne.m("Server certificates are not supported by the key system.  The server certificate has been ignored."),Z(e,0);break;case 3:return t=ee(e),e.return(Promise.reject(new me(2,6,6004,t.message)))}})})}function yt(t){var e=t.a?t.a.initData:[];return e.forEach(function(e){return kt(t,e.initDataType,e.initData)}),t.u.forEach(function(e){return xt(t,e)}),e.length||t.u.length||t.o.resolve(),t.o}function bt(e,t,n){for(var i=e.b.values(),r=(i=Y(i)).next();!r.done;r=i.next())if(ht.Da(n,r.value.initData)&&!nt("Tizen 2"))return void ne.debug("Ignoring duplicate init data.");kt(e,t,n)}function wt(e){return e?e.keySystem:""}function Tt(e,t){return nt("Edge/")||e.v.has(t)}function St(e){return e=qe(e=e.b.keys(),function(e){return e.sessionId}),Array.from(e)}function Et(e,f){if(1==f.size&&f.has(""))return Promise.reject(new me(2,6,6e3));for(var t=Y(f.values()),n=t.next();!n.done;n=t.next())0==(n=n.value).audioCapabilities.length&&delete n.audioCapabilities,0==n.videoCapabilities.length&&delete n.videoCapabilities;var r=t=new ge;return[!0,!1].forEach(function(n){var i=this;f.forEach(function(e,t){e.drmInfos.some(function(e){return!!e.licenseServerUri})==n&&(r=r.catch(function(){if(!this.c)return navigator.requestMediaKeySystemAccess(t,[e])}.bind(i)))})}.bind(e)),r=(r=r.catch(function(){return Promise.reject(new me(2,6,6001))})).then(function(e){if(this.c)return Promise.reject();this.v.clear();for(var t=(i=e.getConfiguration()).videoCapabilities||[],n=Y(i.audioCapabilities||[]),i=n.next();!i.done;i=n.next())this.v.add(i.value.contentType);for(i=(t=Y(t)).next();!i.done;i=t.next())this.v.add(i.value.contentType);t=e.keySystem,i=f.get(e.keySystem),n=[];var r,a,o,s,u,c=[],l=[],d=[];return r=i.drmInfos,a=n,o=c,s=l,u=d,r.forEach(function(t){if(a.includes(t.licenseServerUri)||a.push(t.licenseServerUri),t.serverCertificate&&(o.some(function(e){return ht.Da(e,t.serverCertificate)})||o.push(t.serverCertificate)),t.initData&&t.initData.forEach(function(t){s.some(function(e){return!(!e.keyId||e.keyId!=t.keyId)||e.initDataType==t.initDataType&&ht.Da(e.initData,t.initData)})||s.push(t)}),t.keyIds)for(var e=0;e<t.keyIds.length;++e)u.includes(t.keyIds[e])||u.push(t.keyIds[e])}),1<c.length&&ne.m("Multiple unique server certificates found! Only the first will be used."),1<n.length&&ne.m("Multiple unique license server URIs found! Only the first will be used."),this.a={keySystem:t,licenseServerUri:n[0],distinctiveIdentifierRequired:"required"==i.distinctiveIdentifier,persistentStateRequired:"required"==i.persistentState,audioRobustness:(i.audioCapabilities?i.audioCapabilities[0].robustness:"")||"",videoRobustness:(i.videoCapabilities?i.videoCapabilities[0].robustness:"")||"",serverCertificate:c[0],initData:l,keyIds:d},this.a.licenseServerUri?e.createMediaKeys():Promise.reject(new me(2,6,6012,this.a.keySystem))}.bind(e)).then(function(e){if(this.c)return Promise.reject();ne.info("Created MediaKeys object for key system",this.a.keySystem),this.l=e,this.V=!0}.bind(e)).catch(function(e){if(!this.c)return this.a=null,this.v.clear(),e instanceof me?Promise.reject(e):Promise.reject(new me(2,6,6002,e.message))}.bind(e)),t.reject(),r}function xt(t,n){try{ne.D("Attempting to load an offline session",n);var i=t.l.createSession("persistent-license")}catch(e){var r=new me(2,6,6005,e.message);return t.g(r),Promise.reject(r)}t.i.B(i,"message",t.se.bind(t)),t.i.B(i,"keystatuseschange",t.qe.bind(t));var a={initData:null,loaded:!1,rd:1/0,Ca:null};return t.b.set(i,a),i.load(n).then(function(e){return this.c?Promise.reject():(ne.J("Loaded offline session",n,e),e?(a.loaded=!0,Rt(this)&&this.o.resolve(),i):(this.b.delete(i),void this.g(new me(2,6,6013))))}.bind(t),function(e){this.c||(this.b.delete(i),this.g(new me(2,6,6005,e.message)))}.bind(t))}function kt(n,t,e){try{var i=n.G?(ne.D("Creating new persistent session"),n.l.createSession("persistent-license")):(ne.D("Creating new temporary session"),n.l.createSession())}catch(e){return void n.g(new me(2,6,6005,e.message))}n.i.B(i,"message",n.se.bind(n)),n.i.B(i,"keystatuseschange",n.qe.bind(n)),n.b.set(i,{initData:e,loaded:!1,rd:1/0,Ca:null});try{e=n.f.initDataTransform(e,n.a)}catch(e){return(t=e)instanceof me||(t=new me(2,6,6016,e)),void n.g(t)}i.generateRequest(t,e.buffer).catch(function(e){var t;n.c||(n.b.delete(i),e.errorCode&&e.errorCode.systemCode&&((t=e.errorCode.systemCode)<0&&(t+=Math.pow(2,32)),t="0x"+t.toString(16)),n.g(new me(2,6,6006,e.message,e,t)))})}function At(e,t){var n;return wt(t).startsWith("com.apple.fps")&&(n=t.serverCertificate,e=Ve(e,He(e),n)),e}function Mt(e,t){var n=t.target;ne.D("Sending license request for session",n.sessionId,"of type",t.messageType);var i,r,a=e.b.get(n),o=e.a.licenseServerUri,s=e.f.advanced[e.a.keySystem];"individualization-request"==t.messageType&&s&&s.individualizationServer&&(o=s.individualizationServer),(o=_e([o],e.f.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,"com.microsoft.playready"!=e.a.keySystem&&"com.chromecast.playready"!=e.a.keySystem||function(e){var t=st(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){ne.debug("Unwrapping PlayReady request.");for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),i=0;i<n.length;++i)e.headers[n[i].getElementsByTagName("name")[0].textContent]=n[i].getElementsByTagName("value")[0].textContent;e.body=ht.Fa(t.getElementsByTagName("Challenge")[0].textContent).buffer}else ne.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(o),e.a.keySystem.startsWith("com.apple.fps")&&e.f.fairPlayTransform&&(i=o,r=new Uint8Array(i.body),r="spc="+ht.Hc(r),i.headers["Content-Type"]="application/x-www-form-urlencoded",i.body=ct(r));var u=Date.now();e.F.Db.request(2,o).promise.then(function(e){return this.c?Promise.reject():(this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&function(e){try{var t=ot(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=ht.Fa(t).buffer}(e),this.K+=(Date.now()-u)/1e3,ne.D("Updating session",n.sessionId),n.update(e.data).then(function(){var e=this;this.F.onEvent(new Ee("drmsessionupdate")),a&&(a.Ca&&a.Ca.resolve(),new de(function(){a.loaded=!0,Rt(e)&&e.o.resolve()}).R(_t))}.bind(this)))}.bind(e),function(e){this.c||(e=new me(2,6,6007,e),this.g(e),a&&a.Ca&&a.Ca.reject(e))}.bind(e)).catch(function(e){this.c||(e=new me(2,6,6008,e.message),this.g(e),a&&a.Ca&&a.Ca.reject(e))}.bind(e))}function It(){var a=[{videoCapabilities:e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],o=new Map,e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(e){return r=e,$(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return Q(e,2),J(e,navigator.requestMediaKeySystemAccess(r,a),4);case 4:return t=e.s,i=!!(n=t.getConfiguration().sessionTypes)&&n.includes("persistent-license"),nt("Tizen 3")&&(i=!1),o.set(r,{persistentState:i}),J(e,t.createMediaKeys(),5);case 5:Z(e,0);break;case 2:ee(e),o.set(r,null),K(e)}})});var r});return Promise.all(e).then(function(){return ze(o)})}function Pt(e,t){var n=t.audio,i=t.video;if(n&&n.encrypted&&!Tt(e,Xe(n.mimeType,n.codecs))||i&&i.encrypted&&!Tt(e,Xe(i.mimeType,i.codecs)))return!1;var r=wt(e.a);return 0==t.drmInfos.length||t.drmInfos.some(function(e){return e.keySystem==r})}function Ct(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=0;i<e.length;i++)for(var r=0;r<t.length;r++)if(e[i].keySystem==t[r].keySystem){var a=e[i],r=t[r],o=[];o=(o=o.concat(a.initData||[])).concat(r.initData||[]);var s=[];s=(s=s.concat(a.keyIds)).concat(r.keyIds),n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||r.persistentStateRequired,videoRobustness:a.videoRobustness||r.videoRobustness,audioRobustness:a.audioRobustness||r.audioRobustness,serverCertificate:a.serverCertificate||r.serverCertificate,initData:o,keyIds:s});break}return n}function Nt(n){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return t=Array.from(n.b.keys()),n.b.clear(),J(e,Promise.all(t.map(function(t){return $(function e(){return te(e,function(e){switch(e.j){case 1:return ne.D("Closing session",t.sessionId),Q(e,2),J(e,(n=t,$(function e(){var t;return te(e,function(e){switch(e.j){case 1:return t=new Promise(function(e,t){new de(t).R(Ut)}),Q(e,2),J(e,Promise.race([Promise.all([n.close(),n.closed]),t]),4);case 4:Z(e,0);break;case 2:ee(e),ne.m("Timeout waiting for session close"),K(e)}})})),4);case 4:Z(e,0);break;case 2:ee(e),K(e)}var n})})})),0)}})})}function Rt(e){return Ge(e=e.b.values(),function(e){return e.loaded})}function Dt(e,t,n){!e.keySystem||"org.w3.clearkey"==e.keySystem&&e.licenseServerUri||(t.size&&(t=t.get(e.keySystem)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=[]),(n=n.get(e.keySystem))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=n.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=n.persistentStateRequired),e.videoRobustness||(e.videoRobustness=n.videoRobustness),e.audioRobustness||(e.audioRobustness=n.audioRobustness),e.serverCertificate||(e.serverCertificate=n.serverCertificate)),f.cast&&f.cast.__platform__&&"com.microsoft.playready"==e.keySystem&&(e.keySystem="com.chromecast.playready"))}R("shaka.util.Uint8ArrayUtils.toBase64",ht.Hc),ht.Fa=function(e){e=f.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t},R("shaka.util.Uint8ArrayUtils.fromBase64",ht.Fa),ht.Yc=function(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2)t[n/2]=f.parseInt(e.substr(n,2),16);return t},R("shaka.util.Uint8ArrayUtils.fromHex",ht.Yc),ht.Ic=function(e){for(var t="",n=0;n<e.length;++n){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t},R("shaka.util.Uint8ArrayUtils.toHex",ht.Ic),ht.Da=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0},R("shaka.util.Uint8ArrayUtils.equal",ht.Da),ht.concat=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var i=n=0;i<t.length;++i)n+=t[i].length;n=new Uint8Array(n);for(var r=i=0;r<t.length;++r)n.set(t[r],i),i+=t[r].length;return n},R("shaka.util.Uint8ArrayUtils.concat",ht.concat),(n=pt.prototype).destroy=function(){var n=this;return $(function e(){return te(e,function(e){switch(e.j){case 1:return n.c?J(e,n.qa,0):(n.c=!0,J(e,(t=n,$(function e(){return te(e,function(e){switch(e.j){case 1:return t.i.release(),t.i=null,t.o.reject(),t.ea.stop(),t.ea=null,t.T.stop(),t.T=null,J(e,Nt(t),2);case 2:if(t.h)return Q(e,4),J(e,t.h.setMediaKeys(null),6);e.C(3);break;case 6:Z(e,5);break;case 4:ee(e);case 5:t.h=null;case 3:t.a=null,t.v.clear(),t.l=null,t.u=[],t.f=null,t.g=null,t.F=null,K(e)}})})),4));case 4:n.qa.resolve(),e.C(0)}var t})})},n.configure=function(e){this.f=e},n.Qb=function(e){var t=this;if(!this.l)return this.i.ua(e,"encrypted",function(){t.g(new me(2,6,6010))}),Promise.resolve();this.h=e,this.i.ua(this.h,"play",function(){for(var e=0;e<t.H.length;e++)Mt(t,t.H[e]);t.ra=!0,t.H=[]}),"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Nt(t)}),e=(e=this.h.setMediaKeys(this.l)).catch(function(e){return Promise.reject(new me(2,6,6003,e.message))});var n=vt(this);return Promise.all([e,n]).then(function(){if(t.c)return Promise.reject();yt(t),t.a.initData.length||t.u.length||t.i.B(t.h,"encrypted",function(e){return bt(t,e.initDataType,new Uint8Array(e.initData))})}).catch(function(e){if(!t.c)return Promise.reject(e)})},n.Tb=function(){for(var e=1/0,t=this.b.keys(),n=(t=Y(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},n.se=function(e){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(e):Mt(this,e)},n.qe=function(e){e=e.target,ne.J("Key status changed for session",e.sessionId);var o=this.b.get(e),s=!1;e.keyStatuses.forEach(function(e,t){var n,i,r,a;"string"==typeof t&&(n=t,t=e,e=n),"com.microsoft.playready"!=this.a.keySystem||16!=t.byteLength||Ze()||nt("VITIS")||nt("Web0S")||nt("TiVo")||(i=(n=new DataView(t)).getUint32(0,!0),r=n.getUint16(4,!0),a=n.getUint16(6,!0),n.setUint32(0,i,!1),n.setUint16(4,r,!1),n.setUint16(6,a,!1)),"com.microsoft.playready"==this.a.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(o.loaded=!0),"expired"==e&&(s=!0),n=ht.Ic(new Uint8Array(t)),this.sa.set(n,e)}.bind(this));var t=e.expiration-Date.now();(t<0||s&&t<1e3)&&o&&!o.Ca&&(ne.debug("Session has expired",e.sessionId),this.b.delete(e),e.close().catch(function(){})),Rt(this)&&(this.o.resolve(),this.T.R(Lt))};var Ut=1,_t=5,Lt=.5;function Ot(){this.a=new muxjs.mp4.CaptionParser,this.g=[],this.f={}}function jt(){}function Kt(e){return e&&!(1==e.length&&e.end(0)-e.start(0)<1e-6)&&e.length?e.end(e.length-1):null}function Bt(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6||t>e.end(e.length-1))&&t+n>=e.start(0)}function Ft(e,t){if(!e||!e.length||1==e.length&&e.end(0)-e.start(0)<1e-6)return 0;for(var n=0,i=e.length-1;0<=i&&e.end(i)>t;--i)n+=e.end(i)-Math.max(e.start(i),t);return n}function Ht(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}Ot.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.g=t.videoTrackIds(e),this.f=t.timescale(e),this.a.init()},Ot.prototype.b=function(e,t){var n=new Uint8Array(e);(n=this.a.parse(n,this.g,this.f))&&n.captions&&t(n.captions),this.a.clearParsedCaptions()},Ot.prototype.c=function(){this.a.resetCaptionStream()},jt.prototype.init=function(){},jt.prototype.b=function(){},jt.prototype.c=function(){};var Vt={Xe:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},Oc:function(e,t){return e.concat(t)},wc:function(){},Ma:function(e){return null!=e}};function qt(e,t){if(0==t.length)return e;var n=t.map(function(e){return new ie(e)});return e.map(function(e){return new ie(e)}).map(function(e){return n.map(e.resolve.bind(e))}).reduce(Vt.Oc,[]).map(function(e){return e.toString()})}function Gt(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var Wt={Ua:"video",Nb:"audio",va:"text",Mg:"image",Kg:"application"},zt=1/15;function Xt(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.b=null,this.g=[],this.c=[],this.f=!1,this.a.on("data",this.i.bind(this)),this.a.on("done",this.h.bind(this))}function Yt(e,t){return!(!f.muxjs||"mp2t"!=e.toLowerCase().split(";")[0].split("/")[1])&&(t?MediaSource.isTypeSupported($t(t,e)):MediaSource.isTypeSupported($t("audio",e))||MediaSource.isTypeSupported($t("video",e)))}function $t(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var i,r,a,o=/avc1\.(66|77|100)\.(\d+)/.exec(n);return o&&(a="avc1.",a=("66"==(i=o[1])?a+"4200":"77"==i?a+"4d00":a+"6400")+((r=Number(o[2]))>>4).toString(16),a+=(15&r).toString(16),n=n.replace(o[0],a)),n}function Jt(e,t,n){this.startTime=e,this.direction=rn,this.endTime=t,this.payload=n,this.region=new fn,this.position=null,this.positionAlign=Qt,this.size=0,this.textAlign=Zt,this.writingMode=an,this.lineInterpretation=on,this.line=null,this.lineHeight="",this.lineAlign=sn,this.displayAlign=tn,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=cn,this.fontStyle=ln,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}Xt.prototype.destroy=function(){return this.a.dispose(),this.a=null,Promise.resolve()},Xt.prototype.i=function(e){this.c=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.g.push(t)},Xt.prototype.h=function(){var e={data:ht.concat.apply(null,this.g),captions:this.c};this.b.resolve(e),this.f=!1},R("shaka.text.Cue",Jt);var Qt="auto";Jt.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Qt};var Zt="center",en={LEFT:"left",RIGHT:"right",CENTER:Zt,START:"start",END:"end"};Jt.textAlign=en;var tn="after",nn={BEFORE:"before",CENTER:"center",AFTER:tn};Jt.displayAlign=nn;var rn="ltr";Jt.direction={HORIZONTAL_LEFT_TO_RIGHT:rn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var an="horizontal-tb";Jt.writingMode={HORIZONTAL_TOP_TO_BOTTOM:an,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var on=0;Jt.lineInterpretation={LINE_NUMBER:on,PERCENTAGE:1};var sn="start",un={CENTER:"center",START:sn,END:"end"};Jt.lineAlign=un;var cn=400;Jt.fontWeight={NORMAL:cn,BOLD:700};var ln="normal",dn={NORMAL:ln,ITALIC:"italic",OBLIQUE:"oblique"};function fn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=hn,this.scroll=pn}Jt.fontStyle=dn,Jt.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},R("shaka.text.CueRegion",fn);var hn=1;fn.units={PX:0,PERCENTAGE:hn,LINES:2};var pn="";function mn(e){this.g=null,this.c=e,this.f=this.o=0,this.h=1/0,this.b=this.a=null,this.l="",this.i=new Map}fn.scrollMode={NONE:pn,UP:"up"};var gn={};function vn(e){return!!(gn[e]||f.muxjs&&"application/cea-608"==e)}function yn(e,t){"application/cea-608"!=t&&(e.g=new gn[t])}function bn(e,t,n,i,r){for(var a=n+" "+i,o=new Map,s=(t=Y(t)).next();!s.done;s=t.next()){var u=s.value,s=u.stream;o.has(s)||o.set(s,new Map),o.get(s).has(a)||o.get(s).set(a,[]),u.startTime+=r,u.endTime+=r,u.startTime>=e.f&&u.startTime<e.h&&(u=new Jt(u.startTime,u.endTime,u.text),o.get(s).get(a).push(u),s==e.l&&e.c.append([u]))}for(a=(r=Y(o.keys())).next();!a.done;a=r.next())for(a=a.value,e.i.has(a)||e.i.set(a,new Map),s=(t=Y(o.get(a).keys())).next();!s.done;s=t.next())s=s.value,u=o.get(a).get(s),e.i.get(a).set(s,u);e.a=null==e.a?Math.max(n,e.f):Math.min(e.a,Math.max(n,e.f)),e.b=Math.max(e.b,Math.min(i,e.h))}function wn(e,t,n){this.f=e,this.g=n,this.b={},this.a=null,this.c={},this.i=new Ke,this.v=!1,this.l={},this.o=t,e=this.u=new ge,t=new MediaSource,this.i.ua(t,"sourceopen",e.resolve),this.f.src=Tn(t),this.h=t}R("shaka.text.TextEngine.registerParser",function(e,t){gn[e]=t}),R("shaka.text.TextEngine.unregisterParser",function(e){delete gn[e]}),mn.prototype.destroy=function(){return this.c=this.g=null,this.i.clear(),Promise.resolve()},mn.prototype.sc=function(e){try{return this.g.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new me(2,2,2009,e)}},mn.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.c||!this.c.remove(e,t)||null==this.a||t<=this.a||e>=this.b||(e<=this.a&&t>=this.b?this.a=this.b=null:e<=this.a&&t<this.b?this.a=t:e>this.a&&t>=this.b&&(this.b=e))}.bind(this))};var Tn=f.URL.createObjectURL;function Sn(e){var i,r,t=Xe(e.mimeType,e.codecs),n=(r=[(i=e).mimeType],$e.forEach(function(e,t){var n=i[t];n&&r.push(e+'="'+n+'"')}),r.join(";"));return vn(t)||MediaSource.isTypeSupported(n)||Yt(t,e.type)}function En(e,t){e.a||(e.a=new mn(e.g)),yn(e.a,t)}function xn(e){return!e.h||"ended"==e.h.readyState}function kn(e,t){var n="text"==t?e.a.a:!(n=Mn(e,t))||1==n.length&&n.end(0)-n.start(0)<1e-6?null:1==n.length&&n.start(0)<0?0:n.length?n.start(0):null;return n}function An(e,t){return"text"==t?e.a.b:Kt(Mn(e,t))}function Mn(t,n){try{return t.b[n].buffered}catch(e){return n in t.b&&ne.error("failed to get buffered range for "+n,e),null}}function In(t,n,e,i,r,a){return"text"==n?(o=t.a,s=e,u=i,c=r,Promise.resolve().then(function(){var e;this.g&&this.c&&(null==u||null==c?this.g.parseInit(new Uint8Array(s)):(e={periodStart:this.o,segmentStart:u,segmentEnd:c},e=this.g.parseMedia(new Uint8Array(s),e).filter(function(e){return e.startTime>=this.f&&e.startTime<this.h}.bind(this)),this.c.append(e),null==this.a&&(this.a=Math.max(u,this.f)),this.b=Math.min(c,this.h)))}.bind(o))):t.l[n]?function(e,t){e.f=!0,e.b=new ge,e.g=[],e.c=[];var n=new Uint8Array(t);return e.a.push(n),e.a.flush(),e.f&&e.b.reject(new me(2,3,3018)),e.b}(t.l[n],e).then(function(e){return this.a||En(this,"text/vtt"),e.captions&&e.captions.length&&bn(this.a,e.captions,i,r,this.b.video.timestampOffset),Nn(this,n,this.Ee.bind(this,n,e.data.buffer))}.bind(t)):(a&&f.muxjs&&(t.a||En(t,"text/vtt"),null==i&&null==r?t.o.init(e):t.o.b(e,function(e){e.length&&bn(t.a,e,i,r,t.b.video.timestampOffset)})),Nn(t,n,t.Ee.bind(t,n,e)));var o,s,u,c}function Pn(e,t){var n=An(e,"video")||0;!function(e,t,n){if(e.l=t,t=e.i.get(t))for(var i=Y(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter(function(e){return e.endTime<=n}))&&e.c.append(r)}(e.a,t,n)}function Cn(e,t){return"text"==t?e.a?(e.o.c(),e.a.remove(0,1/0)):Promise.resolve():Nn(e,t,e.Fe.bind(e,t,0,e.h.duration))}function Nn(t,n,i){if(t.v)return Promise.reject();if(i={start:i,p:new ge},t.c[n].push(i),1==t.c[n].length)try{i.start()}catch(e){"QuotaExceededError"==e.name?i.p.reject(new me(2,3,3017,n)):i.p.reject(new me(2,3,3015,e)),Dn(t,n)}return i.p}function Rn(e,n){if(e.v)return Promise.reject();var t,i=[];for(t in e.b){var r=new ge,a={start:function(e){e.resolve()}.bind(null,r),p:r};e.c[t].push(a),i.push(r),1==e.c[t].length&&a.start()}return Promise.all(i).then(function(){try{n()}catch(e){var t=Promise.reject(new me(2,3,3015,e))}for(var e in this.b)Dn(this,e);return t}.bind(e),function(e){throw e}.bind(e))}function Dn(t,n){t.c[n].shift();var i=t.c[n][0];if(i)try{i.start()}catch(e){i.p.reject(new me(2,3,3015,e)),Dn(t,n)}}function Un(e,t){return e=Ln(e),t=Ln(t),e.split("-")[0]==t.split("-")[0]}function _n(e,t){e=Ln(e),t=Ln(t);var n=e.split("-"),i=t.split("-");return n[0]==i[0]&&1==n.length&&2==i.length}function Ln(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=Kn.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function On(e){return e.language?Ln(e.language):e.audio&&e.audio.language?Ln(e.audio.language):e.video&&e.video.language?Ln(e.video.language):"und"}function jn(e,t){for(var n=Ln(e),i=new Set,r=Y(t),a=r.next();!a.done;a=r.next())i.add(Ln(a.value));for(a=(r=Y(i)).next();!a.done;a=r.next())if((a=a.value)==n)return a;for(a=(r=Y(i)).next();!a.done;a=r.next())if(_n(a=a.value,n))return a;for(a=(r=Y(i)).next();!a.done;a=r.next()){var o=n,s=Ln(s=a=a.value),o=Ln(o);if(s=s.split("-"),o=o.split("-"),2==s.length&&2==o.length&&s[0]==o[0])return a}for(a=(i=Y(i)).next();!a.done;a=i.next())if(_n(n,r=a.value))return r;return null}(n=wn.prototype).destroy=function(){var e=this;this.v=!0;var t,n=[];for(t in this.c){var i=this.c[t],r=i[0];for(this.c[t]=i.slice(0,1),r&&n.push(r.p.catch(Vt.wc)),r=1;r<i.length;++r)i[r].p.reject()}for(var a in this.a&&n.push(this.a.destroy()),this.g&&n.push(this.g.destroy()),this.l)n.push(this.l[a].destroy());return Promise.all(n).then(function(){e.i&&(e.i.release(),e.i=null),e.f&&(e.f.removeAttribute("src"),e.f.load(),e.f=null),e.h=null,e.a=null,e.g=null,e.b={},e.l={},e.o=null,e.c={}})},n.init=function(t,r){var a=this;return $(function e(){var i;return te(e,function(e){switch(e.j){case 1:return i=Wt,J(e,a.u,2);case 2:t.forEach(function(e,t){var n=Xe(e.mimeType,e.codecs);t==i.va?En(a,n):(!r&&MediaSource.isTypeSupported(n)||!Yt(n,t)||(a.l[t]=new Xt,n=$t(t,n)),n=a.h.addSourceBuffer(n),a.i.B(n,"error",a.vg.bind(a,t)),a.i.B(n,"updateend",a.Gb.bind(a,t)),a.b[t]=n,a.c[t]=[])}),K(e)}})})},n.$c=function(e){var t,n;e.total=Ht(this.f.buffered),e.audio=Ht(Mn(this,"audio")),e.video=Ht(Mn(this,"video")),e.text=[],this.a&&(t=this.a.a,n=this.a.b,null!=t&&null!=n&&e.text.push({start:t,end:n}))},n.remove=function(e,t,n){return"text"==e?this.a.remove(t,n):Nn(this,e,this.Fe.bind(this,e,t,n))},n.flush=function(e){return"text"==e?Promise.resolve():Nn(this,e,this.bf.bind(this,e))},n.endOfStream=function(e){return Rn(this,function(){xn(this)||(e?this.h.endOfStream(e):this.h.endOfStream())}.bind(this))},n.Ba=function(e){return Rn(this,function(){this.h.duration=e}.bind(this))},n.ca=function(){return this.h.duration},n.Ee=function(e,t){this.b[e].appendBuffer(t)},n.Fe=function(e,t,n){n<=t?this.Gb(e):this.b[e].remove(t,n)},n.Oe=function(e){var t=this.b[e].appendWindowStart,n=this.b[e].appendWindowEnd;this.b[e].abort(),this.b[e].appendWindowStart=t,this.b[e].appendWindowEnd=n,this.Gb(e)},n.bf=function(e){this.f.currentTime-=.001,this.Gb(e)},n.ug=function(e,t){t<0&&(t+=.001),this.b[e].timestampOffset=t,this.Gb(e)},n.rg=function(e,t,n){this.b[e].appendWindowStart=0,this.b[e].appendWindowEnd=n,this.b[e].appendWindowStart=t,this.Gb(e)},n.vg=function(e){this.c[e][0].p.reject(new me(2,3,3014,this.f.error?this.f.error.code:0))},n.Gb=function(e){var t=this.c[e][0];t&&(t.p.resolve(),Dn(this,e))};var Kn=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),Bn={Vd:function(e,t){function n(e){var t="";e.video&&(t=Ye(e.video.codecs)[0]);var n="";return e.audio&&(n=Ye(e.audio.codecs)[0]),t+"-"+n}for(var i=e.periods.reduce(function(e,t){return e.concat(t.variants)},[]),i=Bn.$d(i,t),r=new xe,a=(i=Y(i)).next();!a.done;a=i.next()){var o=n(a=a.value);r.push(o,a)}var s=null,u=1/0;for(r.forEach(function(e,t){for(var n=0,i=0,r=Y(t),a=r.next();!a.done;a=r.next())n+=a.value.bandwidth||0,++i;n/=i,ne.debug("codecs",e,"avg bandwidth",n),n<u&&(s=e,u=n)}),i=(r=Y(e.periods)).next();!i.done;i=r.next())(i=i.value).variants=i.variants.filter(function(e){return n(e)==s||(ne.debug("Dropping Variant (better codec available)",e),!1)})},ld:function(e,t,n){function i(e,t,n){return t<=e&&e<=n}var r=e.video;return!(r&&r.width&&r.height&&(!i(r.width,t.minWidth,Math.min(t.maxWidth,n.width))||!i(r.height,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))},Sd:function(e,n,i){var r=!1;return e.forEach(function(e){var t=e.allowedByApplication;e.allowedByApplication=Bn.ld(e,n,i),t!=e.allowedByApplication&&(r=!0)}),r},filterNewPeriod:function(n,i,r,e){e.variants=e.variants.filter(function(e){if(n&&n.V&&!Pt(n,e))return ne.debug("Dropping variant - not compatible with key system",e),!1;var t=e.audio;return e=e.video,t&&!Sn(t)?(ne.debug("Dropping variant - audio not compatible with platform",Bn.yb(t)),!1):e&&!Sn(e)?(ne.debug("Dropping variant - video not compatible with platform",Bn.yb(e)),!1):t&&i&&!Bn.Td(t,i)?(ne.debug("Droping variant - not compatible with active audio","active audio",Bn.yb(i),"variant.audio",Bn.yb(t)),!1):!(e&&r&&!Bn.Td(e,r))||(ne.debug("Droping variant - not compatible with active video","active video",Bn.yb(r),"variant.video",Bn.yb(e)),!1)}),e.textStreams=e.textStreams.filter(function(e){var t=vn(Xe(e.mimeType,e.codecs));return t||ne.debug("Dropping text stream. Is not supported by the platform.",e),t})},Td:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},Qd:function(e){var t=e.audio,n=e.video,i=t?t.codecs:null,r=n?n.codecs:null,a=[];r&&a.push(r),i&&a.push(i);var o=[];n&&o.push(n.mimeType),t&&o.push(t.mimeType),o=o[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach(function(e){return u.add(e)}),n&&n.roles.forEach(function(e){return u.add(e)}),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:o,codecs:a.join(", "),audioCodec:i,videoCodec:r,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},Fc:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},ed:function(e){return e.__shaka_id||(e.__shaka_id=Bn.Kf++),e.__shaka_id},Kf:0,Ef:function(e){var t=Bn.ee(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},de:function(e){var t=Bn.ee(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},ee:function(e){return{id:Bn.ed(e),active:!1,type:"",bandwidth:0,language:Ln(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},sf:function(e){return e.filter(function(e){return Bn.Bb(e)})},$d:function(e,t){for(var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),i=new Map,r=(n=Y(n)).next();!r.done;r=n.next()){var a=(r=r.value).audio.channelsCount;i.has(a)||i.set(a,[]),i.get(a).push(r)}return 0==(n=Array.from(i.keys())).length?e:(r=n.filter(function(e){return e<=t})).length?i.get(Math.max.apply(null,r)):i.get(Math.min.apply(null,n))},Sb:function(e,t,n){var i=e,r=e.filter(function(e){return e.primary});r.length&&(i=r);var a,o=i.length?i[0].language:"",i=i.filter(function(e){return e.language==o});if(!t||(a=jn(Ln(t),e.map(function(e){return e.language})))&&(i=e.filter(function(e){return Ln(e.language)==a})),n){if((e=Bn.Zd(i,n)).length)return e;ne.m("No exact match for the text role could be found.")}else if((e=i.filter(function(e){return 0==e.roles.length})).length)return e;return(e=i.map(function(e){return e.roles}).reduce(Vt.Oc,[])).length?Bn.Zd(i,e[0]):i},Zd:function(e,t){return e.filter(function(e){return e.roles.includes(t)})},ce:function(e,t,n){for(var i=0;i<n.length;i++)if(n[i].audio==e&&n[i].video==t)return n[i];return null},Ff:function(e){return"audio"==e.type},If:function(e){return"video"==e.type},Bf:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},yb:function(e){return Bn.Ff(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:Bn.If(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function Fn(){this.h=null,this.c=!1,this.b=new F,this.g=[],this.i=!1,this.a=this.f=null}function Hn(t,e){return t&&(e=e.filter(function(e){return Bn.ld(e,t,{width:1/0,height:1/0})})),e.sort(function(e,t){return e.bandwidth-t.bandwidth})}function Vn(e,t){this.a=e,this.b=t}function qn(e,t){var n=new Vn(2,6),i=zn.a,r=n.b-i.b;(0<(n.a-i.a||r)?zn.c:zn.b)(zn.a,n,e,t)}function Gn(e,t,n,i){ne.Z([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function Wn(e,t,n,i){ne.jc([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(""))}R("shaka.abr.SimpleAbrManager",Fn),Fn.prototype.stop=Fn.prototype.stop=function(){this.h=null,this.c=!1,this.g=[],this.f=null},Fn.prototype.init=Fn.prototype.init=function(e){this.h=e},Fn.prototype.chooseVariant=Fn.prototype.chooseVariant=function(){var e=Hn(this.a.restrictions,this.g),t=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!e.length&&(ne.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=Hn(null,this.g))[0]]);for(var n=e[0]||null,i=0;i<e.length;++i){var r=e[i],a=r.bandwidth/this.a.bandwidthDowngradeTarget,o=(e[i+1]||{bandwidth:1/0}).bandwidth/this.a.bandwidthUpgradeTarget;ne.J("Bandwidth ranges:",(r.bandwidth/1e6).toFixed(3),(a/1e6).toFixed(3),(o/1e6).toFixed(3)),a<=t&&t<=o&&(n=r)}return this.f=Date.now(),n},Fn.prototype.enable=Fn.prototype.enable=function(){this.c=!0},Fn.prototype.disable=Fn.prototype.disable=function(){this.c=!1},Fn.prototype.segmentDownloaded=Fn.prototype.segmentDownloaded=function(e,t){ne.J("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.f,"enabled="+this.c);var n,i,r=this.b;if(t<16e3||(n=8e3*t/e,i=e/1e3,r.a+=t,j(r.b,i,n),j(r.c,i,n)),null!=this.f&&this.c)e:{if(ne.J("Suggesting Streams..."),this.i){if(Date.now()-this.f<1e3*this.a.switchInterval){ne.J("Still within switch interval...");break e}}else{if(!(128e3<=this.b.a)){ne.J("Still waiting for a good estimate...");break e}this.i=!0}r=this.chooseVariant(),n=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate),ne.debug("Calling switch_(), bandwidth="+Math.round(n/1e3)+" kbps"),this.h(r)}},Fn.prototype.getBandwidthEstimate=Fn.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)},Fn.prototype.setVariants=Fn.prototype.setVariants=function(e){this.g=e},Fn.prototype.configure=Fn.prototype.configure=function(e){this.a=e},Vn.prototype.toString=function(){return"v"+this.a+"."+this.b};var zn=null,Xn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Yn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),$n=["loop","playbackRate"],Jn=["pause","play"],Qn="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),Zn={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},ei={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},ti=[["getConfiguration","configure"]],ni=[["isTextTrackVisible","setTextTrackVisibility"]],ii="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),ri=["attach","detach","load","unload"];function ai(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Ee){var n={};for(r in t){var i=t[r];i&&"object"==typeof i?"detail"==r&&(n[r]=i):r in Event||(n[r]=i)}return n}if(t instanceof Error){var r=new Set(["name","message","stack"]);for(n in t)r.add(n);for(n=(i=Y(Object.getOwnPropertyNames(t))).next();!n.done;n=i.next())r.add(n.value);for(i={},n=(r=Y(r)).next();!n.done;n=r.next())i[n=n.value]=t[n];r={__type__:"Error",contents:i}}else if(t instanceof TimeRanges)for(r={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=0;n<t.length;++n)r.start.push(t.start(n)),r.end.push(t.end(n));else r=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:t<0?"-Infinity":"Infinity":t;return r}})}function oi(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n={length:(a=t).length,start:function(e){return a.start[e]},end:function(e){return a.end[e]}};else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){n=t.contents;var i,r=Error(n.message);for(i in n)r[i]=n[i];n=r}else n=t;var a;return n})}function si(e,t,n,i,r,a){this.T=e,this.f=new de(t),this.V=n,this.l=!1,this.v=i,this.K=r,this.G=a,this.b=this.h=!1,this.H="",this.i=null,this.o=this.sd.bind(this),this.u=this.Rf.bind(this),this.a={video:{},player:{}},this.F=0,this.c={},this.g=null,pi.add(this)}var ui=!1,ci=null;function li(e,t){ne.debug("CastSender: onExistingSessionJoined");var n=e.G();e.g=new ge,e.l=!0,e.ud(n,t)}function di(e){var t=ci;t.removeUpdateListener(e.o),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.u)}function fi(e){for(var t in e.c){var n=e.c[t];delete e.c[t],n.reject(new me(1,7,7e3))}}function hi(t,e){var n=ai(e),i=ci;try{i.sendMessage("urn:x-cast:com.google.shaka.v2",n,function(){},ne.error)}catch(e){throw ne.error("Cast session sendMessage threw",e),n=new me(2,8,8005,e),t.v("player",new Ee("error",{detail:n})),t.vb(),n}}(n=si.prototype).destroy=function(){return pi.delete(this),fi(this),ci&&di(this),this.f&&(this.f.stop(),this.f=null),this.K=this.v=null,this.b=this.h=!1,this.u=this.o=this.g=this.c=this.a=this.i=null,Promise.resolve()},n.ha=function(){return this.b},n.xd=function(){return this.H},n.init=function(){var e;f.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.T.length&&(this.h=!0,this.f.Gc(),e=new chrome.cast.SessionRequest(this.T),e=new chrome.cast.ApiConfig(e,function(e){for(var t=Y(pi),n=t.next();!n.done;n=t.next())li(n.value,e)}.bind(this),function(e){for(var t=Y(pi),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;ne.debug("CastSender: receiver status",i),ui="available"==i,n.f.Gc()}}.bind(this),"origin_scoped"),chrome.cast.initialize(e,function(){ne.debug("CastSender: init")},function(e){ne.error("CastSender: init error",e)}),ui&&this.f.R(.02),(e=ci)&&e.status!=chrome.cast.SessionStatus.STOPPED?(ne.debug("CastSender: re-using existing connection"),li(this,e)):ci=null)},n.Gd=function(e){this.i=e,this.b&&hi(this,{type:"appData",appData:this.i})},n.cast=function(e){return this.h?ui?this.b?Promise.reject(new me(1,8,8002)):(this.g=new ge,chrome.cast.requestSession(this.ud.bind(this,e),this.pe.bind(this)),this.g):Promise.reject(new me(1,8,8001)):Promise.reject(new me(1,8,8e3))},n.vb=function(){if(this.b){if(fi(this),ci){di(this);try{ci.stop(function(){},function(){})}catch(e){}ci=null}this.sd()}},n.get=function(e,t){if("video"==e){if(Jn.includes(t))return this.ye.bind(this,e,t)}else if("player"==e){if(ei[t]&&!this.get("player","isLive")())return function(){};if(ii.includes(t))return this.ye.bind(this,e,t);if(ri.includes(t))return this.hg.bind(this,e,t);if(Zn[t])return this.ve.bind(this,e,t)}return this.ve(e,t)},n.set=function(e,t,n){this.a[e][t]=n,hi(this,{type:"set",targetName:e,property:t,value:n})},n.ud=function(e,t){ne.debug("CastSender: onSessionInitiated"),(ci=t).addUpdateListener(this.o),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u),this.sd(),hi(this,{type:"init",initState:e,appData:this.i}),this.g.resolve()},n.pe=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.g.reject(new me(2,8,t,e))},n.ve=function(e,t){return this.a[e][t]},n.ye=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];hi(this,{type:"call",targetName:e,methodName:t,args:i})},n.hg=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];r=new ge;var a=this.F.toString();this.F++,this.c[a]=r;try{hi(this,{type:"asyncCall",targetName:e,methodName:t,args:i,id:a})}catch(e){r.reject(e)}return r},n.sd=function(){var e=!!ci&&"connected"==ci.status;if(ne.debug("CastSender: connection status",e),this.b&&!e){for(var t in this.K(),this.a)this.a[t]={};fi(this)}this.H=(this.b=e)?ci.receiver.friendlyName:"",this.f.Gc()},n.Rf=function(e,t){var n=oi(t);switch(ne.J("CastSender: message",n),n.type){case"event":var i=n.event;this.v(n.targetName,new Ee(i.type,i));break;case"update":for(var r in i=n.update)for(var a in n=this.a[r]||{},i[r])n[a]=i[r][a];this.l&&(this.V(),this.l=!1);break;case"asyncComplete":if(r=n.id,n=n.error,a=this.c[r],delete this.c[r],a)if(n){for(i in r=new me(n.severity,n.category,n.code),n)r[i]=n[i];a.reject(r)}else a.resolve()}};var pi=new Set;function mi(e,t,n){var i=this;ke.call(this),this.c=e,this.b=t,this.i=this.g=this.f=this.l=this.h=null,this.u=n,this.o=new Map,this.a=new si(n,function(){return yi(i)},function(){return bi(i)},function(e,t){return Ti(i,e,t)},function(){return wi(i)},function(){return vi(i)}),function(t){for(var e in t.a.init(),t.i=new Ke,Xn.forEach(function(e){this.i.B(this.c,e,this.G.bind(this))}.bind(t)),Qn.forEach(function(e){this.i.B(this.b,e,this.v.bind(this))}.bind(t)),t.h={},t.c)Object.defineProperty(t.h,e,{configurable:!1,enumerable:!0,get:t.F.bind(t,e),set:t.H.bind(t,e)});t.l={},gi(t,function(e){Object.defineProperty(t.l,e,{configurable:!1,enumerable:!0,get:function(){return function e(t,n){t.o.has(n)&&(n=t.o.get(n));if("addEventListener"==n)return t.g.addEventListener.bind(t.g);if("removeEventListener"==n)return t.g.removeEventListener.bind(t.g);if("getMediaElement"==n)return function(){return this.h}.bind(t);if("getSharedConfiguration"==n)return ne.m("Can't share configuration across a network. Returning copy."),t.a.get("player","getConfiguration");if("getNetworkingEngine"==n)return t.a.ha()&&ne.m("NOTE: getNetworkingEngine() is always local!"),t.b.Ub.bind(t.b);if(t.a.ha()){if("getManifest"==n||"drmInfo"==n)return function(){return ne.Z(n+"() does not work while casting!"),null};if("getManifestUri"==n)return qn("getManifestUri",'Please use "getAssetUri" instead.'),e(t,"getAssetUri");if("attach"==n||"detach"==n)return function(){return ne.Z(n+"() does not work while casting!"),Promise.resolve()}}return t.a.ha()&&0==Object.keys(t.a.a.video).length&&Zn[n]||!t.a.ha()?t.b[n].bind(t.b):t.a.get("player",n)}(t,e)}})}),function(i){var r=new Map;gi(i,function(e,t){var n;r.has(t)?(n=r.get(t),e.length<n.length?i.o.set(e,n):i.o.set(n,e)):r.set(t,e)})}(t),t.f=new ke,t.f.gc=t.h,t.g=new ke,t.g.gc=t.l}(this)}function gi(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!r.has(e)}var i=e.b,r=new Set;for(a in i)n(a)&&(r.add(a),t(a,i[a]));for(var a=Object.getPrototypeOf(i),o=Object.getPrototypeOf({});a&&a!=o;){for(var s=Y(Object.getOwnPropertyNames(a)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(r.add(u),t(u,i[u]));a=Object.getPrototypeOf(a)}}function vi(e){var n={video:{},player:{},playerAfterLoad:{},manifest:e.b.pc(),startTime:null};return e.c.pause(),$n.forEach(function(e){n.video[e]=this.c[e]}.bind(e)),e.c.ended||(n.startTime=e.c.currentTime),ti.forEach(function(e){var t=e[1];e=this.b[e[0]](),n.player[t]=e}.bind(e)),ni.forEach(function(e){var t=e[1];e=this.b[e[0]](),n.playerAfterLoad[t]=e}.bind(e)),n}function yi(e){e.dispatchEvent(new Ee("caststatuschanged"))}function bi(e){e.f.dispatchEvent(new Ee(e.h.paused?"pause":"play"))}function wi(t){ti.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t));var e=t.a.get("player","getAssetUri")(),n=t.a.get("video","ended"),i=Promise.resolve(),r=t.c.autoplay,a=null;n||(a=t.a.get("video","currentTime")),e&&(t.c.autoplay=!1,i=t.b.load(e,a));var o={};$n.forEach(function(e){o[e]=this.a.get("video",e)}.bind(t)),i.then(function(){t.c&&($n.forEach(function(e){this.c[e]=o[e]}.bind(t)),ni.forEach(function(e){var t=e[1];e=this.a.get("player",e[0])(),this.b[t](e)}.bind(t)),t.c.autoplay=r,e&&t.c.play())},function(e){t.b.dispatchEvent(new Ee("error",{detail:e}))})}function Ti(e,t,n){e.a.ha()&&("video"==t?e.f.dispatchEvent(n):"player"==t&&e.g.dispatchEvent(n))}function Si(e,t,n,i){var r,a,o=this;ke.call(this),this.a=e,this.b=t,this.c=new Ke,this.G={video:e,player:t},this.u=n||function(){},this.H=i||function(e){return e},this.v=!1,this.h=!0,this.g=0,this.o=!1,this.l=!0,this.i=this.f=null,this.F=new de(function(){xi(o)}),r=this,(a=cast.receiver.CastReceiverManager.getInstance()).onSenderConnected=r.re.bind(r),a.onSenderDisconnected=r.re.bind(r),a.onSystemVolumeChanged=r.af.bind(r),r.i=a.getCastMessageBus("urn:x-cast:com.google.cast.media"),r.i.onMessage=r.Mf.bind(r),r.f=a.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),r.f.onMessage=r.Wf.bind(r),a.start(),Xn.forEach(function(e){this.c.B(this.a,e,this.we.bind(this,"video"))}.bind(r)),Qn.forEach(function(e){this.c.B(this.b,e,this.we.bind(this,"player"))}.bind(r)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?r.b.Hd(3840,2160):r.b.Hd(1920,1080),r.c.B(r.a,"loadeddata",function(){this.o=!0}.bind(r)),r.c.B(r.b,"loading",function(){this.h=!1,Ei(this)}.bind(r)),r.c.B(r.a,"playing",function(){this.h=!1,Ei(this)}.bind(r)),r.c.B(r.a,"pause",function(){Ei(this)}.bind(r)),r.c.B(r.b,"unloading",function(){this.h=!0,Ei(this)}.bind(r)),r.c.B(r.a,"ended",function(){var e=this;new de(function(){e.a&&e.a.ended&&(e.h=!0,Ei(e))}).R(5)}.bind(r))}function Ei(e){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new Ee("caststatuschanged")),ki(this)||Ii(this))}.bind(e))}function xi(e){e.F.R(.5);var t={video:{},player:{}};if(Yn.forEach(function(e){t.video[e]=this.a[e]}.bind(e)),e.b.X())for(var n in ei)0==e.g%ei[n]&&(t.player[n]=e.b[n]());for(var i in Zn)0==e.g%Zn[i]&&(t.player[i]=e.b[i]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.o&&(e.g+=1),Mi(e,{type:"update",update:t},e.f),ki(e)}function ki(e){return e.l&&(e.a.duration||e.b.X())&&(Ai(e),e.l=!1,1)}function Ai(e,t){t=void 0===t?0:t;var n={contentId:e.b.pc(),streamType:e.b.X()?"LIVE":"BUFFERED",contentType:""};e.b.X()||(n.duration=e.a.duration),Ii(e,t,n)}function Mi(e,t,n,i){e.v&&(e=ai(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Ii(e,t,n){t=void 0===t?0:t,n=void 0===n?null:n;var i=e.a.playbackRate,r=Pi,i={mediaSessionId:0,playbackRate:i,playerState:r=e.h?r.IDLE:e.b.fd()?r.Je:e.a.paused?r.Le:r.Me,currentTime:e.a.currentTime,supportedMediaCommands:63,volume:{level:e.a.volume,muted:e.a.muted}};n&&(i.media=n),Mi(e,{requestId:t,type:"MEDIA_STATUS",status:[i]},e.i)}f.__onGCastApiAvailable=function(e){if(e)for(var t=(e=Y(pi)).next();!t.done;t=e.next())t.value.init()},L(mi,ke),R("shaka.cast.CastProxy",mi),mi.prototype.destroy=mi.prototype.destroy=function(e){return e&&this.a.vb(),this.i&&(this.i.release(),this.i=null),e=[],this.b&&(e.push(this.b.destroy()),this.b=null),this.a&&(e.push(this.a.destroy()),this.a=null),this.l=this.h=this.c=null,Promise.all(e)},mi.prototype.getVideo=mi.prototype.Cf=function(){return this.h},mi.prototype.getPlayer=mi.prototype.uf=function(){return this.l},mi.prototype.canCast=mi.prototype.Re=function(){return this.a.h&&ui},mi.prototype.isCasting=mi.prototype.ha=function(){return this.a.ha()},mi.prototype.receiverName=mi.prototype.xd=function(){return this.a.xd()},mi.prototype.cast=mi.prototype.cast=function(){var e=vi(this);return this.a.cast(e).then(function(){if(this.b)return this.b.Od()}.bind(this))},mi.prototype.setAppData=mi.prototype.Gd=function(e){this.a.Gd(e)},mi.prototype.suggestDisconnect=mi.prototype.Cg=function(){var e,t=this.a;t.b&&(e=t.G(),chrome.cast.requestSession(t.ud.bind(t,e),t.pe.bind(t)))},mi.prototype.changeReceiverId=mi.prototype.Ue=function(t){var n=this;return $(function e(){return te(e,function(e){switch(e.j){case 1:return t==n.u?e.return():(n.u=t,n.a.vb(),J(e,n.a.destroy(),2));case 2:n.a=null,n.a=new si(t,function(){return yi(n)},function(){return bi(n)},function(e,t){return Ti(n,e,t)},function(){return wi(n)},function(){return vi(n)}),n.a.init(),K(e)}})})},mi.prototype.forceDisconnect=mi.prototype.vb=function(){this.a.vb()},mi.prototype.F=function(e){if("addEventListener"==e)return this.f.addEventListener.bind(this.f);if("removeEventListener"==e)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var t=this.c[e];if("function"!=typeof t)return t}return this.a.ha()?this.a.get("video",e):("function"==typeof(e=this.c[e])&&(e=e.bind(this.c)),e)},mi.prototype.H=function(e,t){this.a.ha()?this.a.set("video",e,t):this.c[e]=t},mi.prototype.G=function(e){this.a.ha()||this.f.dispatchEvent(new Ee(e.type,e))},mi.prototype.v=function(e){this.a.ha()||this.g.dispatchEvent(e)},L(Si,ke),R("shaka.cast.CastReceiver",Si),Si.prototype.isConnected=Si.prototype.isConnected=function(){return this.v},Si.prototype.isIdle=Si.prototype.Hf=function(){return this.h},Si.prototype.destroy=Si.prototype.destroy=function(){var n=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return n.c&&(n.c.release(),n.c=null),t=[],n.b&&(t.push(n.b.destroy()),n.b=null),n.F&&(n.F.stop(),n.F=null),n.a=null,n.G=null,n.u=null,n.v=!1,n.h=!0,n.f=null,n.i=null,J(e,Promise.all(t),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),K(e)}})})},(n=Si.prototype).re=function(){this.g=0,this.l=!0,this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,Ei(this)},n.we=function(e,t){this.b&&(xi(this),Mi(this,{type:"event",targetName:e,event:t},this.f))},n.af=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Mi(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.f),Mi(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)},n.Wf=function(e){var t=oi(e.data);switch(ne.debug("CastReceiver: message",t),t.type){case"init":this.g=0,this.o=!1,this.l=!0,function(n,i,e){for(var t in i.player)n.b[t](i.player[t]);n.u(e),e=Promise.resolve();var r=n.a.autoplay;i.manifest&&(n.a.autoplay=!1,e=n.b.load(i.manifest,i.startTime)),e.then(function(){if(n.b){for(var e in i.video)n.a[e]=i.video[e];for(var t in i.playerAfterLoad)n.b[t](i.playerAfterLoad[t]);n.a.autoplay=r,i.manifest&&(n.a.play(),Ii(n))}},function(e){n.b.dispatchEvent(new Ee("error",{detail:e}))})}(this,t.initState,t.appData),xi(this);break;case"appData":this.u(t.appData);break;case"set":var n=t.targetName,i=t.property,t=t.value;if("video"==n){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){r.setSystemVolumeLevel(t);break}if("muted"==i){r.setSystemVolumeMuted(t);break}}this.G[n][i]=t;break;case"call":(n=this.G[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,i=t.methodName,"player"==n&&"load"==i&&(this.g=0,this.o=!1),r=t.id,e=e.senderId;var a=this.G[n];t=a[i].apply(a,t.args),"player"==n&&"load"==i&&(t=t.then(function(){this.l=!0}.bind(this))),t.then(this.Be.bind(this,e,r,null),this.Be.bind(this,e,r))}},n.Mf=function(e){var n=oi(e.data);switch(ne.debug("CastReceiver: message",n),n.type){case"PLAY":this.a.play(),Ii(this);break;case"PAUSE":this.a.pause(),Ii(this);break;case"SEEK":e=n.currentTime;var t=n.resumeState;null!=e&&(this.a.currentTime=Number(e)),t&&"PLAYBACK_START"==t?(this.a.play(),Ii(this)):t&&"PLAYBACK_PAUSE"==t&&(this.a.pause(),Ii(this));break;case"STOP":this.b.Od().then(function(){this.b&&Ii(this)}.bind(this));break;case"GET_STATUS":Ai(this,Number(n.requestId));break;case"VOLUME":e=(t=n.volume).level,t=t.muted;var i=this.a.volume,r=this.a.muted;null!=e&&(this.a.volume=Number(e)),null!=t&&(this.a.muted=t),i==this.a.volume&&r==this.a.muted||Ii(this);break;case"LOAD":this.g=0,this.l=this.o=!1,e=n.media,t=n.currentTime,i=this.H(e.contentId),r=n.autoplay||!0,this.u(e.customData),r&&(this.a.autoplay=!0),this.b.load(i,t).then(function(){this.b&&Ai(this)}.bind(this)).catch(function(e){var t="LOAD_FAILED";7==e.category&&7e3==e.code&&(t="LOAD_CANCELLED"),Mi(this,{requestId:Number(n.requestId),type:t},this.i)}.bind(this));break;default:ne.m("Unrecognized message type from the generic Chromecast controller!",n.type),Mi(this,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}},n.Be=function(e,t,n){this.b&&Mi(this,{type:"asyncComplete",id:t,error:n},this.f,e)};var Pi={IDLE:"IDLE",Me:"PLAYING",Je:"BUFFERING",Le:"PAUSED"};function Ci(e,t){this.N=e,this.b=t==Ni,this.a=0}R("shaka.util.DataViewReader",Ci);var Ni=1;function Ri(){throw new me(2,3,3e3)}function Di(){this.c=[],this.b=[],this.a=!1}function Ui(e){for(var t=null!=e.flags?12:8;e.reader.ya()&&!e.parser.a;)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function _i(e){for(var t=null!=e.flags?12:8,n=e.reader.I();0<n&&!e.parser.a;--n)e.parser.Ac(e.start+t,e.reader,e.partialOkay)}function Li(t){return function(e){t(e.reader.gb(e.reader.N.byteLength-e.reader.ga()))}}function Oi(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function ji(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Ki(e){var r=this;this.a=[],this.b=[],this.data=[],(new Di).L("moov",Ui).ia("pssh",function(e){if(1<e.version)ne.m("Unrecognized PSSH version found!");else{var t=e.reader.N,t=new Uint8Array(t.buffer,t.byteOffset-12,e.size);if(r.data.push(t),r.a.push(ht.Ic(e.reader.gb(16))),0<e.version){t=e.reader.I();for(var n=0;n<t;++n){var i=ht.Ic(e.reader.gb(16));r.b.push(i)}}}}).parse(e),0==this.data.length&&ne.m("No pssh box found!")}function Bi(e){if(!e)return e;var t=new Ki(e);if(t.data.length<=1)return e;e=[];for(var n={},i=(t=Y(t.data)).next();!i.done;n={tc:n.tc},i=t.next())n.tc=i.value,e.some(function(t){return function(e){return ht.Da(e,t.tc)}}(n))||e.push(n.tc);return ht.concat.apply(ht,e instanceof Array?e:function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(Y(e)))}Ci.Endianness={Lg:0,Ng:Ni},Ci.prototype.hasMoreData=Ci.prototype.ya=function(){return this.a<this.N.byteLength},Ci.prototype.getPosition=Ci.prototype.ga=function(){return this.a},Ci.prototype.getLength=Ci.prototype.hf=function(){return this.N.byteLength},Ci.prototype.readUint8=Ci.prototype.na=function(){try{var e=this.N.getUint8(this.a);return this.a+=1,e}catch(e){Ri()}},Ci.prototype.readUint16=Ci.prototype.$b=function(){try{var e=this.N.getUint16(this.a,this.b);return this.a+=2,e}catch(e){Ri()}},Ci.prototype.readUint32=Ci.prototype.I=function(){try{var e=this.N.getUint32(this.a,this.b);return this.a+=4,e}catch(e){Ri()}},Ci.prototype.readInt32=Ci.prototype.xe=function(){try{var e=this.N.getInt32(this.a,this.b);return this.a+=4,e}catch(e){Ri()}},Ci.prototype.readUint64=Ci.prototype.Kb=function(){try{var e,t;this.b?(e=this.N.getUint32(this.a,!0),t=this.N.getUint32(this.a+4,!0)):(t=this.N.getUint32(this.a,!1),e=this.N.getUint32(this.a+4,!1))}catch(e){Ri()}if(2097151<t)throw new me(2,3,3001);return this.a+=8,t*Math.pow(2,32)+e},Ci.prototype.readBytes=Ci.prototype.gb=function(e){this.a+e>this.N.byteLength&&Ri();var t=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,e);return this.a+=e,t},Ci.prototype.skip=Ci.prototype.P=function(e){this.a+e>this.N.byteLength&&Ri(),this.a+=e},Ci.prototype.rewind=Ci.prototype.ze=function(e){this.a<e&&Ri(),this.a-=e},Ci.prototype.seek=Ci.prototype.seek=function(e){(e<0||e>this.N.byteLength)&&Ri(),this.a=e},Ci.prototype.readTerminatedString=Ci.prototype.wd=function(){for(var e=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;return e=new Uint8Array(this.N.buffer,this.N.byteOffset+e,this.a-e),this.a+=1,ot(e)},R("shaka.util.Mp4Parser",Di),Di.prototype.box=Di.prototype.L=function(e,t){var n=Oi(e);return this.c[n]=0,this.b[n]=t,this},Di.prototype.fullBox=Di.prototype.ia=function(e,t){var n=Oi(e);return this.c[n]=1,this.b[n]=t,this},Di.prototype.stop=Di.prototype.stop=function(){this.a=!0},Di.prototype.parse=Di.prototype.parse=function(e,t){var n=new Uint8Array(e),n=new Ci(new DataView(n.buffer,n.byteOffset,n.byteLength),0);for(this.a=!1;n.ya()&&!this.a;)this.Ac(0,n,t)},Di.prototype.parseNext=Di.prototype.Ac=function(e,t,n){var i=t.ga(),r=t.I(),a=t.I();switch(ne.J("Parsing MP4 box",ji(a)),r){case 0:r=t.N.byteLength-i;break;case 1:r=t.Kb()}var o,s,u=this.b[a];u?(s=o=null,1==this.c[a]&&(o=(s=t.I())>>>24,s&=16777215),a=i+r,n&&a>t.N.byteLength&&(a=t.N.byteLength),t=0<(a-=t.ga())?t.gb(a):new Uint8Array(0),u({parser:this,partialOkay:n||!1,version:o,flags:s,reader:t=new Ci(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:r,start:i+e})):t.P(Math.min(i+r-t.ga(),t.N.byteLength-t.ga()))},Di.children=Ui,Di.sampleDescription=_i,Di.allData=Li,Di.typeToString=ji;var Fi={oc:function(e,t){var n=Fi.U(e,t);return 1!=n.length?null:n[0]},Wc:function(e,t,n){return 1!=(e=Fi.ae(e,t,n)).length?null:e[0]},U:function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.tagName==t})},ae:function(e,t,n){return Array.prototype.filter.call(e.childNodes,function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t})},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},qc:function(e){return Array.prototype.every.call(e.childNodes,function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE})?e.textContent.trim():null},M:function(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.getAttribute(t))&&(r=n(e)),null==r?i:r},$f:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ia:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(ne.m("Invalid duration string:",e),null)},Cc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Bc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},Hb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},Ze:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},ue:function(e,t){var n,i=new DOMParser;try{var r=i.parseFromString(e,"text/xml")}catch(e){}return r&&r.documentElement.tagName==t&&(n=r.documentElement),n&&0<n.getElementsByTagName("parsererror").length?null:n},te:function(e,t){try{var n=ot(e);return Fi.ue(n,t)}catch(e){}}},Hi=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function Vi(e,t,n){var i=function(e){for(var t=[],n=(e=Y(e)).next();!n.done;n=e.next())(n=Wi(n.value))&&t.push(n);return t}(e),r=null;e=[];var a=[],o=new Set(i.map(function(e){return e.keyId}));if(o.delete(null),1<o.size)throw new me(2,4,4010);if(n||(a=i.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Ae||(r=e.init||r,!1)})).length&&(0==(e=function(e,t,n){for(var i,r=[],a=(n=Y(n)).next();!a.done;a=n.next()){a=a.value;var o,s,u,c,l,d,f=Hi.get(a.Ae);if(f)i=(i=Fi.Wc(a.node,"urn:microsoft:playready","pro"))?(i=ht.Fa(i.textContent),o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),s=i.length,u=o.length+16+s,c=new ArrayBuffer(u),l=new Uint8Array(c),c=new DataView(c),d=0,c.setUint32(d,u),d+=4,c.setUint32(d,1886614376),d+=4,c.setUint32(d,0),d+=4,l.set(o,d),d+=o.length,c.setUint32(d,s),d+=4,l.set(i,d),[{initData:l,initDataType:"cenc",keyId:a.keyId}]):null,i=Gt(f,a.init||e||i),(f=Gi.get(f))&&(i.licenseServerUri=f(a)),r.push(i);else for(a=Y(a=t(a.node)||[]),f=a.next();!f.done;f=a.next())r.push(f.value)}return r}(r,t,a)).length&&(e=[Gt("",r)])),i.length&&(n||!a.length))for(e=[],n=(t=Y(Hi.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(Gt(n,r));if(o=Array.from(o)[0]||null)for(n=(t=Y(e)).next();!n.done;n=t.next())for(i=(n=Y(n.value.initData)).next();!i.done;i=n.next())i.value.keyId=o;return{Xd:o,Pg:r,drmInfos:e,be:!0}}var qi,Gi=(new Map).set("com.widevine.alpha",function(e){return(e=Fi.Wc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",function(e){return(e=Fi.Wc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(t+=4,n!==e.byteLength)return ne.m("PlayReady Object with invalid length encountered."),[];t+=2,n=[];for(var i=new DataView(e);t<e.byteLength-1;){var r=i.getUint16(t,!0);t+=2;var a=i.getUint16(t,!0);t+=2;var o=new Uint8Array(e,t,a);n.push({type:r,value:o}),t+=a}return n}((e=ht.Fa(e.textContent)).buffer).filter(function(e){return 1===e.type})[0])?(e=st(e.value,!0),(e=Fi.ue(e,"WRMHEADER"))?function(e){for(var t=(e=Y(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=Y(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""});function Wi(e){var t=e.getAttribute("schemeIdUri"),n=Fi.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),i=Fi.ae(e,"urn:mpeg:cenc:2013","pssh").map(Fi.qc);if(!t)return ne.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new me(2,4,4009);var r=[];try{r=i.map(function(e){return{initDataType:"cenc",initData:ht.Fa(e),keyId:null}})}catch(e){throw new me(2,4,4007)}return{node:e,Ae:t,keyId:n,init:0<r.length?r:null}}function zi(a,e,t,n,i){var o={RepresentationID:e,Number:t,Bandwidth:n,Time:i};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(e,t,n,i){if("$$"==e)return"$";var r=o[t];if(null==r)return ne.m("URL template does not have an available substitution for identifier",'"'+t+'":',a),e;switch("RepresentationID"==t&&n&&(ne.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',a),n=void 0),"Time"==t&&(r=Math.round(r)),i){case void 0:case"d":case"i":case"u":e=r.toString();break;case"o":e=r.toString(8);break;case"x":e=r.toString(16);break;case"X":e=r.toString(16).toUpperCase();break;default:e=r.toString()}return n=f.parseInt(n,10)||1,Array(Math.max(0,n-e.length)+1).join("0")+e})}function Xi(e,t){var n=Yi(e,t,"timescale"),i=1;n&&(i=Fi.Bc(n)||1),n=Yi(e,t,"duration"),(n=Fi.Bc(n||""))&&(n/=i);var r=Yi(e,t,"startNumber"),a=Number(Yi(e,t,"presentationTimeOffset"))||0,o=Fi.Hb(r||"");null!=r&&null!=o||(o=1);r=null;if(u=$i(e,t,"SegmentTimeline")){r=i;for(var s=e.W.duration||1/0,u=Fi.U(u,"S"),c=[],l=-a,d=0;d<u.length;++d){var f=u[d],h=Fi.M(f,"t",Fi.Hb),p=Fi.M(f,"d",Fi.Hb),m=Fi.M(f,"r",Fi.parseInt);if(null!=h&&(h-=a),!p){ne.m('"S" element must have a duration:','ignoring the remaining "S" elements.',f);break}if(h=null!=h?h:l,(m=m||0)<0)if(d+1<u.length){if(null==(m=Fi.M(u[d+1],"t",Fi.Hb))){ne.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',f);break}if(m<=h){ne.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',f);break}m=Math.ceil((m-h)/p)-1}else{if(1/0==s){ne.m('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',f);break}if(s<=h/r){ne.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',f);break}m=Math.ceil((s*r-h)/p)-1}for(0<c.length&&h!=l&&(Math.abs((h-l)/r)>=zt&&ne.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",f),c[c.length-1].end=h/r),f=0;f<=m;++f)l=h+p,c.push({start:h/r,end:l/r,Hg:h}),h=l}r=c}return{timescale:i,da:n,ib:o,oa:a/i||0,Pd:a,S:r}}function Yi(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Vt.Ma).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}function $i(e,t,n){return[t(e.A),t(e.aa),t(e.ma)].filter(Vt.Ma).map(function(e){return Fi.oc(e,n)}).reduce(function(e,t){return e||t})}function Ji(e,t,n,i,r,a){if(a=void 0===a?0:a,Fi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var o=function(r,a,o,e,s,u){for(var c=Fi.getAttributeNS(r,"http://www.w3.org/1999/xlink","href"),t=Fi.getAttributeNS(r,"http://www.w3.org/1999/xlink","actuate")||"onRequest",n=0;n<r.attributes.length;n++){var i=r.attributes[n];"http://www.w3.org/1999/xlink"==i.namespaceURI&&(r.removeAttributeNS(i.namespaceURI,i.localName),--n)}if(5<=u)return ye(new me(2,4,4028));if("onLoad"!=t)return ye(new me(2,4,4027));var l=qt([e],[c]);return s.request(0,_e(l,a)).Y(function(e){if(!(e=Fi.te(e.data,r.tagName)))return ye(new me(2,4,4001,c));for(;r.childNodes.length;)r.removeChild(r.childNodes[0]);for(;e.childNodes.length;){var t=e.childNodes[0];e.removeChild(t),r.appendChild(t)}for(t=0;t<e.attributes.length;t++){var n=e.attributes[t].nodeName,i=e.getAttribute(n);r.setAttribute(n,i)}return Ji(r,a,o,l[0],s,u+1)})}(e,t,n,i,r,a);return n&&(o=o.Y(void 0,function(){return Ji(e,t,n,i,r,a)})),o}o=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Fi.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&o.push(Ji(u,t,n,i,r,a)))}return Se(o).Y(function(){return e})}function Qi(e,t,n){this.c=e,this.b=t,this.a=n}function Zi(e,t,n,i,r,a){this.position=e,this.startTime=t,this.endTime=n,this.c=i,this.b=r,this.a=a}function er(e,t,n,i){var r,a=(new Di).ia("sidx",function(e){r=function(e,t,n,i){var r=[];i.reader.P(4);var a=i.reader.I();if(0==a)throw ne.error("Invalid timescale."),new me(2,3,3005);{var o,s;s=0==i.version?(o=i.reader.I(),i.reader.I()):(o=i.reader.Kb(),i.reader.Kb())}i.reader.P(2);var u=i.reader.$b();for(e=e+i.size+s,s=0;s<u;s++){var c=i.reader.I(),l=(2147483648&c)>>>31;c&=2147483647;var d=i.reader.I();if(i.reader.P(4),1==l)throw ne.error("Heirarchical SIDXs are not supported."),new me(2,3,3006);r.push(new Zi(r.length,o/a-t,(o+d)/a-t,function(){return n},e,e+c-1)),o+=d,e+=c}return i.parser.stop(),r}(t,i,n,e)});if(e&&a.parse(e),r)return r;throw ne.error('Invalid box type, expected "sidx".'),new me(2,3,3004)}function tr(e){this.a=e}function nr(e,t){for(;e.a.length&&e.a[e.a.length-1].startTime>=t;)e.a.pop();for(;e.a.length&&e.a[0].endTime<=0;)e.a.shift();var n;0!=e.a.length&&(n=e.a[e.a.length-1],e.a[e.a.length-1]=new Zi(n.position,n.startTime,t,n.c,n.b,n.a))}function ir(e){this.b=e,this.a=new Ci(e,0),qi=qi||[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]}function rr(e){var t=ar(e);if(7<t.length)throw new me(2,3,3002);for(var n=0,i=0;i<t.length;i++)n=256*n+t[i];t=n,n=ar(e);e:{i=ht.Da;for(var r=0;r<qi.length;r++)if(i(n,qi[r])){i=!0;break e}i=!1}if(i)n=e.b.byteLength-e.a.ga();else{if(8==n.length&&224&n[1])throw new me(2,3,3001);for(i=n[0]&(1<<8-n.length)-1,r=1;r<n.length;r++)i=256*i+n[r];n=i}return n=e.a.ga()+n<=e.b.byteLength?n:e.b.byteLength-e.a.ga(),i=new DataView(e.b.buffer,e.b.byteOffset+e.a.ga(),n),e.a.P(n),new or(t,i)}function ar(e){for(var t=e.a.na(),n=1;n<=8&&!(t&1<<8-n);n++);if(8<n)throw new me(2,3,3002);var i=new Uint8Array(n);for(i[0]=t,t=1;t<n;t++)i[t]=e.a.na();return i}function or(e,t){this.id=e,this.a=t}function sr(e){if(8<e.a.byteLength)throw new me(2,3,3002);if(8==e.a.byteLength&&224&e.a.getUint8(0))throw new me(2,3,3001);for(var t=0,n=0;n<e.a.byteLength;n++)t=256*t+e.a.getUint8(n);return t}function ur(){}function cr(e){var t=new ir(e.a);if(179!=(e=rr(t)).id)throw ne.m("Not a CueTime element."),new me(2,3,3013);if(e=sr(e),183!=(t=rr(t)).id)throw ne.m("Not a CueTrackPositions element."),new me(2,3,3012);t=new ir(t.a);for(var n=0;t.ya();){var i=rr(t);if(241==i.id){n=sr(i);break}}return{Ig:e,gg:n}}function lr(e,t){var n=$i(e,t,"Initialization");if(!n)return null;var i=e.A.ta,r=n.getAttribute("sourceURL");r&&(i=qt(e.A.ta,[r])),r=0;var a=null;return(n=Fi.M(n,"range",Fi.Cc))&&(r=n.start,a=n.end),new Qi(function(){return i},r,a)}function dr(e,t,n,i,r,a,o,s){var u=e.presentationTimeline,c=!e.tb||!e.W.hd,l=e.W.start,d=e.W.duration,f=t,h=null;return{createSegmentIndex:function(){var e=[f(i,r,a),"webm"==o?f(n.c(),n.b,n.a):null];return f=null,Promise.all(e).then(function(e){var t=e[0];e=e[1]||null,t="mp4"==o?er(t,r,i,s):(new ur).parse(t,e,i,s),u.Eb(t,l),h=new tr(t),c&&nr(h,d)})},findSegmentPosition:function(e){return h.find(e)},getSegmentReference:function(e){return h.get(e)}}}function fr(e){return e.ac}function hr(e,t){var n,i=lr(e,pr),r=[(n=e).A.Pa,n.aa.Pa,n.ma.Pa].filter(Vt.Ma).map(function(e){return Fi.U(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(e){return e.getAttribute("indexRange")&&!n.he&&(n.he=!0,ne.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Jf:e.getAttribute("media"),start:(e=Fi.M(e,"mediaRange",Fi.Cc,{start:0,end:null})).start,end:e.end}}),a=Xi(e,pr),o=a.ib;0==o&&(ne.m("SegmentList@startNumber must be > 0"),o=1);var s=0;if(a.da?s=a.da*(o-1):a.S&&0<a.S.length&&(s=a.S[0].start),!(r={da:a.da,startTime:s,ib:o,oa:a.oa,S:a.S,cb:r}).da&&!r.S&&1<r.cb.length)throw ne.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.A),new me(2,4,4002);if(!r.da&&!e.W.duration&&!r.S&&1==r.cb.length)throw ne.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.A),new me(2,4,4002);if(r.S&&0==r.S.length)throw ne.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.A),new me(2,4,4002);return o=a=null,e.ma.id&&e.A.id&&(a=t[o=e.ma.id+","+e.A.id]),s=function(e,t,n,i){var r=i.cb.length;i.S&&i.S.length!=i.cb.length&&(r=Math.min(i.S.length,i.cb.length),ne.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",i.cb.length,"to",r));for(var a=[],o=i.startTime,s=0;s<r;s++){var u,c=i.cb[s],l=qt(n,[c.Jf]);u=null!=i.da?o+i.da:i.S?i.S[s].end:o+e,a.push(new Zi(s+t,o,u,function(e){return e}.bind(null,l),c.start,c.end)),o=u}return a}(e.W.duration,r.ib,e.A.ta,r),a?(a.md(s),o=e.presentationTimeline.Wb(),a.Tc(o-e.W.start)):(e.presentationTimeline.Eb(s,e.W.start),a=new tr(s),o&&e.tb&&(t[o]=a)),e.tb&&e.W.hd||nr(a,e.W.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:a.find.bind(a),getSegmentReference:a.get.bind(a),initSegmentReference:i,oa:r.oa}}function pr(e){return e.Pa}function mr(e,t,n,i){var r,a,o,s,u,c,l,d,f,h,p=function(e){var t=Yi(e,gr,"initialization");if(!t)return null;var n=e.A.id,i=e.bandwidth||null,r=e.A.ta;return new Qi(function(){var e=zi(t,n,null,i,null);return qt(r,[e])},0,null)}(e),m=Xi(e,gr),g=Yi(e,gr,"media"),v=Yi(e,gr,"index"),g=(m={da:m.da,timescale:m.timescale,ib:m.ib,oa:m.oa,Pd:m.Pd,S:m.S,kd:g,Yb:v}).Yb?1:0;if(g+=m.S?1:0,0==(g+=m.da?1:0))throw ne.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.A),new me(2,4,4002);if(1!=g&&(ne.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.A),m.Yb?(ne.info("Using the index URL template by default."),m.S=null):ne.info("Using the SegmentTimeline by default."),m.da=null),!m.Yb&&!m.kd)throw ne.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.A),new me(2,4,4002);if(m.Yb){if("mp4"!=(n=e.A.mimeType.split("/")[1])&&"webm"!=n)throw ne.error("SegmentTemplate specifies an unsupported container type.",e.A),new me(2,4,4006);if("webm"==n&&!p)throw ne.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.A),new me(2,4,4005);i=zi(m.Yb,e.A.id,null,e.bandwidth||null,null),e=dr(e,t,p,i=qt(e.A.ta,[i]),0,null,n,m.oa)}else e=m.da?(i||(e.presentationTimeline.od(m.da),e.presentationTimeline.pd(e.W.start)),a=m,o=(r=e).W.duration,s=a.da,u=a.ib,c=a.timescale,l=a.kd,d=r.bandwidth||null,f=r.A.id,h=r.A.ta,{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return e<0||o&&o<=e?null:Math.floor(e/s)},getSegmentReference:function(t){var n=t*s,e=n+s;return o&&(e=Math.min(e,o)),e<0||o&&o<=n?null:new Zi(t,n,e,function(){var e=zi(l,f,t+u,d,n*c);return qt(h,[e])},0,null)}}):(g=t=null,e.ma.id&&e.A.id&&(t=n[g=e.ma.id+","+e.A.id]),v=function(e,t){for(var n=[],i=0;i<t.S.length;i++){var r=i+t.ib;n.push(new Zi(r,t.S[i].start,t.S[i].end,function(e,t,n,i,r,a){return qt(i,[e=zi(e,t,r,n,a)]).map(function(e){return e.toString()})}.bind(null,t.kd,e.A.id,e.bandwidth||null,e.A.ta,r,t.S[i].Hg+t.Pd),0,null))}return n}(e,m),i=!e.tb||!e.W.hd,t?(i&&nr(new tr(v),e.W.duration),t.md(v),n=e.presentationTimeline.Wb(),t.Tc(n-e.W.start)):(e.presentationTimeline.Eb(v,e.W.start),t=new tr(v),g&&e.tb&&(n[g]=t)),i&&nr(t,e.W.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:p,oa:m.oa}}function gr(e){return e.cc}R("shaka.media.InitSegmentReference",Qi),Qi.prototype.createUris=Qi.prototype.Qc=function(){return this.c()},Qi.prototype.getStartByte=Qi.prototype.bd=function(){return this.b},Qi.prototype.getEndByte=Qi.prototype.ad=function(){return this.a},R("shaka.media.SegmentReference",Zi),Zi.prototype.getPosition=Zi.prototype.ga=function(){return this.position},Zi.prototype.getStartTime=Zi.prototype.sc=function(){return this.startTime},Zi.prototype.getEndTime=Zi.prototype.ff=function(){return this.endTime},Zi.prototype.createUris=Zi.prototype.Qc=function(){return this.c()},Zi.prototype.getStartByte=Zi.prototype.bd=function(){return this.b},Zi.prototype.getEndByte=Zi.prototype.ad=function(){return this.a},R("shaka.media.SegmentIndex",tr),tr.prototype.destroy=tr.prototype.destroy=function(){return this.a=null,Promise.resolve()},tr.prototype.find=tr.prototype.find=function(e){for(var t=this.a.length-1;0<=t;--t){var n=this.a[t];if(e>=n.startTime&&e<n.endTime)return n.position}return this.a.length&&e<this.a[0].startTime?this.a[0].position:null},tr.prototype.get=tr.prototype.get=function(e){return 0==this.a.length||(e-=this.a[0].position)<0||e>=this.a.length?null:this.a[e]},tr.prototype.offset=tr.prototype.offset=function(e){for(var t=0;t<this.a.length;++t)this.a[t].startTime+=e,this.a[t].endTime+=e},tr.prototype.merge=tr.prototype.md=function(e){for(var t=[],n=0,i=0;n<this.a.length&&i<e.length;){var r=this.a[n],a=e[i];r.startTime<a.startTime?(t.push(r),n++):(r.startTime>a.startTime?0==n?t.push(a):ne.m("Refusing to rewrite original references on update!"):(.1<Math.abs(r.endTime-a.endTime)?t.push(new Zi(r.position,a.startTime,a.endTime,a.c,a.b,a.a)):t.push(r),n++),i++)}for(;n<this.a.length;)t.push(this.a[n++]);if(t.length)for(n=t[t.length-1].position+1;i<e.length;)r=new Zi(n++,(r=e[i++]).startTime,r.endTime,r.c,r.b,r.a),t.push(r);else t=e;this.a=t},tr.prototype.evict=tr.prototype.Tc=function(e){for(var t=0;t<this.a.length;++t)if(this.a[t].endTime>e)return void this.a.splice(0,t);this.a=[]},ir.prototype.ya=function(){return this.a.ya()},ur.prototype.parse=function(e,t,n,i){var r;if(440786851!=rr(t=new ir(new DataView(t))).id)throw ne.error("Not an EBML element."),new me(2,3,3008);var a=rr(t);if(408125543!=a.id)throw ne.error("Not a Segment element."),new me(2,3,3009);for(t=a.a.byteOffset,a=new ir(a.a),r=null;a.ya();){var o=rr(a);if(357149030==o.id){r=o;break}}if(!r)throw ne.error("Not an Info element."),new me(2,3,3010);for(a=new ir(r.a),r=1e6,o=null;a.ya();){var s=rr(a);if(2807729==s.id)r=sr(s);else if(17545==s.id)if(4==(o=s).a.byteLength)o=o.a.getFloat32(0);else{if(8!=o.a.byteLength)throw new me(2,3,3003);o=o.a.getFloat64(0)}}if(null==o)throw new me(2,3,3011);if(r=o*(a=r/1e9),475249515!=(e=rr(new ir(new DataView(e)))).id)throw ne.error("Not a Cues element."),new me(2,3,3007);return function(e,t,n,i,r,a){function o(){return r}var s=[];e=new ir(e.a);for(var u=null,c=null;e.ya();){var l,d=rr(e);187!=d.id||(l=cr(d))&&(d=n*l.Ig,l=t+l.gg,null!=u&&s.push(new Zi(s.length,u-a,d-a,o,c,l-1)),u=d,c=l)}return null!=u&&s.push(new Zi(s.length,u-a,i-a,o,c,null)),s}(e,t,a,r,n,i)};var vr={Ib:{},Zb:{},zd:function(e,t){vr.Zb[e]=t}};function yr(e,t,n){this.f=e,this.Dc=t,this.h=this.g=1/0,this.a=1,this.b=this.c=null,this.l=0,this.o=!0,this.i=0,this.u=void 0===n||n}function br(e,t,n,i){return e=_e(e,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function wr(){var e=this;this.b=this.a=null,this.f=[],this.c=null,this.l=[],this.h=1,this.o={},this.u=0,this.v=new O(5),this.i=new de(function(){var i;i=e,$(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return ne.info("Updating manifest..."),t=0,Q(e,2),J(e,Tr(i),4);case 4:t=e.s,Z(e,3);break;case 2:n=ee(e),i.b&&(n.severity=1,i.b.onError(n));case 3:if(!i.b)return e.return();kr(i,t),K(e)}})})}),this.g=new Ce}function Tr(t){var n=Date.now(),e=t.b.networkingEngine.request(0,_e(t.f,t.a.retryParameters));return Ne(t.g,e),e.promise.then(function(e){if(t.b)return e.uri&&!t.f.includes(e.uri)&&t.f.unshift(e.uri),function(t,e,n){if(!(e=Fi.te(e,"MPD")))throw new me(2,4,4001,n);return e=Ji(e,t.a.retryParameters,t.a.dash.xlinkFailGracefully,n,t.b.networkingEngine),Ne(t.g,e),e.promise.then(function(e){return L=t,O=e,j=n,$(function e(){var f,h,p,m,g,v,y,b,w,T,S,E,x,k,A,M,I,P,C,N,R,D,U,_;return te(e,function(e){switch(e.j){case 1:m=Vt,v=[j],0<(y=(g=Fi).U(O,"Location").map(g.qc).filter(m.Ma)).length&&(b=qt(v,y),v=L.f=b),w=g.U(O,"BaseURL").map(g.qc),T=qt(v,w),S=L.a.dash.ignoreMinBufferTime,E=0,S||(E=g.M(O,"minBufferTime",g.Ia)),L.u=g.M(O,"minimumUpdatePeriod",g.Ia,-1),x=g.M(O,"availabilityStartTime",g.$f),k=g.M(O,"timeShiftBufferDepth",g.Ia),A=g.M(O,"maxSegmentDuration",g.Ia),M=O.getAttribute("type")||"static",I=L.a.dash.ignoreSuggestedPresentationDelay,P=null,I||(P=g.M(O,"suggestedPresentationDelay",g.Ia)),C=L.c?L.c.presentationTimeline:(N=Math.max(L.a.dash.defaultPresentationDelay,1.5*E),new yr(x,null!=P?P:N,L.a.dash.autoCorrectDrift));for(var t={tb:"static"!=M,presentationTimeline:C,ma:null,W:null,aa:null,A:null,bandwidth:0,he:!1},n=T,i=Fi.M(O,"mediaPresentationDuration",Fi.Ia),r=[],a=0,o=Fi.U(O,"Period"),s=0;s<o.length;s++){var u,c=o[s],a=Fi.M(c,"start",Fi.Ia,a),l=Fi.M(c,"duration",Fi.Ia),d=null;if(s!=o.length-1?null!=(u=Fi.M(o[s+1],"start",Fi.Ia))&&(d=u-a):null!=i&&(d=i-a),u=zt,d&&l&&Math.abs(d-l)>u&&ne.m("There is a gap/overlap between Periods",c),null==d&&(d=l),c=Sr(L,t,n,{start:a,duration:d,node:c,hd:null==d||s==o.length-1}),r.push(c),l=t.ma.id,L.l.includes(l)||(L.l.push(l),L.c&&(L.b.filterNewPeriod(c),L.c.periods.push(c))),null==d){s!=o.length-1&&ne.m("Skipping Period",s+1,"and any subsequent Periods:","Period",s+1,"does not have a valid start time.",r[s+1]),a=null;break}a+=d}if(null==L.c&&L.b.filterAllPeriods(r),p=null!=i?(a!=i&&ne.m("@mediaPresentationDuration does not match the total duration of all","Periods."),f=r,h=i,!1):(f=r,h=a,!0),R=h,D=f,C.dc("static"==M),"static"!=M&&p||C.Ba(R||1/0),C.X()&&!isNaN(L.a.availabilityWindowOverride)&&(k=L.a.availabilityWindowOverride),null==k&&(k=1/0),C.Jd(k),C.od(A||1),L.c){e.C(0);break}if(L.c={presentationTimeline:C,periods:D,offlineSessionIds:[],minBufferTime:E||0},C.He())return U=g.U(O,"UTCTiming"),J(e,function(e,n,t){t=t.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}});var i=e.a.dash.clockSyncUri;return!t.length&&i&&t.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),Vt.Xe(t,function(e){var t=e.scheme;switch(e=e.value,t){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Mr(this,n,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Mr(this,n,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return t=Date.parse(e),isNaN(t)?0:t-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return ne.Z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return ne.Z("Unrecognized scheme in UTCTiming element",t),Promise.reject()}}.bind(e)).catch(function(){return ne.Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0})}(L,T,U),4);e.C(0);break;case 4:if(_=e.s,!L.b)return e.return();C.Ce(_),K(e)}})});var L,O,j})}(t,e.data,e.uri)}).then(function(){var e=(Date.now()-n)/1e3;return j(t.v,1,e),e})}function Sr(e,t,n,i){if(t.ma=Ar(i.node,null,n),t.W=i,t.ma.id||(ne.info("No Period ID given for Period with start time "+i.start+",  Assigning a default"),t.ma.id="__shaka_period_"+i.start),Fi.U(i.node,"EventStream").forEach(e.ag.bind(e,i.start,i.duration)),n=Fi.U(i.node,"AdaptationSet").map(e.Zf.bind(e,t)).filter(Vt.Ma),t.tb){t=[];for(var r=Y(n),a=r.next();!a.done;a=r.next())for(var o=(a=Y(a.value.jg)).next();!o.done;o=a.next())t.push(o.value);if(t.length!=new Set(t).size)throw new me(2,4,4018)}var s=n.filter(function(e){return!e.Nd});if(n.filter(function(e){return e.Nd}).forEach(function(e){var t=e.streams[0],n=e.Nd;s.forEach(function(e){e.id==n&&e.streams.forEach(function(e){e.trickModeVideo=t})})}),t=Er(s,"video"),r=Er(s,"audio"),!t.length&&!r.length)throw new me(2,4,4004);for(n=e.a.disableAudio,r.length&&!n||(r=[null]),n=e.a.disableVideo,t.length&&!n||(t=[null]),n=[],a=0;a<r.length;a++)for(o=0;o<t.length;o++)xr(e,r[a],t[o],n);if(t=[],!e.a.disableText)for(e=Er(s,"text"),r=0;r<e.length;r++)t.push.apply(t,e[r].streams);return{startTime:i.start,textStreams:t,variants:n}}function Er(e,t){return e.filter(function(e){return e.contentType==t})}function xr(e,t,n,i){if(t||n)if(t&&n){var r=t.drmInfos,a=n.drmInfos;if(!r.length||!a.length||0<Ct(r,a).length){a=Ct(t.drmInfos,n.drmInfos);for(var o=0;o<t.streams.length;o++)for(var s=0;s<n.streams.length;s++)r=(n.streams[s].bandwidth||0)+(t.streams[o].bandwidth||0),r={id:e.h++,language:t.language,primary:t.jd||n.jd,audio:t.streams[o],video:n.streams[s],bandwidth:r,drmInfos:a,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}}else for(a=t||n,o=0;o<a.streams.length;o++)r=a.streams[o].bandwidth||0,r={id:e.h++,language:a.language||"und",primary:a.jd,audio:t?a.streams[o]:null,video:n?a.streams[o]:null,bandwidth:r,drmInfos:a.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}function kr(e,t){e.u<0||e.i.R(Math.max(3,e.u-t,B(e.v)))}function Ar(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null},n=n||t.ta;for(var i=Fi.Hb,r=Fi.Ze,a=Fi.U(e,"BaseURL").map(Fi.qc),o=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs,r=Fi.M(e,"frameRate",r)||t.frameRate,c=e.getAttribute("sar")||t.pixelAspectRatio,l=Fi.U(e,"InbandEventStream"),d=t.emsgSchemeIdUris.slice(),f=(l=Y(l)).next();!f.done;f=l.next())f=f.value.getAttribute("schemeIdUri"),d.includes(f)||d.push(f);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],i=n.getAttribute("schemeIdUri");if(i&&(n=n.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var r=parseInt(n,10);if(r)return r;ne.m("Channel parsing failure! Ignoring scheme and value",i,n);continue;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(r=parseInt(n,16))){ne.m("Channel parsing failure! Ignoring scheme and value",i,n);continue}for(e=0;r;)1&r&&++e,r>>=1;return e;default:ne.m("Unrecognized audio channel scheme:",i,n)}}return null}(l=Fi.U(e,"AudioChannelConfiguration"))||t.qd,f=Fi.M(e,"audioSamplingRate",i)||t.audioSamplingRate,o=o||Ir(s,u),{ta:qt(n,a),ac:Fi.oc(e,"SegmentBase")||t.ac,Pa:Fi.oc(e,"SegmentList")||t.Pa,cc:Fi.oc(e,"SegmentTemplate")||t.cc,width:Fi.M(e,"width",i)||t.width,height:Fi.M(e,"height",i)||t.height,contentType:o,mimeType:s,codecs:u,frameRate:r,pixelAspectRatio:c,emsgSchemeIdUris:d,id:e.getAttribute("id"),qd:l,audioSamplingRate:f}}function Mr(e,t,n,i){return(t=_e(t=qt(t,[n]),e.a.retryParameters)).method=i,t=e.b.networkingEngine.request(4,t),Ne(e.g,t),t.promise.then(function(e){if("HEAD"==i){if(!e.headers||!e.headers.date)return ne.m("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=ot(e.data);return e=Date.parse(e),isNaN(e)?(ne.m("Unable to parse date from UTC timing response"),0):e-Date.now()})}function Ir(e,t){return vn(Xe(e,t))?"text":e.split("/")[0]}function Pr(e,t,n,i){this.b=e,this.type=t,this.a=n,this.segments=i||null}function Cr(e,t,n,i){this.id=e,this.name=t,this.a=n,this.value=void 0===i?null:i}function Nr(e,t){this.name=e,this.value=t}function Rr(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function Dr(e,t){this.b=t,this.a=e}R("shaka.media.ManifestParser.registerParserByExtension",vr.zd),vr.Lb=function(e,t){vr.Ib[e]=t},R("shaka.media.ManifestParser.registerParserByMime",vr.Lb),vr.dg=function(){var e={};if(Je()){for(var t in vr.Ib)e[t]=!0;for(var n in vr.Zb)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var i=(n=Y(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!i.done;i=n.next())e[i=i.value]=Je()?!!vr.Ib[i]:Qe(i);for(var r in t)e[r]=Je()?!!vr.Zb[r]:Qe(t[r]);return e},vr.create=function(i,r,a,o){return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return Q(e,2),J(e,vr.gf(i,r,a,o),4);case 4:return t=e.s,e.return(new t);case 2:throw(n=ee(e)).severity=2,n}})})},vr.gf=function(o,s,u,c){return $(function e(){var t,n,i,r,a;return te(e,function(e){switch(e.j){case 1:if(t=vr,c){if(n=t.Ib[c.toLowerCase()])return e.return(n);ne.m("Could not determine manifest type using MIME type ",c)}if(i=t.getExtension(o)){if(r=t.Zb[i])return e.return(r);ne.m("Could not determine manifest type for extension ",i)}else ne.m("Could not find extension for ",o);if(c){e.C(2);break}return J(e,t.qf(o,s,u),3);case 3:if(c=e.s){if(a=vr.Ib[c])return e.return(a);ne.m("Could not determine manifest type using MIME type",c)}case 2:throw new me(2,4,4e3,o)}})})},vr.qf=function(r,a,o){return $(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return(t=_e([r],o)).method="HEAD",J(e,a.request(0,t).promise,2);case 2:return n=e.s,i=n.headers["content-type"],e.return(i?i.toLowerCase().split(";").shift():"")}})})},vr.getExtension=function(e){return 1==(e=new ie(e).la.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},vr.isSupported=function(e,t){return!!Je()&&(t in vr.Ib||vr.getExtension(e)in vr.Zb)},R("shaka.media.PresentationTimeline",yr),yr.prototype.getDuration=yr.prototype.ca=function(){return this.g},yr.prototype.getMaxSegmentDuration=yr.prototype.nf=function(){return this.a},yr.prototype.setDuration=yr.prototype.Ba=function(e){this.g=e},yr.prototype.getPresentationStartTime=yr.prototype.wf=function(){return this.f},yr.prototype.setClockOffset=yr.prototype.Ce=function(e){this.l=e},yr.prototype.setStatic=yr.prototype.dc=function(e){this.o=e},yr.prototype.setSegmentAvailabilityDuration=yr.prototype.Jd=function(e){this.h=e},yr.prototype.setDelay=yr.prototype.sg=function(e){this.Dc=e},yr.prototype.getDelay=yr.prototype.ef=function(){return this.Dc},yr.prototype.notifySegments=yr.prototype.Eb=function(e,t){var n;0!=e.length&&(n=e[e.length-1].endTime+t,this.pd(e[0].startTime+t),this.a=e.reduce(function(e,t){return Math.max(e,t.endTime-t.startTime)},this.a),this.b=Math.max(this.b,n),null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1e3-this.b-this.a),ne.D("notifySegments:","maxSegmentDuration="+this.a))},yr.prototype.notifyMinSegmentStartTime=yr.prototype.pd=function(e){this.c=null==this.c?e:Math.min(this.c,e)},yr.prototype.notifyMaxSegmentDuration=yr.prototype.od=function(e){this.a=Math.max(this.a,e),ne.D("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)},yr.prototype.offset=yr.prototype.offset=function(e){null!=this.c&&(this.c+=e),null!=this.b&&(this.b+=e)},yr.prototype.isLive=yr.prototype.X=function(){return 1/0==this.g&&!this.o},yr.prototype.isInProgress=yr.prototype.bb=function(){return 1/0!=this.g&&!this.o},yr.prototype.getSegmentAvailabilityStart=yr.prototype.Wb=function(){if(1/0==this.h)return this.i;var e=this.xb()-this.h;return Math.max(this.i,e)},yr.prototype.setUserSeekStart=yr.prototype.De=function(e){this.i=e},yr.prototype.getSegmentAvailabilityEnd=yr.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1e3-this.a-this.f),this.g):this.g},yr.prototype.getSafeSeekRangeStart=yr.prototype.Vb=function(e){var t=Math.max(this.c,this.i);if(1/0==this.h)return t;var n=this.xb()-this.h;return e=Math.min(n+e,this.Ga()),Math.max(t,e)},yr.prototype.getSeekRangeStart=yr.prototype.wb=function(){return this.Vb(0)},yr.prototype.getSeekRangeEnd=yr.prototype.Ga=function(){var e=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-e)},yr.prototype.usingPresentationStartTime=yr.prototype.He=function(){return!(null==this.f||null!=this.b&&this.u)},R("shaka.dash.DashParser",wr),(n=wr.prototype).configure=function(e){this.a=e},n.start=function(n,i){var r=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return r.f=[n],r.b=i,J(e,Tr(r),2);case 2:if(t=e.s,r.b&&kr(r,t),!r.b)throw new me(2,7,7001);return e.return(r.c)}})})},n.stop=function(){return this.a=this.b=null,this.f=[],this.c=null,this.l=[],this.o={},null!=this.i&&(this.i.stop(),this.i=null),this.g.destroy()},n.update=function(){Tr(this).catch(function(e){this.b&&this.b.onError(e)}.bind(this))},n.onExpirationUpdated=function(){},n.Zf=function(t,e){if(t.aa=Ar(e,t.ma,null),"image"==t.aa.contentType)return ne.m("Skipping Image AdaptationSet",t.aa),null;var n=!1,i=(d=Fi.U(e,"Role")).map(function(e){return e.getAttribute("value")}).filter(Vt.Ma),r=void 0,a="text"==t.aa.contentType;a&&(r="subtitle");for(var o=0;o<d.length;o++){var s=d[o].getAttribute("schemeIdUri");if(null==s||"urn:mpeg:dash:role:2011"==s)switch(s=d[o].getAttribute("value"),s){case"main":n=!0;break;case"caption":case"subtitle":r=s}}var u=null,c=!1;Fi.U(e,"EssentialProperty").forEach(function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?u=e.getAttribute("value"):c=!0}),o=Fi.U(e,"Accessibility");var l=new Map,d={};for(s=(o=Y(o)).next();!s.done;d={Rb:d.Rb},s=o.next()){var s=(f=s.value).getAttribute("schemeIdUri"),f=f.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==s||"urn:scte:dash:cc:cea-708:2015"==s?(d.Rb=1,null!=f?f.split(";").forEach(function(n){return function(e){var t;e.includes("=")?(t=(e=e.split("="))[0].startsWith("CC")?e[0]:"CC"+e[0],e=e[1].split(",")[0].split(":").pop()):(t="CC"+n.Rb,n.Rb+=2),l.set(t,Ln(e))}}(d)):l.set("CC1","und")):"urn:mpeg:dash:role:2011"==s&&null!=f&&(i.push(f),"captions"==f&&(r="caption"))}if(c)return null;var h=Vi(d=Fi.U(e,"ContentProtection"),this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);if(d=Ln(e.getAttribute("lang")||"und"),o=e.getAttribute("label"),(s=Fi.U(e,"Label"))&&s.length&&((s=s[0]).textContent&&(o=s.textContent)),0!=(i=(s=Fi.U(e,"Representation")).map(this.bg.bind(this,t,h,r,d,o,n,i,l)).filter(function(e){return!!e})).length)return t.aa.contentType&&"application"!=t.aa.contentType||(t.aa.contentType=Ir(i[0].mimeType,i[0].codecs),i.forEach(function(e){e.type=t.aa.contentType})),i.forEach(function(t){h.drmInfos.forEach(function(e){t.keyId&&e.keyIds.push(t.keyId)})}),a=s.map(function(e){return e.getAttribute("id")}).filter(Vt.Ma),{id:t.aa.id||"__fake__"+this.h++,contentType:t.aa.contentType,language:d,jd:n,streams:i,drmInfos:h.drmInfos,Nd:u,jg:a};if(this.a.dash.ignoreEmptyAdaptationSet||a)return null;throw new me(2,4,4003)},n.bg=function(e,t,n,i,r,a,o,s,u){if(e.A=Ar(u,e.aa,null),c=e.A,l=c.ac?1:0,l+=c.Pa?1:0,!(0!=(l+=c.cc?1:0)?(1!=l&&(ne.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",c),c.ac?(ne.info("Using SegmentBase by default."),c.Pa=null):ne.info("Using SegmentList by default."),c.cc=null),1):"text"==c.contentType||"application"==c.contentType||(ne.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',c),0)))return ne.m("Skipping Representation",e.A),null;var c,l;e.bandwidth=Fi.M(u,"bandwidth",Fi.Bc)||0;var d="text"==(d=e.A.contentType)||"application"==d;try{var f,h,p,m=this.kg.bind(this);p=e.A.ac?function(e,t){var n=Number(Yi(e,fr,"presentationTimeOffset"))||0,i=Yi(e,fr,"timescale"),r=1;i&&(r=Fi.Bc(i)||1),n=n/r||0,i=lr(e,fr);var a=e.A.contentType,r=e.A.mimeType.split("/")[1];if("text"!=a&&"mp4"!=r&&"webm"!=r)throw ne.error("SegmentBase specifies an unsupported container type.",e.A),new me(2,4,4006);if("webm"==r&&!i)throw ne.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.A),new me(2,4,4005);a=$i(e,fr,"RepresentationIndex");var o,s=Yi(e,fr,"indexRange"),u=e.A.ta,s=Fi.Cc(s||"");if(a&&((o=a.getAttribute("sourceURL"))&&(u=qt(e.A.ta,[o])),s=Fi.M(a,"range",Fi.Cc,s)),!s)throw ne.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.A),new me(2,4,4002);return{createSegmentIndex:(r=dr(e,t,i,u,s.start,s.end,r,n)).createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:i,oa:n}}(e,m):e.A.Pa?hr(e,this.o):e.A.cc?mr(e,m,this.o,!!this.c):(f=e.A.ta,h=e.W.duration||0,{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<h?1:null},getSegmentReference:function(e){return 1!=e?null:new Zi(1,0,h,function(){return f},0,null)},initSegmentReference:null,oa:0})}catch(e){if(d&&4002==e.code)return null;throw e}return u=function(e,t,n,i){var r=Vi(e,t,i);if(n.be)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=r.drmInfos),n.be=!1;else if(0<r.drmInfos.length&&(n.drmInfos=n.drmInfos.filter(function(t){return r.drmInfos.some(function(e){return e.keySystem==t.keySystem})}),0==n.drmInfos.length))throw new me(2,4,4008);return r.Xd||n.Xd}(u=Fi.U(u,"ContentProtection"),this.a.dash.customScheme,t,this.a.dash.ignoreDrmInfo),{id:this.h++,originalId:e.A.id,createSegmentIndex:p.createSegmentIndex,findSegmentPosition:p.findSegmentPosition,getSegmentReference:p.getSegmentReference,initSegmentReference:p.initSegmentReference,presentationTimeOffset:p.oa,mimeType:e.A.mimeType,codecs:e.A.codecs,frameRate:e.A.frameRate,pixelAspectRatio:e.A.pixelAspectRatio,bandwidth:e.bandwidth,width:e.A.width,height:e.A.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:i,label:r,type:e.aa.contentType,primary:a,trickModeVideo:null,emsgSchemeIdUris:e.A.emsgSchemeIdUris,roles:o,channelsCount:e.A.qd,audioSamplingRate:e.A.audioSamplingRate,closedCaptions:s}},n.ag=function(i,r,e){var a=Fi.Hb,o=e.getAttribute("schemeIdUri")||"",s=e.getAttribute("value")||"",u=Fi.M(e,"timescale",a)||1;Fi.U(e,"Event").forEach(function(e){var t=Fi.M(e,"presentationTime",a)||0,n=Fi.M(e,"duration",a)||0,n=(t=t/u+i)+n/u;null!=r&&(t=Math.min(t,i+r),n=Math.min(n,i+r)),e={schemeIdUri:o,value:s,startTime:t,endTime:n,id:e.getAttribute("id")||"",eventElement:e},this.b.onTimelineRegionAdded(e)}.bind(this))},n.kg=function(e,t,n){return e=br(e,t,n,this.a.retryParameters),e=this.b.networkingEngine.request(1,e),Ne(this.g,e),e.promise.then(function(e){return e.data})},vr.zd("mpd",wr),vr.Lb("application/dash+xml",wr),vr.Lb("video/vnd.mpeg.dash.mpd",wr),Cr.prototype.toString=function(){var e="#"+this.name,t=this.a?this.a.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Cr.prototype.getAttribute=function(t){var e=this.a.filter(function(e){return e.name==t});return e.length?e[0]:null};var Ur={ub:function(e,t){return e.filter(function(e){return e.name==t})},Ya:function(e,t){var n=Ur.ub(e,t);return n.length?n[0]:null},Xc:function(e,n,i){return e.filter(function(e){var t=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),t.value==n&&e.value==i})},Pc:function(e,t){return qt([e],[t])[0]},gd:function(e){return/^#(?!EXT)/m.test(e)}};function _r(e){this.b=e,this.a=0}function Lr(e){Or(e,/[ \t]+/gm)}function Or(e,t){t.lastIndex=e.a;var n=null==(n=t.exec(e.b))?null:{position:n.index,length:n[0].length,mg:n};return e.a==e.b.length||null==n||n.position!=e.a?null:(e.a+=n.length,n.mg)}function jr(e){return e.a!=e.b.length&&(e=Or(e,/[^ \t\n]*/gm))?e[0]:null}function Kr(){this.a=0}function Br(e,t,n){var i=(t=(t=ot(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))throw new me(2,4,4015);t=0;for(var r=1;r<i.length;r++)if(!Ur.gd(i[r])){var a=Hr(e,i[r]);if(--e.a,Vr.includes(a.name)){t=1;break}"EXT-X-STREAM-INF"==a.name&&(r+=1)}for(r=[],a=1;a<i.length;)if(Ur.gd(i[a]))a+=1;else{var o=Hr(e,i[a]);if(qr.includes(o.name)){if(1!=t)throw new me(2,4,4017);return new Pr(n,t,r,e=Fr(e,n,i=i.splice(a,i.length-a),r))}r.push(o),a+=1,"EXT-X-STREAM-INF"==o.name&&(o.a.push(new Nr("URI",i[a])),a+=1)}return new Pr(n,t,r)}function Fr(t,n,e,i){var r=[],a=[];return e.forEach(function(e){if(/^(#EXT)/.test(e))e=Hr(t,e),Vr.includes(e.name)?i.push(e):a.push(e);else{if(Ur.gd(e))return[];e=Ur.Pc(n,e.trim()),r.push(new Dr(e,a)),a=[]}}),r}function Hr(e,t){var n=e.a++;if(!(s=t.match(/^#(EXT[^:]*)(?::(.*))?$/)))throw new me(2,4,4016,t);var i,r,a=s[1],o=s[2],s=[];if(o){(r=Or(o=new _r(o),/^([^,=]+)(?:,|$)/g))&&(i=r[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;r=Or(o,u);)s.push(new Nr(r[1],r[2]||r[3]))}return new Cr(n,a,s,i)}var Vr="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),qr="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Gr(e){try{var t=Gr.parse(e);return we({uri:e,vd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return ye(e)}}function Wr(){var e=this;this.a=this.f=null,this.ea=1,this.G=new Map,this.V=new Set,this.b=new Map,this.c=null,this.v="",this.u=new Kr,this.T=0,this.h=new de(function(){var i;i=e,$(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return(ne.info("Updating manifest..."),i.f)?(Q(e,2),J(e,i.update(),4)):e.return();case 4:t=i.T,i.h.R(t),Z(e,0);break;case 2:if(n=ee(e),!i.f)return e.return();n.severity=1,i.f.onError(n),i.h.R(.1),K(e)}})})}),this.g=da,this.o=null,this.F=0,this.H=1/0,this.i=new Ce,this.K=[],this.l=new Map,this.$=!1}function zr(d,f){return $(function e(){var t,n,i,r,a,o,s,u,c,l;return te(e,function(e){switch(e.j){case 1:return t=Ur,n=fa,i=f.Pe,J(e,ca(d,_e([i],d.a.retryParameters),0),2);case 2:if(r=e.s,1!=(a=Br(d.u,r.data,r.uri)).type)throw new me(2,4,4017);return s=(o=t.Ya(a.a,"EXT-X-MEDIA-SEQUENCE"))?Number(o.value):0,u=f.stream,J(e,ea(d,f.Jc,a,s,u.mimeType,u.codecs),3);case 3:c=e.s,f.bc.a=c,l=c[c.length-1],t.Ya(a.a,"EXT-X-ENDLIST")&&(ua(d,n.Va),d.c.Ba(l.endTime)),K(e)}})})}function Xr(e){e.forEach(function(e){var t;e&&(t=(t=e.stream.codecs.split(",")).filter(function(e){return"mp4a.40.34"!=e}),e.stream.codecs=t.join(","))})}function Yr(p,m,g){return $(function e(){var n,i,r,a,o,s,u,c,l,d,f,h;return te(e,function(e){switch(e.j){case 1:return(n=ia(m,"URI"),p.b.has(n))?e.return(p.b.get(n)):(i=ia(m,"TYPE").toLowerCase(),r=Wt,"subtitles"==i&&(i=r.va),a=Ln(Rr(m,"LANGUAGE","und")),o=Rr(m,"NAME"),s=m.getAttribute("DEFAULT"),u=m.getAttribute("AUTOSELECT"),c=Rr(m,"CHANNELS"),t="audio"==i&&c?(t=c.split("/")[0],parseInt(t,10)):null,l=t,d=!!s||!!u,f=Rr(m,"CHARACTERISTICS"),J(e,$r(p,n,g,i,a,d,o,l,null,f),2));var t;case 2:return(h=e.s,p.b.has(n))?e.return(p.b.get(n)):null==h?e.return(null):(p.G.set(m.id,h),p.b.set(n,h),e.return(h))}})})}function $r(K,B,F,H,V,q,G,W,z,X){return $(function e(){var u,c,p,m,g,v,y,b,w,T,S,E,x,k,A,M,I,P,C,N,R,D,U,_,L,O,j;return te(e,function(e){switch(e.j){case 1:return c=(u=Ur).Pc(K.v,B),J(e,ca(K,_e([c],K.a.retryParameters),0),2);case 2:if(p=e.s,c=p.uri,1!=(m=Br(K.u,p.data,c)).type)throw new me(2,4,4017);g=[],m.segments.forEach(function(e){e=u.ub(e.b,"EXT-X-KEY"),g.push.apply(g,e)}),v=!1,y=[],b=null;for(var t=Y(g),n=t.next();!n.done;n=t.next())if(w=n.value,"NONE"!=(T=ia(w,"METHOD"))){if(v=!0,"AES-128"==T)return ne.m("Unsupported HLS Encryption",T),K.$=!0,e.return(null);S=ia(w,"KEYFORMAT"),(x=(E=la[S])?E(w):null)?(x.keyIds.length&&(b=x.keyIds[0]),y.push(x)):ne.m("Unsupported HLS KEYFORMAT",S)}if(v&&!y.length)throw new me(2,4,4026);return i=K,r=m,a=fa,o=Ur.Ya(r.a,"EXT-X-PLAYLIST-TYPE"),s=Ur.Ya(r.a,"EXT-X-ENDLIST"),s=o&&"VOD"==o.value||s,o=o&&"EVENT"==o.value&&!s,o=!s&&!o,s?ua(i,a.Va):(ua(i,o?a.Rd:a.Ke),a=ra(r.a,"EXT-X-TARGETDURATION"),a=Number(a.value),i.F=Math.max(a,i.F),i.H=Math.min(a,i.H)),k=function(e,t){if(1==t.length)return t[0];var n=na(e,t);if(null!=n)return n;throw new me(2,4,4025,t)}(H,F),J(e,(l=K,d=H,f=k,h=m,$(function e(){var t,n,i,r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:return t=Wt,n=h.segments[0].a,i=new ie(n),r=i.la.split(".").pop(),a=sa[d],(o=a[r])?e.return(o):d==t.va?f&&"vtt"!=f?e.return("application/mp4"):e.return("text/vtt"):((s=_e([n],l.a.retryParameters)).method="HEAD",J(e,ca(l,s,1),2));case 2:if(u=e.s,!(c=u.headers["content-type"]))throw new me(2,4,4021,r);return e.return(c.split(";")[0])}})})),3);case 3:return A=e.s,oa.includes(A)&&(k=""),I=(M=u.Ya(m.a,"EXT-X-MEDIA-SEQUENCE"))?Number(M.value):0,Q(e,4),J(e,ea(K,B,m,I,A,k),6);case 6:P=e.s,Z(e,5);break;case 4:if(4035==(C=ee(e)).code)return ne.Z("Skipping unsupported HLS stream",A,B),e.return(null);throw C;case 5:return N=P[0].startTime,R=P[P.length-1].endTime,D=R-N,U=new tr(P),_=Jr(m),L="text"==H?"subtitle":void 0,O=[],X&&O.push(X),j={id:K.ea++,originalId:G,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:U.find.bind(U),getSegmentReference:U.get.bind(U),initSegmentReference:_,presentationTimeOffset:0,mimeType:A,codecs:k,kind:L,encrypted:v,keyId:b,language:V,label:G,type:H,primary:q,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:O,channelsCount:W,audioSamplingRate:null,closedCaptions:z},e.return({stream:j,bc:U,drmInfos:y,Jc:B,Pe:c,nd:N,Qg:R,duration:D})}var l,d,f,h,i,r,a,o,s})})}function Jr(e){var t=Ur.ub(e.a,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new me(2,4,4020);var n=ia(t=t[0],"URI"),i=Ur.Pc(e.b,n);return e=0,n=null,(t=Rr(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new Qi(function(){return[i]},e,n)}function Qr(e,t,n,i){var r=t.b,a=t.a;t=ra(r,"EXTINF").value.split(","),t=i+Number(t[0]);var o=0,s=null;return(r=Ur.Ya(r,"EXT-X-BYTERANGE"))&&(o=r.value.split("@"),r=Number(o[0]),s=(o=o[1]?Number(o[1]):e.a+1)+r-1),new Zi(n,i,t,function(){return[a]},o,s)}function Zr(t){t.c&&(t.K.forEach(function(e){t.c.Eb(e,0)}),t.K=[])}function ea(f,b,w,T,S,E){return $(function e(){var n,i,r,a,o,s,u,c,l,d;return te(e,function(e){switch(e.j){case 1:return n=w.segments,i=[],r=n[0].a,a=Qr(null,n[0],T,0),o=Jr(w),J(e,(h=f,p=b,m=o,g=a,v=S,y=E,$(function e(){var r,a,o,s,u,c,l,d,f;return te(e,function(e){switch(e.j){case 1:if(h.o){if(r=h.b.get(p),a=r.bc,o=a.get(g.position))return ne.D("Found segment start time in previous manifest"),e.return(o.startTime);ne.debug("Unable to find segment start time in previous manifest!")}if(ne.D("Fetching segment to find start time"),v=v.toLowerCase(),oa.includes(v))throw ne.Z("Raw formats are not yet supported.  Skipping "+v),new me(1,4,4035);if("video/webm"==v)throw ne.Z("WebM in HLS is not yet supported.  Skipping."),new me(1,4,4035);if("video/mp4"==v||"audio/mp4"==v)return s=[ta(h,g)],m&&s.push(ta(h,m)),J(e,Promise.all(s),3);e.C(2);break;case 3:return u=e.s,c=u[0],l=u[1]||u[0],e.return(function(e,t,n,i){var r=0;if((new Di).L("moov",Ui).L("trak",Ui).L("mdia",Ui).ia("mdhd",function(e){e.reader.P(0==e.version?8:16),r=e.reader.I(),e.parser.stop()}).parse(i,!0),!r)throw ne.error("Unable to find timescale in init segment!"),new me(2,4,4030,e,t);var a=0,o=!1;if((new Di).L("moof",Ui).L("traf",Ui).ia("tfdt",function(e){a=(0==e.version?e.reader.I():e.reader.Kb())/r,o=!0,e.parser.stop()}).parse(n,!0),!o)throw new me(2,4,4030,e,t);return a}(p,c.uri,c.data,l.data));case 2:if("video/mp2t"==v)return J(e,ta(h,g),5);e.C(4);break;case 5:return d=e.s,e.return(function(e,t,n){function i(){a.seek(o+188),71!=(s=a.na())&&(a.seek(o+192),s=a.na()),71!=s&&(a.seek(o+204),s=a.na()),71!=s&&r(),a.ze(1)}function r(){throw new me(2,4,4030,e,t)}for(var a=new Ci(new DataView(n),0),o=0,s=0;;)if(o=a.ga(),71!=(s=a.na())&&r(),8191==(8191&(n=a.$b())))i();else if(16384&n){if(0!=(n=(48&a.na())>>4)&&2!=n||r(),3==n&&(n=a.na(),a.P(n)),1==a.I()>>8){a.P(3),0!=(n=a.na()>>6)&&1!=n||r(),0==a.na()&&r(),n=a.na();var u=a.$b(),c=a.$b();return(1073741824*((14&n)>>1)+((65534&u)<<14|(65534&c)>>1))/9e4}i()}else i()}(p,d.uri,d.data));case 4:if("application/mp4"==v||v.startsWith("text/"))return J(e,ta(h,g),7);e.C(6);break;case 7:return f=e.s,e.return((t=v,n=y,i=f.data,vn(t=Xe(t,n))?(yn(n=new mn(null),t),n.sc(i)):0));case 6:throw new me(2,4,4030,p)}var t,n,i})})),2);case 2:s=e.s,ne.debug("First segment",r.split("/").pop(),"starts at",s);for(var t=0;t<n.length;++t)u=n[t],c=i[i.length-1],l=0==t?s:c.endTime,d=Qr(c,u,T+t,l),i.push(d);return f.K.push(i),Zr(f),e.return(i)}var h,p,m,g,v,y})})}function ta(s,u){return $(function e(){var t,n,i,r,a,o;return te(e,function(e){switch(e.j){case 1:return(t=1,n=br(u.c(),u.b,u.b+2048-1,s.a.retryParameters),i=br(u.c(),u.b,u.a,s.a.retryParameters),s.a.hls.useFullSegmentsForStartTime)?e.return(ca(s,i,t)):(Q(e,2),J(e,ca(s,n,t),4));case 4:return r=e.s,e.return(r);case 2:if(7001==(a=ee(e)).code)throw a;return ne.Z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",n.uris[0]),J(e,ca(s,i,t),5);case 5:return o=e.s,e.return(o)}})})}function na(e,t){for(var n=aa[e],i=0;i<n.length;i++)for(var r=0;r<t.length;r++)if(n[i].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function ia(e,t){var n=e.getAttribute(t);if(!n)throw new me(2,4,4023,t);return n.value}function ra(e,t){var n=Ur.Ya(e,t);if(!n)throw new me(2,4,4024,t);return n}R("shaka.net.DataUriPlugin",Gr),Gr.parse=function(e){if((n=e.split(":")).length<2||"data"!=n[0])throw ne.error("Bad data URI, failed to parse scheme"),new me(2,1,1004,e);if((n=n.slice(1).join(":").split(",")).length<2)throw ne.error("Bad data URI, failed to extract encoding and MIME type"),new me(2,1,1004,e);var t=n[0],n=f.decodeURIComponent(n.slice(1).join(",")),i=null;if(1<(t=t.split(";")).length&&(i=t[1]),"base64"==i)e=ht.Fa(n).buffer;else{if(i)throw ne.error("Bad data URI, unknown encoding"),new me(2,1,1005,e);e=ct(n)}return{data:e,contentType:t[0]}},Ue("data",Gr),R("shaka.hls.HlsParser",Wr),(n=Wr.prototype).configure=function(e){this.a=e},n.start=function(i,r){var a=this;return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return a.f=r,J(e,ca(a,_e([i],a.a.retryParameters),0),2);case 2:return t=e.s,a.v=t.uri,J(e,(m=a,g=t.data,$(function e(){var i,r,a,o,s,u,c,l,d,f;return te(e,function(e){switch(e.j){case 1:if(0!=(i=Br(m.u,g,m.v)).type)throw new me(2,4,4022);return J(e,(h=m,p=i,$(function e(){var t,n,i,r,a,o,s,u,c,l,d,f;return te(e,function(e){switch(e.j){case 1:return t=Ur,n=Vt,i=p.a,r=t.ub(p.a,"EXT-X-MEDIA"),a=r.filter(function(e){return"SUBTITLES"==ia(e,"TYPE")}.bind(h)),o=a.map(function(r){var a=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return a.a.disableText?e.return(null):(Q(e,2),J(e,(n=a,i=r,$(function e(){var t;return te(e,function(e){switch(e.j){case 1:return ia(i,"TYPE"),J(e,Yr(n,i,[]),2);case 2:return t=e.s,e.return(t.stream)}})})),4));case 4:return e.return(e.s);case 2:if(t=ee(e),a.a.hls.ignoreTextStreamFailures)return e.return(null);throw t}var n,i})})}.bind(h)),s=r.filter(function(e){return"CLOSED-CAPTIONS"==ia(e,"TYPE")}),function(e,t){for(var n=Y(t),i=n.next();!i.done;i=n.next()){ia(i=i.value,"TYPE");var r=Rr(i,"LANGUAGE")||"und";r=Ln(r);var a=ia(i,"GROUP-ID");i=ia(i,"INSTREAM-ID"),e.l.get(a)||e.l.set(a,new Map),e.l.get(a).set(i,r)}}(h,s),J(e,Promise.all(o),2);case 2:return u=e.s,c=t.ub(i,"EXT-X-STREAM-INF"),l=c.map(function(e){return R=this,D=e,U=p,$(function e(){var t,n,i,r,a,l,d,f,h,p,m,g,v,y,b,w,T,S,E,x,k,A,M,I,P,C,N;return te(e,function(e){switch(e.j){case 1:return t=Wt,n=Ur,i=Rr(D,"CODECS","avc1.42E01E,mp4a.40.2"),r=function(e){for(var t=new Set,n=[],i=(e=Y(e)).next();!i.done;i=e.next()){var r=Ye(i=i.value)[0];t.has(r)?ne.debug("Ignoring duplicate codec"):(n.push(i),t.add(r))}return n}(i.split(/\s*,\s*/)),a=D.getAttribute("RESOLUTION"),d=l=null,f=Rr(D,"FRAME-RATE"),h=Number(ia(D,"BANDWIDTH")),a&&(p=a.value.split("x"),l=p[0],d=p[1]),m=(m=(m=n.ub(U.a,"EXT-X-MEDIA")).filter(function(e){return"CLOSED-CAPTIONS"!=ia(e,"TYPE")})).filter(function(e){var t=Rr(e,"URI")||"";return"SUBTITLES"==(Rr(e,"TYPE")||"")||""!=t}),g=Rr(D,"AUDIO"),v=Rr(D,"VIDEO"),g?m=n.Xc(m,"AUDIO",g):v&&(m=n.Xc(m,"VIDEO",v)),(y=na(t.va,r))&&((b=Rr(D,"SUBTITLES"))&&(w=n.Xc(m,"SUBTITLES",b)).length&&(T=R.G.get(w[0].id))&&(T.stream.codecs=y),Ie(r,y)),S=m.map(function(e){return Yr(this,e,r)}.bind(R)),E=[],x=[],J(e,Promise.all(S),2);case 2:if(A=(A=e.s).filter(function(e){return null!=e}),g?E=A:v&&(x=A),ne.debug("Guessing stream type for",D.toString()),I=!1,E.length||x.length?E.length?(C=ia(D,"URI"),N=E[0].Jc,C==N?(ne.debug("Guessing audio-only."),M=t.Nb,I=!0):(ne.debug("Guessing video."),M=t.Ua)):(ne.debug("Guessing audio."),M=t.Nb):1==r.length?(P=na(t.Ua,r),M=a||f||P?(ne.debug("Guessing video-only."),t.Ua):(ne.debug("Guessing audio-only."),t.Nb)):(ne.debug("Guessing multiplexed audio+video."),M=t.Ua,r=[r.join(",")]),I){e.C(3);break}return J(e,(o=R,s=D,u=r,c=M,$(function e(){var t,n,i,r,a;return te(e,function(e){switch(e.j){case 1:return t=Wt,n=ia(s,"URI"),o.b.has(n)?e.return(o.b.get(n)):(i=Rr(s,"CLOSED-CAPTIONS"),r=null,c==t.Ua&&i&&"NONE"!=i&&(r=o.l.get(i)),J(e,$r(o,n,u,c,"und",!1,null,null,r,null),2));case 2:return null==(a=e.s)?e.return(null):o.b.has(n)?e.return(o.b.get(n)):(o.b.set(n,a),e.return(a))}})})),4);case 4:k=e.s;case 3:if(k)k.stream.type==t.Nb?E=[k]:x=[k];else if(null===k)return ne.debug("streamInfo is null"),e.return([]);return x&&Xr(x),E&&Xr(E),e.return(function(e,t,n,i,r,a,o){n.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(a)||void 0,e.frameRate=Number(o)||void 0)}.bind(e));var s=!!e.a&&e.a.disableAudio;t.length&&!s||(t=[null]),s=!!e.a&&e.a.disableVideo,n.length&&!s||(n=[null]),s=[];for(var u,c,l,d,f=(t=Y(t)).next();!f.done;f=t.next()){f=f.value;for(var h=Y(n),p=h.next();!p.done;p=h.next()){var m=p.value;p=f?f.stream:null;var g=m?m.stream:null,v=f?f.drmInfos:null,y=m?m.drmInfos:null;m=(m?m.Jc:"")+" - "+(f?f.Jc:"");var b=void 0;if(p&&g){if(v.length&&y.length&&!(0<Ct(v,y).length)){ne.m("Incompatible DRM info in HLS variant.  Skipping.");continue}b=Ct(v,y)}else p?b=v:g&&(b=y);e.V.has(m)?ne.debug("Skipping variant which only differs in text streams."):(u=p,c=g,l=i,d=b,p={id:e.ea++,language:u?u.language:"und",primary:!!u&&u.primary||!!c&&c.primary,audio:u,video:c,bandwidth:l,drmInfos:d,allowedByApplication:!0,allowedByKeySystem:!0},s.push(p),e.V.add(m))}}return s}(R,E,x,h,l,d,f))}var o,s,u,c})});var R,D,U}.bind(h)),J(e,Promise.all(l),3);case 3:return d=e.s,f=(f=d.reduce(n.Oc,[])).filter(function(e){return null!=e}),e.return({startTime:0,variants:f,textStreams:u.filter(function(e){return null!=e})})}})})),2);case 2:if(r=e.s,!m.f)throw new me(2,7,7001);if(m.$&&0==r.variants.length)throw ne.info("No stream is created, because we don't support AES-128","encryption yet"),new me(2,4,4034);m.f.filterAllPeriods([r]),a=1/0,s=1/(o=0);for(var t=Y(m.b.values()),n=t.next();!n.done;n=t.next())u=n.value,a=Math.min(a,u.nd),o=Math.max(o,u.nd),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(m.g!=fa.Va?(m.c=new yr(0,3*m.F),m.c.dc(!1)):(m.c=new yr(null,0),m.c.dc(!0)),Zr(m),m.g!=fa.Va){for(m.T=m.H,m.g==fa.Rd&&(c=m.c.Dc,isNaN(m.a.availabilityWindowOverride)||(c=m.a.availabilityWindowOverride),m.c.Jd(c)),l=0;95443.7176888889<=o;)l+=95443.7176888889,o-=95443.7176888889;if(l)for(ne.debug("Offsetting live streams by",l,"to compensate for rollover"),n=(t=Y(m.b.values())).next();!n.done;n=t.next())(d=n.value).nd<95443.7176888889?(ne.D("Offset applied to",d.stream.type),d.stream.presentationTimeOffset=-l,d.bc.offset(l)):ne.D("Offset NOT applied to",d.stream.type)}else for(m.c.Ba(s),m.c.offset(-a),n=(t=Y(m.b.values())).next();!n.done;n=t.next())(f=n.value).stream.presentationTimeOffset=a,f.bc.offset(-a),nr(f.bc,s);m.o={presentationTimeline:m.c,periods:[r],offlineSessionIds:[],minBufferTime:0},K(e)}var h,p})})),3);case 3:return 0<(n=a.T)&&a.h.R(n),e.return(a.o)}var m,g})})},n.stop=function(){this.h&&(this.h.stop(),this.h=null);var e=[];return this.i&&(e.push(this.i.destroy()),this.i=null),this.a=this.f=null,this.G.clear(),this.V.clear(),this.b.clear(),this.o=null,Promise.all(e)},n.update=function(){if(this.g!=fa.Va){for(var e=[],t=Y(this.b.values()),n=t.next();!n.done;n=t.next())e.push(zr(this,n.value));return Promise.all(e)}},n.onExpirationUpdated=function(){};var aa={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},oa=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],sa={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function ua(e,t){e.g=t,e.c&&e.c.dc(e.g==fa.Va),e.g!=fa.Va||e.h.stop()}function ca(e,t,n){if(!e.i)throw new me(2,7,7001);return t=e.f.networkingEngine.request(n,t),Ne(e.i,t),t.promise}var la={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ia(e,"METHOD");qn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var n=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return n.includes(t)?(t=ia(e,"URI"),t=Gr.parse(t),t=Gt("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=Rr(e,"KEYID"))&&(t.keyIds=[e.substr(2).toLowerCase()]),t):(ne.error("Widevine in HLS is only supported with [",n.join(", "),"], not",t),null)}},da="VOD",fa={Va:da,Ke:"EVENT",Rd:"LIVE"};function ha(){this.a=new Map}function pa(e,t,n){ma(e,t).text=n}function ma(e,t){return e.a.has(t)||e.a.set(t,new ga),e.a.get(t)}function ga(){this.text=this.variant=null}function va(e,t){this.a=e,this.b=new Set([e]);for(var n=Y(t=t||[]),i=n.next();!i.done;i=n.next())this.add(i.value)}function ya(e,t){var n,i;return!(i=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(i=e.audio&&t.audio)&&(i=e.audio,n=t.audio,i=!(i.channelsCount==n.channelsCount&&ba(i,n)&&wa(i.roles,n.roles))),!i&&(i=e.video&&t.video)&&(i=!(ba(i=e.video,n=t.video)&&wa(i.roles,n.roles))),!i}function ba(e,t){if(e.mimeType==t.mimeType){var n=e.codecs.split(",").map(function(e){return Ye(e)[0]}),i=t.codecs.split(",").map(function(e){return Ye(e)[0]});if(n.length==i.length){n.sort(),i.sort();for(var r=0;r<n.length;r++)if(n[r]!=i[r])return;return 1}}}function wa(e,t){var n=new Set(e),i=new Set(t);if(n.delete("main"),i.delete("main"),n.size==i.size){for(var r=(n=Y(n)).next();!r.done;r=n.next())if(!i.has(r.value))return;return 1}}function Ta(e){this.a=e,this.b=new Sa(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function Sa(e,t,n,i,r){this.f=e,this.c=t,this.a=n,this.b=void 0===i?"":i,this.g=void 0===r?"":r}function Ea(){this.a=Aa,this.b=(new Map).set(Aa,2).set(ka,1)}function xa(e,t,n){e.b.set(Aa,n).set(ka,t)}vr.zd("m3u8",Wr),vr.Lb("application/x-mpegurl",Wr),vr.Lb("application/vnd.apple.mpegurl",Wr),va.prototype.add=function(e){return ya(this.a,e)?(this.b.add(e),!0):(ne.m("Rejecting variant - not compatible with root."),!1)},va.prototype.values=function(){return this.b.values()},Ta.prototype.create=function(e){var t=this,n=e.filter(function(e){return ya(t.a,e)});return n.length?new va(n[0],n):this.b.create(e)},Sa.prototype.create=function(e){var t,n,i,r=[];t=e,n=this.f,r=(i=jn(Ln(n),t.map(On)))?t.filter(function(e){return i==On(e)}):[];var a,o,s,u,c,l=e.filter(function(e){return e.primary}),r=r.length?r:l.length?l:e;for(this.c&&(a=r,o=this.c,s=this.g,(e=a.filter(function(e){if(s){var t=e[s];return t&&t.roles.includes(o)}return t=e.audio,e=e.video,t&&0<=t.roles.indexOf(o)||e&&0<=e.roles.indexOf(o)})).length?r=e:ne.m("No exact match for variant role could be found.")),this.a&&((e=Bn.$d(r,this.a)).length?r=e:ne.m("No exact match for the channel count could be found.")),this.b&&(u=r,c=this.b,(e=u.filter(function(e){return!!e.audio&&e.audio.label.toLowerCase()==c.toLowerCase()})).length?r=e:ne.m("No exact match for variant label could be found.")),e=new va(r[0]),l=(r=Y(r)).next();!l.done;l=r.next())l=l.value,ya(e.a,l)&&e.add(l);return e};var ka=0,Aa=1;function Ma(e,t){this.g=e,this.h=Pa(e),this.a=e.a.currentTime,this.f=Date.now()/1e3,this.b=!1,this.i=t,this.c=function(){}}function Ia(e){this.a=e}function Pa(e){if(e.a.paused||0==e.a.playbackRate||0==e.a.buffered.length)var t=!1;else e:{t=e.a.buffered,e=e.a.currentTime;for(var n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(!(e<i-.1||r-.5<e)){t=!0;break e}}t=!1}return t}function Ca(e,t,n,i,r){var a=this;this.a=e,this.v=t,this.u=n,this.l=r,this.f=new Ke,this.i=!1,this.o=e.readyState,this.c=!1,this.b=i,this.h=!1,this.f.B(e,"waiting",function(){return Na(a)}),this.g=new de(function(){Na(a)}).Ra(.25)}function Na(e){if(0!=e.a.readyState){if(e.a.seeking){if(!e.i)return}else e.i=!1;var t,n,i,r,a,o,s,u;if(!e.a.paused)if(e.a.readyState!=e.o&&(e.c=!1,e.o=e.a.readyState),(t=!e.b)||(i=Pa(n=(t=e.b).g),r=n.a.currentTime,a=Date.now()/1e3,t.a==r&&t.h==i||(t.f=a,t.a=r,t.h=i,t.b=!1),(i=(r=a-t.f)>=t.i&&i&&!t.b)&&(t.c(t.a,r),t.b=!0,t.a=n.a.currentTime),t=!i),t){a=e.u.smallGapLimit,t=e.a.currentTime;e:{if((n=e.a.buffered)&&n.length&&!(1==n.length&&n.end(0)-n.start(0)<1e-6))for(i=nt("Edge/")||nt("Trident/")||Ze()||nt("CrKey")?.5:.1,r=0;r<n.length;r++)if(n.start(r)>t&&(0==r||n.end(r-1)-t<=i)){i=r;break e}i=null}null==i||0==i&&!e.h||(r=n.start(i),(o=e.v.Ga())<=r||(a=(o=r-t)<=a,s=!1,o<.001||(a||e.c||(e.c=!0,(u=new Ee("largegap",{currentTime:t,gapSize:o})).cancelable=!0,e.l(u),e.u.jumpLargeGaps&&!u.defaultPrevented?s=!0:ne.info("Ignoring large gap at",t,"size",o)),(a||s)&&(0==i?ne.info("Jumping forward",o,"seconds because of gap before start time of",r):ne.info("Jumping forward",o,"seconds because of gap starting at",n.end(i-1),"and ending at",r),e.a.currentTime=r))))}}}function Ra(e){var t=this;this.c=e,this.a=new Set,this.b=new de(function(){Da(t,!1)}).Ra(.25)}function Da(e,t){for(var n=Y(e.a),i=n.next();!i.done;i=n.next())i.value.g(e.c.currentTime,t)}function Ua(e){for(var t=[],n=(e=Y(e)).next();!n.done;n=e.next())for(var i=(n=Y(n.value.variants)).next();!i.done;i=n.next())t.push(i.value);return t}function _a(e,t){for(var n=null,i=Y(e),r=i.next();!r.done;r=i.next())t>=(r=r.value).startTime&&(n=r);return n}function La(e){this.c=e,this.a=null,this.b=function(){}}function Oa(e){var t=this;this.a=e,this.f=!1,this.c=this.a.rc(),this.b=new de(function(){t.a.le(.25*t.c)})}function ja(e){e.b.stop();var t=e.f?0:e.c;if(0<=t)try{return void(e.a.rc()!=t&&e.a.Id(t))}catch(e){}e.b.Ra(.25),0!=e.a.rc()&&e.a.Id(0)}function Ka(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Ba.get(t),n.ua(e,t,i))}Ma.prototype.release=function(){this.g=null,this.c=function(){}},Ca.prototype.release=function(){this.f&&(this.f.release(),this.f=null),null!=this.g&&(this.g.stop(),this.g=null),this.b&&(this.b.release(),this.b=null),this.a=this.v=this.l=null},Ca.prototype.td=function(){this.h=!0,Na(this)},Ra.prototype.release=function(){this.b.stop();for(var e=Y(this.a),t=e.next();!t.done;t=e.next())t.value.release();this.a.clear()},La.prototype.release=function(){this.a=this.c=null,this.b=function(){}},La.prototype.g=function(e){var t=this.a,n=this.c.periods;t!=(e=_a(n,e)||n[0])&&this.b(e),this.a=e},Oa.prototype.release=function(){this.b&&(this.b.stop(),this.b=null),this.a=null},Oa.prototype.set=function(e){this.c=e,ja(this)};var Ba=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Fa(e,t,n){var i=this;this.a=e,this.g=t,this.f=n,this.h=!1,this.b=new Ke,this.c=new Wa(e),Ka(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){qa(i,i.f)})}function Ha(e){return e.h?e.a.currentTime:e.f}function Va(e,t){0<e.a.readyState?za(e.c,t):Ka(e.a,HTMLMediaElement.HAVE_METADATA,e.b,function(){qa(e,e.f)})}function qa(e,t){Math.abs(e.a.currentTime-t)<.001?Ga(e):(e.b.ua(e.a,"seeking",function(){Ga(e)}),za(e.c,0==e.a.currentTime?t:e.a.currentTime))}function Ga(e){e.h=!0,e.b.B(e.a,"seeking",function(){return e.g()})}function Wa(e){var t=this;this.b=e,this.h=10,this.g=this.c=this.f=0,this.a=new de(function(){t.f<=0?(ne.m(["Failed to move playhead from",t.c,"to",t.g].join(" ")),t.a.stop()):t.b.currentTime!=t.c?t.a.stop():(t.b.currentTime=t.g,t.f--)})}function za(e,t){e.c=e.b.currentTime,e.g=t,e.f=e.h,e.b.currentTime=t,e.a.Ra(.1)}function Xa(e){var t=this;this.a=e,this.f=!1,this.c=null,this.b=new Ke,Ka(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){null==t.c?t.f=!0:(t.b.ua(t.a,"seeking",function(){t.f=!0}),t.a.currentTime=Math.max(0,t.a.currentTime+t.c))})}function Ya(e,t,n,i,r,a){var o,s,u=this;this.b=e,this.a=t.presentationTimeline,this.F=t.minBufferTime||0,this.h=n,this.v=r,this.l=null,this.f=new Ca(e,t.presentationTimeline,n,function(n,e){if(!e.stallEnabled)return null;var i=e.stallSkip,t=new Ma(new Ia(n),e.stallThreshold);return function(e,t){e.c=t}(t,function(e,t){ne.debug("Stall detected at "+e+" for "+t+" seconds."),i?(ne.debug("Seeking forward "+i+" seconds to break stall."),n.currentTime+=i):(ne.debug("Pausing and unpausing to break stall."),n.pause(),n.play())}),t}(e,n),a),this.c=new Fa(e,function(){e:{var e=u.f;e.i=!0,e.h=!1,e.c=!1,e=Ha(u.c);var t=Ja(u,e);if(.001<Math.abs(t-e)){var n=(new Date).getTime()/1e3;if(!u.l||u.l<n-1){u.l=n,Va(u.c,t),e=void 0;break e}}ne.D("Seek to "+e),u.v(),e=void 0}return e},(o=this,null==(s=i)?s=1/0>o.a.ca()?o.a.wb():o.a.Ga():s<0&&(s=o.a.Ga()+s),$a(o,Qa(o,s)))),this.i=new de(function(){var e,t,n;0==u.b.readyState||u.b.paused||(e=u.b.currentTime,t=u.a.wb(),(n=u.a.Ga())-t<3&&(t=n-3),e<t&&(t=Ja(u,e),ne.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),u.b.currentTime=t))}).Ra(.25)}function $a(e,t){var n=e.a.ca();return n<=t?n-e.h.durationBackoff:t}function Ja(e,t){var n=Bt.bind(null,e.b.buffered),i=Math.max(e.F,e.h.rebufferingGoal),r=e.h.safeSeekOffset,a=e.a.wb(),o=e.a.Ga(),s=e.a.ca();o-a<3&&(a=o-3);var u=e.a.Vb(i),c=e.a.Vb(r),i=e.a.Vb(i+r);return s<=t?(ne.D("Playhead past duration."),$a(e,t)):o<t?(ne.D("Playhead past end."),o):t<a?n(c)?(ne.D("Playhead before start & start is buffered"),c):(ne.D("Playhead before start & start is unbuffered"),i):u<=t||n(t)?(ne.D("Playhead in safe region or in buffered region."),t):(ne.D("Playhead outside safe region & in unbuffered region."),i)}function Qa(e,t){var n=e.a.wb();return t<n||(n=e.a.Ga())<t?n:t}function Za(){this.b=function(){},this.a=new Set}function eo(e){var n=this;this.h=e,this.f=new Map,this.a=function(){},this.b=function(){},this.c=function(){},this.i=[{lb:null,kb:no,ab:function(e,t){return n.a(e,t)}},{lb:to,kb:no,ab:function(e,t){return n.a(e,t)}},{lb:io,kb:no,ab:function(e,t){return n.a(e,t)}},{lb:no,kb:to,ab:function(e,t){return n.b(e,t)}},{lb:no,kb:io,ab:function(e,t){return n.b(e,t)}},{lb:to,kb:io,ab:function(e,t){return n.c(e,t)}},{lb:io,kb:to,ab:function(e,t){return n.c(e,t)}}]}Fa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),null!=this.c&&(this.c.release(),this.c=null),this.g=function(){},this.a=null},Wa.prototype.release=function(){this.a&&(this.a.stop(),this.a=null),this.b=null},Xa.prototype.release=function(){this.b&&(this.b.release(),this.b=null),this.a=null},Xa.prototype.o=function(e){this.c=this.f?this.c:e},Xa.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0},Xa.prototype.u=function(){},Ya.prototype.release=function(){this.c&&(this.c.release(),this.c=null),this.f&&(this.f.release(),this.f=null),this.i&&(this.i.stop(),this.i=null),this.b=this.c=this.a=this.h=null,this.v=function(){}},Ya.prototype.o=function(e){Va(this.c,e)},Ya.prototype.g=function(){var e=Ha(this.c);return 0<this.b.readyState&&!this.b.paused?Qa(this,e):e},Ya.prototype.u=function(){this.f.td()},Za.prototype.release=function(){this.b=function(){},this.a.clear()},eo.prototype.release=function(){this.h=null,this.f.clear(),this.a=function(){},this.b=function(){},this.c=function(){}},eo.prototype.g=function(e,t){for(var n=Y(this.h.a),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.f.get(i),a=e<i.startTime?to:e>i.endTime?io:no;this.f.set(i,a);for(var o=Y(this.i),s=o.next();!s.done;s=o.next())(s=s.value).lb==r&&s.kb==a&&s.ab(i,t)}};var to=1,no=2,io=3;function ro(e,t){this.a=t,this.c=e,this.g=null,this.l=1,this.v=Promise.resolve(),this.h=[],this.i=new Map,this.b=new Map,this.u=!1,this.H=null,this.G=this.f=this.o=!1,this.F=0}function ao(e){return so(e,"audio")}function oo(e){return so(e,"video")}function so(e,t){var n=e.b.get(t);return n?n.Oa||n.stream:null}function uo(l,d){return $(function e(){var t,n,i,r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:return t=Wt,J(e,Cn(l.a.O,t.va),2);case 2:return l.F++,l.G=!1,n=l.F,i=l.a.O,r=new Map,a=new Set,r.set(t.va,d),a.add(d),J(e,i.init(r,!1),3);case 3:return l.f?e.return():J(e,vo(l,a),4);case 4:if(l.f)return e.return();o=l.a.O.g.isTextVisible()||l.g.alwaysStreamText,l.F!=n||l.b.has(t.va)||l.G||!o||(s=l.a.Za(),u=ko(l,s),c=mo(d,u,0),l.b.set(t.va,c),Po(l,c,0)),K(e)}})})}function co(e,t){var n,i,r=e.b.get("video");!r||(n=r.stream)&&(ne.debug("setTrickPlay",t),t?(i=n.trickModeVideo)&&!r.Oa&&(ne.debug("Engaging trick mode stream",i),fo(e,i,!1,0,!1),r.Oa=n):(n=r.Oa)&&(ne.debug("Restoring non-trick-mode stream",n),fo(e,n,!(r.Oa=null),0,!1)))}function lo(e,t,n,i){var r,a=!1;return t.video&&(r=fo(e,t.video,n,i,!1),a=a||r),t.audio&&(e=fo(e,t.audio,n,i,!1),a=a||e),a}function fo(t,e,n,i,r){var a=t.b.get(e.type);if(!a&&"text"==e.type&&t.g.ignoreTextStreamFailures)return uo(t,e),!0;if(!a)return!1;var o=Ao(t,e),s=Array.from(t.b.values()).every(function(e){return e.ka==a.ka});return n&&o!=a.ka&&s?(ne.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),t.b.forEach(function(e){ho(t,e)}),!0):(a.Oa&&(ne.debug("switch during trick play mode",e),e.trickModeVideo?(e=(a.Oa=e).trickModeVideo,ne.debug("switch found trick play stream",e)):(a.Oa=null,ne.debug("switch found no special trick play stream"))),!(!(s=t.h[o])||!s.Mb)&&(!(!(s=t.i.get(e.id))||!s.Mb)&&(a.stream!=e||r?("text"==e.type&&En(t.a.O,Xe(e.mimeType,e.codecs)),a.stream=e,a.vc=!0,ne.debug("switch: switching to Stream "+Do(a)),function(e,t,n){if(!t.fb)return;var i=e.a.Za(),r=An(e.a.O,t.type),a=wo(e,t,i,r,n);return n=a&&a.a?a.a-a.b:null,a&&!n&&(n=(a.endTime-a.sc())*t.stream.bandwidth/8),!isNaN(n)&&((a=t.stream.initSegmentReference)&&(n+=(a.a?a.a-a.b:null)||0),a=e.a.getBandwidthEstimate(),8*n/a<r-i-Math.max(e.c.minBufferTime||0,e.g.rebufferingGoal)||t.fb.b.a>n)}(t,a,o)&&(ne.info("Aborting current segment request to switch."),a.fb.abort()),n&&(a.Wa?a.Kc=!0:a.Na?(a.Sa=!0,a.lc=i,a.Kc=!0):(Co(a),Io(t,a,!0,i).catch(function(e){t.a&&t.a.onError(e)}))),!0):(ne.debug("switch: Stream "+Do(a)+" already active"),!1))))}function ho(t,e){var n=Do(e);e.Wa?ne.debug(n,"clear: already clearing the buffer"):e.Sa?ne.debug(n,"clear: already waiting"):e.Na?(ne.debug(n,"clear: currently updating"),e.Sa=!0,e.lc=0):null==kn(t.a.O,e.type)?(ne.debug(n,"clear: nothing buffered"),null==e.Ka&&Po(t,e,0)):(ne.debug(n,"clear: handling right now"),Co(e),Io(t,e,!1,0).catch(function(e){t.a&&t.a.onError(e)}))}function po(l,d,f,h,p){return $(function e(){var i,r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:return i=l.a.Za(),r=ko(l,i),a=Wt,o=new Map,s=new Set,d&&(o.set(a.Nb,d),s.add(d)),f&&(o.set(a.Ua,f),s.add(f)),h&&(o.set(a.va,h),s.add(h)),u=l.a.O,c=l.g.forceTransmuxTS,J(e,u.init(o,c),2);case 2:return l.f?e.return():((n=(t=l).c.presentationTimeline.ca())<1/0?t.a.O.Ba(n):t.a.O.Ba(Math.pow(2,32)),J(e,vo(l,s),3));case 3:if(l.f)return e.return();o.forEach(function(e,t){var n;l.b.has(t)||(n=mo(e,r,p),l.b.set(t,n),Po(l,n,0))}),K(e)}var t,n})})}function mo(e,t,n){return{stream:e,type:e.type,Cb:null,Ha:null,Oa:null,vc:!0,ka:t,endOfStream:!1,Na:!1,Ka:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:n||0,fb:null}}function go(e,t){var n=e.h[t];if(n)return ne.debug("(all) Period "+t+" is being or has been set up"),n.promise;ne.debug("(all) setting up Period "+t),n={promise:new ge,Mb:!1},e.h[t]=n;for(var i=new Set,r=Y(e.c.periods[t].variants),a=r.next();!a.done;a=r.next())(a=a.value).video&&i.add(a.video),a.video&&a.video.trickModeVideo&&i.add(a.video.trickModeVideo),a.audio&&i.add(a.audio);for(a=(r=Y(e.c.periods[t].textStreams)).next();!a.done;a=r.next())i.add(a.value);return e.v=e.v.then(function(){if(!this.f)return vo(this,i)}.bind(e)).then(function(){this.f||(this.h[t].promise.resolve(),this.h[t].Mb=!0,ne.D("(all) setup Period "+t))}.bind(e)).catch(function(e){this.f||(this.h[t].promise.catch(function(){}),this.h[t].promise.reject(),delete this.h[t],ne.m("(all) failed to setup Period "+t),this.a.onError(e))}.bind(e)),n.promise}function vo(l,d){return $(function e(){var i,r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:i=[];for(var t=Y(d),n=t.next();!n.done;n=t.next())r=n.value,(a=l.i.get(r.id))?(ne.debug("(all) Stream "+r.id+" is being or has been set up"),i.push(a.promise)):(ne.D("(all) setting up Stream "+r.id),l.i.set(r.id,{promise:new ge,Mb:!1}),i.push(r.createSegmentIndex()));return Q(e,2),J(e,Promise.all(i),4);case 4:if(l.f)return e.return();Z(e,3);break;case 2:if(o=ee(e),l.f)return e.return();for(n=(e=Y(d)).next();!n.done;n=e.next())s=n.value,l.i.get(s.id).promise.catch(function(){}),l.i.get(s.id).promise.reject(),l.i.delete(s.id);throw o;case 3:for(n=(t=Y(d)).next();!n.done;n=t.next())u=n.value,(c=l.i.get(u.id)).Mb||(c.promise.resolve(),c.Mb=!0,ne.D("(all) setup Stream "+u.id));K(e)}})})}function yo(t,e){if(!t.f){var n=Do(e);if(!e.Na&&null!=e.Ka&&!e.Wa)if(e.Ka=null,e.Sa)ne.debug(n,"skipping update and clearing the buffer"),Io(t,e,e.Kc,e.lc);else{try{var i=function(t,e){if(Eo(e))return Pn(t.a.O,e.stream.originalId||""),null;var n=Do(e),i=t.a.Za(),r=bo(t,e,i);ne.J(n,"timeNeeded="+r);var a=Ao(t,e.stream),o=ko(t,r),s=function(e,t,n){return"text"==t?null==(e=e.a).b||e.b<n?0:e.b-Math.max(n,e.a):Ft(e=Mn(e,t),n)}(t.a.O,e.type,i);ne.J(n,"update_:","presentationTime="+i,"bufferedAhead="+s);var u=Math.max(t.c.minBufferTime||0,t.g.rebufferingGoal,t.g.bufferingGoal)*t.l;if(r>=t.c.presentationTimeline.ca())return ne.debug(n,"buffered to end of presentation"),e.endOfStream=!0,"video"==e.type&&(r=t.b.get("text"))&&"application/cea-608"==r.stream.mimeType&&(r.endOfStream=!0),null;if(e.endOfStream=!1,(e.ka=o)!=a)return ne.debug(n,"need Period "+o,"presentationTime="+i,"timeNeeded="+r,"currentPeriodIndex="+a),null;if(u<=s)return ne.J(n,"buffering goal met"),.5;if(n=An(t.a.O,e.type),!(n=wo(t,e,i,n,a)))return 1;var c=1/0;return Array.from(t.b.values()).forEach(function(e){Eo(e)||(e=bo(t,e,i),c=Math.min(c,e))}),r>=c+t.c.presentationTimeline.a?1:(e.Bd=0,function(e,l,d,t,f){var n=Do(l),h=e.c.periods[t];ne.D(n,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var p=l.stream,i=e.c.presentationTimeline.ca(),r=e.c.periods[t+1];t=function(e,t,n,i,r){if(!t.vc)return Promise.resolve();var a=Do(t);return n=e.c.periods[n].startTime-t.stream.presentationTimeOffset,ne.D(a,"setting timestamp offset to "+n),ne.D(a,"setting append window start to "+i),ne.D(a,"setting append window end to "+r),i=function(e,t,n,i,r){return"text"==t?(e.a.o=n,(e=e.a).f=i,e.h=r,Promise.resolve()):Promise.all([Nn(e,t,e.Oe.bind(e,t)),Nn(e,t,e.ug.bind(e,t,n)),Nn(e,t,e.rg.bind(e,t,i,r))])}(e.a.O,t.type,n,i,r),t.stream.initSegmentReference?(ne.D(a,"fetching init segment"),e=Mo(e,t,t.stream.initSegmentReference).then(function(e){if(!this.f)return ne.D(a,"appending init segment"),In(this.a.O,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch(function(e){return t.vc=!0,Promise.reject(e)}),Promise.all([i,e])):i}(e,l,t,Math.max(0,h.startTime-.1),r?r.startTime+.01:i),l.Na=!0,l.vc=!1,ne.J(n,"fetching segment"),i=Mo(e,l,f),Promise.all([t,i]).then(function(e){if(!this.f&&!this.o)return t=this,n=l,i=d,r=h,a=p,o=f,s=e[1],u=Do(n),c=a.closedCaptions&&0<a.closedCaptions.size,null!=a.emsgSchemeIdUris&&0<a.emsgSchemeIdUris.length&&(new Di).ia("emsg",t.K.bind(t,r,o,a.emsgSchemeIdUris)).parse(s),function(e,t,n){var i=Do(t);ne.J(i,"checking buffer length");var r=Math.max(e.g.bufferBehind,e.c.presentationTimeline.a),a=kn(e.a.O,t.type);if(null==a)return ne.J(i,"buffer behind okay because nothing buffered:","presentationTime="+n,"bufferBehind="+r),Promise.resolve();var o=n-a,s=o-r;return s<=0?(ne.J(i,"buffer behind okay:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"underflow="+-s),Promise.resolve()):(ne.D(i,"buffer behind too large:","presentationTime="+n,"bufferedBehind="+o,"bufferBehind="+r,"overflow="+s),e.a.O.remove(t.type,a,a+s).then(function(){this.f||ne.D(i,"evicted "+s+" seconds")}.bind(e)))}(t,n,i).then(function(){if(!this.f)return ne.D(u,"appending media segment"),In(this.a.O,n.type,s,o.startTime+r.startTime,o.endTime+r.startTime,c)}.bind(t)).then(function(){if(!this.f)return ne.J(u,"appended media segment"),n.Cb=a,n.Ha=o,Promise.resolve()}.bind(t));var t,n,i,r,a,o,s,u,c}.bind(e)).then(function(){this.f||this.o||(l.Na=!1,l.yd=!1,l.Sa||this.a.td(),Po(this,l,0),function(e,t,n){if(!e.u){var i=Do(t);if(1==(t=Array.from(e.b.values())).length&&"text"==t[0].type||(e.u=t.every(function(e){return"text"==e.type||!e.Sa&&!e.Wa&&e.Ha})),e.u){for(ne.debug(i,"startup complete"),n=Ao(e,n),e.h[n]||go(e,n).then(function(){this.f||(ne.D(i,"calling onCanSwitch()..."),this.a.ne())}.bind(e)).catch(Vt.wc),n=0;n<e.c.periods.length;++n)go(e,n).catch(Vt.wc);e.a.Xf&&(ne.D(i,"calling onStartupComplete()..."),e.a.Xf())}}}(this,l,p),ne.D(n,"finished fetch and append"))}.bind(e)).catch(function(e){this.f||this.o||(l.Na=!1,"text"==l.type&&this.g.ignoreTextStreamFailures?(1001==e.code?ne.m(n,"Text stream failed to download. Proceeding without it."):ne.m(n,"Text stream failed to parse. Proceeding without it."),this.b.delete("text")):7001==e.code?(l.Na=!1,l.Ka=null,Po(this,l,0)):3017==e.code?function(e,t,n){var i=Do(t);if(Array.from(e.b.values()).some(function(e){return e!=t&&e.yd}))ne.debug(i,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var r=Math.round(100*e.l);if(20<r)e.l-=.2;else{if(!(4<r))return ne.error(i,"MediaSource threw QuotaExceededError too many times"),t.Xb=!0,e.o=!0,e.a.onError(n);e.l-=.04}ne.m(i,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.l))+"%"),t.yd=!0}Po(e,t,4)}(this,l,e):(ne.error(n,"failed fetch and append: code="+e.code),l.Xb=!0,e.severity=2,Ro(this,e)))}.bind(e))}(t,e,i,a,n),null)}(t,e);null!=i&&(Po(t,e,i),e.Xb=!1)}catch(e){return void Ro(t,e)}i=Array.from(t.b.values()),function(e,t){var s=Do(t),n=Ao(e,t.stream);{var u,c;t.ka!=n&&(u=t.ka,(c=Array.from(e.b.values())).every(function(e){return e.ka==u||Eo(e)})?c.every(xo)?(ne.debug(s,"all need Period "+u),go(e,u).then(function(){if(!this.f)if(c.every(function(e){var t=xo(e),n=Ao(this,e.stream);return!!Eo(e)||t&&e.ka==u&&n!=u}.bind(this))){var e=this.c.periods[u];ne.D(s,"calling onChooseStreams()...");var t=this.a.oe(e),n=new Map;t.variant&&t.variant.video&&n.set("video",t.variant.video),t.variant&&t.variant.audio&&n.set("audio",t.variant.audio),t.text&&n.set("text",t.text);for(var i=(t=Y(this.b.keys())).next();!i.done;i=t.next())if(i=i.value,!n.has(i)&&"text"!=i)return ne.error(s,"invalid Streams chosen: missing "+i+" Stream"),void this.a.onError(new me(2,5,5005));for(i=(t=Y(Array.from(n.keys()))).next();!i.done;i=t.next())if(i=i.value,!this.b.has(i)){if("text"!=i)return ne.error(s,"invalid Streams chosen: unusable "+i+" Stream"),void this.a.onError(new me(2,5,5005));po(this,null,null,n.get("text"),e.startTime),n.delete(i)}for(i=(t=Y(Array.from(this.b.keys()))).next();!i.done;i=t.next()){i=i.value;var r,a=this.b.get(i),o=n.get(i);o?((r=Eo(a))&&(a.ka=u,a.Bd=e.startTime),fo(this,o,!1,0,!1),r&&Eo(a)||Po(this,this.b.get(i),0)):this.b.delete(i)}ne.D(s,"calling onCanSwitch()..."),this.a.ne()}else ne.debug(s,"ignoring transition to Period",u,"since another is happening")}.bind(e)).catch(Vt.wc)):ne.debug(s,"all MediaStates need Period "+u+", but not all MediaStates are idle"):ne.debug(s,"not all MediaStates need Period "+u))}}(t,e),t.u&&i.every(function(e){return e.endOfStream})&&(ne.D(n,"calling endOfStream()..."),t.a.O.endOfStream().then(function(){var e;this.f||0!=(e=this.a.O.ca())&&e<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(e)}.bind(t)))}}}function bo(e,t,n){return t.Cb&&t.Ha?(n=Ao(e,t.Cb),e.c.periods[n].startTime+t.Ha.endTime):Math.max(n,t.Bd)}function wo(e,t,n,i,r){var a=Do(t);return t.Ha&&t.stream==t.Cb?(i=t.Ha.position+1,ne.J(a,"next position known:","position="+i),So(e,t,r,i)):null==(a=t.Ha?(ne.D(a,"next position unknown: another Stream buffered"),a=Ao(e,t.Cb),To(e,t,e.c.periods[a].startTime+t.Ha.endTime,r)):(ne.D(a,"next position unknown: nothing buffered"),To(e,t,i||n,r)))?null:((n=null)==i&&(n=So(e,t,r,Math.max(0,a-1))),n||So(e,t,r,a))}function To(e,t,n,i){var r=Do(t);return e=e.c.periods[i],ne.debug(r,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+e.startTime),n=Math.max(0,n-e.startTime),null==(t=t.stream.findSegmentPosition(n))&&ne.m(r,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+n),t}function So(e,t,n,i){var r=Do(t);return n=e.c.periods[n],(t=t.stream.getSegmentReference(i))?(e=(i=e.c.presentationTimeline).Wb(),i=i.xb(),n.startTime+t.endTime<e||n.startTime+t.startTime>i?(ne.J(r,"segment is not available:","currentPeriod.startTime="+n.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+i),null):t):(ne.D(r,"segment does not exist:","currentPeriod.startTime="+n.startTime,"position="+i),null)}function Eo(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function xo(e){return!e.Na&&null==e.Ka&&!e.Sa&&!e.Wa}function ko(e,t){var n=_a(e.c.periods,t+zt);return n?e.c.periods.indexOf(n):0}function Ao(e,t){for(var n=e.c.periods,i=0;i<n.length;i++){for(var r=n[i],a=new Set,o=Y(r.variants),s=o.next();!s.done;s=o.next())(s=s.value).audio&&a.add(s.audio),s.video&&a.add(s.video),s.video&&s.video.trickModeVideo&&a.add(s.video.trickModeVideo);for(o=(r=Y(r.textStreams)).next();!o.done;o=r.next())a.add(o.value);if(a.has(t))return i}return-1}function Mo(e,t,n){var i=br(n.c(),n.b,n.a,e.g.retryParameters);return ne.J("fetching: reference=",n),e=e.a.Db.request(1,i),(t.fb=e).promise.then(function(e){return t.fb=null,e.data})}function Io(r,a,o,s){return $(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return t=Do(a),a.Sa=!1,a.Kc=!1,a.lc=0,a.Wa=!0,ne.debug(t,"clearing buffer"),J(e,s?(n=r.a.Za(),i=r.a.O.ca(),r.a.O.remove(a.type,n+s,i)):Cn(r.a.O,a.type).then(function(){if(!this.f&&o)return this.a.O.flush(a.type)}.bind(r)),2);case 2:if(r.f)return e.return();ne.debug(t,"cleared buffer"),a.Cb=null,a.Ha=null,a.Wa=!1,a.endOfStream=!1,Po(r,a,0),K(e)}})})}function Po(n,i,e){ne.J(Do(i),"updating in "+e+" seconds"),i.Ka=new le(function(){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return Q(e,2),J(e,yo(n,i),4);case 4:Z(e,0);break;case 2:t=ee(e),n.a&&n.a.onError(t),K(e)}})})}).R(e)}function Co(e){null!=e.Ka&&(e.Ka.stop(),e.Ka=null)}function No(t){return $(function e(){return te(e,function(e){switch(e.j){case 1:if(t.fb)return J(e,t.fb.abort(),0);e.C(0)}})})}function Ro(e,t){he(e.H).then(function(){this.f||(this.a.onError(t),t.handled||this.g.failureCallback(t))}.bind(e))}function Do(e){return"("+e.type+":"+e.stream.id+")"}function Uo(e,t,n,i,r,a){if(200<=n&&n<=299&&202!=n)return{uri:r||i,vd:i,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=ut(t)}catch(e){}throw ne.debug("HTTP error text:",r),new me(401==n||403==n?2:1,1,1001,i,n,r,e,a)}function _o(e,t,n,i){var r=new _o.b;We(t.headers).forEach(function(e,t){r.append(t,e)});var a,o=new _o.a,s={Ud:!1,Ge:!1};return e=new ve(e=_o.l(e,n,{body:t.body||void 0,headers:r,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,i),function(){return s.Ud=!0,o.abort(),Promise.resolve()}),(t=t.retryParameters.timeout)&&((a=new de(function(){s.Ge=!0,o.abort()})).R(t/1e3),e.finally(function(){a.stop()})),e}function Lo(s,t,u,n){var i=new Lo.f,r=Date.now(),c=0;return new ve(new Promise(function(a,o){for(var e in i.open(t.method,s,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){o(new me(1,1,7001,s,u))},i.onload=function(e){for(var t=(e=e.target).getAllResponseHeaders().trim().split("\r\n"),n={},i=(t=Y(t)).next();!i.done;i=t.next())n[(i=i.value.split(": "))[0].toLowerCase()]=i.slice(1).join(": ");try{var r=Uo(n,e.response,e.status,s,e.responseURL,u);a(r)}catch(e){o(e)}},i.onerror=function(e){o(new me(1,1,1002,s,e,u))},i.ontimeout=function(){o(new me(1,1,1003,s,u))},i.onprogress=function(e){var t=Date.now();(100<t-r||e.lengthComputable&&e.loaded==e.total)&&(n(t-r,e.loaded-c,e.total-e.loaded),c=e.loaded,r=t)},t.headers)i.setRequestHeader(e.toLowerCase(),t.headers[e]);i.send(t.body)}),function(){return i.abort(),Promise.resolve()})}function Oo(){this.a=this.f=this.b=0,this.c=new Map,this.g=0}function jo(e,t,n){this.h=e,this.b=new Map,this.c=!1,this.g=t,this.f=n,this.a=new Oo}function Ko(l,e,d,t,f,h){var p=function(e,t){e.b+=t;var n=e.g;return e.g++,e.c.set(n,t),n}(l.a,t);t=l.b.get(e)||Promise.resolve(),l.b.set(e,t.then(function(){return $(function e(){var r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:return J(e,(n=l,i=d,$(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,n.h.request(1,i).promise,2);case 2:return t=e.s,e.return(t.data)}})})),2);case 2:if(r=e.s,l.c)throw new me(2,9,7001);if(f)for(var t in a=new Uint8Array(r),(o=new Ki(a)).data)s=Number(t),u=o.data[s],c=o.a[s],l.f(u,c);return l.a.close(p,r.byteLength),t=l.a,l.g(0==t.b?0:t.f/t.b,l.a.a),e.return(h(r))}var n,i})})}))}function Bo(e,t){var n=this;this.c=e,this.b=e.objectStore(t),this.a=new ge,e.onabort=function(e){e.preventDefault(),n.a.reject()},e.onerror=function(e){e.preventDefault(),n.a.reject()},e.oncomplete=function(){n.a.resolve()}}function Fo(i,r){return new Promise(function(t,e){var n=i.b.openCursor();n.onerror=e,n.onsuccess=function(e){if(!(e=e.target.result))return t();r(e.key,e.value,e),e.continue()}})}function Ho(e){this.b=e,this.a=[]}function Vo(e,t){return qo(e,t,"readwrite")}function qo(e,t,n){var i=new Bo(n=e.b.transaction([t],n),t);return e.a.push(i),i.promise().then(function(){Ie(e.a,i)},function(){Ie(e.a,i)}),i}function Go(e,t,n){this.b=new Ho(e),this.c=t,this.a=n}function Wo(e){return Promise.reject(new me(2,9,9011,"Cannot add new value to "+e))}function zo(e,t,n,i){t=(e=Vo(e.b,t)).store();for(var r={},a=(n=Y(n)).next();!a.done;r={key:r.key},a=n.next())r.key=a.value,t.delete(r.key).onsuccess=function(e){return function(){return i(e.key)}}(r);return e.promise()}function Xo(u,c,l){return $(function e(){var t,n,i,r,a,o,s;return te(e,function(e){switch(e.j){case 1:for(t=qo(u.b,c,"readonly"),n=t.store(),i={},r=[],a={},o=Y(l),s=o.next();!s.done;a={request:a.request,key:a.key},s=o.next())a.key=s.value,a.request=n.get(a.key),a.request.onsuccess=function(e){return function(){null==e.request.result&&r.push(e.key),i[e.key]=e.request.result}}(a);return J(e,t.promise(),2);case 2:if(r.length)throw new me(2,9,9012,"Could not find values for "+r);return e.return(l.map(function(e){return i[e]}))}})})}function Yo(e){this.a=new Ho(e)}function $o(){this.a=new Map}function Jo(e,t,n){if(!(e=e.a.get(t)))throw new me(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new me(2,9,9013,"Could not find cell with name "+n);return t}function Qo(e,t){Zo.set(e,t)}ro.prototype.destroy=function(){var a=this;return $(function e(){var i,r;return te(e,function(e){switch(e.j){case 1:i=[];for(var t=Y(a.b.values()),n=t.next();!n.done;n=t.next())Co(r=n.value),i.push(No(r));return J(e,Promise.all(i),2);case 2:a.b.clear(),a.i.clear(),a.a=null,a.c=null,a.v=null,a.h=null,a.g=null,a.f=!0,K(e)}})})},ro.prototype.configure=function(e){this.g=e,this.H=new fe({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},ro.prototype.start=function(){var r=this;return $(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return t=r.a.Za(),n=ko(r,t),(i=r.a.oe(r.c.periods[n])).variant||i.text?J(e,po(r,i.variant?i.variant.audio:null,i.variant?i.variant.video:null,i.text,t),2):(ne.error("init: no Streams chosen"),e.return(new me(2,5,5005)));case 2:if(r.f)return e.return();ne.debug("init: completed initial Stream setup"),r.a&&r.a.Of&&(ne.D("init: calling onInitialStreamsSetup()..."),r.a.Of()),K(e)}})})},ro.prototype.K=function(e,t,n,i){var r=i.reader.wd(),a=i.reader.wd(),o=i.reader.I(),s=i.reader.I(),u=i.reader.I(),c=i.reader.I();i=i.reader.gb(i.reader.N.byteLength-i.reader.ga()),e=e.startTime+t.startTime+s/o,n.includes(r)&&("urn:mpeg:dash:event:2012"==r?this.a.Pf():this.a.onEvent(new Ee("emsg",{detail:{startTime:e,endTime:e+u/o,schemeIdUri:r,value:a,timescale:o,presentationTimeDelta:s,eventDuration:u,id:c,messageData:i}})))},R("shaka.net.HttpFetchPlugin",_o),_o.l=function(h,p,m,g,v){return $(function e(){var t,n,i,r,o,s,u,c,a,l,d,f;return te(e,function(e){switch(e.j){case 1:return t=_o.g,n=_o.c,s=o=0,u=Date.now(),Q(e,2),J(e,t(h,m),4);case 4:return i=e.s,c=i.clone().body.getReader(),l=(a=i.headers.get("Content-Length"))?parseInt(a,10):0,new n({start:function(a){!function r(){return $(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return Q(e,2),J(e,c.read(),4);case 4:t=e.s,Z(e,3);break;case 2:return n=ee(e),ne.D("error reading from stream",n.message),e.return();case 3:t.done||(o+=t.value.byteLength),(100<(i=Date.now())-u||t.done)&&(v(i-u,o-s,l-o),s=o,u=i),t.done?a.close():(a.enqueue(t.value),r()),K(e)}})})}()}}),J(e,i.arrayBuffer(),5);case 5:r=e.s,Z(e,3);break;case 2:if(d=ee(e),g.Ud)throw new me(1,1,7001,h,p);if(g.Ge)throw new me(1,1,1003,h,p);throw new me(1,1,1002,h,d,p);case 3:return f={},i.headers.forEach(function(e,t){f[t.trim()]=e}),e.return(Uo(f,r,i.status,h,i.url,p))}})})},_o.isSupported=function(){if(!f.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!f.fetch||!f.AbortController)},_o.isSupported=_o.isSupported,_o.g=f.fetch,_o.a=f.AbortController,_o.c=f.ReadableStream,_o.b=f.Headers,_o.isSupported()&&(Ue("http",_o,2),Ue("https",_o,2)),R("shaka.net.HttpXHRPlugin",Lo),Lo.f=f.XMLHttpRequest,Ue("http",Lo,1),Ue("https",Lo,1),Oo.prototype.close=function(e,t){var n;this.c.has(e)&&(n=this.c.get(e),this.c.delete(e),this.f+=n,this.a+=t)},jo.prototype.destroy=function(){return this.c=!0,Promise.all(this.b.values()).then(function(){},function(){})},Bo.prototype.abort=function(){try{this.c.abort()}catch(e){}return this.a.catch(function(){})},Bo.prototype.store=function(){return this.b},Bo.prototype.promise=function(){return this.a},Ho.prototype.destroy=function(){return Promise.all(this.a.map(function(e){return e.abort()}))},(n=Go.prototype).destroy=function(){return this.b.destroy()},n.hasFixedKeySpace=function(){return!0},n.addSegments=function(){return Wo(this.c)},n.removeSegments=function(e,t){return zo(this,this.c,e,t)},n.getSegments=function(n){var i=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,Xo(i,i.c,n),2);case 2:return t=e.s,e.return(t.map(function(e){return i.Wd(e)}))}})})},n.addManifests=function(){return Wo(this.a)},n.updateManifestExpiration=function(t,n){var e=Vo(this.b,this.a),i=e.store();return i.get(t).onsuccess=function(e){(e=e.target.result)&&(e.expiration=n,i.put(e,t))},e.promise()},n.removeManifests=function(e,t){return zo(this,this.a,e,t)},n.getManifests=function(n){var i=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,Xo(i,i.a,n),2);case 2:return t=e.s,e.return(t.map(function(e){return i.mc(e)}))}})})},n.getAllManifests=function(){var i=this;return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return t=qo(i.b,i.a,"readonly"),n=new Map,J(e,Fo(t,function(e,t){n.set(e,i.mc(t))}),2);case 2:return J(e,t.promise(),3);case 3:return e.return(n)}})})},n.Wd=function(e){return e},n.mc=function(e){return e},n.add=function(s,u){var c=this;return $(function e(){var i,r,a,o;return te(e,function(e){switch(e.j){case 1:i=Vo(c.b,s),r=i.store(),a=[];for(var t=Y(u),n=t.next();!n.done;n=t.next())o=n.value,r.add(o).onsuccess=function(e){a.push(e.target.result)};return J(e,i.promise(),2);case 2:return e.return(a)}})})},Yo.prototype.destroy=function(){return this.a.destroy()},Yo.prototype.getAll=function(){var i=this;return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return t=qo(i.a,"session-ids","readonly"),n=[],J(e,Fo(t,function(e,t){n.push(t)}),2);case 2:return J(e,t.promise(),3);case 3:return e.return(n)}})})},Yo.prototype.add=function(e){for(var t=Vo(this.a,"session-ids"),n=t.store(),i=(e=Y(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Yo.prototype.remove=function(i){var n=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,Fo(t=Vo(n.a,"session-ids"),function(e,t,n){0<=i.indexOf(t.sessionId)&&n.delete()}),2);case 2:return J(e,t.promise(),0)}})})},$o.prototype.destroy=function(){for(var e=[],t=Y(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.a.clear(),Promise.all(e)},$o.prototype.init=function(){var i=this;Zo.forEach(function(e,t){var n=e();n?i.a.set(t,n):ne.info("Skipping "+t+" as it is not supported on this platform")});for(var e=[],t=Y(this.a.values()),n=t.next();!n.done;n=t.next())e.push(n.value.init());return Promise.all(e)},$o.prototype.erase=function(){var i=this;return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return t=Array.from(i.a.values()),(n=0<t.length)||Zo.forEach(function(e){(e=e())&&t.push(e)}),J(e,Promise.all(t.map(function(e){return e.erase()})),2);case 2:if(!n)return J(e,Promise.all(t.map(function(e){return e.destroy()})),0);e.C(0)}})})},R("shaka.offline.StorageMuxer.register",Qo),R("shaka.offline.StorageMuxer.unregister",function(e){Zo.delete(e)});var Zo=new Map;function es(e){Go.apply(this,arguments)}function ts(e){return function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType}),i=e.streams.filter(function(e){return"video"==e.contentType});{var r,n,a;t.every(function(e){return e.variantIds})&&i.every(function(e){return e.variantIds})||(t.forEach(function(e){e.variantIds=[]}),i.forEach(function(e){e.variantIds=[]}),r=0,i.length&&!t.length&&(ne.debug("Found video-only content. Creating variants for video."),n=r++,i.forEach(function(e){e.variantIds.push(n)})),!i.length&&t.length&&(ne.debug("Found audio-only content. Creating variants for audio."),a=r++,t.forEach(function(e){e.variantIds.push(a)})),i.length&&t.length&&(ne.debug("Found audio-video content. Creating variants."),t.forEach(function(n){i.forEach(function(e){var t=r++;n.variantIds.push(t),e.variantIds.push(t)})})))}}(e),e.streams.forEach(function(){}),{startTime:e.startTime,streams:e.streams.map(ns)}}function ns(e){var t=e.initSegmentUri?rs(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(is),variantIds:e.variantIds}}function is(e){var t=rs(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function rs(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new me(2,9,9004,"Could not parse uri "+e)}function as(e,t,n,i){Go.call(this,e,t,n),this.f=i}function os(){this.g=this.c=this.b=this.a=this.f=null}function ss(e,t,n,i){this.a=e,this.g=t,this.f=n,this.c=i,this.b=["offline:",e,"/",t,"/",n,"/",i].join("")}function us(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new ss(t,n,i,Number(e[4])):null}function cs(e,t){this.b=e,this.a=t}function ls(n,t,i){var e=t.streams.filter(function(e){return"audio"==e.contentType}),r=t.streams.filter(function(e){return"video"==e.contentType}),e=function(e,t,n){for(var i=new Set,r=Y(t),a=r.next();!a.done;a=r.next()){var o=Y(a.value.variantIds);for(a=o.next();!a.done;a=o.next())i.add(a.value)}for(r=Y(n),a=r.next();!a.done;a=r.next())for(o=Y(a.value.variantIds),a=o.next();!a.done;a=o.next())i.add(a.value);for(r=new Map,i=Y(i),a=i.next();!a.done;a=i.next())a=a.value,r.set(a,{id:a,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=Y(t),i=t.next();!i.done;i=t.next())for(i=i.value,a=ds(e,i),o=Y(i.variantIds),i=o.next();!i.done;i=o.next())(i=r.get(i.value)).language=a.language,i.primary=i.primary||a.primary,i.audio=a;for(n=Y(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=ds(e,i),a=Y(i.variantIds),i=a.next();!i.done;i=a.next())(i=r.get(i.value)).primary=i.primary||t.primary,i.video=t;return r}(n,e,r),r=t.streams.filter(function(e){return"text"==e.contentType}).map(function(e){return ds(n,e)});return t.streams.forEach(function(e){e=e.segments.map(function(e,t){return fs(n,t,e)}),i.Eb(e,t.startTime)}),{startTime:t.startTime,variants:Array.from(e.values()),textStreams:r}}function ds(n,e){var t,i,r,a=new tr(o=e.segments.map(function(e,t){return fs(n,t,e)})),o={id:e.id,originalId:e.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return a.find(e)},getSegmentReference:function(e){return a.get(e)},initSegmentReference:null,presentationTimeOffset:e.presentationTimeOffset,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate||void 0,pixelAspectRatio:e.pixelAspectRatio||void 0,kind:e.kind,encrypted:e.encrypted,keyId:e.keyId,language:e.language,label:e.label||null,type:e.contentType,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};return null!=e.initSegmentKey&&(o.initSegmentReference=(t=n,i=e.initSegmentKey,r=new ss("segment",t.b,t.a,i),new Qi(function(){return[r.toString()]},0,null))),o}function fs(e,t,n){var i=new ss("segment",e.b,e.a,n.dataKey);return new Zi(t,n.startTime,n.endTime,function(){return[i.toString()]},0,null)}function hs(){this.a=null}function ps(e){var t=us(e);return t&&"manifest"==t.a?ps.h(e):t&&"segment"==t.a?ps.i(t.key(),t):ye(new me(2,1,9004,e))}function ms(b,w,T){return $(function e(){var l,d,m,g,v,y;return te(e,function(e){switch(e.j){case 1:l=[];for(var t=[],n=Y(T),i=n.next();!i.done;i=n.next()){i=i.value;for(var r=!1,a=Y(t),o=a.next();!o.done;o=a.next())if(o=o.value,s=o.info,u=i,s.keySystem==u.keySystem&&s.licenseUri==u.licenseUri&&Pe(s.audioCapabilities,u.audioCapabilities,c)&&Pe(s.videoCapabilities,u.videoCapabilities,c)){o.sessionIds.push(i.sessionId),r=!0;break}r||t.push({info:i,sessionIds:[i.sessionId]})}d=Y(t),m=d.next();case 2:if(m.done){e.C(4);break}return g=m.value,f=b,h=w,p=g,v=$(function e(){var u,c,l,d;return te(e,function(e){switch(e.j){case 1:return u=new pt({Db:h,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Q(e,2),u.configure(f),J(e,(t=u,n=p.info.keySystem,i=p.info.licenseUri,r=p.info.serverCertificate,a=p.info.audioCapabilities,o=p.info.videoCapabilities,(s=new Map).set(n,{audioCapabilities:a,videoCapabilities:o,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:n,drmInfos:[{keySystem:n,licenseServerUri:i,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,initData:null,keyIds:null}]}),Et(t,s)),4);case 4:Z(e,3);break;case 2:return c=ee(e),ne.m("Error initializing EME",c),J(e,u.destroy(),5);case 5:return e.return([]);case 3:return Q(e,6),J(e,vt(u),8);case 8:Z(e,7);break;case 6:return l=ee(e),ne.m("Error setting server certificate",l),J(e,u.destroy(),9);case 9:return e.return([]);case 7:return d=[],J(e,Promise.all(p.sessionIds.map(function(n){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return Q(e,2),J(e,(r=u,a=n,$(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return J(e,xt(r,a),2);case 2:return(t=e.s)?(n=[],(i=r.b.get(t))&&(i.Ca=new ge,n.push(i.Ca)),ne.J("Attempting to remove session",a),n.push(t.remove()),J(e,Promise.all(n),0)):(ne.J("Ignoring attempt to remove missing session",a),e.return())}})})),4);case 4:d.push(n),Z(e,0);break;case 2:t=ee(e),ne.m("Error deleting offline session",t),K(e)}var r,a})})})),10);case 10:return J(e,u.destroy(),11);case 11:return e.return(d)}var t,n,i,r,a,o,s})}),J(e,v,5);case 5:y=e.s,l=l.concat(y),m=d.next(),e.C(2);break;case 4:return e.return(l)}var f,h,p,s,u;function c(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}})})}function gs(e,t){var n=bu(),i=this;this.h=t,this.c=e,this.f=n,this.i=null,this.g=[],this.b=this.a=null,this.l=!0,this.o=Promise.resolve().then(function(){return r=i,$(function e(){return te(e,function(e){switch(e.j){case 1:if(r.l){var t,n=!(0==r.g.length||r.a&&!r.a.$a||(r.a&&(r.a.za.eb(),r.a=null),(t=(n=r.g.shift()).create(r.f))?(n.za.Fb(),r.a={node:t.node,payload:t.payload,$a:t.$a,za:n.za}):n.za.zc(),0));return n=n?Promise.resolve():r.a?(i=r,$(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return i.c=i.h.rf(i.c,i.f,i.a.node,i.a.payload),Q(e,2),i.b=i.h.Ye(i.c,i.f,i.a.payload),J(e,i.b.promise,4);case 4:i.b=null,i.c==i.a.node&&(i.a.za.xc(),i.a=null),Z(e,0);break;case 2:return 7001==(t=ee(e)).code?i.a.za.eb():i.a.za.onError(t),i.a=null,i.b=null,J(e,(n=i).h.handleError(i.f,t),5);case 5:n.c=e.s,K(e)}})})):(r.h.Nf(r.c),r.i=new ge,r.i),J(e,n,1)}e.C(0)}var i})});var r})}function vs(e,t){var n={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Sg:function(){}};return e.g.push({create:t,za:n}),e.b&&e.b.abort(),ys(e),n}function ys(e){e.i&&(e.i.resolve(),e.i=null)}function bs(e){this.a=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.a=n)}this.a||(this.a=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.a.mode="hidden"}function ws(e){if(e.startTime>=e.endTime)return ne.m("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function Ts(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=e.cues,r=i.length-1;0<=r;r--){var a=i[r];a&&t(a)&&e.removeCue(a)}e.mode=n}function Ss(e,t,n,i,r){var a,o=r in i,s=!0;for(a in t){var u=r+"."+a,c=o?i[r]:n[a];o||a in n?void 0===t[a]?void 0===c||o?delete e[a]:e[a]=Ae(c):c.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Ae(c)),u=Ss(e[a],t[a],c,i,u),s=s&&u):typeof t[a]!=typeof c||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=c.constructor?(ne.jc("Invalid config, wrong type for "+u),s=!1):("function"==typeof n[a]&&n[a].length!=t[a].length&&ne.Z("Unexpected number of arguments for "+u),e[a]=t[a]):(ne.jc("Invalid config, unrecognized key "+u),s=!1)}return s}function Es(e,t){for(var n={},i=n,r=0,a=0;!((r=e.indexOf(".",r))<0);)0!=r&&"\\"==e[r-1]||(i[a=e.substring(a,r).replace(/\\\./g,".")]={},i=i[a],a=r+1),r+=1;return i[e.substring(a).replace(/\\\./g,".")]=t,n}function xs(){}function ks(){var e=5e5,t=1/0;navigator.connection&&(navigator.connection.downlink&&(e=1e6*navigator.connection.downlink),navigator.connection.saveData&&(t=360));var n={retryParameters:pe(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:At,fairPlayTransform:!0,updateExpirationTime:1},i={retryParameters:pe(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},r={retryParameters:pe(),failureCallback:function(e){return ne.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(nt("Web0S")||Ze()||nt("CrKey"))&&(r.stallSkip=0);var a={trackSelectionCallback:function(t){return $(function e(){return te(e,function(e){switch(e.j){case 1:return e.return(t)}})})},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},o={drm:n,manifest:i,streaming:r,offline:a,abrFactory:Fn,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return a.trackSelectionCallback=function(t){return $(function e(){return te(e,function(e){switch(e.j){case 1:return e.return(function(e,t){var n=e.filter(function(e){return"variant"==e.type}),i=[],r=jn(t,n.map(function(e){return e.language}));r&&(i=n.filter(function(e){return Ln(e.language)==r})),0==i.length&&(i=n.filter(function(e){return e.primary})),0==i.length&&(1<new Set(n.map(function(e){return e.language})).size&&ne.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=n);var a=i.filter(function(e){return e.height&&e.height<=480});{var o;a.length&&(a.sort(function(e,t){return t.height-e.height}),i=a.filter(function(e){return e.height==a[0].height})),n=[],i.length&&(o=Math.floor(i.length/2),i.sort(function(e,t){return e.bandwidth-t.bandwidth}),n.push(i[o]))}for(i=Y(e),o=i.next();!o.done;o=i.next())"text"==(o=o.value).type&&n.push(o);return n}(t,o.preferredAudioLanguage))}})})},o}function As(e,t,n){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Ss(e,t,n||ks(),i,"")}function Ms(){this.a=null,this.b=[]}function Is(e,t){var n;null==e.a?e.a={timestamp:Date.now()/1e3,state:t,duration:0}:(n=Date.now()/1e3,e.a.duration=n-e.a.timestamp,e.a.state!=t&&(e.b.push(e.a),e.a={timestamp:n,state:t,duration:0}))}function Ps(e,t){var n=0;e.a&&e.a.state==t&&(n+=e.a.duration);for(var i=Y(e.b),r=i.next();!r.done;r=i.next())n+=(r=r.value).state==t?r.duration:0;return n}function Cs(){this.b=this.c=null,this.a=[]}function Ns(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.v=NaN,this.a=new Ms,this.c=new Cs}function Rs(e,t){var n,u=this;ke.call(this),this.i=Su,this.a=null,this.ob=!1,this.g=new Ke,this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.F=this.fc=this.H=this.qb=this.o=this.G=this.h=this.T=null,this.ke=1e9,this.hc=new Set,this.sb=!0,this.sa=null,this.je=!1,this.ge=0,this.ra=null,this.ea=new ha,this.b=qs(this),this.ic={width:1/0,height:1/0},this.v=null,this.Pb=new Sa(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount),this.qa=this.b.preferredTextLanguage,this.nb=this.b.preferredTextRole,this.Mc=[],t&&t(this),this.T=(n=this,new Re(function(e,t){n.l&&n.l.segmentDownloaded(e,t)})),this.g.B(f,"online",function(){u.Cd()}),this.K={name:"detach"},this.V={name:"attach"},this.La={name:"unload"},this.Zc={name:"manifest-parser"},this.Uc={name:"manifest"},this.pb={name:"media-source"},this.Nc={name:"drm-engine"},this.$={name:"load"},this.dd={name:"src-equals-drm-engine"},this.rb={name:"src-equals"};var i=new Map;i.set(this.V,function(e,t){return Te((n=u,r=t,null==(i=e).w&&(i.w=r.w,n.g.B(i.w,"error",function(){var e=su(n);e&&n.Qa(e)})),n.a=i.w,Promise.resolve()));var n,i,r}),i.set(this.K,function(e){return e.w&&(u.g.pa(e.w,"error"),e.w=null),u.a=null,Te(e=Promise.resolve())}),i.set(this.La,function(e){return Te(Ls(u,e))}),i.set(this.pb,function(e){var a,o;return a=u,o=e,Te(e=$(function e(){var t,n,i,r;return te(e,function(e){switch(e.j){case 1:return t=new(f.muxjs?Ot:jt),n=a.b.textDisplayFactory,i=new n,a.Rc=n,J(e,(r=new wn(o.w,t,i)).u,2);case 2:a.G=r,K(e)}})}))}),i.set(this.Zc,function(e,t){var a,o,s;return Te((a=u,o=e,s=t,$(function e(){var t,n,i,r;return te(e,function(e){switch(e.j){case 1:if(o.Ea=s.Ea,o.mimeType=s.mimeType,o.uri=s.uri,t=o.uri,n=a.T,a.Ob=t,o.Ea){a.u=o.Ea(),e.C(2);break}return i=a,J(e,vr.create(t,n,a.b.manifest.retryParameters,o.mimeType),3);case 3:i.u=e.s;case 2:r=Ae(a.b.manifest),s.w&&"AUDIO"===s.w.nodeName&&(r.disableVideo=!0),a.u.configure(r),K(e)}})})))}),i.set(this.Uc,function(e){return function(r,e){var a=e.uri,t=r.T;r.ec=new Za,function(e,t){e.b=t}(r.ec,function(e){ou(r,"timelineregionadded",e)});var o={networkingEngine:t,filterNewPeriod:function(e){return r.Vc(e)},filterAllPeriods:function(e){return Gs(r,e)},onTimelineRegionAdded:function(e){var t=r.ec;e:{for(var n=Y(t.a),i=n.next();!i.done;i=n.next())if((i=i.value).schemeIdUri==e.schemeIdUri&&i.id==e.id&&i.startTime==e.startTime&&i.endTime==e.endTime){n=i;break e}n=null}null==n&&(t.a.add(e),t.b(e))},onEvent:function(e){return r.dispatchEvent(e)},onError:function(e){return r.Qa(e)}};return new ve(Promise.resolve().then(function(){return $(function e(){var i;return te(e,function(e){switch(e.j){case 1:return J(e,(i=r).u.start(a,o),2);case 2:if(i.c=e.s,r.dispatchEvent(new Ee("manifestparsed")),0==r.c.periods.length)throw new me(2,4,4014);(n=r.c.periods).some(function(e){return e.variants.some(t)})&&(ne.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),n.forEach(function(e){e.variants=e.variants.filter(t)})),K(e)}function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}var n})})}),function(){return ne.info("Aborting parser step..."),r.u.stop()})}(u,e)}),i.set(this.Nc,function(){var n;return Te((n=u,$(function e(){return te(e,function(e){switch(e.j){case 1:return n.h=Os(n,{Db:n.T,onError:function(e){n.Qa(e)},yc:function(e){uu(n,e)},onExpirationUpdated:function(e,t){cu(n,e,t)},onEvent:function(e){n.dispatchEvent(e)}}),n.h.configure(n.b.drm),J(e,mt(n.h,Ua(n.c.periods),n.c.offlineSessionIds),2);case 2:Gs(n,n.c.periods),K(e)}})})))}),i.set(this.$,function(e,t){return Te((E=u,x=e,k=t,$(function e(){var h,p,m,g,v,y,b,w,T,S;return te(e,function(e){switch(e.j){case 1:return x.startTime=k.startTime,h=x.w,p=x.uri,E.Ob=p,E.H=new Oa({rc:function(){return x.w.playbackRate},Id:function(e){x.w.playbackRate=e},le:function(e){x.w.currentTime+=e}}),E.v=new Ns,m=function(){return $s(E)},g=function(){return Ys(E)},E.g.B(h,"playing",m),E.g.B(h,"pause",m),E.g.B(h,"ended",m),E.g.B(h,"ratechange",g),v=E.b.abrFactory,E.l&&E.Lc==v||(E.Lc=v,E.l=new v,E.l.configure(E.b.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var i=t[n],r=new Map,a=Y(i.variants),o=a.next();!o.done;o=a.next())if((o=o.value).video&&o.video.closedCaptions)for(var s,u=Y((o=o.video).closedCaptions.keys()),c=u.next();!c.done;c=u.next())c=c.value,r.has(c)||(s={id:e.ke++,originalId:c,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:o.closedCaptions.get(c),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:o.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null},r.set(c,s));for(r=Y(r.values()),a=r.next();!a.done;a=r.next())i.textStreams.push(a.value)}}(E,E.c.periods),E.Pb=new Sa(E.b.preferredAudioLanguage,E.b.preferredVariantRole,E.b.preferredAudioChannelCount),E.qa=E.b.preferredTextLanguage,l=E.c.presentationTimeline,d=E.b.playRangeStart,f=E.b.playRangeEnd,0<d&&(l.X()?ne.m("|playRangeStart| has been configured for live content. Ignoring the setting."):l.De(d)),f<l.ca()&&(l.X()?ne.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):l.Ba(f)),J(e,E.h.Qb(h),2);case 2:return E.l.init(function(e,t,n){t=void 0!==t&&t,n=void 0===n?0:n,ne.debug("switch_");e:{for(var i=Y(E.c.periods),r=i.next();!r.done;r=i.next())if((r=r.value).variants.includes(e)){i=r;break e}i=null}Hs(E,i,e,!0),E.f&&lo(E.f,e,t,n)&&eu(E)}),E.o=(u=E,c=x.startTime,new Ya(u.a,u.c,u.b.streaming,c,function(){u.qb&&Da(u.qb,!0),u.f&&function(n){function e(e){var t=n.a.O;return e="text"==e?null!=(e=t.a).a&&null!=e.b&&i>=e.a&&i<e.b:Bt(e=Mn(t,e),i,r)}var i=n.a.Za(),r=n.g.smallGapLimit,t=!1,a=ko(n,i);if(Ge(n.b.values(),function(e){return e.ka==a}))for(var o=Y(n.b.keys()),s=o.next();!s.done;s=o.next())e(s=s.value)||(ho(n,n.b.get(s)),t=!0);else Ge(n.b.keys(),e)||(ne.debug("(all): seeked: unbuffered seek: clearing all buffers"),n.b.forEach(function(e){ho(n,e)}),t=!0);t||ne.debug("(all): seeked: buffered seek: presentationTime="+i)}(u.f),u.F&&Ks(u)},function(e){return u.dispatchEvent(e)})),E.qb=function(n){var e=new La(n.c);!function(e,t){e.b=t}(e,function(){tu(n)});var t=new eo(n.ec);!function(e,t,n,i){e.a=t,e.b=n,e.c=i}(t,function(e){ou(n,"timelineregionenter",e)},function(e){ou(n,"timelineregionexit",e)},function(e,t){t||(ou(n,"timelineregionenter",e),ou(n,"timelineregionexit",e))});var i=new Ra(n.a);return i.a.add(e),i.a.add(t),i}(E),y=Math.max(E.c.minBufferTime,E.b.streaming.rebufferingGoal),js(E,y),E.f=new ro((s=E).c,{Za:function(){return s.o.g()},getBandwidthEstimate:function(){return s.l.getBandwidthEstimate()},O:s.G,Db:s.T,oe:s.Lf.bind(s),ne:s.Se.bind(s),onError:s.Qa.bind(s),onEvent:function(e){return s.dispatchEvent(e)},Pf:s.Qf.bind(s),td:s.Vf.bind(s)}),E.f.configure(E.b.streaming),Bn.Vd(E.c,E.b.preferredAudioChannelCount),E.i=Eu,E.dispatchEvent(new Ee("streaming")),J(e,E.f.start(),3);case 3:E.b.streaming.startAtSegmentBoundary&&(b=E.o.g(),i=b,r=ao((n=E).f),a=oo(n.f),o=mu(n),r=t(r,i),w=null!=(a=t(a,i))&&null!=r?Math.max(a,r):null!=a?a:null!=r?r:i,E.o.o(w)),E.c.periods.forEach(E.Vc.bind(E)),tu(E),eu(E),T=mu(E)||E.c.periods[0],S=T.variants.some(function(e){return e.primary}),E.b.preferredAudioLanguage||S||ne.m("No preferred audio language set.  We will choose an arbitrary language initially"),Js(E,T.variants),E.g.ua(h,"loadedmetadata",function(){E.v.b=Date.now()/1e3-k.Ld}),K(e)}function t(e,t){if(!e)return null;var n=e.findSegmentPosition(t-o.startTime);return null!=n&&(n=e.getSegmentReference(n))?n.startTime+o.startTime:null}var n,i,r,a,o,s,u,c,l,d,f})})));var E,x,k}),i.set(this.dd,function(e){var i,r;return i=u,r=e,Te(e=$(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return t=Wt,i.h=Os(i,{Db:i.T,onError:function(e){i.Qa(e)},yc:function(e){uu(i,e)},onExpirationUpdated:function(e,t){cu(i,e,t)},onEvent:function(e){i.dispatchEvent(e)}}),i.h.configure(i.b.drm),n={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:t.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},J(e,mt(i.h,[n],[]),2);case 2:return J(e,i.h.Qb(r.w),0)}})}))}),i.set(this.rb,function(e,t){return function(t,n,e){function i(){return $s(t)}{var r;n.uri=e.uri,n.startTime=e.startTime,t.Ob=n.uri,t.v=new Ns,t.o=new Xa(n.w),null!=n.startTime&&t.o.o(n.startTime),t.H=new Oa({rc:function(){return n.w.playbackRate},Id:function(e){n.w.playbackRate=e},le:function(e){n.w.currentTime+=e}}),js(t,t.b.streaming.rebufferingGoal),t.g.B(n.w,"playing",i),t.g.B(n.w,"pause",i),t.g.B(n.w,"ended",i),t.g.B(n.w,"ratechange",function(){return Ys(t)}),"none"!=t.a.preload&&t.g.ua(n.w,"loadedmetadata",function(){t.v.b=Date.now()/1e3-e.Ld}),t.a.audioTracks&&(t.g.B(t.a.audioTracks,"addtrack",function(){return tu(t)}),t.g.B(t.a.audioTracks,"removetrack",function(){return tu(t)}),t.g.B(t.a.audioTracks,"change",function(){return tu(t)})),t.a.textTracks&&(r=t.a.textTracks,t.g.B(r,"addtrack",function(){return tu(t)}),t.g.B(r,"removetrack",function(){return tu(t)}),t.g.B(r,"change",function(){return tu(t)}))}n.w.src=n.uri,Ze()&&n.w.load(),t.i=xu,t.dispatchEvent(new Ee("streaming"));var a=new ge;Ka(t.a,HTMLMediaElement.HAVE_METADATA,t.g,function(){a.resolve()});var o=!1;return t.Mc.push(function(){o=!0}),Ka(t.a,HTMLMediaElement.HAVE_CURRENT_DATA,t.g,function(){return $(function e(){return te(e,function(e){switch(e.j){case 1:if(o)return e.return();if(!function(e){var t=e.b.preferredAudioLanguage;{var n;""!=t&&(e.Dd(t),""!=(n=e.b.preferredVariantRole)&&e.Dd(t,n))}}(t),Fs(t).find(function(e){return"disabled"!=e.mode})){e.C(2);break}return J(e,new Promise(function(e){t.g.ua(t.a.textTracks,"change",e),new de(e).R(1)}),2);case 2:if(o)return e.return();!function(e){var t=e.b.preferredTextLanguage;{var n;""!=t&&(e.Ed(t),""!=(n=e.b.preferredTextRole)&&e.Ed(t,n))}}(t),K(e)}})})}),t.a.error?a.reject(su(t)):"none"==t.a.preload&&(ne.Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),a.resolve()),t.g.ua(t.a,"error",function(){a.reject(su(t))}),new ve(a,function(){return a.reject(new me(2,7,7001)),Promise.resolve()})}(u,e,t)}),this.Ta=new gs(this.K,{rf:function(e,t,n,i){var r=null;return e==u.K&&(r=n==u.K?u.K:u.V),e==u.V&&(r=n==u.K||t.w!=i.w?u.K:n==u.V?u.V:n==u.pb||n==u.$?u.pb:n==u.rb?u.dd:null),e==u.pb&&(r=n==u.$&&t.w==i.w?u.Zc:u.La),e==u.Zc&&(r=yu(u.$,u.Uc,u.La,n,t,i)),e==u.Uc&&(r=yu(u.$,u.Nc,u.La,n,t,i)),e==u.Nc&&(r=yu(u.$,u.$,u.La,n,t,i)),e==u.dd&&(r=n==u.rb&&t.w==i.w?u.rb:u.La),e!=u.$&&e!=u.rb||(r=u.La),e==u.La&&(r=i.w&&t.w==i.w?u.V:u.K),r},Ye:function(e,t,n){return u.dispatchEvent(new Ee("onstatechange",{state:e.name})),i.get(e)(t,n)},handleError:function(t,n){return $(function e(){return te(e,function(e){switch(e.j){case 1:return ne.m("The walker saw an error:"),n instanceof me?ne.m("Error Code:",n.code):(ne.m("Error Message:",n.message),ne.m("Error Stack:",n.stack)),J(e,Ls(u,t),2);case 2:return e.return(t.w?u.V:u.K)}})})},Nf:function(e){u.dispatchEvent(new Ee("onstateidle",{state:e.name}))}}),e&&this.Qb(e,!0)}b(es,Go),es.prototype.updateManifestExpiration=function(t,n){var e=Vo(this.b,this.a),i=e.store(),r=new ge;return i.get(t).onsuccess=function(e){(e=e.target.result)?(e.expiration=n,i.put(e),r.resolve()):r.reject(new me(2,9,9012,"Could not find values for "+t))},e.promise().then(function(){return r})},es.prototype.mc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(ts),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},es.prototype.Wd=function(e){return{data:e.data}},b(as,Go),as.prototype.hasFixedKeySpace=function(){return this.f},as.prototype.addSegments=function(e){return this.f?Wo(this.c):this.add(this.c,e)},as.prototype.addManifests=function(e){return this.f?Wo(this.a):this.add(this.a,e)},as.prototype.mc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(n=os.prototype).init=function(){var n=this,i=new ge,t=f.indexedDB.open("shaka_offline_db",4);return t.onsuccess=function(e){e=e.target.result;var t=(t=(n.f=e).objectStoreNames).contains("manifest")&&t.contains("segment")?(ne.debug("Mounting v1 idb storage cell"),new es(e,"segment","manifest")):null;n.a=t,t=(t=e.objectStoreNames).contains("manifest-v2")&&t.contains("segment-v2")?(ne.debug("Mounting v2 idb storage cell"),new as(e,"segment-v2","manifest-v2",!0)):null,n.b=t,t=(t=e.objectStoreNames).contains("manifest-v3")&&t.contains("segment-v3")?(ne.debug("Mounting v3 idb storage cell"),new as(e,"segment-v3","manifest-v3",!1)):null,n.c=t,e=e.objectStoreNames.contains("session-ids")?(ne.debug("Mounting session ID idb storage cell"),new Yo(e)):null,n.g=e,i.resolve()},t.onupgradeneeded=function(e){e=e.target.result;for(var t=Y(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},t.onerror=function(e){i.reject(new me(2,9,9001,t.error)),e.preventDefault()},i},n.destroy=function(){var t=this;return $(function e(){return te(e,function(e){switch(e.j){case 1:if(t.a)return J(e,t.a.destroy(),2);e.C(2);break;case 2:if(t.b)return J(e,t.b.destroy(),4);e.C(4);break;case 4:if(t.c)return J(e,t.c.destroy(),6);e.C(6);break;case 6:if(t.g)return J(e,t.g.destroy(),8);e.C(8);break;case 8:t.f&&t.f.close(),K(e)}})})},n.getCells=function(){var e=new Map;return this.a&&e.set("v1",this.a),this.b&&e.set("v2",this.b),this.c&&e.set("v3",this.c),e},n.getEmeSessionCell=function(){return this.g},n.erase=function(){var i=this;return $(function e(){return te(e,function(e){switch(e.j){case 1:if(i.a)return J(e,i.a.destroy(),2);e.C(2);break;case 2:if(i.b)return J(e,i.b.destroy(),4);e.C(4);break;case 4:if(i.c)return J(e,i.c.destroy(),6);e.C(6);break;case 6:return i.f&&i.f.close(),J(e,(t=new ge,(n=f.indexedDB.deleteDatabase("shaka_offline_db")).onblocked=function(){ne.m("Deleting","shaka_offline_db","is being blocked")},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new me(2,9,9001,n.error)),e.preventDefault()},t),8);case 8:return i.f=null,i.a=null,i.b=null,i.c=null,J(e,i.init(),0)}var t,n})})},Qo("idb",function(){return f.indexedDB?new os:null}),ss.prototype.Aa=function(){return this.g},ss.prototype.fa=function(){return this.f},ss.prototype.key=function(){return this.c},ss.prototype.toString=function(){return this.b},(n=hs.prototype).configure=function(){},n.start=function(o){var s=this;return $(function e(){var t,n,i,r,a;return te(e,function(e){switch(e.j){case 1:return(t=us(o),null==(s.a=t)||"manifest"!=t.a)?e.return(Promise.reject(new me(2,1,9004,t))):(n=new $o,D(e,2),J(e,n.init(),4));case 4:return J(e,Jo(n,t.Aa(),t.fa()),5);case 5:return J(e,e.s.getManifests([t.key()]),6);case 6:return i=e.s,r=i[0],a=new cs(t.Aa(),t.fa()),e.return(function(t,e){var n=new yr(null,0);n.Ba(e.duration);var i=e.periods.map(function(e){return ls(t,e,n)}),r=e.drmInfo?[e.drmInfo]:[];return e.drmInfo&&i.forEach(function(e){e.variants.forEach(function(e){e.drmInfos=r})}),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:e.sessionIds,periods:i}}(a,r));case 2:return U(e),J(e,n.destroy(),7);case 7:_(e,0)}})})},n.stop=function(){return Promise.resolve()},n.update=function(){},n.onExpirationUpdated=function(c,l){var d=this;return $(function e(){var t,n,i,r,a,o,s,u;return te(e,function(e){switch(e.j){case 1:return t=d.a,n=new $o,Q(e,2,3),J(e,n.init(),5);case 5:return J(e,Jo(n,t.Aa(),t.fa()),6);case 6:return J(e,(i=e.s).getManifests([t.key()]),7);case 7:if(r=e.s,a=r[0],o=a.sessionIds.includes(c),s=null==a.expiration||a.expiration>l,o&&s)return ne.debug("Updating expiration for stored content"),J(e,i.updateManifestExpiration(t.key(),l),3);e.C(3);break;case 3:return U(e),J(e,n.destroy(),10);case 10:_(e,0);break;case 2:u=ee(e),ne.error("There was an error updating",t,u),e.C(3)}})})},vr.Lb("application/x-offline-manifest",hs),R("shaka.offline.OfflineScheme",ps),ps.h=function(e){return we(e={uri:e,vd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},ps.i=function(e,t){var n=new $o;return we(void 0).Y(function(){return n.init()}).Y(function(){return Jo(n,t.Aa(),t.fa())}).Y(function(e){return e.getSegments([t.key()])}).Y(function(e){return{uri:t,vd:t,data:e[0].data,headers:{}}}).finally(function(){return n.destroy()})},Ue("offline",ps),gs.prototype.destroy=function(){var i=this;return $(function e(){return te(e,function(e){switch(e.j){case 1:return i.l=!1,i.b&&i.b.abort(),ys(i),J(e,i.o,2);case 2:i.a&&i.a.za.eb();for(var t=Y(i.g),n=t.next();!n.done;n=t.next())n.value.za.eb();i.a=null,i.g=[],i.h=null,K(e)}})})},R("shaka.text.SimpleTextDisplayer",bs),bs.prototype.remove=bs.prototype.remove=function(t,n){return!!this.a&&(Ts(this.a,function(e){return e.startTime<n&&e.endTime>t}),!0)},bs.prototype.append=bs.prototype.append=function(e){for(var t=ws,n=[],i=(e=Y(e)).next();!i.done;i=e.next())(i=i.value).nestedCues.length?n=n.concat(i.nestedCues):n.push(i);var r=[];e=this.a.cues?Array.from(this.a.cues):[],i={};for(var a=(n=Y(n)).next();!a.done;i={Ab:i.Ab},a=n.next())i.Ab=a.value,e.some(function(t){return function(e){return e.startTime==t.Ab.startTime&&e.endTime==t.Ab.endTime&&e.text==t.Ab.payload}}(i))||(a=t(i.Ab))&&r.push(a);r.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:r.indexOf(t)-r.indexOf(e)}).forEach(function(e){this.a.addCue(e)}.bind(this))},bs.prototype.destroy=bs.prototype.destroy=function(){return this.a&&Ts(this.a,function(){return 1}),this.a=null,Promise.resolve()},bs.prototype.isTextVisible=bs.prototype.isTextVisible=function(){return"showing"==this.a.mode},bs.prototype.setTextVisibility=bs.prototype.setTextVisibility=function(e){this.a.mode=e?"showing":"hidden"},R("shaka.util.ConfigUtils.mergeConfigObjects",Ss),R("shaka.util.ConfigUtils.convertToConfigObject",Es),R("shaka.util.PlayerConfiguration",xs),xs.mergeConfigObjects=As,L(Rs,ke),R("shaka.Player",Rs),Rs.prototype.destroy=Rs.prototype.destroy=function(){var n=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return n.i==Tu?e.return():(n.i=Tu,t=vs(n.Ta,function(){return{node:n.K,payload:bu(),$a:!1}}),J(e,new Promise(function(e){t.Fb=function(){ne.info("Preparing to destroy walker...")},t.xc=function(){e(),n.dispatchEvent(new Ee("loaded"))},t.eb=function(){e()},t.onError=function(){e()},t.zc=function(){e()}}),2));case 2:return J(e,n.Ta.destroy(),3);case 3:if(n.g&&(n.g.release(),n.g=null),n.Lc=null,n.l=null,n.b=null,n.T)return J(e,n.T.destroy(),5);e.C(0);break;case 5:n.T=null,K(e)}})})},Rs.version="v2.5.14";var Ds=["2","5"],zn=new function(e){this.a=e,this.c=Gn,this.b=Wn}(new Vn(Number(Ds[0]),Number(Ds[1]))),Us=["output-restricted","internal-error"],_s={};function Ls(n,i){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return n.i!=Tu&&(n.i=Su),t=n.Mc.map(function(e){return e()}),n.Mc=[],J(e,Promise.all(t),2);case 2:if(n.dispatchEvent(new Ee("unloading")),i.Ea=null,i.mimeType=null,i.startTime=null,i.uri=null,i.w&&(n.g.pa(i.w,"loadedmetadata"),n.g.pa(i.w,"playing"),n.g.pa(i.w,"pause"),n.g.pa(i.w,"ended"),n.g.pa(i.w,"ratechange")),n.qb&&(n.qb.release(),n.qb=null),n.fc&&(n.fc.stop(),n.fc=null),n.u)return J(e,n.u.stop(),4);e.C(3);break;case 4:n.u=null;case 3:if(n.l)return J(e,n.l.stop(),5);e.C(5);break;case 5:if(n.f)return J(e,n.f.destroy(),8);e.C(7);break;case 8:n.f=null;case 7:if(n.H&&(n.H.release(),n.H=null),n.o&&(n.o.release(),n.o=null),n.G)return J(e,n.G.destroy(),10);e.C(9);break;case 10:n.G=null;case 9:if(i.w&&i.w.src)return J(e,new Promise(function(e){return new de(e).R(.1)}),12);e.C(11);break;case 12:i.w.removeAttribute("src"),i.w.load();case 11:if(n.h)return J(e,n.h.destroy(),14);e.C(13);break;case 14:n.h=null;case 13:n.ea.a.clear(),n.Ob=null,n.F=null,n.hc.clear(),n.c=null,n.v=null,n.Rc=null,n.sb=!0,Xs(n),K(e)}})})}function Os(e,t){return new pt(t,e.b.drm.updateExpirationTime)}function js(e,t){e.F=new Ea,e.F.a=ka,xa(e.F,t,Math.min(.5,t/2)),Xs(e),e.fc=new de(function(){Ks(e)}).Ra(.25)}function Ks(e){switch(e.i){case xu:var t=!!e.a.ended||Kt(e.a.buffered)>=e.a.duration-1;break;case Eu:e:if(e.a.ended||xn(e.G))t=!0;else{if(e.c.presentationTimeline.X()){var n=e.c.presentationTimeline.xb();if(Kt(e.a.buffered)>=n){t=!0;break e}}t=!1}break;default:t=!1}var i=Ft(e.a.buffered,e.a.currentTime),r=t,a=(n=e.F).b.get(n.a),t=n.a,i=r||a<=i?Aa:ka;t!=(n.a=i)&&Xs(e)}function Bs(t){var e;if(t.u&&(r=Ae(t.b.manifest),t.a&&"AUDIO"===t.a.nodeName&&(r.disableVideo=!0),t.u.configure(r)),t.h&&t.h.configure(t.b.drm),t.f){t.f.configure(t.b.streaming);try{t.c.periods.forEach(t.Vc.bind(t))}catch(e){t.Qa(e)}var n=ao(t.f),i=oo(t.f),r=mu(t),n=Bn.ce(n,i,r.variants);t.l&&n&&n.allowedByApplication&&n.allowedByKeySystem?Js(t,r.variants):(ne.debug("Choosing new streams after changing configuration"),Qs(t,r))}t.G&&(r=t.b.textDisplayFactory,t.Rc!=r)&&(n=new r,e=(i=t.G).g,i.g=n,e&&(n.setTextVisibility(e.isTextVisible()),e.destroy()),i.a&&(i.a.c=n),t.Rc=r,!t.f||(n=(r=t.f).b.get("text"))&&fo(r,n.stream,!0,0,!0)),t.l&&(t.l.configure(t.b.abr),t.b.abr.enabled&&!t.sb?t.l.enable():t.l.disable(),au(t)),t.F&&(r=t.b.streaming.rebufferingGoal,t.c&&(r=Math.max(r,t.c.minBufferTime)),xa(t.F,r,Math.min(.5,r/2)))}function Fs(e){return Array.from(e.a.textTracks).filter(function(e){return"metadata"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function Hs(e,t,n,i){ma(e.ea,t).variant=n,(e=e.v.c).c!=n&&(e.c=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:i,bandwidth:n.bandwidth}))}function Vs(e,t,n,i){pa(e.ea,t,n),(e=e.v.c).b!=n&&(e.b=n,e.a.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:i,bandwidth:null}))}function qs(t){var e=ks();return e.streaming.failureCallback=function(e){t.X()&&[1001,1002,1003].includes(e.code)&&(e.severity=1,ne.m("Live streaming error.  Retrying automatically..."),t.Cd())},e.textDisplayFactory=function(){return new bs(t.a)},e}function Gs(e,t){var n,i,r=e.f?ao(e.f):null,a=e.f?oo(e.f):null;if(t.forEach(Bn.filterNewPeriod.bind(null,e.h,r,a)),n=function(e){return e.variants.some(Bn.Bb)},i=0,t.forEach(function(e){i+=n(e)?1:0}),0==(r=i))throw new me(2,4,4032);if(r<t.length)throw new me(2,4,4011);t.forEach(function(e){Bn.Sd(e.variants,this.b.restrictions,this.ic)&&this.f&&mu(this)==e&&tu(this),lu(this,e.variants)}.bind(e))}function Ws(e,t,n,i){return n=void 0!==n&&n,i=void 0===i?0:i,e.sb?(e.sa=t,e.je=n,e.ge=i,!0):((t=lo(e.f,t,n,i))&&nu(e),t)}function zs(e,t){if(e.sb)return e.ra=t,!0;var n=fo(e.f,t,!0,0,!1);return n&&iu(e),n}function Xs(e){var t,n=e.fd();e.v&&e.F&&e.o&&((t=e.H).f=n,ja(t),$s(e)),e.dispatchEvent(new Ee("buffering",{buffering:n}))}function Ys(e){var t=e.a.playbackRate;0!=t&&e.H.set(t)}function $s(e){var t;e.v&&e.F&&(t=e.v.a,e.F.a==ka?Is(t,"buffering"):e.a.paused?Is(t,"paused"):e.a.ended?Is(t,"ended"):Is(t,"playing"))}function Js(t,e){try{lu(t,e)}catch(e){return t.Qa(e),null}var n=e.filter(function(e){return Bn.Bb(e)}),n=t.Pb.create(n);return t.l.setVariants(Array.from(n.values())),t.l.chooseVariant()}function Qs(e,t){var n=Zs(e,t,!1),i=Bn.Sb(t.textStreams,e.qa,e.nb)[0]||null,r=!1;i&&(e.b.streaming.alwaysStreamText||e.uc())&&(Vs(e,t,i,!0),r=zs(e,i)),(n||r)&&eu(e)}function Zs(e,t,n){n=void 0===n||n;var i=Js(e,t.variants),r=!1;return i&&(Hs(e,t,i,!0),r=Ws(e,i,!0)),n&&r&&eu(e),r}function eu(e){du(e,new Ee("adaptation"))}function tu(e){du(e,new Ee("trackschanged"))}function nu(e){du(e,new Ee("variantchanged"))}function iu(e){du(e,new Ee("textchanged"))}function ru(e){du(e,new Ee("texttrackvisibility"))}function au(e){du(e,new Ee("abrstatuschanged",{Rg:e.b.abr.enabled}))}function ou(e,t,n){e.dispatchEvent(new Ee(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function su(e){if(!e.a.error)return null;var t=e.a.error.code;if(1==t)return null;var n=e.a.error.msExtendedCode;return n&&(n<0&&(n+=Math.pow(2,32)),n=n.toString(16)),new me(2,3,3016,t,n,e.a.error.message)}function uu(e,i){var t,r,n,a,o;e.f&&(t=mu(e),r=!1,0==(n=Object.keys(i)).length&&ne.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),(a=1==n.length&&"00"==n[0])&&ne.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),n.length&&e.c.periods.forEach(function(e){e.variants.forEach(function(n){Bn.Bf(n).forEach(function(e){var t=n.allowedByKeySystem;e.keyId&&(e=i[a?"00":e.keyId],n.allowedByKeySystem=!!e&&!Us.includes(e)),t!=n.allowedByKeySystem&&(r=!0)})})}),n=ao(e.f),o=oo(e.f),(n=Bn.ce(n,o,t.variants))&&!n.allowedByKeySystem&&(ne.debug("Choosing new variants after key status changed"),Zs(e,t)),r&&(tu(e),Js(e,t.variants)))}function cu(e,t,n){e.u&&e.u.onExpirationUpdated&&e.u.onExpirationUpdated(t,n),e.dispatchEvent(new Ee("expirationupdated"))}function lu(e,t){for(var n=e.h?ze(e.h.$):{},i=(i=Object.keys(n)).length&&"00"==i[0],r=!1,a=!1,o=[],s=[],u=Y(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var d,f=(l=Y(l)).next();!f.done;f=l.next()){(f=f.value).keyId&&((d=n[i?"00":f.keyId])?Us.includes(d)&&(s.includes(d)||s.push(d)):o.includes(f.keyId)||o.push(f.keyId))}c.allowedByApplication?c.allowedByKeySystem&&(r=!0):a=!0}if(!r)throw new me(2,4,4012,{hasAppRestrictions:a,missingKeys:o,restrictedKeyStatuses:s})}function du(t,n){$(function e(){return te(e,function(e){switch(e.j){case 1:return J(e,Promise.resolve(),2);case 2:t.i!=Tu&&t.dispatchEvent(n),K(e)}})})}function fu(e){for(var t=new Set,n=(e=Y(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(Ln(n.language)):t.add("und");return t}function hu(e){for(var t=new Map,n=(e=Y(e)).next();!n.done;n=e.next()){var i=n.value,n="und",r=[];for(i.language&&(n=Ln(i.language)),(r="variant"==i.type?i.audioRoles:i.roles)&&r.length||(r=[""]),t.has(n)||t.set(n,new Set),r=(i=Y(r)).next();!r.done;r=i.next())r=r.value,t.get(n).add(r)}var a=[];return t.forEach(function(e,t){for(var n=Y(e),i=n.next();!i.done;i=n.next())a.push({language:t,role:i.value})}),a}function pu(e){return null==(e=mu(e))?[]:e.variants.filter(function(e){return Bn.Bb(e)})}function mu(e){for(var t=e.o.g(),n=null,i=(e=Y(e.c.periods)).next();!i.done;i=e.next())(i=i.value).startTime<=t&&(n=i);return n}function gu(e){var t=mu(e);return ma(e.ea,t).variant}function vu(){return new me(2,7,7e3)}function yu(e,t,n,i,r,a){return i==e&&r.w==a.w&&r.uri==a.uri&&r.mimeType==a.mimeType&&r.Ea==a.Ea?t:n}function bu(){return{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null}}function wu(n){return new Promise(function(e,t){n.eb=function(){return t(vu())},n.xc=function(){return e()},n.onError=function(e){return t(e)},n.zc=function(){return t(vu())}})}Rs.registerSupportPlugin=function(e,t){_s[e]=t},Rs.isBrowserSupported=function(){if(!(f.Promise&&f.Uint8Array&&Array.prototype.forEach))return!1;var e=tt();return!(e&&e<12||!(f.MediaKeys&&f.navigator&&f.navigator.requestMediaKeySystemAccess&&f.MediaKeySystemAccess&&f.MediaKeySystemAccess.prototype.getConfiguration))&&(!!Je()||Qe("application/x-mpegurl"))},Rs.probeSupport=function(){return It().then(function(e){for(var t=vr.dg(),n={},i=Y('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),r=i.next();!r.done;r=i.next()){n[r=r.value]=Je()?!!vn(r)||(MediaSource.isTypeSupported(r)||Yt(r)):Qe(r);var a=r.split(";")[0];n[a]=n[a]||n[r]}for(var o in e={manifest:t,media:n,drm:e},_s)e[o]=_s[o]();return e})},Rs.prototype.attach=Rs.prototype.Qb=function(e,t){if(t=void 0===t||t,this.i==Tu)return Promise.reject(vu());var n=bu();n.w=e,Je()||(t=!1);var i=t?this.pb:this.V,r=vs(this.Ta,function(){return{node:i,payload:n,$a:!1}});return r.Fb=function(){return ne.info("Starting attach...")},wu(r)},Rs.prototype.detach=Rs.prototype.detach=function(){var e=this;if(this.i==Tu)return Promise.reject(vu());var t=vs(this.Ta,function(){return{node:e.K,payload:bu(),$a:!1}});return t.Fb=function(){return ne.info("Starting detach...")},wu(t)},Rs.prototype.unload=Rs.prototype.Od=function(n){var i=this;if(n=void 0===n||n,this.i==Tu)return Promise.reject(vu());Je()||(n=!1);var r=bu(),e=vs(this.Ta,function(e){var t=e.w&&n?i.pb:e.w?i.V:i.K;return r.w=e.w,{node:t,payload:r,$a:!1}});return e.Fb=function(){return ne.info("Starting unload...")},wu(e)},Rs.prototype.load=Rs.prototype.load=function(e,t,n){if(this.i==Tu)return Promise.reject(vu());this.dispatchEvent(new Ee("loading"));var i=bu();i.uri=e,i.Ld=Date.now()/1e3,n&&"string"!=typeof n&&(qn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),i.Ea=function(){return new n}),n&&"string"==typeof n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var r=function(e,t){if(t.Ea)return;if(!Je())return 1;var n=t.mimeType,i=t.uri||"";return!!(n=n||{mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[vr.getExtension(i)])&&(""!=(t.w||it()).canPlayType(n)&&(!vr.isSupported(i,n)||et()&&e.b.streaming.useNativeHlsOnSafari))}(this,i)?this.rb:this.$,a=vs(this.Ta,function(e){return null==e.w?null:(i.w=e.w,{node:r,payload:i,$a:!0})});return a.Fb=function(){return ne.info("Starting load of "+e+"...")},new Promise(function(e,t){a.zc=function(){return t(new me(2,7,7002))},a.xc=function(){return e()},a.eb=function(){return t(vu())},a.onError=function(e){return t(e)}})},Rs.prototype.configure=Rs.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Es(e,t));var n=As(this.b,e,qs(this));return Bs(this),n},Rs.prototype.getConfiguration=Rs.prototype.getConfiguration=function(){var e=qs(this);return As(e,this.b,qs(this)),e},Rs.prototype.resetConfiguration=Rs.prototype.lg=function(){for(var e in this.b)delete this.b[e];As(this.b,qs(this),qs(this)),Bs(this)},Rs.prototype.getLoadMode=Rs.prototype.jf=function(){return this.i},Rs.prototype.getMediaElement=Rs.prototype.pf=function(){return this.a},Rs.prototype.getNetworkingEngine=Rs.prototype.Ub=function(){return this.T},Rs.prototype.getAssetUri=Rs.prototype.pc=function(){return this.Ob},Rs.prototype.getManifestUri=Rs.prototype.mf=function(){return qn("getManifestUri",'Please use "getAssetUri" instead.'),this.pc()},Rs.prototype.isLive=Rs.prototype.X=function(){return this.c?this.c.presentationTimeline.X():!(!this.a||!this.a.src)&&1/0==this.a.duration},Rs.prototype.isInProgress=Rs.prototype.bb=function(){return!!this.c&&this.c.presentationTimeline.bb()},Rs.prototype.isAudioOnly=Rs.prototype.Gf=function(){if(this.c){if(!this.c.periods.length)return!1;var e=this.c.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.a||!this.a.src)&&(this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight)},Rs.prototype.seekRange=Rs.prototype.ng=function(){if(this.c){var e=this.c.presentationTimeline;return{start:e.wb(),end:e.Ga()}}return this.a&&this.a.src&&(e=this.a.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Rs.prototype.keySystem=Rs.prototype.keySystem=function(){return wt(this.drmInfo())},Rs.prototype.drmInfo=Rs.prototype.drmInfo=function(){return this.h?this.h.a:null},Rs.prototype.getExpiration=Rs.prototype.Tb=function(){return this.h?this.h.Tb():1/0},Rs.prototype.isBuffering=Rs.prototype.fd=function(){return!!this.F&&this.F.a==ka},Rs.prototype.getPlaybackRate=Rs.prototype.tf=function(){var e;return e=!this.H||(e=this.H).f?0:e.c},Rs.prototype.trickPlay=Rs.prototype.Eg=function(e){0==e?ne.Z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(e),this.i==Eu&&co(this.f,1<Math.abs(e)))},Rs.prototype.cancelTrickPlay=Rs.prototype.Te=function(){this.i==xu&&this.H.set(1),this.i==Eu&&(this.H.set(1),co(this.f,!1))},Rs.prototype.getVariantTracks=Rs.prototype.cd=function(){if(this.c&&this.o){for(var e=gu(this),t=[],n=Y(pu(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=Bn.Qd(i);r.active=i==e,t.push(r)}return t}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(e){return Bn.de(e)}):[]},Rs.prototype.getTextTracks=Rs.prototype.zb=function(){if(this.c&&this.o){for(var e=function(e){var t=mu(e);if(null==t)return null;{var n;ma(e.ea,t).text||(n=Bn.Sb(t.textStreams,e.qa,e.nb)).length&&pa(e.ea,t,n[0])}return ma(e.ea,t).text}(this),t=[],n=Y(null==(o=mu(a=this))?[]:o.textStreams.filter(function(e){return!a.hc.has(e)})),i=n.next();!i.done;i=n.next()){i=i.value;var r=Bn.Fc(i);r.active=i==e,t.push(r)}return t}var a,o;return this.a&&this.a.src&&this.a.textTracks?Fs(this).map(function(e){return Bn.Ef(e)}):[]},Rs.prototype.selectTextTrack=Rs.prototype.Fd=function(t){if(this.c&&this.f){var e=mu(this),n=e.textStreams.find(function(e){return e.id==t.id});n?(Vs(this,e,n,!1),zs(this,n),this.qa=n.language):ne.error("No stream with id",t.id)}else if(this.a&&this.a.src&&this.a.textTracks){for(n=(e=Y(e=Fs(this))).next();!n.done;n=e.next())n=n.value,Bn.ed(n)==t.id?n.mode=this.ob?"showing":"hidden":n.mode="disabled";iu(this)}},Rs.prototype.selectEmbeddedTextTrack=Rs.prototype.og=function(){qn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.zb().filter(function(e){return"application/cea-608"==e.mimeType});0<e.length?this.Fd(e[0]):ne.m("Unable to find the text track embedded in the video.")},Rs.prototype.usingEmbeddedTextTrack=Rs.prototype.Jg=function(){qn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.zb().filter(function(e){return e.active})[0];return!!e&&"application/cea-608"==e.mimeType},Rs.prototype.selectVariantTrack=Rs.prototype.pg=function(t,e,n){if(n=void 0===n?0:n,this.c&&this.f){var i=mu(this);this.b.abr.enabled&&ne.Z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=i.variants.find(function(e){return e.id==t.id});r?Bn.Bb(r)?(Hs(this,i,r,!1),Ws(this,r,e,n),this.Pb=new Ta(r),Js(this,i.variants)):ne.error("Unable to switch to restricted track",t.id):ne.error("No variant with id",t.id)}else if(this.a&&this.a.audioTracks){for(n=(e=Y(e=Array.from(this.a.audioTracks))).next();!n.done;n=e.next())n=n.value,Bn.ed(n)==t.id&&(n.enabled=!0);nu(this)}},Rs.prototype.getAudioLanguagesAndRoles=Rs.prototype.df=function(){return hu(this.cd())},Rs.prototype.getTextLanguagesAndRoles=Rs.prototype.Af=function(){return hu(this.zb())},Rs.prototype.getAudioLanguages=Rs.prototype.cf=function(){return Array.from(fu(this.cd()))},Rs.prototype.getTextLanguages=Rs.prototype.zf=function(){return Array.from(fu(this.zb()))},Rs.prototype.selectAudioLanguage=Rs.prototype.Dd=function(e,t){if(this.c&&this.o){var n=mu(this);this.Pb=new Sa(e,t||"",0,"","audio"),Zs(this,n)}else if(this.a&&this.a.audioTracks){for(var i=Array.from(this.a.audioTracks),n=Ln(e),r=(i=Y(i)).next();!r.done;r=i.next()){r=r.value;var a=Bn.de(r);Ln(a.language)!=n||t&&!a.roles.includes(t)||(r.enabled=!0)}nu(this)}},Rs.prototype.selectTextLanguage=Rs.prototype.Ed=function(e,t){var n,i,r;this.c&&this.o?(n=mu(this),this.qa=e,this.nb=t||"",(i=Bn.Sb(n.textStreams,this.qa,this.nb)[0]||null)&&(Vs(this,n,i,!1),(this.b.streaming.alwaysStreamText||this.uc())&&zs(this,i))):(r=Ln(e),(n=this.zb().filter(function(e){return Ln(e.language)==r&&(!t||e.roles.includes(t))})[0])&&this.Fd(n))},Rs.prototype.selectVariantsByLabel=Rs.prototype.qg=function(e){if(this.c&&this.o){for(var t=mu(this),n=null,i=Y(pu(this)),r=i.next();!r.done;r=i.next())if((r=r.value).audio.label==e){n=r;break}null==n?ne.m("No variants were found with label: "+e+". Ignoring the request to switch."):(this.Pb=new Sa(n.language,"",0,e),Zs(this,t))}},Rs.prototype.isTextTrackVisible=Rs.prototype.uc=function(){var e=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Fs(this).some(function(e){return"showing"==e.mode}):e},Rs.prototype.setTextTrackVisibility=Rs.prototype.tg=function(s){var u=this;return $(function e(){var i,r,a,o;return te(e,function(e){switch(e.j){case 1:if(u.ob==(i=!!s))return e.return();if(u.ob=i,u.i!=Eu){if(u.a&&u.a.src&&u.a.textTracks)for(var t=Y(Fs(u)),n=t.next();!n.done;n=t.next())"disabled"!=(r=n.value).mode&&(r.mode=i?"showing":"hidden");e.C(2);break}if(u.G.g.setTextVisibility(i),u.b.streaming.alwaysStreamText){e.C(2);break}if(!i){!function(e){e.G=!0;var t=e.b.get("text");t&&(Co(t),No(t).catch(function(){}),e.b.delete("text"))}(u.f),e.C(2);break}if(so(u.f,"text")){e.C(2);break}if(a=mu(u),0<(o=Bn.Sb(a.textStreams,u.qa,u.nb)).length)return J(e,uo(u.f,o[0]),2);e.C(2);break;case 2:ru(u),K(e)}})})},Rs.prototype.getPlayheadTimeAsDate=Rs.prototype.vf=function(){if(!this.X())return ne.m("getPlayheadTimeAsDate is for live streams!"),null;var e=this.Ta.f,t=0;if(this.o)t=this.o.g();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.c?new Date(1e3*(this.c.presentationTimeline.f+this.a.currentTime)):this.a&&this.a.getStartDate?(e=this.a.getStartDate(),isNaN(e.getTime())?(ne.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(ne.m("No way to get playhead time as Date!"),null)},Rs.prototype.getPresentationStartTimeAsDate=Rs.prototype.xf=function(){if(!this.X())return ne.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1e3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var e=this.a.getStartDate();return isNaN(e.getTime())?(ne.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return ne.m("No way to get presentation start time as Date!"),null},Rs.prototype.getBufferedInfo=Rs.prototype.$c=function(){var e={total:[],audio:[],video:[],text:[]};return this.i==xu&&(e.total=Ht(this.a.buffered)),this.i==Eu&&this.G.$c(e),e},Rs.prototype.getStats=Rs.prototype.getStats=function(){if(this.i!=Eu&&this.i!=xu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};$s(this),(t=this.a).getVideoPlaybackQuality&&(t=t.getVideoPlaybackQuality(),n=this.v,i=Number(t.totalVideoFrames),n.o=Number(t.droppedVideoFrames),n.l=i,this.v.i=Number(t.corruptedVideoFrames)),t=this.h?(t=this.h).K?t.K:NaN:NaN,this.v.h=t,this.i==Eu&&((t=gu(this))&&(this.v.u=t.bandwidth),t&&t.video&&(n=this.v,i=t.video.height||NaN,n.v=t.video.width||NaN,n.g=i),t=this.l.getBandwidthEstimate(),this.v.f=t);for(var e=this.v,t=e.v,n=e.g,i=e.u,r=e.l,a=e.o,o=e.i,s=e.f,u=e.b,c=Ps(e.a,"playing"),l=Ps(e.a,"paused"),d=Ps(e.a,"buffering"),f=e.h,h=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=Y(e.b),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.a&&n.push(t(e.a)),n}(e.a),p=[],m=(e=Y(e.c.a)).next();!m.done;m=e.next())m=m.value,p.push({timestamp:m.timestamp,id:m.id,type:m.type,fromAdaptation:m.fromAdaptation,bandwidth:m.bandwidth});return{width:t,height:n,streamBandwidth:i,decodedFrames:r,droppedFrames:a,corruptedFrames:o,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:d,licenseTime:f,stateHistory:h,switchHistory:p}},Rs.prototype.addTextTrack=Rs.prototype.addTextTrack=function(l,d,f,h,p,m){var g=this;return $(function e(){var t,n,i,r,a,o,s,u,c;return te(e,function(e){switch(e.j){case 1:if(g.i==xu)throw ne.error("Cannot add text when loaded with src="),Error("State error!");if(g.i!=Eu)throw ne.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(t=mu(g),n=Wt,i=g.c.periods.indexOf(t),a=(r=i+1)>=g.c.periods.length?g.c.presentationTimeline.ca():g.c.periods[r].startTime,1/0==(o=a-t.startTime))throw new me(1,4,4033);return s=new Zi(1,0,o,function(){return[l]},0,null),u={id:g.ke++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?s:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:h,codecs:p||"",kind:f,encrypted:!1,keyId:null,language:d,label:m||null,type:n.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},g.hc.add(u),t.textStreams.push(u),J(e,uo(g.f,u),2);case 2:return(c=so(g.f,"text"))&&pa(g.ea,t,c),g.hc.delete(u),ne.debug("Choosing new streams after adding a text stream"),Qs(g,t),tu(g),e.return(Bn.Fc(u))}})})},Rs.prototype.setMaxHardwareResolution=Rs.prototype.Hd=function(e,t){this.ic.width=e,this.ic.height=t},Rs.prototype.retryStreaming=Rs.prototype.Cd=function(){if(this.i==Eu){var e=this.f;if(e.f)ne.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.o)ne.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=Y(e.b.values()),n=t.next();!n.done;n=t.next()){var i=Do(n=n.value);n.Xb&&(ne.info(i,"Retrying after failure..."),n.Xb=!1,Po(e,n,.1))}e=!0}}else e=!1;return e},Rs.prototype.getManifest=Rs.prototype.kf=function(){return this.c},Rs.prototype.getManifestParserFactory=Rs.prototype.lf=function(){return this.u?this.u.constructor:null},(n=Rs.prototype).Vc=function(e){var t=this.f?ao(this.f):null,n=this.f?oo(this.f):null;if(Bn.filterNewPeriod(this.h,t,n,e),!(t=e.variants).some(Bn.Bb))throw new me(2,4,4011);if(lu(this,e.variants),Bn.Sd(t,this.b.restrictions,this.ic)&&this.f&&mu(this)==e&&tu(this),e=this.h?this.h.a:null)for(n=(t=Y(t)).next();!n.done;n=t.next())for(var i=(n=Y(n.value.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==e.keySystem)for(var r=(i=Y(i.initData||[])).next();!r.done;r=i.next())r=r.value,bt(this.h,r.initDataType,r.initData)},n.Lf=function(e){ne.debug("onChooseStreams_",e);try{ne.J("onChooseStreams_, choosing variant from ",e.variants),ne.J("onChooseStreams_, choosing text from ",e.textStreams),this.sb=!0,this.l.disable(),au(this),ne.debug("Choosing new streams after period changed");var t=Js(this,e.variants),n=Bn.Sb(e.textStreams,this.qa,this.nb)[0]||null;this.sa&&(e.variants.includes(this.sa)&&(t=this.sa),this.sa=null),this.ra&&(e.textStreams.includes(this.ra)&&(n=this.ra),this.ra=null),t&&Hs(this,e,t,!0),n&&Vs(this,e,n,!0);var i,r,a=this.f,o=a.b.get("video");r=o?a.c.periods[o.ka]:(i=a.b.get("audio"))?a.c.periods[i.ka]:null;var s,u,c,l,d=t?t.audio:null;!r&&n&&((l=d)&&(e=n,s=Ln(this.b.preferredTextLanguage),u=Ln(d.language),l=Un(c=Ln(e.language),s)&&!Un(u,c)),l&&(this.ob=!0),this.ob&&this.G.g.setTextVisibility(!0),ru(this));var f=this.b.streaming.alwaysStreamText||this.uc()?{variant:t,text:n}:{variant:t,text:null};return ne.J("onChooseStreams_, chose variant ",f.variant),ne.J("onChooseStreams_, chose text ",f.text),f}catch(e){return this.Qa(e),{variant:null,text:null}}},n.Se=function(){ne.debug("canSwitch_"),this.sb=!1,this.b.abr.enabled&&(this.l.enable(),au(this)),this.sa&&(lo(this.f,this.sa,this.je,this.ge),nu(this),this.sa=null),this.ra&&(fo(this.f,this.ra,!0,0,!1),iu(this),this.ra=null)},n.Qf=function(){this.u&&this.u.update&&this.u.update()},n.Vf=function(){this.o&&this.o.u()},n.Qa=function(e){var t;this.i!=Tu&&(t=new Ee("error",{detail:e}),this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0))};var Tu=0,Su=1,Eu=2,xu=3;function ku(e,t){var n=ls(new cs(e.Aa(),e.fa()),t.periods[0],new yr(null,0)),i=t.appMetadata||{},n=Au(n);return{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i}}function Au(e){for(var t=[],n=Bn.sf(e.variants),i=(n=Y(n)).next();!i.done;i=n.next())t.push(Bn.Qd(i.value));for(n=(e=Y(e.textStreams)).next();!n.done;n=e.next())t.push(Bn.Fc(n.value));return t}function Mu(){this.a={}}function Iu(e,t){var n=e.a[t];return null==n&&(n=0,ne.error("Asking for bitrate of stream not given to the estimator")),0==n&&ne.m("Using bitrate of 0, this stream won't affect progress"),n}function Pu(e){this.a=!1,this.b=new ge,this.c=e}function Cu(e){var o=new Ru;e.periods.forEach(function(e,t){var n,i,r=Uu(e.variants);if(0==t)for(var a=(r=Y(r.a)).next();!a.done;a=r.next())o.add(a.value);else i=r,(n=o).a=n.a.filter(function(e){return Du(i,e)})});for(var t=(e=Y(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){return Du(o,new Nu(e))})}function Nu(e){var t=e.audio;e=e.video,this.b=t?t.mimeType:null,this.a=t?t.codecs.split(".")[0]:null,this.f=e?e.mimeType:null,this.c=e?e.codecs.split(".")[0]:null}function Ru(){this.a=[]}function Du(e,t){return e.a.some(function(e){return t.b==e.b&&t.a==e.a&&t.f==e.f&&t.c==e.c})}function Uu(e){for(var t=new Ru,n=(e=Y(e)).next();!n.done;n=e.next())t.add(new Nu(n.value));return t}function _u(e){var n=this;if(e&&e.constructor!=Rs)throw new me(2,9,9008);this.b=this.a=null,e?(this.a=e.b,this.b=e.Ub()):(this.a=ks(),this.b=new Re),this.f=!1,this.c=[],this.g=[];var i=!e;this.h=new Pu(function(){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return t=function(){},J(e,Promise.all(n.g.map(function(e){return e.then(t,t)})),2);case 2:if(i)return J(e,n.b.destroy(),3);e.C(3);break;case 3:n.a=null,n.b=null,K(e)}})})})}function Lu(){if(Je())e:{for(var e=Y(Zo.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Ou(e,t){for(var n=[],i=Y(e.periods),r=i.next();!r.done;r=i.next())for(var a=(r=Y(r.value.streams)).next();!a.done;a=r.next())a=a.value,t&&"video"==a.contentType?n.push({contentType:Xe(a.mimeType,a.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=a.contentType||n.push({contentType:Xe(a.mimeType,a.codecs),robustness:e.drmInfo.audioRobustness});return n}function ju(a,o,s,u,e,c){var l={id:c.id,originalId:c.originalId,primary:c.primary,presentationTimeOffset:c.presentationTimeOffset||0,contentType:c.type,mimeType:c.mimeType,codecs:c.codecs,frameRate:c.frameRate,pixelAspectRatio:c.pixelAspectRatio,kind:c.kind,language:c.language,label:c.label,width:c.width||null,height:c.height||null,initSegmentKey:null,encrypted:c.encrypted,keyId:c.keyId,segments:[],variantIds:[]};e=e.presentationTimeline.Wb();var d=c.id,t=c.initSegmentReference;return t&&(t=br(t.c(),t.b,t.a,a.a.streaming.retryParameters),Ko(o,d,t,.5*Iu(u,c.id),!0,function(n){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,s.addSegments([{data:n}]),2);case 2:t=e.s,a.c.push(t[0]),l.initSegmentKey=t[0],K(e)}})})})),function(e,t,n){for(var i=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);i;)n(i),i=e.getSegmentReference(++t)}(c,e,function(i){var e,t,n,r=br(i.c(),i.b,i.a,a.a.streaming.retryParameters);Ko(o,d,r,(e=u,t=c.id,n=(n=i).endTime-n.startTime,Iu(e,t)*n),!1,function(n){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return J(e,s.addSegments([{data:n}]),2);case 2:t=e.s,a.c.push(t[0]),l.segments.push({startTime:i.startTime,endTime:i.endTime,dataKey:t[0]}),K(e)}})})})}),l}function Ku(e){if(e.h.a)throw new me(2,9,7001)}function Bu(){if(!Lu())throw new me(2,9,9e3)}function Fu(t,n){return $(function e(){return te(e,function(e){switch(e.j){case 1:return t.g.push(n),D(e,2),J(e,n,4);case 4:return e.return(e.s);case 2:U(e),Ie(t.g,n),_(e,0)}})})}function Hu(e){var t=new Set(e.variants.map(function(e){return e.video})),n=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams,1<t.size&&ne.m("Multiple video tracks selected to be stored");for(var i=(t=Y(n)).next();!i.done;i=t.next()){i=i.value;for(var r=Y(n),a=r.next();!a.done;a=r.next())i!=(a=a.value)&&i.language==a.language&&ne.m("Similar audio tracks were selected to be stored",i.id,a.id)}for(t=(n=Y(e)).next();!t.done;t=n.next())for(t=t.value,r=(i=Y(e)).next();!r.done;r=i.next())t!=(r=r.value)&&t.language==r.language&&ne.m("Similar text tracks were selected to be stored",t.id,r.id)}Rs.LoadMode={DESTROYED:Tu,NOT_LOADED:Su,MEDIA_SOURCE:Eu,SRC_EQUALS:xu},Pu.prototype.destroy=function(){var e=this;return this.a?this.b:(this.a=!0,this.c().then(function(){e.b.resolve()},function(){e.b.resolve()}))},Ru.prototype.add=function(e){Du(this,e)||this.a.push(e)},R("shaka.offline.Storage",_u),_u.support=Lu,_u.prototype.destroy=_u.prototype.destroy=function(){return this.h.destroy()},_u.prototype.configure=_u.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Es(e,t));var n=e,i=!1;return null!=n.trackSelectionCallback&&(i=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(i=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(i=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),i&&qn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),As(this.a,e)},_u.prototype.getConfiguration=_u.prototype.getConfiguration=function(){var e=ks();return As(e,this.a,ks()),e},_u.prototype.getNetworkingEngine=_u.prototype.Ub=function(){return this.b},_u.prototype.store=_u.prototype.store=function(n,e,i){var b,w,T,S,r=this;return Fu(this,(b=this,w=n,T=e||{},S=function(){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return i&&"string"!=typeof i?(qn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.return(new i)):J(e,vr.create(n,r.b,r.a.manifest.retryParameters,i),2);case 2:return t=e.s,e.return(t)}})})},$(function e(){var t,n,a,o,p,m,g,v,y;return te(e,function(e){switch(e.j){case 1:return Bu(),b.f?e.return(Promise.reject(new me(2,9,9006))):(b.f=!0,J(e,(l=b,d=w,h=S,$(function e(){var t,n,i,r,a,o;return te(e,function(e){switch(e.j){case 1:return t=null,n=l.b,i={networkingEngine:n,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){t=e}},J(e,h(),2);case 2:return(r=e.s).configure(l.a.manifest),Ku(l),D(e,3),J(e,r.start(d,i),5);case 5:return a=e.s,Ku(l),o=function(e){for(var t=new Set,n=(e=Y(e.periods)).next();!n.done;n=e.next()){for(var i=Y((n=n.value).textStreams),r=i.next();!r.done;r=i.next())t.add(r.value);for(n=Y(n.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video)}return t}(a),J(e,Promise.all(qe(o,function(e){return e.createSegmentIndex()})),6);case 6:if(Ku(l),t)throw t;return e.return(a);case 3:return U(e),J(e,r.stop(),7);case 7:_(e,0)}})})),2));case 2:if(t=e.s,Ku(b),t.presentationTimeline.X()||t.presentationTimeline.bb())throw new me(2,9,9005,w);return n=null,a=new $o,p=o=null,Q(e,3,4),J(e,(s=b,u=t,c=function(e){p=p||e},$(function e(){var r,a,o;return te(e,function(e){switch(e.j){case 1:return r=new pt({Db:s.b,onError:c,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),a=Ua(u.periods),o=s.a,r.configure(o.drm),J(e,(t=r,n=a,i=o.offline.usePersistentLicense,t.u=[],t.G=i,gt(t,n)),2);case 2:return J(e,vt(r),3);case 3:return J(e,yt(r),4);case 4:return e.return(r)}var t,n,i})})),6);case 6:if(n=e.s,Ku(b),p)throw p;return J(e,(f=b,i=t,r=n,$(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return t={width:1/0,height:1/0},function(e,t,n){for(var i=(e=Y(e.periods)).next();!i.done;i=e.next())(i=i.value).variants=i.variants.filter(function(e){return Bn.ld(e,t,n)})}(i,f.a.restrictions,t),function(e){for(var t=(e=Y(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter(function(e){var t=!0;return e.audio&&(t=t&&Sn(e.audio)),e.video&&(t=t&&Sn(e.video)),t})}(i),function(e,t){for(var n=Y(e.periods),i=n.next();!i.done;i=n.next())(i=i.value).variants=i.variants.filter(function(e){return Pt(t,e)})}(i,r),Cu(i),n=f.a.preferredAudioChannelCount,Bn.Vd(i,n),J(e,(a=i,o=function(d){return $(function e(){var i,r,a,o,s,u,c,l;return te(e,function(e){switch(e.j){case 1:i=Bn,r=[];for(var t=Y(d.variants),n=t.next();!n.done;n=t.next())a=n.value,r.push(i.Qd(a));for(n=(t=Y(d.textStreams)).next();!n.done;n=t.next())o=n.value,r.push(i.Fc(o));return J(e,f.a.offline.trackSelectionCallback(r),2);case 2:for(s=e.s,u=new Set,c=new Set,n=(t=Y(s)).next();!n.done;n=t.next())"variant"==(l=n.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);d.variants=d.variants.filter(function(e){return u.has(e.id)}),d.textStreams=d.textStreams.filter(function(e){return c.has(e.id)}),K(e)}})})},$(function e(){var t,n,i,r;return te(e,function(e){switch(e.j){case 1:t=null,n=Y(a.periods),i=n.next();case 2:if(i.done){e.C(0);break}return r=i.value,t&&(r.variants=r.variants.filter(function(e){return Du(t,new Nu(e))})),J(e,o(r),5);case 5:t=Uu(r.variants),i=n.next(),e.C(2)}})})),2);case 2:(function(e){if(0==e.periods.length)throw new me(2,4,4014);for(var t=(e=Y(e.periods)).next();!t.done;t=e.next())Hu(t.value)})(i),K(e)}var a,o})})),7);case 7:return J(e,a.init(),8);case 8:return Ku(b),J(e,function(e){var i=null;if(e.a.forEach(function(e,n){e.getCells().forEach(function(e,t){e.hasFixedKeySpace()||i||(i={path:{Aa:n,fa:t},fa:e})})}),i)return i;throw new me(2,9,9013,"Could not find a cell that supports add-operations")}(a),9);case 9:return o=e.s,Ku(b),J(e,(M=b,I=o.fa,P=n,C=t,N=w,R=T,$(function e(){var v,y,b,w,T,S,E,x,k,A;return te(e,function(e){switch(e.j){case 1:return h=N,m=R,g=null==(p=C).expiration?1/0:p.expiration,v={offlineUri:null,originalManifestUri:h,duration:p.presentationTimeline.ca(),size:0,expiration:g,tracks:p=Au(p.periods[0]),appMetadata:m},y=C.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos&&e.drmInfos.length})}),b=C.periods.some(function(e){return e.variants.some(function(e){return e.drmInfos.some(function(e){return e.initData&&e.initData.length})})}),T=null,(w=y&&!b)&&(S=P.a,T=Vu.get(S.keySystem)),E=new jo(M.b,function(e,t){v.size=t,M.a.offline.progressCallback(v,e)},function(e,t){w&&M.a.offline.usePersistentLicense&&T==t&&bt(P,"cenc",e)}),D(e,2),n=M,i=E,r=I,a=P,o=C,s=N,u=R,c=new Mu,l=o.periods.map(function(e){return function(e,t,n,i,r,a){for(var o,s,u,c,l,d,f=Y(a.variants),h=f.next();!h.done;h=f.next())o=i,s=h.value,c=void 0,l=s.audio,d=s.video,l&&!d&&(o.a[l.id]=l.bandwidth||s.bandwidth),!l&&d&&(o.a[d.id]=d.bandwidth||s.bandwidth),l&&d&&(u=l.bandwidth||393216,(c=d.bandwidth||s.bandwidth-u)<=0&&(ne.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),c=s.bandwidth),o.a[l.id]=u,o.a[d.id]=c);for(f=Y(a.textStreams),h=f.next();!h.done;h=f.next())i.a[h.value.id]=52;f=function(e){for(var t=new Set,n=Y(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=Y(e.variants),n=e.next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}(a);var p=new Map;for(f=Y(f),h=f.next();!h.done;h=f.next()){h=h.value;var m=ju(e,t,n,i,r,h);p.set(h.id,m)}return a.variants.forEach(function(e){e.audio&&p.get(e.audio.id).variantIds.push(e.id),e.video&&p.get(e.video.id).variantIds.push(e.id)}),{startTime:a.startTime,streams:Array.from(p.values())}}(n,i,r,c,o,e)}),d=a.a,f=n.a.offline.usePersistentLicense,d&&f&&(d.initData=[]),k=x={originalManifestUri:s,duration:o.presentationTimeline.ca(),size:0,expiration:a.Tb(),periods:l,sessionIds:f?St(a):[],drmInfo:d,appMetadata:u},J(e,(t=E,$(function e(){return te(e,function(e){switch(e.j){case 1:return J(e,Promise.all(t.b.values()),2);case 2:return e.return(t.a.a)}})})),4);case 4:if(k.size=e.s,x.expiration=P.Tb(),A=St(P),x.sessionIds=M.a.offline.usePersistentLicense?A:[],y&&M.a.offline.usePersistentLicense&&!A.length)throw new me(2,9,9007);return e.return(x);case 2:return U(e),J(e,E.destroy(),5);case 5:_(e,0)}var t,n,i,r,a,o,s,u,c,l,d,f,h,p,m,g})})),10);case 10:if(m=e.s,Ku(b),p)throw p;return J(e,o.fa.addManifests([m]),11);case 11:return g=e.s,Ku(b),v=new ss("manifest",o.path.Aa,o.path.fa,g[0]),e.return(ku(v,m));case 4:return U(e),b.f=!1,b.c=[],J(e,a.destroy(),12);case 12:if(n)return J(e,n.destroy(),13);e.C(13);break;case 13:_(e,0);break;case 3:if(y=ee(e),o)return J(e,o.fa.removeSegments(b.c,function(){}),15);e.C(15);break;case 15:throw p||y}var M,I,P,C,N,R,f,i,r,s,u,c,l,d,h})})))},_u.prototype.getStoreInProgress=_u.prototype.yf=function(){return this.f},_u.prototype.remove=_u.prototype.remove=function(e){return Fu(this,(b=this,w=e,$(function e(){var h,p,m,g,v,y;return te(e,function(e){switch(e.j){case 1:return Bu(),null==(h=us(w))||"manifest"!=h.a?e.return(Promise.reject(new me(2,9,9004,w))):(p=h,m=new $o,D(e,2),J(e,m.init(),4));case 4:return J(e,Jo(m,p.Aa(),p.fa()),5);case 5:return J(e,(g=e.s).getManifests([p.key()]),6);case 6:return v=e.s,y=v[0],J(e,Promise.all([(l=b,d=y,f=m,$(function e(){return te(e,function(e){switch(e.j){case 1:return J(e,(r=l.b,a=l.a.drm,o=f,s=d,$(function e(){var t,n,i;return te(e,function(e){switch(e.j){case 1:return s.drmInfo?(t=function(e){var t=Array.from(e.a.keys());if(!t.length)throw new me(2,9,9e3,"No supported storage mechanisms found");return e.a.get(t[0]).getEmeSessionCell()}(o),n=s.sessionIds.map(function(e){return{sessionId:e,keySystem:s.drmInfo.keySystem,licenseUri:s.drmInfo.licenseServerUri,serverCertificate:s.drmInfo.serverCertificate,audioCapabilities:Ou(s,!1),videoCapabilities:Ou(s,!0)}}),J(e,ms(a,r,n),2)):e.return();case 2:return i=e.s,J(e,t.remove(i),3);case 3:return J(e,t.add(n.filter(function(e){return-1==i.indexOf(e.sessionId)})),0)}})})),0)}var r,a,o,s})})),(n=b,i=g,r=p,o=function(e){var t=[];return e.periods.forEach(function(e){e.streams.forEach(function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach(function(e){t.push(e.dataKey)})})}),t}(a=y),s=o.length+1,u=0,c=ku(r,a),Promise.all([i.removeSegments(o,t),i.removeManifests([r.key()],t)]))]),2);case 2:return U(e),J(e,m.destroy(),8);case 8:_(e,0)}function t(){u+=1,n.a.offline.progressCallback(c,u/s)}var n,i,r,a,o,s,u,c,l,d,f})})));var b,w},_u.prototype.removeEmeSessions=_u.prototype.ig=function(){return Fu(this,(d=this,$(function e(){var r,a,n,o,i,s,u,c,l;return te(e,function(e){switch(e.j){case 1:return Bu(),r=d.b,a=d.a.drm,n=new $o,o=!1,D(e,2),J(e,n.init(),4);case 4:for(i=[],t=function(e){return i.push(e)},n.a.forEach(function(e){t(e.getEmeSessionCell())}),s=Promise.resolve(),u={},c=Y(i),l=c.next();!l.done;u={Ec:u.Ec},l=c.next())u.Ec=l.value,s=s.then(function(i){return function(){return $(function e(){var t,n;return te(e,function(e){switch(e.j){case 1:return J(e,i.Ec.getAll(),2);case 2:return t=e.s,J(e,ms(a,r,t),3);case 3:return n=e.s,J(e,i.Ec.remove(n),4);case 4:n.length!=t.length&&(o=!0),K(e)}})})}}(u));return J(e,s,2);case 2:return U(e),J(e,n.destroy(),6);case 6:_(e,3);break;case 3:return e.return(!o)}var t})})));var d},_u.prototype.list=_u.prototype.list=function(){return Fu(this,$(function e(){var r,t,n;return te(e,function(e){switch(e.j){case 1:return Bu(),r=[],t=new $o,D(e,2),J(e,t.init(),4);case 4:return n=Promise.resolve(),i=function(i,t){n=n.then(function(){return $(function e(){return te(e,function(e){switch(e.j){case 1:return J(e,t.getAllManifests(),2);case 2:e.s.forEach(function(e,t){var n=ku(new ss("manifest",i.Aa,i.fa,t),e);r.push(n)}),K(e)}})})})},t.a.forEach(function(e,n){e.getCells().forEach(function(e,t){i({Aa:n,fa:t},e)})}),J(e,n,2);case 2:return U(e),J(e,t.destroy(),6);case 6:_(e,3);break;case 3:return e.return(r)}var i})}))},_u.deleteAll=function(){return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return t=new $o,D(e,2),J(e,t.erase(),2);case 2:return U(e),J(e,t.destroy(),5);case 5:_(e,0)}})})};var Vu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");_s.offline=Lu,R("shaka.polyfill.installAll",function(){for(var e=0;e<Wu.length;++e)try{Wu[e].Qe()}catch(e){ne.Z("Error installing polyfill!",e)}});var qu,Gu,Wu=[];function zu(e,t){for(var n={priority:t=t||0,Qe:e},i=0;i<Wu.length;i++)if(Wu[i].priority<t)return void Wu.splice(i,0,n);Wu.push(n)}function Xu(e){var t,n=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();"function"==typeof Event?t=new Event(n,e):(t=document.createEvent("Event")).initEvent(n,e.bubbles,e.cancelable),e.target.dispatchEvent(t)}function Yu(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function $u(){var i=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];return(t=i.apply(this,t)).abort=function(){},t}}function Ju(e,t){ne.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var n=new Qu(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Qu(e,t){if(ne.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),(this.keySystem=e).startsWith("com.apple.fps"))for(var n=Y(t),i=n.next();!i.done;i=n.next()){var r=i.value;if("required"==r.persistentState)i=null;else{var a,o=!(i={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label}),s=!1;if(r.audioCapabilities)for(var u=Y(r.audioCapabilities),c=u.next();!c.done;c=u.next()){(c=c.value).contentType&&(o=!0,a=c.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,a)&&(i.audioCapabilities.push(c),s=!0))}if(r.videoCapabilities)for(c=(r=Y(r.videoCapabilities)).next();!c.done;c=r.next())(u=c.value).contentType&&(o=!0,c=u.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(i.videoCapabilities.push(u),s=!0));o||(s=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),i=s?i:null}if(i)return void(this.a=i)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Zu(e){ne.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&tc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?tc(e,this):Promise.resolve()}function ec(e){ne.debug("PatchedMediaKeysApple.MediaKeys"),this.b=new WebKitMediaKeys(e),this.a=new Ke}function tc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"webkitneedkey",ic);try{return Ka(t,HTMLMediaElement.HAVE_METADATA,e.a,function(){t.webkitSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function nc(e){ne.debug("PatchedMediaKeysApple.MediaKeySession"),ke.call(this),this.b=null,this.g=e,this.c=this.a=null,this.f=new Ke,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new ac}function ic(e){if(ne.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=ct(e=st(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function rc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function ac(){this.size=0,this.a=void 0}function oc(e,t){ne.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var n=new sc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function sc(e,t){ne.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var n=!1,i=0;i<t.length;++i){var r=t[i],a={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},o=!1;if(r.audioCapabilities)for(var s=0;s<r.audioCapabilities.length;++s){var u,c=r.audioCapabilities[s];c.contentType&&(o=!0,u=c.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.audioCapabilities.push(c),n=!0))}if(r.videoCapabilities)for(s=0;s<r.videoCapabilities.length;++s)(c=r.videoCapabilities[s]).contentType&&(o=!0,u=c.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,u)&&(a.videoCapabilities.push(c),n=!0));if(o||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(n=!1),n)return void(this.a=a)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function uc(e){ne.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&lc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?lc(e,this):Promise.resolve()}function cc(e){ne.debug("PatchedMediaKeysMs.MediaKeys"),this.b=new MSMediaKeys(e),this.a=new Ke}function lc(e,t){if(e.a.hb(),!t)return Promise.resolve();e.a.B(t,"msneedkey",fc);try{return Ka(t,HTMLMediaElement.HAVE_METADATA,e.a,function(){t.msSetMediaKeys(e.b)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function dc(e){ne.debug("PatchedMediaKeysMs.MediaKeySession"),ke.call(this),this.c=null,this.g=e,this.b=this.a=null,this.f=new Ke,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new pc}function fc(e){var t;ne.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData&&((t=document.createEvent("CustomEvent")).initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=Bi(e.initData).buffer,this.dispatchEvent(t))}function hc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function pc(){this.size=0,this.a=void 0}function mc(){return ne.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function gc(e){return ne.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function vc(){throw new TypeError("Illegal constructor.")}function yc(){throw new TypeError("Illegal constructor.")}R("shaka.polyfill.register",zu),zu(function(){Pl()},-1),zu(function(){var e;f.Document&&((e=Element.prototype).requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Xu),document.addEventListener("webkitfullscreenerror",Xu),document.addEventListener("mozfullscreenchange",Xu),document.addEventListener("mozfullscreenerror",Xu),document.addEventListener("MSFullscreenChange",Xu),document.addEventListener("MSFullscreenError",Xu))}),zu(function(){ne.debug("IndexedDB.install");var t=!1;if(nt("CrKey"))ne.debug("Removing IndexedDB from ChromeCast"),t=!0;else try{f.indexedDB&&(t=!1)}catch(e){ne.debug("Removing IndexedDB due to an exception when accessing it"),t=!0}t&&delete f.indexedDB}),zu(function(){ne.debug("InputEvent.install"),nt("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(ne.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Yu)}),zu(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})}),zu(function(){ne.debug("mathRound.install")}),zu(function(){ne.debug("MediaSource.install");var t,n,i,l,d,e=tt();f.MediaSource?f.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(ne.info("Patching Chromecast MSE bugs."),l=MediaSource.isTypeSupported,d=/^dv(?:h[e1]|a[v1])\./,MediaSource.isTypeSupported=function(e){for(var t=e.split(/ *; */),n=t[0],i={},r=1;r<t.length;++r){var a=(o=t[r].split("="))[0],o=o[1].replace(/"(.*)"/,"$1");i[a]=o}if(!(t=i.codecs))return l(e);var s=!1,u=!1;for(var c in e=t.split(",").filter(function(e){return d.test(e)&&(u=!0),/^(hev|hvc)1\.2/.test(e)&&(s=!0),!0}),u&&(s=!1),i.codecs=e.join(","),s&&(i.eotf="smpte2084"),i)n+="; "+c+'="'+i[c]+'"';return cast.__platform__.canDisplayType(n)}):e?(i=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"mp2t"!=e.split(/ *; */)[0].split("/")[1].toLowerCase()&&i(e)},e<=12?(ne.info("Patching Safari 11 & 12 MSE bugs."),$u(),n=SourceBuffer.prototype.remove,SourceBuffer.prototype.remove=function(e,t){return n.call(this,e,t-.001)}):(ne.info("Patching Safari 13 MSE bugs."),$u())):nt("Tizen 2")||nt("Tizen 3")||nt("Tizen 4")?(t=MediaSource.isTypeSupported,MediaSource.isTypeSupported=function(e){return"opus"!=Ye(e)[0]&&t(e)}):ne.info("Using native MSE as-is."):ne.info("No MSE implementation available.")}),Qu.prototype.createMediaKeys=function(){ne.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new ec(this.keySystem);return Promise.resolve(e)},Qu.prototype.getConfiguration=function(){return ne.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.a},ec.prototype.createSession=function(e){if(ne.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new nc(this.b)},ec.prototype.setServerCertificate=function(e){return ne.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),e&&new Uint8Array(e),Promise.resolve(!0)},L(nc,ke),(n=nc.prototype).generateRequest=function(e,t){ne.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.a=new ge;try{this.b=this.g.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.yg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.wg.bind(this)),this.f.B(this.b,"webkitkeyerror",this.xg.bind(this)),rc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},n.load=function(){return ne.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(e){ne.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.c=new ge;try{this.b.update(new Uint8Array(e))}catch(e){this.c.reject(e)}return this.c},n.close=function(){ne.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},n.remove=function(){return ne.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.yg=function(e){ne.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ee("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},n.wg=function(e){ne.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.c&&(rc(this,"usable"),this.c.resolve(),this.c=null)},n.xg=function(e){if(ne.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.b.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.c)this.c.reject(e),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:rc(this,"output-not-allowed");break;default:rc(this,"internal-error")}},(n=ac.prototype).forEach=function(e){this.a&&e(this.a,qu)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=qu;return!(!this.a||!ht.Da(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},zu(function(){f.HTMLVideoElement&&f.WebKitMediaKeys&&(ne.info("Using Apple-prefixed EME"),qu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Zu,f.MediaKeys=ec,f.MediaKeySystemAccess=Qu,navigator.requestMediaKeySystemAccess=Ju)}),sc.prototype.createMediaKeys=function(){ne.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new cc(this.keySystem);return Promise.resolve(e)},sc.prototype.getConfiguration=function(){return ne.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.a},cc.prototype.createSession=function(e){if(ne.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new dc(this.b)},cc.prototype.setServerCertificate=function(){return ne.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},L(dc,ke),(n=dc.prototype).generateRequest=function(e,t){ne.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.a=new ge;try{this.c=this.g.createSession("video/mp4",new Uint8Array(t),null),this.f.B(this.c,"mskeymessage",this.Uf.bind(this)),this.f.B(this.c,"mskeyadded",this.Sf.bind(this)),this.f.B(this.c,"mskeyerror",this.Tf.bind(this)),hc(this,"status-pending")}catch(e){this.a.reject(e)}return this.a},n.load=function(){return ne.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},n.update=function(e){ne.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.b=new ge;try{this.c.update(new Uint8Array(e))}catch(e){this.b.reject(e)}return this.b},n.close=function(){ne.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(e){this.closed.reject(e)}return this.closed},n.remove=function(){return ne.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},n.Uf=function(e){ne.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.a&&(this.a.resolve(),this.a=null),this.dispatchEvent(new Ee("message",{messageType:null==this.keyStatuses.a?"license-request":"license-renewal",message:e.message.buffer}))},n.Sf=function(e){ne.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.a?(ne.debug("Simulating completion for a PR persistent license."),hc(this,"usable"),this.a.resolve(),this.a=null):this.b&&(hc(this,"usable"),this.b.resolve(),this.b=null)},n.Tf=function(e){if(ne.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.c.error,null!=this.a)this.a.reject(e),this.a=null;else if(null!=this.b)this.b.reject(e),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:hc(this,"output-not-allowed");break;default:hc(this,"internal-error")}},(n=pc.prototype).forEach=function(e){this.a&&e(this.a,Gu)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=Gu;return!(!this.a||!ht.Da(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},zu(function(){!f.HTMLVideoElement||!f.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(ne.info("Using ms-prefixed EME v20140218"),Gu=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=uc,f.MediaKeys=cc,f.MediaKeySystemAccess=sc,navigator.requestMediaKeySystemAccess=oc)}),vc.prototype.createSession=function(){},vc.prototype.setServerCertificate=function(){},yc.prototype.getConfiguration=function(){},yc.prototype.createMediaKeys=function(){},zu(function(){!f.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(ne.info("EME not available."),navigator.requestMediaKeySystemAccess=mc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=gc,f.MediaKeys=vc,f.MediaKeySystemAccess=yc)},-10);var bc,wc="";function Tc(e){return wc?wc+e.charAt(0).toUpperCase()+e.slice(1):e}function Sc(e,t){ne.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var n=new xc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Ec(e){ne.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Ac(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Ac(e,this),Promise.resolve()}function xc(e,t){ne.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.a=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(n=!(this.a="webkit-org.w3.clearkey"));for(var i=!1,r=(r=document.getElementsByTagName("video")).length?r[0]:document.createElement("video"),a=0;a<t.length;++a){var o=t[a],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:o.initDataTypes,sessionTypes:["temporary"],label:o.label},u=!1;if(o.audioCapabilities)for(var c=0;c<o.audioCapabilities.length;++c){var l,d=o.audioCapabilities[c];d.contentType&&(u=!0,l=d.contentType.split(";")[0],r.canPlayType(l,this.a)&&(s.audioCapabilities.push(d),i=!0))}if(o.videoCapabilities)for(c=0;c<o.videoCapabilities.length;++c)(d=o.videoCapabilities[c]).contentType&&(u=!0,r.canPlayType(d.contentType,this.a)&&(s.videoCapabilities.push(d),i=!0));if(u||(i=r.canPlayType("video/mp4",this.a)||r.canPlayType("video/webm",this.a)),"required"==o.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):i=!1),i)return void(this.b=s)}throw n="org.w3.clearkey"!=e&&"com.widevine.alpha"!=e?"Unsupported keySystem":"None of the requested configurations were supported.",(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function kc(e){ne.debug("PatchedMediaKeysWebkit.MediaKeys"),this.g=e,this.b=null,this.a=new Ke,this.c=[],this.f={}}function Ac(e,t){e.b=t,e.a.hb();var n=wc;t&&(e.a.B(t,n+"needkey",e.Yf.bind(e)),e.a.B(t,n+"keymessage",e.Bg.bind(e)),e.a.B(t,n+"keyadded",e.zg.bind(e)),e.a.B(t,n+"keyerror",e.Ag.bind(e)))}function Mc(e,t){var n=e.f[t];return n?(ne.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):(n=e.c.shift())?(n.sessionId=t,e.f[t]=n,ne.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):null}function Ic(e,t,n){ne.debug("PatchedMediaKeysWebkit.MediaKeySession"),ke.call(this),this.f=e,this.h=!1,this.a=this.b=null,this.c=t,this.g=n,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new Nc}function Pc(t,e,n){if(t.h)return Promise.reject(Error("The session is already initialized."));t.h=!0;try{var i,r,a="persistent-license"==t.g?n?new Uint8Array(ct("LOAD_SESSION|"+n)):(i=ct("PERSISTENT|"),(r=new Uint8Array(i.byteLength+e.byteLength)).set(new Uint8Array(i),0),r.set(new Uint8Array(e),i.byteLength),r):new Uint8Array(e)}catch(e){return Promise.reject(e)}t.b=new ge;var o=Tc("generateKeyRequest");try{t.f[o](t.c,a)}catch(e){if("InvalidStateError"!=e.name)return t.b=null,Promise.reject(e);new de(function(){try{t.f[o](t.c,a)}catch(e){t.b.reject(e),t.b=null}}).R(.01)}return t.b}function Cc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.a=t,e.dispatchEvent(new Ee("keystatuseschange"))}function Nc(){this.size=0,this.a=void 0}function Rc(e){var t="picture-in-picture"==(e=e.target).webkitPresentationMode?(document.pictureInPictureElement=e,new Event("enterpictureinpicture")):(document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),new Event("leavepictureinpicture"));e.dispatchEvent(t)}function Dc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Uc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function _c(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Lc(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Oc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function jc(e,t,n){return new f.TextTrackCue(e,t,n)}function Kc(e,t,n){return new f.TextTrackCue(e+"-"+t+"-"+n,e,t,n)}function Bc(){}xc.prototype.createMediaKeys=function(){ne.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new kc(this.a);return Promise.resolve(e)},xc.prototype.getConfiguration=function(){return ne.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.b},(n=kc.prototype).createSession=function(e){if(ne.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.b||document.createElement("video");return t.src||(t.src="about:blank"),e=new Ic(t,this.g,e),this.c.push(e),e},n.setServerCertificate=function(){return ne.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},n.Yf=function(e){ne.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.b.dispatchEvent(t)},n.Bg=function(e){ne.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Mc(this,e.sessionId);t?(e=new Ee("message",{messageType:null==t.keyStatuses.a?"licenserequest":"licenserenewal",message:e.message}),ne.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.b&&(t.b.resolve(),t.b=null),t.dispatchEvent(e)):ne.error("Session not found",e.sessionId)},n.zg=function(e){ne.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Mc(this,e.sessionId))&&(ne.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Cc(e,"usable"),e.a&&e.a.resolve(),e.a=null)},n.Ag=function(e){ne.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Mc(this,e.sessionId);t&&t.handleError(e)},L(Ic,ke),(n=Ic.prototype).handleError=function(e){ne.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.b?(45==e.systemCode&&(t.message="Unsupported session type."),this.b.reject(t),this.b=null):e.sessionId&&this.a?(this.a.reject(t),this.a=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Cc(this,"output-restricted"):Cc(this,1==t?"expired":"internal-error"))},n.Kd=function(e,t){if(this.a)this.a.then(this.Kd.bind(this,e,t)).catch(this.Kd.bind(this,e,t));else{var n,i;this.a=e,i="webkit-org.w3.clearkey"==this.c?(n=ot(t),"oct"!=(i=JSON.parse(n)).keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),n=ht.Fa(i.keys[0].k),ht.Fa(i.keys[0].kid)):(n=new Uint8Array(t),null);var r=Tc("addKey");try{this.f[r](this.c,n,i,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}},n.generateRequest=function(e,t){return ne.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),Pc(this,t,null)},n.load=function(e){return ne.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.g?Pc(this,null,e):Promise.reject(Error("Not a persistent session."))},n.update=function(e){ne.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new ge;return this.Kd(t,e),t},n.close=function(){if(ne.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Tc("cancelKeyRequest");try{this.f[e](this.c,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},n.remove=function(){return ne.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()},(n=Nc.prototype).forEach=function(e){this.a&&e(this.a,bc)},n.get=function(e){if(this.has(e))return this.a},n.has=function(e){var t=bc;return!(!this.a||!ht.Da(new Uint8Array(e),new Uint8Array(t)))},n.entries=function(){},n.keys=function(){},n.values=function(){},zu(function(){if(!(!f.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)ne.info("Using webkit-prefixed EME v0.1b"),wc="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;ne.info("Using nonprefixed EME v0.1b")}bc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Sc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ec,f.MediaKeys=kc,f.MediaKeySystemAccess=xc}}),zu(function(){var e;f.HTMLVideoElement&&((e=HTMLVideoElement.prototype).requestPictureInPicture&&document.exitPictureInPicture||!e.webkitSupportsPresentationMode||(ne.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=Dc,Object.defineProperty(e,"disablePictureInPicture",{get:_c,set:Lc,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Uc,document.addEventListener("webkitpresentationmodechanged",Rc,!0)))}),zu(function(){var t;ne.debug("VideoPlayPromise.install"),f.HTMLMediaElement&&(t=HTMLMediaElement.prototype.play,HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e})}),zu(function(){var e;!f.HTMLVideoElement||!(e=HTMLVideoElement.prototype).getVideoPlaybackQuality&&"webkitDroppedFrameCount"in e&&(e.getVideoPlaybackQuality=Oc)}),zu(function(){if(f.VTTCue)ne.info("Using native VTTCue.");else if(f.TextTrackCue){var e=TextTrackCue.length;if(3==e)ne.info("Using VTTCue polyfill from 3 argument TextTrackCue."),f.VTTCue=jc;else if(6==e)ne.info("Using VTTCue polyfill from 6 argument TextTrackCue."),f.VTTCue=Kc;else{try{var t=!!jc(1,2,"")}catch(e){t=!1}t&&(ne.info("Using VTTCue polyfill from 3 argument TextTrackCue."),f.VTTCue=jc)}}else ne.error("VTTCue not available.")}),R("shaka.text.TtmlTextParser",Bc),Bc.prototype.parseInit=Bc.prototype.parseInit=function(){},Bc.prototype.parseMedia=Bc.prototype.parseMedia=function(e,t){var n=ot(e),i=[],r=new DOMParser,a=null;if(""==n)return i;try{a=r.parseFromString(n,"text/xml")}catch(e){throw new me(2,2,2005,"Failed to parse TTML.")}if(a){if(n=a.getElementsByTagName("parsererror")[0])throw new me(2,2,2005,n.textContent);if(!(r=a.getElementsByTagName("tt")[0]))throw new me(2,2,2005,"TTML does not contain <tt> tag.");var o=Fi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=Fi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Fi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=Fi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","tickRate"),a=r.getAttribute("xml:space")||"default",n=r.getAttribute("tts:extent");if("default"!=a&&"preserve"!=a)throw new me(2,2,2005,"Invalid xml:space value: "+a);a="default"==a,o=new cl(o,s,u,c),s=el(r.getElementsByTagName("metadata")[0]),u=el(r.getElementsByTagName("styling")[0]),c=el(r.getElementsByTagName("layout")[0]);for(var l=[],d=0;d<c.length;d++){var f,h,p=c[d],m=u,g=n,v=new fn,y=p.getAttribute("xml:id");y?(v.id=y,y=null,g&&(y=Vc.exec(g)||Gc.exec(g)),g=y?Number(y[1]):null,y=y?Number(y[2]):null,!(f=rl(p,m,"extent"))||null!=(f=(h=Vc.exec(f))||Gc.exec(f))&&(v.width=null!=g?100*Number(f[1])/g:Number(f[1]),v.height=null!=y?100*Number(f[2])/y:Number(f[2]),v.widthUnits=h||null!=g?hn:0,v.heightUnits=h||null!=y?hn:0),!(p=rl(p,m,"origin"))||null!=(f=(h=Vc.exec(p))||Gc.exec(p))&&(v.viewportAnchorX=null!=y?100*Number(f[1])/y:Number(f[1]),v.viewportAnchorY=null!=g?100*Number(f[2])/g:Number(f[2]),v.viewportAnchorUnits=h||null!=g?hn:0)):(ne.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),v=null),v&&l.push(v)}for(n=function e(t){if(!t)return[];var n=[];t=Y(t.childNodes);for(var i=t.next();!i.done;i=t.next())i=i.value,i instanceof Element&&(i.hasAttribute("begin")?n.push(i):n=n.concat(e(i)));return n}(r.getElementsByTagName("body")[0]),r=(n=Y(n)).next();!r.done;r=n.next())(r=tl(r.value,t.periodStart,o,s,u,c,l,a,!1))&&i.push(r)}return i};var Fc,Hc,Vc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,qc=/^(\d+px|\d+em)$/,Gc=/^(\d+)px (\d+)px$/,Wc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,zc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Xc=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Yc=/^(\d*(?:\.\d*)?)f$/,$c=/^(\d*(?:\.\d*)?)t$/,Jc=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Qc={left:sn,center:"center",right:"end",start:sn,end:"end"},Zc={left:"line-left",center:"center",right:"line-right"};function el(e){var t=[];if(!e)return t;for(var n=Y(e.childNodes),i=n.next();!i.done;i=n.next())(i=i.value).nodeType==Node.ELEMENT_NODE&&"br"!==i.nodeName&&(i=el(i),t=t.concat(i));return t.length||t.push(e),t}function tl(e,t,n,i,r,a,o,s,u){if(u&&"br"==e.nodeName)return(e=new Jt(0,0,"")).spacer=!0,e;var c=/^[\s\n]*$/.test(e.textContent),l=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;c=sl(e.getAttribute("begin"),n),l=sl(e.getAttribute("end"),n);var d,f=sl(e.getAttribute("dur"),n);if(null==l&&null!=f&&(l=c+f),!u&&(null==c||null==l))throw new me(2,2,2001);if(c=u&&null==c?0:c+t,l=u&&null==l?0:l+t,f="",u=[],Array.from(e.childNodes).find(function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)}))f=function e(t,n){for(var i="",r=Y(t.childNodes),a=r.next();!a.done;a=r.next())"br"==(a=a.value).nodeName&&t.childNodes[0]!==a?i+="\n":a.childNodes&&0<a.childNodes.length?i+=e(a,n):i+=n?a=(a=a.textContent.trim()).replace(/\s+/g," "):a.textContent;return i}(e,s);else for(var h=Y(e.childNodes),p=h.next();!p.done;p=h.next())(p=tl(p.value,t,n,i,r,a,o,s,!0))&&(p.startTime=p.startTime||c,p.endTime=p.endTime||l,u.push(p));return(t=new Jt(c,l,f)).nestedCues=u,(a=ol(e,"region",a,"")[0])&&a.getAttribute("xml:id")&&(d=a.getAttribute("xml:id"),t.region=o.filter(function(e){return e.id==d})[0]),function(e,t,n,i,r){"rtl"==il(t,n,r,"direction")&&(e.direction="rtl");var a=il(t,n,r,"writingMode");"tb"==a||"tblr"==a?e.writingMode="vertical-lr":"tbrl"==a?e.writingMode="vertical-rl":"rltb"==a||"rl"==a?e.direction="rtl":a&&(e.direction=rn),(a=il(t,n,r,"textAlign"))?(e.positionAlign=Zc[a],e.lineAlign=Qc[a],e.textAlign=en[a.toUpperCase()]):e.textAlign="start",(a=il(t,n,r,"displayAlign"))&&(e.displayAlign=nn[a.toUpperCase()]);(a=il(t,n,r,"color"))&&(e.color=a);(a=il(t,n,r,"backgroundColor"))&&(e.backgroundColor=a);(a=il(t,n,r,"fontFamily"))&&(e.fontFamily=a);(a=il(t,n,r,"fontWeight"))&&"bold"==a&&(e.fontWeight=700),(a=il(t,n,r,"wrapOption"))&&"noWrap"==a&&(e.wrapLine=!1),(a=il(t,n,r,"lineHeight"))&&a.match(qc)&&(e.lineHeight=a),(a=il(t,n,r,"fontSize"))&&a.match(qc)&&(e.fontSize=a),(a=il(t,n,r,"fontStyle"))&&(e.fontStyle=dn[a.toUpperCase()]);{var o;i&&(a=i.getAttribute("imagetype"),o=i.getAttribute("encoding"),i=i.textContent.trim(),"PNG"==a&&"Base64"==o&&i&&(e.backgroundImage="data:image/png;base64,"+i))}(n=rl(n,r,"textDecoration"))&&nl(e,n),(t=al(t,r,"textDecoration"))&&nl(e,t)}(t,e,a,i=ol(e,"smpte:backgroundImage",i,"#")[0],r),t}function nl(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)switch(n[i]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&Ie(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&Ie(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&Ie(e.textDecoration,"overline")}}function il(e,t,n,i){return(e=al(e,n,i))?e:rl(t,n,i)}function rl(e,t,n){for(var i=el(e),r=0;r<i.length;r++){var a=Fi.getAttributeNS(i[r],"http://www.w3.org/ns/ttml#styling",n);if(a)return a}return(e=ol(e,"style",t,"")[0])?Fi.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n):null}function al(e,t,n){var i=Fi.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n);if(i)return i;for(e=ol(e,"style",t,""),t=null,i=0;i<e.length;i++){var r=Fi.getAttributeNS(e[i],"http://www.w3.org/ns/ttml#styling",n);r&&(t=r)}return t}function ol(e,t,n,i){var r=[];if(!e||n.length<1)return r;var a=e;for(e=null;a&&!(e=a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(e=(t=Y(t=t.split(" "))).next();!e.done;e=t.next()){e=e.value;for(var o=(a=Y(n)).next();!o.done;o=a.next())if(i+(o=o.value).getAttribute("xml:id")==e){r.push(o);break}}return r}function sl(e,t){var n,i,r,a,o=null;return Wc.test(e)?(o=Wc.exec(e),n=Number(o[1]),i=Number(o[2]),r=Number(o[3]),a=Number(o[4]),o=(r+=(a+=(Number(o[5])||0)/t.b)/t.frameRate)+60*i+3600*n):zc.test(e)?o=ul(zc,e):Xc.test(e)?o=ul(Xc,e):Yc.test(e)?(o=Yc.exec(e),o=Number(o[1])/t.frameRate):$c.test(e)?(o=$c.exec(e),o=Number(o[1])/t.a):Jc.test(e)&&(o=ul(Jc,e)),o}function ul(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function cl(e,t,n,i){this.frameRate=Number(e)||30,this.b=Number(t)||1,this.a=Number(i),0==this.a&&(this.a=e?this.frameRate*this.b:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function ll(){this.a=new Bc}function dl(){}function fl(e,t,n){var i,r,a,o;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))t=i[1],e.textAlign="middle"==t?Zt:en[t.toUpperCase()];else if(i=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl";else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(i=/^region:(.*)$/.exec(t))){e:{if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=un[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=on,e.line=Number(n[1]),n[2]&&(e.lineAlign=un[n[2].toUpperCase()])}e=!0}return e}r=n,a=i[1],(t=(o=r.filter(function(e){return e.id==a})).length?o[0]:(ne.m("VTT parser could not find a region with id: ",a," The region will be ignored."),null))&&(e.region=t)}return 1}function hl(e){if(null==(e=Or(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function pl(){this.a=null}function ml(e,t,n){var i,r,a;return(new Di).L("payl",Li(function(e){i=ot(e)})).L("iden",Li(function(e){r=ot(e)})).L("sttg",Li(function(e){a=ot(e)})).parse(e),i?function(e,t,n,i,r){if(e=new Jt(i,r,e),t&&(e.id=t),n)for(t=new _r(n),n=jr(t);n;)fl(e,n,[])||ne.m("VTT parser encountered an invalid VTT setting: ",n," The setting will be ignored."),Lr(t),n=jr(t);return e}(i,r,a,t,n):null}function gl(){}function vl(){Fc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Fc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=yl):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function yl(n,i){var r=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return console.assert(r==navigator,'bad "this" for requestMediaKeySystemAccess'),J(e,Fc.call(r,n,i),2);case 2:return Ml(t=e.s)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Fc,e.return(t)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=bl,e.return(bl.call(r,n,i)))}})})}function bl(d,f){var h=this;return $(function e(){var i,r,a,o,s,u,c,l;return te(e,function(e){switch(e.j){case 1:console.assert(h==navigator,'bad "this" for requestMediaKeySystemAccess'),i=Al(d),r=[];for(var t=Y(f),n=t.next();!n.done;n=t.next())a=n.value,o=wl(a.videoCapabilities,i),s=wl(a.audioCapabilities,i),a.videoCapabilities&&a.videoCapabilities.length&&!o.length||a.audioCapabilities&&a.audioCapabilities.length&&!s.length||((u=Object.assign({},a)).videoCapabilities=o,u.audioCapabilities=s,r.push(u));if(!r.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return J(e,Fc.call(h,d,r),2);case 2:return l=e.s,e.return(new kl(l,i))}})})}function wl(e,t){return e?e.filter(function(e){return!e.encryptionScheme||e.encryptionScheme==t}):e}function Tl(){}function Sl(){navigator.mediaCapabilities?(Hc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=El):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function El(n){var i=this;return $(function e(){var t;return te(e,function(e){switch(e.j){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),J(e,Hc.call(i,n),2);case 2:return(t=e.s,n.keySystemConfiguration)?Ml(t.keySystemAccess)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Hc,e.return(t)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=xl,e.return(xl.call(i,n))):e.return(t)}})})}function xl(u){var c=this;return $(function e(){var t,n,i,r,a,o,s;return te(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,u.keySystemConfiguration&&(n=u.keySystemConfiguration,i=n.keySystem,r=n.audio&&n.audio.encryptionScheme,a=n.video&&n.video.encryptionScheme,t=Al(i),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:u},r&&r!=t||a&&a!=t)?e.return(o):J(e,Hc.call(c,u),2);case 2:return(s=e.s).keySystemAccess&&(s.keySystemAccess=new kl(s.keySystemAccess,t)),e.return(s)}})})}function kl(e,t){this.b=e,this.a=t,this.keySystem=e.keySystem}function Al(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Ml(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function Il(){}function Pl(){vl(),Sl()}gn["application/ttml+xml"]=Bc,R("shaka.text.Mp4TtmlParser",ll),ll.prototype.parseInit=ll.prototype.parseInit=function(e){var t=!1;if((new Di).L("moov",Ui).L("trak",Ui).L("mdia",Ui).L("minf",Ui).L("stbl",Ui).ia("stsd",_i).L("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new me(2,2,2007)},ll.prototype.parseMedia=ll.prototype.parseMedia=function(e,t){var n=!1,i=[];if((new Di).L("mdat",Li(function(e){n=!0,i=i.concat(this.a.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new me(2,2,2007);return i},gn['application/mp4; codecs="stpp"']=ll,gn['application/mp4; codecs="stpp.ttml.im1t"']=ll,gn['application/mp4; codecs="stpp.TTML.im1t"']=ll,R("shaka.text.VttTextParser",dl),dl.prototype.parseInit=dl.prototype.parseInit=function(){},dl.prototype.parseMedia=dl.prototype.parseMedia=function(e,t){var n=ot(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new me(2,2,2e3);var i=t.segmentStart;if(null==i&&n[i=0].includes("X-TIMESTAMP-MAP")){var r=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),a=n[0].match(/MPEGTS:(\d+)/m);if(r&&a){if(null==(i=hl(new _r(r[1]))))throw new me(2,2,2e3);i=t.periodStart+(Number(a[1])/9e4-i)}}a=[];for(var o=n[0].split("\n"),r=1;r<o.length;r++)if(/^Region:/.test(o[r])){var s=new _r(o[r]),u=new fn;jr(s),Lr(s);for(var c,l=jr(s);l;){e:{var d=u,f=l;if(c=/^id=(.*)$/.exec(f))d.id=c[1];else if(c=/^width=(\d{1,2}|100)%$/.exec(f))d.width=Number(c[1]);else if(c=/^lines=(\d+)$/.exec(f))d.height=Number(c[1]),d.heightUnits=2;else if(c=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))d.regionAnchorX=Number(c[1]),d.regionAnchorY=Number(c[2]);else if(c=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(f))d.viewportAnchorX=Number(c[1]),d.viewportAnchorY=Number(c[2]);else{if(!/^scroll=up$/.exec(f)){c=!1;break e}d.scroll="up"}c=!0}c||ne.m("VTT parser encountered an invalid VTTRegion setting: ",l," The setting will be ignored."),Lr(s),l=jr(s)}a.push(u)}for(r=[],s=1;s<n.length;s++){if(c=o=n[s].split("\n"),d=i,o=a,1==c.length&&!c[0]||/^NOTE($|[ \t])/.test(c[0])||"STYLE"==c[0])o=null;else{u=null,c[0].includes("--\x3e")||(u=c[0],c.splice(0,1)),f=hl(l=new _r(c[0]));var h=Or(l,/[ \t]+--\x3e[ \t]+/g),p=hl(l);if(null==f||null==h||null==p)throw new me(2,2,2001);for(c=new Jt(f+d,p+d,c.slice(1).join("\n").trim()),Lr(l),d=jr(l);d;)fl(c,d,o)||ne.m("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Lr(l),d=jr(l);null!=u&&(c.id=u),o=c}o&&r.push(o)}return r},gn["text/vtt"]=dl,gn['text/vtt; codecs="vtt"']=dl,R("shaka.text.Mp4VttParser",pl),pl.prototype.parseInit=pl.prototype.parseInit=function(e){var t=!1;if((new Di).L("moov",Ui).L("trak",Ui).L("mdia",Ui).ia("mdhd",function(e){0==e.version?(e.reader.P(4),e.reader.P(4),this.a=e.reader.I(),e.reader.P(4)):(e.reader.P(8),e.reader.P(8),this.a=e.reader.I(),e.reader.P(8)),e.reader.P(4)}.bind(this)).L("minf",Ui).L("stbl",Ui).ia("stsd",_i).L("wvtt",function(){t=!0}).parse(e),!this.a)throw new me(2,2,2008);if(!t)throw new me(2,2,2008)},pl.prototype.parseMedia=pl.prototype.parseMedia=function(e,s){var u=this;if(!this.a)throw ne.error("No init segment for MP4+VTT!"),new me(2,2,2008);var t,c=0,l=[],d=[],n=!1,f=!1,i=!1,h=null;if((new Di).L("moof",Ui).L("traf",Ui).ia("tfdt",function(e){n=!0,c=0==e.version?e.reader.I():e.reader.Kb()}).ia("tfhd",function(e){var t=e.flags;(e=e.reader).P(4),1&t&&e.P(8),2&t&&e.P(4),h=8&t?e.I():null}).ia("trun",function(e){f=!0;var t=e.version,n=e.flags,i=(e=e.reader).I();1&n&&e.P(4),4&n&&e.P(4);for(var r=[],a=0;a<i;a++){var o={duration:null,sampleSize:null,Md:null};256&n&&(o.duration=e.I()),512&n&&(o.sampleSize=e.I()),1024&n&&e.P(4),2048&n&&(o.Md=0==t?e.I():e.xe()),r.push(o)}l=r}).L("mdat",Li(function(e){i=!0,t=e})).parse(e),!i&&!n&&!f)throw new me(2,2,2008);var p=c,m=new Ci(new DataView(t.buffer,t.byteOffset,t.byteLength),0);return l.forEach(function(e){var t=e.duration||h,n=e.Md?c+e.Md:p;p=n+(t||0);var i=0;do{var r=m.I();i+=r;var a=m.I(),o=null;"vttc"==(a=ji(a))?8<r&&(o=m.gb(r-8)):("vtte"!=a&&ne.error("Unknown box "+a+"! Skipping!"),m.P(r-8)),t?o&&d.push(ml(o,s.periodStart+n/u.a,s.periodStart+p/u.a)):ne.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&i<e.sampleSize)}),d.filter(Vt.Ma)},gn['application/mp4; codecs="wvtt"']=pl,R("shaka.util.Dom.createHTMLElement",function(e){return document.createElement(e)}),R("shaka.util.Dom.createVideoElement",function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e}),R("shaka.util.Dom.asHTMLElement",function(e){return e}),R("shaka.util.Dom.asHTMLMediaElement",function(e){return e}),R("shaka.util.Dom.removeAllChildren",function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}),R("EmeEncryptionSchemePolyfill",gl),gl.install=vl,R("McEncryptionSchemePolyfill",Tl),Tl.install=Sl,kl.prototype.getConfiguration=function(){var e=this.b.getConfiguration();if(e.videoCapabilities)for(var t=Y(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.a;if(e.audioCapabilities)for(n=(t=Y(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.a;return e},kl.prototype.createMediaKeys=function(){return this.b.createMediaKeys()},R("EncryptionSchemePolyfills",Il),Il.install=Pl,void 0!==t&&t.$e&&(t.$e=Il)}.call(t,e,e,void 0),"undefined"!=typeof exports)for(var n in t.shaka)exports[n]=t.shaka[n];else"undefined"!=typeof define&&define.amd?define(function(){return t.shaka}):e.shaka=t.shaka}();