!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).BoardgameIO={})}(this,(function(e){"use strict";function t(){}const n=e=>e;function r(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function a(){return Object.create(null)}function s(e){e.forEach(o)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(c(t,n))}function d(e,t,n,o){return e[1]&&o?r(n.ctx.slice(),e[1](o(t))):n.ctx}function p(e,t,n,r,o,a,s){const l=function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(t,r,o,a);if(l){const o=d(t,n,r,s);e.p(o,l)}}function f(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function y(e){return null==e?"":e}const m="undefined"!=typeof window;let v=m?()=>window.performance.now():()=>Date.now(),h=m?e=>requestAnimationFrame(e):t;const g=new Set;function b(e){g.forEach(t=>{t.c(e)||(g.delete(t),t.f())}),0!==g.size&&h(b)}function $(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode.removeChild(e)}function P(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function k(e){return document.createElement(e)}function E(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function O(e){return document.createTextNode(e)}function I(){return O(" ")}function A(){return O("")}function j(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function D(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function S(e,t){e.value=null==t?"":t}function C(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function z(e,t,n){e.classList[n?"add":"remove"](t)}function M(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const N=new Set;let q,G=0;function T(e,t,n,r,o,a,s,l=0){const i=16.666/r;let c="{\n";for(let e=0;e<=1;e+=i){const r=t+(n-t)*a(e);c+=100*e+`%{${s(r,1-r)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${l}`,p=e.ownerDocument;N.add(p);const f=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(k("style")).sheet),y=p.__svelte_rules||(p.__svelte_rules={});y[d]||(y[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${d} ${r}ms linear ${o}ms 1 both`,G+=1,d}function B(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),G-=o,G||h(()=>{G||(N.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),N.clear())}))}function L(e){q=e}function V(){if(!q)throw new Error("Function called outside component initialization");return q}function R(e){V().$$.on_destroy.push(e)}function U(){const e=V();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=M(t,n);r.slice().forEach(t=>{t.call(e,o)})}}}function K(e,t){V().$$.context.set(e,t)}function F(e){return V().$$.context.get(e)}function J(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const H=[],W=[],Y=[],X=[],Z=Promise.resolve();let Q=!1;function ee(e){Y.push(e)}let te=!1;const ne=new Set;function re(){if(!te){te=!0;do{for(let e=0;e<H.length;e+=1){const t=H[e];L(t),oe(t.$$)}for(H.length=0;W.length;)W.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];ne.has(t)||(ne.add(t),t())}Y.length=0}while(H.length);for(;X.length;)X.pop()();Q=!1,te=!1,ne.clear()}}function oe(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ee)}}let ae;function se(e,t,n){e.dispatchEvent(M(`${t?"intro":"outro"}${n}`))}const le=new Set;let ie;function ce(){ie={r:0,c:[],p:ie}}function ue(){ie.r||s(ie.c),ie=ie.p}function de(e,t){e&&e.i&&(le.delete(e),e.i(t))}function pe(e,t,n,r){if(e&&e.o){if(le.has(e))return;le.add(e),ie.c.push(()=>{le.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const fe={duration:0};function ye(e,r,o,a){let i=r(e,o),c=a?0:1,u=null,d=null,p=null;function f(){p&&B(e,p)}function y(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(r){const{delay:o=0,duration:a=300,easing:l=n,tick:m=t,css:$}=i||fe,x={start:v()+o,b:r};r||(x.group=ie,ie.r+=1),u?d=x:($&&(f(),p=T(e,c,r,a,o,l,$)),r&&m(0,1),u=y(x,a),ee(()=>se(e,r,"start")),function(e){let t;0===g.size&&h(b),new Promise(n=>{g.add(t={c:e,f:n})})}(t=>{if(d&&t>d.start&&(u=y(d,a),d=null,se(e,u.b,"start"),$&&(f(),p=T(e,c,u.b,u.duration,0,l,i.css))),u)if(t>=u.end)m(c=u.b,1-c),se(e,u.b,"end"),d||(u.b?f():--u.group.r||s(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;c=u.a+u.d*l(e/u.duration),m(c,1-c)}return!(!u&&!d)}))}return{run(e){l(i)?(ae||(ae=Promise.resolve(),ae.then(()=>{ae=null})),ae).then(()=>{i=i(),m(e)}):m(e)},end(){f(),u=d=null}}}function me(e){e&&e.c()}function ve(e,t,n){const{fragment:r,on_mount:a,on_destroy:i,after_update:c}=e.$$;r&&r.m(t,n),ee(()=>{const t=a.map(o).filter(l);i?i.push(...t):s(t),e.$$.on_mount=[]}),c.forEach(ee)}function he(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ge(e,t){-1===e.$$.dirty[0]&&(H.push(e),Q||(Q=!0,Z.then(re)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function be(e,n,r,o,l,i,c=[-1]){const u=q;L(e);const d=n.props||{},p=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:l,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:a(),dirty:c};let f=!1;if(p.ctx=r?r(e,d,(t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=o)&&(p.bound[t]&&p.bound[t](o),f&&ge(e,t)),n}):[],p.update(),f=!0,s(p.before_update),p.fragment=!!o&&o(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(w)}else p.fragment&&p.fragment.c();n.intro&&de(e.$$.fragment),ve(e,n.target,n.anchor),re()}L(u)}class $e{$destroy(){he(this,1),this.$destroy=t}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}var xe=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),we=function(){return Math.random().toString(36).substring(7).split("").join(".")},Pe={INIT:"@@redux/INIT"+we(),REPLACE:"@@redux/REPLACE"+we(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+we()}};function ke(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Ee(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(Ee)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,a=t,s=[],l=s,i=!1;function c(){l===s&&(l=s.slice())}function u(){if(i)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(i)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return c(),l.push(e),function(){if(t){if(i)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,c();var n=l.indexOf(e);l.splice(n,1)}}}function p(e){if(!ke(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(i)throw new Error("Reducers may not dispatch actions.");try{i=!0,a=o(a,e)}finally{i=!1}for(var t=s=l,n=0;n<t.length;n++){(0,t[n])()}return e}function f(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,p({type:Pe.REPLACE})}function y(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[xe]=function(){return this},e}return p({type:Pe.INIT}),(r={dispatch:p,subscribe:d,getState:u,replaceReducer:f})[xe]=y,r}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(n,!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function De(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return Ae({},n,{dispatch:r=je.apply(void 0,a)(n.dispatch)})}}}const _e=(e,t,n,r)=>({type:"MAKE_MOVE",payload:{type:e,args:t,playerID:n,credentials:r}}),Se=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r}}),Ce=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r},automatic:!0}),ze=e=>({type:"SYNC",state:e.state,log:e.log,initialState:e.initialState,clientOnly:!0}),Me=e=>({type:"RESET",state:e,clientOnly:!0}),Ne=(e,t)=>({type:"UNDO",payload:{type:null,args:null,playerID:e,credentials:t}}),qe=(e,t)=>({type:"REDO",payload:{type:null,args:null,playerID:e,credentials:t}});var Ge,Te,Be,Le=Object.freeze({makeMove:_e,gameEvent:Se,automaticGameEvent:Ce,sync:ze,update:(e,t)=>({type:"UPDATE",state:e,deltalog:t,clientOnly:!0}),reset:Me,undo:Ne,redo:qe,plugin:(e,t,n,r)=>({type:"PLUGIN",payload:{type:e,args:t,playerID:n,credentials:r}})}),Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ue="undefined"!=typeof Symbol?Symbol("immer-nothing"):(Be=!0,(Te="immer-nothing")in(Ge={})?Object.defineProperty(Ge,Te,{value:Be,enumerable:!0,configurable:!0,writable:!0}):Ge[Te]=Be,Ge),Ke="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",Fe="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function Je(e){return!!e&&!!e[Fe]}function He(e){if(!e||"object"!==(void 0===e?"undefined":Ve(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[Ke]||!!e.constructor[Ke])}var We=Object.assign||function(e,t){for(var n in t)et(t,n)&&(e[n]=t[n]);return e},Ye="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function Xe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e))return e.slice();var n=Object.create(Object.getPrototypeOf(e));return Ye(e).forEach((function(r){if(r!==Fe){var o=Object.getOwnPropertyDescriptor(e,r);if(o.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(e)}o.enumerable?n[r]=o.value:Object.defineProperty(n,r,{value:o.value,writable:!0,configurable:!0})}})),n}function Ze(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(n,e[n],e);else Ye(e).forEach((function(n){return t(n,e[n],e)}))}function Qe(e,t){return Object.getOwnPropertyDescriptor(e,t).enumerable}function et(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function tt(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var nt={},rt=[],ot=function(){return rt[rt.length-1]};function at(e,t){var n=Array.isArray(e),r=ut(e);Ze(r,(function(t){!function(e,t,n){var r=nt[t];r?r.enumerable=n:nt[t]=r={configurable:!0,enumerable:n,get:function(){return function(e,t){dt(e);var n=lt(e)[t];if(!e.finalizing&&n===e.base[t]&&He(n))return ct(e),e.copy[t]=at(n,e);return n}(this[Fe],t)},set:function(e){!function(e,t,n){if(dt(e),e.assigned[t]=!0,!e.modified){if(tt(lt(e)[t],n))return;it(e),ct(e)}e.copy[t]=n}(this[Fe],t,e)}};Object.defineProperty(e,t,r)}(r,t,n||Qe(e,t))}));var o={scope:t?t.scope:ot(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:r,copy:null,revoke:st,revoked:!1};return function(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0})}(r,Fe,o),o.scope.push(o),r}function st(){this.revoked=!0}function lt(e){return e.copy||e.base}function it(e){e.modified||(e.modified=!0,e.parent&&it(e.parent))}function ct(e){e.copy||(e.copy=ut(e.base))}function ut(e){var t=e&&e[Fe];if(t){t.finalizing=!0;var n=Xe(t.draft,!0);return t.finalizing=!1,n}return Xe(e)}function dt(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(lt(e)))}function pt(e){for(var t=e.base,n=e.draft,r=Object.keys(n),o=r.length-1;o>=0;o--)if(void 0===t[r[o]]&&!et(t,r[o]))return!0;return r.length!==Object.keys(t).length}function ft(e){var t=e.draft;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var yt=Object.freeze({scopes:rt,currentScope:ot,willFinalize:function(e,t,n){var r=ot();r.forEach((function(e){return e.finalizing=!0})),void 0!==e&&e!==t||(n&&function e(t){if(!t||"object"!==(void 0===t?"undefined":Ve(t)))return;var n=t[Fe];if(!n)return;var r=n.base,o=n.draft,a=n.assigned;if(Array.isArray(t)){if(ft(n)){if(it(n),a.length=!0,o.length<r.length)for(var s=o.length;s<r.length;s++)a[s]=!1;else for(var l=r.length;l<o.length;l++)a[l]=!0;for(var i=0;i<o.length;i++)void 0===a[i]&&e(o[i])}}else Object.keys(o).forEach((function(t){void 0!==r[t]||et(r,t)?a[t]||e(o[t]):(a[t]=!0,it(n))})),Object.keys(r).forEach((function(e){void 0!==o[e]||et(o,e)||(a[e]=!1,it(n))}))}(t),function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];!1===n.modified&&(Array.isArray(n.base)?ft(n)&&it(n):pt(n)&&it(n))}}(r))},createDraft:at}),mt=[],vt=function(){return mt[mt.length-1]};function ht(e,t){var n={scope:t?t.scope:vt(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},r=Array.isArray(e)?Proxy.revocable([n],bt):Proxy.revocable(n,gt),o=r.revoke,a=r.proxy;return n.draft=a,n.revoke=o,n.scope.push(n),a}var gt={get:function(e,t){if(t===Fe)return e;var n=e.drafts;if(!e.modified&&et(n,t))return n[t];var r=$t(e)[t];if(e.finalized||!He(r))return r;if(e.modified){if(r!==e.base[t])return r;n=e.copy}return n[t]=ht(r,e)},has:function(e,t){return t in $t(e)},ownKeys:function(e){return Reflect.ownKeys($t(e))},set:function(e,t,n){if(!e.modified){if(n?tt(e.base[t],n)||n===e.drafts[t]:tt(e.base[t],n)&&t in e.base)return!0;xt(e)}return e.assigned[t]=!0,e.copy[t]=n,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,xt(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var n=$t(e),r=Reflect.getOwnPropertyDescriptor(n,t);r&&(r.writable=!0,r.configurable=!Array.isArray(n)||"length"!==t);return r},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},bt={};function $t(e){return e.copy||e.base}function xt(e){e.modified||(e.modified=!0,e.copy=We(Xe(e.base),e.drafts),e.drafts=null,e.parent&&xt(e.parent))}Ze(gt,(function(e,t){bt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),bt.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return gt.deleteProperty.call(this,e[0],t)},bt.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return gt.set.call(this,e[0],t,n)};var wt=Object.freeze({scopes:mt,currentScope:vt,willFinalize:function(){},createDraft:ht});function Pt(e,t,n,r){Array.isArray(e.base)?function(e,t,n,r){for(var o=e.base,a=e.copy,s=e.assigned,l=Math.min(o.length,a.length),i=0;i<l;i++)if(s[i]&&o[i]!==a[i]){var c=t.concat(i);n.push({op:"replace",path:c,value:a[i]}),r.push({op:"replace",path:c,value:o[i]})}if(l<a.length){for(var u=l;u<a.length;u++)n.push({op:"add",path:t.concat(u),value:a[u]});r.push({op:"replace",path:t.concat("length"),value:o.length})}else if(l<o.length){n.push({op:"replace",path:t.concat("length"),value:a.length});for(var d=l;d<o.length;d++)r.push({op:"add",path:t.concat(d),value:o[d]})}}(e,t,n,r):function(e,t,n,r){var o=e.base,a=e.copy;Ze(e.assigned,(function(e,s){var l=o[e],i=a[e],c=s?e in o?"replace":"add":"remove";if(l!==i||"replace"!==c){var u=t.concat(e);n.push("remove"===c?{op:c,path:u}:{op:c,path:u,value:i}),r.push("add"===c?{op:"remove",path:u}:"remove"===c?{op:"add",path:u,value:l}:{op:"replace",path:u,value:l})}}))}(e,t,n,r)}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n],o=r.path;if(0===o.length&&"replace"===r.op)e=r.value;else{for(var a=e,s=0;s<o.length-1;s++)if(!(a=a[o[s]])||"object"!==(void 0===a?"undefined":Ve(a)))throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var l=o[o.length-1];switch(r.op){case"replace":case"add":a[l]=r.value;break;case"remove":if(Array.isArray(a)){if(l!==a.length-1)throw new Error("Only the last index of an array can be removed, index: "+l+", length: "+a.length);a.length-=1}else delete a[l];break;default:throw new Error("Unsupported patch operation: "+r.op)}}}return e}var Et={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:"undefined"==typeof process&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},Ot=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),We(this,Et,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return Re(e,[{key:"produce",value:function(e,t,n){var r=this;if("function"==typeof e&&"function"!=typeof t){var o=t;return t=e,function(){for(var e=arguments.length,n=Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return r.produce(s,(function(e){var r;return(r=t).call.apply(r,[e,e].concat(n))}))}}if("function"!=typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("the third argument of a producer should not be set or a function");var a=void 0;if(He(e)){this.scopes.push([]);var s=this.createDraft(e);try{a=t.call(s,s),this.willFinalize(a,s,!!n);var l=n&&[],i=n&&[];if(void 0===a||a===s)a=this.finalize(s,[],l,i);else{if(s[Fe].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");He(a)&&(a=this.finalize(a)),n&&(l.push({op:"replace",path:[],value:a}),i.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach((function(e){return e.revoke()})),this.scopes.pop()}n&&n(l,i)}else if(void 0===(a=t(e)))return e;return a===Ue?void 0:a}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,We(this,e?wt:yt)}},{key:"applyPatches",value:function(e,t){return Je(e)?kt(e,t):this.produce(e,(function(e){return kt(e,t)}))}},{key:"finalize",value:function(e,t,n,r){var o=this,a=e[Fe];if(!a)return Object.isFrozen(e)?e:this.finalizeTree(e);if(a.scope!==this.currentScope())return e;if(!a.modified)return a.base;if(!a.finalized){if(a.finalized=!0,this.finalizeTree(a.draft,t,n,r),this.onDelete)if(this.useProxies){var s=a.assigned;for(var l in s)s[l]||this.onDelete(a,l)}else{var i=a.base,c=a.copy;Ze(i,(function(e){et(c,e)||o.onDelete(a,e)}))}this.onCopy&&this.onCopy(a),this.autoFreeze&&1===this.scopes.length&&Object.freeze(a.copy),n&&Pt(a,t,n,r)}return a.copy}},{key:"finalizeTree",value:function(e,t,n,r){var o=this,a=e[Fe];a&&(this.useProxies||(a.finalizing=!0,a.copy=Xe(a.draft,!0),a.finalizing=!1),e=a.copy);var s=this.onAssign;return Ze(e,(function l(i,c,u){if(c===u)throw Error("Immer forbids circular references");var d=!!a&&u===e;if(Je(c)){if(c=n&&d&&!a.assigned[i]?o.finalize(c,t.concat(i),n,r):o.finalize(c),Array.isArray(u)||Qe(u,i)?u[i]=c:Object.defineProperty(u,i,{value:c}),d&&c===a.base[i])return}else{if(d&&tt(c,a.base[i]))return;He(c)&&!Object.isFrozen(c)&&Ze(c,l)}d&&s&&s(a,i,c)})),e}}]),e}()),It=Ot.produce;Ot.setAutoFreeze.bind(Ot),Ot.setUseProxies.bind(Ot),Ot.applyPatches.bind(Ot);const At={name:"plugin-immer",fnWrap:e=>(t,n,...r)=>{let o=!1;const a=It(t,t=>{const a=e(t,n,...r);if("INVALID_MOVE"!==a)return a;o=!0});return o?"INVALID_MOVE":a}};function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){_t(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e){return function(e){if(Array.isArray(e))return Mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function qt(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function Gt(e,t){var n=new Nt(e),r=t&&t.state,o=n.next;return o.quick=o,r&&("object"==jt(r)&&qt(r,n),o.state=function(){return qt(n,{})}),o}var Tt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=t,this.used=!1}var t,n,r;return t=e,(n=[{key:"isUsed",value:function(){return this.used}},{key:"getState",value:function(){return this.state}},{key:"_random",value:function(){this.used=!0;var e,t=this.state,n=(e=void 0===t.prngstate?new Gt(t.seed,{state:!0}):new Gt("",{state:t.prngstate}))();return this.state=Ct(Ct({},t),{},{prngstate:e.state()}),n}},{key:"api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={},r=function(r){var o=t[r];n[r]=function(t){return void 0===t?Math.floor(e()*o)+1:zt(new Array(t).keys()).map((function(){return Math.floor(e()*o)+1}))}};for(var o in t)r(o);return Ct(Ct({},n),{},{Die:function(t,n){return void 0===t&&(t=6),void 0===n?Math.floor(e()*t)+1:zt(new Array(n).keys()).map((function(){return Math.floor(e()*t)+1}))},Number:function(){return e()},Shuffle:function(t){for(var n=t.slice(0),r=t.length,o=0,a=new Array(r);r;){var s=r*e()|0;a[o++]=n[s],n[s]=n[--r]}return a},_obj:this})}}])&&Dt(t.prototype,n),r&&Dt(t,r),e}();Tt.seed=function(){return(+new Date).toString(36).slice(-10)};class Bt{constructor(e,t){this.flow=e,this.playerID=t,this.dispatch=[]}api(e){const t={_obj:this},{phase:n,turn:r}=e;for(const e of this.flow.eventNames)t[e]=(...t)=>{this.dispatch.push({key:e,args:t,phase:n,turn:r})};return t}isUsed(){return this.dispatch.length>0}update(e){for(let t=0;t<this.dispatch.length;t++){const n=this.dispatch[t];if("endTurn"===n.key&&n.turn!==e.ctx.turn)continue;if(("endPhase"===n.key||"setPhase"===n.key)&&n.phase!==e.ctx.phase)continue;const r=Ce(n.key,n.args,this.playerID);e={...e,...this.flow.processEvent(e,r)}}return e}}const Lt=[At,{name:"random",noClient:({api:e})=>e._obj.isUsed(),flush:({api:e})=>e._obj.getState(),api:({data:e})=>new Tt(e).api(),setup:({game:e})=>{let t=e.seed;return void 0===t&&(t=Tt.seed()),{seed:t}}},{name:"events",noClient:({api:e})=>e._obj.isUsed(),dangerouslyFlushRawState:({state:e,api:t})=>t._obj.update(e),api:({game:e,playerID:t,ctx:n})=>new Bt(e.flow,t).api(n)}],Vt=e=>{let t={...e.ctx};const n=e.plugins||{};return Object.entries(n).forEach(([e,{api:n}])=>{t[e]=n}),t},Rt=(e,t)=>[...Lt,...t].filter(e=>void 0!==e.fnWrap).reduce((e,{fnWrap:t})=>t(e),e),Ut=(e,t)=>([...Lt,...t.game.plugins].filter(e=>void 0!==e.api).forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}},a=n.api({G:e.G,ctx:e.ctx,data:o.data,game:t.game,playerID:t.playerID});e={...e,plugins:{...e.plugins,[r]:{...o,api:a}}}}),e),Kt=(e,t)=>([...Lt,...t.game.plugins].reverse().forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}};if(n.flush){const r=n.flush({G:e.G,ctx:e.ctx,game:t.game,api:o.api,data:o.data});e={...e,plugins:{...e.plugins,[n.name]:{data:r}}}}else if(n.dangerouslyFlushRawState){const a=(e=n.dangerouslyFlushRawState({state:e,game:t.game,api:o.api,data:o.data})).plugins[r].data;e={...e,plugins:{...e.plugins,[n.name]:{data:a}}}}}),e),Ft=console.log,Jt=console.error;function Ht(e){Jt("ERROR:",e)}function Wt(e,t,n){return{...e,ctx:Yt(e.ctx,n)}}function Yt(e,t){let{_prevActivePlayers:n}=e,r={},o=null,a={};if(Array.isArray(t)){let e={};t.forEach(t=>e[t]=en.NULL),r=e}else{if(t.next&&(o=t.next),n=t.revert?n.concat({activePlayers:e.activePlayers,_activePlayersMoveLimit:e._activePlayersMoveLimit,_activePlayersNumMoves:e._activePlayersNumMoves}):[],void 0!==t.currentPlayer&&Xt(r,a,e.currentPlayer,t.currentPlayer),void 0!==t.others)for(let n=0;n<e.playOrder.length;n++){const o=e.playOrder[n];o!==e.currentPlayer&&Xt(r,a,o,t.others)}if(void 0!==t.all)for(let n=0;n<e.playOrder.length;n++){Xt(r,a,e.playOrder[n],t.all)}if(t.value)for(const e in t.value)Xt(r,a,e,t.value[e]);if(t.moveLimit)for(const e in r)void 0===a[e]&&(a[e]=t.moveLimit)}0==Object.keys(r).length&&(r=null),0==Object.keys(a).length&&(a=null);let s={};for(const e in r)s[e]=0;return{...e,activePlayers:r,_activePlayersMoveLimit:a,_activePlayersNumMoves:s,_prevActivePlayers:n,_nextActivePlayers:o}}function Xt(e,t,n,r){"object"==typeof r&&r!==en.NULL||(r={stage:r}),void 0!==r.stage&&(e[n]=r.stage,r.moveLimit&&(t[n]=r.moveLimit))}function Zt(e,t){return e[t]+""}const Qt={first:(e,t)=>0===t.turn?t.playOrderPos:(t.playOrderPos+1)%t.playOrder.length,next:(e,t)=>(t.playOrderPos+1)%t.playOrder.length},en={NULL:null};function tn({moves:e,phases:t,endIf:n,onEnd:r,turn:o,events:a,plugins:s,disableUndo:l}){void 0===e&&(e={}),void 0===a&&(a={}),void 0===s&&(s=[]),void 0===t&&(t={}),n||(n=()=>{}),r||(r=e=>e),o||(o={});const i={...t};""in i&&Ht("cannot specify phase with empty name"),i[""]={};let c={},u=new Set,d=null;Object.keys(e).forEach(e=>u.add(e));const p=e=>{const t=Rt(e,s);return e=>{const n=Vt(e);return t(e.G,n)}},f=e=>t=>{let n=Vt(t);return e(t.G,n)},y={onEnd:p(r),endIf:f(n)};for(let e in i){const t=i[e];if(!0===t.start&&(d=e),void 0!==t.moves)for(let n of Object.keys(t.moves))c[e+"."+n]=t.moves[n],u.add(n);void 0===t.endIf&&(t.endIf=()=>{}),void 0===t.onBegin&&(t.onBegin=e=>e),void 0===t.onEnd&&(t.onEnd=e=>e),void 0===t.turn&&(t.turn=o),void 0===t.turn.order&&(t.turn.order=Qt),void 0===t.turn.onBegin&&(t.turn.onBegin=e=>e),void 0===t.turn.onEnd&&(t.turn.onEnd=e=>e),void 0===t.turn.endIf&&(t.turn.endIf=()=>!1),void 0===t.turn.onMove&&(t.turn.onMove=e=>e),void 0===t.turn.stages&&(t.turn.stages={});for(const n in t.turn.stages){const r=t.turn.stages[n].moves||{};for(let t of Object.keys(r)){c[e+"."+n+"."+t]=r[t],u.add(t)}}t.wrapped={onBegin:p(t.onBegin),onEnd:p(t.onEnd),endIf:f(t.endIf)},t.turn.wrapped={onMove:p(t.turn.onMove),onBegin:p(t.turn.onBegin),onEnd:p(t.turn.onEnd),endIf:f(t.turn.endIf)}}function m(e){return e.phase?i[e.phase]:i[""]}function v(e){return e}function h(e,t){const n=new Set,r=new Set;for(let o=0;o<t.length;o++){const{fn:a,arg:s,...l}=t[o];if(a===A){r.clear();const t=e.ctx.phase;if(n.has(t)){const t={...e.ctx,phase:null};return{...e,ctx:t}}n.add(t)}let i=[];if(e=a(e,{...l,arg:s,next:i}),a===I)break;const c=k(e);if(c){t.push({fn:I,arg:c,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}const u=E(e);if(u)t.push({fn:A,arg:u,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});else{if(a===v){const n=O(e);if(n){t.push({fn:j,arg:n,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}}t.push(...i)}}return e}function g(e,{next:t}){return t.push({fn:b}),e}function b(e,{next:t}){let{G:n,ctx:r}=e;return n=m(r).wrapped.onBegin(e),t.push({fn:$}),{...e,G:n,ctx:r}}function $(e,{currentPlayer:t}){let{G:n,ctx:r}=e;const o=m(r);t?(r={...r,currentPlayer:t},o.turn.activePlayers&&(r=Yt(r,o.turn.activePlayers))):r=function(e,t){let{G:n,ctx:r}=e;const o=Vt(e),a=t.order;let s=[...new Array(r.numPlayers)].map((e,t)=>t+"");void 0!==a.playOrder&&(s=a.playOrder(n,o));const l=a.first(n,o),i=typeof l;"number"!==i&&Ht(`invalid value returned by turn.order.first — expected number got ${i} “${l}”.`);const c=Zt(s,l);return r={...r,currentPlayer:c,playOrderPos:l,playOrder:s},r=Yt(r,t.activePlayers||{}),r}(e,o.turn);const a=r.turn+1;r={...r,turn:a,numMoves:0,_prevActivePlayers:[]},n=o.turn.wrapped.onBegin({...e,G:n,ctx:r});const s=l?[]:[{G:n,ctx:r}];return{...e,G:n,ctx:r,_undo:s,_redo:[]}}function x(e,{arg:t,next:n,phase:r}){const o=m({phase:r});let{ctx:a}=e;if(t&&t.next){if(!(t.next in i))return Ht("invalid phase: "+t.next),e;a={...a,phase:t.next}}else a=void 0!==o.next?{...a,phase:o.next}:{...a,phase:null};return e={...e,ctx:a},n.push({fn:b}),e}function w(e,{arg:t,currentPlayer:n,next:r}){let{G:o,ctx:a}=e;const s=m(a),{endPhase:l,ctx:i}=function(e,t,n,r){const o=n.order;let{G:a,ctx:s}=e,l=s.playOrderPos,i=!1;if(r&&!0!==r)"object"!=typeof r&&Ht(`invalid argument to endTurn: ${r}`),Object.keys(r).forEach(e=>{switch(e){case"remove":t=Zt(s.playOrder,l);break;case"next":l=s.playOrder.indexOf(r.next),t=r.next;break;default:Ht(`invalid argument to endTurn: ${e}`)}});else{const n=Vt(e),r=o.next(a,n),c=typeof r;void 0!==r&&"number"!==c&&Ht(`invalid value returned by turn.order.next — expected number or undefined got ${c} “${r}”.`),void 0===r?i=!0:(l=r,t=Zt(s.playOrder,l))}return s={...s,playOrderPos:l,currentPlayer:t},{endPhase:i,ctx:s}}(e,n,s.turn,t);return a=i,e={...e,G:o,ctx:a},l?r.push({fn:A,turn:a.turn,phase:a.phase}):r.push({fn:$,currentPlayer:a.currentPlayer}),e}function P(e,{arg:t,playerID:n}){"string"==typeof t&&(t={stage:t});let{ctx:r}=e,{activePlayers:o,_activePlayersMoveLimit:a,_activePlayersNumMoves:s}=r;return t.stage&&(null===o&&(o={}),o[n]=t.stage,s[n]=0,t.moveLimit&&(null===a&&(a={}),a[n]=t.moveLimit)),r={...r,activePlayers:o,_activePlayersMoveLimit:a,_activePlayersNumMoves:s},{...e,ctx:r}}function k(e){return y.endIf(e)}function E(e){return m(e.ctx).wrapped.endIf(e)}function O(e){const t=m(e.ctx),n=e.ctx.numMoves||0;return!!(t.turn.moveLimit&&n>=t.turn.moveLimit)||t.turn.wrapped.endIf(e)}function I(e,{arg:t,phase:n}){e=A(e,{phase:n}),void 0===t&&(t=!0),e={...e,ctx:{...e.ctx,gameover:t}};const r=y.onEnd(e);return{...e,G:r}}function A(e,{arg:t,next:n,turn:r,automatic:o}){let a=(e=j(e,{turn:r,force:!0})).G,s=e.ctx;if(n&&n.push({fn:x,arg:t,phase:s.phase}),null===s.phase)return e;a=m(s).wrapped.onEnd(e),s={...s,phase:null};const l={action:Se("endPhase",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};o&&(l.automatic=!0);const i=[...e.deltalog,l];return{...e,G:a,ctx:s,deltalog:i}}function j(e,{arg:t,next:n,turn:r,force:o,automatic:a,playerID:s}){if(r!==e.ctx.turn)return e;let{G:l,ctx:i}=e;const c=m(i),u=i.numMoves||0;if(!o&&c.turn.moveLimit&&u<c.turn.moveLimit)return d=`cannot end turn before making ${c.turn.moveLimit} moves`,Ft(`INFO: ${d}`),e;var d;if(l=c.turn.wrapped.onEnd(e),n&&n.push({fn:w,arg:t,currentPlayer:i.currentPlayer}),i={...i,activePlayers:null},t&&t.remove){s=s||i.currentPlayer;const t=i.playOrder.filter(e=>e!=s),r=i.playOrderPos>t.length-1?0:i.playOrderPos;if(i={...i,playOrder:t,playOrderPos:r},0===t.length)return n.push({fn:A,turn:i.turn,phase:i.phase}),e}const p={action:Se("endTurn",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};a&&(p.automatic=!0);const f=[...e.deltalog||[],p];return{...e,G:l,ctx:i,deltalog:f,_undo:[],_redo:[]}}function D(e,{arg:t,next:n,automatic:r,playerID:o}){o=o||e.ctx.currentPlayer;let{ctx:a}=e,{activePlayers:s,_activePlayersMoveLimit:l}=a;const i=null!==s&&o in s;if(!t&&i){const e=m(a).turn.stages[s[o]];e&&e.next&&(t=e.next)}if(n&&t&&n.push({fn:P,arg:t,playerID:o}),!i)return e;s=Object.keys(s).filter(e=>e!==o).reduce((e,t)=>(e[t]=s[t],e),{}),l&&(l=Object.keys(l).filter(e=>e!==o).reduce((e,t)=>(e[t]=l[t],e),{})),a=function(e){let{activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}=e;if(t&&0==Object.keys(t).length)if(e._nextActivePlayers)e=Yt(e,e._nextActivePlayers),({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}=e);else if(o.length>0){const e=o.length-1;({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r}=o[e]),o=o.slice(0,e)}else t=null,n=null;return{...e,activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:o}}({...a,activePlayers:s,_activePlayersMoveLimit:l});const c={action:Se("endStage",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};r&&(c.automatic=!0);const u=[...e.deltalog||[],c];return{...e,ctx:a,deltalog:u}}function _(t,n,r){const o=m(t),a=o.turn.stages,{activePlayers:s}=t;if(s&&void 0!==s[r]&&s[r]!==en.NULL&&void 0!==a[s[r]]&&void 0!==a[s[r]].moves){const e=a[s[r]].moves;if(n in e)return e[n]}else if(o.moves){if(n in o.moves)return o.moves[n]}else if(n in e)return e[n];return null}const S={endStage:function(e,t){return h(e,[{fn:D,playerID:t}])},setStage:function(e,t,n){return h(e,[{fn:D,arg:n,playerID:t}])},endTurn:function(e,t,n){return h(e,[{fn:j,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},pass:function(e,t,n){return h(e,[{fn:j,turn:e.ctx.turn,phase:e.ctx.phase,force:!0,arg:n}])},endPhase:function(e){return h(e,[{fn:A,phase:e.ctx.phase,turn:e.ctx.turn}])},setPhase:function(e,t,n){return h(e,[{fn:A,phase:e.ctx.phase,turn:e.ctx.turn,arg:{next:n}}])},endGame:function(e,t,n){return h(e,[{fn:I,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},setActivePlayers:Wt};let C=[];return!1!==a.endTurn&&C.push("endTurn"),!1!==a.pass&&C.push("pass"),!1!==a.endPhase&&C.push("endPhase"),!1!==a.setPhase&&C.push("setPhase"),!1!==a.endGame&&C.push("endGame"),!1!==a.setActivePlayers&&C.push("setActivePlayers"),!1!==a.endStage&&C.push("endStage"),!1!==a.setStage&&C.push("setStage"),{ctx:e=>({numPlayers:e,turn:0,currentPlayer:"0",playOrder:[...new Array(e)].map((e,t)=>t+""),playOrderPos:0,phase:d,activePlayers:null}),init:e=>h(e,[{fn:g}]),isPlayerActive:function(e,t,n){return t.activePlayers?n in t.activePlayers:t.currentPlayer===n},eventHandlers:S,eventNames:Object.keys(S),enabledEventNames:C,moveMap:c,moveNames:[...u.values()],processMove:function(e,t){let n=m(e.ctx);const r=_(e.ctx,t.type,t.playerID),o=!r||"function"==typeof r||!0!==r.noLimit;let{ctx:a}=e,{_activePlayersNumMoves:s}=a;const{playerID:l}=t;let i=e.ctx.numMoves;o&&(l==e.ctx.currentPlayer&&i++,a.activePlayers&&s[l]++),e={...e,ctx:{...a,numMoves:i,_activePlayersNumMoves:s}},a._activePlayersMoveLimit&&s[l]>=a._activePlayersMoveLimit[l]&&(e=D(e,{playerID:l,automatic:!0}));const c=n.turn.wrapped.onMove(e);return h(e={...e,G:c},[{fn:v}])},processEvent:function(e,t){const{type:n,playerID:r,args:o}=t.payload;if(S.hasOwnProperty(n)){const t=[e,r].concat(o);return S[n].apply({},t)}return e},getMove:_}}function nn(e){if(function(e){return void 0!==e.processMove}(e))return e;if(void 0===e.name&&(e.name="default"),void 0===e.disableUndo&&(e.disableUndo=!1),void 0===e.setup&&(e.setup=()=>({})),void 0===e.moves&&(e.moves={}),void 0===e.playerView&&(e.playerView=e=>e),void 0===e.plugins&&(e.plugins=[]),e.plugins.forEach(e=>{if(void 0===e.name)throw new Error("Plugin missing name attribute");if(e.name.includes(" "))throw new Error(e.name+": Plugin name must not include spaces")}),e.name.includes(" "))throw new Error(e.name+": Game name must not include spaces");const t=tn(e);return{...e,flow:t,moveNames:t.moveNames,pluginNames:e.plugins.map(e=>e.name),processMove:(n,r)=>{let o=t.getMove(n.ctx,r.type,r.playerID);var a;if((a=o)instanceof Object&&void 0!==a.move&&(o=o.move),o instanceof Function){const t=Rt(o,e.plugins),a={...Vt(n),playerID:r.playerID};let s=[];return void 0!==r.args&&(s=s.concat(r.args)),t(n.G,a,...s)}return Ht(`invalid move object: ${r.type}`),n.G}}}const rn=[];function on(e,n=t){let r;const o=[];function a(t){if(i(e,t)&&(e=t,r)){const t=!rn.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),rn.push(n,e)}if(t){for(let e=0;e<rn.length;e+=2)rn[e][0](rn[e+1]);rn.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(s,l=t){const i=[s,l];return o.push(i),1===o.length&&(r=n(a)||t),s(e),()=>{const e=o.indexOf(i);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}function an(e){const t=e-1;return t*t*t+1}function sn(e,{delay:t=0,duration:n=400,easing:r=an,x:o=0,y:a=0,opacity:s=0}){const l=getComputedStyle(e),i=+l.opacity,c="none"===l.transform?"":l.transform,u=i*(1-s);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*o}px, ${(1-e)*a}px);\n\t\t\topacity: ${i-u*t}`}}function ln(e,t,n){const r=e.slice();return r[4]=t[n][0],r[5]=t[n][1].label,r}function cn(e){let t,n,r,o,a,s=e[5]+"";function l(...t){return e[3](e[4],...t)}return{c(){t=k("div"),n=O(s),r=I(),D(t,"class","menu-item svelte-19bfq8g"),z(t,"active",e[0]==e[4])},m(e,s){x(e,t,s),$(t,n),$(t,r),o||(a=j(t,"click",l),o=!0)},p(r,o){e=r,2&o&&s!==(s=e[5]+"")&&_(n,s),3&o&&z(t,"active",e[0]==e[4])},d(e){e&&w(t),o=!1,a()}}}function un(e){let n,r=Object.entries(e[1]).reverse(),o=[];for(let t=0;t<r.length;t+=1)o[t]=cn(ln(e,r,t));return{c(){n=k("div");for(let e=0;e<o.length;e+=1)o[e].c();D(n,"class","menu svelte-19bfq8g")},m(e,t){x(e,n,t);for(let e=0;e<o.length;e+=1)o[e].m(n,null)},p(e,[t]){if(7&t){let a;for(r=Object.entries(e[1]).reverse(),a=0;a<r.length;a+=1){const s=ln(e,r,a);o[a]?o[a].p(s,t):(o[a]=cn(s),o[a].c(),o[a].m(n,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}},i:t,o:t,d(e){e&&w(n),P(o,e)}}}function dn(e,t,n){let{pane:r}=t,{panes:o}=t;const a=U();return e.$set=e=>{"pane"in e&&n(0,r=e.pane),"panes"in e&&n(1,o=e.panes)},[r,o,a,e=>a("change",e)]}class pn extends $e{constructor(e){var t;super(),document.getElementById("svelte-19bfq8g-style")||((t=k("style")).id="svelte-19bfq8g-style",t.textContent=".menu.svelte-19bfq8g{display:flex;margin-top:-10px;flex-direction:row;border:1px solid #ccc;border-radius:5px 5px 0 0;height:25px;line-height:25px;margin-right:-500px;transform-origin:bottom right;transform:rotate(-90deg) translate(0, -500px)}.menu-item.svelte-19bfq8g{line-height:25px;cursor:pointer;background:#fefefe;color:#555;padding-left:15px;padding-right:15px;text-align:center}.menu-item.svelte-19bfq8g:last-child{border-radius:0 5px 0 0}.menu-item.svelte-19bfq8g:first-child{border-radius:5px 0 0 0}.menu-item.active.svelte-19bfq8g{cursor:default;font-weight:bold;background:#ddd;color:#555}.menu-item.svelte-19bfq8g:hover{background:#ddd;color:#555}",$(document.head,t)),be(this,e,dn,un,i,{pane:0,panes:1})}}var fn={};function yn(e){let n,r,o,a;return{c(){n=k("div"),r=k("div"),r.textContent="▶",D(r,"class","arrow svelte-1vyml86"),z(r,"expanded",e[0]),D(n,"class","container svelte-1vyml86")},m(t,s){x(t,n,s),$(n,r),o||(a=j(n,"click",e[1]),o=!0)},p(e,[t]){1&t&&z(r,"expanded",e[0])},i:t,o:t,d(e){e&&w(n),o=!1,a()}}}function mn(e,t,n){let{expanded:r}=t;return e.$set=e=>{"expanded"in e&&n(0,r=e.expanded)},[r,function(t){J(e,t)}]}class vn extends $e{constructor(e){var t;super(),document.getElementById("svelte-1vyml86-style")||((t=k("style")).id="svelte-1vyml86-style",t.textContent=".container.svelte-1vyml86{display:inline-block;cursor:pointer;transform:translate(calc(0px - var(--li-identation)), -50%);position:absolute;top:50%;padding-right:100%}.arrow.svelte-1vyml86{transform-origin:25% 50%;position:relative;line-height:1.1em;font-size:0.75em;margin-left:0;transition:150ms;color:var(--arrow-sign);user-select:none;font-family:'Courier New', Courier, monospace}.expanded.svelte-1vyml86{transform:rotateZ(90deg) translateX(-3px)}",$(document.head,t)),be(this,e,mn,yn,i,{expanded:0})}}function hn(e){let t,n,r,o,a,s;return{c(){t=k("label"),n=k("span"),r=O(e[0]),o=O(e[2]),D(t,"class","svelte-1vlbacg"),z(t,"spaced",e[1])},m(l,i){x(l,t,i),$(t,n),$(n,r),$(n,o),a||(s=j(t,"click",e[5]),a=!0)},p(e,n){1&n&&_(r,e[0]),4&n&&_(o,e[2]),2&n&&z(t,"spaced",e[1])},d(e){e&&w(t),a=!1,s()}}}function gn(e){let n,r=e[3]&&e[0]&&hn(e);return{c(){r&&r.c(),n=A()},m(e,t){r&&r.m(e,t),x(e,n,t)},p(e,[t]){e[3]&&e[0]?r?r.p(e,t):(r=hn(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(e){r&&r.d(e),e&&w(n)}}}function bn(e,t,n){let r,{key:o}=t,{isParentExpanded:a}=t,{isParentArray:s=!1}=t,{colon:l=":"}=t;return e.$set=e=>{"key"in e&&n(0,o=e.key),"isParentExpanded"in e&&n(1,a=e.isParentExpanded),"isParentArray"in e&&n(4,s=e.isParentArray),"colon"in e&&n(2,l=e.colon)},e.$$.update=()=>{19&e.$$.dirty&&n(3,r=a||!s||o!=+o)},[o,a,l,r,s,function(t){J(e,t)}]}class $n extends $e{constructor(e){var t;super(),document.getElementById("svelte-1vlbacg-style")||((t=k("style")).id="svelte-1vlbacg-style",t.textContent="label.svelte-1vlbacg{display:inline-block;color:var(--label-color);padding:0}.spaced.svelte-1vlbacg{padding-right:var(--li-colon-space)}",$(document.head,t)),be(this,e,bn,gn,i,{key:0,isParentExpanded:1,isParentArray:4,colon:2})}}function xn(e,t,n){const r=e.slice();return r[12]=t[n],r[20]=n,r}function wn(e){let t,n;return t=new vn({props:{expanded:e[0]}}),t.$on("click",e[15]),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.expanded=e[0]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Pn(e){let n;return{c(){n=k("span"),n.textContent="…"},m(e,t){x(e,n,t)},p:t,i:t,o:t,d(e){e&&w(n)}}}function kn(e){let t,n,r,o,a,s=e[13],l=[];for(let t=0;t<s.length;t+=1)l[t]=On(xn(e,s,t));const i=e=>pe(l[e],1,1,()=>{l[e]=null});let c=e[13].length<e[7].length&&In();return{c(){t=k("ul");for(let e=0;e<l.length;e+=1)l[e].c();n=I(),c&&c.c(),D(t,"class","svelte-rwxv37"),z(t,"collapse",!e[0])},m(s,i){x(s,t,i);for(let e=0;e<l.length;e+=1)l[e].m(t,null);$(t,n),c&&c.m(t,null),r=!0,o||(a=j(t,"click",e[16]),o=!0)},p(e,r){if(10129&r){let o;for(s=e[13],o=0;o<s.length;o+=1){const a=xn(e,s,o);l[o]?(l[o].p(a,r),de(l[o],1)):(l[o]=On(a),l[o].c(),de(l[o],1),l[o].m(t,n))}for(ce(),o=s.length;o<l.length;o+=1)i(o);ue()}e[13].length<e[7].length?c||(c=In(),c.c(),c.m(t,null)):c&&(c.d(1),c=null),1&r&&z(t,"collapse",!e[0])},i(e){if(!r){for(let e=0;e<s.length;e+=1)de(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)pe(l[e]);r=!1},d(e){e&&w(t),P(l,e),c&&c.d(),o=!1,a()}}}function En(e){let t;return{c(){t=k("span"),t.textContent=",",D(t,"class","comma svelte-rwxv37")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function On(e){let t,n,r,o;t=new ur({props:{key:e[8](e[12]),isParentExpanded:e[0],isParentArray:e[4],value:e[0]?e[9](e[12]):e[10](e[12])}});let a=!e[0]&&e[20]<e[7].length-1&&En();return{c(){me(t.$$.fragment),n=I(),a&&a.c(),r=A()},m(e,s){ve(t,e,s),x(e,n,s),a&&a.m(e,s),x(e,r,s),o=!0},p(e,n){const o={};8448&n&&(o.key=e[8](e[12])),1&n&&(o.isParentExpanded=e[0]),16&n&&(o.isParentArray=e[4]),9729&n&&(o.value=e[0]?e[9](e[12]):e[10](e[12])),t.$set(o),!e[0]&&e[20]<e[7].length-1?a||(a=En(),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null)},i(e){o||(de(t.$$.fragment,e),o=!0)},o(e){pe(t.$$.fragment,e),o=!1},d(e){he(t,e),e&&w(n),a&&a.d(e),e&&w(r)}}}function In(e){let t;return{c(){t=k("span"),t.textContent="…"},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function An(e){let t,n,r,o,a,s,l,i,c,u,d,p,f,y,m,v,h,g,b=e[11]&&e[2]&&wn(e);o=new $n({props:{key:e[12],colon:e[14].colon,isParentExpanded:e[2],isParentArray:e[3]}}),o.$on("click",e[15]);const P=[kn,Pn],E=[];function A(e,t){return e[2]?0:1}return d=A(e),p=E[d]=P[d](e),{c(){t=k("li"),n=k("label"),b&&b.c(),r=I(),me(o.$$.fragment),a=I(),s=k("span"),l=k("span"),i=O(e[1]),c=O(e[5]),u=I(),p.c(),f=I(),y=k("span"),m=O(e[6]),D(n,"class","svelte-rwxv37"),D(t,"class","svelte-rwxv37"),z(t,"indent",e[2])},m(p,w){x(p,t,w),$(t,n),b&&b.m(n,null),$(n,r),ve(o,n,null),$(n,a),$(n,s),$(s,l),$(l,i),$(s,c),$(t,u),E[d].m(t,null),$(t,f),$(t,y),$(y,m),v=!0,h||(g=j(s,"click",e[15]),h=!0)},p(e,[a]){e[11]&&e[2]?b?(b.p(e,a),2052&a&&de(b,1)):(b=wn(e),b.c(),de(b,1),b.m(n,r)):b&&(ce(),pe(b,1,1,()=>{b=null}),ue());const s={};4096&a&&(s.key=e[12]),4&a&&(s.isParentExpanded=e[2]),8&a&&(s.isParentArray=e[3]),o.$set(s),(!v||2&a)&&_(i,e[1]),(!v||32&a)&&_(c,e[5]);let l=d;d=A(e),d===l?E[d].p(e,a):(ce(),pe(E[l],1,1,()=>{E[l]=null}),ue(),p=E[d],p||(p=E[d]=P[d](e),p.c()),de(p,1),p.m(t,f)),(!v||64&a)&&_(m,e[6]),4&a&&z(t,"indent",e[2])},i(e){v||(de(b),de(o.$$.fragment,e),de(p),v=!0)},o(e){pe(b),pe(o.$$.fragment,e),pe(p),v=!1},d(e){e&&w(t),b&&b.d(),he(o),E[d].d(),h=!1,g()}}}function jn(e,t,n){let{key:r}=t,{keys:o}=t,{colon:a=":"}=t,{label:s=""}=t,{isParentExpanded:l}=t,{isParentArray:i}=t,{isArray:c=!1}=t,{bracketOpen:u}=t,{bracketClose:d}=t,{previewKeys:p=o}=t,{getKey:f=(e=>e)}=t,{getValue:y=(e=>e)}=t,{getPreviewValue:m=y}=t,{expanded:v=!1}=t,{expandable:h=!0}=t;const g=F(fn);let b;return K(fn,{...g,colon:a}),e.$set=e=>{"key"in e&&n(12,r=e.key),"keys"in e&&n(17,o=e.keys),"colon"in e&&n(18,a=e.colon),"label"in e&&n(1,s=e.label),"isParentExpanded"in e&&n(2,l=e.isParentExpanded),"isParentArray"in e&&n(3,i=e.isParentArray),"isArray"in e&&n(4,c=e.isArray),"bracketOpen"in e&&n(5,u=e.bracketOpen),"bracketClose"in e&&n(6,d=e.bracketClose),"previewKeys"in e&&n(7,p=e.previewKeys),"getKey"in e&&n(8,f=e.getKey),"getValue"in e&&n(9,y=e.getValue),"getPreviewValue"in e&&n(10,m=e.getPreviewValue),"expanded"in e&&n(0,v=e.expanded),"expandable"in e&&n(11,h=e.expandable)},e.$$.update=()=>{4&e.$$.dirty&&(l||n(0,v=!1)),131201&e.$$.dirty&&n(13,b=v?o:p.slice(0,5))},[v,s,l,i,c,u,d,p,f,y,m,h,r,b,g,function(){n(0,v=!v)},function(){n(0,v=!0)},o,a]}class Dn extends $e{constructor(e){var t;super(),document.getElementById("svelte-rwxv37-style")||((t=k("style")).id="svelte-rwxv37-style",t.textContent="label.svelte-rwxv37{display:inline-block}.indent.svelte-rwxv37{padding-left:var(--li-identation)}.collapse.svelte-rwxv37{--li-display:inline;display:inline;font-style:italic}.comma.svelte-rwxv37{margin-left:-0.5em;margin-right:0.5em}label.svelte-rwxv37{position:relative}",$(document.head,t)),be(this,e,jn,An,i,{key:12,keys:17,colon:18,label:1,isParentExpanded:2,isParentArray:3,isArray:4,bracketOpen:5,bracketClose:6,previewKeys:7,getKey:8,getValue:9,getPreviewValue:10,expanded:0,expandable:11})}}function _n(e){let t,n;return t=new Dn({props:{key:e[0],expanded:e[4],isParentExpanded:e[1],isParentArray:e[2],keys:e[5],previewKeys:e[5],getValue:e[6],label:e[3]+" ",bracketOpen:"{",bracketClose:"}"}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),16&n&&(r.expanded=e[4]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),32&n&&(r.keys=e[5]),32&n&&(r.previewKeys=e[5]),8&n&&(r.label=e[3]+" "),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Sn(e,t,n){let r,{key:o}=t,{value:a}=t,{isParentExpanded:s}=t,{isParentArray:l}=t,{nodeType:i}=t,{expanded:c=!0}=t;return e.$set=e=>{"key"in e&&n(0,o=e.key),"value"in e&&n(7,a=e.value),"isParentExpanded"in e&&n(1,s=e.isParentExpanded),"isParentArray"in e&&n(2,l=e.isParentArray),"nodeType"in e&&n(3,i=e.nodeType),"expanded"in e&&n(4,c=e.expanded)},e.$$.update=()=>{128&e.$$.dirty&&n(5,r=Object.getOwnPropertyNames(a))},[o,s,l,i,c,r,function(e){return a[e]},a]}class Cn extends $e{constructor(e){super(),be(this,e,Sn,_n,i,{key:0,value:7,isParentExpanded:1,isParentArray:2,nodeType:3,expanded:4})}}function zn(e){let t,n;return t=new Dn({props:{key:e[0],expanded:e[4],isParentExpanded:e[2],isParentArray:e[3],isArray:!0,keys:e[5],previewKeys:e[6],getValue:e[7],label:"Array("+e[1].length+")",bracketOpen:"[",bracketClose:"]"}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),16&n&&(r.expanded=e[4]),4&n&&(r.isParentExpanded=e[2]),8&n&&(r.isParentArray=e[3]),32&n&&(r.keys=e[5]),64&n&&(r.previewKeys=e[6]),2&n&&(r.label="Array("+e[1].length+")"),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Mn(e,t,n){let{key:r}=t,{value:o}=t,{isParentExpanded:a}=t,{isParentArray:s}=t,{expanded:l=JSON.stringify(o).length<1024}=t;const i=new Set(["length"]);let c,u;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,o=e.value),"isParentExpanded"in e&&n(2,a=e.isParentExpanded),"isParentArray"in e&&n(3,s=e.isParentArray),"expanded"in e&&n(4,l=e.expanded)},e.$$.update=()=>{2&e.$$.dirty&&n(5,c=Object.getOwnPropertyNames(o)),32&e.$$.dirty&&n(6,u=c.filter(e=>!i.has(e)))},[r,o,a,s,l,c,u,function(e){return o[e]}]}class Nn extends $e{constructor(e){super(),be(this,e,Mn,zn,i,{key:0,value:1,isParentExpanded:2,isParentArray:3,expanded:4})}}function qn(e){let t,n;return t=new Dn({props:{key:e[0],isParentExpanded:e[1],isParentArray:e[2],keys:e[4],getKey:Gn,getValue:Tn,isArray:!0,label:e[3]+"("+e[4].length+")",bracketOpen:"{",bracketClose:"}"}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),16&n&&(r.keys=e[4]),24&n&&(r.label=e[3]+"("+e[4].length+")"),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Gn(e){return String(e[0])}function Tn(e){return e[1]}function Bn(e,t,n){let{key:r}=t,{value:o}=t,{isParentExpanded:a}=t,{isParentArray:s}=t,{nodeType:l}=t,i=[];return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(5,o=e.value),"isParentExpanded"in e&&n(1,a=e.isParentExpanded),"isParentArray"in e&&n(2,s=e.isParentArray),"nodeType"in e&&n(3,l=e.nodeType)},e.$$.update=()=>{if(32&e.$$.dirty){let e=[],t=0;for(const n of o)e.push([t++,n]);n(4,i=e)}},[r,a,s,l,i,o]}class Ln extends $e{constructor(e){super(),be(this,e,Bn,qn,i,{key:0,value:5,isParentExpanded:1,isParentArray:2,nodeType:3})}}class Vn{constructor(e,t){this.key=e,this.value=t}}function Rn(e){let t,n;return t=new Dn({props:{key:e[0],isParentExpanded:e[1],isParentArray:e[2],keys:e[4],getKey:Un,getValue:Kn,label:e[3]+"("+e[4].length+")",colon:"",bracketOpen:"{",bracketClose:"}"}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),16&n&&(r.keys=e[4]),24&n&&(r.label=e[3]+"("+e[4].length+")"),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Un(e){return e[0]}function Kn(e){return e[1]}function Fn(e,t,n){let{key:r}=t,{value:o}=t,{isParentExpanded:a}=t,{isParentArray:s}=t,{nodeType:l}=t,i=[];return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(5,o=e.value),"isParentExpanded"in e&&n(1,a=e.isParentExpanded),"isParentArray"in e&&n(2,s=e.isParentArray),"nodeType"in e&&n(3,l=e.nodeType)},e.$$.update=()=>{if(32&e.$$.dirty){let e=[],t=0;for(const n of o)e.push([t++,new Vn(n[0],n[1])]);n(4,i=e)}},[r,a,s,l,i,o]}class Jn extends $e{constructor(e){super(),be(this,e,Fn,Rn,i,{key:0,value:5,isParentExpanded:1,isParentArray:2,nodeType:3})}}function Hn(e){let t,n;return t=new Dn({props:{expanded:e[4],isParentExpanded:e[2],isParentArray:e[3],key:e[2]?String(e[0]):e[1].key,keys:e[5],getValue:e[6],label:e[2]?"Entry ":"=> ",bracketOpen:"{",bracketClose:"}"}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r={};16&n&&(r.expanded=e[4]),4&n&&(r.isParentExpanded=e[2]),8&n&&(r.isParentArray=e[3]),7&n&&(r.key=e[2]?String(e[0]):e[1].key),4&n&&(r.label=e[2]?"Entry ":"=> "),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Wn(e,t,n){let{key:r}=t,{value:o}=t,{isParentExpanded:a}=t,{isParentArray:s}=t,{expanded:l=!1}=t;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,o=e.value),"isParentExpanded"in e&&n(2,a=e.isParentExpanded),"isParentArray"in e&&n(3,s=e.isParentArray),"expanded"in e&&n(4,l=e.expanded)},[r,o,a,s,l,["key","value"],function(e){return o[e]}]}class Yn extends $e{constructor(e){super(),be(this,e,Wn,Hn,i,{key:0,value:1,isParentExpanded:2,isParentArray:3,expanded:4})}}function Xn(e){let t,n,r,o,a,s,l,i=(e[2]?e[2](e[1]):e[1])+"";return n=new $n({props:{key:e[0],colon:e[6],isParentExpanded:e[3],isParentArray:e[4]}}),{c(){t=k("li"),me(n.$$.fragment),r=I(),o=k("span"),a=O(i),D(o,"class",s=y(e[5])+" svelte-3bjyvl"),D(t,"class","svelte-3bjyvl"),z(t,"indent",e[3])},m(e,s){x(e,t,s),ve(n,t,null),$(t,r),$(t,o),$(o,a),l=!0},p(e,[r]){const c={};1&r&&(c.key=e[0]),8&r&&(c.isParentExpanded=e[3]),16&r&&(c.isParentArray=e[4]),n.$set(c),(!l||6&r)&&i!==(i=(e[2]?e[2](e[1]):e[1])+"")&&_(a,i),(!l||32&r&&s!==(s=y(e[5])+" svelte-3bjyvl"))&&D(o,"class",s),8&r&&z(t,"indent",e[3])},i(e){l||(de(n.$$.fragment,e),l=!0)},o(e){pe(n.$$.fragment,e),l=!1},d(e){e&&w(t),he(n)}}}function Zn(e,t,n){let{key:r}=t,{value:o}=t,{valueGetter:a=null}=t,{isParentExpanded:s}=t,{isParentArray:l}=t,{nodeType:i}=t;const{colon:c}=F(fn);return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,o=e.value),"valueGetter"in e&&n(2,a=e.valueGetter),"isParentExpanded"in e&&n(3,s=e.isParentExpanded),"isParentArray"in e&&n(4,l=e.isParentArray),"nodeType"in e&&n(5,i=e.nodeType)},[r,o,a,s,l,i,c]}class Qn extends $e{constructor(e){var t;super(),document.getElementById("svelte-3bjyvl-style")||((t=k("style")).id="svelte-3bjyvl-style",t.textContent="li.svelte-3bjyvl{user-select:text;word-wrap:break-word;word-break:break-all}.indent.svelte-3bjyvl{padding-left:var(--li-identation)}.String.svelte-3bjyvl{color:var(--string-color)}.Date.svelte-3bjyvl{color:var(--date-color)}.Number.svelte-3bjyvl{color:var(--number-color)}.Boolean.svelte-3bjyvl{color:var(--boolean-color)}.Null.svelte-3bjyvl{color:var(--null-color)}.Undefined.svelte-3bjyvl{color:var(--undefined-color)}.Function.svelte-3bjyvl{color:var(--function-color);font-style:italic}.Symbol.svelte-3bjyvl{color:var(--symbol-color)}",$(document.head,t)),be(this,e,Zn,Xn,i,{key:0,value:1,valueGetter:2,isParentExpanded:3,isParentArray:4,nodeType:5})}}function er(e,t,n){const r=e.slice();return r[8]=t[n],r[10]=n,r}function tr(e){let t,n;return t=new vn({props:{expanded:e[0]}}),t.$on("click",e[7]),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.expanded=e[0]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function nr(e){let t,n,r=e[0]&&rr(e);return{c(){t=k("ul"),r&&r.c(),D(t,"class","svelte-1ca3gb2"),z(t,"collapse",!e[0])},m(e,o){x(e,t,o),r&&r.m(t,null),n=!0},p(e,n){e[0]?r?(r.p(e,n),1&n&&de(r,1)):(r=rr(e),r.c(),de(r,1),r.m(t,null)):r&&(ce(),pe(r,1,1,()=>{r=null}),ue()),1&n&&z(t,"collapse",!e[0])},i(e){n||(de(r),n=!0)},o(e){pe(r),n=!1},d(e){e&&w(t),r&&r.d()}}}function rr(e){let t,n,r,o,a,s,l;t=new ur({props:{key:"message",value:e[2].message}}),o=new $n({props:{key:"stack",colon:":",isParentExpanded:e[3]}});let i=e[5],c=[];for(let t=0;t<i.length;t+=1)c[t]=or(er(e,i,t));return{c(){me(t.$$.fragment),n=I(),r=k("li"),me(o.$$.fragment),a=I(),s=k("span");for(let e=0;e<c.length;e+=1)c[e].c();D(r,"class","svelte-1ca3gb2")},m(e,i){ve(t,e,i),x(e,n,i),x(e,r,i),ve(o,r,null),$(r,a),$(r,s);for(let e=0;e<c.length;e+=1)c[e].m(s,null);l=!0},p(e,n){const r={};4&n&&(r.value=e[2].message),t.$set(r);const a={};if(8&n&&(a.isParentExpanded=e[3]),o.$set(a),32&n){let t;for(i=e[5],t=0;t<i.length;t+=1){const r=er(e,i,t);c[t]?c[t].p(r,n):(c[t]=or(r),c[t].c(),c[t].m(s,null))}for(;t<c.length;t+=1)c[t].d(1);c.length=i.length}},i(e){l||(de(t.$$.fragment,e),de(o.$$.fragment,e),l=!0)},o(e){pe(t.$$.fragment,e),pe(o.$$.fragment,e),l=!1},d(e){he(t,e),e&&w(n),e&&w(r),he(o),P(c,e)}}}function or(e){let t,n,r,o=e[8]+"";return{c(){t=k("span"),n=O(o),r=k("br"),D(t,"class","svelte-1ca3gb2"),z(t,"indent",e[10]>0)},m(e,o){x(e,t,o),$(t,n),x(e,r,o)},p(e,t){32&t&&o!==(o=e[8]+"")&&_(n,o)},d(e){e&&w(t),e&&w(r)}}}function ar(e){let t,n,r,o,a,s,l,i,c,u,d,p=(e[0]?"":e[2].message)+"",f=e[3]&&tr(e);r=new $n({props:{key:e[1],colon:e[6].colon,isParentExpanded:e[3],isParentArray:e[4]}});let y=e[3]&&nr(e);return{c(){t=k("li"),f&&f.c(),n=I(),me(r.$$.fragment),o=I(),a=k("span"),s=O("Error: "),l=O(p),i=I(),y&&y.c(),D(t,"class","svelte-1ca3gb2"),z(t,"indent",e[3])},m(p,m){x(p,t,m),f&&f.m(t,null),$(t,n),ve(r,t,null),$(t,o),$(t,a),$(a,s),$(a,l),$(t,i),y&&y.m(t,null),c=!0,u||(d=j(a,"click",e[7]),u=!0)},p(e,[o]){e[3]?f?(f.p(e,o),8&o&&de(f,1)):(f=tr(e),f.c(),de(f,1),f.m(t,n)):f&&(ce(),pe(f,1,1,()=>{f=null}),ue());const a={};2&o&&(a.key=e[1]),8&o&&(a.isParentExpanded=e[3]),16&o&&(a.isParentArray=e[4]),r.$set(a),(!c||5&o)&&p!==(p=(e[0]?"":e[2].message)+"")&&_(l,p),e[3]?y?(y.p(e,o),8&o&&de(y,1)):(y=nr(e),y.c(),de(y,1),y.m(t,null)):y&&(ce(),pe(y,1,1,()=>{y=null}),ue()),8&o&&z(t,"indent",e[3])},i(e){c||(de(f),de(r.$$.fragment,e),de(y),c=!0)},o(e){pe(f),pe(r.$$.fragment,e),pe(y),c=!1},d(e){e&&w(t),f&&f.d(),he(r),y&&y.d(),u=!1,d()}}}function sr(e,t,n){let{key:r}=t,{value:o}=t,{isParentExpanded:a}=t,{isParentArray:s}=t,{expanded:l=!1}=t;const i=F(fn);let c;return K(fn,{...i,colon:":"}),e.$set=e=>{"key"in e&&n(1,r=e.key),"value"in e&&n(2,o=e.value),"isParentExpanded"in e&&n(3,a=e.isParentExpanded),"isParentArray"in e&&n(4,s=e.isParentArray),"expanded"in e&&n(0,l=e.expanded)},e.$$.update=()=>{4&e.$$.dirty&&n(5,c=o.stack.split("\n")),8&e.$$.dirty&&(a||n(0,l=!1))},[l,r,o,a,s,c,i,function(){n(0,l=!l)}]}class lr extends $e{constructor(e){var t;super(),document.getElementById("svelte-1ca3gb2-style")||((t=k("style")).id="svelte-1ca3gb2-style",t.textContent="li.svelte-1ca3gb2{user-select:text;word-wrap:break-word;word-break:break-all}.indent.svelte-1ca3gb2{padding-left:var(--li-identation)}.collapse.svelte-1ca3gb2{--li-display:inline;display:inline;font-style:italic}",$(document.head,t)),be(this,e,sr,ar,i,{key:1,value:2,isParentExpanded:3,isParentArray:4,expanded:0})}}function ir(e){let t,n,r;var o=e[5];function a(e){return{props:{key:e[0],value:e[1],isParentExpanded:e[2],isParentArray:e[3],nodeType:e[4],valueGetter:e[6]}}}return o&&(t=new o(a(e))),{c(){t&&me(t.$$.fragment),n=A()},m(e,o){t&&ve(t,e,o),x(e,n,o),r=!0},p(e,[r]){const s={};if(1&r&&(s.key=e[0]),2&r&&(s.value=e[1]),4&r&&(s.isParentExpanded=e[2]),8&r&&(s.isParentArray=e[3]),16&r&&(s.nodeType=e[4]),64&r&&(s.valueGetter=e[6]),o!==(o=e[5])){if(t){ce();const e=t;pe(e.$$.fragment,1,0,()=>{he(e,1)}),ue()}o?(t=new o(a(e)),me(t.$$.fragment),de(t.$$.fragment,1),ve(t,n.parentNode,n)):t=null}else o&&t.$set(s)},i(e){r||(t&&de(t.$$.fragment,e),r=!0)},o(e){t&&pe(t.$$.fragment,e),r=!1},d(e){e&&w(n),t&&he(t,e)}}}function cr(e,t,n){let r,o,a,{key:s}=t,{value:l}=t,{isParentExpanded:i}=t,{isParentArray:c}=t;return e.$set=e=>{"key"in e&&n(0,s=e.key),"value"in e&&n(1,l=e.value),"isParentExpanded"in e&&n(2,i=e.isParentExpanded),"isParentArray"in e&&n(3,c=e.isParentArray)},e.$$.update=()=>{2&e.$$.dirty&&n(4,r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t?"function"==typeof e[Symbol.iterator]?"Iterable":e.constructor.name:t}(l)),16&e.$$.dirty&&n(5,o=function(e){switch(e){case"Object":return Cn;case"Error":return lr;case"Array":return Nn;case"Iterable":case"Map":case"Set":return"function"==typeof l.set?Jn:Ln;case"MapEntry":return Yn;default:return Qn}}(r)),16&e.$$.dirty&&n(6,a=function(e){switch(e){case"Object":case"Error":case"Array":case"Iterable":case"Map":case"Set":case"MapEntry":case"Number":return;case"String":return e=>`"${e}"`;case"Boolean":return e=>e?"true":"false";case"Date":return e=>e.toISOString();case"Null":return()=>"null";case"Undefined":return()=>"undefined";case"Function":case"Symbol":return e=>e.toString();default:return()=>`<${e}>`}}(r))},[s,l,i,c,r,o,a]}class ur extends $e{constructor(e){super(),be(this,e,cr,ir,i,{key:0,value:1,isParentExpanded:2,isParentArray:3})}}function dr(e){let t,n,r;return n=new ur({props:{key:e[0],value:e[1],isParentExpanded:!0,isParentArray:!1}}),{c(){t=k("ul"),me(n.$$.fragment),D(t,"class","svelte-773n60")},m(e,o){x(e,t,o),ve(n,t,null),r=!0},p(e,[t]){const r={};1&t&&(r.key=e[0]),2&t&&(r.value=e[1]),n.$set(r)},i(e){r||(de(n.$$.fragment,e),r=!0)},o(e){pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),he(n)}}}function pr(e,t,n){K(fn,{});let{key:r=""}=t,{value:o}=t;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,o=e.value)},[r,o]}class fr extends $e{constructor(e){var t;super(),document.getElementById("svelte-773n60-style")||((t=k("style")).id="svelte-773n60-style",t.textContent="ul.svelte-773n60{--string-color:var(--json-tree-string-color, #cb3f41);--symbol-color:var(--json-tree-symbol-color, #cb3f41);--boolean-color:var(--json-tree-boolean-color, #112aa7);--function-color:var(--json-tree-function-color, #112aa7);--number-color:var(--json-tree-number-color, #3029cf);--label-color:var(--json-tree-label-color, #871d8f);--arrow-color:var(--json-tree-arrow-color, #727272);--null-color:var(--json-tree-null-color, #8d8d8d);--undefined-color:var(--json-tree-undefined-color, #8d8d8d);--date-color:var(--json-tree-date-color, #8d8d8d);--li-identation:var(--json-tree-li-indentation, 1em);--li-line-height:var(--json-tree-li-line-height, 1.3);--li-colon-space:0.3em;font-size:var(--json-tree-font-size, 12px);font-family:var(--json-tree-font-family, 'Courier New', Courier, monospace)}ul.svelte-773n60 li{line-height:var(--li-line-height);display:var(--li-display, list-item);list-style:none}ul.svelte-773n60,ul.svelte-773n60 ul{padding:0;margin:0}",$(document.head,t)),be(this,e,pr,dr,i,{key:0,value:1})}}function yr(e){let t,n;return{c(){t=k("div"),n=O(e[1]),D(t,"class","label svelte-1olzq4i")},m(e,r){x(e,t,r),$(t,n)},p(e,t){2&t&&_(n,e[1])},d(e){e&&w(t)}}}function mr(e){let n,r,o,a,l,i,c=e[1]&&yr(e);return{c(){n=k("div"),r=k("div"),o=O(e[0]),a=I(),c&&c.c(),D(r,"class","key-box svelte-1olzq4i"),D(n,"class","key svelte-1olzq4i"),z(n,"active",e[2])},m(t,s){x(t,n,s),$(n,r),$(r,o),$(n,a),c&&c.m(n,null),l||(i=[j(window,"keydown",e[5]),j(r,"click",e[4])],l=!0)},p(e,[t]){1&t&&_(o,e[0]),e[1]?c?c.p(e,t):(c=yr(e),c.c(),c.m(n,null)):c&&(c.d(1),c=null),4&t&&z(n,"active",e[2])},i:t,o:t,d(e){e&&w(n),c&&c.d(),l=!1,s(i)}}}function vr(e,t,n){let r,{value:o}=t,{onPress:a=null}=t,{label:s=null}=t,{disable:l=!1}=t;const{disableHotkeys:i}=F("hotkeys");u(e,i,e=>n(8,r=e));let c=!1;function d(){n(2,c=!1)}function p(){n(2,c=!0),setTimeout(d,200),a&&setTimeout(a,1)}return e.$set=e=>{"value"in e&&n(0,o=e.value),"onPress"in e&&n(6,a=e.onPress),"label"in e&&n(1,s=e.label),"disable"in e&&n(7,l=e.disable)},[o,s,c,i,p,function(e){r||l||e.ctrlKey||e.metaKey||e.key!=o||(e.preventDefault(),p())},a,l]}class hr extends $e{constructor(e){var t;super(),document.getElementById("svelte-1olzq4i-style")||((t=k("style")).id="svelte-1olzq4i-style",t.textContent=".key.svelte-1olzq4i.svelte-1olzq4i{display:flex;flex-direction:row;align-items:center}.key-box.svelte-1olzq4i.svelte-1olzq4i{cursor:pointer;min-width:10px;padding-left:5px;padding-right:5px;height:20px;line-height:20px;text-align:center;border:1px solid #ccc;box-shadow:1px 1px 1px #888;background:#eee;color:#444}.key-box.svelte-1olzq4i.svelte-1olzq4i:hover{background:#ddd}.key.active.svelte-1olzq4i .key-box.svelte-1olzq4i{background:#ddd;border:1px solid #999;box-shadow:none}.label.svelte-1olzq4i.svelte-1olzq4i{margin-left:10px}",$(document.head,t)),be(this,e,vr,mr,i,{value:0,onPress:6,label:1,disable:7})}}function gr(e){let n,r,o,a,i,c,u,d,p,f,y;return{c(){n=k("div"),r=k("span"),o=O(e[2]),a=I(),i=k("span"),i.textContent="(",c=I(),u=k("span"),d=I(),p=k("span"),p.textContent=")",D(u,"class","arg-field svelte-1mppqmp"),D(u,"contenteditable",""),D(n,"class","move svelte-1mppqmp"),z(n,"active",e[3])},m(t,s){var m;x(t,n,s),$(n,r),$(r,o),$(n,a),$(n,i),$(n,c),$(n,u),e[6](u),$(n,d),$(n,p),f||(y=[j(u,"focus",(function(){l(e[0])&&e[0].apply(this,arguments)})),j(u,"blur",(function(){l(e[1])&&e[1].apply(this,arguments)})),j(u,"keypress",(m=br,function(e){return e.stopPropagation(),m.call(this,e)})),j(u,"keydown",e[5]),j(n,"click",(function(){l(e[0])&&e[0].apply(this,arguments)}))],f=!0)},p(t,[r]){e=t,4&r&&_(o,e[2]),8&r&&z(n,"active",e[3])},i:t,o:t,d(t){t&&w(n),e[6](null),f=!1,s(y)}}}const br=()=>{};function $r(e,t,n){let r,{Activate:o}=t,{Deactivate:a}=t,{name:s}=t,{active:l}=t;const i=U();var c;return c=()=>{l?r.focus():r.blur()},V().$$.after_update.push(c),e.$set=e=>{"Activate"in e&&n(0,o=e.Activate),"Deactivate"in e&&n(1,a=e.Deactivate),"name"in e&&n(2,s=e.name),"active"in e&&n(3,l=e.active)},[o,a,s,l,r,function(e){"Enter"==e.key&&(e.preventDefault(),function(){try{const e=r.innerText;let t=new Function(`return [${e}]`)();i("submit",t)}catch(e){i("error",e)}n(4,r.innerText="",r)}()),"Escape"==e.key&&(e.preventDefault(),a())},function(e){W[e?"unshift":"push"](()=>{r=e,n(4,r)})}]}class xr extends $e{constructor(e){var t;super(),document.getElementById("svelte-1mppqmp-style")||((t=k("style")).id="svelte-1mppqmp-style",t.textContent=".move.svelte-1mppqmp{display:flex;flex-direction:row;cursor:pointer;margin-left:10px;color:#666}.move.svelte-1mppqmp:hover{color:#333}.move.active.svelte-1mppqmp{color:#111;font-weight:bold}.arg-field.svelte-1mppqmp{outline:none;font-family:monospace}",$(document.head,t)),be(this,e,$r,gr,i,{Activate:0,Deactivate:1,name:2,active:3})}}function wr(e){let t,n;return{c(){t=k("span"),n=O(e[2]),D(t,"class","move-error svelte-smqssc")},m(e,r){x(e,t,r),$(t,n)},p(e,t){4&t&&_(n,e[2])},d(e){e&&w(t)}}}function Pr(e){let t,n,r,o,a,s,l;r=new hr({props:{value:e[0],onPress:e[4]}}),a=new xr({props:{Activate:e[4],Deactivate:e[5],name:e[1],active:e[3]}}),a.$on("submit",e[6]),a.$on("error",e[7]);let i=e[2]&&wr(e);return{c(){t=k("div"),n=k("div"),me(r.$$.fragment),o=I(),me(a.$$.fragment),s=I(),i&&i.c(),D(n,"class","wrapper svelte-smqssc")},m(e,c){x(e,t,c),$(t,n),ve(r,n,null),$(n,o),ve(a,n,null),$(t,s),i&&i.m(t,null),l=!0},p(e,[n]){const o={};1&n&&(o.value=e[0]),r.$set(o);const s={};2&n&&(s.name=e[1]),8&n&&(s.active=e[3]),a.$set(s),e[2]?i?i.p(e,n):(i=wr(e),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},i(e){l||(de(r.$$.fragment,e),de(a.$$.fragment,e),l=!0)},o(e){pe(r.$$.fragment,e),pe(a.$$.fragment,e),l=!1},d(e){e&&w(t),he(r),he(a),i&&i.d()}}}function kr(e,t,n){let{shortcut:r}=t,{name:o}=t,{fn:a}=t;const{disableHotkeys:s}=F("hotkeys");let l="",i=!1;function c(){s.set(!1),n(2,l=""),n(3,i=!1)}return e.$set=e=>{"shortcut"in e&&n(0,r=e.shortcut),"name"in e&&n(1,o=e.name),"fn"in e&&n(8,a=e.fn)},[r,o,l,i,function(){s.set(!0),n(3,i=!0)},c,function(e){n(2,l=""),c(),a.apply(this,e.detail)},function(e){n(2,l=e.detail),Ht(e.detail)},a]}class Er extends $e{constructor(e){var t;super(),document.getElementById("svelte-smqssc-style")||((t=k("style")).id="svelte-smqssc-style",t.textContent=".move-error.svelte-smqssc{color:#a00;font-weight:bold}.wrapper.svelte-smqssc{display:flex;flex-direction:row;align-items:center}",$(document.head,t)),be(this,e,kr,Pr,i,{shortcut:0,name:1,fn:8})}}var Or=function(e,t){return{parse:function(t){var n=JSON.parse(t,o).map(r),a=n[0];return"object"==typeof a&&a?function t(n,r,o){return Object.keys(o).reduce((function(o,a){var s=o[a];if(s instanceof e){var l=n[s];"object"!=typeof l||r.has(l)?o[a]=l:(r.add(l),o[a]=t(n,r,l))}return o}),o)}(n,new Set,a):a},stringify:function(e){for(var t,r=new Map,o=[],a=[],s=+n(r,o,e),l=function(e,a){if(t)return t=!t,a;switch(typeof a){case"object":if(null===a)return a;case"string":return r.get(a)||n(r,o,a)}return a};s<o.length;s++)t=!0,a[s]=JSON.stringify(o[s],l);return"["+a.join(",")+"]"}};function n(t,n,r){var o=e(n.push(r)-1);return t.set(r,o),o}function r(t){return t instanceof e?e(t):t}function o(t,n){return"string"==typeof n?new e(n):n}}(String);const Ir=Or.parse,Ar=Or.stringify;function jr(e){let t,n,r,o,a,s,l,i,c,u,d,p,f;return r=new hr({props:{value:"1",onPress:e[0].reset,label:"reset"}}),s=new hr({props:{value:"2",onPress:e[1],label:"save"}}),c=new hr({props:{value:"3",onPress:e[2],label:"restore"}}),p=new hr({props:{value:".",disable:!0,label:"hide"}}),{c(){t=k("section"),n=k("li"),me(r.$$.fragment),o=I(),a=k("li"),me(s.$$.fragment),l=I(),i=k("li"),me(c.$$.fragment),u=I(),d=k("li"),me(p.$$.fragment),D(n,"class","svelte-1x2w9i0"),D(a,"class","svelte-1x2w9i0"),D(i,"class","svelte-1x2w9i0"),D(d,"class","svelte-1x2w9i0"),D(t,"id","debug-controls"),D(t,"class","controls")},m(e,y){x(e,t,y),$(t,n),ve(r,n,null),$(t,o),$(t,a),ve(s,a,null),$(t,l),$(t,i),ve(c,i,null),$(t,u),$(t,d),ve(p,d,null),f=!0},p(e,[t]){const n={};1&t&&(n.onPress=e[0].reset),r.$set(n)},i(e){f||(de(r.$$.fragment,e),de(s.$$.fragment,e),de(c.$$.fragment,e),de(p.$$.fragment,e),f=!0)},o(e){pe(r.$$.fragment,e),pe(s.$$.fragment,e),pe(c.$$.fragment,e),pe(p.$$.fragment,e),f=!1},d(e){e&&w(t),he(r),he(s),he(c),he(p)}}}function Dr(e,t,n){let{client:r}=t;return e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,function(){const e=r.getState(),t=Ar({...e,_undo:[],_redo:[],deltalog:[]});window.localStorage.setItem("gamestate",t),window.localStorage.setItem("initialState",Ar(r.initialState))},function(){const e=window.localStorage.getItem("gamestate"),t=window.localStorage.getItem("initialState");if(null!==e&&null!==t){const n=Ir(e),o=Ir(t);r.store.dispatch(ze({state:n,initialState:o}))}}]}class _r extends $e{constructor(e){var t;super(),document.getElementById("svelte-1x2w9i0-style")||((t=k("style")).id="svelte-1x2w9i0-style",t.textContent="li.svelte-1x2w9i0{list-style:none;margin:none;margin-bottom:5px}",$(document.head,t)),be(this,e,Dr,jr,i,{client:0})}}function Sr(e,t,n){const r=e.slice();return r[6]=t[n],r}function Cr(e){let t,n,r,o,a,s=e[6]+"";function l(...t){return e[4](e[6],...t)}return{c(){t=k("button"),n=O(s),r=I(),D(t,"class","player svelte-19aan9p"),z(t,"current",e[6]==e[0].currentPlayer),z(t,"active",e[6]==e[1])},m(e,s){x(e,t,s),$(t,n),$(t,r),o||(a=j(t,"click",l),o=!0)},p(r,o){e=r,4&o&&s!==(s=e[6]+"")&&_(n,s),5&o&&z(t,"current",e[6]==e[0].currentPlayer),6&o&&z(t,"active",e[6]==e[1])},d(e){e&&w(t),o=!1,a()}}}function zr(e){let n,r=e[2],o=[];for(let t=0;t<r.length;t+=1)o[t]=Cr(Sr(e,r,t));return{c(){n=k("div");for(let e=0;e<o.length;e+=1)o[e].c();D(n,"class","player-box svelte-19aan9p")},m(e,t){x(e,n,t);for(let e=0;e<o.length;e+=1)o[e].m(n,null)},p(e,[t]){if(15&t){let a;for(r=e[2],a=0;a<r.length;a+=1){const s=Sr(e,r,a);o[a]?o[a].p(s,t):(o[a]=Cr(s),o[a].c(),o[a].m(n,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}},i:t,o:t,d(e){e&&w(n),P(o,e)}}}function Mr(e,t,n){let{ctx:r}=t,{playerID:o}=t;const a=U();function s(e){a("change",e==o?{playerID:null}:{playerID:e})}let l;return e.$set=e=>{"ctx"in e&&n(0,r=e.ctx),"playerID"in e&&n(1,o=e.playerID)},e.$$.update=()=>{1&e.$$.dirty&&n(2,l=r?[...Array(r.numPlayers).keys()].map(e=>e.toString()):[])},[r,o,l,s,e=>s(e)]}class Nr extends $e{constructor(e){var t;super(),document.getElementById("svelte-19aan9p-style")||((t=k("style")).id="svelte-19aan9p-style",t.textContent=".player-box.svelte-19aan9p{display:flex;flex-direction:row}.player.svelte-19aan9p{cursor:pointer;text-align:center;width:30px;height:30px;line-height:30px;background:#eee;border:3px solid #fefefe;box-sizing:content-box;padding:0}.player.current.svelte-19aan9p{background:#555;color:#eee;font-weight:bold}.player.active.svelte-19aan9p{border:3px solid #ff7f50}",$(document.head,t)),be(this,e,Mr,zr,i,{ctx:0,playerID:1})}}function qr(e,t,n){const r=e.slice();return r[8]=t[n][0],r[9]=t[n][1],r}function Gr(e){let t,n,r,o;return n=new Er({props:{shortcut:e[6][e[8]],fn:e[9],name:e[8]}}),{c(){t=k("li"),me(n.$$.fragment),r=I(),D(t,"class","svelte-13iak2e")},m(e,a){x(e,t,a),ve(n,t,null),$(t,r),o=!0},p(e,t){const r={};4&t&&(r.shortcut=e[6][e[8]]),4&t&&(r.fn=e[9]),4&t&&(r.name=e[8]),n.$set(r)},i(e){o||(de(n.$$.fragment,e),o=!0)},o(e){pe(n.$$.fragment,e),o=!1},d(e){e&&w(t),he(n)}}}function Tr(e){let t,n,r;return n=new Er({props:{name:"endStage",shortcut:7,fn:e[3].endStage}}),{c(){t=k("li"),me(n.$$.fragment),D(t,"class","svelte-13iak2e")},m(e,o){x(e,t,o),ve(n,t,null),r=!0},p(e,t){const r={};8&t&&(r.fn=e[3].endStage),n.$set(r)},i(e){r||(de(n.$$.fragment,e),r=!0)},o(e){pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),he(n)}}}function Br(e){let t,n,r;return n=new Er({props:{name:"endTurn",shortcut:8,fn:e[3].endTurn}}),{c(){t=k("li"),me(n.$$.fragment),D(t,"class","svelte-13iak2e")},m(e,o){x(e,t,o),ve(n,t,null),r=!0},p(e,t){const r={};8&t&&(r.fn=e[3].endTurn),n.$set(r)},i(e){r||(de(n.$$.fragment,e),r=!0)},o(e){pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),he(n)}}}function Lr(e){let t,n,r;return n=new Er({props:{name:"endPhase",shortcut:9,fn:e[3].endPhase}}),{c(){t=k("li"),me(n.$$.fragment),D(t,"class","svelte-13iak2e")},m(e,o){x(e,t,o),ve(n,t,null),r=!0},p(e,t){const r={};8&t&&(r.fn=e[3].endPhase),n.$set(r)},i(e){r||(de(n.$$.fragment,e),r=!0)},o(e){pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),he(n)}}}function Vr(e){let t,n,r,o,a,s,l,i,c,u,d,p,f,y,m,v,h,g,b,E,O,A,j,_,S,C,z,M,N,q,G;o=new _r({props:{client:e[0]}}),c=new Nr({props:{ctx:e[4],playerID:e[1]}}),c.$on("change",e[7]);let T=Object.entries(e[2]),B=[];for(let t=0;t<T.length;t+=1)B[t]=Gr(qr(e,T,t));const L=e=>pe(B[e],1,1,()=>{B[e]=null});let V=e[4].activePlayers&&e[3].endStage&&Tr(e),R=e[3].endTurn&&Br(e),U=e[4].phase&&e[3].endPhase&&Lr(e);return S=new fr({props:{value:e[5]}}),q=new fr({props:{value:Rr(e[4])}}),{c(){t=k("section"),n=k("h3"),n.textContent="Controls",r=I(),me(o.$$.fragment),a=I(),s=k("section"),l=k("h3"),l.textContent="Players",i=I(),me(c.$$.fragment),u=I(),d=k("section"),p=k("h3"),p.textContent="Moves",f=I();for(let e=0;e<B.length;e+=1)B[e].c();y=I(),m=k("section"),v=k("h3"),v.textContent="Events",h=I(),g=k("div"),V&&V.c(),b=I(),R&&R.c(),E=I(),U&&U.c(),O=I(),A=k("section"),j=k("label"),j.textContent="G",_=I(),me(S.$$.fragment),C=I(),z=k("section"),M=k("label"),M.textContent="ctx",N=I(),me(q.$$.fragment),D(n,"class","svelte-13iak2e"),D(l,"class","svelte-13iak2e"),D(p,"class","svelte-13iak2e"),D(v,"class","svelte-13iak2e"),D(g,"class","events"),D(j,"class","svelte-13iak2e"),D(A,"class","tree svelte-13iak2e"),D(M,"class","svelte-13iak2e"),D(z,"class","tree svelte-13iak2e")},m(e,w){x(e,t,w),$(t,n),$(t,r),ve(o,t,null),x(e,a,w),x(e,s,w),$(s,l),$(s,i),ve(c,s,null),x(e,u,w),x(e,d,w),$(d,p),$(d,f);for(let e=0;e<B.length;e+=1)B[e].m(d,null);x(e,y,w),x(e,m,w),$(m,v),$(m,h),$(m,g),V&&V.m(g,null),$(g,b),R&&R.m(g,null),$(g,E),U&&U.m(g,null),x(e,O,w),x(e,A,w),$(A,j),$(A,_),ve(S,A,null),x(e,C,w),x(e,z,w),$(z,M),$(z,N),ve(q,z,null),G=!0},p(e,[t]){const n={};1&t&&(n.client=e[0]),o.$set(n);const r={};if(16&t&&(r.ctx=e[4]),2&t&&(r.playerID=e[1]),c.$set(r),68&t){let n;for(T=Object.entries(e[2]),n=0;n<T.length;n+=1){const r=qr(e,T,n);B[n]?(B[n].p(r,t),de(B[n],1)):(B[n]=Gr(r),B[n].c(),de(B[n],1),B[n].m(d,null))}for(ce(),n=T.length;n<B.length;n+=1)L(n);ue()}e[4].activePlayers&&e[3].endStage?V?(V.p(e,t),24&t&&de(V,1)):(V=Tr(e),V.c(),de(V,1),V.m(g,b)):V&&(ce(),pe(V,1,1,()=>{V=null}),ue()),e[3].endTurn?R?(R.p(e,t),8&t&&de(R,1)):(R=Br(e),R.c(),de(R,1),R.m(g,E)):R&&(ce(),pe(R,1,1,()=>{R=null}),ue()),e[4].phase&&e[3].endPhase?U?(U.p(e,t),24&t&&de(U,1)):(U=Lr(e),U.c(),de(U,1),U.m(g,null)):U&&(ce(),pe(U,1,1,()=>{U=null}),ue());const a={};32&t&&(a.value=e[5]),S.$set(a);const s={};16&t&&(s.value=Rr(e[4])),q.$set(s)},i(e){if(!G){de(o.$$.fragment,e),de(c.$$.fragment,e);for(let e=0;e<T.length;e+=1)de(B[e]);de(V),de(R),de(U),de(S.$$.fragment,e),de(q.$$.fragment,e),G=!0}},o(e){pe(o.$$.fragment,e),pe(c.$$.fragment,e),B=B.filter(Boolean);for(let e=0;e<B.length;e+=1)pe(B[e]);pe(V),pe(R),pe(U),pe(S.$$.fragment,e),pe(q.$$.fragment,e),G=!1},d(e){e&&w(t),he(o),e&&w(a),e&&w(s),he(c),e&&w(u),e&&w(d),P(B,e),e&&w(y),e&&w(m),V&&V.d(),R&&R.d(),U&&U.d(),e&&w(O),e&&w(A),he(S),e&&w(C),e&&w(z),he(q)}}}function Rr(e){let t={};for(const n in e)n.startsWith("_")||(t[n]=e[n]);return t}function Ur(e,t,n){let{client:r}=t;const o=function(e,t){for(var n={},r={},o=0;o<t.length;o++){r[t[o]]=!0}var a=r,s=!0;for(var l in e){var i=l[0];if(a[i]){s=!1;break}a[i]=!0,n[l]=i}if(s)return n;a=r;var c=97;for(var u in n={},e){for(var d=String.fromCharCode(c);a[d];)c++,d=String.fromCharCode(c);a[d]=!0,n[u]=d}return n}(r.moves,"mlia");let{playerID:a,moves:s,events:l}=r,i={},c={};r.subscribe(e=>{e&&n(5,({G:c,ctx:i}=e),c,n(4,i)),n(1,({playerID:a,moves:s,events:l}=r),a,n(2,s),n(3,l))});return e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,a,s,l,i,c,o,e=>r.updatePlayerID(e.detail.playerID)]}class Kr extends $e{constructor(e){var t;super(),document.getElementById("svelte-13iak2e-style")||((t=k("style")).id="svelte-13iak2e-style",t.textContent=".tree.svelte-13iak2e{--json-tree-font-family:monospace;--json-tree-font-size:14px;--json-tree-null-color:#757575}label.svelte-13iak2e{font-weight:bold;font-size:1.1em;display:inline}h3.svelte-13iak2e{text-transform:uppercase}li.svelte-13iak2e{list-style:none;margin:none;margin-bottom:5px}",$(document.head,t)),be(this,e,Ur,Vr,i,{client:0})}}function Fr(e){let n,r,o,a,s,l,i=JSON.stringify(e[1])+"";return{c(){n=k("div"),r=k("strong"),o=O(e[0]),a=I(),s=k("div"),l=O(i),D(s,"class","svelte-13qih23"),D(n,"class","item svelte-13qih23")},m(e,t){x(e,n,t),$(n,r),$(r,o),$(n,a),$(n,s),$(s,l)},p(e,[t]){1&t&&_(o,e[0]),2&t&&i!==(i=JSON.stringify(e[1])+"")&&_(l,i)},i:t,o:t,d(e){e&&w(n)}}}function Jr(e,t,n){let{name:r}=t,{value:o}=t;return e.$set=e=>{"name"in e&&n(0,r=e.name),"value"in e&&n(1,o=e.value)},[r,o]}class Hr extends $e{constructor(e){var t;super(),document.getElementById("svelte-13qih23-style")||((t=k("style")).id="svelte-13qih23-style",t.textContent=".item.svelte-13qih23.svelte-13qih23{padding:10px}.item.svelte-13qih23.svelte-13qih23:not(:first-child){border-top:1px dashed #aaa}.item.svelte-13qih23 div.svelte-13qih23{float:right;text-align:right}",$(document.head,t)),be(this,e,Jr,Fr,i,{name:0,value:1})}}function Wr(e){let t,n;return t=new Hr({props:{name:"isConnected",value:e[1].isConnected}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.value=e[1].isConnected),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Yr(e){let t,n,r,o,a,s,l,i;n=new Hr({props:{name:"matchID",value:e[0].matchID}}),o=new Hr({props:{name:"playerID",value:e[0].playerID}}),s=new Hr({props:{name:"isActive",value:e[1].isActive}});let c=e[0].multiplayer&&Wr(e);return{c(){t=k("section"),me(n.$$.fragment),r=I(),me(o.$$.fragment),a=I(),me(s.$$.fragment),l=I(),c&&c.c(),D(t,"class","gameinfo svelte-1yzq5o8")},m(e,u){x(e,t,u),ve(n,t,null),$(t,r),ve(o,t,null),$(t,a),ve(s,t,null),$(t,l),c&&c.m(t,null),i=!0},p(e,[r]){const a={};1&r&&(a.value=e[0].matchID),n.$set(a);const l={};1&r&&(l.value=e[0].playerID),o.$set(l);const i={};2&r&&(i.value=e[1].isActive),s.$set(i),e[0].multiplayer?c?(c.p(e,r),1&r&&de(c,1)):(c=Wr(e),c.c(),de(c,1),c.m(t,null)):c&&(ce(),pe(c,1,1,()=>{c=null}),ue())},i(e){i||(de(n.$$.fragment,e),de(o.$$.fragment,e),de(s.$$.fragment,e),de(c),i=!0)},o(e){pe(n.$$.fragment,e),pe(o.$$.fragment,e),pe(s.$$.fragment,e),pe(c),i=!1},d(e){e&&w(t),he(n),he(o),he(s),c&&c.d()}}}function Xr(e,n,r){let o,a=t,s=()=>(a(),a=c(l,e=>r(1,o=e)),l);e.$$.on_destroy.push(()=>a());let{client:l}=n;return s(),e.$set=e=>{"client"in e&&s(r(0,l=e.client))},[l,o]}class Zr extends $e{constructor(e){var t;super(),document.getElementById("svelte-1yzq5o8-style")||((t=k("style")).id="svelte-1yzq5o8-style",t.textContent=".gameinfo.svelte-1yzq5o8{padding:10px}",$(document.head,t)),be(this,e,Xr,Yr,i,{client:0})}}function Qr(e){let n,r;return{c(){n=k("div"),r=O(e[0]),D(n,"class","turn-marker svelte-6eza86"),D(n,"style",e[1])},m(e,t){x(e,n,t),$(n,r)},p(e,[t]){1&t&&_(r,e[0])},i:t,o:t,d(e){e&&w(n)}}}function eo(e,t,n){let{turn:r}=t,{numEvents:o}=t;const a=`grid-row: span ${o}`;return e.$set=e=>{"turn"in e&&n(0,r=e.turn),"numEvents"in e&&n(2,o=e.numEvents)},[r,a,o]}class to extends $e{constructor(e){var t;super(),document.getElementById("svelte-6eza86-style")||((t=k("style")).id="svelte-6eza86-style",t.textContent=".turn-marker.svelte-6eza86{display:flex;justify-content:center;align-items:center;grid-column:1;background:#555;color:#eee;text-align:center;font-weight:bold;border:1px solid #888}",$(document.head,t)),be(this,e,eo,Qr,i,{turn:0,numEvents:2})}}function no(e){let n,r,o=(e[0]||"")+"";return{c(){n=k("div"),r=O(o),D(n,"class","phase-marker svelte-1t4xap"),D(n,"style",e[1])},m(e,t){x(e,n,t),$(n,r)},p(e,[t]){1&t&&o!==(o=(e[0]||"")+"")&&_(r,o)},i:t,o:t,d(e){e&&w(n)}}}function ro(e,t,n){let{phase:r}=t,{numEvents:o}=t;const a=`grid-row: span ${o}`;return e.$set=e=>{"phase"in e&&n(0,r=e.phase),"numEvents"in e&&n(2,o=e.numEvents)},[r,a,o]}class oo extends $e{constructor(e){var t;super(),document.getElementById("svelte-1t4xap-style")||((t=k("style")).id="svelte-1t4xap-style",t.textContent=".phase-marker.svelte-1t4xap{grid-column:3;background:#555;border:1px solid #888;color:#eee;text-align:center;font-weight:bold;padding-top:10px;padding-bottom:10px;text-orientation:sideways;writing-mode:vertical-rl;line-height:30px;width:100%}",$(document.head,t)),be(this,e,ro,no,i,{phase:0,numEvents:2})}}function ao(e){let n;return{c(){n=k("div"),n.textContent=`${e[0]}`},m(e,t){x(e,n,t)},p:t,i:t,o:t,d(e){e&&w(n)}}}function so(e,t,n){let{payload:r}=t;const o=void 0!==r?JSON.stringify(r,null,4):"";return e.$set=e=>{"payload"in e&&n(1,r=e.payload)},[o,r]}class lo extends $e{constructor(e){super(),be(this,e,so,ao,i,{payload:1})}}function io(e){let t,n;return t=new lo({props:{payload:e[3]}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};8&n&&(r.payload=e[3]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function co(e){let t,n,r;var o=e[4];function a(e){return{props:{payload:e[3]}}}return o&&(t=new o(a(e))),{c(){t&&me(t.$$.fragment),n=A()},m(e,o){t&&ve(t,e,o),x(e,n,o),r=!0},p(e,r){const s={};if(8&r&&(s.payload=e[3]),o!==(o=e[4])){if(t){ce();const e=t;pe(e.$$.fragment,1,0,()=>{he(e,1)}),ue()}o?(t=new o(a(e)),me(t.$$.fragment),de(t.$$.fragment,1),ve(t,n.parentNode,n)):t=null}else o&&t.$set(s)},i(e){r||(t&&de(t.$$.fragment,e),r=!0)},o(e){t&&pe(t.$$.fragment,e),r=!1},d(e){e&&w(n),t&&he(t,e)}}}function uo(e){let t,n,r,o,a,l,i,c,u,d,p,f,y,m=e[1].payload.type+"",v=e[6].join(",")+"";const h=[co,io],g=[];function b(e,t){return e[4]?0:1}return c=b(e),u=g[c]=h[c](e),{c(){t=k("div"),n=k("div"),r=O(m),o=O("("),a=O(v),l=O(")"),i=I(),u.c(),D(t,"class",d="log-event player"+e[7]+" svelte-10wdo7v"),z(t,"pinned",e[2])},m(s,u){x(s,t,u),$(t,n),$(n,r),$(n,o),$(n,a),$(n,l),$(t,i),g[c].m(t,null),p=!0,f||(y=[j(t,"click",e[8]),j(t,"mouseenter",e[9]),j(t,"mouseleave",e[10])],f=!0)},p(e,[n]){(!p||2&n)&&m!==(m=e[1].payload.type+"")&&_(r,m);let o=c;c=b(e),c===o?g[c].p(e,n):(ce(),pe(g[o],1,1,()=>{g[o]=null}),ue(),u=g[c],u||(u=g[c]=h[c](e),u.c()),de(u,1),u.m(t,null)),4&n&&z(t,"pinned",e[2])},i(e){p||(de(u),p=!0)},o(e){pe(u),p=!1},d(e){e&&w(t),g[c].d(),f=!1,s(y)}}}function po(e,t,n){let{logIndex:r}=t,{action:o}=t,{pinned:a}=t,{payload:s}=t,{payloadComponent:l}=t;const i=U(),c=o.payload.args||[],u=o.payload.playerID;return e.$set=e=>{"logIndex"in e&&n(0,r=e.logIndex),"action"in e&&n(1,o=e.action),"pinned"in e&&n(2,a=e.pinned),"payload"in e&&n(3,s=e.payload),"payloadComponent"in e&&n(4,l=e.payloadComponent)},[r,o,a,s,l,i,c,u,()=>i("click",{logIndex:r}),()=>i("mouseenter",{logIndex:r}),()=>i("mouseleave")]}class fo extends $e{constructor(e){var t;super(),document.getElementById("svelte-10wdo7v-style")||((t=k("style")).id="svelte-10wdo7v-style",t.textContent=".log-event.svelte-10wdo7v{grid-column:2;cursor:pointer;overflow:hidden;display:flex;flex-direction:column;justify-content:center;background:#fff;border:1px dotted #ccc;border-left:5px solid #ccc;padding:5px;text-align:center;color:#888;font-size:14px;min-height:25px;line-height:25px}.log-event.svelte-10wdo7v:hover{border-style:solid;background:#eee}.log-event.pinned.svelte-10wdo7v{border-style:solid;background:#eee;opacity:1}.player0.svelte-10wdo7v{border-left-color:#ff851b}.player1.svelte-10wdo7v{border-left-color:#7fdbff}.player2.svelte-10wdo7v{border-left-color:#0074d9}.player3.svelte-10wdo7v{border-left-color:#39cccc}.player4.svelte-10wdo7v{border-left-color:#3d9970}.player5.svelte-10wdo7v{border-left-color:#2ecc40}.player6.svelte-10wdo7v{border-left-color:#01ff70}.player7.svelte-10wdo7v{border-left-color:#ffdc00}.player8.svelte-10wdo7v{border-left-color:#001f3f}.player9.svelte-10wdo7v{border-left-color:#ff4136}.player10.svelte-10wdo7v{border-left-color:#85144b}.player11.svelte-10wdo7v{border-left-color:#f012be}.player12.svelte-10wdo7v{border-left-color:#b10dc9}.player13.svelte-10wdo7v{border-left-color:#111111}.player14.svelte-10wdo7v{border-left-color:#aaaaaa}.player15.svelte-10wdo7v{border-left-color:#dddddd}",$(document.head,t)),be(this,e,po,uo,i,{logIndex:0,action:1,pinned:2,payload:3,payloadComponent:4})}}function yo(e){let t,n;return{c(){t=E("title"),n=O(e[0])},m(e,r){x(e,t,r),$(t,n)},p(e,t){1&t&&_(n,e[0])},d(e){e&&w(t)}}}function mo(e){let t,n,r,o=e[0]&&yo(e);const a=e[3].default,s=function(e,t,n,r){if(e){const o=d(e,t,n,r);return e[0](o)}}(a,e,e[2],null);return{c(){t=E("svg"),o&&o.c(),n=A(),s&&s.c(),D(t,"xmlns","http://www.w3.org/2000/svg"),D(t,"viewBox",e[1]),D(t,"class","svelte-c8tyih")},m(e,a){x(e,t,a),o&&o.m(t,null),$(t,n),s&&s.m(t,null),r=!0},p(e,[l]){e[0]?o?o.p(e,l):(o=yo(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null),s&&s.p&&4&l&&p(s,a,e,e[2],l,null,null),(!r||2&l)&&D(t,"viewBox",e[1])},i(e){r||(de(s,e),r=!0)},o(e){pe(s,e),r=!1},d(e){e&&w(t),o&&o.d(),s&&s.d(e)}}}function vo(e,t,n){let{title:r=null}=t,{viewBox:o}=t,{$$slots:a={},$$scope:s}=t;return e.$set=e=>{"title"in e&&n(0,r=e.title),"viewBox"in e&&n(1,o=e.viewBox),"$$scope"in e&&n(2,s=e.$$scope)},[r,o,s,a]}class ho extends $e{constructor(e){var t;super(),document.getElementById("svelte-c8tyih-style")||((t=k("style")).id="svelte-c8tyih-style",t.textContent="svg.svelte-c8tyih{stroke:currentColor;fill:currentColor;stroke-width:0;width:100%;height:auto;max-height:100%}",$(document.head,t)),be(this,e,vo,mo,i,{title:0,viewBox:1})}}function go(e){let t;return{c(){t=E("path"),D(t,"d","M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function bo(e){let t,n;const o=[{viewBox:"0 0 512 512"},e[0]];let a={$$slots:{default:[go]},$$scope:{ctx:e}};for(let e=0;e<o.length;e+=1)a=r(a,o[e]);return t=new ho({props:a}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,[n]){const r=1&n?function(e,t){const n={},r={},o={$$scope:1};let a=e.length;for(;a--;){const s=e[a],l=t[a];if(l){for(const e in s)e in l||(r[e]=1);for(const e in l)o[e]||(n[e]=l[e],o[e]=1);e[a]=l}else for(const e in s)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}(o,[o[0],(a=e[0],"object"==typeof a&&null!==a?a:{})]):{};var a;2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function $o(e,t,n){return e.$set=e=>{n(0,t=r(r({},t),f(e)))},[t=f(t)]}class xo extends $e{constructor(e){super(),be(this,e,$o,bo,i,{})}}function wo(e){let n,r;return{c(){n=k("div"),r=O(e[0]),D(n,"alt",e[0]),D(n,"class","svelte-1a7time")},m(e,t){x(e,n,t),$(n,r)},p(e,[t]){1&t&&_(r,e[0]),1&t&&D(n,"alt",e[0])},i:t,o:t,d(e){e&&w(n)}}}function Po(e,t,n){let r,{action:o}=t;return e.$set=e=>{"action"in e&&n(1,o=e.action)},e.$$.update=()=>{if(2&e.$$.dirty){const{type:e,args:t}=o.payload,a=(t||[]).join(",");n(0,r=`${e}(${a})`)}},[r,o]}class ko extends $e{constructor(e){var t;super(),document.getElementById("svelte-1a7time-style")||((t=k("style")).id="svelte-1a7time-style",t.textContent="div.svelte-1a7time{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:500px}",$(document.head,t)),be(this,e,Po,wo,i,{action:1})}}function Eo(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function Oo(e){let t,n,r,o,a,l,i,c,u,d,p,f,y,m=e[10].value+"",v=e[10].visits+"";function h(...t){return e[5](e[10],e[12],...t)}function g(...t){return e[6](e[12],...t)}function b(...t){return e[7](e[10],e[12],...t)}return u=new ko({props:{action:e[10].parentAction}}),{c(){t=k("tr"),n=k("td"),r=O(m),o=I(),a=k("td"),l=O(v),i=I(),c=k("td"),me(u.$$.fragment),d=I(),D(n,"class","svelte-ztcwsu"),D(a,"class","svelte-ztcwsu"),D(c,"class","svelte-ztcwsu"),D(t,"class","svelte-ztcwsu"),z(t,"clickable",e[1].length>0),z(t,"selected",e[12]===e[0])},m(e,s){x(e,t,s),$(t,n),$(n,r),$(t,o),$(t,a),$(a,l),$(t,i),$(t,c),ve(u,c,null),$(t,d),p=!0,f||(y=[j(t,"click",h),j(t,"mouseout",g),j(t,"mouseover",b)],f=!0)},p(n,o){e=n,(!p||2&o)&&m!==(m=e[10].value+"")&&_(r,m),(!p||2&o)&&v!==(v=e[10].visits+"")&&_(l,v);const a={};2&o&&(a.action=e[10].parentAction),u.$set(a),2&o&&z(t,"clickable",e[1].length>0),1&o&&z(t,"selected",e[12]===e[0])},i(e){p||(de(u.$$.fragment,e),p=!0)},o(e){pe(u.$$.fragment,e),p=!1},d(e){e&&w(t),he(u),f=!1,s(y)}}}function Io(e){let t,n,r,o,a,s=e[1],l=[];for(let t=0;t<s.length;t+=1)l[t]=Oo(Eo(e,s,t));const i=e=>pe(l[e],1,1,()=>{l[e]=null});return{c(){t=k("table"),n=k("thead"),n.innerHTML='<th class="svelte-ztcwsu">Value</th> \n    <th class="svelte-ztcwsu">Visits</th> \n    <th class="svelte-ztcwsu">Action</th>',r=I(),o=k("tbody");for(let e=0;e<l.length;e+=1)l[e].c();D(t,"class","svelte-ztcwsu")},m(e,s){x(e,t,s),$(t,n),$(t,r),$(t,o);for(let e=0;e<l.length;e+=1)l[e].m(o,null);a=!0},p(e,[t]){if(15&t){let n;for(s=e[1],n=0;n<s.length;n+=1){const r=Eo(e,s,n);l[n]?(l[n].p(r,t),de(l[n],1)):(l[n]=Oo(r),l[n].c(),de(l[n],1),l[n].m(o,null))}for(ce(),n=s.length;n<l.length;n+=1)i(n);ue()}},i(e){if(!a){for(let e=0;e<s.length;e+=1)de(l[e]);a=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)pe(l[e]);a=!1},d(e){e&&w(t),P(l,e)}}}function Ao(e,t,n){let{root:r}=t,{selectedIndex:o=null}=t;const a=U();let s=[],l=[];function i(e,t){a("select",{node:e,selectedIndex:t})}function c(e,t){null===o&&a("preview",{node:e})}return e.$set=e=>{"root"in e&&n(4,r=e.root),"selectedIndex"in e&&n(0,o=e.selectedIndex)},e.$$.update=()=>{if(272&e.$$.dirty){let e=r;for(n(8,s=[]);e.parent;){const t=e.parent,{type:n,args:r}=e.parentAction.payload,o=`${n}(${(r||[]).join(",")})`;s.push({parent:t,arrowText:o}),e=t}s.reverse(),n(1,l=[...r.children].sort((e,t)=>e.visits<t.visits?1:-1).slice(0,50))}},[o,l,i,c,r,(e,t)=>i(e,t),e=>c(null),(e,t)=>c(e)]}class jo extends $e{constructor(e){var t;super(),document.getElementById("svelte-ztcwsu-style")||((t=k("style")).id="svelte-ztcwsu-style",t.textContent="table.svelte-ztcwsu.svelte-ztcwsu{font-size:12px;border-collapse:collapse;border:1px solid #ddd;padding:0}tr.svelte-ztcwsu.svelte-ztcwsu{cursor:pointer}tr.svelte-ztcwsu:hover td.svelte-ztcwsu{background:#eee}tr.selected.svelte-ztcwsu td.svelte-ztcwsu{background:#eee}td.svelte-ztcwsu.svelte-ztcwsu{padding:10px;height:10px;line-height:10px;font-size:12px;border:none}th.svelte-ztcwsu.svelte-ztcwsu{background:#888;color:#fff;padding:10px;text-align:center}",$(document.head,t)),be(this,e,Ao,Io,i,{root:4,selectedIndex:0})}}function Do(e,t,n){const r=e.slice();return r[9]=t[n].node,r[10]=t[n].selectedIndex,r[12]=n,r}function _o(e){let t,n;return t=new jo({props:{root:e[9],selectedIndex:e[10]}}),t.$on("select",(function(...t){return e[7](e[12],...t)})),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(n,r){e=n;const o={};1&r&&(o.root=e[9]),1&r&&(o.selectedIndex=e[10]),t.$set(o)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function So(e){let t,n;return t=new jo({props:{root:e[9]}}),t.$on("select",(function(...t){return e[5](e[12],...t)})),t.$on("preview",(function(...t){return e[6](e[12],...t)})),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(n,r){e=n;const o={};1&r&&(o.root=e[9]),t.$set(o)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Co(e){let t,n,r,o,a,s=0!==e[12]&&function(e){let t,n,r;return n=new xo({}),{c(){t=k("div"),me(n.$$.fragment),D(t,"class","icon svelte-1f0amz4")},m(e,o){x(e,t,o),ve(n,t,null),r=!0},i(e){r||(de(n.$$.fragment,e),r=!0)},o(e){pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),he(n)}}}();const l=[So,_o],i=[];function c(e,t){return e[12]===e[0].length-1?0:1}return r=c(e),o=i[r]=l[r](e),{c(){s&&s.c(),t=I(),n=k("section"),o.c()},m(e,o){s&&s.m(e,o),x(e,t,o),x(e,n,o),i[r].m(n,null),a=!0},p(e,t){let a=r;r=c(e),r===a?i[r].p(e,t):(ce(),pe(i[a],1,1,()=>{i[a]=null}),ue(),o=i[r],o||(o=i[r]=l[r](e),o.c()),de(o,1),o.m(n,null))},i(e){a||(de(s),de(o),a=!0)},o(e){pe(s),pe(o),a=!1},d(e){s&&s.d(e),e&&w(t),e&&w(n),i[r].d()}}}function zo(e){let t,n,r,o,a,s;return n=new xo({}),a=new jo({props:{root:e[1]}}),{c(){t=k("div"),me(n.$$.fragment),r=I(),o=k("section"),me(a.$$.fragment),D(t,"class","icon svelte-1f0amz4"),D(o,"class","preview svelte-1f0amz4")},m(e,l){x(e,t,l),ve(n,t,null),x(e,r,l),x(e,o,l),ve(a,o,null),s=!0},p(e,t){const n={};2&t&&(n.root=e[1]),a.$set(n)},i(e){s||(de(n.$$.fragment,e),de(a.$$.fragment,e),s=!0)},o(e){pe(n.$$.fragment,e),pe(a.$$.fragment,e),s=!1},d(e){e&&w(t),he(n),e&&w(r),e&&w(o),he(a)}}}function Mo(e){let t,n,r,o=e[0],a=[];for(let t=0;t<o.length;t+=1)a[t]=Co(Do(e,o,t));const s=e=>pe(a[e],1,1,()=>{a[e]=null});let l=e[1]&&zo(e);return{c(){t=k("div");for(let e=0;e<a.length;e+=1)a[e].c();n=I(),l&&l.c(),D(t,"class","visualizer svelte-1f0amz4")},m(e,o){x(e,t,o);for(let e=0;e<a.length;e+=1)a[e].m(t,null);$(t,n),l&&l.m(t,null),r=!0},p(e,[r]){if(13&r){let l;for(o=e[0],l=0;l<o.length;l+=1){const s=Do(e,o,l);a[l]?(a[l].p(s,r),de(a[l],1)):(a[l]=Co(s),a[l].c(),de(a[l],1),a[l].m(t,n))}for(ce(),l=o.length;l<a.length;l+=1)s(l);ue()}e[1]?l?(l.p(e,r),2&r&&de(l,1)):(l=zo(e),l.c(),de(l,1),l.m(t,null)):l&&(ce(),pe(l,1,1,()=>{l=null}),ue())},i(e){if(!r){for(let e=0;e<o.length;e+=1)de(a[e]);de(l),r=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)pe(a[e]);pe(l),r=!1},d(e){e&&w(t),P(a,e),l&&l.d()}}}function No(e,t,n){let{metadata:r}=t,o=[],a=null;function s({node:e,selectedIndex:t},r){n(1,a=null),n(0,o[r].selectedIndex=t,o),n(0,o=[...o.slice(0,r+1),{node:e}])}function l({node:e},t){n(1,a=e)}return e.$set=e=>{"metadata"in e&&n(4,r=e.metadata)},e.$$.update=()=>{16&e.$$.dirty&&n(0,o=[{node:r}])},[o,a,s,l,r,(e,t)=>s(t.detail,e),(e,t)=>l(t.detail),(e,t)=>s(t.detail,e)]}class qo extends $e{constructor(e){var t;super(),document.getElementById("svelte-1f0amz4-style")||((t=k("style")).id="svelte-1f0amz4-style",t.textContent=".visualizer.svelte-1f0amz4{display:flex;flex-direction:column;align-items:center;padding:50px}.preview.svelte-1f0amz4{opacity:0.5}.icon.svelte-1f0amz4{color:#777;width:32px;height:32px;margin-bottom:20px}",$(document.head,t)),be(this,e,No,Mo,i,{metadata:4})}}function Go(e,t,n){const r=e.slice();return r[15]=t[n].phase,r[17]=n,r}function To(e,t,n){const r=e.slice();return r[18]=t[n].action,r[19]=t[n].payload,r[17]=n,r}function Bo(e,t,n){const r=e.slice();return r[21]=t[n].turn,r[17]=n,r}function Lo(e){let t,n;return t=new to({props:{turn:e[21],numEvents:e[3][e[17]]}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.turn=e[21]),8&n&&(r.numEvents=e[3][e[17]]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Vo(e){let t,n,r=e[17]in e[3]&&Lo(e);return{c(){r&&r.c(),t=A()},m(e,o){r&&r.m(e,o),x(e,t,o),n=!0},p(e,n){e[17]in e[3]?r?(r.p(e,n),8&n&&de(r,1)):(r=Lo(e),r.c(),de(r,1),r.m(t.parentNode,t)):r&&(ce(),pe(r,1,1,()=>{r=null}),ue())},i(e){n||(de(r),n=!0)},o(e){pe(r),n=!1},d(e){r&&r.d(e),e&&w(t)}}}function Ro(e){let t,n;return t=new fo({props:{pinned:e[17]===e[1],logIndex:e[17],action:e[18],payload:e[19]}}),t.$on("click",e[5]),t.$on("mouseenter",e[6]),t.$on("mouseleave",e[7]),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.pinned=e[17]===e[1]),4&n&&(r.action=e[18]),4&n&&(r.payload=e[19]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Uo(e){let t,n;return t=new oo({props:{phase:e[15],numEvents:e[4][e[17]]}}),{c(){me(t.$$.fragment)},m(e,r){ve(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.phase=e[15]),16&n&&(r.numEvents=e[4][e[17]]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){he(t,e)}}}function Ko(e){let t,n,r=e[17]in e[4]&&Uo(e);return{c(){r&&r.c(),t=A()},m(e,o){r&&r.m(e,o),x(e,t,o),n=!0},p(e,n){e[17]in e[4]?r?(r.p(e,n),16&n&&de(r,1)):(r=Uo(e),r.c(),de(r,1),r.m(t.parentNode,t)):r&&(ce(),pe(r,1,1,()=>{r=null}),ue())},i(e){n||(de(r),n=!0)},o(e){pe(r),n=!1},d(e){r&&r.d(e),e&&w(t)}}}function Fo(e){let t,n,r,o,a,s,l=e[2],i=[];for(let t=0;t<l.length;t+=1)i[t]=Vo(Bo(e,l,t));const c=e=>pe(i[e],1,1,()=>{i[e]=null});let u=e[2],d=[];for(let t=0;t<u.length;t+=1)d[t]=Ro(To(e,u,t));const p=e=>pe(d[e],1,1,()=>{d[e]=null});let f=e[2],y=[];for(let t=0;t<f.length;t+=1)y[t]=Ko(Go(e,f,t));const m=e=>pe(y[e],1,1,()=>{y[e]=null});return{c(){t=k("div");for(let e=0;e<i.length;e+=1)i[e].c();n=I();for(let e=0;e<d.length;e+=1)d[e].c();r=I();for(let e=0;e<y.length;e+=1)y[e].c();D(t,"class","gamelog svelte-1pq5e4b"),z(t,"pinned",e[1])},m(l,c){x(l,t,c);for(let e=0;e<i.length;e+=1)i[e].m(t,null);$(t,n);for(let e=0;e<d.length;e+=1)d[e].m(t,null);$(t,r);for(let e=0;e<y.length;e+=1)y[e].m(t,null);o=!0,a||(s=j(window,"keydown",e[8]),a=!0)},p(e,[o]){if(12&o){let r;for(l=e[2],r=0;r<l.length;r+=1){const a=Bo(e,l,r);i[r]?(i[r].p(a,o),de(i[r],1)):(i[r]=Vo(a),i[r].c(),de(i[r],1),i[r].m(t,n))}for(ce(),r=l.length;r<i.length;r+=1)c(r);ue()}if(230&o){let n;for(u=e[2],n=0;n<u.length;n+=1){const a=To(e,u,n);d[n]?(d[n].p(a,o),de(d[n],1)):(d[n]=Ro(a),d[n].c(),de(d[n],1),d[n].m(t,r))}for(ce(),n=u.length;n<d.length;n+=1)p(n);ue()}if(20&o){let n;for(f=e[2],n=0;n<f.length;n+=1){const r=Go(e,f,n);y[n]?(y[n].p(r,o),de(y[n],1)):(y[n]=Ko(r),y[n].c(),de(y[n],1),y[n].m(t,null))}for(ce(),n=f.length;n<y.length;n+=1)m(n);ue()}2&o&&z(t,"pinned",e[1])},i(e){if(!o){for(let e=0;e<l.length;e+=1)de(i[e]);for(let e=0;e<u.length;e+=1)de(d[e]);for(let e=0;e<f.length;e+=1)de(y[e]);o=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)pe(i[e]);d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)pe(d[e]);y=y.filter(Boolean);for(let e=0;e<y.length;e+=1)pe(y[e]);o=!1},d(e){e&&w(t),P(i,e),P(d,e),P(y,e),a=!1,s()}}}function Jo(e,n,r){let o,a=t,s=()=>(a(),a=c(l,e=>r(10,o=e)),l);e.$$.on_destroy.push(()=>a());let{client:l}=n;s();const{secondaryPane:i}=F("secondaryPane"),u=l.getInitialState();let d,{log:p}=o,f=null;function y(e){let t=u;for(let n=0;n<p.length;n++){const{action:r,automatic:o}=p[n];if(o||(t=l.reducer(t,r)),"MAKE_MOVE"==r.type){if(0==e)break;e--}}return{G:t.G,ctx:t.ctx}}function m(){r(1,f=null),l.overrideGameState(null),i.set(null)}R(m);let v={},h={};return e.$set=e=>{"client"in e&&s(r(0,l=e.client))},e.$$.update=()=>{if(1540&e.$$.dirty){r(9,p=o.log),r(2,d=p.filter(e=>"MAKE_MOVE"==e.action.type));let e=0,t=0;r(3,v={}),r(4,h={});for(let n=0;n<d.length;n++){const{action:o,payload:a,turn:s,phase:l}=d[n];t++,e++,n!=d.length-1&&d[n+1].turn==s||(r(3,v[n]=t,v),t=0),n!=d.length-1&&d[n+1].phase==l||(r(4,h[n]=e,h),e=0)}}},[l,f,d,v,h,function(e){const{logIndex:t}=e.detail,n=y(t),o=p.filter(e=>"MAKE_MOVE"==e.action.type);if(l.overrideGameState(n),f==t)r(1,f=null),i.set(null);else{r(1,f=t);const{metadata:e}=o[t].action.payload;e&&i.set({component:qo,metadata:e})}},function(e){const{logIndex:t}=e.detail;if(null===f){const e=y(t);l.overrideGameState(e)}},function(){null===f&&l.overrideGameState(null)},function(e){27==e.keyCode&&m()}]}class Ho extends $e{constructor(e){var t;super(),document.getElementById("svelte-1pq5e4b-style")||((t=k("style")).id="svelte-1pq5e4b-style",t.textContent=".gamelog.svelte-1pq5e4b{display:grid;grid-template-columns:30px 1fr 30px;grid-auto-rows:auto;grid-auto-flow:column}",$(document.head,t)),be(this,e,Jo,Fo,i,{client:0})}}function Wo(e,t,n){const r=e.slice();return r[5]=t[n][0],r[6]=t[n][1],r}function Yo(e){let t,n,r,o,a,l,i,c,u=e[1][e[5]]+"";function d(){e[3].call(o,e[5])}return{c(){t=k("span"),n=O(u),r=I(),o=k("input"),D(t,"class","value svelte-7cel4i"),D(o,"type","range"),D(o,"min",a=e[6].range.min),D(o,"max",l=e[6].range.max)},m(a,s){x(a,t,s),$(t,n),x(a,r,s),x(a,o,s),S(o,e[1][e[5]]),i||(c=[j(o,"change",d),j(o,"input",d),j(o,"change",e[2])],i=!0)},p(t,r){e=t,3&r&&u!==(u=e[1][e[5]]+"")&&_(n,u),1&r&&a!==(a=e[6].range.min)&&D(o,"min",a),1&r&&l!==(l=e[6].range.max)&&D(o,"max",l),3&r&&S(o,e[1][e[5]])},d(e){e&&w(t),e&&w(r),e&&w(o),i=!1,s(c)}}}function Xo(e){let t,n,r;function o(){e[4].call(t,e[5])}return{c(){t=k("input"),D(t,"type","checkbox"),D(t,"class","svelte-7cel4i")},m(a,s){x(a,t,s),t.checked=e[1][e[5]],n||(r=[j(t,"change",o),j(t,"change",e[2])],n=!0)},p(n,r){e=n,3&r&&(t.checked=e[1][e[5]])},d(e){e&&w(t),n=!1,s(r)}}}function Zo(e){let t,n,r,o,a,s,l=e[5]+"",i=e[6].range&&Yo(e),c="boolean"==typeof e[6].value&&Xo(e);return{c(){t=k("div"),n=k("label"),r=O(l),o=I(),i&&i.c(),a=I(),c&&c.c(),s=I(),D(n,"class","svelte-7cel4i"),D(t,"class","option svelte-7cel4i")},m(e,l){x(e,t,l),$(t,n),$(n,r),$(t,o),i&&i.m(t,null),$(t,a),c&&c.m(t,null),$(t,s)},p(e,n){1&n&&l!==(l=e[5]+"")&&_(r,l),e[6].range?i?i.p(e,n):(i=Yo(e),i.c(),i.m(t,a)):i&&(i.d(1),i=null),"boolean"==typeof e[6].value?c?c.p(e,n):(c=Xo(e),c.c(),c.m(t,s)):c&&(c.d(1),c=null)},d(e){e&&w(t),i&&i.d(),c&&c.d()}}}function Qo(e){let n,r=Object.entries(e[0].opts()),o=[];for(let t=0;t<r.length;t+=1)o[t]=Zo(Wo(e,r,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();n=A()},m(e,t){for(let n=0;n<o.length;n+=1)o[n].m(e,t);x(e,n,t)},p(e,[t]){if(7&t){let a;for(r=Object.entries(e[0].opts()),a=0;a<r.length;a+=1){const s=Wo(e,r,a);o[a]?o[a].p(s,t):(o[a]=Zo(s),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}},i:t,o:t,d(e){P(o,e),e&&w(n)}}}function ea(e,t,n){let{bot:r}=t,o={};for(let[e,t]of Object.entries(r.opts()))o[e]=t.value;return e.$set=e=>{"bot"in e&&n(0,r=e.bot)},[r,o,function(){for(let[e,t]of Object.entries(o))r.setOpt(e,t)},function(e){o[e]=function(e){return""===e?void 0:+e}(this.value),n(1,o),n(0,r)},function(e){o[e]=this.checked,n(1,o),n(0,r)}]}class ta extends $e{constructor(e){var t;super(),document.getElementById("svelte-7cel4i-style")||((t=k("style")).id="svelte-7cel4i-style",t.textContent="label.svelte-7cel4i{font-weight:bold;color:#999}.option.svelte-7cel4i{margin-bottom:20px}.value.svelte-7cel4i{font-weight:bold}input[type='checkbox'].svelte-7cel4i{vertical-align:middle}",$(document.head,t)),be(this,e,ea,Qo,i,{bot:0})}}function na({game:e,isClient:t}){return e=nn(e),(n=null,r)=>{switch(r.type){case"GAME_EVENT":{if(n={...n,deltalog:[]},t)return n;if(void 0!==n.ctx.gameover)return Ht("cannot call event after game end"),n;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!e.flow.isPlayerActive(n.G,n.ctx,r.payload.playerID))return Ht(`disallowed event: ${r.payload.type}`),n;n=Ut(n,{game:e,isClient:!1,playerID:r.payload.playerID});let o=e.flow.processEvent(n,r);return o=Kt(o,{game:e,isClient:!1}),{...o,_stateID:n._stateID+1}}case"MAKE_MOVE":{n={...n,deltalog:[]};const o=e.flow.getMove(n.ctx,r.payload.type,r.payload.playerID||n.ctx.currentPlayer);if(null===o)return Ht(`disallowed move: ${r.payload.type}`),n;if(t&&!1===o.client)return n;if(void 0!==n.ctx.gameover)return Ht("cannot make move after game end"),n;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!e.flow.isPlayerActive(n.G,n.ctx,r.payload.playerID))return Ht(`disallowed move: ${r.payload.type}`),n;n=Ut(n,{game:e,isClient:t,playerID:r.payload.playerID});let a=e.processMove(n,r.payload);if("INVALID_MOVE"===a)return Ht(`invalid move: ${r.payload.type} args: ${r.payload.args}`),n;let s={action:r,_stateID:n._stateID,turn:n.ctx.turn,phase:n.ctx.phase};!0===o.redact&&(s.redact=!0);const l={...n,G:a,deltalog:[s],_stateID:n._stateID+1};if(t&&((e,t)=>[...Lt,...t.game.plugins].filter(e=>void 0!==e.noClient).map(n=>{const r=n.name,o=e.plugins[r];return!!o&&n.noClient({G:e.G,ctx:e.ctx,game:t.game,api:o.api,data:o.data})}).some(e=>!0===e))(l,{game:e}))return n;if(n=l,t)return n=Kt(n,{game:e,isClient:!0});const i=n.ctx.turn;return n=e.flow.processMove(n,r.payload),(n=Kt(n,{game:e})).ctx.turn!==i||e.disableUndo||(n._undo=n._undo.concat({G:n.G,ctx:n.ctx,moveType:r.payload.type})),n._redo=[],n}case"RESET":case"UPDATE":case"SYNC":return r.state;case"UNDO":{if(e.disableUndo)return Ht("Undo is not enabled"),n;const{_undo:t,_redo:l}=n;if(t.length<2)return n;const i=t[t.length-1],c=t[t.length-2],u=e.flow.getMove(c.ctx,i.moveType,r.payload.playerID);return o=n.G,a=n.ctx,!function(e){return void 0!==e.undoable}(s=u)||(s.undoable instanceof Function?s.undoable(o,a):s.undoable)?{...n,G:c.G,ctx:c.ctx,_undo:t.slice(0,t.length-1),_redo:[i,...l]}:n}case"REDO":{const{_undo:t,_redo:r}=n;if(e.disableUndo)return Ht("Redo is not enabled"),n;if(0==r.length)return n;const o=r[0];return{...n,G:o.G,ctx:o.ctx,_undo:[...t,o],_redo:r.slice(1)}}case"PLUGIN":return((e,t,n)=>(n.game.plugins.filter(e=>void 0!==e.action).filter(e=>e.name===t.payload.type).forEach(n=>{const r=n.name,o=e.plugins[r]||{data:{}},a=n.action(o.data,t.payload);e={...e,plugins:{...e.plugins,[r]:{...o,data:a}}}}),e))(n,r,{game:e});default:return n}var o,a,s}}class ra{constructor({enumerate:e,seed:t}){this.enumerateFn=e,this.seed=t,this.iterationCounter=0,this._opts={}}addOpt({key:e,range:t,initial:n}){this._opts[e]={range:t,value:n}}getOpt(e){return this._opts[e].value}setOpt(e,t){e in this._opts&&(this._opts[e].value=t)}opts(){return this._opts}enumerate(e,t,n){return this.enumerateFn(e,t,n).map(e=>"payload"in e?e:"move"in e?_e(e.move,e.args,n):"event"in e?Se(e.event,e.args,n):void 0)}random(e){let t;if(void 0!==this.seed){let e=null;e=this.prngstate?new Gt("",{state:this.prngstate}):new Gt(this.seed,{state:!0}),t=e(),this.prngstate=e.state()}else t=Math.random();if(e){if(Array.isArray(e)){return e[Math.floor(t*e.length)]}return Math.floor(t*e)}return t}}class oa extends ra{constructor({enumerate:e,seed:t,objectives:n,game:r,iterations:o,playoutDepth:a,iterationCallback:s}){super({enumerate:e,seed:t}),void 0===n&&(n=()=>({})),this.objectives=n,this.iterationCallback=s||(()=>{}),this.reducer=na({game:r}),this.iterations=o,this.playoutDepth=a,this.addOpt({key:"async",initial:!1}),this.addOpt({key:"iterations",initial:"number"==typeof o?o:1e3,range:{min:1,max:2e3}}),this.addOpt({key:"playoutDepth",initial:"number"==typeof a?a:50,range:{min:1,max:100}})}createNode({state:e,parentAction:t,parent:n,playerID:r}){const{G:o,ctx:a}=e;let s=[],l=[];if(void 0!==r)s=this.enumerate(o,a,r),l=this.objectives(o,a,r);else if(a.activePlayers)for(let e in a.activePlayers)s=s.concat(this.enumerate(o,a,e)),l=l.concat(this.objectives(o,a,e));else s=s.concat(this.enumerate(o,a,a.currentPlayer)),l=l.concat(this.objectives(o,a,a.currentPlayer));return{state:e,parent:n,parentAction:t,actions:s,objectives:l,children:[],visits:0,value:0}}select(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;let t=null,n=0;for(const r of e.children){const o=r.visits+Number.EPSILON,a=r.value/o+Math.sqrt(2*Math.log(e.visits)/o);(null==t||a>n)&&(n=a,t=r)}return this.select(t)}expand(e){const t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;const n=this.random(t.length),r=t[n];e.actions.splice(n,1);const o=this.reducer(e.state,r),a=this.createNode({state:o,parentAction:r,parent:e});return e.children.push(a),a}playout({state:e}){let t=this.getOpt("playoutDepth");"function"==typeof this.playoutDepth&&(t=this.playoutDepth(e.G,e.ctx));for(let n=0;n<t&&void 0===e.ctx.gameover;n++){const{G:t,ctx:n}=e;let r=n.currentPlayer;n.activePlayers&&(r=Object.keys(n.activePlayers)[0]);const o=this.enumerate(t,n,r),a=this.objectives(t,n,r),s=Object.keys(a).reduce((e,r)=>{const o=a[r];return o.checker(t,n)?e+o.weight:e},0);if(s>0)return{score:s};if(!o||0==o.length)return;const l=this.random(o.length);e=this.reducer(e,o[l])}return e.ctx.gameover}backpropagate(e,t={}){e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}play(e,t){const n=this.createNode({state:e,playerID:t});let r=this.getOpt("iterations");"function"==typeof this.iterations&&(r=this.iterations(e.G,e.ctx));const o=()=>{let e=null;for(const t of n.children)(null==e||t.visits>e.visits)&&(e=t);return{action:e&&e.parentAction,metadata:n}};return new Promise(e=>{const t=()=>{for(let e=0;e<25&&this.iterationCounter<r;e++){const e=this.select(n),t=this.expand(e),r=this.playout(t);this.backpropagate(t,r),this.iterationCounter++}this.iterationCallback({iterationCounter:this.iterationCounter,numIterations:r,metadata:n})};if(this.iterationCounter=0,this.getOpt("async")){const n=()=>{this.iterationCounter<r?(t(),setTimeout(n,0)):e(o())};n()}else{for(;this.iterationCounter<r;)t();e(o())}})}}class aa extends ra{play({G:e,ctx:t},n){const r=this.enumerate(e,t,n);return Promise.resolve({action:this.random(r)})}}async function sa(e,t){const n=e.store.getState();let r=n.ctx.currentPlayer;n.ctx.activePlayers&&(r=Object.keys(n.ctx.activePlayers)[0]);const{action:o,metadata:a}=await t.play(n,r);if(o){const t={...o,payload:{...o.payload,metadata:a}};return e.store.dispatch(t),t}}function la(e,t,n){const r=e.slice();return r[7]=t[n],r}function ia(e){let n,r,o;return{c(){n=k("p"),n.textContent="No bots available.",r=I(),o=k("p"),o.innerHTML='Follow the instructions\n        <a href="https://boardgame.io/documentation/#/tutorial?id=bots" target="_blank">here</a>\n        to set up bots.'},m(e,t){x(e,n,t),x(e,r,t),x(e,o,t)},p:t,i:t,o:t,d(e){e&&w(n),e&&w(r),e&&w(o)}}}function ca(e){let n;return{c(){n=k("p"),n.textContent="The bot debugger is only available in singleplayer mode."},m(e,t){x(e,n,t)},p:t,i:t,o:t,d(e){e&&w(n)}}}function ua(e){let t,n,r,o,a,l,i,c,u,d,p,f,y,m,v,h,g,b,E,O,_,S,z=Object.keys(e[7].opts()).length;a=new hr({props:{value:"1",onPress:e[13],label:"reset"}}),c=new hr({props:{value:"2",onPress:e[11],label:"play"}}),p=new hr({props:{value:"3",onPress:e[12],label:"simulate"}});let M=Object.keys(e[8]),N=[];for(let t=0;t<M.length;t+=1)N[t]=da(la(e,M,t));let q=z&&pa(e),G=(e[5]||e[3])&&fa(e);return{c(){t=k("section"),n=k("h3"),n.textContent="Controls",r=I(),o=k("li"),me(a.$$.fragment),l=I(),i=k("li"),me(c.$$.fragment),u=I(),d=k("li"),me(p.$$.fragment),f=I(),y=k("section"),m=k("h3"),m.textContent="Bot",v=I(),h=k("select");for(let e=0;e<N.length;e+=1)N[e].c();g=I(),q&&q.c(),b=I(),G&&G.c(),E=A(),D(n,"class","svelte-hsd9fq"),D(o,"class","svelte-hsd9fq"),D(i,"class","svelte-hsd9fq"),D(d,"class","svelte-hsd9fq"),D(m,"class","svelte-hsd9fq"),void 0===e[4]&&ee(()=>e[15].call(h))},m(s,w){x(s,t,w),$(t,n),$(t,r),$(t,o),ve(a,o,null),$(t,l),$(t,i),ve(c,i,null),$(t,u),$(t,d),ve(p,d,null),x(s,f,w),x(s,y,w),$(y,m),$(y,v),$(y,h);for(let e=0;e<N.length;e+=1)N[e].m(h,null);C(h,e[4]),x(s,g,w),q&&q.m(s,w),x(s,b,w),G&&G.m(s,w),x(s,E,w),O=!0,_||(S=[j(h,"change",e[15]),j(h,"change",e[10])],_=!0)},p(e,t){if(256&t){let n;for(M=Object.keys(e[8]),n=0;n<M.length;n+=1){const r=la(e,M,n);N[n]?N[n].p(r,t):(N[n]=da(r),N[n].c(),N[n].m(h,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=M.length}272&t&&C(h,e[4]),128&t&&(z=Object.keys(e[7].opts()).length),z?q?(q.p(e,t),128&t&&de(q,1)):(q=pa(e),q.c(),de(q,1),q.m(b.parentNode,b)):q&&(ce(),pe(q,1,1,()=>{q=null}),ue()),e[5]||e[3]?G?G.p(e,t):(G=fa(e),G.c(),G.m(E.parentNode,E)):G&&(G.d(1),G=null)},i(e){O||(de(a.$$.fragment,e),de(c.$$.fragment,e),de(p.$$.fragment,e),de(q),O=!0)},o(e){pe(a.$$.fragment,e),pe(c.$$.fragment,e),pe(p.$$.fragment,e),pe(q),O=!1},d(e){e&&w(t),he(a),he(c),he(p),e&&w(f),e&&w(y),P(N,e),e&&w(g),q&&q.d(e),e&&w(b),G&&G.d(e),e&&w(E),_=!1,s(S)}}}function da(e){let n,r,o,a=e[7]+"";return{c(){n=k("option"),r=O(a),n.__value=o=e[7],n.value=n.__value},m(e,t){x(e,n,t),$(n,r)},p:t,d(e){e&&w(n)}}}function pa(e){let t,n,r,o,a,l,i,c,u,d,p;return c=new ta({props:{bot:e[7]}}),{c(){t=k("section"),n=k("h3"),n.textContent="Options",r=I(),o=k("label"),o.textContent="debug",a=I(),l=k("input"),i=I(),me(c.$$.fragment),D(n,"class","svelte-hsd9fq"),D(o,"class","svelte-hsd9fq"),D(l,"type","checkbox"),D(l,"class","svelte-hsd9fq")},m(s,f){x(s,t,f),$(t,n),$(t,r),$(t,o),$(t,a),$(t,l),l.checked=e[1],$(t,i),ve(c,t,null),u=!0,d||(p=[j(l,"change",e[16]),j(l,"change",e[9])],d=!0)},p(e,t){2&t&&(l.checked=e[1]);const n={};128&t&&(n.bot=e[7]),c.$set(n)},i(e){u||(de(c.$$.fragment,e),u=!0)},o(e){pe(c.$$.fragment,e),u=!1},d(e){e&&w(t),he(c),d=!1,s(p)}}}function fa(e){let t,n,r,o,a=e[2]&&e[2]<1&&ya(e),s=e[5]&&ma(e);return{c(){t=k("section"),n=k("h3"),n.textContent="Result",r=I(),a&&a.c(),o=I(),s&&s.c(),D(n,"class","svelte-hsd9fq")},m(e,l){x(e,t,l),$(t,n),$(t,r),a&&a.m(t,null),$(t,o),s&&s.m(t,null)},p(e,n){e[2]&&e[2]<1?a?a.p(e,n):(a=ya(e),a.c(),a.m(t,o)):a&&(a.d(1),a=null),e[5]?s?s.p(e,n):(s=ma(e),s.c(),s.m(t,null)):s&&(s.d(1),s=null)},d(e){e&&w(t),a&&a.d(),s&&s.d()}}}function ya(e){let t;return{c(){t=k("progress"),t.value=e[2]},m(e,n){x(e,t,n)},p(e,n){4&n&&(t.value=e[2])},d(e){e&&w(t)}}}function ma(e){let t,n,r,o,a,s,l,i=JSON.stringify(e[6])+"";return{c(){t=k("li"),n=O("Action: "),r=O(e[5]),o=I(),a=k("li"),s=O("Args: "),l=O(i),D(t,"class","svelte-hsd9fq"),D(a,"class","svelte-hsd9fq")},m(e,i){x(e,t,i),$(t,n),$(t,r),x(e,o,i),x(e,a,i),$(a,s),$(a,l)},p(e,t){32&t&&_(r,e[5]),64&t&&i!==(i=JSON.stringify(e[6])+"")&&_(l,i)},d(e){e&&w(t),e&&w(o),e&&w(a)}}}function va(e){let t,n,r,o,a,s;const l=[ua,ca,ia],i=[];function c(e,t){return e[0].game.ai&&!e[0].multiplayer?0:e[0].multiplayer?1:2}return n=c(e),r=i[n]=l[n](e),{c(){t=k("section"),r.c()},m(r,l){x(r,t,l),i[n].m(t,null),o=!0,a||(s=j(window,"keydown",e[14]),a=!0)},p(e,[o]){let a=n;n=c(e),n===a?i[n].p(e,o):(ce(),pe(i[a],1,1,()=>{i[a]=null}),ue(),r=i[n],r||(r=i[n]=l[n](e),r.c()),de(r,1),r.m(t,null))},i(e){o||(de(r),o=!0)},o(e){pe(r),o=!1},d(e){e&&w(t),i[n].d(),a=!1,s()}}}function ha(e,t,n){let{client:r}=t;const{secondaryPane:o}=F("secondaryPane"),a={MCTS:oa,Random:aa};let s=!1,l=null,i=0,c=null;const u=({iterationCounter:e,numIterations:t,metadata:r})=>{n(3,i=e),n(2,l=e/t),c=r,s&&c&&o.set({component:qo,metadata:c})};let d,p,f,y;function m(){r.overrideGameState(null),o.set(null),n(1,s=!1)}return r.game.ai&&(d=new oa({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u}),d.setOpt("async",!0)),R(m),e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,s,l,i,p,f,y,d,a,function(){s&&c?o.set({component:qo,metadata:c}):o.set(null)},function(){n(7,d=new(0,a[p])({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u})),d.setOpt("async",!0),n(5,f=null),c=null,o.set(null),n(3,i=0)},async function(){n(5,f=null),c=null,n(3,i=0);const e=await sa(r,d);e&&(n(5,f=e.payload.type),n(6,y=e.payload.args))},function(e=1e4,t=100){return n(5,f=null),c=null,n(3,i=0),(async()=>{for(let n=0;n<e;n++){if(!await sa(r,d))break;await new Promise(e=>setTimeout(e,t))}})()},function(){r.reset(),n(5,f=null),c=null,n(3,i=0),m()},function(e){27==e.keyCode&&m()},function(){p=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(4,p),n(8,a)},function(){s=this.checked,n(1,s)}]}class ga extends $e{constructor(e){var t;super(),document.getElementById("svelte-hsd9fq-style")||((t=k("style")).id="svelte-hsd9fq-style",t.textContent="li.svelte-hsd9fq{list-style:none;margin:none;margin-bottom:5px}h3.svelte-hsd9fq{text-transform:uppercase}label.svelte-hsd9fq{font-weight:bold;color:#999}input[type='checkbox'].svelte-hsd9fq{vertical-align:middle}",$(document.head,t)),be(this,e,ha,va,i,{client:0})}}function ba(e){let t,n,r,o,a,s,l,i;n=new pn({props:{panes:e[4],pane:e[1]}}),n.$on("change",e[6]);var c=e[4][e[1]].component;function u(e){return{props:{client:e[0]}}}c&&(a=new c(u(e)));let d=e[3]&&$a(e);return{c(){t=k("div"),me(n.$$.fragment),r=I(),o=k("div"),a&&me(a.$$.fragment),s=I(),d&&d.c(),D(o,"class","pane svelte-1a0kmkk"),D(t,"class","debug-panel svelte-1a0kmkk")},m(e,l){x(e,t,l),ve(n,t,null),$(t,r),$(t,o),a&&ve(a,o,null),$(t,s),d&&d.m(t,null),i=!0},p(e,r){const s={};2&r&&(s.pane=e[1]),n.$set(s);const l={};if(1&r&&(l.client=e[0]),c!==(c=e[4][e[1]].component)){if(a){ce();const e=a;pe(e.$$.fragment,1,0,()=>{he(e,1)}),ue()}c?(a=new c(u(e)),me(a.$$.fragment),de(a.$$.fragment,1),ve(a,o,null)):a=null}else c&&a.$set(l);e[3]?d?(d.p(e,r),8&r&&de(d,1)):(d=$a(e),d.c(),de(d,1),d.m(t,null)):d&&(ce(),pe(d,1,1,()=>{d=null}),ue())},i(e){i||(de(n.$$.fragment,e),a&&de(a.$$.fragment,e),de(d),ee(()=>{l||(l=ye(t,sn,{x:400},!0)),l.run(1)}),i=!0)},o(e){pe(n.$$.fragment,e),a&&pe(a.$$.fragment,e),pe(d),l||(l=ye(t,sn,{x:400},!1)),l.run(0),i=!1},d(e){e&&w(t),he(n),a&&he(a),d&&d.d(),e&&l&&l.end()}}}function $a(e){let t,n,r;var o=e[3].component;function a(e){return{props:{metadata:e[3].metadata}}}return o&&(n=new o(a(e))),{c(){t=k("div"),n&&me(n.$$.fragment),D(t,"class","secondary-pane svelte-1a0kmkk")},m(e,o){x(e,t,o),n&&ve(n,t,null),r=!0},p(e,r){const s={};if(8&r&&(s.metadata=e[3].metadata),o!==(o=e[3].component)){if(n){ce();const e=n;pe(e.$$.fragment,1,0,()=>{he(e,1)}),ue()}o?(n=new o(a(e)),me(n.$$.fragment),de(n.$$.fragment,1),ve(n,t,null)):n=null}else o&&n.$set(s)},i(e){r||(n&&de(n.$$.fragment,e),r=!0)},o(e){n&&pe(n.$$.fragment,e),r=!1},d(e){e&&w(t),n&&he(n)}}}function xa(e){let t,n,r,o,a=e[2]&&ba(e);return{c(){a&&a.c(),t=A()},m(s,l){a&&a.m(s,l),x(s,t,l),n=!0,r||(o=j(window,"keypress",e[7]),r=!0)},p(e,[n]){e[2]?a?(a.p(e,n),4&n&&de(a,1)):(a=ba(e),a.c(),de(a,1),a.m(t.parentNode,t)):a&&(ce(),pe(a,1,1,()=>{a=null}),ue())},i(e){n||(de(a),n=!0)},o(e){pe(a),n=!1},d(e){a&&a.d(e),e&&w(t),r=!1,o()}}}function wa(e,t,n){let r,{client:o}=t;const a={main:{label:"Main",shortcut:"m",component:Kr},log:{label:"Log",shortcut:"l",component:Ho},info:{label:"Info",shortcut:"i",component:Zr},ai:{label:"AI",shortcut:"a",component:ga}},s=on(!1),l=on(null);u(e,l,e=>n(3,r=e)),K("hotkeys",{disableHotkeys:s}),K("secondaryPane",{secondaryPane:l});let i="main";let c=!0;return e.$set=e=>{"client"in e&&n(0,o=e.client)},[o,i,c,r,a,l,function(e){n(1,i=e.detail)},function(e){"."!=e.key?c&&Object.entries(a).forEach(([t,{shortcut:r}])=>{e.key==r&&n(1,i=t)}):n(2,c=!c)}]}class Pa extends $e{constructor(e){var t;super(),document.getElementById("svelte-1a0kmkk-style")||((t=k("style")).id="svelte-1a0kmkk-style",t.textContent=".debug-panel.svelte-1a0kmkk{position:fixed;color:#555;font-family:monospace;display:flex;flex-direction:row;text-align:left;right:0;top:0;height:100%;font-size:14px;box-sizing:border-box;opacity:0.9;z-index:99999}.pane.svelte-1a0kmkk{flex-grow:2;overflow-x:hidden;overflow-y:scroll;background:#fefefe;padding:20px;border-left:1px solid #ccc;box-shadow:-1px 0 5px rgba(0, 0, 0, 0.2);box-sizing:border-box;width:280px}.secondary-pane.svelte-1a0kmkk{background:#fefefe;overflow-y:scroll}.debug-panel.svelte-1a0kmkk button,.debug-panel.svelte-1a0kmkk select{cursor:pointer;font-size:14px;font-family:monospace}.debug-panel.svelte-1a0kmkk select{background:#eee;border:1px solid #bbb;color:#555;padding:3px;border-radius:3px}.debug-panel.svelte-1a0kmkk section{margin-bottom:20px}",$(document.head,t)),be(this,e,wa,xa,i,{client:0})}}function ka({game:e,numPlayers:t,setupData:n}){t||(t=2);let r={G:{},ctx:(e=nn(e)).flow.ctx(t),plugins:{}};r=((e,t)=>([...Lt,...t.game.plugins].filter(e=>void 0!==e.setup).forEach(n=>{const r=n.name,o=n.setup({G:e.G,ctx:e.ctx,game:t.game});e={...e,plugins:{...e.plugins,[r]:{data:o}}}}),e))(r,{game:e}),r=Ut(r,{game:e,playerID:void 0});const o=Vt(r);r.G=e.setup(o,n);let a={...r,_undo:[],_redo:[],_stateID:0};return a=e.flow.init(a),a=Kt(a,{game:e}),a}function Ea(e,t,n,r,o,a){return t.reduce((t,s)=>(t[s]=function(...t){let l=r;if(!a&&null==r){l=n.getState().ctx.currentPlayer}n.dispatch(Le[e](s,t,l,o))},t),{})}const Oa=Ea.bind(null,"makeMove"),Ia=Ea.bind(null,"gameEvent"),Aa=Ea.bind(null,"plugin");class ja{constructor({game:e,debug:t,numPlayers:n,multiplayer:r,matchID:o,playerID:a,credentials:s,enhancer:l}){this.game=nn(e),this.playerID=a,this.matchID=o,this.credentials=s,this.multiplayer=r,this.debug=t,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=na({game:this.game,isClient:void 0!==r}),this.initialState=null,r||(this.initialState=ka({game:this.game,numPlayers:n})),this.reset=()=>{this.store.dispatch(Me(this.initialState))},this.undo=()=>{this.store.dispatch(Ne(this.playerID,this.credentials))},this.redo=()=>{this.store.dispatch(qe(this.playerID,this.credentials))},this.store=null,this.log=[];const i=e=>t=>n=>{const r=t(n),o=e.getState();switch(n.type){case"MAKE_MOVE":case"GAME_EVENT":{const e=o.deltalog;this.log=[...this.log,...e];break}case"RESET":this.log=[];break;case"UPDATE":{let e=-1;this.log.length>0&&(e=this.log[this.log.length-1]._stateID);let t=n.deltalog||[];t=t.filter(t=>t._stateID>e),this.log=[...this.log,...t];break}case"SYNC":this.initialState=n.initialState,this.log=n.log||[]}return r},c=e=>t=>n=>{const r=e.getState(),o=t(n);return"clientOnly"in n||this.transport.onAction(r,n),o},u=()=>e=>t=>{const n=e(t);return this.notifySubscribers(),n};l=void 0!==l?je(De(u,c,i),l):De(u,c,i),this.store=Ee(this.reducer,this.initialState,l),this.transport={isConnected:!0,onAction:()=>{},subscribe:()=>{},subscribeMatchData:()=>{},connect:()=>{},disconnect:()=>{},updateMatchID:()=>{},updatePlayerID:()=>{}},r&&(this.transport=r({gameKey:e,game:this.game,store:this.store,matchID:o,playerID:a,gameName:this.game.name,numPlayers:n})),this.createDispatchers(),this.transport.subscribeMatchData(e=>{this.matchData=e}),this._debugPanel=null}notifySubscribers(){Object.values(this.subscribers).forEach(e=>e(this.getState()))}overrideGameState(e){this.gameStateOverride=e,this.notifySubscribers()}start(){this.transport.connect(),this._running=!0;let e=null;if(e=Pa,this.debug&&!0!==this.debug&&this.debug.impl&&(e=this.debug.impl),null!==e&&!1!==this.debug&&null==this._debugPanel&&"undefined"!=typeof document){let t=document.body;this.debug&&!0!==this.debug&&void 0!==this.debug.target&&(t=this.debug.target),t&&(this._debugPanel=new e({target:t,props:{client:this}}))}}stop(){this.transport.disconnect(),this._running=!1,null!=this._debugPanel&&(this._debugPanel.$destroy(),this._debugPanel=null)}subscribe(e){const t=Object.keys(this.subscribers).length;return this.subscribers[t]=e,this.transport.subscribe(()=>this.notifySubscribers()),!this._running&&this.multiplayer||e(this.getState()),()=>{delete this.subscribers[t]}}getInitialState(){return this.initialState}getState(){let e=this.store.getState();if(null!==this.gameStateOverride&&(e=this.gameStateOverride),null===e)return e;let t=!0;const n=this.game.flow.isPlayerActive(e.G,e.ctx,this.playerID);this.multiplayer&&!n&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||n||(t=!1),void 0!==e.ctx.gameover&&(t=!1);const r=this.game.playerView(e.G,e.ctx,this.playerID);return{...e,G:r,log:this.log,isActive:t,isConnected:this.transport.isConnected}}createDispatchers(){this.moves=Oa(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Ia(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer),this.plugins=Aa(this.game.pluginNames,this.store,this.playerID,this.credentials,this.multiplayer)}updatePlayerID(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e),this.notifySubscribers()}updateMatchID(e){this.matchID=e,this.createDispatchers(),this.transport.updateMatchID(e),this.notifySubscribers()}updateCredentials(e){this.credentials=e,this.createDispatchers(),this.notifySubscribers()}}const Da=(e,t)=>{if(!e||"string"!=typeof e)throw new Error(`Expected ${t} string, got "${e}".`)},_a=e=>Da(e,"game name"),Sa=e=>Da(e,"match ID"),Ca=(e,t)=>{if(!e)throw new Error(`Expected body, got “${e}”.`);for(const n in t){const r=t[n],o=e[n];if(typeof o!==r)throw new Error(`Expected body.${n} to be of type ${r}, got “${o}”.`)}};e.Client=function(e){return new ja(e)},e.LobbyClient=class{constructor({server:e=""}={}){this.server=e.replace(/\/$/,"")}async request(e,t){const n=await fetch(this.server+e,t);if(!n.ok)throw new Error(`HTTP status ${n.status}`);return n.json()}async post(e,t){let n={method:"post",body:JSON.stringify(t.body),headers:{"Content-Type":"application/json"}};return t.init&&(n={...n,...t.init,headers:{...n.headers,...t.init.headers}}),this.request(e,n)}async listGames(e){return this.request("/games",e)}async listMatches(e,t,n){_a(e);let r="";if(t){const e=[],{isGameover:n,updatedBefore:o,updatedAfter:a}=t;void 0!==n&&e.push(`isGameover=${n}`),o&&e.push(`updatedBefore=${o}`),a&&e.push(`updatedAfter=${a}`),e.length&&(r="?"+e.join("&"))}return this.request(`/games/${e}${r}`,n)}async getMatch(e,t,n){return _a(e),Sa(t),this.request(`/games/${e}/${t}`,n)}async createMatch(e,t,n){return _a(e),Ca(t,{numPlayers:"number"}),this.post(`/games/${e}/create`,{body:t,init:n})}async joinMatch(e,t,n,r){return _a(e),Sa(t),Ca(n,{playerID:"string",playerName:"string"}),this.post(`/games/${e}/${t}/join`,{body:n,init:r})}async leaveMatch(e,t,n,r){_a(e),Sa(t),Ca(n,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${t}/leave`,{body:n,init:r})}async updatePlayer(e,t,n,r){_a(e),Sa(t),Ca(n,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${t}/update`,{body:n,init:r})}async playAgain(e,t,n,r){return _a(e),Sa(t),Ca(n,{playerID:"string",credentials:"string"}),this.post(`/games/${e}/${t}/playAgain`,{body:n,init:r})}},Object.defineProperty(e,"__esModule",{value:!0})}));
