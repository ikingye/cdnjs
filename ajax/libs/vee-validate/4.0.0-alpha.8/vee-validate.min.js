/**
  * vee-validate vundefined
  * (c) 2020 Abdelrahman Awad
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VeeValidate={},e.Vue)}(this,(function(e,t){"use strict";function r(e){return"function"==typeof e}const a=e=>null!==e&&e&&"object"==typeof e&&!Array.isArray(e),n={};function i(e){return r(e)&&!!e.__locatorRef}function u(e){return e&&r(e.validate)}function s(e){return"checkbox"===e||"radio"===e}function l(e){return`v_${e}_error`}function o(e){if(!(t=e)||!("undefined"!=typeof Event&&r(Event)&&t instanceof Event||t&&t.srcElement))return e;var t;const a=e.target;return"file"===a.type&&a.files?Array.from(a.files):a.value}function d(e){return t.isRef(e)?e.value:e}function c(e){return t.computed(()=>Object.keys(e).reduce((t,r)=>(t[r]=e[r].value,t),{}))}function v(e){const t={};return Object.defineProperty(t,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?r(e)||u(e)||a(e)&&e._$$isNormalized?e:a(e)?Object.keys(e).reduce((t,r)=>{const n=function(e){if(!0===e)return[];if(Array.isArray(e))return e;if(a(e))return e;return[e]}(e[r]);return!1!==e[r]&&(t[r]=f(n)),t},t):"string"!=typeof e?t:e.split("|").reduce((e,t)=>{const r=m(t);return r.name?(e[r.name]=f(r.params),e):e},t):t}function f(e){const t=e=>"string"==typeof e&&"@"===e[0]?function(e){const t=t=>t[e];return t.__locatorRef=e,t}(e.slice(1)):e;return Array.isArray(e)?e.map(t):Object.keys(e).reduce((r,a)=>(r[a]=t(e[a]),r),{})}const m=e=>{let t=[];const r=e.split(":")[0];return e.includes(":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:r,params:t}};const p=(e,t)=>e.slots.default&&e.slots.default(t)||[];let h=Object.assign({},{generateMessage:({field:e})=>e+" is not valid.",bails:!0});const y=()=>h;async function b(e,t,a={}){const n=null==a?void 0:a.bails,i=null==a?void 0:a.skipIfEmpty,s={name:(null==a?void 0:a.name)||"{field}",rules:v(t),bails:null==n||n,skipIfEmpty:null==i||i,forceRequired:!1,crossTable:(null==a?void 0:a.values)||{}},l=await async function(e,t){if(r(e.rules)){const r=await e.rules(t);return{errors:"string"!=typeof r&&r?[]:[r]}}if(u(e.rules))return async function(e,t){return{errors:await e.rules.validate(t,{abortEarly:e.bails}).then(()=>[]).catch(e=>{if("ValidationError"===e.name)return e.errors;throw e})}}(e,t);const a=[],n=Object.keys(e.rules),i=n.length;for(let r=0;r<i;r++){const i=n[r],u=await g(e,t,{name:i,params:e.rules[i]});if(u.error&&(a.push(u.error),e.bails))return{errors:a}}return{errors:a}}(s,e);return{errors:l.errors}}async function g(e,t,r){const a=(u=r.name,n[u]);var u;if(!a)throw new Error(`No such validator '${r.name}' exists.`);const s=function(e,t){const r=e=>i(e)?e(t):e;if(Array.isArray(e))return e.map(r);return Object.keys(e).reduce((t,a)=>(t[a]=r(e[a]),t),{})}(r.params,e.crossTable),l={field:e.name,value:t,form:e.crossTable,rule:r},o=await a(t,s,l);return"string"==typeof o?{error:o}:{error:o?void 0:j(l)}}function j(e){return(0,y().generateMessage)(e)}function O(e,a,n){const{initialValue:u,form:c,immediate:f,bails:m,disabled:p,type:h,valueProp:y}=function(e){const r=t.inject("$_veeForm",void 0),a=()=>({initialValue:void 0,immediate:!1,bails:!0,rules:"",disabled:!1,form:r});if(!e)return a();return Object.assign(Object.assign({},a()),e||{})}(n),{meta:g,errors:j,onBlur:O,handleChange:S,reset:A,patch:V,value:E}=function(e,r,a){const n=t.ref([]),{onBlur:i,reset:u,meta:s}=function(){const e=()=>({untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:!1,invalid:!1,validated:!1,pending:!1,changed:!1,passed:!1,failed:!1}),r=t.reactive(e()),a=t.computed(()=>r.valid&&r.validated),n=t.computed(()=>r.invalid&&r.validated),i=()=>{r.touched=!0,r.untouched=!1};function u(){const t=e();Object.keys(r).forEach(e=>{"passed"!==e&&"failed"!==e&&(r[e]=t[e])})}return{meta:Object.assign(Object.assign({},t.toRefs(r)),{passed:a,failed:n}),onBlur:i,reset:u}}(),l=r,c=function(e,r,a){if(!a)return t.ref(e);const n=t.computed({get:()=>a.values[d(r)],set(e){a.setFieldValue(d(r),e)}});void 0!==e&&(n.value=e);return n}(l,e,a),v=e=>{c.value=o(e),s.dirty.value=!0,s.pristine.value=!1};function f(e){return n.value=e.errors,s.changed.value=l!==c.value,s.valid.value=!e.errors.length,s.invalid.value=!!e.errors.length,s.validated.value=!0,e}const m=()=>{n.value=[],u()};return{meta:s,errors:n,patch:f,reset:m,onBlur:i,handleChange:v,value:c}}(e,u,c),k=function(e,t){if(!e)return;return e[t]}(null==c?void 0:c.schema,d(e)),w=t.computed(()=>v(k||d(a))),x=async()=>{var t;if(g.pending.value=!0,!c||!c.validateSchema){const r=await b(E.value,w.value,{name:d(e),values:null!==(t=null==c?void 0:c.values)&&void 0!==t?t:{},bails:m});return g.valid.value=!r.errors.length,g.invalid.value=!!r.errors.length,g.pending.value=!1,r}const r=await c.validateSchema();return g.pending.value=!1,r[d(e)]},F=()=>x().then(V);t.onMounted(()=>{x().then(e=>{f&&V(e)})});const _=t.computed(()=>j.value[0]),R=function(e,r){return t.computed(()=>({"aria-invalid":r.failed.value?"true":"false","aria-describedBy":l(d(e))}))}(e,g),B=s(h)?t.computed(()=>Array.isArray(E.value)?E.value.includes(d(y)):d(y)===E.value):void 0,$={name:e,value:E,meta:g,errors:j,errorMessage:_,aria:R,reset:A,validate:F,handleChange:S,onBlur:O,disabled:p,setValidationState:V,type:h,valueProp:y,checked:B,idx:-1};if(t.watch(E,F,{deep:!0}),t.isRef(a)&&t.watch(a,F,{deep:!0}),!c)return $;c.register($),t.onBeforeUnmount(()=>{c.unregister($)});const C=t.computed(()=>{const e=w.value;return!e||r(e)||r(e.validate)?[]:Object.keys(e).reduce((e,t)=>{const r=(a=w.value[t],Array.isArray(a)?a.filter(i):Object.keys(a).filter(e=>i(a[e])).map(e=>a[e])).map(e=>e.__locatorRef);var a;return e.push(...r),e},[])});return t.watchEffect(()=>{C.value.length&&C.value.forEach(e=>{e in c.values&&g.validated.value&&F()})}),$}const S=t.defineComponent({name:"Field",inheritAttrs:!1,props:{as:{type:[String,Object],default:void 0},name:{type:String,required:!0},rules:{type:[Object,String,Function],default:null},immediate:{type:Boolean,default:!1},bails:{type:Boolean,default:()=>y().bails},disabled:{type:Boolean,default:!1}},setup(e,r){const a=e.name,n=t.computed(()=>e.disabled),i=t.computed(()=>e.rules),{errors:u,value:l,errorMessage:o,validate:d,handleChange:v,onBlur:f,reset:m,meta:h,aria:y,checked:b}=O(a,i,{immediate:e.immediate,bails:e.bails,disabled:n,type:r.attrs.type,initialValue:s(r.attrs.type)||"modelValue"in r.attrs?r.attrs.modelValue:r.attrs.value,valueProp:r.attrs.value}),g="modelValue"in r.attrs?function(e){v(e),r.emit("update:modelValue",l.value)}:v,j=c(h),S=t.computed(()=>{const t={name:a,disabled:e.disabled,onInput:g,onChange:g,"onUpdate:modelValue":g,onBlur:f};return s(r.attrs.type)&&b?(t.checked=b.value,delete t.onInput):t.value=l.value,{field:t,aria:y.value,meta:j.value,errors:u.value,errorMessage:o.value,validate:d,reset:m,handleChange:g}});return()=>{let a=e.as;e.as||r.slots.default||(a="input"),"modelValue"in r.attrs&&String(r.attrs.modelValue)!==String(l.value)&&t.nextTick(()=>{v(r.attrs.modelValue)});const n=p(r,S.value);return a?t.h(a,Object.assign(Object.assign(Object.assign({},r.attrs),S.value.field),function(e){return["input","textarea","select"].includes(e)}(a)?S.value.aria:{}),n):n}}});function A(e){const r=t.ref([]),a=t.ref(!1),n=t.computed(()=>r.value.reduce((e,t)=>{if(!e[t.name])return e[t.name]=t,t.idx=-1,e;if(!Array.isArray(e[t.name])){const r=e[t.name];r.idx=0,e[t.name]=[r]}return t.idx=e[t.name].length,e[t.name].push(t),e},{})),i=t.computed(()=>r.value.filter(e=>!d(e.disabled))),s=t.reactive({}),l=t.computed(()=>i.value.reduce((e,t)=>(e[t.name]=s[t.name],e),{})),o={register(t){var a;const n=d(t.name);void 0!==(null===(a=null==e?void 0:e.initialValues)||void 0===a?void 0:a[n])&&(s[n]=null==e?void 0:e.initialValues[n]),r.value.push(t)},unregister(e){var t,a;const n=r.value.indexOf(e);if(-1===n)return;r.value.splice(n,1);const i=d(e.name);if(-1===e.idx)return void delete s[i];const u=null===(a=null===(t=s[i])||void 0===t?void 0:t.indexOf)||void 0===a?void 0:a.call(t,d(e.valueProp));void 0!==u?-1!==u&&s[i].splice(u,1):delete s[i]},fields:n,values:s,schema:null==e?void 0:e.validationSchema,validateSchema:u(null==e?void 0:e.validationSchema)?(e=!1)=>async function(e,t=!1){const r=await e.schema.validate(e.values,{abortEarly:!1}).then(()=>[]).catch(e=>{if("ValidationError"!==e.name)throw e;return e.inner||[]}),a=e.fields.value,n=r.reduce((e,t)=>(e[t.path]=t,e),{});return Object.keys(a).reduce((e,r)=>{const i=a[r],u={errors:(n[r]||{errors:[]}).errors};e[r]=u;const s=Array.isArray(i),l=s?i.some(e=>e.meta.validated):i.meta.validated;return t||l?s?(i.forEach(e=>e.setValidationState(u)),e):(i.setValidationState(u),e):e},{})}(o,e):void 0,setFieldValue(e,t){const r=n.value[e];if(!r||!Array.isArray(r)&&"checkbox"!==r.type)return void(s[e]=t);if(Array.isArray(r)&&"checkbox"!==r[0].type)return void(s[e]=t);if(!Array.isArray(r)&&"checkbox"===r.type)return void(s[e]=s[e]===t?void 0:t);if(Array.isArray(t))return void(s[e]=t);const a=Array.isArray(s[e])?[...s[e]]:[];if(a.includes(t)){const r=a.indexOf(t);return a.splice(r,1),void(s[e]=a)}a.push(t),s[e]=a}},c=async()=>{if(o.validateSchema)return o.validateSchema(!0).then(e=>Object.keys(e).every(t=>!e[t].errors.length));return(await Promise.all(i.value.map(e=>e.validate()))).every(e=>!e.errors.length)},v=t.computed(()=>i.value.reduce((e,t)=>(e[t.name]=t.errorMessage,e),{})),f=e=>function(t){return t instanceof Event&&(t.preventDefault(),t.stopPropagation()),a.value=!0,c().then(r=>{if(r&&"function"==typeof e)return e(l.value,t)}).then(()=>{a.value=!1},e=>{throw a.value=!1,e})},m=f((e,t)=>{t&&t.target.submit()}),p=function(e){return Object.keys(V).reduce((r,a)=>(r[a]=t.computed(()=>{const t=V[a];return e.value[t](e=>e.meta[a])}),r),{})}(r);return t.provide("$_veeForm",o),t.provide("$_veeFormErrors",v),{errors:v,meta:p,form:o,values:l,validate:c,isSubmitting:a,handleReset:()=>{r.value.forEach(e=>e.reset())},handleSubmit:f,submitForm:m}}const V={valid:"every",invalid:"some",dirty:"some",pristine:"every",touched:"some",untouched:"every",pending:"some",validated:"every",changed:"some",passed:"every",failed:"some"};const E=t.defineComponent({name:"Form",inheritAttrs:!1,props:{as:{type:String,default:"form"},validationSchema:{type:Object,default:void 0},initialValues:{type:Object,default:void 0}},setup(e,r){const{errors:a,validate:n,handleSubmit:i,handleReset:u,values:s,meta:l,isSubmitting:o,submitForm:d}=A({validationSchema:e.validationSchema,initialValues:e.initialValues}),v=c(l),f=t.computed(()=>({meta:v.value,errors:a.value,values:s.value,isSubmitting:o.value,validate:n,handleSubmit:i,handleReset:u,submitForm:d})),m=r.attrs.onSubmit?i(r.attrs.onSubmit):d;function h(){u(),"function"==typeof r.attrs.onReset&&r.attrs.onReset()}return()=>{const a=p(r,f.value);if(!e.as)return a;const n="form"===e.as?{novalidate:!0}:{};return t.h(e.as,Object.assign(Object.assign(Object.assign({},n),r.attrs),{onSubmit:m,onReset:h}),a)}}}),k=t.defineComponent({props:{as:{type:String,default:void 0},name:{type:String,required:!0}},setup(e,r){const a=t.inject("$_veeFormErrors",void 0),n=t.computed(()=>a.value[e.name]);return()=>{const a=p(r,{message:n.value}),i=e.as,u=Object.assign({id:l(e.name),role:"alert"},r.attrs);return!i&&a.length?a:a.length?t.h(i,u,a):t.h(i||"span",u,n.value)}}});e.ErrorMessage=k,e.Field=S,e.Form=E,e.configure=e=>{var t;t=e,h=Object.assign(Object.assign({},h),t)},e.defineRule=function(e,t){!function(e,t){if(r(t))return;throw new Error(`Extension Error: The validator '${e}' must be a function.`)}(e,t),n[e]=t},e.useField=O,e.useForm=A,e.validate=b,Object.defineProperty(e,"__esModule",{value:!0})}));