const dna={version:"[VERSION]",clone:(e,a,n)=>{const t={...{fade:!1,top:!1,container:null,empty:!1,clones:1,html:!1,transform:null,callback:null},...n},d=dna.store.getTemplate(e);d.nested&&!t.container&&dna.core.berserk("Container missing for nested template",e),t.empty&&dna.empty(e);const l=[].concat(...Array(t.clones).fill(a));let s=$();return l.forEach((e,a)=>s=s.add(dna.core.replicate(d,e,a,t))),dna.placeholder.setup(),dna.panels.initialize(s.first().closest(".dna-panels")),s.first().parents(".dna-hide").removeClass("dna-hide").addClass("dna-unhide"),s},cloneSub:(e,a,n,t)=>{const d=dna.compile.subTemplateName(e,a),l=".dna-contains-"+d,s={container:e.find(l).addBack(l)},o=dna.clone(d,n,{...s,...t});return dna.core.updateArray(o),o},createTemplate:(e,a,n)=>($(a).attr({id:e}).addClass("dna-template").appendTo(n),dna.store.getTemplate(e)),getModel:(e,a)=>{return"string"==typeof e?(e=>{const a=[];return dna.getClones(e).each((e,n)=>a.push(dna.getModel($(n)))),a})(e):(e=>dna.getClone($(e),a).data("dnaModel"))(e)},empty:(e,a)=>{const n={...{fade:!1,callback:null},...a},t=dna.store.getTemplate(e),d=t.container.children(".dna-clone");t.container.data().dnaCountsMap&&(t.container.data().dnaCountsMap[e]=0);return n.fade?(()=>dna.ui.slideFadeDelete(d,n.callback))():dna.core.remove(d,n.callback)},insert:(e,a,n)=>{const t=dna.getClones(e).first();return t.length?dna.refresh(t,{data:a,html:n&&n.html}):dna.clone(e,a,n)},refresh:(e,a)=>{const n={...{html:!1},...a},t=dna.getClone(e,a),d=n.data?n.data:dna.getModel(t);return dna.core.inject(t,d,t.data().dnaCount,n)},refreshAll:(e,a)=>{return dna.getClones(e).each((e,n)=>dna.refresh($(n),a))},updateField:(e,a)=>{const n=e.data()&&e.data().dnaField;return n&&(e.is("input:checkbox")?e.prop("checked",a):e.is("input:radio")?e.prop("checked",a):e.is("input, select, textarea")&&e.val(a),dna.getModel(e)[n]=a),e},recount:(e,a)=>{return(e=dna.getClone(e)).length&&(()=>{const n=e.data().dnaRules.template,t=e.parent(),d=t.children(".dna-clone."+n).each((e,n)=>{(n=$(n)).data().dnaCount=e+1,dna.refresh(n,a)});t.data().dnaCountsMap=t.data().dnaCountsMap||{},t.data().dnaCountsMap[n]=d.length})(),e},destroy:(e,a)=>{const n={...{fade:!1,callback:null},...a};e=dna.getClone(e,a);const t=dna.core.getArrayName(e);t&&dna.getModel(e.parent())[t].splice(dna.getIndex(e),1);return n.fade?(()=>dna.ui.slideFadeDelete(e,n.callback))():dna.core.remove(e,n.callback)},getClone:(e,a)=>{const n={...{main:!1},...a}.main?".dna-clone:not(.dna-sub-clone)":".dna-clone";return e instanceof $?e.closest(n):$()},getClones:e=>dna.store.getTemplate(e).container.children(".dna-clone."+e),getIndex:(e,a)=>{const n=dna.getClone(e,a);return n.parent().children(".dna-clone."+n.data().dnaRules.template).index(n)},up:function(e,a){return dna.ui.smoothMoveUp(dna.getClone(dna.ui.toElem(e,this)),a)},down:function(e,a){return dna.ui.smoothMoveDown(dna.getClone(dna.ui.toElem(e,this)),a)},bye:function(e,a){const n=dna.ui.toElem(e,this),t={fade:!0,callback:"function"==typeof a?a:null};return dna.destroy(n,t)},registerInitializer:(e,a)=>{const n={...{onDocumentLoad:!0},...a};n.onDocumentLoad&&dna.util.apply(e,[(e=>e?$(e).not(".dna-template "+e).addClass("dna-initialized"):$(window.document))(n.selector)].concat(n.params));const t={func:e,selector:n.selector,params:n.params};return dna.events.initializers.push(t),dna.events.initializers},clearInitializers:()=>{dna.events.initializers=[]},registerContext:(e,a)=>(dna.events.context[e]=a,dna.events.context),info:()=>{const e=Object.keys(dna.store.templates),a=$(".dna-menu.dna-panels-initialized");return{version:dna.version,templates:e.length,clones:$(".dna-clone:not(.dna-sub-clone)").length,subs:$(".dna-sub-clone").length,names:e,store:dna.store.templates,initializers:dna.events.initializers,panels:a.toArray().map(e=>$(e).attr("data-nav"))}}};dna.array={find:(e,a,n)=>{n=n||"code";const t=Array.isArray(e);let d=0;if(t)for(;d<e.length&&e[d][n]!==a;)d++;return t&&d<e.length?{item:e[d],index:d}:{item:void 0,index:-1}},last:e=>Array.isArray(e)&&e.length?e[e.length-1]:void 0,fromMap:(e,a)=>{const n={...{key:"code",kebabCodes:!1},...a},t=[],d=e=>e instanceof Object?e:{value:e};for(let a in e)t[t.push(d(e[a]))-1][n.key]=n.kebabCodes?dna.util.toKebab(a):a;return t},toMap:(e,a)=>{const n={...{key:"code",camelKeys:!1},...a},t={};return e.forEach(n.camelKeys?e=>t[dna.util.toCamel(e[n.key])]=e:e=>t[e[n.key]]=e),t},wrap:e=>e?e instanceof Array?e:[e]:[]},dna.browser={getUrlParams:()=>{const e={};return window.location.search.slice(1).split("&").forEach(a=>a&&(a=>e[a.split("=")[0]]=a.split("=")[1])(a)),e}},dna.pageToken={put:(e,a)=>(window.sessionStorage[e+window.location.pathname]=JSON.stringify(a),a),get:(e,a)=>{const n=window.sessionStorage[e+window.location.pathname];return void 0===n?a:JSON.parse(n)}},dna.ui={deleteElem:function(e,a){return a="function"==typeof a?a:null,dna.core.remove(dna.ui.toElem(e,this),a)},focus:e=>e.trigger("focus"),getAttrs:e=>e[0]?Object.values(e[0].attributes):[],getComponent:e=>e.closest("[data-component]"),pulse:(e,a)=>{const n={...{duration:400,interval:null,out:5e3},...a},t={opacity:0},d={opacity:1};return e.stop(!0).slideDown().css(t).animate(d,n.duration),n.interval&&e.animate(d,n.interval).animate(t,n.out),e},slideFade:(e,a,n)=>{const t={opacity:1,transition:"opacity 400ms"},d={transition:"opacity 0s"};return n&&window.setTimeout(()=>e.css(t),200)?e.css({opacity:0,transition:"opacity 0s"}).hide().delay(100).slideDown(a):e.css({opacity:0,transition:"opacity 400ms"}).delay(100).slideUp(a),e.delay(200).promise().then(()=>e.css(d)),e},slideFadeIn:(e,a)=>dna.ui.slideFade(e,a,!0),slideFadeOut:(e,a)=>dna.ui.slideFade(e,a,!1),slideFadeToggle:(e,a)=>dna.ui.slideFade(e,a,e.is(":hidden")),slideFadeDelete:(e,a)=>dna.ui.slideFadeOut(e,()=>dna.ui.deleteElem(e,a)),smoothHeightSetBaseline:e=>{dna.ui.$container=e=e||$("body");const a=e.outerHeight();return e.css({minHeight:a,maxHeight:a,overflow:"hidden"})},smoothHeightAnimate:(e,a)=>{a=a||dna.ui.$container;window.setTimeout(()=>{a.css({minHeight:0,maxHeight:"100vh"});window.setTimeout(()=>a.css({transition:"none",maxHeight:"none"}),1e3)},e||50);return window.setTimeout(()=>a.css({transition:"all 1s"}),10),a},smoothMove:(e,a,n)=>{n="function"==typeof n?n:null;const t=a?e.prev():e.next();return t.length?(()=>{const d=t.clone(!0);a?e.after(t.hide()).before(d):e.before(t.hide()).after(d);let l=0;const s=()=>l++&&n&&n(e);window.setTimeout(()=>{dna.ui.slideFadeIn(t,s),dna.ui.slideFadeDelete(d,s)})})():n&&n(e),e},smoothMoveUp:(e,a)=>dna.ui.smoothMove(e,!0,a),smoothMoveDown:(e,a)=>dna.ui.smoothMove(e,!1,a),toElem:(e,a)=>{const n=e instanceof $&&e,t=e&&e.target;return n||$(t||e||a)}},dna.util={apply:(e,a)=>{const n=void 0===a?[]:[].concat(a),t=n[0];let d;const l=(a,s)=>{!a||1===s.length&&"function"!=typeof a[s[0]]?dna.core.berserk("Callback function not found",e):1===s.length?d=a[s[0]].apply(t,n):l(a[s[0]],s.slice(1))};return t instanceof $&&0===t.length?d=t:"function"==typeof e?d=e.apply(t,n):t&&t[e]?d=t[e](n[1],n[2],n[3]):""===e||{number:!0,boolean:!0}[typeof e]?dna.core.berserk("Invalid callback function",e):"string"==typeof e&&e.length>0&&(e=>{t instanceof $&&n.push(dna.ui.getComponent(t));const a=e[0],d=eval;/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(a)&&(e=>void 0===window[e]&&!dna.events.context[e])(a)&&(e=>["object","function"].includes(d("typeof "+e)))(a)&&dna.registerContext(a,d(a)),l(dna.events.context[a]?dna.events.context:window,e)})(e.split(".")),d},assign:(e,a,n)=>{const t="string"==typeof a?a.split("."):a,d=t[0],l=$.isPlainObject(e)?e:{};return 1===t.length?l[d]=n:dna.util.assign((()=>void 0===l[d]?l[d]={}:l[d])(),t.slice(1),n),l},printf:(e,...a)=>a.reduce((e,a)=>e.replace(/%s/,a),e),realTruth:e=>{return!!e&&(!(()=>e instanceof Array&&0===e.length)()&&!(()=>/^(f|false|n|no|0)$/i.test(e))())},toCamel:e=>{return(""+e).replace(/\-(.)/g,(e,a)=>a.toUpperCase())},toKebab:e=>{return(""+e).replace(/([A-Z]+)/g,e=>"-"+e.toLowerCase()).replace(/\s|^-/g,"")},value:(e,a)=>("string"==typeof a&&(a=a.split(".")),null==e||void 0===a?null:1===a.length?e[a[0]]:dna.util.value(e[a[0]],a.slice(1)))},dna.placeholder={setup:()=>{$("option.dna-template").closest("select").addClass("dna-hide");$("[data-placeholder]").each((e,a)=>{const n=$(a).stop(!0);return dna.getClones(n.data().placeholder).length?n.fadeOut():n.fadeIn()})}},dna.panels={display:(e,a,n)=>{const t=e.data().dnaPanels,d=e.data().nav,l=e.find(".menu-item"),s=(e=>Math.max(0,Math.min(e,l.length-1)))(void 0===a?dna.pageToken.get(d,0):a);e[0].selectedIndex=s,l.removeClass("selected").addClass("unselected"),l.eq(s).addClass("selected").removeClass("unselected"),t.hide().removeClass("displayed").addClass("hidden");const o=t.eq(s).fadeIn().addClass("displayed").removeClass("hidden"),r=o.data().hash;dna.pageToken.put(d,s),n&&r&&window.history.pushState(null,null,"#"+r),dna.util.apply(e.data().callback,[o,r])},clickRotate:e=>{const a=$(e.target).closest(".menu-item"),n=a.closest(".dna-menu");dna.panels.display(n,n.find(".menu-item").index(a),!0)},selectRotate:e=>{const a=$(e.target);dna.panels.display(a,a.find("option:selected").index(),!0)},nextNav:1,initialize:e=>{const a="dna-panels-initialized";!e.length||e.hasClass(a)||e.children().hasClass("dna-template")||(()=>{!e.data().nav&&/-panels$/.test(e.attr("id"))&&(a=>{e.attr("data-nav",a).addClass("dna-legacy-id"),$("#"+a+"-menu").attr("data-nav",a).addClass("dna-legacy-id"),e.data().nav=a})(e.attr("id").replace(/-panels$/,""));const n=e.data().nav||(()=>{const a="dna-panels-"+dna.panels.nextNav++;return e.attr("data-nav",a).prev(".dna-menu").attr("data-nav",a),a})(),t=$(".dna-menu[data-nav="+n+"]").addClass(a),d=e.addClass(a).children().addClass("panel"),l=window.location.hash.replace(/[^\w-]/g,""),s=l&&d.first().data().hash?(()=>d.filter("[data-hash="+l+"]").index())():(()=>dna.pageToken.get(n,0))();t.length||dna.core.berserk("Menu not found for panels",n),t.data().dnaPanels=d,t.find(".menu-item").length||t.children().addClass("menu-item"),dna.panels.display(t,s)})()},setup:()=>{$(".dna-panels").each((e,a)=>dna.panels.initialize($(a))),$(window.document).on({click:dna.panels.clickRotate},".dna-menu .menu-item"),$(window.document).on({change:dna.panels.selectRotate},".dna-menu")}},dna.compile={regexDnaField:/^[\s]*(~~|\{\{).*(~~|\}\})[\s]*$/,regexDnaBasePair:/~~|{{|}}/,regexDnaBasePairs:/~~|\{\{|\}\}/g,setupNucleotide:e=>(e.data().dnaRules||(e.data().dnaRules={}),e.addClass("dna-nucleotide")),isDnaField:(e,a)=>{const n=a.childNodes[0];return n&&n.nodeValue&&(()=>n.nodeValue.match(dna.compile.regexDnaField))()},field:(e,a)=>((a=dna.compile.setupNucleotide($(a))).data().dnaField=a.text().replace(dna.compile.regexDnaBasePairs,"").trim(),a.is("textarea")?a.addClass("dna-update-model").data().dnaRules.val=!0:a.data().dnaRules.text=!0,a.empty()),propsAndAttrs:(e,a)=>{a=$(a);const n=[],t=[],d=[];return dna.ui.getAttrs(a).forEach(e=>{/^data-prop-/.test(e.name)?((e,t)=>{d.push(e),e=e.replace(/^data-prop-/,"").toLowerCase(),t=t.replace(dna.compile.regexDnaBasePairs,""),n.push(e,t),"checked"===e&&a.is("input")&&(a.addClass("dna-update-model").data().dnaField=t)})(e.name,e.value):3===e.value.split(dna.compile.regexDnaBasePair).length&&((e,n)=>{const l=n.split(dna.compile.regexDnaBasePair);"[count]"===l[1]?l[1]=1:"[value]"===l[1]&&(l[1]=2),t.push(e.replace(/^data-attr-/,""),l),d.push(e),(a.is("input:not(:checkbox, :radio)")&&"value"===e&&""===l[0]&&""===l[2]||a.is("select")&&"data-option"===e)&&(dna.compile.setupNucleotide(a).addClass("dna-update-model"),a.data().dnaField=l[1],a.data().dnaRules.val=!0)})(e.name,e.value)}),n.length>0&&(dna.compile.setupNucleotide(a).data().dnaRules.props=n),t.length>0&&(dna.compile.setupNucleotide(a).data().dnaRules.attrs=t),a.data().transform&&(dna.compile.setupNucleotide(a).data().dnaRules.transform=a.data().transform),a.data().callback&&(dna.compile.setupNucleotide(a).data().dnaRules.callback=a.data().callback),a.removeAttr(d.join(" "))},getDataField:(e,a)=>$.trim(e.data(a).replace(dna.compile.regexDnaBasePairs,"")),subTemplateName:(e,a)=>{return(e instanceof $&&(()=>dna.getClone(e,{main:!0}))().data().dnaRules.template||e)+"-"+a+"-instance"},rules:(e,a,n)=>{return e.filter("[data-"+a+"]").each((e,t)=>{t=dna.compile.setupNucleotide($(t));const d=dna.compile.getDataField(t,a);t.data().dnaRules[a]=n?(()=>d.split(";").map(e=>e.split(",")))():d}).removeAttr("data-"+a)},separators:e=>{const a=(e,a)=>3===a.nodeType&&!/\S/.test(a.nodeValue),n=(e,n,t)=>{return n&&(e.contents().last().filter(a).remove(),void e.append($("<span>").addClass(t).html(n)))};e.find(".dna-template, .dna-sub-clone").addBack().each((e,a)=>{const t=$(a);n(t,t.data().separator,"dna-separator"),n(t,t.data().lastSeparator,"dna-last-separator")})},template:e=>{const a=$("#"+e);a.length||dna.core.berserk("Template not found",e);const n=(e,a)=>$(a).data().dnaRules.subs=[];a.find(".dna-template").addBack().each((e,a)=>$(a).data().dnaRules={template:$(a).attr("id"),subs:[]}).removeAttr("id").each(n);const t=a.find("*").addBack();t.filter(dna.compile.isDnaField).each(dna.compile.field).addClass("dna-field"),dna.compile.rules(t,"array").addClass("dna-sub-clone").each(n),dna.compile.rules(t,"class",!0),dna.compile.rules(t,"require"),dna.compile.rules(t,"missing"),dna.compile.rules(t,"true"),dna.compile.rules(t,"false"),t.each(dna.compile.propsAndAttrs),dna.compile.separators(a);return $("input[data-attr-type]").each((e,a)=>$(a).attr({type:$(a).data().attrType})),dna.store.stash(a)}},dna.store={templates:{},stash:e=>{const a=e.data().dnaRules.template,n=(e,a)=>{const n=(a=$(a)).data().dnaRules.template,t=a.parent(),d=1===t.children().length&&!t.hasClass("dna-container");d||t.data().dnaContents||(()=>{t.data().dnaContents=!0;t.data().dnaContents=t.children().toArray().map(e=>(e=$(e)).hasClass("dna-template")?(e=>e?dna.compile.template(e).name:n)(e.attr("id")):!!e.hasClass("dna-sub-clone")&&e.data().dnaRules.template)})();const l={name:n,elem:a,container:t.addClass("dna-container").addClass("dna-contains-"+n),nested:0!==t.closest(".dna-clone").length,separators:a.find(".dna-separator, .dna-last-separator").length,wrapped:d};dna.store.templates[n]=l,a.removeClass("dna-template").addClass("dna-clone").addClass(n).detach()};return e.find(".dna-template").addBack().each(n),e.find(".dna-sub-clone").each((e,n)=>{const t=$(n).data().dnaRules,d=dna.compile.setupNucleotide($(n).parent()).addClass("dna-array");t.template=dna.compile.subTemplateName(a,t.array),d.data().dnaRules.loop={name:t.template,field:t.array},d.closest(".dna-clone, .dna-sub-clone").data().dnaRules.subs.push(t.array)}).each(n),dna.store.templates[a]},getTemplate:e=>dna.store.templates[e]||dna.compile.template(e)},dna.events={context:{},initializers:[],runOnLoads:()=>{return $("[data-on-load]").not(".dna-loaded").each((e,a)=>dna.util.apply($(a).data().onLoad,$(a))).addClass("dna-loaded")},runInitializers:e=>{return dna.events.initializers.forEach(a=>{const n=[(a.selector?(()=>e.find(a.selector).addBack(a.selector))():e).addClass("dna-initialized")].concat(a.params);dna.util.apply(a.func,n)}),e},setup:()=>{const e=(e,a,n)=>{const t=(e=e.closest("[data-"+a+"]")).data(a);return"click"===a&&"A"===e.prop("tagName")&&t&&t.match(/^dna[.]/)&&n.preventDefault(),dna.util.apply(t,[e,n])},a=a=>{const n=$(a.target),t=(e,a)=>dna.util.assign(dna.getModel(e),e.data().dnaField,a(e)),d=e=>e.val(),l=e=>e.is(":checked"),s=(e,a)=>t($(a),l);return n.hasClass("dna-update-model")&&(()=>{const e=dna.getClone(n,{main:!0});0!==e.length&&(n.is("input:checkbox")?t(n,l):n.is("input:radio")?$("input:radio[name="+n.attr("name")+"]").each(s):n.data().dnaRules.val&&t(n,d),dna.refresh(e))})(),e(n,a.type.replace("key","key-"),a)},n=a=>{const n=$(a.target),t=n.data(),d=()=>{t.dnaLastUpdated=Date.now(),t.dnaLastValue=n.val(),t.dnaTimeoutId=null,e(n,"smart-update",a)},l=()=>{n.val()===t.dnaLastValue||t.dnaTimeoutId||(()=>{const e=t.smartThrottle?+t.smartThrottle:1e3;Date.now()<t.dnaLastUpdated+e?t.dnaTimeoutId=window.setTimeout(d,e):d()})()};t.smartUpdate&&("keydown"===a.type&&void 0===t.dnaLastValue&&(t.dnaLastValue=n.val()),window.setTimeout(l))};$(window.document).on({click:a,change:a,keydown:a,keypress:a,keyup:a,input:a}).on({keydown:n,keyup:n,change:n,cut:n,paste:n}).on({keyup:a=>{13===a.which&&e($(a.target),"enter-key",a)}}).on({click:e=>{const a=$(e.target).closest("[data-href]"),n=/iPad|iPhone|iPod/.test(window.navigator.userAgent)&&/Apple/.test(window.navigator.vendor),t=a.closest(".external-site").length?"_blank":"_self";window.open(a.data().href,n?"_self":a.data().target||t)}},"[data-href]"),dna.events.runOnLoads()}},dna.core={inject:(e,a,n,t)=>{const d=e=>{const n=dna.util.value(a,e);return null!=n},l=(e,l)=>{const s=(l=$(l)).data().dnaRules;s.transform&&dna.util.apply(s.transform,a),s.loop&&((e,n)=>{const d=dna.util.value(a,n.field),l=e.children("."+n.name.replace(/[.]/g,"\\."));d?d.length===l.length?l.each((e,a)=>{(a=$(a)).is("option")||dna.core.inject(a,d[e],e+1,t)}):(l.remove(),dna.clone(n.name,d,{container:e,html:t.html})):a[n.field]=[]})(l,s.loop),s.text&&((e,d)=>{const l="[count]"===d?n:"[value]"===d?a:dna.util.value(a,d);({string:!0,number:!0,boolean:!0})[typeof l]&&(e=t.html?e.html(l):e.text(l))})(l,l.data().dnaField),s.val&&((e,t)=>{const d="[count]"===t?n:"[value]"===t?a:dna.util.value(a,t);null!==d&&d!==e.val()&&e.val(d)})(l,l.data().dnaField),s.props&&((e,n)=>{for(let t=0;t<n.length/2;t++)e.prop(n[2*t],dna.util.realTruth(dna.util.value(a,n[2*t+1])))})(l,s.props),s.attrs&&((e,t)=>{for(let d=0;d<t.length/2;d++){const l=t[2*d],s=t[2*d+1],o=s[1],r=1===o?n:2===o?a:dna.util.value(a,o),i=[s[0],r,s[2]].join("");e.attr(l,i),/^data-./.test(l)&&e.data(l.substring(5),i),"value"===l&&i!==e.val()&&e.val(i)}})(l,s.attrs),s.class&&((e,n)=>{n.forEach(n=>{const t=dna.util.value(a,n[0]),d=dna.util.realTruth(t);1===n.length?e.addClass(t):n.length>1&&(e.toggleClass(n[1],d),n[2]&&e.toggleClass(n[2],!d))})})(l,s.class),s.require&&l.toggle(d(s.require)),s.missing&&l.toggle(!d(s.missing)),s.true&&l.toggle(dna.util.realTruth(dna.util.value(a,s.true))),s.false&&l.toggle(!dna.util.realTruth(dna.util.value(a,s.false))),s.callback&&dna.util.apply(s.callback,l)},s=e=>{e.filter(".dna-nucleotide").each(l),e.length&&s(e.children().not(".dna-sub-clone"))};return t.transform&&t.transform(a),s(e),e.data().dnaModel=a,e.data().dnaCount=n,e},replicate:(e,a,n,t)=>{const d=".dna-contains-"+e.name.replace(/[.]/g,"\\."),l=t.container?t.container.find(d).addBack(d):e.container,s=e.elem.clone(!0,!0),o=s.data().dnaRules.template;l.data().dnaCountsMap||(l.data().dnaCountsMap={});const r=l.data().dnaCountsMap;r[o]=(r[o]||0)+1,dna.core.inject(s,a,r[o],t);return e.wrapped?t.top?l.prepend(s):l.append(s):(()=>{const a=l.children(".dna-clone"),n=a.filter("."+e.name);n.length?t.top?n.first().before(s):n.last().after(s):(()=>{const n=l.data().dnaContents,t=n.indexOf(e.name),d=l.children().eq(t+n.reduce((e,d)=>e+(d&&n.indexOf(d)<t?a.filter("."+d).length-1:0),0));d.length?d.before(s):l.append(s)})()})(),e.separators&&(()=>{const a=l.children("."+e.name);a.find(".dna-separator").show().end().last().find(".dna-separator").hide(),a.find(".dna-last-separator").hide().end().eq(-2).find(".dna-last-separator").show().closest(".dna-clone").find(".dna-separator").hide()})(),dna.events.runInitializers(s,a),t.callback&&t.callback(s,a),t.fade&&dna.ui.slideFadeIn(s),s},getArrayName:e=>e.hasClass("dna-sub-clone")?e.data().dnaRules.array:null,updateArrayByName:(e,a)=>{return a?(()=>{e=dna.getClone(e);const n=dna.compile.subTemplateName(e,a);return e.data().dnaRules.subs.includes(a)&&(dna.getModel(e)[a]=e.find("."+n).get().map(dna.getModel)),e})():e},updateArray:e=>(e=dna.getClone(e.first()),dna.core.updateArrayByName(e.parent(),dna.core.getArrayName(e)),e),remove:(e,a)=>{const n=e.parent();return e.detach(),dna.core.updateArrayByName(n,dna.core.getArrayName(e)),dna.placeholder.setup(),e.remove(),a&&a(e),e},berserk:(e,a)=>{throw Error("dna.js ~~ "+e+" ["+a+"]")},plugin:()=>{$.fn.dna=function(e){const a=[arguments[1],arguments[2],arguments[3]],n=dna[dna.util.toCamel(e)];n||dna.core.berserk("Unknown plugin action",e);return this.each((e,t)=>n($(t),a[0],a[1],a[2]))}},initModule:(e,a)=>(window=e,$=a,window.dna=dna,dna.core.setup(),dna),setup:()=>{dna.core.plugin(),$(dna.placeholder.setup),$(dna.panels.setup),$(dna.events.setup)}},"object"==typeof window&&(window.dna=dna),"object"==typeof module?module.exports=dna.core.initModule:dna.core.setup();