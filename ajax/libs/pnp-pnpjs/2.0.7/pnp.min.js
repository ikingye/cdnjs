!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(window,function(){return r={},i.m=n=[function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return l});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){var i,o=arguments.length,c=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(c=(o<3?i(c):3<o?i(t,n,c):i(t,n))||c);return 3<o&&c&&Object.defineProperty(t,n,c),c}function c(e,c,s,a){return new(s=s||Promise)(function(n,t){function r(e){try{o(a.next(e))}catch(e){t(e)}}function i(e){try{o(a.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((a=a.apply(e,c||[])).next())})}function s(n,r){var i,o,c,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(c=2&t[0]?o.return:t[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,t[1])).done)return c;switch(o=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((c=0<(c=s.trys).length&&c[c.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){s.label=t[1];break}if(6===t[0]&&s.label<c[1]){s.label=c[1],c=t;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(t);break}c[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),c=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)c.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return c}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}Object.create,Object.create},function(e,t,n){"use strict";n.r(t);var r=n(31);n.d(t,"objectToMap",function(){return r.b}),n.d(t,"mergeMaps",function(){return r.a});var i=n(30);n.d(t,"setup",function(){return i.c}),n.d(t,"RuntimeConfigImpl",function(){return i.b}),n.d(t,"RuntimeConfig",function(){return i.a});var o=n(41);n.d(t,"mergeHeaders",function(){return o.e}),n.d(t,"mergeOptions",function(){return o.f}),n.d(t,"getADALResource",function(){return o.d}),n.d(t,"FetchClient",function(){return o.b}),n.d(t,"BearerTokenFetchClient",function(){return o.a}),n.d(t,"SPFxAdalClient",function(){return o.c});var c=n(42);for(var s in c)["objectToMap","mergeMaps","setup","RuntimeConfigImpl","RuntimeConfig","mergeHeaders","mergeOptions","getADALResource","FetchClient","BearerTokenFetchClient","SPFxAdalClient","default"].indexOf(s)<0&&function(e){n.d(t,e,function(){return c[e]})}(s);var a=n(43);n.d(t,"PnPClientStorageWrapper",function(){return a.b}),n.d(t,"PnPClientStorage",function(){return a.a});var u=n(21);n.d(t,"getCtxCallback",function(){return u.d}),n.d(t,"dateAdd",function(){return u.c}),n.d(t,"combine",function(){return u.b}),n.d(t,"getRandomString",function(){return u.g}),n.d(t,"getGUID",function(){return u.e}),n.d(t,"isFunc",function(){return u.j}),n.d(t,"objectDefinedNotNull",function(){return u.m}),n.d(t,"isArray",function(){return u.i}),n.d(t,"assign",function(){return u.a}),n.d(t,"isUrlAbsolute",function(){return u.k}),n.d(t,"stringIsNullOrEmpty",function(){return u.o}),n.d(t,"sanitizeGuid",function(){return u.n}),n.d(t,"jsS",function(){return u.l}),n.d(t,"hOP",function(){return u.h}),n.d(t,"getHashCode",function(){return u.f});var l=n(32);n.d(t,"safeGlobal",function(){return l.a})},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"m",function(){return l}),n.d(t,"y",function(){return E}),n.d(t,"A",function(){return ne}),n.d(t,"q",function(){return re}),n.d(t,"i",function(){return N}),n.d(t,"l",function(){return A}),n.d(t,"b",function(){return U}),n.d(t,"g",function(){return x}),n.d(t,"c",function(){return D}),n.d(t,"h",function(){return k}),n.d(t,"f",function(){return L}),n.d(t,"C",function(){return X}),n.d(t,"z",function(){return $}),n.d(t,"B",function(){return Y}),n.d(t,"j",function(){return Z}),n.d(t,"w",function(){return te}),n.d(t,"p",function(){return V}),n.d(t,"k",function(){return K}),n.d(t,"n",function(){return ie}),n.d(t,"x",function(){return oe}),n.d(t,"u",function(){return f}),n.d(t,"v",function(){return O}),n.d(t,"t",function(){return g}),n.d(t,"o",function(){return j}),n.d(t,"s",function(){return v}),n.d(t,"r",function(){return m});var u=n(1),r=(Object.defineProperty(a.prototype,"batchId",{get:function(){return this._batchId},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"requests",{get:function(){return this._reqs.sort(function(e,t){return e.index-t.index})},enumerable:!1,configurable:!0}),a.prototype.track=function(e){e.data.batch=this,(void 0===e.data.batchIndex||e.data.batchIndex<0)&&(e.data.batchIndex=++this._index)},a.prototype.add=function(e){var n={id:e.requestId,index:e.batchIndex,method:e.method.toUpperCase(),options:e.options,parser:e.parser,reject:null,resolve:null,url:e.url},t=new Promise(function(e,t){n.resolve=e,n.reject=t});return this._reqs.push(n),t},a.prototype.addDependency=function(){var t=function(){};return this._deps.push(new Promise(function(e){t=e})),t},a.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},a.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return Promise.all(e._deps)}).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},a),i=(Object.defineProperty(s.prototype,"store",{get:function(){return"local"===this.storeName?s.storage.local:s.storage.session},enumerable:!1,configurable:!0}),s.storage=new u.PnPClientStorage,s),o=(c.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},c.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},c);function c(e,t){this.parser=e,this.cacheOptions=t}function s(e,t,n){void 0===t&&(t=u.RuntimeConfig.defaultCachingStore),void 0===n&&(n=Object(u.dateAdd)(new Date,"second",u.RuntimeConfig.defaultCachingTimeoutSeconds)),this.key=e,this.storeName=t,this.expiration=n}function a(e){void 0===e&&(e=Object(u.getGUID)()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}function l(e,t,n,r){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,r)}})}var d=n(0),p=!1,h=[],b=Symbol("__extensions"),f=function(e){p=!0,y(h,e)},O=function(e,t){return p=!0,Reflect.has(e,b)||Reflect.set(e,b,[]),y(Reflect.get(e,b),t),e},g=function(e,t){p=!0,void 0===e.__proto__[b]&&(e.__proto__[b]=[]),y(e.__proto__[b],t)};function y(e,t){Object(u.isArray)(t)?e.push.apply(e,Object(d.e)(t)):e.push(t)}var j=function(){h.length=0},m=function(){p=!1},v=function(){p=!0};function S(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];if(p){var o=[];Reflect.has(n,b)&&o.push.apply(o,Object(d.e)(Reflect.get(n,b))),o.push.apply(o,Object(d.e)(h));for(var c=0;c<o.length;c++){var s=o[c],a=void 0;if(Object(u.isFunc)(s)?a=s.apply(void 0,Object(d.e)([e,n],r)):"get"===e&&Reflect.has(s,r[0])?a=Reflect.get(s,r[0],n):Reflect.has(s,e)&&(a=Reflect.get(s,e).apply(void 0,Object(d.e)([n],r))),void 0!==a)return a}}return t.apply(void 0,Object(d.e)([n],r))}var T,P,I,w,_,C,R,E=(T=function(e){return this.defaultAction(e)},function(o){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];function n(e){var n=Object.assign(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(n,e)},new(o.bind.apply(o,Object(d.e)([void 0],e))));return Reflect.setPrototypeOf(n,o.prototype),n}var r,i;return u.RuntimeConfig.ie11?n(e):new Proxy((i=(r=n)(e),r.__proto__[b]&&(i=O(i,r.__proto__[b])),i),{apply:function(e,t,n){return S("apply",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.apply(e[0],e[1],e[2])},e,t,n)},get:function(e,t,n){return S("get",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.get(e[0],e[1],e[2])},e,t,n)},has:function(e,t){return S("has",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.has(e[0],e[1])},e,t)},set:function(e,t,n,r){return S("set",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Reflect.set(e[0],e[1],e[2],e[3])},e,t,n,r)}})}}),N=(H.prototype.parse=function(n){var r=this;return new Promise(function(e,t){r.handleError(n,t)&&r.parseImpl(n,e,t)})},H.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return 0<e.replace(/\s/gi,"").length?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},H.prototype.handleError=function(e,t){return e.ok||L.init(e).then(t),e.ok},H.prototype.parseODataJSON=function(e){var t=e;return Object(u.hOP)(e,"d")?t=Object(u.hOP)(e.d,"results")?e.d.results:e.d:Object(u.hOP)(e,"value")&&(t=e.value),t},H),A=(R=N,Object(d.c)(W,R),W.prototype.parseImpl=function(e,t){e.text().then(t)},W),U=(C=N,Object(d.c)(q,C),q.prototype.parseImpl=function(e,t){e.blob().then(t)},q),x=(_=N,Object(d.c)(G,_),G.prototype.parseImpl=function(e,t){e.json().then(t)},G),D=(w=N,Object(d.c)(M,w),M.prototype.parseImpl=function(e,t){Object(u.isFunc)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},M),k=(I=N,Object(d.c)(B,I),B.prototype.parseImpl=function(e,t){this.parser(e).then(t)},B),L=(P=Error,Object(d.c)(F,P),F.init=function(n){return Object(d.a)(this,void 0,void 0,function(){var t;return Object(d.d)(this,function(e){switch(e.label){case 0:return[4,n.clone().text()];case 1:return t=e.sent(),[2,new F("Error making HttpClient request in queryable ["+n.status+"] "+n.statusText+" ::> "+t,n.clone())]}})})},F);function F(e,t,n,r){void 0===n&&(n=t.status),void 0===r&&(r=t.statusText);var i=P.call(this,e)||this;return i.response=t,i.status=n,i.statusText=r,i.isHttpRequestError=!0,i}function B(e){var t=I.call(this)||this;return t.parser=e,t}function M(){return null!==w&&w.apply(this,arguments)||this}function G(){return null!==_&&_.apply(this,arguments)||this}function q(){return null!==C&&C.apply(this,arguments)||this}function W(){return null!==R&&R.apply(this,arguments)||this}function H(){}function V(n){var e=JSON.stringify(n,function(e,t){switch(e){case"query":return JSON.stringify(Object(d.e)(t));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}},0),t=JSON.parse(e,function(e,t){switch(e){case"query":return new Map(JSON.parse(t));case"batch":return n.batch;case"batchDependency":return n.batchDependency;case"cachingOptions":return n.cachingOptions;case"clientFactory":return n.clientFactory;case"parser":return n.parser;default:return t}});return n.options&&n.options.body&&(t.options.body=n.options.body),t}var K=(Object.defineProperty(z.prototype,"data",{get:function(){return this._data},set:function(e){this._data=Object.assign({},V(this.data),V(e))},enumerable:!1,configurable:!0}),z.prototype.toUrl=function(){return this.data.url},z.prototype.concat=function(e){return this.data.url+=e,this},Object.defineProperty(z.prototype,"query",{get:function(){return this.data.query},enumerable:!1,configurable:!0}),z.prototype.configure=function(e){return Object(u.mergeOptions)(this.data.options,e),this},z.prototype.configureFrom=function(e){return Object(u.mergeOptions)(this.data.options,e.data.options),this},z.prototype.usingCaching=function(e){return u.RuntimeConfig.globalCacheDisable||(this.data.useCaching=!0,void 0!==e&&(this.data.cachingOptions=e)),this},z.prototype.usingParser=function(e){return this.data.parser=e,this},z.prototype.withPipeline=function(e){return this.data.pipes=e.slice(0),this},z.prototype.append=function(e){this.data.url=Object(u.combine)(this.data.url,e)},z.prototype.inBatch=function(e){if(this.hasBatch)throw Error("This query is already part of a batch.");return Object(u.objectDefinedNotNull)(e)&&e.track(this),this},z.prototype.addBatchDependency=function(){return Object(u.objectDefinedNotNull)(this.data.batch)?this.data.batch.addDependency():function(){return null}},Object.defineProperty(z.prototype,"hasBatch",{get:function(){return Object(u.objectDefinedNotNull)(this.data.batch)},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"batch",{get:function(){return this.hasBatch?this.data.batch:null},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"parentUrl",{get:function(){return this.data.parentUrl},enumerable:!1,configurable:!0}),z.prototype.cloneTo=function(e,t){return void 0===t&&(t={includeBatch:!0}),e.data=Object.assign({},V(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},V(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e},z),Q=n(15);function z(e){void 0===e&&(e={}),this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new N,query:new Map,url:"",useCaching:!1},V(e))}function X(t,n){return new Promise(function(e){t.result=n,t.hasResult=!0,e(t)})}function J(e){return 0<e.pipes.length?e.pipes.shift()(e):Promise.resolve(e)}function $(e){if(e.pipes.length<1)throw Q.d.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",3),Error("Request pipeline contains no methods!");var t=J(e).then(function(e){return t=e,Q.d.log({data:0===Q.d.activeLogLevel?t.result:{},level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(t.result);var t}).catch(function(e){throw Q.d.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function Y(o){return void 0===o&&(o=!1),function(n,r,e){var i=e.value;e.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!o&&0<e.length&&Object(u.hOP)(e[0],"hasResult")&&e[0].hasResult?(Q.d.write("["+e[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",0),Promise.resolve(e[0])):(Q.d.write("["+e[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",0),i.apply(n,e).then(J))}}}var Z=(ee.logStart=function(t){return new Promise(function(e){Q.d.log({data:1===Q.d.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Beginning "+t.method+" request ("+t.url+")"}),e(t)})},ee.caching=function(r){return new Promise(function(t){if(r.useCaching){Q.d.write("["+r.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var e=new i(r.url.toLowerCase());if(void 0!==r.cachingOptions&&(e=Object(u.assign)(e,r.cachingOptions)),null!==e.store){var n=e.store.get(e.key);if(null!==n)return Q.d.log({data:1===Q.d.activeLogLevel?{}:n,level:1,message:"["+r.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),Object(u.isFunc)(r.batchDependency)&&r.batchDependency(),Object(u.hOP)(r.parser,"hydrate")&&(n=r.parser.hydrate(n)),X(r,n).then(function(e){return t(e)})}Q.d.write("["+r.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),r.parser=new o(r.parser,e)}return t(r)})},ee.send=function(o){return new Promise(function(t,n){var e,r,i;o.isBatched?(e=o.batch.add(o),Object(u.isFunc)(o.batchDependency)&&o.batchDependency(),Q.d.write("["+o.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+o.batch.batchId+".",1),t(X(o,e))):(Q.d.write("["+o.requestId+"] ("+(new Date).getTime()+") Sending request.",1),r=o.clientFactory(),i=Object(u.assign)(o.options||{},{method:o.method}),r.fetch(o.url,i).then(function(e){return o.parser.parse(e)}).then(function(e){return X(o,e)}).then(function(e){return t(e)}).catch(function(e){return n(e)}))})},ee.logEnd=function(t){return new Promise(function(e){t.isBatched?Q.d.log({data:1===Q.d.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") "+t.method+" request will complete in batch "+t.batch.batchId+"."}):Q.d.log({data:1===Q.d.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Completing "+t.method+" request."}),e(t)})},Object(d.b)([Y(!0)],ee,"logStart",null),Object(d.b)([Y()],ee,"caching",null),Object(d.b)([Y()],ee,"send",null),Object(d.b)([Y(!0)],ee,"logEnd",null),ee);function ee(){}function te(){return[Z.logStart,Z.caching,Z.send,Z.logEnd].slice(0)}function ne(r){return function(n){return function(t){return function(e){return $(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:n,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:Object(u.objectDefinedNotNull)(e.batch),method:t,options:null,parentUrl:"",parser:new N,pipes:r.slice(0),query:new Map,requestId:Object(u.getGUID)(),url:"",useCaching:/^get$/i.test(e.method)&&e.useCaching},V(e)))}}}}var re=ne(te());function ie(e,t){return Object.assign({body:Object(u.jsS)(e)},t)}function oe(e,t){return Object.assign({headers:e},t)}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(0),r=n(1),c=n(2);function i(i){return function(e,t,n){void 0===n&&(n=Object.getOwnPropertyDescriptor(e,t));var r=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Object(o.a)(this,void 0,void 0,function(){return Object(o.d)(this,function(e){return this.configure(Object(c.x)({"X-PnPjs-Tracking":i})),[2,r.apply(this,t)]})})},n}}i.getClientTag=function(e,t){if(void 0===t&&(t=!0),e.has("X-PnPjs-Tracking")){var n=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!Object(r.stringIsNullOrEmpty)(n))return n}return""},i.configure=function(e,t){return e.configure(Object(c.x)({"X-PnPjs-Tracking":t}))},i.isTagged=function(e){return e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"]}},function(e,t,n){"use strict";n.d(t,"i",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"a",function(){return f}),n.d(t,"e",function(){return O}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return y}),n.d(t,"c",function(){return j}),n.d(t,"g",function(){return T}),n.d(t,"h",function(){return P});var r,i,a,o=n(0),u=n(1),c=n(2),s=n(15),l=n(10),d=n(5),p=n(3),h=function(e){return Object(c.y)(e)},b=(a=c.k,Object(o.c)(S,a),S.prototype.toUrlAndQuery=function(){var e,r=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(e,t,n){return s.d.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+n,0),r.set(t,"'"+n+"'"),t});return 0<r.size&&(e=-1<t.indexOf("?")?"&":"?",t+=e+Array.from(r).map(function(e){return e[0]+"="+e[1]}).join("&")),t},S.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this},S.prototype.get=function(e){return Object(d.b)(this,e)},S.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this},S.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=a.prototype.cloneTo.call(this,e(this,t),{includeBatch:n}),i="@target";return this.query.has(i)&&r.query.set(i,this.query.get(i)),r},S.prototype.defaultAction=function(e){return Object(d.b)(this,e)},S.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var i=e(t,n).configureFrom(this),o="@target";return this.query.has(o)&&i.query.set(o,this.query.get(o)),void 0!==r&&(i=i.inBatch(r)),i},S),f=h(b),O=(i=b,Object(o.c)(v,i),v.prototype.filter=function(e){return this.query.set("$filter",encodeURIComponent(e)),this},v.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(encodeURIComponent(e)+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},v.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},v.prototype.top=function(e){return this.query.set("$top",e.toString()),this},v),g=h(O),y=(r=b,Object(o.c)(m,r),m.prototype._update=function(e,n){var r=this;return function(t){return Object(d.d)(p.a.configure(r,e+".Update"),{body:Object(u.jsS)(Object(u.assign)(Object(l.a)(e),t)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return n(e,t)})}},m),j=h(y);function m(){return null!==r&&r.apply(this,arguments)||this}function v(){return null!==i&&i.apply(this,arguments)||this}function S(e,t){var n,r,i=this,o="",c="",s=new Map;return"string"==typeof e?o=Object(u.isUrlAbsolute)(e)||e.lastIndexOf("/")<0?(c=e,Object(u.combine)(e,t)):e.lastIndexOf("/")>e.lastIndexOf("(")?(n=e.lastIndexOf("/"),c=e.slice(0,n),t=Object(u.combine)(e.slice(n),t),Object(u.combine)(c,t)):(n=e.lastIndexOf("("),c=e.slice(0,n),Object(u.combine)(e,t)):(c=e.toUrl(),o=Object(u.combine)(c,t||""),void 0!==(r=e.query.get("@target"))&&s.set("@target",r)),i=a.call(this,{parentUrl:c,query:s,url:o})||this,"string"!=typeof e&&i.configureFrom(e),i._forceCaching=!1,i}function T(e){return function(){return Object(d.e)(p.a.configure(this,e+".delete"))}}function P(t){return function(e){return void 0===e&&(e="*"),Object(d.f)(p.a.configure(this,t+".delete"),{},e)}}},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return h}),n.d(t,"e",function(){return b}),n.d(t,"f",function(){return f});function r(e){var c=o(e);return function(i,o){return Object(s.a)(this,void 0,void 0,function(){var t,n,r;return Object(s.d)(this,function(e){switch(e.label){case 0:return t=Object(a.p)(i.data),n=Object(u.objectDefinedNotNull)(t.batch)?t.batch.addDependency():function(){},[4,Object(l.a)(i.toUrlAndQuery())];case 1:return r=e.sent(),Object(u.mergeOptions)(t.options,o),[2,c(Object.assign({},t,{batchDependency:n,url:r}))]}})})}}var s=n(0),a=n(2),i=n(26),u=n(1),l=n(27),o=Object(a.q)(function(){return new i.a}),c=function(e,t){return e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),r("GET")(e,t)},d=r("POST"),p=r("DELETE"),h=r("PATCH"),b=function(e,t){var n=Object.assign(Object(a.x)({"X-HTTP-Method":"DELETE"}),t);return d(e,n)},f=function(e,t,n){void 0===n&&(n="*");var r=Object.assign(Object(a.x)({"X-HTTP-Method":"DELETE","IF-Match":n}),t);return d(e,r)}},function(e,t,n){"use strict";n.d(t,"f",function(){return p}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"a",function(){return f}),n.d(t,"e",function(){return g}),n.d(t,"b",function(){return y});var r,i,o,c,s=n(0),a=n(1),u=n(2),l=n(34),d=n(9),p=function(e){return Object(u.y)(e)},h=(c=u.k,Object(s.c)(S,c),S.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this},S.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this},S.prototype.defaultAction=function(e){return Object(d.b)(this,e)},S.prototype.get=function(e){return Object(d.b)(this,e)},S.prototype.toUrlAndQuery=function(){var e,t=this.toUrl();return Object(a.isUrlAbsolute)(t)||(t=Object(a.combine)("https://graph.microsoft.com",t)),0<this.query.size&&(e=-1<t.indexOf("?")?"&":"?",t+=e+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&")),t},S.prototype.setEndpoint=function(e){return this.data.url=l.a.ensure(this.data.url,e),this},S.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},S.prototype.clone=function(e,t,n){return void 0===n&&(n=!0),c.prototype.cloneTo.call(this,e(this,t),{includeBatch:n})},S),b=(p(h),o=h,Object(s.c)(v,o),v.prototype.filter=function(e){return this.query.set("$filter",e),this},v.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(encodeURIComponent(e)+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},v.prototype.top=function(e){return this.query.set("$top",e.toString()),this},v.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},v.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(v.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!1,configurable:!0}),v),f=p(b),O=(i=b,Object(s.c)(m,i),m.prototype.search=function(e){return this.query.set("$search",e),this},m),g=(p(O),r=h,Object(s.c)(j,r),j),y=p(g);function j(){return null!==r&&r.apply(this,arguments)||this}function m(){return null!==i&&i.apply(this,arguments)||this}function v(){return null!==o&&o.apply(this,arguments)||this}function S(e,t){var n=this,r="",i="",o=new Map,r=(i="string"==typeof e?e:e.toUrl(),Object(a.combine)(i,t)),n=c.call(this,{parentUrl:i,query:o,url:r})||this;return"string"!=typeof e&&n.configureFrom(e),n}},function(e,t,n){"use strict";n.d(t,"b",function(){return y}),n.d(t,"c",function(){return j}),n.d(t,"a",function(){return m});var r,i,u=n(0),l=n(1),d=n(2),o=n(4),c=n(8),p=n(16),s=n(28),h=n(10),a=n(24),b=n(5),f=n(12),O=n(3),g=(i=o.e,Object(u.c)(S,i),S.prototype.add=function(r,i,o,c,s,a){return void 0===o&&(o=""),void 0===c&&(c="STS"),void 0===s&&(s=1033),void 0===a&&(a=!0),Object(u.a)(this,void 0,void 0,function(){var t,n;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=Object(d.n)({parameters:Object(l.assign)(Object(h.a)("SP.WebCreationInformation"),{Description:o,Language:s,Title:r,Url:i,UseSamePermissionsAsParentSite:a,WebTemplate:c})}),[4,Object(b.d)(this.clone(y,"add"),t)];case 1:return[2,{data:n=e.sent(),web:m(Object(p.a)(n).replace(/_api\/web\/?/i,""))}]}})})},Object(u.b)([Object(O.a)("ws.add")],S.prototype,"add",null),Object(u.b)([Object(c.a)("webs")],S)),y=Object(o.i)(g),j=(r=o.f,Object(u.c)(v,r),Object.defineProperty(v.prototype,"webs",{get:function(){return y(this)},enumerable:!1,configurable:!0}),v.prototype.getParentWeb=function(){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(b.b)(this.select("ParentWeb/Id").expand("ParentWeb"))];case 1:return[2,(t=e.sent().ParentWeb)?Object(a.a)(this.parentUrl).openWebById(t.Id):null]}})})},v.prototype.getSubwebsFilteredForCurrentUser=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=-1);var n=this.clone(y,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")");return O.a.configure(n,"w.getSubwebsFilteredForCurrentUser")},Object.defineProperty(v.prototype,"allProperties",{get:function(){return O.a.configure(this.clone(o.c,"allproperties"),"w.allprops")},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"webinfos",{get:function(){return O.a.configure(Object(o.b)(this,"webinfos"),"w.webinfos")},enumerable:!1,configurable:!0}),v.prototype.createBatch=function(){return new s.a(this.parentUrl)},v.prototype.update=function(n){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=Object(d.n)(Object(l.assign)(Object(h.a)("SP.Web"),n),Object(d.x)({"X-HTTP-Method":"MERGE"})),[4,Object(b.d)(this,t)];case 1:return[2,{data:e.sent(),web:this}]}})})},v.prototype.applyTheme=function(e,t,n,r){var i=Object(d.n)({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:r});return Object(b.d)(this.clone(m,"applytheme"),i)},v.prototype.applyWebTemplate=function(e){var t=this.clone(m,"applywebtemplate");return t.concat("(webTemplate='"+Object(f.a)(e)+"')"),Object(b.d)(t)},v.prototype.availableWebTemplates=function(e,t){void 0===e&&(e=1033),void 0===t&&(t=!0);var n="getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")";return O.a.configure(Object(o.b)(this,n),"w.availableWebTemplates")},v.prototype.getChanges=function(e){var t=Object(d.n)({query:Object(l.assign)(Object(h.a)("SP.ChangeQuery"),e)});return Object(b.d)(this.clone(m,"getchanges"),t)},v.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),Object(b.b)(this.clone(m,"maptoicon(filename='"+Object(f.a)(e)+"', progid='"+Object(f.a)(n)+"', size="+t+")"))},v.prototype.getStorageEntity=function(e){return Object(b.b)(this.clone(m,"getStorageEntity('"+Object(f.a)(e)+"')"))},v.prototype.setStorageEntity=function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=""),Object(b.d)(this.clone(m,"setStorageEntity"),Object(d.n)({comments:r,description:n,key:e,value:t}))},v.prototype.removeStorageEntity=function(e){return Object(b.d)(this.clone(m,"removeStorageEntity('"+Object(f.a)(e)+"')"))},Object(u.b)([Object(O.a)("w.getParentWeb")],v.prototype,"getParentWeb",null),Object(u.b)([Object(O.a)("w.update")],v.prototype,"update",null),Object(u.b)([Object(O.a)("w.applyTheme")],v.prototype,"applyTheme",null),Object(u.b)([Object(O.a)("w.applyWebTemplate")],v.prototype,"applyWebTemplate",null),Object(u.b)([Object(O.a)("w.getChanges")],v.prototype,"getChanges",null),Object(u.b)([Object(O.a)("w.mapToIcon")],v.prototype,"mapToIcon",null),Object(u.b)([Object(O.a)("w.getStorageEntity")],v.prototype,"getStorageEntity",null),Object(u.b)([Object(O.a)("w.setStorageEntity")],v.prototype,"setStorageEntity",null),Object(u.b)([Object(O.a)("w.removeStorageEntity")],v.prototype,"removeStorageEntity",null),Object(u.b)([Object(c.a)("_api/web")],v)),m=Object(o.i)(j);function v(){var e=null!==r&&r.apply(this,arguments)||this;return e.delete=Object(o.g)("w"),e}function S(){return null!==i&&i.apply(this,arguments)||this}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(0);function r(r){return function(e){return n=e,Object(i.c)(t,n),t;function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.call(this,e[0],1<e.length&&void 0!==e[1]?e[1]:r)||this}var n}}},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return p}),n.d(t,"e",function(){return h});function r(c){return function(i,o){return Object(s.a)(this,void 0,void 0,function(){var t,n,r;return Object(s.d)(this,function(e){return t=Object(u.p)(i.data),n=Object(a.objectDefinedNotNull)(t.batch)?t.batch.addDependency():function(){},r=i.toUrlAndQuery(),Object(a.mergeOptions)(t.options,o),[2,c(Object.assign({},t,{batchDependency:n,url:r}))]})})}}var s=n(0),a=n(1),u=n(2),i=n(29),o=Object(u.q)(function(){return new i.a}),c=function(e,t){return r(o("GET"))(e,t)},l=function(e,t){return r(o("POST"))(e,t)},d=function(e,t){return r(o("DELETE"))(e,t)},p=function(e,t){return r(o("PATCH"))(e,t)},h=function(e,t){return r(o("PUT"))(e,t)}},function(e,t,n){"use strict";function r(e){return{__metadata:{type:e}}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"c",function(){return v}),n.d(t,"e",function(){return S}),n.d(t,"b",function(){return T}),n.d(t,"d",function(){return r}),n.d(t,"a",function(){return i});var r,i,o,c,s,a,u=n(0),l=n(1),d=n(2),p=n(4),h=n(16),b=n(10),f=n(8),O=n(5),g=n(12),y=n(3),j=n(22),m=(c=p.e,Object(u.c)(I,c),I.prototype.getById=function(e){return y.a.configure(T(this).concat("('"+e+"')"),"ls.getById")},I.prototype.getByTitle=function(e){return y.a.configure(T(this,"getByTitle('"+Object(g.a)(e)+"')"),"ls.getByTitle")},I.prototype.add=function(n,r,i,o,c){return void 0===r&&(r=""),void 0===i&&(i=100),void 0===o&&(o=!1),void 0===c&&(c={}),Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=Object.assign({AllowContentTypes:o,BaseTemplate:i,ContentTypesEnabled:o,Description:r,Title:n},Object(b.a)("SP.List"),c),[4,Object(O.d)(this,Object(d.n)(t))];case 1:return[2,{data:e.sent(),list:this.getByTitle(t.Title)}]}})})},I.prototype.ensure=function(r,i,o,c,s){return void 0===i&&(i=""),void 0===o&&(o=100),void 0===c&&(c=!1),void 0===s&&(s={}),Object(u.a)(this,void 0,void 0,function(){var t,n;return Object(u.d)(this,function(e){switch(e.label){case 0:if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");t=Object(l.assign)(s,{Title:r,Description:i,ContentTypesEnabled:c},!0),n=this.getByTitle(t.Title),e.label=1;case 1:return e.trys.push([1,4,,6]),[4,n.select("Title")()];case 2:return e.sent(),[4,n.update(t).then(function(e){return e.data})];case 3:return[2,{created:!1,data:e.sent(),list:this.getByTitle(t.Title)}];case 4:return e.sent(),[4,this.add(r,i,o,c,t).then(function(e){return e.data})];case 5:return[2,{created:!0,data:e.sent(),list:this.getByTitle(t.Title)}];case 6:return[2]}})})},I.prototype.ensureSiteAssetsLibrary=function(){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(O.d)(this.clone(v,"ensuresiteassetslibrary"))];case 1:return t=e.sent(),[2,T(Object(h.a)(t))]}})})},I.prototype.ensureSitePagesLibrary=function(){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(O.d)(this.clone(v,"ensuresitepageslibrary"))];case 1:return t=e.sent(),[2,T(Object(h.a)(t))]}})})},Object(u.b)([Object(y.a)("ls.add")],I.prototype,"add",null),Object(u.b)([Object(y.a)("ls.ensure")],I.prototype,"ensure",null),Object(u.b)([Object(y.a)("ls.ensureSiteAssetsLibrary")],I.prototype,"ensureSiteAssetsLibrary",null),Object(u.b)([Object(y.a)("ls.ensureSitePagesLibrary")],I.prototype,"ensureSitePagesLibrary",null),Object(u.b)([Object(f.a)("lists")],I)),v=Object(p.i)(m),S=(o=p.f,Object(u.c)(P,o),Object.defineProperty(P.prototype,"effectiveBasePermissions",{get:function(){return y.a.configure(Object(p.a)(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"eventReceivers",{get:function(){return y.a.configure(Object(p.b)(this,"EventReceivers"),"l.eventReceivers")},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"relatedFields",{get:function(){return y.a.configure(Object(p.a)(this,"getRelatedFields"),"l.relatedFields")},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"informationRightsManagementSettings",{get:function(){return y.a.configure(Object(p.a)(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")},enumerable:!1,configurable:!0}),P.prototype.update=function(i,o){return void 0===o&&(o="*"),Object(u.a)(this,void 0,void 0,function(){var t,n,r;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=Object(d.n)(Object(l.assign)(Object(b.a)("SP.List"),i),Object(d.x)({"IF-Match":o,"X-HTTP-Method":"MERGE"})),[4,Object(O.d)(this,t)];case 1:return n=e.sent(),r=this,Object(l.hOP)(i,"Title")&&(r=this.getParent(T,this.parentUrl,"getByTitle('"+i.Title+"')")),[2,{data:n,list:r}]}})})},P.prototype.getChanges=function(e){return Object(O.d)(this.clone(T,"getchanges"),Object(d.n)({query:Object(l.assign)(Object(b.a)("SP.ChangeQuery"),e)}))},P.prototype.getItemsByCAMLQuery=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.clone(T,"getitems");return Object(O.d)(r.expand.apply(r,t),Object(d.n)({query:Object(l.assign)(Object(b.a)("SP.CamlQuery"),e)}))},P.prototype.getListItemChangesSinceToken=function(e){var t=this.clone(T,"getlistitemchangessincetoken").usingParser({parse:function(e){return e.text()}});return Object(O.d)(t,Object(d.n)({query:Object(l.assign)(Object(b.a)("SP.ChangeLogItemQuery"),e)}))},P.prototype.recycle=function(){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(O.d)(this.clone(T,"recycle"))];case 1:return t=e.sent(),[2,Object(l.hOP)(t,"Recycle")?t.Recycle:t]}})})},P.prototype.renderListData=function(r){return Object(u.a)(this,void 0,void 0,function(){var t,n;return Object(u.d)(this,function(e){switch(e.label){case 0:return(t=this.clone(T,"renderlistdata(@viewXml)")).query.set("@viewXml","'"+r+"'"),[4,Object(O.d)(t)];case 1:return n=e.sent(),[2,JSON.parse(Object(l.hOP)(n,"RenderListData")?n.RenderListData:n)]}})})},P.prototype.renderListDataAsStream=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=new Map),Object(l.hOP)(e,"RenderOptions")&&Object(l.isArray)(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce(function(e,t){return e+t}));var r=Object(d.n)({overrideParameters:Object(l.assign)(Object(b.a)("SP.RenderListDataOverrideParameters"),t),parameters:Object(l.assign)(Object(b.a)("SP.RenderListDataParameters"),e)}),i=this.clone(T,"RenderListDataAsStream",!0);return n&&0<n.size&&n.forEach(function(e,t){return i.query.set(t,e)}),Object(O.d)(i,r)},P.prototype.renderListFormData=function(n,r,i){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(O.d)(this.clone(T,"renderlistformdata(itemid="+n+", formid='"+r+"', mode='"+i+"')"))];case 1:return t=e.sent(),[2,JSON.parse(Object(l.hOP)(t,"RenderListFormData")?t.RenderListFormData:t)]}})})},P.prototype.reserveListItemId=function(){return Object(u.a)(this,void 0,void 0,function(){var t;return Object(u.d)(this,function(e){switch(e.label){case 0:return[4,Object(O.d)(this.clone(T,"reservelistitemid"))];case 1:return t=e.sent(),[2,Object(l.hOP)(t,"ReserveListItemId")?t.ReserveListItemId:t]}})})},P.prototype.getListItemEntityTypeFullName=function(){return this.clone(T,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},P.prototype.addValidateUpdateItemUsingPath=function(r,i,o,c,s){return void 0===o&&(o=!1),Object(u.a)(this,void 0,void 0,function(){var t,n;return Object(u.d)(this,function(e){switch(e.label){case 0:return t={FolderPath:Object(j.a)(i)},Object(l.objectDefinedNotNull)(s)&&(s.leafName&&(t.LeafName=Object(j.a)(s.leafName)),s.objectType&&(t.UnderlyingObjectType=s.objectType)),[4,Object(O.d)(this.clone(T,"AddValidateUpdateItemUsingPath()"),Object(d.n)({bNewDocumentUpdate:o,checkInComment:c,formValues:r,listItemCreateInfo:Object(l.assign)(Object(b.a)("SP.ListItemCreationInformationUsingPath"),t)}))];case 1:return n=e.sent(),[2,Object(l.hOP)(n,"AddValidateUpdateItemUsingPath")?n.AddValidateUpdateItemUsingPath:n]}})})},Object(u.b)([Object(y.a)("l.update")],P.prototype,"update",null),Object(u.b)([Object(y.a)("l.getChanges")],P.prototype,"getChanges",null),Object(u.b)([Object(y.a)("l.CAMLQuery")],P.prototype,"getItemsByCAMLQuery",null),Object(u.b)([Object(y.a)("l.ChangesSinceToken")],P.prototype,"getListItemChangesSinceToken",null),Object(u.b)([Object(y.a)("l.recycle")],P.prototype,"recycle",null),Object(u.b)([Object(y.a)("l.renderListData")],P.prototype,"renderListData",null),Object(u.b)([Object(y.a)("l.AsStream")],P.prototype,"renderListDataAsStream",null),Object(u.b)([Object(y.a)("l.renderListFormData")],P.prototype,"renderListFormData",null),Object(u.b)([Object(y.a)("l.reserveListItemId")],P.prototype,"reserveListItemId",null),Object(u.b)([Object(y.a)("l.getListItemEntityTypeFullName")],P.prototype,"getListItemEntityTypeFullName",null),Object(u.b)([Object(y.a)("l.addValidateUpdateItemUsingPath")],P.prototype,"addValidateUpdateItemUsingPath",null),P),T=Object(p.i)(S);function P(){var e=null!==o&&o.apply(this,arguments)||this;return e.delete=Object(p.h)("l"),e}function I(){return null!==c&&c.apply(this,arguments)||this}(a=r=r||{})[a.None=0]="None",a[a.ContextInfo=1]="ContextInfo",a[a.ListData=2]="ListData",a[a.ListSchema=4]="ListSchema",a[a.MenuView=8]="MenuView",a[a.ListContentType=16]="ListContentType",a[a.FileSystemItemId=32]="FileSystemItemId",a[a.ClientFormSchema=64]="ClientFormSchema",a[a.QuickLaunch=128]="QuickLaunch",a[a.Spotlight=256]="Spotlight",a[a.Visualization=512]="Visualization",a[a.ViewMetadata=1024]="ViewMetadata",a[a.DisableAutoHyperlink=2048]="DisableAutoHyperlink",a[a.EnableMediaTAUrls=4096]="EnableMediaTAUrls",a[a.ParentInfo=8192]="ParentInfo",a[a.PageContextInfo=16384]="PageContextInfo",a[a.ClientSideComponentManifest=32768]="ClientSideComponentManifest",(s=i=i||{})[s.Display=1]="Display",s[s.Edit=2]="Edit",s[s.New=3]="New"},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),i=n(15);function o(e){return Object(r.stringIsNullOrEmpty)(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,function(e,t,n){return i.d.write("Rewriting aliased parameter from match "+e+" to label: "+t+" value: "+n,0),"!"+t+"::"+encodeURIComponent(n.replace(/\'/gi,"''"))}):encodeURIComponent(e.replace(/\'/gi,"''"))}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1);function i(e){if(Object(r.stringIsNullOrEmpty)(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),-1<t?e.substr(0,t):e}},function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"f",function(){return v}),n.d(t,"a",function(){return S}),n.d(t,"c",function(){return P}),n.d(t,"b",function(){return w}),n.d(t,"e",function(){return _});var r,i,o,c,s,a,u=n(0),l=n(4),d=n(1),p=n(11),h=n(2),b=n(15),f=n(10),O=n(8),g=n(5),y=n(3),j=(a=l.e,Object(u.c)(k,a),k.prototype.getById=function(e){return y.a.configure(S(this).concat("("+e+")"),"is.getById")},k.prototype.getItemByStringId=function(e){return y.a.configure(S(this.parentUrl,"getItemByStringId('"+e+"')"),"is.getItemByStringId")},k.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},k.prototype.getPaged=function(){return this.usingParser(new C(this))()},k.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),b.d.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var o=m(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&o.query.set(t,e)}),new Promise(function(t,n){var r=[],i=function(e){[].push.apply(r,e.results),e.hasNext?e.getNext().then(i).catch(n):t(r)};o.getPaged().then(i).catch(n)})},k.prototype.add=function(c,s){return void 0===c&&(c={}),void 0===s&&(s=null),Object(u.a)(this,void 0,void 0,function(){var t,n,r,i,o=this;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(s)];case 1:return n=e.sent(),r=Object(h.n)(Object(d.assign)(Object(f.a)(n),c)),i=Object(g.d)(this.clone(m,""),r).then(function(e){return{data:e,item:o.getById(e.Id)}}),t(),[2,i]}})})},k.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(p.b).getListItemEntityTypeFullName()},Object(u.b)([Object(y.a)("is.getPaged")],k.prototype,"getPaged",null),Object(u.b)([Object(y.a)("is.getAll")],k.prototype,"getAll",null),Object(u.b)([Object(y.a)("is.add")],k.prototype,"add",null),Object(u.b)([Object(O.a)("items")],k)),m=Object(l.i)(j),v=(s=l.f,Object(u.c)(D,s),Object.defineProperty(D.prototype,"effectiveBasePermissions",{get:function(){return y.a.configure(Object(l.a)(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"effectiveBasePermissionsForUI",{get:function(){return y.a.configure(Object(l.a)(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"fieldValuesAsHTML",{get:function(){return y.a.configure(Object(l.c)(this,"FieldValuesAsHTML"),"i.fvHTML")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"fieldValuesAsText",{get:function(){return y.a.configure(Object(l.c)(this,"FieldValuesAsText"),"i.fvText")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"fieldValuesForEdit",{get:function(){return y.a.configure(Object(l.c)(this,"FieldValuesForEdit"),"i.fvEdit")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"versions",{get:function(){return y.a.configure(P(this),"i.versions")},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"list",{get:function(){return this.getParent(p.b,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!1,configurable:!0}),D.prototype.update=function(o,c,s){return void 0===c&&(c="*"),void 0===s&&(s=null),Object(u.a)(this,void 0,void 0,function(){var t,n,r,i;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.ensureListItemEntityTypeName(s)];case 1:return n=e.sent(),r=Object(h.n)(Object(d.assign)(Object(f.a)(n),o),Object(h.x)({"IF-Match":c,"X-HTTP-Method":"MERGE"})),t(),i=y.a.configure(this.clone(S).usingParser(new R),"i.update"),[4,Object(g.d)(i,r)];case 2:return[2,{data:e.sent(),item:this}]}})})},D.prototype.recycle=function(){return Object(g.d)(this.clone(S,"recycle"))},D.prototype.getWopiFrameUrl=function(r){return void 0===r&&(r=0),Object(u.a)(this,void 0,void 0,function(){var t,n;return Object(u.d)(this,function(e){switch(e.label){case 0:return(t=this.clone(S,"getWOPIFrameUrl(@action)")).query.set("@action",r),[4,Object(g.d)(t)];case 1:return n=e.sent(),Object(d.hOP)(n,"GetWOPIFrameUrl")?[2,n.GetWOPIFrameUrl]:[2,n]}})})},D.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),Object(g.d)(this.clone(S,"validateupdatelistitem"),Object(h.n)({formValues:e,bNewDocumentUpdate:t}))},D.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},Object(u.b)([Object(y.a)("i.recycle")],D.prototype,"recycle",null),Object(u.b)([Object(y.a)("i.getWopiFrameUrl")],D.prototype,"getWopiFrameUrl",null),Object(u.b)([Object(y.a)("i.validateUpdateListItem")],D.prototype,"validateUpdateListItem",null),D),S=Object(l.i)(v),T=(c=l.e,Object(u.c)(x,c),x.prototype.getById=function(e){return y.a.configure(w(this).concat("("+e+")"),"iv.getById")},Object(u.b)([Object(O.a)("versions")],x)),P=Object(l.i)(T),I=(o=l.f,Object(u.c)(U,o),U),w=Object(l.i)(I),_=(Object.defineProperty(A.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&0<this.nextUrl.length},enumerable:!1,configurable:!0}),A.prototype.getNext=function(){return this.hasNext?y.a.configure(m(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged():new Promise(function(e){return e(null)})},A),C=(i=h.i,Object(u.c)(N,i),N.prototype.parse=function(t){var r=this;return new Promise(function(n,e){r.handleError(t,e)&&t.json().then(function(e){var t=Object(d.hOP)(e,"d")&&Object(d.hOP)(e.d,"__next")?e.d.__next:e["odata.nextLink"];n(new _(r._parent,t,r.parseODataJSON(e)))})})},N),R=(r=h.i,Object(u.c)(E,r),E.prototype.parse=function(n){var r=this;return new Promise(function(e,t){r.handleError(n,t)&&e({"odata.etag":n.headers.get("etag")})})},E);function E(){return null!==r&&r.apply(this,arguments)||this}function N(e){var t=i.call(this)||this;return t._parent=e,t}function A(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}function U(){var e=null!==o&&o.apply(this,arguments)||this;return e.delete=Object(l.h)("iv"),e}function x(){return null!==c&&c.apply(this,arguments)||this}function D(){var e=null!==s&&s.apply(this,arguments)||this;return e.delete=Object(l.h)("i"),e}function k(){return null!==a&&a.apply(this,arguments)||this}},function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return l});var r,i,o=(Object.defineProperty(a,"activeLogLevel",{get:function(){return a.instance.activeLogLevel},set:function(e){a.instance.activeLogLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(a,"instance",{get:function(){return null!=a._instance||(a._instance=new c),a._instance},enumerable:!1,configurable:!0}),a.subscribe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){return a.instance.subscribe(e)})},a.clearSubscribers=function(){return a.instance.clearSubscribers()},Object.defineProperty(a,"count",{get:function(){return a.instance.count},enumerable:!1,configurable:!0}),a.write=function(e,t){void 0===t&&(t=1),a.instance.log({level:t,message:e})},a.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},a.log=function(e){a.instance.log(e)},a.error=function(e){a.instance.log({data:e,level:3,message:e.message})},a),c=(s.prototype.subscribe=function(e){this.subscribers.push(e)},s.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(s.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!1,configurable:!0}),s.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},s.prototype.log=function(t){void 0!==t&&this.activeLogLevel<=t.level&&this.subscribers.map(function(e){return e.log(t)})},s);function s(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}function a(){}(i=r=r||{})[i.Verbose=0]="Verbose",i[i.Info=1]="Info",i[i.Warning=2]="Warning",i[i.Error=3]="Error",i[i.Off=99]="Off";var u=(p.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},p.prototype.format=function(e){var t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(" Data: Error in stringify of supplied data "+e)}return t.join("")},p),l=(d.prototype.log=function(e){this.method(e)},d);function d(e){this.method=e}function p(){}},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return O});var i=n(0),o=n(1),c=n(15),r=n(2),s=n(13);function a(e){var t,n=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];return Object(o.hOP)(e,r[0])&&"SP.Web"===e[r[0]]?Object(o.hOP)(e,r[4])?n.push(e[r[4]]):Object(o.hOP)(e,r[2])&&n.push(e.__metadata.uri):Object(o.hOP)(e,r[3])&&Object(o.hOP)(e,r[1])?(t=Object(o.isUrlAbsolute)(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]],n.push(Object(s.a)(e[r[3]]),"_api",t)):Object(o.hOP)(e,r[1])?n.push("_api",e[r[1]]):Object(o.hOP)(e,r[2])&&n.push(e.__metadata.uri),n.length<1?(c.d.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):o.combine.apply(void 0,Object(i.e)(n))}var u,l,d=(l=r.i,Object(i.c)(b,l),b.prototype.parse=function(e){var n=this;return l.prototype.parse.call(this,e).then(function(e){var t=n.factory(a(e),null);return Object(o.assign)(t,e)})},b),p=(u=r.i,Object(i.c)(h,u),h.prototype.parse=function(e){var n=this;return u.prototype.parse.call(this,e).then(function(e){return e.map(function(e){var t=n.factory(a(e),null);return Object(o.assign)(t,e)})})},h);function h(e){var n=u.call(this)||this;return n.factory=e,n.hydrate=function(e){return e.map(function(e){var t=n.factory(a(e),null);return Object(o.assign)(t,e)})},n}function b(e){var n=l.call(this)||this;return n.factory=e,n.hydrate=function(e){var t=n.factory(a(e),null);return Object(o.assign)(t,e)},n}function f(e){return new d(e)}function O(e){return new p(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(20),i=(o.prototype.configure=function(e,t){return void 0===t&&(t=""),new o(e,t)},o.prototype.setup=function(e){e.pageContext?Object(r.c)({spfxContext:e}):Object(r.c)(e)},o);function o(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}new i},function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return u});var r,i=n(0),o=n(6),c=n(23),s=n(35),a=(r=o.c,Object(i.c)(l,r),l.prototype.createBatch=function(){return new s.a},l.prototype.setup=function(e){Object(c.b)(e)},l),u=new a("v1.0");function l(){return null!==r&&r.apply(this,arguments)||this}},function(e,t,n){"use strict";n.d(t,"b",function(){return y}),n.d(t,"a",function(){return j});var r,l=n(0),i=n(4),o=n(8),c=n(7),s=n(1),a=n(2),u=n(16),d=n(5),p=n(28),h=n(12),b=n(3),f=n(10),O=n(13),g=n(20),y=(r=i.f,Object(l.c)(m,r),Object.defineProperty(m.prototype,"rootWeb",{get:function(){return b.a.configure(Object(c.a)(this,"rootweb"),"si.rootWeb")},enumerable:!1,configurable:!0}),m.prototype.getRootWeb=function(){return Object(l.a)(this,void 0,void 0,function(){var t;return Object(l.d)(this,function(e){switch(e.label){case 0:return[4,this.rootWeb.select("Url")()];case 1:return t=e.sent(),[2,b.a.configure(Object(c.a)(t.Url),"si.getRootWeb")]}})})},m.prototype.getContextInfo=function(){return Object(l.a)(this,void 0,void 0,function(){var t,n,r;return Object(l.d)(this,function(e){switch(e.label){case 0:return t=b.a.configure(j(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),[4,Object(d.d)(t)];case 1:return n=e.sent(),Object(s.hOP)(n,"GetContextWebInformation")?((r=n.GetContextWebInformation).SupportedSchemaVersions=r.SupportedSchemaVersions.results,[2,r]):[2,n]}})})},m.prototype.createBatch=function(){return new p.a(this.parentUrl)},m.prototype.delete=function(){return Object(l.a)(this,void 0,void 0,function(){var t,n;return Object(l.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(j,"").select("Id")()];case 1:return t=e.sent(),n=b.a.configure(j(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete"),[4,Object(d.d)(n,Object(a.n)({siteId:t.Id}))];case 2:return e.sent(),[2]}})})},m.prototype.getDocumentLibraries=function(r){return Object(l.a)(this,void 0,void 0,function(){var t,n;return Object(l.d)(this,function(e){switch(e.label){case 0:return(t=b.a.configure(Object(i.a)("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries")).query.set("@v","'"+Object(h.a)(r)+"'"),[4,t()];case 1:return n=e.sent(),[2,Object(s.hOP)(n,"GetDocumentLibraries")?n.GetDocumentLibraries:n]}})})},m.prototype.getWebUrlFromPageUrl=function(r){return Object(l.a)(this,void 0,void 0,function(){var t,n;return Object(l.d)(this,function(e){switch(e.label){case 0:return(t=b.a.configure(Object(i.a)("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl")).query.set("@v","'"+Object(h.a)(r)+"'"),[4,t()];case 1:return n=e.sent(),[2,Object(s.hOP)(n,"GetWebUrlFromPageUrl")?n.GetWebUrlFromPageUrl:n]}})})},m.prototype.getChanges=function(e){var t=Object(a.n)({query:Object(s.assign)(Object(f.a)("SP.ChangeQuery"),e)});return Object(d.d)(this.clone(c.a,"getchanges"),t)},m.prototype.openWebById=function(n){return Object(l.a)(this,void 0,void 0,function(){var t;return Object(l.d)(this,function(e){switch(e.label){case 0:return[4,Object(d.d)(this.clone(j,"openWebById('"+n+"')"))];case 1:return[2,{data:t=e.sent(),web:Object(c.a)(Object(O.a)(Object(u.a)(t)))}]}})})},m.prototype.createCommunicationSite=function(t,n,r,i,o,c,s,a,u){return void 0===n&&(n=1033),void 0===r&&(r=!1),Object(l.a)(this,void 0,void 0,function(){return Object(l.d)(this,function(e){return[2,this.createCommunicationSiteFromProps({Classification:c,Description:o,HubSiteId:a,Lcid:n,Owner:u,ShareByEmailEnabled:r,SiteDesignId:s,Title:t,Url:i})]})})},m.prototype.createCommunicationSiteFromProps=function(r){return Object(l.a)(this,void 0,void 0,function(){var t,n;return Object(l.d)(this,function(e){return t=Object.assign({},{Classification:"",Description:"",HubSiteId:g.b,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:g.b,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:g.b},r),n=Object(a.n)({request:Object(s.assign)(Object(f.a)("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),t)}),[2,Object(d.d)(j(Object(O.a)(this.toUrl()),"/_api/SPSiteManager/Create"),n)]})})},m.prototype.exists=function(n){return Object(l.a)(this,void 0,void 0,function(){var t;return Object(l.d)(this,function(e){switch(e.label){case 0:return t=Object(a.n)({url:n}),[4,Object(d.d)(j(Object(O.a)(this.toUrl()),"/_api/SP.Site.Exists"),t)];case 1:return[2,e.sent()]}})})},m.prototype.createModernTeamSite=function(t,n,r,i,o,c,s,a,u){return Object(l.a)(this,void 0,void 0,function(){return Object(l.d)(this,function(e){return[2,this.createModernTeamSiteFromProps({alias:n,classification:c,description:o,displayName:t,hubSiteId:a,isPublic:r,lcid:i,owners:s,siteDesignId:u})]})})},m.prototype.createModernTeamSiteFromProps=function(r){return Object(l.a)(this,void 0,void 0,function(){var t,n;return Object(l.d)(this,function(e){return t=Object.assign({},{classification:"",description:"",hubSiteId:g.b,isPublic:!0,lcid:1033,owners:[]},r),n={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:{results:["SPSiteLanguage:"+t.lcid,"HubSiteId:"+t.hubSiteId]},Description:t.description,Owners:{results:t.owners}}},t.siteDesignId&&n.optionalParams.CreationOptions.results.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+t.siteDesignId),[2,Object(d.d)(j(Object(O.a)(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),Object(a.n)(n))]})})},Object(l.b)([Object(b.a)("si.getChanges")],m.prototype,"getChanges",null),Object(l.b)([Object(b.a)("si.openWebById")],m.prototype,"openWebById",null),Object(l.b)([Object(o.a)("_api/site")],m)),j=Object(i.i)(y);function m(){return null!==r&&r.apply(this,arguments)||this}},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return c});var r=n(1),i="00000000-0000-0000-0000-000000000000";function o(e){r.RuntimeConfig.assign(e)}var c=(Object.defineProperty(s.prototype,"headers",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"baseUrl",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:Object(r.objectDefinedNotNull)(r.RuntimeConfig.spfxContext)?r.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"fetchClientFactory",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new r.FetchClient}},enumerable:!1,configurable:!0}),new s);function s(){}},function(e,t,n){"use strict";function r(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function i(e,t,n){var r=new Date(e.toString());switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!h(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function c(e){for(var t=new Array(e),n=0;n<e;n++)t[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t.join("")}function s(){var n=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"===e?t:3&t|8).toString(16)})}function a(e){return"function"==typeof e}function u(e){return null!=e}function l(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function d(t,n,e,r){if(void 0===e&&(e=!1),void 0===r&&(r=function(){return!0}),!u(n))return t;var i=e?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(n).filter(function(e){return i(t,e)&&r(e)}).reduce(function(e,t){return e[t]=n[t],e},t)}function p(e){return/^https?:\/\/|^\/\//i.test(e)}function h(e){return null==e||e.length<1}function b(e){if(h(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function f(e){return JSON.stringify(e)}function O(e,t){return Object.hasOwnProperty.call(e,t)}function g(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}n.d(t,"d",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"g",function(){return c}),n.d(t,"e",function(){return s}),n.d(t,"j",function(){return a}),n.d(t,"m",function(){return u}),n.d(t,"i",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"k",function(){return p}),n.d(t,"o",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"l",function(){return f}),n.d(t,"h",function(){return O}),n.d(t,"f",function(){return g})},function(e,t,n){"use strict";function r(e){return{DecodedUrl:e,__metadata:{type:"SP.ResourcePath"}}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return l});var i,o=n(1),c=n(0),r=n(49),s=(i=o.BearerTokenFetchClient,Object(c.c)(a,i),a.fromSPFxContext=function(e){return new o.SPFxAdalClient(e)},a.prototype.fetch=function(n,r){return Object(c.a)(this,void 0,void 0,function(){var t;return Object(c.d)(this,function(e){switch(e.label){case 0:if(!Object(o.isUrlAbsolute)(n))throw Error("You must supply absolute urls to AdalClient.fetch.");return[4,this.getToken(Object(o.getADALResource)(n))];case 1:return t=e.sent(),this.token=t,[2,i.prototype.fetch.call(this,n,r)]}})})},a.prototype.getToken=function(t){return Object(c.a)(this,void 0,void 0,function(){return Object(c.d)(this,function(e){switch(e.label){case 0:return[4,this.login()];case 1:return e.sent(),[2,new Promise(function(n,r){a._authContext.acquireToken(t,function(e,t){e?r(Error(e)):n(t)})})]}})})},a.prototype.ensureAuthContext=function(){return Object(c.a)(this,void 0,void 0,function(){var t=this;return Object(c.d)(this,function(e){return null===a._authContext&&(a._authContext=r.inject({clientId:this.clientId,displayCall:function(e){t._displayCallback&&t._displayCallback(e)},navigateToLoginRequestUrl:!1,redirectUri:this.redirectUri,tenant:this.tenant})),[2]})})},a.prototype.login=function(){var o=this;return this._loginPromise||(this._loginPromise=new Promise(function(r,i){o.ensureAuthContext().then(function(e){if(a._authContext.getCachedUser())return r();o._displayCallback=function(e){var t=window.open(e,"login","width=483, height=600");if(!t)return i(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));t&&t.focus&&t.focus();var n=window.setInterval(function(){try{if(!t||t.closed||void 0===t.closed)throw Error("No popup window.");-1!==t.document.URL.indexOf(o.redirectUri)&&(a._authContext.handleWindowCallback(t.location.hash),t.close(),r())}catch(e){i(e)}finally{window.clearInterval(n)}},300)},a._authContext._loginInProgress=!1,a._authContext.login(),o._displayCallback=null})})),this._loginPromise},a._authContext=null,a);function a(e,t,n){var r=i.call(this,null)||this;return r.clientId=e,r.tenant=t,r.redirectUri=n,r._displayCallback=null,r._loginPromise=null,r}function u(e){o.RuntimeConfig.assign(e)}var l=(Object.defineProperty(d.prototype,"headers",{get:function(){var e=o.RuntimeConfig.get("graph");return null!=e&&void 0!==e.headers?e.headers:{}},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"fetchClientFactory",{get:function(){var e=o.RuntimeConfig.get("graph");if(null!=e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==o.RuntimeConfig.spfxContext)return function(){return s.fromSPFxContext(o.RuntimeConfig.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!1,configurable:!0}),new d);function d(){}},function(e,t,n){"use strict";var r=n(17),i=n(19);n.d(t,"a",function(){return i.a}),Reflect.defineProperty(r.a.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return Object(i.a)(this._baseUrl).configure(this._options)}})},function(e,t,n){"use strict";var r=n(7),i=n(17);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),Reflect.defineProperty(i.a.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return Object(r.a)(this._baseUrl).configure(this._options)}}),i.a.prototype.createBatch=function(){return this.web.createBatch()}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var u=n(0),l=n(1),d=n(20),a=n(13),p=n(3),h=n(2),r=(i.prototype.fetch=function(c,s){return void 0===s&&(s={}),Object(u.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(u.d)(this,function(e){switch(e.label){case 0:return t=Object(l.assign)(s,{cache:"no-cache",credentials:"same-origin"},!0),n=new Headers,Object(l.mergeHeaders)(n,d.a.headers),Object(l.mergeHeaders)(n,s.headers),n.has("Accept")||n.append("Accept","application/json"),n.has("Content-Type")||n.append("Content-Type","application/json;odata=verbose;charset=utf-8"),n.has("X-ClientService-ClientTag")||(r=p.a.getClientTag(n),32<(i="PnPCoreJS:$$Version$$:"+r).length&&(i=i.substr(0,32)),n.append("X-ClientService-ClientTag",i)),!(t=Object(l.assign)(t,{headers:n})).method||"GET"===t.method.toUpperCase()||n.has("X-RequestDigest")||n.has("Authorization")?[3,2]:[4,this._digestCache(Object(a.a)(c))];case 1:o=e.sent(),n.append("X-RequestDigest",o),e.label=2;case 2:return[2,this.fetchRaw(c,t)]}})})},i.prototype.fetchRaw=function(e,r){var i=this;void 0===r&&(r={});var t=new Headers;Object(l.mergeHeaders)(t,r.headers),r=Object(l.assign)(r,{headers:t});var o=function(n){function t(e){var t;e.headers.has("Retry-After")?t=1e3*parseInt(e.headers.get("Retry-After"),10):(t=n.delay,n.delay*=2),n.attempts++,n.retryCount<=n.attempts?n.reject(Error("Retry count exceeded ("+n.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(Object(l.getCtxCallback)(i,o,n),t)}i._impl.fetch(e,r).then(function(e){429===e.status?t(e):n.resolve(e)}).catch(function(e){503===e.status||504===e.status?t(e):n.reject(e)})};return new Promise(function(e,t){o.call(i,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})})},i.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(l.assign)(t,{method:"GET"});return this.fetch(e,n)},i.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(l.assign)(t,{method:"POST"});return this.fetch(e,n)},i.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(l.assign)(t,{method:"PATCH"});return this.fetch(e,n)},i.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(l.assign)(t,{method:"DELETE"});return this.fetch(e,n)},i),b=new Map;function i(e){void 0===e&&(e=d.a.fetchClientFactory()),this._impl=e,this._digestCache=function(a){var e=this;return function(s){return Object(u.a)(e,void 0,void 0,function(){var t,n,r,i,o,c;return Object(u.d)(this,function(e){switch(e.label){case 0:return void 0!==(t=b.get(s))&&new Date<t.expiration?[2,t.value]:(n=Object(l.combine)(s,"/_api/contextinfo"),r={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},[4,a.fetchRaw(n,{cache:"no-cache",credentials:"same-origin",headers:Object(l.assign)(r,d.a.headers,!0),method:"POST"})]);case 1:return i=e.sent(),[4,(new h.i).parse(i).then(function(e){return e.GetContextWebInformation})];case 2:return o=e.sent(),c={expiration:Object(l.dateAdd)(new Date,"second",o.FormDigestTimeoutSeconds),value:o.FormDigestValue},b.set(s,c),[2,c.value]}})})}}(this)}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(1),c=n(20);function r(i){return new Promise(function(n){if(Object(o.isUrlAbsolute)(i))return n(i);if(null!==c.a.baseUrl)return n(Object(o.combine)(c.a.baseUrl,i));if(void 0!==o.safeGlobal._spPageContextInfo){if(Object(o.hOP)(o.safeGlobal._spPageContextInfo,"webAbsoluteUrl"))return n(Object(o.combine)(o.safeGlobal._spPageContextInfo.webAbsoluteUrl,i));if(Object(o.hOP)(o.safeGlobal._spPageContextInfo,"webServerRelativeUrl"))return n(Object(o.combine)(o.safeGlobal._spPageContextInfo.webServerRelativeUrl,i))}var r;return void 0!==o.safeGlobal.location&&(r=o.safeGlobal.location.toString().toLowerCase(),["/_layouts/","/siteassets/"].forEach(function(e){var t=r.indexOf(e);if(0<t)return n(Object(o.combine)(r.substr(0,t),i))})),n(i)})}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r,f=n(0),i=n(2),O=n(1),g=n(15),y=n(26),j=n(20),m=n(27),o=(r=i.a,Object(f.c)(v,r),v.ParseResponse=function(e){for(var t,n,r=[],i=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),o=e.split("\n"),c="batch",s=0;s<o.length;++s){var a=o[s];switch(c){case"batch":if("--batchresponse_"===a.substr(0,"--batchresponse_".length))c="batchHeaders";else if(""!==a.trim())throw Error("Invalid response, line "+s);break;case"batchHeaders":""===a.trim()&&(c="status");break;case"status":var u=i.exec(a);if(3!==u.length)throw Error("Invalid status, line "+s);t=parseInt(u[1],10),n=u[2],c="statusHeaders";break;case"statusHeaders":""===a.trim()&&(c="body");break;case"body":r.push(204===t?new Response:new Response(a,{status:t,statusText:n})),c="batch"}}if("status"!==c)throw Error("Unexpected end of input");return r},v.prototype.executeImpl=function(){return Object(f.a)(this,void 0,void 0,function(){var t,n,r,i,o,c,s,a,u,l,d,p,h,b=this;return Object(f.d)(this,function(e){switch(e.label){case 0:return g.d.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1?(g.d.write("Resolving empty batch.",1),[2]):(t=new y.a,[4,Object(m.a)(this.baseUrl)]);case 1:for(n=e.sent(),r=[],i="",o=0;o<this.requests.length;o++)"GET"===(c=this.requests[o]).method?(0<i.length&&(r.push("--changeset_"+i+"--\n\n"),i=""),r.push("--batch_"+this.batchId+"\n")):(i.length<1&&(i=Object(O.getGUID)(),r.push("--batch_"+this.batchId+"\n"),r.push('Content-Type: multipart/mixed; boundary="changeset_'+i+'"\n\n')),r.push("--changeset_"+i+"\n")),r.push("Content-Type: application/http\n"),r.push("Content-Transfer-Encoding: binary\n\n"),s=new Headers,a=Object(O.isUrlAbsolute)(c.url)?c.url:Object(O.combine)(n,c.url),g.d.write("["+this.batchId+"] ("+(new Date).getTime()+") Adding request "+c.method+" "+a+" to batch.",0),"GET"!==c.method?(u=c.method,l=c.options.headers,Object(O.hOP)(c,"options")&&Object(O.hOP)(c.options,"headers")&&void 0!==l["X-HTTP-Method"]&&(u=l["X-HTTP-Method"],delete l["X-HTTP-Method"]),r.push(u+" "+a+" HTTP/1.1\n"),s.set("Content-Type","application/json;odata=verbose;charset=utf-8")):r.push(c.method+" "+a+" HTTP/1.1\n"),Object(O.mergeHeaders)(s,j.a.headers),c.options&&Object(O.mergeHeaders)(s,c.options.headers),s.has("Accept")||s.append("Accept","application/json"),s.has("Content-Type")||s.append("Content-Type","application/json;odata=verbose;charset=utf-8"),s.has("X-ClientService-ClientTag")||s.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$:batch"),s.forEach(function(e,t){r.push(t+": "+e+"\n")}),r.push("\n"),c.options.body&&r.push(c.options.body+"\n\n");return 0<i.length&&(r.push("--changeset_"+i+"--\n\n"),i=""),r.push("--batch_"+this.batchId+"--\n"),d={body:r.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+this.batchId},method:"POST"},g.d.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),[4,t.fetch(Object(O.combine)(n,"/_api/$batch"),d)];case 2:return[4,e.sent().text()];case 3:if(p=e.sent(),(h=v.ParseResponse(p)).length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return g.d.write("["+this.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),[2,h.reduce(function(e,o,c){return e.then(function(e){return Object(f.a)(b,void 0,void 0,function(){var t,n,r,i;return Object(f.d)(this,function(e){switch(e.label){case 0:t=this.requests[c],g.d.write("["+t.id+"] ("+(new Date).getTime()+") Resolving request in batch "+this.batchId+".",1),e.label=1;case 1:return e.trys.push([1,3,,4]),r=(n=t).resolve,[4,t.parser.parse(o)];case 2:return r.apply(n,[e.sent()]),[3,4];case 3:return i=e.sent(),t.reject(i),[3,4];case 4:return[2]}})})})},Promise.resolve(void 0))]}})})},v);function v(e){var t=r.call(this)||this;return t.baseUrl=e,t}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(1),i=n(23),r=(c.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;Object(o.mergeHeaders)(n,i.a.headers),Object(o.mergeHeaders)(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json"),n.has("SdkVersion")||n.append("SdkVersion","PnPCoreJS/$$Version$$");var r=Object(o.assign)(t,{headers:n});return this.fetchRaw(e,r)},c.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;Object(o.mergeHeaders)(n,t.headers),t=Object(o.assign)(t,{headers:n});var i=function(n){r._impl.fetch(e,t).then(function(e){return n.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&504!==e.status&&n.reject(e);var t=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(e),setTimeout(Object(o.getCtxCallback)(r,i,n),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},c.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(o.assign)(t,{method:"GET"});return this.fetch(e,n)},c.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(o.assign)(t,{method:"POST"});return this.fetch(e,n)},c.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(o.assign)(t,{method:"PATCH"});return this.fetch(e,n)},c.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(o.assign)(t,{method:"DELETE"});return this.fetch(e,n)},c);function c(){this._impl=i.a.fetchClientFactory()}},function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return s});var r=n(31);function i(e){s.assign(e)}var o=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],c=(a.prototype.assign=function(e){this._v=Object(r.a)(this._v,Object(r.b)(e))},a.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(a.prototype,"defaultCachingStore",{get:function(){return this.get(o[0])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(o[1])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"globalCacheDisable",{get:function(){return this.get(o[2])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"enableCacheExpiration",{get:function(){return this.get(o[3])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(o[4])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"spfxContext",{get:function(){return this.get(o[5])},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"ie11",{get:function(){return this.get(o[6])},enumerable:!1,configurable:!0}),a),s=new c;function a(e){void 0===e&&(e=new Map),this._v=e,this._v.set(o[0],"session"),this._v.set(o[1],60),this._v.set(o[2],!1),this._v.set(o[3],!1),this._v.set(o[4],750),this._v.set(o[5],null),this._v.set(o[6],!1)}},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var r=n(21),i=Object(r.j)(Object.entries)?Object.entries:function(t){return Object.keys(t).map(function(e){return[e,t[e]]})};function o(e){return null!=e?new Map(i(e)):new Map}function c(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r++)e[r].forEach(function(e,t){n.set(t,e)});return n}},function(e,n,r){"use strict";(function(e){r.d(n,"a",function(){return t});var t=void 0===e?window:e}).call(this,r(52))},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(10),i=n(1);function o(t){return Object(i.assign)(Object(r.a)("Collection(SP.KeyValue)"),{results:Object.keys(t).map(function(e){return Object(i.assign)(Object(r.a)("SP.KeyValue"),{Key:e,Value:Reflect.get(t,e),ValueType:"Edm.String"})})})}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=(o.ensure=function(e,t){var n=[o.Beta,o.V1],r=new RegExp(t,"i"),i=n.filter(function(e){return!r.test(e)}).map(function(e){return e.replace(".","\\.")}),r=new RegExp("/?("+i.join("|")+")/","ig");return e.replace(r,"/"+t+"/")},o.Beta="beta",o.V1="v1.0",o);function o(){}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r,l=n(0),i=n(2),d=n(15),p=n(1),o=n(23),c=n(29),s=(r=i.a,Object(l.c)(h,r),h.makeUrlRelative=function(e){if(!Object(p.isUrlAbsolute)(e))return e;var t=e.indexOf(".com/v1.0/");return t<0?-1<(t=e.indexOf(".com/beta/"))?e.substr(t+10):e:e.substr(t+9)},h.formatRequests=function(e){var i=this;return e.map(function(e,t){var n={id:""+ ++t,method:e.method,url:i.makeUrlRelative(e.url)},r={};return void 0!==o.a.headers&&null!==o.a.headers&&(r=Object(p.assign)(r,o.a.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(r=Object(p.assign)(r,e.options.headers)),"GET"!==e.method&&(r["Content-Type"]="application/json"),void 0!==e.options.body&&null!==e.options.body&&(n=Object(p.assign)(n,{body:JSON.parse(e.options.body)}))),Object(p.assign)(n,{headers:r})})},h.parseResponse=function(c,s){return new Promise(function(e,t){if(Object(p.hOP)(s,"error"))return t(Error("Error Porcessing Batch: ("+s.error.code+") "+s.error.message));for(var n=new Array(c.length).fill(null),r=0;r<s.responses.length;++r){var i=s.responses[r],o=parseInt(i.id,10)-1;204===i.status?n[o]=new Response:n[o]=new Response(JSON.stringify(i.body),i)}e({nextLink:s.nextLink,responses:n})})},h.prototype.executeImpl=function(){var e=this;if(d.d.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return d.d.write("Resolving empty batch.",1),Promise.resolve();var s=new c.a,a=this.requests.slice(),u=!1;return new Promise(function(n,c){return Object(l.a)(e,void 0,void 0,function(){var t,r,o=this;return Object(l.d)(this,function(e){switch(e.label){case 0:t=function(){var i,t,n;return Object(l.d)(this,function(e){switch(e.label){case 0:return i=a.splice(0,r.maxRequests),t={requests:h.formatRequests(i)},n={body:Object(p.jsS)(t),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},d.d.write("["+r.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),[4,s.fetch(r.batchUrl,n).then(function(e){return e.json()}).then(function(e){return h.parseResponse(i,e)}).then(function(e){d.d.write("["+o.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.responses.reduce(function(e,t,n){var r=i[n];return d.d.write("["+o.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+r.method+" "+r.url+".",0),e.then(function(e){return r.parser.parse(t).then(r.resolve).catch(r.reject)})},Promise.resolve())}).catch(function(e){c(e),u=!0})];case 1:return e.sent(),u?[2,"break"]:[2]}})},r=this,e.label=1;case 1:return 0<a.length?[5,t()]:[3,3];case 2:return"break"===e.sent()?[3,3]:[3,1];case 3:return u||n(),[2]}})})})},h);function h(e,t){void 0===e&&(e="https://graph.microsoft.com/v1.0/$batch"),void 0===t&&(t=20);var n=r.call(this)||this;return n.batchUrl=e,n.maxRequests=t,n}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var i=n(1),r=(u.prototype.add=function(e,t){this._settings.set(e,t)},u.prototype.addJSON=function(e,t){this._settings.set(e,Object(i.jsS)(t))},u.prototype.apply=function(n){var r=this;return new Promise(function(e,t){try{r._settings=Object(i.mergeMaps)(r._settings,Object(i.objectToMap)(n)),e()}catch(e){t(e)}})},u.prototype.load=function(n){var r=this;return new Promise(function(t,e){n.getConfiguration().then(function(e){r._settings=Object(i.mergeMaps)(r._settings,Object(i.objectToMap)(e)),t()}).catch(e)})},u.prototype.get=function(e){return this._settings.get(e)||null},u.prototype.getJSON=function(e){var t=this.get(e);return null==t?t:JSON.parse(t)},u),o=(a.prototype.getWrappedProvider=function(){return this.wrappedProvider},a.prototype.getConfiguration=function(){var t=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,function(){return t.wrappedProvider.getConfiguration().then(function(e){return t.store.put(t.cacheKey,e),e})}):this.wrappedProvider.getConfiguration()},a.prototype.selectPnPCache=function(){var e=new i.PnPClientStorage;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")},a),c=(n(38),n(44),s.prototype.getConfiguration=function(){var n=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName)().then(function(e){return e.reduce(function(e,t){return e[t[n.keyFieldName]]=t[n.valueFieldName],e},{})})},s.prototype.asCaching=function(e){return void 0===e&&(e="pnp_configcache_splist_"+this.web.toUrl()+"+"+this.listTitle),new o(this,e)},s);function s(e,t,n,r){void 0===t&&(t="config"),void 0===n&&(n="Title"),void 0===r&&(r="Value"),this.web=e,this.listTitle=t,this.keyFieldName=n,this.valueFieldName=r}function a(e,t,n){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=n||this.selectPnPCache()}function u(e){void 0===e&&(e=new Map),this._settings=e}},function(e,t,n){"use strict";n.d(t,"i",function(){return u.c}),n.d(t,"h",function(){return u.b}),n.d(t,"g",function(){return u.a}),n.d(t,"p",function(){return u.i}),n.d(t,"d",function(){return l.a}),n.d(t,"k",function(){return d.a}),n.d(t,"o",function(){return p.b}),n.d(t,"r",function(){return p.d}),n.d(t,"n",function(){return p.a}),n.d(t,"q",function(){return p.c}),n.d(t,"s",function(){return p.e}),n.d(t,"t",function(){return p.f}),n.d(t,"e",function(){return h.a}),n.d(t,"f",function(){return b.a}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"v",function(){return f.a}),n.d(t,"l",function(){return O.a}),n.d(t,"m",function(){return g.a}),n.d(t,"u",function(){return v}),n.d(t,"j",function(){return m});var r,i,o,c,s,a,u=n(4),l=n(28),d=n(8),p=n(5),h=n(26),b=n(17);(a=r=r||{})[a.None=0]="None",a[a.User=1]="User",a[a.DistributionList=2]="DistributionList",a[a.SecurityGroup=4]="SecurityGroup",a[a.SharePointGroup=8]="SharePointGroup",a[a.All=15]="All",(s=i=i||{})[s.None=0]="None",s[s.UserInfoList=1]="UserInfoList",s[s.Windows=2]="Windows",s[s.MembershipProvider=4]="MembershipProvider",s[s.RoleProvider=8]="RoleProvider",s[s.All=15]="All",(c=o=o||{})[c.Invalid=-1]="Invalid",c[c.DefaultView=0]="DefaultView",c[c.NormalView=1]="NormalView",c[c.DialogView=2]="DialogView",c[c.View=3]="View",c[c.DisplayForm=4]="DisplayForm",c[c.DisplayFormDialog=5]="DisplayFormDialog",c[c.EditForm=6]="EditForm",c[c.EditFormDialog=7]="EditFormDialog",c[c.NewForm=8]="NewForm",c[c.NewFormDialog=9]="NewFormDialog",c[c.SolutionForm=10]="SolutionForm",c[c.PAGE_MAXITEMS=11]="PAGE_MAXITEMS";var f=n(27),O=n(13),g=n(33),y=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,j=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g;function m(e,t){return void 0===t&&(t=!1),t?j.test(e):y.test(e)}function v(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=!1),n?e.replace(j,t):e.replace(y,t)}},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(7),c=n(11),s=n(16),a=n(4),u=n(12);Object(i.m)(o.c,"lists",c.c),Object(i.m)(o.c,"siteUserInfoList",c.b,"siteuserinfolist"),Object(i.m)(o.c,"defaultDocumentLibrary",c.b,"DefaultDocumentLibrary"),Object(i.m)(o.c,"customListTemplates",a.b,"getcustomlisttemplates"),o.c.prototype.getList=function(e){return Object(c.b)(this,"getList('"+Object(u.a)(e)+"')")},o.c.prototype.getCatalog=function(n){return Object(r.a)(this,void 0,void 0,function(){var t;return Object(r.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(o.a,"getcatalog("+n+")").select("Id").get()];case 1:return t=e.sent(),[2,Object(c.b)(Object(s.a)(t))]}})})}},function(e,t,n){"use strict";n.r(t),n.d(t,"App",function(){return V}),n.d(t,"AppCatalog",function(){return W}),n.d(t,"Attachment",function(){return Z}),n.d(t,"Attachments",function(){return $}),n.d(t,"ClientsidePageFromFile",function(){return _e}),n.d(t,"CreateClientsidePage",function(){return Ce}),n.d(t,"CanvasColumn",function(){return Ee}),n.d(t,"CanvasSection",function(){return Re}),n.d(t,"ClientsideText",function(){return Ae}),n.d(t,"ClientsideWebpart",function(){return Ue}),n.d(t,"ColumnControl",function(){return Ne}),n.d(t,"PromotedState",function(){return se}),n.d(t,"Comment",function(){return fe}),n.d(t,"Comments",function(){return he}),n.d(t,"Replies",function(){return ge}),n.d(t,"ContentType",function(){return nt}),n.d(t,"ContentTypes",function(){return et}),n.d(t,"FieldLink",function(){return ct}),n.d(t,"FieldLinks",function(){return it}),n.d(t,"Feature",function(){return Ot}),n.d(t,"Features",function(){return bt}),n.d(t,"Fields",function(){return Ft}),n.d(t,"Field",function(){return Mt}),n.d(t,"AddFieldOptions",function(){return St}),n.d(t,"CalendarType",function(){return Tt}),n.d(t,"ChoiceFieldFormatType",function(){return wt}),n.d(t,"DateTimeFieldFormatType",function(){return mt}),n.d(t,"DateTimeFieldFriendlyFormatType",function(){return vt}),n.d(t,"FieldTypes",function(){return jt}),n.d(t,"FieldUserSelectionMode",function(){return It}),n.d(t,"UrlFieldFormatType",function(){return Pt}),n.d(t,"File",function(){return E}),n.d(t,"Files",function(){return C}),n.d(t,"CheckinType",function(){return r}),n.d(t,"MoveOperations",function(){return i}),n.d(t,"TemplateFileType",function(){return o}),n.d(t,"Version",function(){return x}),n.d(t,"Versions",function(){return A}),n.d(t,"Folder",function(){return Ve}),n.d(t,"Folders",function(){return We}),n.d(t,"Form",function(){return zt}),n.d(t,"Forms",function(){return Kt}),n.d(t,"HubSite",function(){return nn}),n.d(t,"HubSites",function(){return en}),n.d(t,"Item",function(){return f.a}),n.d(t,"Items",function(){return f.d}),n.d(t,"ItemVersion",function(){return f.b}),n.d(t,"ItemVersions",function(){return f.c}),n.d(t,"PagedItemCollection",function(){return f.e}),n.d(t,"List",function(){return re.b}),n.d(t,"Lists",function(){return re.c}),n.d(t,"ControlMode",function(){return re.a}),n.d(t,"RenderListDataOptions",function(){return re.d}),n.d(t,"Navigation",function(){return fn}),n.d(t,"NavigationNode",function(){return hn}),n.d(t,"NavigationNodes",function(){return dn}),n.d(t,"NavigationService",function(){return gn}),n.d(t,"spODataEntity",function(){return b.b}),n.d(t,"spODataEntityArray",function(){return b.c}),n.d(t,"Profiles",function(){return Cn}),n.d(t,"UrlZone",function(){return Sn}),n.d(t,"RegionalSettings",function(){return Mn}),n.d(t,"TimeZone",function(){return qn}),n.d(t,"TimeZones",function(){return Hn}),n.d(t,"RelatedItemManager",function(){return ur}),n.d(t,"SortDirection",function(){return fr}),n.d(t,"ReorderingRuleMatchType",function(){return Or}),n.d(t,"QueryPropertyValueType",function(){return gr}),n.d(t,"SearchBuiltInSourceId",function(){return Ar}),n.d(t,"SearchQueryBuilder",function(){return br}),n.d(t,"SearchResults",function(){return wr}),n.d(t,"Search",function(){return Ir}),n.d(t,"Suggest",function(){return Cr}),n.d(t,"RoleAssignment",function(){return hi}),n.d(t,"RoleAssignments",function(){return di}),n.d(t,"RoleDefinition",function(){return gi}),n.d(t,"RoleDefinitions",function(){return fi}),n.d(t,"PermissionKind",function(){return xr}),n.d(t,"SPSharedObjectType",function(){return kr}),n.d(t,"SharingDomainRestrictionMode",function(){return Lr}),n.d(t,"SharingLinkKind",function(){return Br}),n.d(t,"SharingOperationStatusCode",function(){return Fr}),n.d(t,"SharingRole",function(){return Dr}),n.d(t,"RoleType",function(){return Mr}),n.d(t,"SiteDesigns",function(){return Ki}),n.d(t,"SiteGroup",function(){return ui}),n.d(t,"SiteGroups",function(){return si}),n.d(t,"SiteScripts",function(){return Zi}),n.d(t,"SiteUser",function(){return oi}),n.d(t,"SiteUsers",function(){return ri}),n.d(t,"Site",function(){return ho.a}),n.d(t,"MySocial",function(){return yo}),n.d(t,"Social",function(){return fo}),n.d(t,"SocialActorType",function(){return no}),n.d(t,"SocialActorTypes",function(){return ro}),n.d(t,"SocialFollowResult",function(){return io}),n.d(t,"SocialStatusCode",function(){return oo}),n.d(t,"Utilities",function(){return Io}),n.d(t,"Subscription",function(){return Uo}),n.d(t,"Subscriptions",function(){return No}),n.d(t,"TermStore",function(){return Ko}),n.d(t,"TermGroup",function(){return Jo}),n.d(t,"TermGroups",function(){return zo}),n.d(t,"TermSets",function(){return Yo}),n.d(t,"TermSet",function(){return ec}),n.d(t,"Terms",function(){return nc}),n.d(t,"Relation",function(){return ac}),n.d(t,"Relations",function(){return cc}),n.d(t,"Term",function(){return ic}),n.d(t,"UserCustomAction",function(){return ir}),n.d(t,"UserCustomActions",function(){return nr}),n.d(t,"UserCustomActionRegistrationType",function(){return Xn}),n.d(t,"UserCustomActionScope",function(){return Jn}),n.d(t,"View",function(){return wc}),n.d(t,"ViewFields",function(){return Cc}),n.d(t,"Views",function(){return Pc}),n.d(t,"ViewScope",function(){return yc}),n.d(t,"WebPartsPersonalizationScope",function(){return Ac}),n.d(t,"WebPartDefinitions",function(){return Gc}),n.d(t,"WebPartDefinition",function(){return Wc}),n.d(t,"LimitedWebPartManager",function(){return Fc}),n.d(t,"Web",function(){return G.a}),n.d(t,"Webs",function(){return G.b}),n.d(t,"SharePointQueryableInstance",function(){return Qc.i}),n.d(t,"SharePointQueryableCollection",function(){return Qc.h}),n.d(t,"SharePointQueryable",function(){return Qc.g}),n.d(t,"spInvokableFactory",function(){return Qc.p}),n.d(t,"SPBatch",function(){return Qc.d}),n.d(t,"defaultPath",function(){return Qc.k}),n.d(t,"spGet",function(){return Qc.o}),n.d(t,"spPost",function(){return Qc.r}),n.d(t,"spDelete",function(){return Qc.n}),n.d(t,"spPatch",function(){return Qc.q}),n.d(t,"spPostDelete",function(){return Qc.s}),n.d(t,"spPostDeleteETag",function(){return Qc.t}),n.d(t,"SPHttpClient",function(){return Qc.e}),n.d(t,"SPRest",function(){return Qc.f}),n.d(t,"PrincipalType",function(){return Qc.c}),n.d(t,"PrincipalSource",function(){return Qc.b}),n.d(t,"PageType",function(){return Qc.a}),n.d(t,"toAbsoluteUrl",function(){return Qc.v}),n.d(t,"extractWebUrl",function(){return Qc.l}),n.d(t,"objectToSPKeyValueCollection",function(){return Qc.m}),n.d(t,"stripInvalidFileFolderChars",function(){return Qc.u}),n.d(t,"containsInvalidFileFolderChars",function(){return Qc.j}),n.d(t,"sp",function(){return zc});var r,i,o,c,s,a,u,l,d,p,h=n(17),g=n(0),y=n(7),j=n(4),m=n(5),b=n(16),v=n(13),S=n(2),T=n(1),f=(n(44),n(14)),O=n(8),P=n(12),I=n(3),w=n(22),_=(u=j.e,Object(g.c)(F,u),F.prototype.getByName=function(e){if(/\%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return I.a.configure(E(this).concat("('"+Object(P.a)(e)+"')"),"fis.getByName")},F.prototype.add=function(t,n,r){return void 0===r&&(r=!0),Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(C(this,"add(overwrite="+r+",url='"+Object(P.a)(t)+"')"),{body:n})];case 1:return[2,{data:e.sent(),file:this.getByName(t)}]}})})},F.prototype.addUsingPath=function(r,i,o){return void 0===o&&(o={Overwrite:!1}),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=["AddUsingPath(decodedurl='"+Object(P.a)(r)+"'"],o&&(o.Overwrite&&t.push(",Overwrite=true"),o.AutoCheckoutOnInvalidData&&t.push(",AutoCheckoutOnInvalidData=true"),Object(T.stringIsNullOrEmpty)(o.XorHash)||t.push(",XorHash="+Object(P.a)(o.XorHash))),t.push(")"),[4,Object(m.d)(C(this,t.join("")),{body:i})];case 1:return[2,{data:n=e.sent(),file:E(Object(b.a)(n))}]}})})},F.prototype.addChunked=function(t,n,r,i,o){return void 0===i&&(i=!0),void 0===o&&(o=10485760),Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(C,"add(overwrite="+i+",url='"+Object(P.a)(t)+"')",!1))];case 1:return e.sent(),[4,this.getByName(t).setContentChunked(n,r,o)];case 2:return[2,e.sent()]}})})},F.prototype.addTemplateFile=function(n,r){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(C,"addTemplateFile(urloffile='"+Object(P.a)(n)+"',templatefiletype="+r+")",!1))];case 1:return[2,{data:t=e.sent(),file:E(Object(b.a)(t))}]}})})},Object(g.b)([Object(I.a)("fis.add")],F.prototype,"add",null),Object(g.b)([Object(I.a)("fis.addUsingPath")],F.prototype,"addUsingPath",null),Object(g.b)([Object(I.a)("fis.addChunked")],F.prototype,"addChunked",null),Object(g.b)([Object(I.a)("fis.addTemplateFile")],F.prototype,"addTemplateFile",null),Object(g.b)([Object(O.a)("files")],F)),C=Object(j.i)(_),R=(a=j.f,Object(g.c)(L,a),Object.defineProperty(L.prototype,"listItemAllFields",{get:function(){return I.a.configure(Object(j.c)(this,"listItemAllFields"),"fi.listItemAllFields")},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"versions",{get:function(){return I.a.configure(A(this),"fi.versions")},enumerable:!1,configurable:!0}),L.prototype.approve=function(e){return void 0===e&&(e=""),Object(m.d)(this.clone(E,"approve(comment='"+Object(P.a)(e)+"')"))},L.prototype.cancelUpload=function(e){return Object(m.d)(this.clone(E,"cancelUpload(uploadId=guid'"+e+"')",!1))},L.prototype.checkin=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=r.Major),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Object(m.d)(this.clone(E,"checkin(comment='"+Object(P.a)(e)+"',checkintype="+t+")"))},L.prototype.checkout=function(){return Object(m.d)(this.clone(E,"checkout"))},L.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),Object(m.d)(this.clone(E,"copyTo(strnewurl='"+Object(P.a)(e)+"',boverwrite="+t+")"))},L.prototype.copyByPath=function(c,s,a){return void 0===a&&(a=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(E(i,"/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1="+s),Object(S.n)({destPath:Object(w.a)(Object(T.isUrlAbsolute)(c)?c:""+o+c),options:{KeepBoth:a,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Object(w.a)(Object(T.isUrlAbsolute)(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},L.prototype.deny=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Object(m.d)(this.clone(E,"deny(comment='"+Object(P.a)(e)+"')"))},L.prototype.moveTo=function(e,t){return void 0===t&&(t=i.Overwrite),Object(m.d)(this.clone(E,"moveTo(newurl='"+Object(P.a)(e)+"',flags="+t+")"))},L.prototype.moveByPath=function(c,s,a){return void 0===a&&(a=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(E(i,"/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1="+s),Object(S.n)({destPath:Object(w.a)(Object(T.isUrlAbsolute)(c)?c:""+o+c),options:{KeepBoth:a,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Object(w.a)(Object(T.isUrlAbsolute)(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},L.prototype.publish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Object(m.d)(this.clone(E,"publish(comment='"+Object(P.a)(e)+"')"))},L.prototype.recycle=function(){return Object(m.d)(this.clone(E,"recycle"))},L.prototype.undoCheckout=function(){return Object(m.d)(this.clone(E,"undoCheckout"))},L.prototype.unpublish=function(e){if(void 0===e&&(e=""),1023<e.length)throw Error("The maximum comment length is 1023 characters.");return Object(m.d)(this.clone(E,"unpublish(comment='"+Object(P.a)(e)+"')"))},L.prototype.getText=function(){return this.clone(E,"$value",!1).usingParser(new S.l)(Object(S.x)({binaryStringResponseBody:"true"}))},L.prototype.getBlob=function(){return this.clone(E,"$value",!1).usingParser(new S.b)(Object(S.x)({binaryStringResponseBody:"true"}))},L.prototype.getBuffer=function(){return this.clone(E,"$value",!1).usingParser(new S.c)(Object(S.x)({binaryStringResponseBody:"true"}))},L.prototype.getJSON=function(){return this.clone(E,"$value",!1).usingParser(new S.g)(Object(S.x)({binaryStringResponseBody:"true"}))},L.prototype.setContent=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(E,"$value",!1),{body:t,headers:{"X-HTTP-Method":"PUT"}})];case 1:return e.sent(),[2,E(this)]}})})},L.prototype.getItem=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,(t=this.listItemAllFields).select.apply(t,r)()];case 1:return n=e.sent(),[2,Object(T.assign)(Object(f.a)(Object(b.a)(n)),n)]}})})},L.prototype.setContentChunked=function(c,s,a){return void 0===a&&(a=10485760),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return Object(T.isFunc)(s)||(s=function(){return null}),t=c.size,n=parseInt((t/a).toString(),10)+(t%a==0?1:0),r=Object(T.getGUID)(),s({uploadId:r,blockNumber:1,chunkSize:a,currentPointer:0,fileSize:t,stage:"starting",totalBlocks:n}),[4,this.startUpload(r,c.slice(0,a))];case 1:i=e.sent(),o=2,e.label=2;case 2:return o<n?(s({uploadId:r,blockNumber:o,chunkSize:a,currentPointer:i,fileSize:t,stage:"continue",totalBlocks:n}),[4,this.continueUpload(r,i,c.slice(i,i+a))]):[3,5];case 3:i=e.sent(),e.label=4;case 4:return o++,[3,2];case 5:return s({uploadId:r,blockNumber:n,chunkSize:a,currentPointer:i,fileSize:t,stage:"finishing",totalBlocks:n}),[2,this.finishUpload(r,i,c.slice(i))]}})})},L.prototype.startUpload=function(n,r){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(E,"startUpload(uploadId=guid'"+n+"')",!1),{body:r})];case 1:return"object"==typeof(t=e.sent())&&(t=t.StartUpload),[2,parseFloat(t)]}})})},L.prototype.continueUpload=function(n,r,i){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(E,"continueUpload(uploadId=guid'"+n+"',fileOffset="+r+")",!1),{body:i})];case 1:return"object"==typeof(t=e.sent())&&(t=t.ContinueUpload),[2,parseFloat(t)]}})})},L.prototype.finishUpload=function(n,r,i){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(E,"finishUpload(uploadId=guid'"+n+"',fileOffset="+r+")",!1),{body:i})];case 1:return[2,{data:t=e.sent(),file:E(Object(b.a)(t))}]}})})},Object(g.b)([Object(I.a)("fi.approve")],L.prototype,"approve",null),Object(g.b)([Object(I.a)("fi.cancelUpload")],L.prototype,"cancelUpload",null),Object(g.b)([Object(I.a)("fi.checkin")],L.prototype,"checkin",null),Object(g.b)([Object(I.a)("fi.checkout")],L.prototype,"checkout",null),Object(g.b)([Object(I.a)("fi.copyTo")],L.prototype,"copyTo",null),Object(g.b)([Object(I.a)("fi.copyByPath")],L.prototype,"copyByPath",null),Object(g.b)([Object(I.a)("fi.deny")],L.prototype,"deny",null),Object(g.b)([Object(I.a)("fi.moveTo")],L.prototype,"moveTo",null),Object(g.b)([Object(I.a)("fi.moveByPath")],L.prototype,"moveByPath",null),Object(g.b)([Object(I.a)("fi.publish")],L.prototype,"publish",null),Object(g.b)([Object(I.a)("fi.recycle")],L.prototype,"recycle",null),Object(g.b)([Object(I.a)("fi.undoCheckout")],L.prototype,"undoCheckout",null),Object(g.b)([Object(I.a)("fi.unpublish")],L.prototype,"unpublish",null),Object(g.b)([Object(I.a)("fi.getText")],L.prototype,"getText",null),Object(g.b)([Object(I.a)("fi.getBlob")],L.prototype,"getBlob",null),Object(g.b)([Object(I.a)("fi.getBuffer")],L.prototype,"getBuffer",null),Object(g.b)([Object(I.a)("fi.getJSON")],L.prototype,"getJSON",null),Object(g.b)([Object(I.a)("fi.setContent")],L.prototype,"setContent",null),Object(g.b)([Object(I.a)("fi.getItem")],L.prototype,"getItem",null),Object(g.b)([Object(I.a)("fi.startUpload")],L.prototype,"startUpload",null),Object(g.b)([Object(I.a)("fi.continueUpload")],L.prototype,"continueUpload",null),Object(g.b)([Object(I.a)("fi.finishUpload")],L.prototype,"finishUpload",null),L),E=Object(j.i)(R),N=(s=j.e,Object(g.c)(k,s),k.prototype.getById=function(e){return I.a.configure(x(this).concat("("+e+")"),"vers.getById")},k.prototype.deleteAll=function(){return Object(m.d)(A(this,"deleteAll"))},k.prototype.deleteById=function(e){return Object(m.d)(this.clone(A,"deleteById(vid="+e+")"))},k.prototype.recycleByID=function(e){return Object(m.d)(this.clone(A,"recycleByID(vid="+e+")"))},k.prototype.deleteByLabel=function(e){return Object(m.d)(this.clone(A,"deleteByLabel(versionlabel='"+Object(P.a)(e)+"')"))},k.prototype.recycleByLabel=function(e){return Object(m.d)(this.clone(A,"recycleByLabel(versionlabel='"+Object(P.a)(e)+"')"))},k.prototype.restoreByLabel=function(e){return Object(m.d)(this.clone(A,"restoreByLabel(versionlabel='"+Object(P.a)(e)+"')"))},Object(g.b)([Object(I.a)("vers.deleteAll")],k.prototype,"deleteAll",null),Object(g.b)([Object(I.a)("vers.deleteById")],k.prototype,"deleteById",null),Object(g.b)([Object(I.a)("vers.recycleByID")],k.prototype,"recycleByID",null),Object(g.b)([Object(I.a)("vers.deleteByLabel")],k.prototype,"deleteByLabel",null),Object(g.b)([Object(I.a)("vers.recycleByLabel")],k.prototype,"recycleByLabel",null),Object(g.b)([Object(I.a)("vers.restoreByLabel")],k.prototype,"restoreByLabel",null),Object(g.b)([Object(O.a)("versions")],k)),A=Object(j.i)(N),U=(c=j.f,Object(g.c)(D,c),D),x=Object(j.i)(U);function D(){var e=null!==c&&c.apply(this,arguments)||this;return e.delete=Object(j.h)("ver"),e}function k(){return null!==s&&s.apply(this,arguments)||this}function L(){var e=null!==a&&a.apply(this,arguments)||this;return e.delete=Object(j.h)("fi"),e}function F(){return null!==u&&u.apply(this,arguments)||this}(p=r=r||{})[p.Minor=0]="Minor",p[p.Major=1]="Major",p[p.Overwrite=2]="Overwrite",(d=i=i||{})[d.Overwrite=1]="Overwrite",d[d.AllowBrokenThickets=8]="AllowBrokenThickets",(l=o=o||{})[l.StandardPage=0]="StandardPage",l[l.WikiPage=1]="WikiPage",l[l.FormPage=2]="FormPage",l[l.ClientSidePage=3]="ClientSidePage";var B,M,G=n(25),q=(M=j.e,Object(g.c)(Q,M),Q.prototype.getAppById=function(e){return I.a.configure(V(this,"getById('"+e+"')"),"ac.getAppById")},Q.prototype.syncSolutionToTeams=function(s,a){return void 0===a&&(a=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o,c;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=null,n=Object(v.a)(this.toUrl()),a?(t=s,[3,4]):[3,1];case 1:return[4,(r=Object(G.a)(n)).lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")()];case 2:return i=e.sent()[0].Id,[4,r.lists.getById(i).items.filter("AppProductID eq '"+s+"'").top(1)()];case 3:if(!((o=e.sent())&&0<o.length))throw Error("Did not find the app with id "+s+" in the appcatalog.");t=o[0].Id,e.label=4;case 4:return c=I.a.configure(W(n,"_api/web/tenantappcatalog/SyncSolutionToTeams(id="+t+")"),"ac.syncSolutionToTeams"),[4,Object(m.d)(c,{})];case 5:return[2,e.sent()]}})})},Q.prototype.add=function(r,i,o){return void 0===o&&(o=!0),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=I.a.configure(W(Object(v.a)(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+o+",url='"+r+"')"),"ac.add"),[4,Object(m.d)(t,{body:i,headers:{binaryStringRequestBody:"true"}})];case 1:return[2,{data:n=e.sent(),file:E(Object(b.a)(n))}]}})})},Q),W=Object(j.i)(q),H=(B=j.f,Object(g.c)(K,B),K.prototype.deploy=function(e){return void 0===e&&(e=!1),this.do("Deploy("+e+")")},K.prototype.retract=function(){return this.do("Retract")},K.prototype.install=function(){return this.do("Install")},K.prototype.uninstall=function(){return this.do("Uninstall")},K.prototype.upgrade=function(){return this.do("Upgrade")},K.prototype.remove=function(){return this.do("Remove")},K.prototype.do=function(e){return Object(m.d)(this.clone(V,e))},Object(g.b)([Object(I.a)("app.deploy")],K.prototype,"deploy",null),Object(g.b)([Object(I.a)("app.retract")],K.prototype,"retract",null),Object(g.b)([Object(I.a)("app.install")],K.prototype,"install",null),Object(g.b)([Object(I.a)("app.uninstall")],K.prototype,"uninstall",null),Object(g.b)([Object(I.a)("app.upgrade")],K.prototype,"upgrade",null),Object(g.b)([Object(I.a)("app.remove")],K.prototype,"remove",null),K),V=Object(j.i)(H);function K(){return null!==B&&B.apply(this,arguments)||this}function Q(e,t){return void 0===t&&(t="_api/web/tenantappcatalog/AvailableApps"),M.call(this,Object(v.a)("string"==typeof e?e:e.toUrl()),t)||this}y.c.prototype.getAppCatalog=function(e){return W(e||this)},h.a.prototype.getTenantAppCatalogWeb=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(j.a)("/","_api/SP_TenantSettings_Current")()];case 1:return t=e.sent(),[2,Object(y.a)(t.CorporateCatalogUrl)]}})})};var z,X,J=(X=j.e,Object(g.c)(te,X),te.prototype.getByName=function(e){var t=I.a.configure(Z(this),"ats.getByName");return t.concat("('"+e+"')"),t},te.prototype.add=function(t,n){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone($,"add(FileName='"+t+"')",!1),{body:n})];case 1:return[2,{data:e.sent(),file:this.getByName(t)}]}})})},te.prototype.addMultiple=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.add(n[t].name,n[t].content)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},te.prototype.deleteMultiple=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.getByName(n[t]).delete()]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},te.prototype.recycleMultiple=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<n.length?[4,this.getByName(n[t]).recycle()]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},Object(g.b)([Object(I.a)("ats.add")],te.prototype,"add",null),Object(g.b)([Object(I.a)("ats.addMultiple")],te.prototype,"addMultiple",null),Object(g.b)([Object(I.a)("ats.deleteMultiple")],te.prototype,"deleteMultiple",null),Object(g.b)([Object(I.a)("ats.recycleMultiple")],te.prototype,"recycleMultiple",null),Object(g.b)([Object(O.a)("AttachmentFiles")],te)),$=Object(j.i)(J),Y=(z=j.f,Object(g.c)(ee,z),ee.prototype.getText=function(){return this.getParsed(new S.l)},ee.prototype.getBlob=function(){return this.getParsed(new S.b)},ee.prototype.getBuffer=function(){return this.getParsed(new S.c)},ee.prototype.getJSON=function(){return this.getParsed(new S.g)},ee.prototype.setContent=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(Z,"$value",!1),Object(S.x)({"X-HTTP-Method":"PUT"},{body:t}))];case 1:return e.sent(),[2,Z(this)]}})})},ee.prototype.recycle=function(e){return void 0===e&&(e="*"),Object(m.d)(this.clone(Z,"recycleObject"),Object(S.x)({"IF-Match":e,"X-HTTP-Method":"DELETE"}))},ee.prototype.getParsed=function(e){return this.clone(Z,"$value",!1).usingParser(e)()},Object(g.b)([Object(I.a)("at.getText")],ee.prototype,"getText",null),Object(g.b)([Object(I.a)("at.getBlob")],ee.prototype,"getBlob",null),Object(g.b)([Object(I.a)("at.getBuffer")],ee.prototype,"getBuffer",null),Object(g.b)([Object(I.a)("at.getJSON")],ee.prototype,"getJSON",null),Object(g.b)([Object(I.a)("at.setContent")],ee.prototype,"setContent",null),Object(g.b)([Object(I.a)("at.recycle")],ee.prototype,"recycle",null),ee),Z=Object(j.i)(Y);function ee(){var e=null!==z&&z.apply(this,arguments)||this;return e.delete=Object(j.h)("at"),e}function te(){return null!==X&&X.apply(this,arguments)||this}Object(S.m)(f.f,"attachmentFiles",$);var ne=n(10),re=n(11),ie=n(19);function oe(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function ce(e){for(var t=0;t<e.length;t++)e[t].order=t+1,Object(T.hOP)(e[t],"columns")?ce(e[t].columns):Object(T.hOP)(e[t],"controls")&&ce(e[t].controls)}y.c.prototype.getFileByServerRelativeUrl=function(e){return E(this,"getFileByServerRelativeUrl('"+Object(P.a)(e)+"')")},y.c.prototype.getFileByServerRelativePath=function(e){return E(this,"getFileByServerRelativePath(decodedUrl='"+Object(P.a)(e)+"')")},y.c.prototype.getFileById=function(e){return E(this,"getFileById('"+e+"')")},y.c.prototype.getFileByUrl=function(e){return E(this,"getFileByUrl('!@p1::"+Object(P.a)(e)+"')")};var se,ae,ue,le,de,pe=(le=j.e,Object(g.c)(me,le),me.prototype.add=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={text:r}),t=Object(S.n)(Object(T.assign)(Object(ne.a)("Microsoft.SharePoint.Comments.comment"),r)),[4,Object(m.d)(this.clone(he,null),t)];case 1:return n=e.sent(),[2,Object(T.assign)(this.getById(n.id),n)]}})})},me.prototype.getById=function(e){return I.a.configure(fe(this).concat("("+e+")"),"coms.getById")},me.prototype.clear=function(){return Object(m.d)(I.a.configure(this.clone(he,"DeleteAll"),"coms.clear"))},Object(g.b)([Object(I.a)("coms.add")],me.prototype,"add",null),Object(g.b)([Object(O.a)("comments")],me)),he=Object(j.i)(pe),be=(ue=j.f,Object(g.c)(je,ue),Object.defineProperty(je.prototype,"replies",{get:function(){return I.a.configure(ge(this),"com.replies")},enumerable:!1,configurable:!0}),je.prototype.like=function(){return Object(m.d)(this.clone(fe,"Like"))},je.prototype.unlike=function(){return Object(m.d)(this.clone(fe,"Unlike"))},je.prototype.delete=function(){return Object(m.d)(this.clone(fe,"DeleteComment"))},Object(g.b)([Object(I.a)("com.like")],je.prototype,"like",null),Object(g.b)([Object(I.a)("com.unlike")],je.prototype,"unlike",null),Object(g.b)([Object(I.a)("com.delete")],je.prototype,"delete",null),je),fe=Object(j.i)(be),Oe=(ae=j.e,Object(g.c)(ye,ae),ye.prototype.add=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={text:r}),t=Object(S.n)(Object(T.assign)(Object(ne.a)("Microsoft.SharePoint.Comments.comment"),r)),[4,Object(m.d)(this.clone(ge,null),t)];case 1:return n=e.sent(),[2,Object(T.assign)(fe(Object(b.a)(n)),n)]}})})},Object(g.b)([Object(I.a)("reps.add")],ye.prototype,"add",null),Object(g.b)([Object(O.a)("replies")],ye)),ge=Object(j.i)(Oe);function ye(){return null!==ae&&ae.apply(this,arguments)||this}function je(){return null!==ue&&ue.apply(this,arguments)||this}function me(){return null!==le&&le.apply(this,arguments)||this}function ve(e,t){return we(Object(v.a)(e.toUrl()),t).configureFrom(e)}Object(S.m)(f.f,"comments",he),f.f.prototype.getLikedBy=function(){return Object(m.d)(this.clone(f.a,"likedBy"))},f.f.prototype.like=function(){return Object(m.d)(this.clone(f.a,"like"))},f.f.prototype.unlike=function(){return Object(m.d)(this.clone(f.a,"unlike"))},f.f.prototype.getLikedByInformation=function(){return this.clone(f.a,"likedByInformation").expand("likedby")()},(de=se=se||{})[de.NotPromoted=0]="NotPromoted",de[de.PromoteOnPublish=1]="PromoteOnPublish",de[de.Promoted=2]="Promoted";var Se,Te,Pe,Ie=(Pe=j.d,Object(g.c)(Be,Pe),Be.getDefaultLayoutPart=function(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}},Object.defineProperty(Be.prototype,"pageLayout",{get:function(){return this.json.PageLayoutType},set:function(e){this.json.PageLayoutType=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"bannerImageUrl",{get:function(){return this.json.BannerImageUrl},set:function(e){this.setBannerImage(e)},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"thumbnailUrl",{get:function(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl},set:function(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"topicHeader",{get:function(){return Object(T.objectDefinedNotNull)(this.json.TopicHeader)?this.json.TopicHeader:""},set:function(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,Object(T.stringIsNullOrEmpty)(e)&&(this.showTopicHeader=!1)},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"title",{get:function(){return this._layoutPart.properties.title},set:function(e){this.json.Title=e,this._layoutPart.properties.title=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"description",{get:function(){return this.json.Description},set:function(e){if(!Object(T.stringIsNullOrEmpty)(e)&&255<e.length)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,Object(T.hOP)(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"layoutType",{get:function(){return this._layoutPart.properties.layoutType},set:function(e){this._layoutPart.properties.layoutType=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"headerTextAlignment",{get:function(){return this._layoutPart.properties.textAlignment},set:function(e){this._layoutPart.properties.textAlignment=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"showTopicHeader",{get:function(){return this._layoutPart.properties.showTopicHeader},set:function(e){this._layoutPart.properties.showTopicHeader=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"showPublishDate",{get:function(){return this._layoutPart.properties.showPublishDate},set:function(e){this._layoutPart.properties.showPublishDate=e},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"hasVerticalSection",{get:function(){return-1<this.sections.findIndex(function(e){return 2===e.layoutIndex})},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"authorByLine",{get:function(){return Object(T.isArray)(this.json.AuthorByline)&&0<this.json.AuthorByline.length?this.json.AuthorByline[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(Be.prototype,"verticalSection",{get:function(){return this.hasVerticalSection?this.addVerticalSection():null},enumerable:!1,configurable:!0}),Be.prototype.addSection=function(){var e=new Re(this,oe(this.sections),1);return this.sections.push(e),e},Be.prototype.addVerticalSection=function(){var e=this.sections.findIndex(function(e){return 2===e.layoutIndex});if(-1<e)return this.sections[e];var t=new Re(this,oe(this.sections),2);return this.sections.push(t),t},Be.prototype.fromJSON=function(e){this.json=e;var t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&0<n.length&&(this._layoutPart=n[0]),this.setControls(t),this},Be.prototype.load=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.getItem("Id","CommentsDisabled")];case 1:return t=e.sent(),[4,Object(j.a)(this,"_api/sitepages/pages("+t.Id+")")()];case 2:return n=e.sent(),this.commentsDisabled=t.CommentsDisabled,[2,this.fromJSON(n)]}})})},Be.prototype.save=function(O){return void 0===O&&(O=!0),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o,c,s,a,u,l,d,p,h,b,f;return Object(g.d)(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return this._bannerImageDirty?(t=this.json.BannerImageUrl,Object(T.isUrlAbsolute)(t)&&(t=t.replace(/^https?:\/\/[a-z0-9\.]*?\.[a-z]{2,3}\//i,"/")),n=Object(ie.a)(Object(v.a)(this.toUrl())),r=Object(y.a)(Object(v.a)(this.toUrl())),i=r.getFileByServerRelativePath(t.replace(/%20/gi," ")),u=a=s=c=o="",l=r.createBatch(),n.select("Id","Url").inBatch(l)().then(function(e){return o=e.Id}),r.select("Id","Url").inBatch(l)().then(function(e){c=e.Id,u=e.Url}),i.listItemAllFields.select("UniqueId","ParentList/Id").expand("ParentList").inBatch(l)().then(function(e){s=e.UniqueId,a=e.ParentList.Id}),[4,l.execute()]):[3,2];case 1:e.sent(),(d=Object(j.a)(u,"_layouts/15/getpreview.ashx")).query.set("guidSite",""+o),d.query.set("guidWeb",""+c),d.query.set("guidFile",""+s),this.bannerImageUrl=d.toUrlAndQuery(),Object(T.objectDefinedNotNull)(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:t},Object(T.objectDefinedNotNull)(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:a,siteId:o,uniqueId:s,webId:c},this._layoutPart.properties.webId=c,this._layoutPart.properties.siteId=o,this._layoutPart.properties.listId=a,this._layoutPart.properties.uniqueId=s,e.label=2;case 2:return this.json.IsPageCheckedOutToCurrentUser?[3,4]:[4,Object(m.d)(ve(this,"_api/sitepages/pages("+this.json.Id+")/checkoutpage"))];case 3:e.sent(),e.label=4;case 4:return p=Object.assign(Object(ne.a)("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader}),(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty)&&(h=this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl,p=Object(T.assign)(p,{BannerImageUrl:h})),b=ve(this,"_api/sitepages/pages("+this.json.Id+")/savepage"),[4,Object(m.d)(b,Object(S.x)({"if-match":"*"},Object(S.n)(p)))];case 5:return e.sent(),f=!0,O?[4,Object(m.d)(ve(this,"_api/sitepages/pages("+this.json.Id+")/publish"))]:[3,7];case 6:(f=e.sent())&&(this.json.IsPageCheckedOutToCurrentUser=!1),e.label=7;case 7:return this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,[2,f]}})})},Be.prototype.discardPageCheckout=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,Object(m.d)(ve(this,"_api/sitepages/pages("+this.json.Id+")/discardPage"),Object(S.n)(Object(ne.a)("SP.Publishing.SitePage")))];case 1:return t=e.sent(),this.fromJSON(t),[2]}})})},Be.prototype.promoteToNews=function(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){return[2,this.promoteNewsImpl("promoteToNews")]})})},Be.prototype.findControlById=function(t){return this.findControl(function(e){return e.id===t})},Be.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},Be.prototype.copy=function(l,d,p,h,b){return void 0===h&&(h=!0),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o,c,s,a,u;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Ce(l,d,p,this.pageLayout,b)];case 1:return(t=e.sent()).setControls(this.getControls()),Object(T.stringIsNullOrEmpty)(this.json.BannerImageUrl)?[3,5]:(n=new URL(this.json.BannerImageUrl),r=function(e){return e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5")},n.searchParams.has("guidSite")&&n.searchParams.has("guidWeb")&&n.searchParams.has("guidFile")?(i=r(n.searchParams.get("guidSite")),o=r(n.searchParams.get("guidWeb")),c=r(n.searchParams.get("guidFile")),[4,(s=Object(ie.a)(Object(v.a)(this.toUrl()))).select("Id")()]):[3,5]);case 2:return e.sent().Id!==i?[3,5]:[4,s.openWebById(o)];case 3:return[4,e.sent().web.getFileById(c).select("ServerRelativeUrl")()];case 4:a=e.sent(),u={},this._layoutPart.properties&&(Object(T.hOP)(this._layoutPart.properties,"translateX")&&(u.translateX=this._layoutPart.properties.translateX),Object(T.hOP)(this._layoutPart.properties,"translateY")&&(u.translateY=this._layoutPart.properties.translateY),Object(T.hOP)(this._layoutPart.properties,"imageSourceType")&&(u.imageSourceType=this._layoutPart.properties.imageSourceType),Object(T.hOP)(this._layoutPart.properties,"altText")&&(u.altText=this._layoutPart.properties.altText)),t.setBannerImage(a.ServerRelativeUrl,u),e.label=5;case 5:return[4,t.save(h)];case 6:return e.sent(),[2,t]}})})},Be.prototype.setBannerImage=function(e,t){this.json.BannerImageUrl=e,this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,Object(T.objectDefinedNotNull)(t)&&(Object(T.hOP)(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),Object(T.hOP)(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),Object(T.hOP)(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),Object(T.hOP)(t,"altText")&&(this._layoutPart.properties.altText=t.altText))},Be.prototype.setAuthorById=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(j.b)(Object(v.a)(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter("Id eq "+n).select("LoginName")()];case 1:if((t=e.sent()).length<1)throw Error("Could not find user with id "+n+".");return[2,this.setAuthorByLoginName(t[0].LoginName)]}})})},Be.prototype.setAuthorByLoginName=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(j.b)(Object(v.a)(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter("LoginName eq '"+encodeURIComponent(n)+"'").select("UserPrincipalName","Title")()];case 1:if((t=e.sent()).length<1)throw Error("Could not find user with login name '"+n+"'.");return this.json.AuthorByline=[n],this._layoutPart.properties.authorByline=[n],this._layoutPart.properties.authors=[{id:n,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}],[2]}})})},Be.prototype.getItem=function(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=ve(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),[4,Object(m.d)(t)];case 1:return n=e.sent(),[4,(r=Object(re.b)(n["odata.id"]).configureFrom(this).items.getById(this.json.Id)).select.apply(r,o)()];case 2:return i=e.sent(),[2,Object(T.assign)(Object(f.a)(Object(b.a)(i)).configureFrom(this),i)]}})})},Be.prototype.assign=function(e,t){this.data.parentUrl=e.data.url,this.data.url=Object(T.combine)(this.data.parentUrl,t||""),this.configureFrom(e)},Be.prototype.getCanvasContent1=function(){return JSON.stringify(this.getControls())},Be.prototype.getLayoutWebpartsContent=function(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)},Be.prototype.setControls=function(e){if(e&&e.length){for(var t=0;t<e.length;t++)switch(Object(T.hOP)(e[t],"controlType")?e[t].controlType:0){case 0:Object(T.hOP)(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new Ee(e[t]));break;case 3:var n=new Ue(e[t]);this.mergePartToTree(n,n.data.position);break;case 4:var r=e[t],i=new Ae(r.innerHTML,r);this.mergePartToTree(i,i.data.position)}ce(this.sections)}},Be.prototype.getControls=function(){var n=this;ce(this.sections);var r=[];return this.sections.forEach(function(t){t.columns.forEach(function(e){e.controls.length<1?r.push({displayMode:e.data.displayMode,emphasis:n.getEmphasisObj(t.emphasis),position:e.data.position}):e.controls.forEach(function(e){e.data.emphasis=n.getEmphasisObj(t.emphasis),r.push(e.data)})})}),r.push(this._pageSettings),r},Be.prototype.getEmphasisObj=function(e){return e<1||3<e?{}:{zoneEmphasis:e}},Be.prototype.promoteNewsImpl=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null.");return Object(T.stringIsNullOrEmpty)(this.json.VersionInfo.LastVersionCreatedBy)&&new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3?[4,this.save(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,Object(m.d)(ve(this,"_api/sitepages/pages("+this.json.Id+")/"+t),Object(S.n)(Object(ne.a)("SP.Publishing.SitePage")))];case 3:return[2,e.sent()]}})})},Be.prototype.mergePartToTree=function(e,t){var n,r,i,o=null,c=12,s=0,a=0,u=1;t&&(Object(T.hOP)(t,"zoneIndex")&&(a=t.zoneIndex),Object(T.hOP)(t,"sectionIndex")&&(s=t.sectionIndex),Object(T.hOP)(t,"sectionFactor")&&(c=t.sectionFactor),Object(T.hOP)(t,"layoutIndex")&&(u=t.layoutIndex));var l=null!==(i=null===(r=null===(n=e.data)||void 0===n?void 0:n.emphasis)||void 0===r?void 0:r.zoneEmphasis)&&void 0!==i?i:0,d=this.getOrCreateSection(a,u,l),p=d.columns.filter(function(e){return e.order===s}),o=p.length<1?d.addColumn(c,u):p[0];(e.column=o).addControl(e)},Be.prototype.mergeColumnToTree=function(e){var t=Object(T.hOP)(e.data,"position")&&Object(T.hOP)(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,n=Object(T.hOP)(e.data,"position")&&Object(T.hOP)(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,r=this.getOrCreateSection(t,n,e.data.emphasis.zoneEmphasis||0);(e.section=r).columns.push(e)},Be.prototype.getOrCreateSection=function(t,n,e){var r=null,i=this.sections.filter(function(e){return e.order===t&&e.layoutIndex===n});return i.length<1?((r=2===n?this.addVerticalSection():this.addSection()).order=t,r.emphasis=e):r=i[0],r},Object(g.b)([Object(I.a)("csp.load")],Be.prototype,"load",null),Object(g.b)([Object(I.a)("csp.save")],Be.prototype,"save",null),Object(g.b)([Object(I.a)("csp.discardPageCheckout")],Be.prototype,"discardPageCheckout",null),Object(g.b)([Object(I.a)("csp.promoteToNews")],Be.prototype,"promoteToNews",null),Object(g.b)([Object(I.a)("csp.copy")],Be.prototype,"copy",null),Object(g.b)([Object(I.a)("csp.getItem")],Be.prototype,"getItem",null),Be),we=function(e,t,n,r,i,o){return void 0===r&&(r=!1),void 0===i&&(i=[]),void 0===o&&(o=!1),Object(S.y)(Ie)(e,t,n,r,i,o)},_e=function(n){return Object(g.a)(void 0,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,n.getItem()];case 1:return t=e.sent(),[2,we(Object(v.a)(n.toUrl()),"",{Id:t.Id},!0).configureFrom(n).load()]}})})},Ce=function(r,i,o,c,s){return void 0===c&&(c="Article"),void 0===s&&(s=0),Object(g.a)(void 0,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return i=i.replace(/\.aspx$/i,""),[4,Object(m.d)(ve(r,"_api/sitepages/pages"),Object(S.n)(Object.assign(Object(ne.a)("SP.Publishing.SitePage"),{PageLayoutType:c,PromotedState:s})))];case 1:return t=e.sent(),(n=we(r,"",t)).title=i,[4,n.save(!1)];case 2:return e.sent(),n.title=o,[2,n]}})})},Re=(Object.defineProperty(Fe.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(Fe.prototype,"layoutIndex",{get:function(){return this._layoutIndex},set:function(e){this._layoutIndex=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(Fe.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!1,configurable:!0}),Fe.prototype.addColumn=function(e,t){void 0===t&&(t=1);var n=new Ee;return n.section=this,n.data.position.zoneIndex=this.order,n.data.position.layoutIndex=t,n.data.position.sectionFactor=e,n.order=oe(this.columns),this.columns.push(n),n},Fe.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},Object.defineProperty(Fe.prototype,"emphasis",{get:function(){return this._emphasis},set:function(e){this._emphasis=e},enumerable:!1,configurable:!0}),Fe.prototype.remove=function(){var t=this;this.page.sections=this.page.sections.filter(function(e){return e._memId!==t._memId}),ce(this.page.sections)},Fe),Ee=(Object.defineProperty(Le.prototype,"data",{get:function(){return this.json},enumerable:!1,configurable:!0}),Object.defineProperty(Le.prototype,"section",{get:function(){return this._section},set:function(e){this._section=e},enumerable:!1,configurable:!0}),Object.defineProperty(Le.prototype,"order",{get:function(){return this.data.position.sectionIndex},set:function(e){this.data.position.sectionIndex=e;for(var t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(Le.prototype,"factor",{get:function(){return this.data.position.sectionFactor},set:function(e){this.data.position.sectionFactor=e},enumerable:!1,configurable:!0}),Le.prototype.addControl=function(e){return(e.column=this).controls.push(e),this},Le.prototype.getControl=function(e){return this.controls[e]},Le.prototype.remove=function(){var t=this;this.section.columns=this.section.columns.filter(function(e){return e._memId!==t._memId}),ce(this.section.columns)},Le.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},Le),Ne=(Object.defineProperty(ke.prototype,"id",{get:function(){return this.json.id},enumerable:!1,configurable:!0}),Object.defineProperty(ke.prototype,"data",{get:function(){return this.json},enumerable:!1,configurable:!0}),Object.defineProperty(ke.prototype,"column",{get:function(){return this._column},set:function(e){this._column=e,this.onColumnChange(this._column)},enumerable:!1,configurable:!0}),ke.prototype.remove=function(){var t=this;this.column.controls=this.column.controls.filter(function(e){return e.id!==t.id}),ce(this.column.controls)},ke.prototype.setData=function(e){this.json=e},ke),Ae=(Te=Ne,Object(g.c)(De,Te),Object.defineProperty(De.prototype,"text",{get:function(){return this.data.innerHTML},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this.data.innerHTML=e},enumerable:!1,configurable:!0}),Object.defineProperty(De.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!1,configurable:!0}),De.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=oe(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex},De.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},De),Ue=(Se=Ne,Object(g.c)(xe,Se),xe.fromComponentDef=function(e){var t=new xe;return t.import(e),t},Object.defineProperty(xe.prototype,"title",{get:function(){return this.data.webPartData.title},set:function(e){this.data.webPartData.title=e},enumerable:!1,configurable:!0}),Object.defineProperty(xe.prototype,"description",{get:function(){return this.data.webPartData.description},set:function(e){this.data.webPartData.description=e},enumerable:!1,configurable:!0}),Object.defineProperty(xe.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(xe.prototype,"height",{get:function(){return this.data.reservedHeight},set:function(e){this.data.reservedHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(xe.prototype,"width",{get:function(){return this.data.reservedWidth},set:function(e){this.data.reservedWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(xe.prototype,"dataVersion",{get:function(){return this.data.webPartData.dataVersion},set:function(e){this.data.webPartData.dataVersion=e},enumerable:!1,configurable:!0}),xe.prototype.setProperties=function(e){return this.data.webPartData.properties=Object(T.assign)(this.data.webPartData.properties,e),this},xe.prototype.getProperties=function(){return this.data.webPartData.properties},xe.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=oe(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex},xe.prototype.import=function(e){var t=Object(T.getGUID)(),n=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),r=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:r.description.default,id:n,instanceId:t,properties:r.properties,title:r.title.default},webPartId:n}))},xe.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},xe);function xe(e){return void 0===e&&(e=JSON.parse(JSON.stringify(xe.Default))),Se.call(this,e)||this}function De(e,t){void 0===t&&(t=JSON.parse(JSON.stringify(De.Default)));var n=this;return Object(T.stringIsNullOrEmpty)(t.id)&&(t.id=Object(T.getGUID)(),t.anchorComponentId=t.id),(n=Te.call(this,t)||this).text=e,n}function ke(e){this.json=e}function Le(e,t){void 0===e&&(e=JSON.parse(JSON.stringify(Le.Default))),void 0===t&&(t=[]),this.json=e,this.controls=t,this._section=null,this._memId=Object(T.getGUID)()}function Fe(e,t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=0),this.page=e,this.columns=r,this._emphasis=i,this._memId=Object(T.getGUID)(),this._order=t,this._layoutIndex=n}function Be(e,t,n,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=[]),void 0===o&&(o=!1);var c=Pe.call(this,e,t)||this;return c.json=n,c.sections=i,c.commentsDisabled=o,c._bannerImageDirty=!1,c._bannerImageThumbnailUrlDirty=!1,"string"==typeof e?(c.data.parentUrl="",c.data.url=Object(T.combine)(Object(v.a)(e),t)):c.assign(ve(e,null),t),c._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},c._layoutPart=Be.getDefaultLayoutPart(),void 0===n||r||c.fromJSON(n),c}y.c.prototype.getClientsideWebParts=function(){return this.clone(j.b,"GetClientSideWebParts")()},y.c.prototype.addClientsidePage=function(e,t,n,r){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),Ce(this,e,t,n,r)},y.c.prototype.loadClientsidePage=function(e){return _e(this.getFileByServerRelativePath(e))};var Me,Ge,qe=(Ge=j.e,Object(g.c)(ze,Ge),ze.prototype.getByName=function(e){return I.a.configure(Ve(this).concat("('"+Object(P.a)(e)+"')"),"fs.getByName")},ze.prototype.add=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(We,"add('"+Object(P.a)(t)+"')"))];case 1:return[2,{data:e.sent(),folder:this.getByName(t)}]}})})},ze.prototype.addUsingPath=function(t,n){return void 0===n&&(n=!1),Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(We,"addUsingPath(DecodedUrl='"+Object(P.a)(t)+"',overwrite="+n+")"))];case 1:return[2,{data:e.sent(),folder:Ve(Object(v.a)(this.toUrl()),"_api/web/getFolderByServerRelativePath(decodedUrl='"+Object(P.a)(t)+"')")}]}})})},Object(g.b)([Object(I.a)("fs.add")],ze.prototype,"add",null),Object(g.b)([Object(I.a)("fs.addUsingPath")],ze.prototype,"addUsingPath",null),Object(g.b)([Object(O.a)("folders")],ze)),We=Object(j.i)(qe),He=(Me=j.f,Object(g.c)(Qe,Me),Object.defineProperty(Qe.prototype,"contentTypeOrder",{get:function(){return I.a.configure(Object(j.b)(this,"contentTypeOrder"),"f.contentTypeOrder")},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"folders",{get:function(){return We(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"listItemAllFields",{get:function(){return I.a.configure(Object(j.c)(this,"listItemAllFields"),"f.listItemAllFields")},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"parentFolder",{get:function(){return I.a.configure(Ve(this,"parentFolder"),"f.parentFolder")},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"properties",{get:function(){return I.a.configure(Object(j.c)(this,"properties"),"f.properties")},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"serverRelativeUrl",{get:function(){return I.a.configure(Object(j.a)(this,"serverRelativeUrl"),"f.serverRelativeUrl")},enumerable:!1,configurable:!0}),Object.defineProperty(Qe.prototype,"uniqueContentTypeOrder",{get:function(){return I.a.configure(Object(j.b)(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")},enumerable:!1,configurable:!0}),Qe.prototype.recycle=function(){return Object(m.d)(this.clone(Ve,"recycle"))},Qe.prototype.getItem=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,(n=this.listItemAllFields).select.apply(n,Object(g.e)(r))()];case 1:return t=e.sent(),[2,Object(T.assign)(Object(f.a)(Object(b.a)(t)),t)]}})})},Qe.prototype.moveTo=function(c){return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(Ve(i,"/_api/SP.MoveCopyUtil.MoveFolder()"),Object(S.n)({destUrl:Object(T.isUrlAbsolute)(c)?c:""+o+c,srcUrl:""+o+n}))];case 2:return e.sent(),[2]}})})},Qe.prototype.moveByPath=function(c,s){return void 0===s&&(s=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(Ve(i,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),Object(S.n)({destPath:Object(w.a)(Object(T.isUrlAbsolute)(c)?c:""+o+c),options:{KeepBoth:s,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Object(w.a)(Object(T.isUrlAbsolute)(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Qe.prototype.copyTo=function(c){return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(Ve(i,"/_api/SP.MoveCopyUtil.CopyFolder()"),Object(S.n)({destUrl:Object(T.isUrlAbsolute)(c)?c:""+o+c,srcUrl:""+o+n}))];case 2:return e.sent(),[2]}})})},Qe.prototype.copyByPath=function(c,s){return void 0===s&&(s=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("ServerRelativeUrl")()];case 1:return t=e.sent(),n=t.ServerRelativeUrl,r=t["odata.id"],i=Object(v.a)(r),o=i.replace("://","___").split("/")[0].replace("___","://"),[4,Object(m.d)(Ve(i,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),Object(S.n)({destPath:Object(w.a)(Object(T.isUrlAbsolute)(c)?c:""+o+c),options:{KeepBoth:s,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Object(w.a)(Object(T.isUrlAbsolute)(n)?n:""+o+n)}))];case 2:return e.sent(),[2]}})})},Qe.prototype.getShareable=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(j.c,"listItemAllFields",!1).select("odata.id")()];case 1:return t=e.sent(),n=Object(f.a)(Object(b.a)(t)),this.hasBatch&&(n=n.inBatch(this.batch)),[2,n]}})})},Object(g.b)([Object(I.a)("f.recycle")],Qe.prototype,"recycle",null),Object(g.b)([Object(I.a)("f.getItem")],Qe.prototype,"getItem",null),Object(g.b)([Object(I.a)("f.moveTo")],Qe.prototype,"moveTo",null),Object(g.b)([Object(I.a)("f.moveByPath")],Qe.prototype,"moveByPath",null),Object(g.b)([Object(I.a)("f.copyTo")],Qe.prototype,"copyTo",null),Object(g.b)([Object(I.a)("f.copyByPath")],Qe.prototype,"copyByPath",null),Object(g.b)([Object(I.a)("f.getShareable")],Qe.prototype,"getShareable",null),Qe),Ve=Object(j.i)(He),Ke=n(15);function Qe(){var t=null!==Me&&Me.apply(this,arguments)||this;return t.delete=Object(j.h)("f"),t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}function ze(){return null!==Ge&&Ge.apply(this,arguments)||this}Object(S.m)(re.e,"rootFolder",Ve,"rootFolder"),re.e.prototype.getDefaultColumnValues=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o,c,s;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.rootFolder.select("ServerRelativePath")()];case 1:return t=e.sent(),[4,this.select("ParentWeb/Url").expand("ParentWeb")()];case 2:n=e.sent(),r=Object(T.combine)("/",t.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),i=Object(T.combine)(n.ParentWeb.Url,"_api/web","getFileByServerRelativePath(decodedUrl='"+Object(P.a)(r)+"')"),o="",e.label=3;case 3:return e.trys.push([3,5,,6]),[4,Ve(i,"$value").usingParser(new S.l)(Object(S.x)({binaryStringResponseBody:"true"}))];case 4:return o=e.sent(),[3,6];case 5:if((c=e.sent())&&c.status&&404===c.status)return[2,[]];throw c;case 6:return[2,(null===(s=o.match(/<a.*?<\/a>/gi))?[]:s.map(function(e){return e.trim()})).map(function(e){var t=/<a href="(.*?)"><DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(e);return t.length<1?(Ke.d.write("Could not parse default column value from '"+e+"'",2),null):{name:t[2],path:decodeURIComponent(t[1]),value:t[3]}}).filter(function(e){return null!==e})]}})})},re.e.prototype.setDefaultColumnValues=function(a){return Object(g.a)(this,void 0,void 0,function(){var i,t,n,r,o,c,s;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(Qc.h)(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")()];case 1:return i=e.sent(),t=a.map(function(t){var e=i.findIndex(function(e){return e.InternalName===t.name});if(e<0)throw Error("Field '"+t.name+"' does not exist in the list. Please check the internal field name. Failed to set defaults.");var n=i[e],r="";switch(n.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(Object(T.isArray)(t.value))throw Error("The type '"+n.TypeAsString+"' does not support multiple values.");r=""+t.value;break;case"MultiChoice":r=Object(T.isArray)(t.value)?t.value.map(function(e){return""+e}).join(";"):""+t.value;break;case"UserMulti":r=Object(T.isArray)(t.value)?t.value.map(function(e){return""+e}).join(";#"):""+t.value;break;case"Taxonomy":if(Object(T.isArray)(t.value))throw Error("The type '"+n.TypeAsString+"' does not support multiple values.");r=t.value.wssId+";#"+t.value.termName+"|"+t.value.termId;break;case"TaxonomyMulti":Object(T.isArray)(t.value)&&(r=t.value.map(function(e){return e.wssId+";#"+e.termName+"|"+e.termId}).join(";#")),r=t.value.wssId+";#"+t.value.termName+"|"+t.value.termId}return'<a href="'+t.path.replace(/ /gi,"%20")+'"><DefaultValue FieldName="'+t.name+'">'+r+"</DefaultValue></a>"}),n="<MetadataDefaults>"+t.join("")+"</MetadataDefaults>",[4,this.rootFolder.select("ServerRelativePath")()];case 2:return r=e.sent(),[4,this.select("ParentWeb/Url").expand("ParentWeb")()];case 3:return o=e.sent(),c=Object(T.combine)("/",r.ServerRelativePath.DecodedUrl,"Forms"),s=Object(T.combine)(o.ParentWeb.Url,"_api/web","getFolderByServerRelativePath(decodedUrl='"+Object(P.a)(c)+"')","files"),[4,Object(m.d)(Ve(s,"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:n})];case 4:return e.sent(),[4,this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()];case 5:return e.sent().length<1?[4,Object(m.d)(Object(re.b)(this.eventReceivers,"add"),Object(S.n)({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}}))]:[3,7];case 6:e.sent(),e.label=7;case 7:return[2]}})})},n(38),He.prototype.getDefaultColumnValues=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Ve(this,"Properties").select("vti_x005f_listname")()];case 1:return t=e.sent(),[4,this.select("ServerRelativePath")()];case 2:return n=e.sent().ServerRelativePath,[4,Object(y.a)(Object(v.a)(Object(b.a)(t))).lists.getById(t.vti_x005f_listname).getDefaultColumnValues()];case 3:return[2,e.sent().filter(function(e){return e.path.toLowerCase()===n.DecodedUrl.toLowerCase()})]}})})},He.prototype.setDefaultColumnValues=function(s,a){return void 0===a&&(a=!0),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o,c;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Ve(this,"Properties").select("vti_x005f_listname")()];case 1:return t=e.sent(),n=Object(y.a)(Object(v.a)(Object(b.a)(t))),r=n.lists.getById(t.vti_x005f_listname),[4,this.select("ServerRelativePath")()];case 2:return i=e.sent().ServerRelativePath.DecodedUrl,[4,r.getDefaultColumnValues()];case 3:return o=e.sent(),c=a?o:o.filter(function(e){return e.path!==i}),s.forEach(function(t){var e=c.find(function(e){return e.name===t.name&&e.path===i});e?e.value=t.value:c.push({name:t.name,path:i,value:t.value})}),[4,r.setDefaultColumnValues(c)];case 4:return e.sent(),[2]}})})},He.prototype.clearDefaultColumnValues=function(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.setDefaultColumnValues([],!1)];case 1:return e.sent(),[2]}})})};var Xe,Je,$e,Ye,Ze=(Ye=j.e,Object(g.c)(lt,Ye),lt.prototype.addAvailableContentType=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(et,"addAvailableContentType"),Object(S.n)({contentTypeId:n}))];case 1:return t=e.sent(),[2,{contentType:this.getById(t.id),data:t}]}})})},lt.prototype.getById=function(e){return I.a.configure(nt(this).concat("('"+e+"')"),"cts.getById")},lt.prototype.add=function(r,i,o,c,s){return void 0===o&&(o=""),void 0===c&&(c="Custom Content Types"),void 0===s&&(s={}),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object.assign(Object(ne.a)("SP.ContentType"),{Description:o,Group:c,Id:{StringValue:r},Name:i},s)),[4,Object(m.d)(this,t)];case 1:return n=e.sent(),[2,{contentType:this.getById(n.id),data:n}]}})})},Object(g.b)([Object(I.a)("cts.addAvailableContentType")],lt.prototype,"addAvailableContentType",null),Object(g.b)([Object(I.a)("cts.add")],lt.prototype,"add",null),Object(g.b)([Object(O.a)("contenttypes")],lt)),et=Object(j.i)(Ze),tt=($e=j.f,Object(g.c)(ut,$e),Object.defineProperty(ut.prototype,"fieldLinks",{get:function(){return I.a.configure(it(this),"ct.fieldLinks")},enumerable:!1,configurable:!0}),Object.defineProperty(ut.prototype,"fields",{get:function(){return I.a.configure(Object(j.b)(this,"fields"),"ct.fields")},enumerable:!1,configurable:!0}),Object.defineProperty(ut.prototype,"parent",{get:function(){return I.a.configure(nt(this,"parent"),"ct.parent")},enumerable:!1,configurable:!0}),Object.defineProperty(ut.prototype,"workflowAssociations",{get:function(){return I.a.configure(Object(j.b)(this,"workflowAssociations"),"ct.workflowAssociations")},enumerable:!1,configurable:!0}),ut),nt=Object(j.i)(tt),rt=(Je=j.e,Object(g.c)(at,Je),at.prototype.getById=function(e){return I.a.configure(ct(this).concat("(guid'"+e+"')"),"fls.getById")},Object(g.b)([Object(O.a)("fieldlinks")],at)),it=Object(j.i)(rt),ot=(Xe=j.f,Object(g.c)(st,Xe),st),ct=Object(j.i)(ot);function st(){return null!==Xe&&Xe.apply(this,arguments)||this}function at(){return null!==Je&&Je.apply(this,arguments)||this}function ut(){var e=null!==$e&&$e.apply(this,arguments)||this;return e.delete=Object(j.g)("ct"),e}function lt(){return null!==Ye&&Ye.apply(this,arguments)||this}Object(S.m)(y.c,"contentTypes",et),Object(S.m)(f.f,"contentType",nt,"ContentType"),Object(S.m)(re.e,"contentTypes",et);var dt,pt,ht=(pt=j.e,Object(g.c)(yt,pt),yt.prototype.add=function(t,n){return void 0===n&&(n=!1),Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(bt,"add"),Object(S.n)({featdefScope:0,featureId:t,force:n}))];case 1:return[2,{data:e.sent(),feature:this.getById(t)}]}})})},yt.prototype.getById=function(e){var t=Ot(this);return t.concat("('"+e+"')"),I.a.configure(t,"fes.getById")},yt.prototype.remove=function(e,t){return void 0===t&&(t=!1),Object(m.d)(this.clone(bt,"remove"),Object(S.n)({featureId:e,force:t}))},Object(g.b)([Object(I.a)("fes.add")],yt.prototype,"add",null),Object(g.b)([Object(I.a)("fes.remove")],yt.prototype,"remove",null),Object(g.b)([Object(O.a)("features")],yt)),bt=Object(j.i)(ht),ft=(dt=j.f,Object(g.c)(gt,dt),gt.prototype.deactivate=function(i){return void 0===i&&(i=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,Ot(this).select("DefinitionId")()];case 1:return n=e.sent(),r=this.getParent(bt,this.parentUrl,"",this.batch).remove(n.DefinitionId,i),t(),[2,r]}})})},Object(g.b)([Object(I.a)("fe.deactivate")],gt.prototype,"deactivate",null),gt),Ot=Object(j.i)(ft);function gt(){return null!==dt&&dt.apply(this,arguments)||this}function yt(){return null!==pt&&pt.apply(this,arguments)||this}Object(S.m)(ie.b,"features",bt),Object(S.m)(y.c,"features",bt);var jt,mt,vt,St,Tt,Pt,It,wt,_t,Ct,Rt,Et,Nt,At,Ut,xt,Dt,kt,Lt=(Ct=j.e,Object(g.c)(qt,Ct),qt.prototype.getById=function(e){return I.a.configure(Mt(this).concat("('"+e+"')"),"fs.getById")},qt.prototype.getByTitle=function(e){return I.a.configure(Mt(this,"getByTitle('"+e+"')"),"fs.getByTitle")},qt.prototype.getByInternalNameOrTitle=function(e){return I.a.configure(Mt(this,"getByInternalNameOrTitle('"+e+"')"),"fs.getByInternalNameOrTitle")},qt.prototype.createFieldAsXml=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return"string"==typeof r&&(r={SchemaXml:r}),t=Object(S.n)({parameters:Object(T.assign)(Object(ne.a)("SP.XmlSchemaFieldCreationInformation"),r)}),[4,Object(m.d)(this.clone(Ft,"createfieldasxml"),t)];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},qt.prototype.add=function(r,i,o){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object.assign(Object(ne.a)(i),{Title:r},o)),I.a.isTagged(this)||I.a.configure(this,"fs.add"),[4,Object(m.d)(this.clone(Ft,null),t)];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},qt.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",Object(T.assign)(r,n))},qt.prototype.addCalculated=function(e,t,n,r,i){void 0===r&&(r=jt.Text);var o={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",Object(T.assign)(o,i))},qt.prototype.addDateTime=function(e,t,n,r,i){void 0===t&&(t=mt.DateOnly),void 0===n&&(n=Tt.Gregorian),void 0===r&&(r=vt.Unspecified);var o={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",Object(T.assign)(o,i))},qt.prototype.addNumber=function(e,t,n,r){var i={FieldTypeKind:9};return void 0!==t&&(i=Object(T.assign)({MinimumValue:t},i)),void 0!==n&&(i=Object(T.assign)({MaximumValue:n},i)),this.add(e,"SP.FieldNumber",Object(T.assign)(i,r))},qt.prototype.addCurrency=function(e,t,n,r,i){void 0===r&&(r=1033);var o={CurrencyLocaleId:r,FieldTypeKind:10};return void 0!==t&&(o=Object(T.assign)({MinimumValue:t},o)),void 0!==n&&(o=Object(T.assign)({MaximumValue:n},o)),this.add(e,"SP.FieldCurrency",Object(T.assign)(o,i))},qt.prototype.addMultilineText=function(e,t,n,r,i,o,c){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!0);var s={AllowHyperlink:o,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",Object(T.assign)(s,c))},qt.prototype.addUrl=function(e,t,n){void 0===t&&(t=Pt.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",Object(T.assign)(r,n))},qt.prototype.addUser=function(e,t,n){var r={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",Object(T.assign)(r,n))},qt.prototype.addLookup=function(i,o,c,s){return Object(g.a)(this,void 0,void 0,function(){var t,n,r;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(T.assign)({FieldTypeKind:7,LookupFieldName:c,LookupListId:o,Title:i},s),n=Object(S.n)({parameters:Object(T.assign)(Object(ne.a)("SP.FieldCreationInformation"),t)}),[4,Object(m.d)(this.clone(Ft,"addfield"),n)];case 1:return[2,{data:r=e.sent(),field:this.getById(r.Id)}]}})})},qt.prototype.addChoice=function(e,t,n,r,i){void 0===n&&(n=wt.Dropdown);var o={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:r};return this.add(e,"SP.FieldChoice",Object(T.assign)(o,i))},qt.prototype.addMultiChoice=function(e,t,n,r){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",Object(T.assign)(i,r))},qt.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",Object(T.assign)({FieldTypeKind:8},t))},qt.prototype.addDependentLookupField=function(r,i,o){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t="adddependentlookupfield(displayName='"+r+"', primarylookupfieldid='"+i+"', showfield='"+o+"')",[4,Object(m.d)(this.clone(Ft,t))];case 1:return[2,{data:n=e.sent(),field:this.getById(n.Id)}]}})})},qt.prototype.addLocation=function(e,t){return this.add(e,"SP.FieldLocation",Object(T.assign)({FieldTypeKind:33},t))},Object(g.b)([Object(I.a)("fs.createFieldAsXml")],qt.prototype,"createFieldAsXml",null),Object(g.b)([Object(I.a)("fs.addText")],qt.prototype,"addText",null),Object(g.b)([Object(I.a)("fs.addCalculated")],qt.prototype,"addCalculated",null),Object(g.b)([Object(I.a)("fs.addDateTime")],qt.prototype,"addDateTime",null),Object(g.b)([Object(I.a)("fs.addNumber")],qt.prototype,"addNumber",null),Object(g.b)([Object(I.a)("fs.addCurrency")],qt.prototype,"addCurrency",null),Object(g.b)([Object(I.a)("fs.addMultilineText")],qt.prototype,"addMultilineText",null),Object(g.b)([Object(I.a)("fs.addUrl")],qt.prototype,"addUrl",null),Object(g.b)([Object(I.a)("fs.addUser")],qt.prototype,"addUser",null),Object(g.b)([Object(I.a)("fs.addLookup")],qt.prototype,"addLookup",null),Object(g.b)([Object(I.a)("fs.addChoice")],qt.prototype,"addChoice",null),Object(g.b)([Object(I.a)("fs.addMultiChoice")],qt.prototype,"addMultiChoice",null),Object(g.b)([Object(I.a)("fs.addBoolean")],qt.prototype,"addBoolean",null),Object(g.b)([Object(I.a)("fs.addDependentLookupField")],qt.prototype,"addDependentLookupField",null),Object(g.b)([Object(I.a)("fs.addLocation")],qt.prototype,"addLocation",null),Object(g.b)([Object(O.a)("fields")],qt)),Ft=Object(j.i)(Lt),Bt=(_t=j.f,Object(g.c)(Gt,_t),Gt.prototype.update=function(r,i){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return null!=i?[3,2]:[4,Mt(this).select("FieldTypeKind").configure({headers:{Accept:"application/json"}})()];case 1:t=e.sent(),i=t["odata.type"],e.label=2;case 2:return n=Object(S.n)(Object(T.assign)(Object(ne.a)(i),r),Object(S.x)({"X-HTTP-Method":"MERGE"})),[4,Object(m.d)(this,n)];case 3:return[2,{data:e.sent(),field:this}]}})})},Gt.prototype.setShowInDisplayForm=function(e){return Object(m.d)(this.clone(Mt,"setshowindisplayform("+e+")"))},Gt.prototype.setShowInEditForm=function(e){return Object(m.d)(this.clone(Mt,"setshowineditform("+e+")"))},Gt.prototype.setShowInNewForm=function(e){return Object(m.d)(this.clone(Mt,"setshowinnewform("+e+")"))},Object(g.b)([Object(I.a)("f.update")],Gt.prototype,"update",null),Object(g.b)([Object(I.a)("f.setShowInDisplayForm")],Gt.prototype,"setShowInDisplayForm",null),Object(g.b)([Object(I.a)("f.setShowInEditForm")],Gt.prototype,"setShowInEditForm",null),Object(g.b)([Object(I.a)("f.setShowInNewForm")],Gt.prototype,"setShowInNewForm",null),Gt),Mt=Object(j.i)(Bt);function Gt(){var e=null!==_t&&_t.apply(this,arguments)||this;return e.delete=Object(j.g)("f"),e}function qt(){return null!==Ct&&Ct.apply(this,arguments)||this}(kt=jt=jt||{})[kt.Invalid=0]="Invalid",kt[kt.Integer=1]="Integer",kt[kt.Text=2]="Text",kt[kt.Note=3]="Note",kt[kt.DateTime=4]="DateTime",kt[kt.Counter=5]="Counter",kt[kt.Choice=6]="Choice",kt[kt.Lookup=7]="Lookup",kt[kt.Boolean=8]="Boolean",kt[kt.Number=9]="Number",kt[kt.Currency=10]="Currency",kt[kt.URL=11]="URL",kt[kt.Computed=12]="Computed",kt[kt.Threading=13]="Threading",kt[kt.Guid=14]="Guid",kt[kt.MultiChoice=15]="MultiChoice",kt[kt.GridChoice=16]="GridChoice",kt[kt.Calculated=17]="Calculated",kt[kt.File=18]="File",kt[kt.Attachments=19]="Attachments",kt[kt.User=20]="User",kt[kt.Recurrence=21]="Recurrence",kt[kt.CrossProjectLink=22]="CrossProjectLink",kt[kt.ModStat=23]="ModStat",kt[kt.Error=24]="Error",kt[kt.ContentTypeId=25]="ContentTypeId",kt[kt.PageSeparator=26]="PageSeparator",kt[kt.ThreadIndex=27]="ThreadIndex",kt[kt.WorkflowStatus=28]="WorkflowStatus",kt[kt.AllDayEvent=29]="AllDayEvent",kt[kt.WorkflowEventType=30]="WorkflowEventType",(Dt=mt=mt||{})[Dt.DateOnly=0]="DateOnly",Dt[Dt.DateTime=1]="DateTime",(xt=vt=vt||{})[xt.Unspecified=0]="Unspecified",xt[xt.Disabled=1]="Disabled",xt[xt.Relative=2]="Relative",(Ut=St=St||{})[Ut.DefaultValue=0]="DefaultValue",Ut[Ut.AddToDefaultContentType=1]="AddToDefaultContentType",Ut[Ut.AddToNoContentType=2]="AddToNoContentType",Ut[Ut.AddToAllContentTypes=4]="AddToAllContentTypes",Ut[Ut.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",Ut[Ut.AddFieldToDefaultView=16]="AddFieldToDefaultView",Ut[Ut.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName",(At=Tt=Tt||{})[At.Gregorian=1]="Gregorian",At[At.Japan=3]="Japan",At[At.Taiwan=4]="Taiwan",At[At.Korea=5]="Korea",At[At.Hijri=6]="Hijri",At[At.Thai=7]="Thai",At[At.Hebrew=8]="Hebrew",At[At.GregorianMEFrench=9]="GregorianMEFrench",At[At.GregorianArabic=10]="GregorianArabic",At[At.GregorianXLITEnglish=11]="GregorianXLITEnglish",At[At.GregorianXLITFrench=12]="GregorianXLITFrench",At[At.KoreaJapanLunar=14]="KoreaJapanLunar",At[At.ChineseLunar=15]="ChineseLunar",At[At.SakaEra=16]="SakaEra",At[At.UmAlQura=23]="UmAlQura",(Nt=Pt=Pt||{})[Nt.Hyperlink=0]="Hyperlink",Nt[Nt.Image=1]="Image",(Et=It=It||{})[Et.PeopleAndGroups=1]="PeopleAndGroups",Et[Et.PeopleOnly=0]="PeopleOnly",(Rt=wt=wt||{})[Rt.Dropdown=0]="Dropdown",Rt[Rt.RadioButtons=1]="RadioButtons",Object(S.m)(y.c,"fields",Ft),Object(S.m)(y.c,"availablefields",Ft,"availablefields"),Object(S.m)(re.e,"fields",Ft),Object(S.m)(He,"files",C),Object(S.m)(f.f,"file",E,"file"),Object(S.m)(f.f,"folder",Ve,"folder"),Object(S.m)(re.e,"rootFolder",Ve,"rootFolder"),Object(S.m)(y.c,"folders",We),Object(S.m)(y.c,"rootFolder",Ve,"rootFolder"),y.c.prototype.getFolderByServerRelativeUrl=function(e){return Ve(this,"getFolderByServerRelativeUrl('"+Object(P.a)(e)+"')")},y.c.prototype.getFolderByServerRelativePath=function(e){return Ve(this,"getFolderByServerRelativePath(decodedUrl='"+Object(P.a)(e)+"')")},y.c.prototype.getFolderById=function(e){return Ve(this,"getFolderById('"+e+"')")};var Wt,Ht,Vt=(Ht=j.e,Object(g.c)(Jt,Ht),Jt.prototype.getById=function(e){return I.a.configure(zt(this).concat("('"+e+"')"),"fos.getById")},Object(g.b)([Object(O.a)("forms")],Jt)),Kt=Object(j.i)(Vt),Qt=(Wt=j.f,Object(g.c)(Xt,Wt),Xt),zt=Object(j.i)(Qt);function Xt(){return null!==Wt&&Wt.apply(this,arguments)||this}function Jt(){return null!==Ht&&Ht.apply(this,arguments)||this}Object(S.m)(re.e,"forms",Kt,"forms");var $t,Yt,Zt=(Yt=j.e,Object(g.c)(on,Yt),on.prototype.getById=function(e){return I.a.configure(nn(this,"GetById?hubSiteId='"+e+"'"),"hss.getById")},Object(g.b)([Object(O.a)("_api/hubsites")],on)),en=Object(j.i)(Zt),tn=($t=j.f,Object(g.c)(rn,$t),rn.prototype.getSite=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.select("SiteUrl")()];case 1:return t=e.sent(),[2,Object(ie.a)(t.SiteUrl)]}})})},Object(g.b)([Object(I.a)("hs.getSite")],rn.prototype,"getSite",null),rn),nn=Object(j.i)(tn);function rn(){return null!==$t&&$t.apply(this,arguments)||this}function on(){return null!==Yt&&Yt.apply(this,arguments)||this}ie.b.prototype.joinHubSite=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(ie.a,"joinHubSite('"+t+"')"))];case 1:return e.sent(),[2]}})})},ie.b.prototype.registerHubSite=function(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(ie.a,"registerHubSite"))];case 1:return e.sent(),[2]}})})},ie.b.prototype.unRegisterHubSite=function(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(ie.a,"unRegisterHubSite"))];case 1:return e.sent(),[2]}})})},y.c.prototype.hubSiteData=function(n){return void 0===n&&(n=!1),Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(y.a,"hubSiteData("+n+")")()];case 1:return"string"==typeof(t=e.sent())?[2,JSON.parse(t)]:[2,t]}})})},y.c.prototype.syncHubSiteTheme=function(){return Object(m.d)(this.clone(y.a,"syncHubSiteTheme"))},Reflect.defineProperty(h.a.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return en(this._baseUrl).configure(this._options)}});var cn,sn,an,un,ln=(un=j.e,Object(g.c)(vn,un),vn.prototype.getById=function(e){return I.a.configure(hn(this).concat("("+e+")"),"nns.getById")},vn.prototype.add=function(r,i,o){return void 0===o&&(o=!0),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object(T.assign)(Object(ne.a)("SP.NavigationNode"),{IsVisible:o,Title:r,Url:i})),[4,Object(m.d)(this.clone(dn,null),t)];case 1:return[2,{data:n=e.sent(),node:this.getById(n.Id)}]}})})},vn.prototype.moveAfter=function(e,t){var n=Object(S.n)({nodeId:e,previousNodeId:t});return Object(m.d)(this.clone(dn,"MoveAfter"),n)},Object(g.b)([Object(I.a)("nns.add")],vn.prototype,"add",null),Object(g.b)([Object(I.a)("nns.moveAfter")],vn.prototype,"moveAfter",null),vn),dn=Object(j.i)(ln),pn=(an=j.f,Object(g.c)(mn,an),Object.defineProperty(mn.prototype,"children",{get:function(){return I.a.configure(dn(this,"children"),"nn.children")},enumerable:!1,configurable:!0}),mn.prototype.update=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object(T.assign)(Object(ne.a)("SP.NavigationNode"),n),Object(S.x)({"X-HTTP-Method":"MERGE"})),[4,Object(m.d)(this,t)];case 1:return[2,{data:e.sent(),node:this}]}})})},Object(g.b)([Object(I.a)("nn.update")],mn.prototype,"update",null),mn),hn=Object(j.i)(pn),bn=(sn=j.d,Object(g.c)(jn,sn),Object.defineProperty(jn.prototype,"quicklaunch",{get:function(){return I.a.configure(dn(this,"quicklaunch"),"n.quicklaunch")},enumerable:!1,configurable:!0}),Object.defineProperty(jn.prototype,"topNavigationBar",{get:function(){return I.a.configure(dn(this,"topnavigationbar"),"n.topnavigationbar")},enumerable:!1,configurable:!0}),Object(g.b)([Object(O.a)("navigation")],jn)),fn=Object(j.i)(bn),On=(cn=j.d,Object(g.c)(yn,cn),yn.prototype.getMenuState=function(e,t,n,r){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===n&&(n=null),void 0===r&&(r=null),Object(m.d)(gn("MenuState"),Object(S.n)({customProperties:r,depth:t,mapProviderName:n,menuNodeKey:e}))},yn.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),Object(m.d)(gn("MenuNodeKey"),Object(S.n)({currentUrl:e,mapProviderName:t}))},Object(g.b)([Object(I.a)("ns.getMenuState")],yn.prototype,"getMenuState",null),Object(g.b)([Object(I.a)("ns.getMenuNodeKey")],yn.prototype,"getMenuNodeKey",null),yn),gn=function(e){return new On(e)};function yn(e){return void 0===e&&(e=null),cn.call(this,"_api/navigation",e)||this}function jn(){return null!==sn&&sn.apply(this,arguments)||this}function mn(){var e=null!==an&&an.apply(this,arguments)||this;return e.delete=Object(j.g)("nn"),e}function vn(){return null!==un&&un.apply(this,arguments)||this}Object(S.m)(y.c,"navigation",fn),Reflect.defineProperty(h.a.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return gn().configure(this._options)}});var Sn,Tn,Pn,In,wn,_n=(In=j.f,Object(g.c)(Dn,In),Object.defineProperty(Dn.prototype,"editProfileLink",{get:function(){return this.clone(Cn,"EditProfileLink").get()},enumerable:!1,configurable:!0}),Object.defineProperty(Dn.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(Cn,"IsMyPeopleListPublic").get()},enumerable:!1,configurable:!0}),Dn.prototype.amIFollowedBy=function(e){var t=this.clone(Cn,"amifollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Dn.prototype.amIFollowing=function(e){var t=this.clone(Cn,"amifollowing(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Dn.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(Cn,"getfollowedtags("+e+")").get()},Dn.prototype.getFollowersFor=function(e){var t=this.clone(Cn,"getfollowersfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(Dn.prototype,"myFollowers",{get:function(){return Object(j.b)(this,"getmyfollowers")},enumerable:!1,configurable:!0}),Object.defineProperty(Dn.prototype,"myProperties",{get:function(){return new Dn(this,"getmyproperties")},enumerable:!1,configurable:!0}),Dn.prototype.getPeopleFollowedBy=function(e){var t=this.clone(Cn,"getpeoplefollowedby(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Dn.prototype.getPropertiesFor=function(e){var t=this.clone(Cn,"getpropertiesfor(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(Dn.prototype,"trendingTags",{get:function(){var e=this.clone(Cn,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!1,configurable:!0}),Dn.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(Cn,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Dn.prototype.hideSuggestion=function(e){var t=this.clone(Cn,"hidesuggestion(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),Object(m.d)(t)},Dn.prototype.isFollowing=function(e,t){var n=this.clone(Cn,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.query.set("@y","'"+encodeURIComponent(t)+"'"),n.get()},Dn.prototype.setMyProfilePic=function(t){var n=this;return new Promise(function(i,o){var e=new FileReader;e.onload=function(r){return Object(g.a)(n,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:t=r.target.result,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Object(m.d)(Cn(this,"setmyprofilepicture"),{body:t})];case 2:return e.sent(),i(),[3,4];case 3:return n=e.sent(),o(n),[3,4];case 4:return[2]}})})},e.readAsArrayBuffer(t)})},Dn.prototype.setSingleValueProfileProperty=function(e,t,n){return Object(m.d)(this.clone(Cn,"SetSingleValueProfileProperty"),Object(S.n)({accountName:e,propertyName:t,propertyValue:n}))},Dn.prototype.setMultiValuedProfileProperty=function(e,t,n){return Object(m.d)(this.clone(Cn,"SetMultiValuedProfileProperty"),Object(S.n)({accountName:e,propertyName:t,propertyValues:n}))},Dn.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(Dn.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!1,configurable:!0}),Object.defineProperty(Dn.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!1,configurable:!0}),Dn.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},Dn.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},Dn.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},Dn.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},Dn),Cn=Object(j.i)(_n),Rn=(Pn=j.d,Object(g.c)(xn,Pn),xn.prototype.createPersonalSiteEnqueueBulk=function(e){return Object(m.d)(this.clone(En,"createpersonalsiteenqueuebulk",!1),Object(S.n)({emailIDs:e}))},Object.defineProperty(xn.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(En,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),Object(m.d)(e)},enumerable:!1,configurable:!0}),Object.defineProperty(xn.prototype,"userProfile",{get:function(){return Object(m.d)(this.clone(En,"getuserprofile"))},enumerable:!1,configurable:!0}),xn.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),Object(m.d)(this.clone(En,"getuserprofile/createpersonalsiteenque("+e+")"))},xn.prototype.shareAllSocialData=function(e){return Object(m.d)(this.clone(En,"getuserprofile/shareallsocialdata("+e+")"))},Object(g.b)([Object(O.a)("_api/sp.userprofiles.profileloader.getprofileloader")],xn)),En=function(e,t){return new Rn(e,t)},Nn=(Tn=j.d,Object(g.c)(Un,Tn),Un.prototype.clientPeoplePickerResolveUser=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return(t=this.clone(An,null)).concat(".clientpeoplepickerresolveuser"),[4,Object(m.d)(t,this.getBodyFrom(r))];case 1:return n=e.sent(),[2,JSON.parse("object"==typeof n?n.ClientPeoplePickerResolveUser:n)]}})})},Un.prototype.clientPeoplePickerSearchUser=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return(t=this.clone(An,null)).concat(".clientpeoplepickersearchuser"),[4,Object(m.d)(t,this.getBodyFrom(r))];case 1:return n=e.sent(),[2,JSON.parse("object"==typeof n?n.ClientPeoplePickerSearchUser:n)]}})})},Un.prototype.getBodyFrom=function(e){return Object(S.n)({queryParams:Object(T.assign)(Object(ne.a)("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},Object(g.b)([Object(O.a)("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],Un)),An=function(e,t){return new Nn(e,t)};function Un(){return null!==Tn&&Tn.apply(this,arguments)||this}function xn(){return null!==Pn&&Pn.apply(this,arguments)||this}function Dn(e,t){void 0===t&&(t="_api/sp.userprofiles.peoplemanager");var n=In.call(this,e,t)||this;return n.clientPeoplePickerQuery=new Nn(e).configureFrom(n),n.profileLoader=new Rn(e).configureFrom(n),n}(wn=Sn=Sn||{})[wn.DefaultZone=0]="DefaultZone",wn[wn.Intranet=1]="Intranet",wn[wn.Internet=2]="Internet",wn[wn.Custom=3]="Custom",wn[wn.Extranet=4]="Extranet",Reflect.defineProperty(h.a.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return Cn(this._baseUrl)}});var kn,Ln,Fn,Bn=(Fn=j.f,Object(g.c)(Qn,Fn),Object.defineProperty(Qn.prototype,"installedLanguages",{get:function(){return console.warn("Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages"),I.a.configure(Object(j.b)(this,"installedlanguages"),"rs.installedLanguages")},enumerable:!1,configurable:!0}),Object.defineProperty(Qn.prototype,"timeZone",{get:function(){return I.a.configure(qn(this),"rs.tz")},enumerable:!1,configurable:!0}),Object.defineProperty(Qn.prototype,"timeZones",{get:function(){return I.a.configure(Hn(this),"rs.tzs")},enumerable:!1,configurable:!0}),Qn.prototype.getInstalledLanguages=function(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,I.a.configure(Object(j.b)(this,"installedlanguages"),"rs.getInstalledLanguages")()];case 1:return[2,e.sent().Items]}})})},Object(g.b)([Object(O.a)("regionalsettings")],Qn)),Mn=Object(j.i)(Bn),Gn=(Ln=j.f,Object(g.c)(Kn,Ln),Kn.prototype.utcToLocalTime=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t="string"==typeof r?r:r.toISOString(),[4,Object(m.d)(this.clone(qn,"utctolocaltime('"+t+"')"))];case 1:return n=e.sent(),[2,Object(T.hOP)(n,"UTCToLocalTime")?n.UTCToLocalTime:n]}})})},Kn.prototype.localTimeToUTC=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t="string"==typeof r?r:Object(T.dateAdd)(r,"minute",-1*r.getTimezoneOffset()).toISOString(),[4,Object(m.d)(this.clone(qn,"localtimetoutc('"+t+"')"))];case 1:return n=e.sent(),[2,Object(T.hOP)(n,"LocalTimeToUTC")?n.LocalTimeToUTC:n]}})})},Object(g.b)([Object(I.a)("tz.utcToLocalTime")],Kn.prototype,"utcToLocalTime",null),Object(g.b)([Object(I.a)("tz.localTimeToUTC")],Kn.prototype,"localTimeToUTC",null),Object(g.b)([Object(O.a)("timezone")],Kn)),qn=Object(j.i)(Gn),Wn=(kn=j.e,Object(g.c)(Vn,kn),Vn.prototype.getById=function(e){return Object(m.d)(this.clone(Hn,"GetById("+e+")").usingParser(Object(b.b)(qn)))},Object(g.b)([Object(I.a)("tzs.getById")],Vn.prototype,"getById",null),Object(g.b)([Object(O.a)("timezones")],Vn)),Hn=Object(j.i)(Wn);function Vn(){return null!==kn&&kn.apply(this,arguments)||this}function Kn(){return null!==Ln&&Ln.apply(this,arguments)||this}function Qn(){return null!==Fn&&Fn.apply(this,arguments)||this}function zn(t){return function(e){return Object(m.d)(this.clone(j.a,t+"/getValueForUICulture"),Object(S.n)({cultureName:e}))}}Object(S.m)(y.c,"regionalSettings",Mn),y.c.prototype.titleResource=zn("titleResource"),y.c.prototype.descriptionResource=zn("descriptionResource");var Xn,Jn,$n,Yn,Zn,er,tr=(Yn=j.e,Object(g.c)(cr,Yn),cr.prototype.getById=function(e){return I.a.configure(ir(this).concat("('"+e+"')"),"ucas.getById")},cr.prototype.add=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this,Object(S.n)(Object(T.assign)(Object(ne.a)("SP.UserCustomAction"),n)))];case 1:return t=e.sent(),[2,{action:this.getById(t.Id),data:t}]}})})},cr.prototype.clear=function(){return Object(m.d)(this.clone(nr,"clear"))},Object(g.b)([Object(I.a)("ucas.add")],cr.prototype,"add",null),Object(g.b)([Object(I.a)("ucas.clear")],cr.prototype,"clear",null),Object(g.b)([Object(O.a)("usercustomactions")],cr)),nr=Object(j.i)(tr),rr=($n=j.f,Object(g.c)(or,$n),or),ir=Object(j.i)(rr);function or(){var t=null!==$n&&$n.apply(this,arguments)||this;return t.delete=Object(j.g)("uca"),t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}function cr(){return null!==Yn&&Yn.apply(this,arguments)||this}(er=Xn=Xn||{})[er.None=0]="None",er[er.List=1]="List",er[er.ContentType=2]="ContentType",er[er.ProgId=3]="ProgId",er[er.FileType=4]="FileType",(Zn=Jn=Jn||{})[Zn.Unknown=0]="Unknown",Zn[Zn.Site=2]="Site",Zn[Zn.Web=3]="Web",Zn[Zn.List=4]="List",rr.prototype.titleResource=zn("titleResource"),rr.prototype.descriptionResource=zn("descriptionResource"),re.e.prototype.titleResource=zn("titleResource"),re.e.prototype.descriptionResource=zn("descriptionResource"),Bt.prototype.titleResource=zn("titleResource"),Bt.prototype.descriptionResource=zn("descriptionResource"),tt.prototype.titleResource=zn("titleResource"),tt.prototype.descriptionResource=zn("descriptionResource");var sr,ar=(sr=j.d,Object(g.c)(pr,sr),pr.prototype.getRelatedItems=function(e,t){var n=this.clone(ur,null);return n.concat(".GetRelatedItems"),Object(m.d)(n,Object(S.n)({SourceItemID:t,SourceListName:e}))},pr.prototype.getPageOneRelatedItems=function(e,t){var n=this.clone(ur,null);return n.concat(".GetPageOneRelatedItems"),Object(m.d)(n,Object(S.n)({SourceItemID:t,SourceListName:e}))},pr.prototype.addSingleLink=function(e,t,n,r,i,o,c){void 0===c&&(c=!1);var s=this.clone(ur,null);return s.concat(".AddSingleLink"),Object(m.d)(s,Object(S.n)({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:r,TargetWebUrl:o,TryAddReverseLink:c}))},pr.prototype.addSingleLinkToUrl=function(e,t,n,r){void 0===r&&(r=!1);var i=this.clone(ur,null);return i.concat(".AddSingleLinkToUrl"),Object(m.d)(i,Object(S.n)({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:r}))},pr.prototype.addSingleLinkFromUrl=function(e,t,n,r){void 0===r&&(r=!1);var i=this.clone(ur,null);return i.concat(".AddSingleLinkFromUrl"),Object(m.d)(i,Object(S.n)({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:r}))},pr.prototype.deleteSingleLink=function(e,t,n,r,i,o,c){void 0===c&&(c=!1);var s=this.clone(ur,null);return s.concat(".DeleteSingleLink"),Object(m.d)(s,Object(S.n)({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:r,TargetWebUrl:o,TryDeleteReverseLink:c}))},Object(g.b)([Object(I.a)("rim.getRelatedItems")],pr.prototype,"getRelatedItems",null),Object(g.b)([Object(I.a)("rim.getPageOneRelatedItems")],pr.prototype,"getPageOneRelatedItems",null),Object(g.b)([Object(I.a)("rim.addSingleLink")],pr.prototype,"addSingleLink",null),Object(g.b)([Object(I.a)("rim.ToUrl")],pr.prototype,"addSingleLinkToUrl",null),Object(g.b)([Object(I.a)("rim.FromUrl")],pr.prototype,"addSingleLinkFromUrl",null),Object(g.b)([Object(I.a)("rim.deleteSingleLink")],pr.prototype,"deleteSingleLink",null),Object(g.b)([Object(O.a)("_api/SP.RelatedItemManager")],pr)),ur=function(e){return new ar(Object(v.a)("string"==typeof e?e:e.toUrl()))},lr=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),dr=new Map([]);function pr(){return null!==sr&&sr.apply(this,arguments)||this}function hr(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function br(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(r,e,i){var o=e.toString();if("toSearchQuery"===o)return function(){return r.query};if(lr.has(o))return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=lr.get(o);return r.query[0<n.length?n:hr(o)]=1<e.length?e:e[0],i};var t=dr.has(o)?dr.get(o):hr(o);return r.query[t]=!0,i}})}var fr,Or,gr,yr,jr,mr,vr,Sr,Tr=/_api\/search\/postquery$/i,Pr=(jr=j.f,Object(g.c)(Nr,jr),Nr.prototype.execute=function(o){return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.parseQuery(o),n=Object(S.n)({request:Object(T.assign)(Object(ne.a)("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))}),this.data.useCaching&&(this._forceCaching=!0,r="PnPjs.SearchWithCaching("+Object(T.getHashCode)(n.body)+")",Object(T.objectDefinedNotNull)(this.data.cachingOptions)?Tr.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=r):this.data.cachingOptions=new S.d(r)),[4,Object(m.d)(this,n)];case 1:return i=e.sent(),[2,new wr(i,this.toUrl(),t)]}})})},Nr.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:{results:Object(T.isArray)(e)?e:[e]}},Nr.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},Object(g.b)([Object(I.a)("se.execute")],Nr.prototype,"execute",null),Object(g.b)([Object(O.a)("_api/search/postquery")],Nr)),Ir=function(t,n){return void 0===n&&(n={}),function(e){return new Pr(t).configure(n).execute(e)}},wr=(Object.defineProperty(Er.prototype,"ElapsedTime",{get:function(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0},enumerable:!1,configurable:!0}),Object.defineProperty(Er.prototype,"RowCount",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.RowCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(Er.prototype,"TotalRows",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRows)||0},enumerable:!1,configurable:!0}),Object.defineProperty(Er.prototype,"TotalRowsIncludingDuplicates",{get:function(){var e,t,n;return(null===(n=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.TotalRowsIncludingDuplicates)||0},enumerable:!1,configurable:!0}),Object.defineProperty(Er.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!1,configurable:!0}),Object.defineProperty(Er.prototype,"PrimarySearchResults",{get:function(){var e,t,n,r;return null===this._primary&&(this._primary=this.formatSearchResults((null===(r=null===(n=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===r?void 0:r.Rows)||null)),this._primary},enumerable:!1,configurable:!0}),Er.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:Object(T.hOP)(this._query,"RowLimit")?this._query.RowLimit:10,r=Object(T.assign)(this._query,{RowLimit:n,StartRow:n*(e-1)});return r.StartRow>this.TotalRows?Promise.resolve(null):Ir(this._url)(r)},Er.prototype.formatSearchResults=function(e){var t,n,r=new Array;if(void 0===e||null==e)return[];var i=e.results?e.results:e;try{for(var o=Object(g.f)(i),c=o.next();!c.done;c=o.next()){var s=c.value,a=s.Cells.results?s.Cells.results:s.Cells;r.push(a.reduce(function(e,t){return Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},Er),_r=(yr=j.f,Object(g.c)(Rr,yr),Rr.prototype.execute=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return this.mapQueryToQueryString(r),[4,this.get()];case 1:return t=e.sent(),[2,{PeopleNames:(n=Object(T.hOP)(t,"suggest")?function(e){return t.suggest[e].results}:function(e){return t[e]})("PeopleNames"),PersonalResults:n("PersonalResults"),Queries:n("Queries")}]}})})},Rr.prototype.mapQueryToQueryString=function(e){var n=this;this.query.set("querytext","'"+e.querytext+"'");var r,t=(r=e,function(t){return function(e){Object(T.hOP)(r,t)&&n.query.set(e,r[t].toString())}});t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")},Object(g.b)([Object(I.a)("su.execute")],Rr.prototype,"execute",null),Object(g.b)([Object(O.a)("_api/search/suggest")],Rr)),Cr=function(t,n){return void 0===n&&(n={}),function(e){return new _r(t).configure(n).execute(e)}};function Rr(){return null!==yr&&yr.apply(this,arguments)||this}function Er(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this._url=t,this._query=n,this._raw=r,this._primary=i,this._url=this._url.replace(Tr,""),this._raw=e.postquery?e.postquery:e}function Nr(){return null!==jr&&jr.apply(this,arguments)||this}(Sr=fr=fr||{})[Sr.Ascending=0]="Ascending",Sr[Sr.Descending=1]="Descending",Sr[Sr.FQLFormula=2]="FQLFormula",(vr=Or=Or||{})[vr.ResultContainsKeyword=0]="ResultContainsKeyword",vr[vr.TitleContainsKeyword=1]="TitleContainsKeyword",vr[vr.TitleMatchesKeyword=2]="TitleMatchesKeyword",vr[vr.UrlStartsWith=3]="UrlStartsWith",vr[vr.UrlExactlyMatches=4]="UrlExactlyMatches",vr[vr.ContentTypeIs=5]="ContentTypeIs",vr[vr.FileExtensionMatches=6]="FileExtensionMatches",vr[vr.ResultHasTag=7]="ResultHasTag",vr[vr.ManualCondition=8]="ManualCondition",(mr=gr=gr||{})[mr.None=0]="None",mr[mr.StringType=1]="StringType",mr[mr.Int32Type=2]="Int32Type",mr[mr.BooleanType=3]="BooleanType",mr[mr.StringArrayType=4]="StringArrayType",mr[mr.UnSupportedType=5]="UnSupportedType";var Ar=(Ur.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",Ur.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",Ur.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",Ur.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",Ur.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",Ur.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",Ur.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",Ur.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",Ur.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",Ur.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",Ur.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",Ur.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",Ur.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",Ur.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",Ur.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",Ur);function Ur(){}h.a.prototype.search=function(e){return Ir(this._baseUrl,this._options)(e)},h.a.prototype.searchWithCaching=function(e,t){return new Pr(this._baseUrl).configure(this._options).usingCaching(t).execute(e)},h.a.prototype.searchSuggest=function(e){return Cr(this._baseUrl,this._options)("string"==typeof e?{querytext:e}:e)};var xr,Dr,kr,Lr,Fr,Br,Mr,Gr,qr,Wr,Hr,Vr,Kr,Qr,zr,Xr,Jr,$r,Yr,Zr,ei,ti,ni=(zr=j.e,Object(g.c)(Ii,zr),Ii.prototype.getById=function(e){return I.a.configure(oi(this,"getById("+e+")"),"sus.getById")},Ii.prototype.getByEmail=function(e){return I.a.configure(oi(this,"getByEmail('"+e+"')"),"sus.getByEmail")},Ii.prototype.getByLoginName=function(e){return I.a.configure(oi(this).concat("('!@v::"+encodeURIComponent(e)+"')"),"sus.getByLoginName")},Ii.prototype.removeById=function(e){return Object(m.d)(this.clone(ri,"removeById("+e+")"))},Ii.prototype.removeByLoginName=function(e){var t=this.clone(ri,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),Object(m.d)(t)},Ii.prototype.add=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this,Object(S.n)(Object(T.assign)(Object(ne.a)("SP.User"),{LoginName:t})))];case 1:return e.sent(),[2,this.getByLoginName(t)]}})})},Object(g.b)([Object(I.a)("sus.remId")],Ii.prototype,"removeById",null),Object(g.b)([Object(I.a)("sus.remLoginName")],Ii.prototype,"removeByLoginName",null),Object(g.b)([Object(I.a)("sus.add")],Ii.prototype,"add",null),Object(g.b)([Object(O.a)("siteusers")],Ii)),ri=Object(j.i)(ni),ii=(Qr=j.f,Object(g.c)(Pi,Qr),Object.defineProperty(Pi.prototype,"groups",{get:function(){return I.a.configure(si(this,"groups"),"su.groups")},enumerable:!1,configurable:!0}),Pi),oi=Object(j.i)(ii),ci=(Kr=j.e,Object(g.c)(Ti,Kr),Ti.prototype.getById=function(e){return I.a.configure(ui(this).concat("("+e+")"),"sgs.getById")},Ti.prototype.add=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object(T.assign)(Object(ne.a)("SP.Group"),r)),[4,Object(m.d)(I.a.configure(this,"sgs.add"),t)];case 1:return[2,{data:n=e.sent(),group:this.getById(n.Id)}]}})})},Ti.prototype.getByName=function(e){return I.a.configure(ui(this,"getByName('"+e+"')"),"sgs.getByName")},Ti.prototype.removeById=function(e){return Object(m.d)(this.clone(si,"removeById('"+e+"')"))},Ti.prototype.removeByLoginName=function(e){return Object(m.d)(this.clone(si,"removeByLoginName('"+e+"')"))},Object(g.b)([Object(I.a)("sgs.removeById")],Ti.prototype,"removeById",null),Object(g.b)([Object(I.a)("sgs.removeByLoginName")],Ti.prototype,"removeByLoginName",null),Object(g.b)([Object(O.a)("sitegroups")],Ti)),si=Object(j.i)(ci),ai=(Vr=j.f,Object(g.c)(Si,Vr),Object.defineProperty(Si.prototype,"users",{get:function(){return I.a.configure(ri(this,"users"),"sg.users")},enumerable:!1,configurable:!0}),Si.prototype.setUserAsOwner=function(e){return Object(m.d)(this.clone(ui,"SetUserAsOwner("+e+")"))},Object(g.b)([Object(I.a)("sg.setUserAsOwner")],Si.prototype,"setUserAsOwner",null),Si),ui=Object(j.i)(ai),li=(Hr=j.e,Object(g.c)(vi,Hr),vi.prototype.getById=function(e){return hi(this).concat("("+e+")")},vi.prototype.add=function(t,n){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(di,"addroleassignment(principalid="+t+", roledefid="+n+")"))];case 1:return e.sent(),[2]}})})},vi.prototype.remove=function(t,n){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(di,"removeroleassignment(principalid="+t+", roledefid="+n+")"))];case 1:return e.sent(),[2]}})})},Object(g.b)([Object(O.a)("roleassignments")],vi)),di=Object(j.i)(li),pi=(Wr=j.f,Object(g.c)(mi,Wr),Object.defineProperty(mi.prototype,"groups",{get:function(){return I.a.configure(si(this,"groups"),"ra.groups")},enumerable:!1,configurable:!0}),Object.defineProperty(mi.prototype,"bindings",{get:function(){return Object(j.b)(this,"roledefinitionbindings")},enumerable:!1,configurable:!0}),mi),hi=Object(j.i)(pi),bi=(qr=j.e,Object(g.c)(ji,qr),ji.prototype.getById=function(e){return gi(this,"getById("+e+")")},ji.prototype.getByName=function(e){return gi(this,"getbyname('"+e+"')")},ji.prototype.getByType=function(e){return gi(this,"getbytype("+e+")")},ji.prototype.add=function(r,i,o,c){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)({BasePermissions:{High:c.High.toString(),Low:c.Low.toString()},Description:i,Name:r,Order:o,__metadata:{type:"SP.RoleDefinition"}}),[4,Object(m.d)(this,t)];case 1:return[2,{data:n=e.sent(),definition:this.getById(n.Id)}]}})})},Object(g.b)([Object(O.a)("roledefinitions")],ji)),fi=Object(j.i)(bi),Oi=(Gr=j.f,Object(g.c)(yi,Gr),yi.prototype.update=function(c){return Object(g.a)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=["BasePermissions"],void 0!==Object(T.hOP)(c,t[0])&&(c[t[0]]=Object(T.assign)(Object(ne.a)("SP."+t[0]),c[t[0]])),n=Object(S.n)(Object(T.assign)(Object(ne.a)("SP.RoleDefinition"),c),Object(S.x)({"X-HTTP-Method":"MERGE"})),[4,Object(m.d)(this,n)];case 1:return r=e.sent(),i=this,Object(T.hOP)(c,"Name")&&(o=this.getParent(fi,this.parentUrl,""),i=o.getByName(c.Name)),[2,{data:r,definition:i}]}})})},yi),gi=Object(j.i)(Oi);function yi(){var e=null!==Gr&&Gr.apply(this,arguments)||this;return e.delete=Object(j.g)("rd"),e}function ji(){return null!==qr&&qr.apply(this,arguments)||this}function mi(){var e=null!==Wr&&Wr.apply(this,arguments)||this;return e.delete=Object(j.g)("ra"),e}function vi(){return null!==Hr&&Hr.apply(this,arguments)||this}function Si(){var r=null!==Vr&&Vr.apply(this,arguments)||this;return r.update=r._update("SP.Group",function(e,t){var n=r;return Object(T.hOP)(t,"Title")&&(n=r.getParent(ui,r.parentUrl,"getByName('"+t.Title+"')")),{data:e,group:n}}),r}function Ti(){return null!==Kr&&Kr.apply(this,arguments)||this}function Pi(){var t=null!==Qr&&Qr.apply(this,arguments)||this;return t.delete=Object(j.g)("su"),t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t}function Ii(){return null!==zr&&zr.apply(this,arguments)||this}function wi(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return(t=this.clone(j.c,"getUserEffectivePermissions(@user)")).query.set("@user","'"+encodeURIComponent(r)+"'"),[4,t.get()];case 1:return n=e.sent(),[2,Object(T.hOP)(n,"GetUserEffectivePermissions")?n.GetUserEffectivePermissions:n]}})})}function _i(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){return[2,this.clone(j.a,"EffectiveBasePermissions").get().then(function(e){return Object(T.hOP)(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e})]})})}function Ci(t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(j.a,"breakroleinheritance(copyroleassignments="+t+", clearsubscopes="+n+")"))];case 1:return e.sent(),[2]}})})}function Ri(){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(j.a,"resetroleinheritance"))];case 1:return e.sent(),[2]}})})}function Ei(n,r){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,wi.call(this,n)];case 1:return t=e.sent(),[2,this.hasPermissions(t,r)]}})})}function Ni(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,_i.call(this)];case 1:return t=e.sent(),[2,this.hasPermissions(t,n)]}})})}function Ai(e,t){if(!t)return!0;if(t===xr.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return 0<=--t&&t<32?(n<<=t,0!=(e.Low&n)):32<=t&&t<64&&(n<<=t-32,0!=(e.High&n))}(ti=xr=xr||{})[ti.EmptyMask=0]="EmptyMask",ti[ti.ViewListItems=1]="ViewListItems",ti[ti.AddListItems=2]="AddListItems",ti[ti.EditListItems=3]="EditListItems",ti[ti.DeleteListItems=4]="DeleteListItems",ti[ti.ApproveItems=5]="ApproveItems",ti[ti.OpenItems=6]="OpenItems",ti[ti.ViewVersions=7]="ViewVersions",ti[ti.DeleteVersions=8]="DeleteVersions",ti[ti.CancelCheckout=9]="CancelCheckout",ti[ti.ManagePersonalViews=10]="ManagePersonalViews",ti[ti.ManageLists=12]="ManageLists",ti[ti.ViewFormPages=13]="ViewFormPages",ti[ti.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",ti[ti.Open=17]="Open",ti[ti.ViewPages=18]="ViewPages",ti[ti.AddAndCustomizePages=19]="AddAndCustomizePages",ti[ti.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",ti[ti.ApplyStyleSheets=21]="ApplyStyleSheets",ti[ti.ViewUsageData=22]="ViewUsageData",ti[ti.CreateSSCSite=23]="CreateSSCSite",ti[ti.ManageSubwebs=24]="ManageSubwebs",ti[ti.CreateGroups=25]="CreateGroups",ti[ti.ManagePermissions=26]="ManagePermissions",ti[ti.BrowseDirectories=27]="BrowseDirectories",ti[ti.BrowseUserInfo=28]="BrowseUserInfo",ti[ti.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",ti[ti.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",ti[ti.ManageWeb=31]="ManageWeb",ti[ti.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",ti[ti.UseClientIntegration=37]="UseClientIntegration",ti[ti.UseRemoteAPIs=38]="UseRemoteAPIs",ti[ti.ManageAlerts=39]="ManageAlerts",ti[ti.CreateAlerts=40]="CreateAlerts",ti[ti.EditMyUserInfo=41]="EditMyUserInfo",ti[ti.EnumeratePermissions=63]="EnumeratePermissions",ti[ti.FullMask=65]="FullMask",Object(S.m)(f.f,"roleAssignments",di),Object(S.m)(f.f,"firstUniqueAncestorSecurableObject",j.c),f.f.prototype.getUserEffectivePermissions=wi,f.f.prototype.getCurrentUserEffectivePermissions=_i,f.f.prototype.breakRoleInheritance=Ci,f.f.prototype.resetRoleInheritance=Ri,f.f.prototype.userHasPermissions=Ei,f.f.prototype.currentUserHasPermissions=Ni,f.f.prototype.hasPermissions=Ai,Object(S.m)(re.e,"roleAssignments",di),Object(S.m)(re.e,"firstUniqueAncestorSecurableObject",j.c),re.e.prototype.getUserEffectivePermissions=wi,re.e.prototype.getCurrentUserEffectivePermissions=_i,re.e.prototype.breakRoleInheritance=Ci,re.e.prototype.resetRoleInheritance=Ri,re.e.prototype.userHasPermissions=Ei,re.e.prototype.currentUserHasPermissions=Ni,re.e.prototype.hasPermissions=Ai,Object(S.m)(y.c,"roleDefinitions",fi),Object(S.m)(y.c,"roleAssignments",di),Object(S.m)(y.c,"firstUniqueAncestorSecurableObject",j.c),y.c.prototype.getUserEffectivePermissions=wi,y.c.prototype.getCurrentUserEffectivePermissions=_i,y.c.prototype.breakRoleInheritance=Ci,y.c.prototype.resetRoleInheritance=Ri,y.c.prototype.userHasPermissions=Ei,y.c.prototype.currentUserHasPermissions=Ni,y.c.prototype.hasPermissions=Ai,(ei=Dr=Dr||{})[ei.None=0]="None",ei[ei.View=1]="View",ei[ei.Edit=2]="Edit",ei[ei.Owner=3]="Owner",(Zr=kr=kr||{})[Zr.Unknown=0]="Unknown",Zr[Zr.File=1]="File",Zr[Zr.Folder=2]="Folder",Zr[Zr.Item=3]="Item",Zr[Zr.List=4]="List",Zr[Zr.Web=5]="Web",Zr[Zr.Max=6]="Max",(Yr=Lr=Lr||{})[Yr.None=0]="None",Yr[Yr.AllowList=1]="AllowList",Yr[Yr.BlockList=2]="BlockList",($r=Fr=Fr||{})[$r.CompletedSuccessfully=0]="CompletedSuccessfully",$r[$r.AccessRequestsQueued=1]="AccessRequestsQueued",$r[$r.NoResolvedUsers=-1]="NoResolvedUsers",$r[$r.AccessDenied=-2]="AccessDenied",$r[$r.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",$r[$r.UnknowError=-4]="UnknowError",$r[$r.EmailBodyTooLong=-5]="EmailBodyTooLong",$r[$r.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",$r[$r.CapabilityDisabled=-7]="CapabilityDisabled",$r[$r.ObjectNotSupported=-8]="ObjectNotSupported",$r[$r.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported",(Jr=Br=Br||{})[Jr.Uninitialized=0]="Uninitialized",Jr[Jr.Direct=1]="Direct",Jr[Jr.OrganizationView=2]="OrganizationView",Jr[Jr.OrganizationEdit=3]="OrganizationEdit",Jr[Jr.AnonymousView=4]="AnonymousView",Jr[Jr.AnonymousEdit=5]="AnonymousEdit",Jr[Jr.Flexible=6]="Flexible",(Xr=Mr=Mr||{})[Xr.None=0]="None",Xr[Xr.Guest=1]="Guest",Xr[Xr.Reader=2]="Reader",Xr[Xr.Contributor=3]="Contributor",Xr[Xr.WebDesigner=4]="WebDesigner",Xr[Xr.Administrator=5]="Administrator";var Ui=n(20);function xi(i,o,c){return void 0===c&&(c=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r;return Object(g.d)(this,function(e){switch(e.label){case 0:return c?[2,Wi(i,o)]:[4,function(r,i){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:if(null==i)return[3,7];switch(i){case Mr.Contributor:return[3,1];case Mr.Reader:case Mr.Guest:return[3,3]}return[3,5];case 1:return[4,Object(y.a)("_api/web","associatedmembergroup").select("Id")()];case 2:return[2,"group: "+e.sent().Id];case 3:return[4,Object(y.a)("_api/web","associatedvisitorgroup").select("Id")()];case 4:return[2,"group: "+e.sent().Id];case 5:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported");case 6:return[3,9];case 7:return t=r===Dr.Edit?Mr.Contributor:Mr.Reader,[4,fi("_api/web").select("Id").top(1).filter("RoleTypeKind eq "+t)()];case 8:if((n=e.sent()).length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return[2,"role: "+n[0].Id];case 9:return[2]}})})}((o=Object(T.assign)(o,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0)).role,o.group)];case 1:return t=e.sent(),Array.isArray(o.loginNames)||(o.loginNames=[o.loginNames]),n=Object(T.jsS)(o.loginNames.map(function(e){return{Key:e}})),r={peoplePickerInput:n,roleValue:t,url:o.url},void 0!==o.emailData&&null!==o.emailData&&(r=Object(T.assign)(r,{emailBody:o.emailData.body,emailSubject:void 0!==o.emailData.subject?o.emailData.subject:"Shared with you.",sendEmail:!0})),[2,Wi(i,r)]}})})}function Di(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null,r=I.a.configure(this.clone(j.c,"shareLink"),"sh.getShareLink");return Object(m.d)(r,Object(S.n)({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}}))}function ki(e){var t=I.a.configure(this.clone(j.c,"checkPermissions"),"sh.checkPermissions");return Object(m.d)(t,Object(S.n)({recipients:e}))}function Li(e,t){void 0===e&&(e=null),void 0===t&&(t=[]);var n=I.a.configure(this.clone(j.c,"getSharingInformation"),"sh.getSharingInformation");return Object(m.d)(n.expand.apply(n,Object(g.e)(t)),Object(S.n)({request:e}))}function Fi(e){void 0===e&&(e=!0);var t=I.a.configure(this.clone(j.c,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return Object(m.d)(t,Object(S.n)({useSimplifiedRoles:e}))}function Bi(){return Object(m.d)(I.a.configure(this.clone(j.c,"unshareObject"),"sh.unshareObject"))}function Mi(e){return Object(m.d)(I.a.configure(this.clone(j.c,"deleteLinkByKind"),"sh.deleteLinkByKind"),Object(S.n)({linkKind:e}))}function Gi(e,t){return void 0===t&&(t=Ui.b),Object(m.d)(I.a.configure(this.clone(j.c,"unshareLink"),"sh.unshareLink"),Object(S.n)({linkKind:e,shareId:t}))}function qi(o,c,s,a,u,l){return void 0===a&&(a=!1),void 0===u&&(u=!1),Object(g.a)(this,void 0,void 0,function(){var t,n,r,i;return Object(g.d)(this,function(e){switch(e.label){case 0:return Array.isArray(c)||(c=[c]),t=Object(T.jsS)(c.map(function(e){return{Key:e}})),n=s===Dr.Edit?Mr.Contributor:Mr.Reader,[4,Object(j.b)("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+n).get()];case 1:if(r=e.sent(),!Array.isArray(r)||r.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+n);return i={includeAnonymousLinkInEmail:a,peoplePickerInput:t,propagateAcl:u,roleValue:"role:"+r[0].Id,useSimplifiedRoles:!0},void 0!==l&&(i=Object(T.assign)(i,{emailBody:l.body,emailSubject:void 0!==l.subject?l.subject:"",sendEmail:!0})),[2,Object(m.d)(I.a.configure(o.clone(j.c,"shareObject"),"sh.shareWith"),Object(S.n)(i))]}})})}function Wi(e,t){var n=I.a.configure(Object(y.a)(Object(v.a)(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return Object(m.d)(n.expand("UsersWithAccessRequests","GroupsSharedWith"),Object(S.n)(t))}R.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=Dr.View),void 0===n&&(n=!1),qi(this,e,t,n,!1,r)},R.prototype.getShareLink=Di,R.prototype.checkSharingPermissions=ki,R.prototype.getSharingInformation=Li,R.prototype.getObjectSharingSettings=Fi,R.prototype.unshare=Bi,R.prototype.deleteSharingLinkByKind=Mi,R.prototype.unshareLink=Gi,He.prototype.shareWith=function(r,i,o,c,s){return void 0===i&&(i=Dr.View),void 0===o&&(o=!1),void 0===c&&(c=!1),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.shareWith(r,i,o,c,s)]}})})},He.prototype.getShareLink=function(r,i){return void 0===i&&(i=null),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getShareLink(r,i)]}})})},He.prototype.checkSharingPermissions=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.checkSharingPermissions(r)]}})})},He.prototype.getSharingInformation=function(r,i){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getSharingInformation(r,i)]}})})},He.prototype.getObjectSharingSettings=function(r){return void 0===r&&(r=!0),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.getObjectSharingSettings(r)]}})})},He.prototype.unshare=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.unshare()]}})})},He.prototype.deleteSharingLinkByKind=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.deleteSharingLinkByKind(r)]}})})},He.prototype.unshareLink=function(r,i){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,this.getShareable()];case 1:return n=e.sent(),t(),[2,n.unshareLink(r,i)]}})})},f.f.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=Dr.View),void 0===n&&(n=!1),qi(this,e,t,n,!1,r)},f.f.prototype.getShareLink=Di,f.f.prototype.checkSharingPermissions=ki,f.f.prototype.getSharingInformation=Li,f.f.prototype.getObjectSharingSettings=Fi,f.f.prototype.unshare=Bi,f.f.prototype.deleteSharingLinkByKind=Mi,f.f.prototype.unshareLink=Gi,y.c.prototype.shareWith=function(r,i,o){return void 0===i&&(i=Dr.View),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.addBatchDependency(),[4,new j.f(Object(v.a)(this.toUrl()),"/_api/web/url").get()];case 1:return n=e.sent(),t(),[2,this.shareObject(Object(T.combine)(n,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),r,i,o)]}})})},y.c.prototype.shareObject=function(e,t,n,r,i,o,c,s){return void 0===o&&(o=!1),void 0===c&&(c=!1),void 0===s&&(s=!0),xi(this,{emailData:r,group:i,includeAnonymousLinkInEmail:c,loginNames:t,propagateAcl:o,role:n,url:e,useSimplifiedRoles:s})},y.c.prototype.shareObjectRaw=function(e){return xi(this,e,!0)},y.c.prototype.unshareObject=function(e){return Object(m.d)(Object(y.a)(this,"unshareObject"),Object(S.n)({url:e}))};var Hi,Vi=(Hi=j.d,Object(g.c)(zi,Hi),zi.prototype.execute=function(e){return Object(m.d)(this,Object(S.n)(e,Object(S.x)({"Content-Type":"application/json;charset=utf-8"})))},zi.prototype.createSiteDesign=function(e){return this.clone(Qi,"CreateSiteDesign").execute({info:e})},zi.prototype.applySiteDesign=function(e,t){return this.clone(Qi,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})},zi.prototype.getSiteDesigns=function(){return this.clone(Qi,"GetSiteDesigns").execute({})},zi.prototype.getSiteDesignMetadata=function(e){return this.clone(Qi,"GetSiteDesignMetadata").execute({id:e})},zi.prototype.updateSiteDesign=function(e){return this.clone(Qi,"UpdateSiteDesign").execute({updateInfo:e})},zi.prototype.deleteSiteDesign=function(e){return this.clone(Qi,"DeleteSiteDesign").execute({id:e})},zi.prototype.getSiteDesignRights=function(e){return this.clone(Qi,"GetSiteDesignRights").execute({id:e})},zi.prototype.grantSiteDesignRights=function(e,t,n){return void 0===n&&(n=1),this.clone(Qi,"GrantSiteDesignRights").execute({grantedRights:n.toString(),id:e,principalNames:t})},zi.prototype.revokeSiteDesignRights=function(e,t){return this.clone(Qi,"RevokeSiteDesignRights").execute({id:e,principalNames:t})},zi.prototype.addSiteDesignTask=function(e,t){return this.clone(Qi,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})},zi.prototype.addSiteDesignTaskToCurrentWeb=function(e){return this.clone(Qi,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})},zi.prototype.getSiteDesignTask=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(Qi,"GetSiteDesignTask").execute({taskId:n})];case 1:return t=e.sent(),[2,Object(T.hOP)(t,"ID")?t:null]}})})},zi.prototype.getSiteDesignRun=function(e,t){return this.clone(Qi,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})},zi.prototype.getSiteDesignRunStatus=function(e,t){return this.clone(Qi,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})},Object(g.b)([Object(I.a)("sd.createSiteDesign")],zi.prototype,"createSiteDesign",null),Object(g.b)([Object(I.a)("sd.applySiteDesign")],zi.prototype,"applySiteDesign",null),Object(g.b)([Object(I.a)("sd.getSiteDesigns")],zi.prototype,"getSiteDesigns",null),Object(g.b)([Object(I.a)("sd.getSiteDesignMetadata")],zi.prototype,"getSiteDesignMetadata",null),Object(g.b)([Object(I.a)("sd.updateSiteDesign")],zi.prototype,"updateSiteDesign",null),Object(g.b)([Object(I.a)("sd.deleteSiteDesign")],zi.prototype,"deleteSiteDesign",null),Object(g.b)([Object(I.a)("sd.getSiteDesignRights")],zi.prototype,"getSiteDesignRights",null),Object(g.b)([Object(I.a)("sd.grantSiteDesignRights")],zi.prototype,"grantSiteDesignRights",null),Object(g.b)([Object(I.a)("sd.revokeSiteDesignRights")],zi.prototype,"revokeSiteDesignRights",null),Object(g.b)([Object(I.a)("sd.addSiteDesignTask")],zi.prototype,"addSiteDesignTask",null),Object(g.b)([Object(I.a)("sd.addSiteDesignTaskToCurrentWeb")],zi.prototype,"addSiteDesignTaskToCurrentWeb",null),Object(g.b)([Object(I.a)("sd.getSiteDesignTask")],zi.prototype,"getSiteDesignTask",null),Object(g.b)([Object(I.a)("sd.getSiteDesignRun")],zi.prototype,"getSiteDesignRun",null),Object(g.b)([Object(I.a)("sd.getSiteDesignRunStatus")],zi.prototype,"getSiteDesignRunStatus",null),zi),Ki=function(e,t){return new Vi(e,t)},Qi=function(e,t){return void 0===t&&(t=""),Ki(e,t)};function zi(e,t){void 0===t&&(t="");var n="string"==typeof e?e:e.toUrl();return Hi.call(this,Object(v.a)(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}y.c.prototype.getSiteDesignRuns=function(e){return Ki(this,"").getSiteDesignRun(void 0,e)},y.c.prototype.addSiteDesignTask=function(e){return Ki(this,"").addSiteDesignTaskToCurrentWeb(e)},y.c.prototype.getSiteDesignRunStatus=function(e){return Ki(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty(h.a.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return Ki(this._baseUrl)}}),Object(S.m)(y.c,"siteGroups",si),Object(S.m)(y.c,"associatedOwnerGroup",si,"associatedownergroup"),Object(S.m)(y.c,"associatedMemberGroup",si,"associatedmembergroup"),Object(S.m)(y.c,"associatedVisitorGroup",si,"associatedvisitorgroup"),y.c.prototype.createDefaultAssociatedGroups=function(n,r,i,o,c){return void 0===i&&(i=!1),void 0===o&&(o=!0),Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.breakRoleInheritance(i,o)];case 1:return e.sent(),(t=this.clone(y.a,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)")).query.set("@u","'"+Object(P.a)(r||"")+"'"),t.query.set("@v","'"+Object(P.a)(c||"")+"'"),t.query.set("@s","'"+Object(P.a)(n||"")+"'"),[2,Object(m.d)(t)]}})})};var Xi,Ji,$i,Yi=(Ji=j.d,Object(g.c)(to,Ji),to.prototype.execute=function(e){return Object(m.d)(this,Object(S.n)(e))},to.prototype.getSiteScripts=function(){return this.clone(eo,"GetSiteScripts",!0).execute({})},to.prototype.createSiteScript=function(e,t,n){return this.clone(eo,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+Object(P.a)(e)+"'&@desc='"+Object(P.a)(t)+"'").execute(n)},to.prototype.getSiteScriptMetadata=function(e){return this.clone(eo,"GetSiteScriptMetadata").execute({id:e})},to.prototype.deleteSiteScript=function(e){return this.clone(eo,"DeleteSiteScript").execute({id:e})},to.prototype.updateSiteScript=function(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(eo,"UpdateSiteScript").execute({updateInfo:e})},to.prototype.getSiteScriptFromList=function(e){return this.clone(eo,"GetSiteScriptFromList").execute({listUrl:e})},to.prototype.getSiteScriptFromWeb=function(e,t){return this.clone(eo,"getSiteScriptFromWeb").execute({webUrl:e,info:t})},to.prototype.executeSiteScriptAction=function(e){return this.clone(eo,"executeSiteScriptAction").execute({actionDefinition:e})},Object(g.b)([Object(I.a)("ss.getSiteScripts")],to.prototype,"getSiteScripts",null),Object(g.b)([Object(I.a)("ss.createSiteScript")],to.prototype,"createSiteScript",null),Object(g.b)([Object(I.a)("ss.getSiteScriptMetadata")],to.prototype,"getSiteScriptMetadata",null),Object(g.b)([Object(I.a)("ss.deleteSiteScript")],to.prototype,"deleteSiteScript",null),Object(g.b)([Object(I.a)("ss.updateSiteScript")],to.prototype,"updateSiteScript",null),Object(g.b)([Object(I.a)("ss.getSiteScriptFromList")],to.prototype,"getSiteScriptFromList",null),Object(g.b)([Object(I.a)("ss.getSiteScriptFromWeb")],to.prototype,"getSiteScriptFromWeb",null),Object(g.b)([Object(I.a)("ss.executeSiteScriptAction")],to.prototype,"executeSiteScriptAction",null),to),Zi=function(e,t){return new Yi(e,t)},eo=function(e,t){return void 0===t&&(t=""),Zi(e,t)};function to(e,t){void 0===t&&(t="");var n="string"==typeof e?e:e.toUrl();return Ji.call(this,Object(v.a)(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+t)||this}($i=Xi=Xi||{})[$i.Success=0]="Success",$i[$i.Failure=1]="Failure",$i[$i.NoOp=2]="NoOp",$i[$i.SucceededWithException=3]="SucceededWithException",y.c.prototype.getSiteScript=function(e){return Zi(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)},re.e.prototype.getSiteScript=function(){return Object(g.a)(this,void 0,void 0,function(){var t,n,r;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(re.b).rootFolder.get()];case 1:return t=e.sent(),[4,Object(y.a)(Object(v.a)(this.toUrl())).select("Url").get()];case 2:return n=e.sent(),r=Object(T.combine)(n.Url,"Lists",t.Name),[2,Zi(this,"").getSiteScriptFromList(r)]}})})},Reflect.defineProperty(h.a.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return Zi(this._baseUrl)}}),Object(S.m)(y.c,"siteUsers",ri),Object(S.m)(y.c,"currentUser",oi,"currentuser"),y.c.prototype.ensureUser=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(y.a,"ensureuser"),Object(S.n)({logonName:n}))];case 1:return[2,{data:t=e.sent(),user:oi(Object(b.a)(t))}]}})})},y.c.prototype.getUserById=function(e){return oi(this,"getUserById("+e+")")};var no,ro,io,oo,co,so,ao,uo,lo,po,ho=n(24),bo=(so=j.f,Object(g.c)(vo,so),Object.defineProperty(vo.prototype,"my",{get:function(){return yo(this)},enumerable:!1,configurable:!0}),vo.prototype.getFollowedSitesUri=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(Oo,"FollowedSitesUri").get()];case 1:return[2,(t=e.sent()).FollowedSitesUri||t]}})})},vo.prototype.getFollowedDocumentsUri=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(Oo,"FollowedDocumentsUri").get()];case 1:return[2,(t=e.sent()).FollowedDocumentsUri||t]}})})},vo.prototype.follow=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(Oo,"follow"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},vo.prototype.isFollowed=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(Oo,"isfollowed"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},vo.prototype.stopFollowing=function(t){return Object(g.a)(this,void 0,void 0,function(){return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,Object(m.d)(this.clone(Oo,"stopfollowing"),this.createSocialActorInfoRequestBody(t))];case 1:return[2,e.sent()]}})})},vo.prototype.createSocialActorInfoRequestBody=function(e){return Object(S.n)({actor:Object.assign(Object(ne.a)("SP.Social.SocialActorInfo"),{Id:null},e)})},Object(g.b)([Object(I.a)("soc.getFollowedSitesUri")],vo.prototype,"getFollowedSitesUri",null),Object(g.b)([Object(I.a)("soc.getFollowedDocumentsUri")],vo.prototype,"getFollowedDocumentsUri",null),Object(g.b)([Object(I.a)("soc.follow")],vo.prototype,"follow",null),Object(g.b)([Object(I.a)("soc.isFollowed")],vo.prototype,"isFollowed",null),Object(g.b)([Object(I.a)("soc.stopFollowing")],vo.prototype,"stopFollowing",null),Object(g.b)([Object(O.a)("_api/social.following")],vo)),fo=function(e){return new bo(e)},Oo=function(e,t){return new bo(e,t)},go=(co=j.f,Object(g.c)(mo,co),mo.prototype.followed=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(jo,"followed(types="+n+")")()];case 1:return t=e.sent(),[2,Object(T.hOP)(t,"Followed")?t.Followed.results:t]}})})},mo.prototype.followedCount=function(n){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(jo,"followedcount(types="+n+")")()];case 1:return[2,(t=e.sent()).FollowedCount||t]}})})},mo.prototype.followers=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(jo,"followers")()];case 1:return t=e.sent(),[2,Object(T.hOP)(t,"Followers")?t.Followers.results:t]}})})},mo.prototype.suggestions=function(){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return[4,this.clone(jo,"suggestions")()];case 1:return t=e.sent(),[2,Object(T.hOP)(t,"Suggestions")?t.Suggestions.results:t]}})})},Object(g.b)([Object(I.a)("msoc.followed")],mo.prototype,"followed",null),Object(g.b)([Object(I.a)("msoc.followedCount")],mo.prototype,"followedCount",null),Object(g.b)([Object(I.a)("msoc.followers")],mo.prototype,"followers",null),Object(g.b)([Object(I.a)("msoc.suggestions")],mo.prototype,"suggestions",null),Object(g.b)([Object(O.a)("my")],mo)),yo=Object(j.i)(go),jo=function(e,t){return yo(e,t)};function mo(){return null!==co&&co.apply(this,arguments)||this}function vo(){return null!==so&&so.apply(this,arguments)||this}(po=no=no||{})[po.User=0]="User",po[po.Document=1]="Document",po[po.Site=2]="Site",po[po.Tag=3]="Tag",(lo=ro=ro||{})[lo.None=0]="None",lo[lo.User=1]="User",lo[lo.Document=2]="Document",lo[lo.Site=4]="Site",lo[lo.Tag=8]="Tag",lo[lo.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",lo[lo.IncludeGroupsSites=536870912]="IncludeGroupsSites",lo[lo.WithinLast24Hours=1073741824]="WithinLast24Hours",(uo=io=io||{})[uo.Ok=0]="Ok",uo[uo.AlreadyFollowing=1]="AlreadyFollowing",uo[uo.LimitReached=2]="LimitReached",uo[uo.InternalError=3]="InternalError",(ao=oo=oo||{})[ao.OK=0]="OK",ao[ao.InvalidRequest=1]="InvalidRequest",ao[ao.AccessDenied=2]="AccessDenied",ao[ao.ItemNotFound=3]="ItemNotFound",ao[ao.InvalidOperation=4]="InvalidOperation",ao[ao.ItemNotModified=5]="ItemNotModified",ao[ao.InternalError=6]="InternalError",ao[ao.CacheReadError=7]="CacheReadError",ao[ao.CacheUpdateError=8]="CacheUpdateError",ao[ao.PersonalSiteNotFound=9]="PersonalSiteNotFound",ao[ao.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",ao[ao.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",ao[ao.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",ao[ao.LimitReached=13]="LimitReached",ao[ao.AttachmentError=14]="AttachmentError",ao[ao.PartialData=15]="PartialData",ao[ao.FeatureDisabled=16]="FeatureDisabled",ao[ao.StorageQuotaExceeded=17]="StorageQuotaExceeded",ao[ao.DatabaseError=18]="DatabaseError",Reflect.defineProperty(h.a.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return fo(this._baseUrl)}});var So,To=n(33),Po=(So=j.d,Object(g.c)(_o,So),_o.prototype.excute=function(e){return Object(m.d)(this,Object(S.n)(e))},_o.prototype.sendEmail=function(e){var t={properties:Object(T.assign)(Object(ne.a)("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&0<e.To.length&&(t.properties=Object(T.assign)(t.properties,{To:{results:e.To}})),e.CC&&0<e.CC.length&&(t.properties=Object(T.assign)(t.properties,{CC:{results:e.CC}})),e.BCC&&0<e.BCC.length&&(t.properties=Object(T.assign)(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=Object(T.assign)(t.properties,{AdditionalHeaders:Object(To.a)(e.AdditionalHeaders)})),I.a.configure(this.clone(wo,"SendEmail",!0),"u.sendEmail").excute(t)},_o.prototype.getCurrentUserEmailAddresses=function(){return I.a.configure(this.clone(wo,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})},_o.prototype.resolvePrincipal=function(e,t,n,r,i,o){void 0===o&&(o=!1);var c={addToUserInfoList:i,input:e,inputIsEmailOnly:r,matchUserInfoList:o,scopes:t,sources:n},s=this.clone(wo,"ResolvePrincipalInCurrentContext",!0);return I.a.configure(s,"u.ResolvePrincipalInCurrentContext").excute(c)},_o.prototype.searchPrincipals=function(e,t,n,r,i){var o={groupName:r,input:e,maxCount:i,scopes:t,sources:n},c=this.clone(wo,"SearchPrincipalsUsingContextWeb",!0);return I.a.configure(c,"u.SearchPrincipalsUsingContextWeb").excute(o)},_o.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e},n=this.clone(wo,"CreateEmailBodyForInvitation",!0);return I.a.configure(n,"u.CreateEmailBodyForInvitation").excute(t)},_o.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t},r=this.clone(wo,"ExpandGroupsToPrincipals",!0);return I.a.configure(r,"u.ExpandGroupsToPrincipals").excute(n)},_o.prototype.createWikiPage=function(r){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=this.clone(wo,"CreateWikiPageInContextWeb",!0),[4,I.a.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:r})];case 1:return[2,{data:n=e.sent(),file:E(Object(b.a)(n))}]}})})},_o),Io=Object(j.i)(Po),wo=function(e,t){return Io(e,t)};function _o(e,t){var n="string"==typeof e?e:e.toUrl();return So.call(this,Object(v.a)(n),"_api/SP.Utilities.Utility."+t)||this}Reflect.defineProperty(h.a.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return Io(this._baseUrl,"")}});var Co,Ro,Eo=(Ro=j.e,Object(g.c)(Do,Ro),Do.prototype.getById=function(e){return I.a.configure(Uo(this).concat("('"+e+"')"),"subs.getById")},Do.prototype.add=function(r,i,o){return Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t={expirationDateTime:i,notificationUrl:r,resource:this.toUrl()},o&&(t.clientState=o),[4,Object(m.d)(this,Object(S.n)(t,Object(S.x)({"Content-Type":"application/json"})))];case 1:return[2,{data:n=e.sent(),subscription:this.getById(n.id)}]}})})},Object(g.b)([Object(I.a)("subs.add")],Do.prototype,"add",null),Object(g.b)([Object(O.a)("subscriptions")],Do)),No=Object(j.i)(Eo),Ao=(Co=j.f,Object(g.c)(xo,Co),xo.prototype.update=function(n,r,i){return Object(g.a)(this,void 0,void 0,function(){var t;return Object(g.d)(this,function(e){switch(e.label){case 0:return t={},n&&(t.expirationDateTime=n),r&&(t.notificationUrl=r),i&&(t.clientState=i),[4,Object(m.c)(this,Object(S.n)(t,Object(S.x)({"Content-Type":"application/json"})))];case 1:return[2,{data:e.sent(),subscription:this}]}})})},xo.prototype.delete=function(){return Object(m.a)(this)},Object(g.b)([Object(I.a)("sub.update")],xo.prototype,"update",null),Object(g.b)([Object(I.a)("sub.delete")],xo.prototype,"delete",null),xo),Uo=Object(j.i)(Ao);function xo(){return null!==Co&&Co.apply(this,arguments)||this}function Do(){return null!==Ro&&Ro.apply(this,arguments)||this}Object(S.m)(re.e,"subscriptions",No);var ko,Lo,Fo,Bo,Mo,Go,qo,Wo,Ho,Vo=(Ho=j.f,Object(g.c)(gc,Ho),Object.defineProperty(gc.prototype,"termGroups",{get:function(){return zo(this)},enumerable:!1,configurable:!0}),Object.defineProperty(gc.prototype,"groups",{get:function(){return zo(this,"groups")},enumerable:!1,configurable:!0}),Object(g.b)([Object(O.a)("_api/v2.1/termstore")],gc)),Ko=Object(j.i)(Vo),Qo=(Wo=j.e,Object(g.c)(Oc,Wo),Oc.prototype.getById=function(e){return Jo(this,e)},Object(g.b)([Object(O.a)("termgroups")],Oc)),zo=Object(j.i)(Qo),Xo=(qo=j.f,Object(g.c)(fc,qo),Object.defineProperty(fc.prototype,"termSets",{get:function(){return Yo(this)},enumerable:!1,configurable:!0}),Object.defineProperty(fc.prototype,"sets",{get:function(){return Yo(this,"sets")},enumerable:!1,configurable:!0}),fc),Jo=Object(j.i)(Xo),$o=(Go=j.e,Object(g.c)(bc,Go),bc.prototype.getById=function(e){return ec(this,e)},Object(g.b)([Object(O.a)("termsets")],bc)),Yo=Object(j.i)($o),Zo=(Mo=j.f,Object(g.c)(hc,Mo),Object.defineProperty(hc.prototype,"terms",{get:function(){return nc(this)},enumerable:!1,configurable:!0}),Object.defineProperty(hc.prototype,"parentGroup",{get:function(){return Jo(this,"parentGroup")},enumerable:!1,configurable:!0}),Object.defineProperty(hc.prototype,"children",{get:function(){return nc(this,"children")},enumerable:!1,configurable:!0}),Object.defineProperty(hc.prototype,"relations",{get:function(){return cc(this)},enumerable:!1,configurable:!0}),hc),ec=Object(j.i)(Zo),tc=(Bo=j.e,Object(g.c)(pc,Bo),pc.prototype.getById=function(e){return ic(this,e)},Object(g.b)([Object(O.a)("terms")],pc)),nc=Object(j.i)(tc),rc=(Fo=j.f,Object(g.c)(dc,Fo),Object.defineProperty(dc.prototype,"parent",{get:function(){return ic(this,"parent")},enumerable:!1,configurable:!0}),Object.defineProperty(dc.prototype,"children",{get:function(){return nc(this,"children")},enumerable:!1,configurable:!0}),Object.defineProperty(dc.prototype,"relations",{get:function(){return cc(this)},enumerable:!1,configurable:!0}),Object.defineProperty(dc.prototype,"set",{get:function(){return ec(this,"set")},enumerable:!1,configurable:!0}),dc),ic=Object(j.i)(rc),oc=(Lo=j.e,Object(g.c)(lc,Lo),lc.prototype.getById=function(e){return ac(this,e)},Object(g.b)([Object(O.a)("relations")],lc)),cc=Object(j.i)(oc),sc=(ko=j.f,Object(g.c)(uc,ko),Object.defineProperty(uc.prototype,"fromTerm",{get:function(){return ic(this,"fromTerm")},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"toTerm",{get:function(){return ic(this,"toTerm")},enumerable:!1,configurable:!0}),Object.defineProperty(uc.prototype,"set",{get:function(){return ec(this,"set")},enumerable:!1,configurable:!0}),uc),ac=Object(j.i)(sc);function uc(){return null!==ko&&ko.apply(this,arguments)||this}function lc(){return null!==Lo&&Lo.apply(this,arguments)||this}function dc(){return null!==Fo&&Fo.apply(this,arguments)||this}function pc(){return null!==Bo&&Bo.apply(this,arguments)||this}function hc(){return null!==Mo&&Mo.apply(this,arguments)||this}function bc(){return null!==Go&&Go.apply(this,arguments)||this}function fc(){return null!==qo&&qo.apply(this,arguments)||this}function Oc(){return null!==Wo&&Wo.apply(this,arguments)||this}function gc(){return null!==Ho&&Ho.apply(this,arguments)||this}Reflect.defineProperty(h.a.prototype,"termStore",{configurable:!0,enumerable:!0,get:function(){return Ko(this._baseUrl).configure(this._options)}}),Object(S.m)(re.e,"userCustomActions",nr),Object(S.m)(y.c,"userCustomActions",nr),Object(S.m)(ie.b,"userCustomActions",nr);var yc,jc,mc,vc,Sc,Tc=(vc=j.e,Object(g.c)(Nc,vc),Nc.prototype.getById=function(e){return wc(this).concat("('"+e+"')")},Nc.prototype.getByTitle=function(e){return wc(this,"getByTitle('"+e+"')")},Nc.prototype.add=function(r,i,o){return void 0===i&&(i=!1),void 0===o&&(o={}),Object(g.a)(this,void 0,void 0,function(){var t,n;return Object(g.d)(this,function(e){switch(e.label){case 0:return t=Object(S.n)(Object.assign(Object(ne.a)("SP.View"),{PersonalView:i,Title:r},o)),[4,Object(m.d)(this.clone(Pc,null),t)];case 1:return[2,{data:n=e.sent(),view:this.getById(n.Id)}]}})})},Object(g.b)([Object(I.a)("vs.add")],Nc.prototype,"add",null),Object(g.b)([Object(O.a)("views")],Nc)),Pc=Object(j.i)(Tc),Ic=(mc=j.f,Object(g.c)(Ec,mc),Object.defineProperty(Ec.prototype,"fields",{get:function(){return Cc(this)},enumerable:!1,configurable:!0}),Ec.prototype.renderAsHtml=function(){return this.clone(wc,"renderashtml")()},Ec.prototype.setViewXml=function(e){return Object(m.d)(this.clone(wc,"SetViewXml"),Object(S.n)({viewXml:e}))},Object(g.b)([Object(I.a)("v.renderAsHtml")],Ec.prototype,"renderAsHtml",null),Object(g.b)([Object(I.a)("v.setViewXml")],Ec.prototype,"setViewXml",null),Ec),wc=Object(j.i)(Ic),_c=(jc=j.e,Object(g.c)(Rc,jc),Rc.prototype.getSchemaXml=function(){return this.clone(Cc,"schemaxml")()},Rc.prototype.add=function(e){return Object(m.d)(this.clone(Cc,"addviewfield('"+e+"')"))},Rc.prototype.move=function(e,t){return Object(m.d)(this.clone(Cc,"moveviewfieldto"),Object(S.n)({field:e,index:t}))},Rc.prototype.removeAll=function(){return Object(m.d)(this.clone(Cc,"removeallviewfields"))},Rc.prototype.remove=function(e){return Object(m.d)(this.clone(Cc,"removeviewfield('"+e+"')"))},Object(g.b)([Object(I.a)("vfs.getSchemaXml")],Rc.prototype,"getSchemaXml",null),Object(g.b)([Object(I.a)("vfs.add")],Rc.prototype,"add",null),Object(g.b)([Object(I.a)("vfs.move")],Rc.prototype,"move",null),Object(g.b)([Object(I.a)("vfs.removeAll")],Rc.prototype,"removeAll",null),Object(g.b)([Object(I.a)("vfs.remove")],Rc.prototype,"remove",null),Object(g.b)([Object(O.a)("viewfields")],Rc)),Cc=Object(j.i)(_c);function Rc(){return null!==jc&&jc.apply(this,arguments)||this}function Ec(){var t=null!==mc&&mc.apply(this,arguments)||this;return t.delete=Object(j.g)("vw"),t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t}function Nc(){return null!==vc&&vc.apply(this,arguments)||this}(Sc=yc=yc||{})[Sc.DefaultValue=0]="DefaultValue",Sc[Sc.Recursive=1]="Recursive",Sc[Sc.RecursiveAll=2]="RecursiveAll",Sc[Sc.FilesOnly=3]="FilesOnly",Object(S.m)(re.e,"views",Pc),Object(S.m)(re.e,"defaultView",wc,"DefaultView"),re.e.prototype.getView=function(e){return wc(this,"getView('"+e+"')")};var Ac,Uc,xc,Dc,kc,Lc=(Dc=j.d,Object(g.c)(Kc,Dc),Object.defineProperty(Kc.prototype,"scope",{get:function(){return I.a.configure(Object(j.a)(this,"Scope"),"f.scope")},enumerable:!1,configurable:!0}),Object.defineProperty(Kc.prototype,"webparts",{get:function(){return Gc(this,"webparts")},enumerable:!1,configurable:!0}),Kc.prototype.export=function(e){return Object(m.d)(this.clone(Bc,"ExportWebPart"),Object(S.n)({webPartId:e}))},Kc.prototype.import=function(e){return Object(m.d)(this.clone(Bc,"ImportWebPart"),Object(S.n)({webPartXml:e}))},Kc),Fc=function(e,t){return new Lc(e,t)},Bc=function(e,t){return Fc(e,t)},Mc=(xc=j.e,Object(g.c)(Vc,xc),Vc.prototype.getById=function(e){return Wc(this,"getbyid('"+e+"')")},Vc.prototype.getByControlId=function(e){return Wc(this,"getByControlId('"+e+"')")},Vc),Gc=Object(j.i)(Mc),qc=(Uc=j.f,Object(g.c)(Hc,Uc),Object.defineProperty(Hc.prototype,"webpart",{get:function(){return Object(j.c)(this,"webpart")},enumerable:!1,configurable:!0}),Hc.prototype.saveChanges=function(){return Object(m.d)(this.clone(Wc,"SaveWebPartChanges"))},Hc.prototype.moveTo=function(e,t){return Object(m.d)(this.clone(Wc,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")"))},Hc.prototype.close=function(){return Object(m.d)(this.clone(Wc,"CloseWebPart"))},Hc.prototype.open=function(){return Object(m.d)(this.clone(Wc,"OpenWebPart"))},Hc.prototype.delete=function(){return Object(m.d)(this.clone(Wc,"DeleteWebPart"))},Hc),Wc=Object(j.i)(qc);function Hc(){return null!==Uc&&Uc.apply(this,arguments)||this}function Vc(){return null!==xc&&xc.apply(this,arguments)||this}function Kc(){return null!==Dc&&Dc.apply(this,arguments)||this}(kc=Ac=Ac||{})[kc.User=0]="User",kc[kc.Shared=1]="Shared",R.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=Ac.Shared),Fc(this,"getLimitedWebPartManager(scope="+e+")")};var Qc=n(37),zc=new h.a},function(e,t,n){"use strict";n.r(t),n.d(t,"Attachment",function(){return V}),n.d(t,"Attachments",function(){return Q}),n.d(t,"Calendar",function(){return Te}),n.d(t,"Calendars",function(){return Ie}),n.d(t,"Event",function(){return _e}),n.d(t,"Events",function(){return Re}),n.d(t,"Contact",function(){return $e}),n.d(t,"ContactFolder",function(){return tt}),n.d(t,"ContactFolders",function(){return rt}),n.d(t,"Contacts",function(){return Ze}),n.d(t,"Conversation",function(){return S}),n.d(t,"Conversations",function(){return P}),n.d(t,"Post",function(){return E}),n.d(t,"Posts",function(){return A}),n.d(t,"Senders",function(){return x}),n.d(t,"Thread",function(){return w}),n.d(t,"Threads",function(){return C}),n.d(t,"DirectoryObjectTypes",function(){return J}),n.d(t,"DirectoryObject",function(){return ie}),n.d(t,"DirectoryObjects",function(){return ce}),n.d(t,"Group",function(){return pe}),n.d(t,"GroupType",function(){return $}),n.d(t,"Groups",function(){return be}),n.d(t,"Insights",function(){return yt}),n.d(t,"SharedInsight",function(){return Ct}),n.d(t,"SharedInsights",function(){return Et}),n.d(t,"TrendingInsight",function(){return mt}),n.d(t,"TrendingInsights",function(){return St}),n.d(t,"UsedInsight",function(){return Pt}),n.d(t,"UsedInsights",function(){return wt}),n.d(t,"Resource",function(){return At}),n.d(t,"Invitations",function(){return Wt}),n.d(t,"Member",function(){return zt}),n.d(t,"Members",function(){return Jt}),n.d(t,"MailFolder",function(){return ln}),n.d(t,"MailFolders",function(){return pn}),n.d(t,"MailboxSettings",function(){return bn}),n.d(t,"Message",function(){return cn}),n.d(t,"Messages",function(){return an}),n.d(t,"Drive",function(){return wn}),n.d(t,"DriveItem",function(){return An}),n.d(t,"DriveItems",function(){return xn}),n.d(t,"Drives",function(){return Cn}),n.d(t,"Root",function(){return En}),n.d(t,"Notebook",function(){return zn}),n.d(t,"Notebooks",function(){return Jn}),n.d(t,"OneNote",function(){return Kn}),n.d(t,"Section",function(){return Yn}),n.d(t,"Sections",function(){return er}),n.d(t,"Photo",function(){return ar}),n.d(t,"Bucket",function(){return xr}),n.d(t,"Buckets",function(){return kr}),n.d(t,"Plan",function(){return Pr}),n.d(t,"Planner",function(){return mr}),n.d(t,"Plans",function(){return wr}),n.d(t,"Task",function(){return Er}),n.d(t,"Tasks",function(){return Ar}),n.d(t,"TaskDetails",function(){return Cr}),n.d(t,"PlanDetails",function(){return Sr}),n.d(t,"Subscription",function(){return Xr}),n.d(t,"Subscriptions",function(){return $r}),n.d(t,"Channel",function(){return di}),n.d(t,"Channels",function(){return hi}),n.d(t,"Tab",function(){return fi}),n.d(t,"Tabs",function(){return gi}),n.d(t,"Team",function(){return si}),n.d(t,"Teams",function(){return ui}),n.d(t,"User",function(){return Fe}),n.d(t,"Users",function(){return Me}),n.d(t,"People",function(){return qe}),n.d(t,"graph",function(){return at.b}),n.d(t,"GraphRest",function(){return at.a});var a=n(0),u=n(2),r=n(6),l=n(9);function i(r){return function(e){return n=e,Object(a.c)(t,n),t;function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.call(this,e[0],1<e.length&&void 0!==e[1]?e[1]:r)||this}var n}}function o(){return function(e){return n=e,Object(a.c)(t,n),t.prototype.delete=function(){return Object(l.a)(this)},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function c(){return function(e){return n=e,Object(a.c)(t,n),t.prototype.delete=function(e){return void 0===e&&(e="*"),Object(l.a)(this,Object(u.x)({"If-Match":e}))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function s(){return function(e){return n=e,Object(a.c)(t,n),t.prototype.update=function(e){return Object(l.c)(this,Object(u.n)(e))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function d(){return function(e){return n=e,Object(a.c)(t,n),t.prototype.update=function(e,t){return void 0===t&&(t="*"),Object(l.c)(this,Object(u.n)(e,Object(u.x)({"If-Match":t})))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function p(){return function(e){return n=e,Object(a.c)(t,n),t.prototype.add=function(e){return Object(l.d)(this,Object(u.n)(e))},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}function h(r){return function(e){return n=e,Object(a.c)(t,n),t.prototype.getById=function(e){return r(this,e)},t;function t(){return null!==n&&n.apply(this,arguments)||this}var n}}var b,f,O,g,y,j,m,v=(m=r.e,Object(a.c)(G,m),Object.defineProperty(G.prototype,"threads",{get:function(){return C(this)},enumerable:!1,configurable:!0}),Object(a.b)([s(),o()],G)),S=Object(r.f)(v),T=(j=r.d,Object(a.c)(M,j),Object(a.b)([i("conversations"),p(),h(S)],M)),P=Object(r.f)(T),I=(y=r.e,Object(a.c)(B,y),Object.defineProperty(B.prototype,"posts",{get:function(){return A(this)},enumerable:!1,configurable:!0}),B.prototype.reply=function(e){return Object(l.d)(this.clone(w,"reply"),Object(u.n)(e))},Object(a.b)([o()],B)),w=Object(r.f)(I),_=(g=r.d,Object(a.c)(F,g),Object(a.b)([i("threads"),p(),h(w)],F)),C=Object(r.f)(_),R=(O=r.e,Object(a.c)(L,O),L.prototype.forward=function(e){return Object(l.d)(this.clone(E,"forward"),Object(u.n)(e))},L.prototype.reply=function(e){return Object(l.d)(this.clone(E,"reply"),Object(u.n)(e))},Object(a.b)([o()],L)),E=Object(r.f)(R),N=(f=r.d,Object(a.c)(k,f),Object(a.b)([i("posts"),p(),h(E)],k)),A=Object(r.f)(N),U=(b=r.d,Object(a.c)(D,b),D.prototype.add=function(e){return Object(l.d)(this.clone(x,"$ref"),Object(u.n)({"@odata.id":e}))},D.prototype.remove=function(e){var t=this.clone(x,"$ref");return t.query.set("$id",e),Object(l.a)(t)},D),x=Object(r.f)(U);function D(){return null!==b&&b.apply(this,arguments)||this}function k(){return null!==f&&f.apply(this,arguments)||this}function L(){return null!==O&&O.apply(this,arguments)||this}function F(){return null!==g&&g.apply(this,arguments)||this}function B(){return null!==y&&y.apply(this,arguments)||this}function M(){return null!==j&&j.apply(this,arguments)||this}function G(){return null!==m&&m.apply(this,arguments)||this}var q,W,H=(W=r.e,Object(a.c)(X,W),X),V=Object(r.f)(H),K=(q=r.d,Object(a.c)(z,q),z.prototype.addFile=function(e,t){return Object(l.d)(this,Object(u.n)((n={contentBytes:t,name:e},Object.assign({"@odata.type":"#microsoft.graph.fileAttachment"},n))));var n},Object(a.b)([i("attachments"),h(V)],z)),Q=Object(r.f)(K);function z(){return null!==q&&q.apply(this,arguments)||this}function X(){return null!==W&&W.apply(this,arguments)||this}Object(u.m)(R,"attachments",Q);var J,$,Y,Z,ee,te,ne=n(1),re=(Z=r.e,Object(a.c)(ae,Z),ae.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),Object(l.d)(this.clone(ie,"getMemberObjects"),Object(u.n)({securityEnabledOnly:e}))},ae.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),Object(l.d)(this.clone(ie,"getMemberGroups"),Object(u.n)({securityEnabledOnly:e}))},ae.prototype.checkMemberGroups=function(e){return Object(l.d)(this.clone(ie,"checkMemberGroups"),Object(u.n)({groupIds:e}))},Object(a.b)([o()],ae)),ie=Object(r.f)(re),oe=(Y=r.d,Object(a.c)(se,Y),se.prototype.getByIds=function(e,t){return void 0===t&&(t=J.directoryObject),Object(l.d)(this.clone(ce,"getByIds"),Object(u.n)({ids:e,type:t}))},Object(a.b)([i("directoryObjects"),h(ie)],se)),ce=Object(r.f)(oe);function se(){return null!==Y&&Y.apply(this,arguments)||this}function ae(){return null!==Z&&Z.apply(this,arguments)||this}(te=J=J||{})[te.directoryObject=0]="directoryObject",te[te.user=1]="user",te[te.group=2]="group",te[te.device=3]="device",(ee=$=$||{})[ee.Office365=0]="Office365",ee[ee.Dynamic=1]="Dynamic",ee[ee.Security=2]="Security";var ue,le,de=(le=re,Object(a.c)(Oe,le),Oe.prototype.addFavorite=function(){return Object(l.d)(this.clone(pe,"addFavorite"))},Oe.prototype.removeFavorite=function(){return Object(l.d)(this.clone(pe,"removeFavorite"))},Oe.prototype.resetUnseenCount=function(){return Object(l.d)(this.clone(pe,"resetUnseenCount"))},Oe.prototype.subscribeByMail=function(){return Object(l.d)(this.clone(pe,"subscribeByMail"))},Oe.prototype.unsubscribeByMail=function(){return Object(l.d)(this.clone(pe,"unsubscribeByMail"))},Oe.prototype.getCalendarView=function(e,t){var n=this.clone(pe,"calendarView");return n.query.set("startDateTime",e.toISOString()),n.query.set("endDateTime",t.toISOString()),n()},Object(a.b)([o(),s()],Oe)),pe=Object(r.f)(de),he=(ue=r.d,Object(a.c)(fe,ue),fe.prototype.add=function(r,i,o,c){return void 0===c&&(c={}),Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({displayName:r,mailEnabled:o===$.Office365,mailNickname:i,securityEnabled:o!==$.Office365},c),o!==$.Security&&(t=Object(ne.assign)(t,{groupTypes:o===$.Office365?["Unified"]:["DynamicMembership"]})),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return[2,{data:n=e.sent(),group:this.getById(n.id)}]}})})},Object(a.b)([i("groups"),h(pe)],fe)),be=Object(r.f)(he);function fe(){return null!==ue&&ue.apply(this,arguments)||this}function Oe(){return null!==le&&le.apply(this,arguments)||this}function ge(e,t){var n=Object(r.a)(this,"calendarView");return n.query.set("startDateTime",encodeURIComponent(e)),n.query.set("endDateTime",encodeURIComponent(t)),n}var ye,je,me,ve,Se=(ve=r.e,Object(a.c)(Ue,ve),Object.defineProperty(Ue.prototype,"events",{get:function(){return Re(this)},enumerable:!1,configurable:!0}),Ue),Te=Object(r.f)(Se),Pe=(me=r.d,Object(a.c)(Ae,me),Object(a.b)([i("calendars"),h(Te)],Ae)),Ie=Object(r.f)(Pe),we=(je=r.e,Object(a.c)(Ne,je),Object(a.b)([o(),s()],Ne)),_e=Object(r.f)(we),Ce=(ye=r.d,Object(a.c)(Ee,ye),Ee.prototype.add=function(n){return Object(a.a)(this,void 0,void 0,function(){var t;return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,Object(l.d)(this,Object(u.n)(n))];case 1:return[2,{data:t=e.sent(),event:this.getById(t.id)}]}})})},Object(a.b)([i("events"),h(_e)],Ee)),Re=Object(r.f)(Ce);function Ee(){return null!==ye&&ye.apply(this,arguments)||this}function Ne(){return null!==je&&je.apply(this,arguments)||this}function Ae(){return null!==me&&me.apply(this,arguments)||this}function Ue(){var e=null!==ve&&ve.apply(this,arguments)||this;return e.calendarView=ge,e}Object(u.m)(de,"calendar",Te,"calendar"),Object(u.m)(de,"events",Re);var xe,De,ke,Le=(ke=re,Object(a.c)(Ve,ke),Object.defineProperty(Ve.prototype,"memberOf",{get:function(){return ce(this,"memberOf")},enumerable:!1,configurable:!0}),Object.defineProperty(Ve.prototype,"people",{get:function(){return qe(this)},enumerable:!1,configurable:!0}),Object(a.b)([s(),o()],Ve)),Fe=Object(r.f)(Le),Be=(De=r.d,Object(a.c)(He,De),Object(a.b)([i("users"),h(Fe)],He)),Me=Object(r.f)(Be),Ge=(xe=r.d,Object(a.c)(We,xe),Object(a.b)([i("people")],We)),qe=Object(r.f)(Ge);function We(){return null!==xe&&xe.apply(this,arguments)||this}function He(){return null!==De&&De.apply(this,arguments)||this}function Ve(){return null!==ke&&ke.apply(this,arguments)||this}Object(u.m)(Le,"calendar",Te,"calendar"),Object(u.m)(Le,"calendars",Ie,"calendars"),Object(u.m)(Le,"events",Re),Le.prototype.calendarView=ge;var Ke,Qe,ze,Xe,Je=(Xe=r.e,Object(a.c)(st,Xe),Object(a.b)([s(),o()],st)),$e=Object(r.f)(Je),Ye=(ze=r.d,Object(a.c)(ct,ze),ct.prototype.add=function(r,i,o,c,s){return void 0===s&&(s={}),Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({businessPhones:c,emailAddresses:o,givenName:r,surName:i},s),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return n=e.sent(),[2,{contact:this.getById(n.id),data:n}]}})})},Object(a.b)([i("contacts"),h($e)],ct)),Ze=Object(r.f)(Ye),et=(Qe=r.e,Object(a.c)(ot,Qe),Object.defineProperty(ot.prototype,"contacts",{get:function(){return Ze(this)},enumerable:!1,configurable:!0}),Object.defineProperty(ot.prototype,"childFolders",{get:function(){return rt(this,"childFolders")},enumerable:!1,configurable:!0}),Object(a.b)([o(),s()],ot)),tt=Object(r.f)(et),nt=(Ke=r.d,Object(a.c)(it,Ke),it.prototype.add=function(r,i){return Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t={displayName:r,parentFolderId:i},[4,Object(l.d)(this,Object(u.n)(t))];case 1:return n=e.sent(),[2,{contactFolder:this.getById(n.id),data:n}]}})})},Object(a.b)([i("contactFolders"),h(tt)],it)),rt=Object(r.f)(nt);function it(){return null!==Ke&&Ke.apply(this,arguments)||this}function ot(){return null!==Qe&&Qe.apply(this,arguments)||this}function ct(){return null!==ze&&ze.apply(this,arguments)||this}function st(){return null!==Xe&&Xe.apply(this,arguments)||this}Object(u.m)(Le,"contacts",Ze),Object(u.m)(Le,"contactFolders",rt),Object(u.m)(de,"conversations",P),Object(u.m)(de,"acceptedSenders",x,"acceptedsenders"),Object(u.m)(de,"rejectedSenders",x,"rejectedsenders");var at=n(18);Reflect.defineProperty(at.a.prototype,"directoryObjects",{configurable:!0,enumerable:!0,get:function(){return ce(this)}}),Reflect.defineProperty(at.a.prototype,"groups",{configurable:!0,enumerable:!0,get:function(){return be(this)}});var ut,lt,dt,pt,ht,bt,ft,Ot,gt=(Ot=r.e,Object(a.c)(Mt,Ot),Object.defineProperty(Mt.prototype,"trending",{get:function(){return St(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"used",{get:function(){return wt(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"shared",{get:function(){return Et(this)},enumerable:!1,configurable:!0}),Object(a.b)([i("insights")],Mt)),yt=Object(r.f)(gt),jt=(ft=r.e,Object(a.c)(Bt,ft),Object.defineProperty(Bt.prototype,"resource",{get:function(){return At(this)},enumerable:!1,configurable:!0}),Bt),mt=Object(r.f)(jt),vt=(bt=r.d,Object(a.c)(Ft,bt),Object(a.b)([i("trending"),h(mt)],Ft)),St=Object(r.f)(vt),Tt=(ht=r.e,Object(a.c)(Lt,ht),Object.defineProperty(Lt.prototype,"resource",{get:function(){return At(this)},enumerable:!1,configurable:!0}),Lt),Pt=Object(r.f)(Tt),It=(pt=r.d,Object(a.c)(kt,pt),Object(a.b)([i("used"),h(Pt)],kt)),wt=Object(r.f)(It),_t=(dt=r.e,Object(a.c)(Dt,dt),Object.defineProperty(Dt.prototype,"resource",{get:function(){return At(this)},enumerable:!1,configurable:!0}),Dt),Ct=Object(r.f)(_t),Rt=(lt=r.d,Object(a.c)(xt,lt),Object(a.b)([i("shared"),h(Ct)],xt)),Et=Object(r.f)(Rt),Nt=(ut=r.e,Object(a.c)(Ut,ut),Object(a.b)([i("resource")],Ut)),At=Object(r.f)(Nt);function Ut(){return null!==ut&&ut.apply(this,arguments)||this}function xt(){return null!==lt&&lt.apply(this,arguments)||this}function Dt(){return null!==dt&&dt.apply(this,arguments)||this}function kt(){return null!==pt&&pt.apply(this,arguments)||this}function Lt(){return null!==ht&&ht.apply(this,arguments)||this}function Ft(){return null!==bt&&bt.apply(this,arguments)||this}function Bt(){return null!==ft&&ft.apply(this,arguments)||this}function Mt(){return null!==Ot&&Ot.apply(this,arguments)||this}Object(u.m)(Le,"insights",yt);var Gt,qt=(Gt=r.d,Object(a.c)(Ht,Gt),Ht.prototype.create=function(n,r,i){return void 0===i&&(i={}),Object(a.a)(this,void 0,void 0,function(){var t;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({inviteRedirectUrl:r,invitedUserEmailAddress:n},i),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return[2,{data:e.sent()}]}})})},Object(a.b)([i("invitations")],Ht)),Wt=Object(r.f)(qt);function Ht(){return null!==Gt&&Gt.apply(this,arguments)||this}Reflect.defineProperty(at.a.prototype,"invitations",{configurable:!0,enumerable:!0,get:function(){return Wt(this)}});var Vt,Kt,Qt=(Kt=r.e,Object(a.c)(Yt,Kt),Yt.prototype.remove=function(){return Object(l.a)(this.clone(zt,"$ref"))},Yt),zt=Object(r.f)(Qt),Xt=(Vt=r.d,Object(a.c)($t,Vt),$t.prototype.add=function(e){return Object(l.d)(this.clone(Jt,"$ref"),Object(u.n)({"@odata.id":e}))},Object(a.b)([i("members"),h(zt)],$t)),Jt=Object(r.f)(Xt);function $t(){return null!==Vt&&Vt.apply(this,arguments)||this}function Yt(){return null!==Kt&&Kt.apply(this,arguments)||this}Object(u.m)(de,"owners",Jt,"owners"),Object(u.m)(de,"members",Jt);var Zt,en,tn,nn,rn,on=(rn=r.e,Object(a.c)(jn,rn),jn),cn=Object(r.f)(on),sn=(nn=r.d,Object(a.c)(yn,nn),Object(a.b)([i("messages"),h(cn),p()],yn)),an=Object(r.f)(sn),un=(tn=r.e,Object(a.c)(gn,tn),gn),ln=Object(r.f)(un),dn=(en=r.d,Object(a.c)(On,en),Object(a.b)([i("mailFolders"),h(ln),p()],On)),pn=Object(r.f)(dn),hn=(Zt=r.e,Object(a.c)(fn,Zt),Object(a.b)([i("mailboxSettings"),s()],fn)),bn=Object(r.f)(hn);function fn(){return null!==Zt&&Zt.apply(this,arguments)||this}function On(){return null!==en&&en.apply(this,arguments)||this}function gn(){return null!==tn&&tn.apply(this,arguments)||this}function yn(){return null!==nn&&nn.apply(this,arguments)||this}function jn(){return null!==rn&&rn.apply(this,arguments)||this}Object(u.m)(Le,"messages",an),Object(u.m)(Le,"mailboxSettings",bn),Object(u.m)(Le,"mailFolders",pn),Le.prototype.sendMail=function(e){return Object(l.d)(this.clone(Fe,"sendMail"),Object(u.n)(e))};var mn,vn,Sn,Tn,Pn,In=(Pn=r.e,Object(a.c)(Bn,Pn),Object.defineProperty(Bn.prototype,"root",{get:function(){return En(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Bn.prototype,"list",{get:function(){return Object(r.b)(this,"list")},enumerable:!1,configurable:!0}),Object.defineProperty(Bn.prototype,"recent",{get:function(){return xn(this,"recent")},enumerable:!1,configurable:!0}),Object.defineProperty(Bn.prototype,"sharedWithMe",{get:function(){return xn(this,"sharedWithMe")},enumerable:!1,configurable:!0}),Bn.prototype.getItemById=function(e){return An(this,Object(ne.combine)("items",e))},Object(a.b)([i("drive")],Bn)),wn=Object(r.f)(In),_n=(Tn=r.d,Object(a.c)(Fn,Tn),Object(a.b)([i("drives"),h(wn)],Fn)),Cn=Object(r.f)(_n),Rn=(Sn=r.e,Object(a.c)(Ln,Sn),Object.defineProperty(Ln.prototype,"children",{get:function(){return xn(this,"children")},enumerable:!1,configurable:!0}),Ln.prototype.search=function(e){var t=this.clone(En);return t.query.set("search","'"+e+"'"),t()},Object.defineProperty(Ln.prototype,"thumbnails",{get:function(){return Object(r.a)(this,"thumbnails")},enumerable:!1,configurable:!0}),Object(a.b)([i("root")],Ln)),En=Object(r.f)(Rn),Nn=(vn=r.e,Object(a.c)(kn,vn),Object.defineProperty(kn.prototype,"children",{get:function(){return xn(this,"children")},enumerable:!1,configurable:!0}),Object.defineProperty(kn.prototype,"thumbnails",{get:function(){return Object(r.a)(this,"thumbnails")},enumerable:!1,configurable:!0}),Object.defineProperty(kn.prototype,"versions",{get:function(){return Object(r.a)(this,"versions")},enumerable:!1,configurable:!0}),kn.prototype.move=function(e,t){return Object(l.c)(this,Object(u.n)(Object(ne.assign)(e,{name:t})))},kn.prototype.getContent=function(){return Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,this()];case 1:return t=e.sent(),[4,ne.safeGlobal.fetch(t["@microsoft.graph.downloadUrl"],{headers:{accept:"application/json"},method:"GET",responseType:"arraybuffer"})];case 2:return n=e.sent(),[2,(new u.b).parse(n)]}})})},kn.prototype.setContent=function(e){return Object(l.e)(this.clone(An,"content"),{body:e})},Object(a.b)([o(),s()],kn)),An=Object(r.f)(Nn),Un=(mn=r.d,Object(a.c)(Dn,mn),Object(a.b)([h(An)],Dn)),xn=Object(r.f)(Un);function Dn(){return null!==mn&&mn.apply(this,arguments)||this}function kn(){return null!==vn&&vn.apply(this,arguments)||this}function Ln(){return null!==Sn&&Sn.apply(this,arguments)||this}function Fn(){return null!==Tn&&Tn.apply(this,arguments)||this}function Bn(){return null!==Pn&&Pn.apply(this,arguments)||this}Object(u.m)(Le,"drive",wn),Object(u.m)(Le,"drives",Cn);var Mn,Gn,qn,Wn,Hn,Vn=(Hn=r.e,Object(a.c)(or,Hn),Object.defineProperty(or.prototype,"notebooks",{get:function(){return Jn(this)},enumerable:!1,configurable:!0}),Object.defineProperty(or.prototype,"sections",{get:function(){return er(this)},enumerable:!1,configurable:!0}),Object.defineProperty(or.prototype,"pages",{get:function(){return Object(r.a)(this,"pages")},enumerable:!1,configurable:!0}),Object(a.b)([i("onenote")],or)),Kn=Object(r.f)(Vn),Qn=(Wn=r.e,Object(a.c)(ir,Wn),Object.defineProperty(ir.prototype,"sections",{get:function(){return er(this)},enumerable:!1,configurable:!0}),ir),zn=Object(r.f)(Qn),Xn=(qn=r.d,Object(a.c)(rr,qn),rr.prototype.add=function(n){return Object(a.a)(this,void 0,void 0,function(){var t;return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,Object(l.d)(this,Object(u.n)({displayName:n}))];case 1:return[2,{data:t=e.sent(),notebook:this.getById(t.id)}]}})})},Object(a.b)([i("notebooks"),h(zn)],rr)),Jn=Object(r.f)(Xn),$n=(Gn=r.e,Object(a.c)(nr,Gn),nr),Yn=Object(r.f)($n),Zn=(Mn=r.d,Object(a.c)(tr,Mn),tr.prototype.add=function(n){return Object(a.a)(this,void 0,void 0,function(){var t;return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,Object(l.d)(this,Object(u.n)({displayName:n}))];case 1:return[2,{data:t=e.sent(),section:this.getById(t.id)}]}})})},Object(a.b)([i("sections"),h(Yn)],tr)),er=Object(r.f)(Zn);function tr(){return null!==Mn&&Mn.apply(this,arguments)||this}function nr(){return null!==Gn&&Gn.apply(this,arguments)||this}function rr(){return null!==qn&&qn.apply(this,arguments)||this}function ir(){return null!==Wn&&Wn.apply(this,arguments)||this}function or(){return null!==Hn&&Hn.apply(this,arguments)||this}Object(u.m)(Le,"onenote",Kn);var cr,sr=(cr=r.e,Object(a.c)(ur,cr),ur.prototype.getBlob=function(){return this.clone(ar,"$value",!1).usingParser(new u.b)()},ur.prototype.getBuffer=function(){return this.clone(ar,"$value",!1).usingParser(new u.c)()},ur.prototype.setContent=function(e){return Object(l.c)(this.clone(ar,"$value",!1),{body:e})},Object(a.b)([i("photo")],ur)),ar=Object(r.f)(sr);function ur(){return null!==cr&&cr.apply(this,arguments)||this}Object(u.m)(de,"photo",ar),Object(u.m)(Le,"photo",ar);var lr,dr,pr,hr,br,fr,Or,gr,yr,jr=(yr=r.e,Object(a.c)(Vr,yr),Object.defineProperty(Vr.prototype,"plans",{get:function(){return wr(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"tasks",{get:function(){return Ar(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Vr.prototype,"buckets",{get:function(){return kr(this)},enumerable:!1,configurable:!0}),Object(a.b)([i("planner")],Vr)),mr=Object(r.f)(jr),vr=(gr=r.e,Object(a.c)(Hr,gr),Object(a.b)([i("details"),d()],Hr)),Sr=Object(r.f)(vr),Tr=(Or=r.e,Object(a.c)(Wr,Or),Object.defineProperty(Wr.prototype,"tasks",{get:function(){return Ar(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Wr.prototype,"buckets",{get:function(){return kr(this)},enumerable:!1,configurable:!0}),Object.defineProperty(Wr.prototype,"details",{get:function(){return Sr(this)},enumerable:!1,configurable:!0}),Object(a.b)([d(),c()],Wr)),Pr=Object(r.f)(Tr),Ir=(fr=r.d,Object(a.c)(qr,fr),qr.prototype.add=function(n,r){return Object(a.a)(this,void 0,void 0,function(){var t;return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,Object(l.d)(this,Object(u.n)({owner:n,title:r}))];case 1:return[2,{data:t=e.sent(),plan:this.getById(t.id)}]}})})},Object(a.b)([i("plans"),h(Pr)],qr)),wr=Object(r.f)(Ir),_r=(br=r.e,Object(a.c)(Gr,br),Object(a.b)([i("details"),d()],Gr)),Cr=Object(r.f)(_r),Rr=(hr=r.e,Object(a.c)(Mr,hr),Object.defineProperty(Mr.prototype,"details",{get:function(){return Cr(this)},enumerable:!1,configurable:!0}),Object(a.b)([d(),c()],Mr)),Er=Object(r.f)(Rr),Nr=(pr=r.d,Object(a.c)(Br,pr),Br.prototype.add=function(r,i,o,c){return Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({planId:r,title:i},o),c&&(t=Object(ne.assign)(t,{bucketId:c})),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return[2,{data:n=e.sent(),task:this.getById(n.id)}]}})})},Object(a.b)([i("tasks"),h(Er)],Br)),Ar=Object(r.f)(Nr),Ur=(dr=r.e,Object(a.c)(Fr,dr),Object.defineProperty(Fr.prototype,"tasks",{get:function(){return Ar(this)},enumerable:!1,configurable:!0}),Object(a.b)([d(),c()],Fr)),xr=Object(r.f)(Ur),Dr=(lr=r.d,Object(a.c)(Lr,lr),Lr.prototype.add=function(r,i,o){return Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t={name:r,orderHint:o||"",planId:i},[4,Object(l.d)(this,Object(u.n)(t))];case 1:return n=e.sent(),[2,{bucket:this.getById(n.id),data:n}]}})})},Object(a.b)([i("buckets"),h(xr)],Lr)),kr=Object(r.f)(Dr);function Lr(){return null!==lr&&lr.apply(this,arguments)||this}function Fr(){return null!==dr&&dr.apply(this,arguments)||this}function Br(){return null!==pr&&pr.apply(this,arguments)||this}function Mr(){return null!==hr&&hr.apply(this,arguments)||this}function Gr(){return null!==br&&br.apply(this,arguments)||this}function qr(){return null!==fr&&fr.apply(this,arguments)||this}function Wr(){return null!==Or&&Or.apply(this,arguments)||this}function Hr(){return null!==gr&&gr.apply(this,arguments)||this}function Vr(){return null!==yr&&yr.apply(this,arguments)||this}Object(u.m)(de,"plans",wr,"planner/plans"),Object(u.m)(Le,"tasks",Ar,"planner/tasks"),Reflect.defineProperty(at.a.prototype,"planner",{configurable:!0,enumerable:!0,get:function(){return mr(this)}});var Kr,Qr,zr=(Qr=r.e,Object(a.c)(Zr,Qr),Object(a.b)([o(),s()],Zr)),Xr=Object(r.f)(zr),Jr=(Kr=r.d,Object(a.c)(Yr,Kr),Yr.prototype.add=function(r,i,o,c,s){return void 0===s&&(s={}),Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({changeType:r,expirationDateTime:c,notificationUrl:i,resource:o},s),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return[2,{data:n=e.sent(),subscription:this.getById(n.id)}]}})})},Object(a.b)([i("subscriptions"),h(Xr)],Yr)),$r=Object(r.f)(Jr);function Yr(){return null!==Kr&&Kr.apply(this,arguments)||this}function Zr(){return null!==Qr&&Qr.apply(this,arguments)||this}Reflect.defineProperty(at.a.prototype,"subscriptions",{configurable:!0,enumerable:!0,get:function(){return $r(this)}});var ei,ti,ni,ri,ii,oi,ci=(oi=r.e,Object(a.c)(Ti,oi),Object.defineProperty(Ti.prototype,"channels",{get:function(){return hi(this)},enumerable:!1,configurable:!0}),Ti.prototype.archive=function(e){return void 0===e&&(e=!1),Object(l.d)(this.clone(si,"archive"),Object(u.n)({shouldSetSpoSiteReadOnlyForMembers:e}))},Ti.prototype.unarchive=function(){return Object(l.d)(this.clone(si,"unarchive"))},Ti.prototype.cloneTeam=function(e,t,n,r){void 0===t&&(t=""),void 0===n&&(n="apps,tabs,settings,channels,members"),void 0===r&&(r="private");var i={description:t||"",displayName:e,mailNickname:e,partsToClone:n,visibility:r};return Object(l.d)(this.clone(si,"clone"),Object(u.n)(i))},Object(a.b)([i("team"),s()],Ti)),si=Object(r.f)(ci),ai=(ii=r.d,Object(a.c)(Si,ii),Object(a.b)([i("teams"),h(si)],Si)),ui=Object(r.f)(ai),li=(ri=r.e,Object(a.c)(vi,ri),Object.defineProperty(vi.prototype,"tabs",{get:function(){return gi(this)},enumerable:!1,configurable:!0}),vi),di=Object(r.f)(li),pi=(ni=r.d,Object(a.c)(mi,ni),mi.prototype.add=function(r,i){return void 0===i&&(i=""),Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t={description:i,displayName:r},[4,Object(l.d)(this,Object(u.n)(t))];case 1:return n=e.sent(),[2,{channel:this.getById(n.id),data:n}]}})})},Object(a.b)([i("channels"),h(di)],mi)),hi=Object(r.f)(pi),bi=(ti=r.e,Object(a.c)(ji,ti),Object(a.b)([i("tab"),s(),o()],ji)),fi=Object(r.f)(bi),Oi=(ei=r.d,Object(a.c)(yi,ei),yi.prototype.add=function(r,i,o){return Object(a.a)(this,void 0,void 0,function(){var t,n;return Object(a.d)(this,function(e){switch(e.label){case 0:return t=Object(ne.assign)({displayName:r,"teamsApp@odata.bind":i},o),[4,Object(l.d)(this,Object(u.n)(t))];case 1:return[2,{data:n=e.sent(),tab:this.getById(n.id)}]}})})},Object(a.b)([i("tabs"),h(fi)],yi)),gi=Object(r.f)(Oi);function yi(){return null!==ei&&ei.apply(this,arguments)||this}function ji(){return null!==ti&&ti.apply(this,arguments)||this}function mi(){return null!==ni&&ni.apply(this,arguments)||this}function vi(){return null!==ri&&ri.apply(this,arguments)||this}function Si(){return null!==ii&&ii.apply(this,arguments)||this}function Ti(){return null!==oi&&oi.apply(this,arguments)||this}Object(u.m)(Le,"joinedTeams",ui,"joinedTeams"),Object(u.m)(de,"team",si),de.prototype.createTeam=function(t){return Object(a.a)(this,void 0,void 0,function(){return Object(a.d)(this,function(e){switch(e.label){case 0:return[4,Object(l.e)(this.clone(pe,"team"),Object(u.n)(t))];case 1:return[2,{data:e.sent(),team:this.team}]}})})},Reflect.defineProperty(at.a.prototype,"teams",{configurable:!0,enumerable:!0,get:function(){return ui(this)}}),Reflect.defineProperty(at.a.prototype,"me",{configurable:!0,enumerable:!0,get:function(){return Fe(this,"me")}}),Reflect.defineProperty(at.a.prototype,"users",{configurable:!0,enumerable:!0,get:function(){return Me(this)}})},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return h});var i=n(0),r=n(21),o=n(32);function c(n,e){Object(r.m)(e)&&new Request("",{headers:e}).headers.forEach(function(e,t){n.append(t,e)})}function s(e,t){var n;Object(r.m)(t)&&(n=Object(r.a)(e.headers||{},t.headers),(e=Object(r.a)(e,t)).headers=n)}function a(e){var t=new URL(e);return t.protocol+"//"+t.hostname}var u,l,d=(O.prototype.fetch=function(e,t){return o.a.fetch(e,t)},O),p=(l=d,Object(i.c)(f,l),Object.defineProperty(f.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!1,configurable:!0}),f.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;return c(n,t.headers),n.set("Authorization","Bearer "+this._token),t.headers=n,l.prototype.fetch.call(this,e,t)},f),h=(u=p,Object(i.c)(b,u),b.prototype.fetch=function(n,r){return Object(i.a)(this,void 0,void 0,function(){var t;return Object(i.d)(this,function(e){switch(e.label){case 0:return[4,this.getToken(a(n))];case 1:return t=e.sent(),this.token=t,[2,u.prototype.fetch.call(this,n,r)]}})})},b.prototype.getToken=function(t){return Object(i.a)(this,void 0,void 0,function(){return Object(i.d)(this,function(e){switch(e.label){case 0:return[4,this.context.aadTokenProviderFactory.getTokenProvider()];case 1:return[2,e.sent().getToken(t)]}})})},b);function b(e){var t=u.call(this,null)||this;return t.context=e,t}function f(e){var t=l.call(this)||this;return t._token=e,t}function O(){}},function(e,t){},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return a});var o=n(0),r=n(21),i=n(30),c=(d.bind=function(e){return new d(void 0===e?new s:e)},d.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!Object(r.m)(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},d.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},d.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},d.prototype.getOrPut=function(n,r,i){return Object(o.a)(this,void 0,void 0,function(){var t;return Object(o.d)(this,function(e){switch(e.label){case 0:return this.enabled?null!==(t=this.get(n))?[3,2]:[4,r()]:[2,r()];case 1:t=e.sent(),this.put(n,t,i),e.label=2;case 2:return[2,t]}})})},d.prototype.deleteExpired=function(){return Object(o.a)(this,void 0,void 0,function(){var t,n;return Object(o.d)(this,function(e){switch(e.label){case 0:if(!this.enabled)return[2];t=0,e.label=1;case 1:return t<this.store.length?null!==(n=this.store.key(t))&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(n))?[4,this.get(n)]:[3,3]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},d.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},d.prototype.createPersistable=function(e,t){var n;return void 0===t&&(n=i.a.defaultCachingTimeoutSeconds,0<this.defaultTimeoutMinutes&&(n=60*this.defaultTimeoutMinutes),t=Object(r.c)(new Date,"second",n)),Object(r.l)({pnp:1,expiration:t,value:e})},d.prototype.cacheExpirationHandler=function(){var t=this;this.enabled&&this.deleteExpired().then(function(e){setTimeout(Object(r.d)(t,t.cacheExpirationHandler),i.a.cacheExpirationIntervalMilliseconds)}).catch(console.error)},d),s=(Object.defineProperty(l.prototype,"length",{get:function(){return this._store.size},enumerable:!1,configurable:!0}),l.prototype.clear=function(){this._store.clear()},l.prototype.getItem=function(e){return this._store.get(e)},l.prototype.key=function(e){return Array.from(this._store)[e][0]},l.prototype.removeItem=function(e){this._store.delete(e)},l.prototype.setItem=function(e,t){this._store.set(e,t)},l),a=(Object.defineProperty(u.prototype,"local",{get:function(){return null===this._local&&(this._local=new c("undefined"==typeof localStorage?new s:localStorage)),this._local},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"session",{get:function(){return null===this._session&&(this._session=new c("undefined"==typeof sessionStorage?new s:sessionStorage)),this._session},enumerable:!1,configurable:!0}),u);function u(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}function l(e){void 0===e&&(e=new Map),this._store=e}function d(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),i.a.enableCacheExpiration&&this.cacheExpirationHandler()}},function(e,t,n){"use strict";var r=n(2),i=n(11),o=n(14);Object(r.m)(i.e,"items",o.d)},function(e,t,n){"use strict";var r=n(39);n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var r=n(40);n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1);function i(e){r.RuntimeConfig.assign(e)}},function(e,t,n){"use strict";var r=n(18);n.d(t,"a",function(){return r.b}),n(35),n(6),n(29),n(34)},function(e,t,n){var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if((r.prototype._singletonInstance=this).instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){var e,t,n;this._loginInProgress?this.info("Login in progress"):(this._loginInProgress=!0,e=this._guid(),this.config.state=e,this._idTokenNonce=this._guid(),(t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST))&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce),this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n))},r.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=c/2-n/2+i,u=s/2-r/2+o,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+a);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,r,t){var i,o,c,n,s=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),a=t||this.callback;null!=s?(this._openedWindows.push(s),i=-1!=this.config.redirectUri.indexOf("#")?this.config.redirectUri.split("#")[0]:this.config.redirectUri,o=this,c=window.setInterval(function(){if(!s||s.closed||void 0===s.closed){var e="Popup Window closed",t="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return o.isAngular&&o._broadcast("adal:popUpClosed",t+o.CONSTANTS.RESOURCE_DELIMETER+e),o._handlePopupError(a,r,e,t,t),void window.clearInterval(c)}try{var n=s.location;if(-1!=encodeURI(n.href).indexOf(encodeURI(i)))return o.isAngular?o._broadcast("adal:popUpHashChanged",n.hash):o.handleWindowCallback(n.hash),window.clearInterval(c),o._loginInProgress=!1,o._acquireTokenInProgress=!1,o.info("Closing popup window"),o._openedWindows=[],void s.close()}catch(e){}},1)):(n="Popup Window is null. This can happen if you are using IE",this._handlePopupError(a,r,"Error opening popup",n,n))},r.prototype._broadcast=function(e,t){function n(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(n.prototype=window.Event.prototype,window.CustomEvent=n);var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&-1<t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(o,c,e){this._activeRenewals[c]=o,this._callBacksMappedToRenewStates[o]||(this._callBacksMappedToRenewStates[o]=[]);var s=this;this._callBacksMappedToRenewStates[o].push(e),this._callBackMappedToRenewStates[o]||(this._callBackMappedToRenewStates[o]=function(e,t,n,r){s._activeRenewals[c]=null;for(var i=0;i<s._callBacksMappedToRenewStates[o].length;++i)try{s._callBacksMappedToRenewStates[o][i](e,t,n,r)}catch(n){s.warn(n)}s._callBacksMappedToRenewStates[o]=null,s._callBackMappedToRenewStates[o]=null})},r.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i),n=n||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null==t?null:this.config.clientId,o=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,i),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){var e;r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS&&(r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n),(e=r._activeRenewals[n])&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED))},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(t,e){var n=this;n.info("LoadFrame: "+e);var r=e;setTimeout(function(){var e=n._addAdalFrame(r);""!==e.src&&"about:blank"!==e.src||(e.src=t,n._loadFrame(t,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e,t,n;this.clearCache(),this._user=null,e=this.config.logOutUri?this.config.logOutUri:(t="common",n="",this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),this.instance+t+"/oauth2/logout?"+n),this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");var t;this._user?e(null,this._user):(t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN),this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user)))},r.prototype._addHintParameters=function(e){var t;return this._user&&this._user.profile&&(this._user.profile.sid&&-1!==e.indexOf("&prompt=none")?this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid)):this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&-1<this._user.profile.upn.indexOf("@"))&&(t=this._user.profile.upn.split("@"),e+="&domain_hint="+encodeURIComponent(t[t.length-1]))),e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return-1<e.indexOf("#/")?e=e.substring(e.indexOf("#/")+2):-1<e.indexOf("#")&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t,n=this._deserialize(e),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(n&&((r.parameters=n).hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||n.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||n.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(r.valid=!0,!n.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+n.state),t=n.state,r.stateResponse=t,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var i=this._renewStates,o=0;o<i.length;o++)if(i[o]===r.stateResponse){r.stateMatch=!0;break}}}return r},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r)for(r=r.split(this.CONSTANTS.CACHE_DELIMETER),n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0;return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(-1<t&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),n=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(-1<e.indexOf(this.config.anonymousEndpoints[t]))return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(-1<e.indexOf(n))return this.config.endpoints[n];return!(-1<e.indexOf("http://")||-1<e.indexOf("https://"))||this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null},r.prototype._getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;0<this._openedWindows.length&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i=t.getRequestInfo(e),o=null,c=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback;t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ID_TOKEN);var s=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],a=i.parameters[t.CONSTANTS.ERROR];try{c&&c(s,r,a,o)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,c,s,a,u,l,d="",p=0;p<n;p+=4){if(r=t.indexOf(e.charAt(p)),i=t.indexOf(e.charAt(p+1)),o=t.indexOf(e.charAt(p+2)),c=t.indexOf(e.charAt(p+3)),p+2===n-1){a=(s=r<<18|i<<12|o<<6)>>16&255,u=s>>8&255,d+=String.fromCharCode(a,u);break}if(p+1===n-1){a=(s=r<<18|i<<12)>>16&255,d+=String.fromCharCode(a);break}a=(s=r<<18|i<<12|o<<6|c)>>16&255,u=s>>8&255,l=255&s,d+=String.fromCharCode(a,u,l)}return d},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,n){var r,i=[];return null!==t&&(i.push("?response_type="+e),i.push("client_id="+encodeURIComponent(t.clientId)),n&&i.push("resource="+encodeURIComponent(n)),i.push("redirect_uri="+encodeURIComponent(t.redirectUri)),i.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&i.push(t.extraQueryParameter),r=t.correlationId?t.correlationId:this._guid(),i.push("client-request-id="+encodeURIComponent(r))),i.join("&")},r.prototype._deserialize=function(e){for(var t=/\+/g,n=/([^&=]+)=([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i={},o=n.exec(e);o;)i[r(o[1])]=r(o[2]),o=n.exec(e);return i},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",c=0;c<36;c++)"-"!==n[c]&&"4"!==n[c]&&(i=16*Math.random()|0),"x"===n[c]?o+=r[i]:"y"===n[c]?(i&=3,o+=r[i|=8]):o+=n[c];return o},r.prototype._expiresIn=function(e){return e=e||3599,this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t,n=document.getElementById(e);return n||(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))?((t=document.createElement("iframe")).setAttribute("id",e),t.setAttribute("aria-hidden","true"),t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height=t.borderWidth="0px",n=document.getElementsByTagName("body")[0].appendChild(t)):document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>'),window.frames&&window.frames[e]&&(n=window.frames[e])),n}},r.prototype._saveItem=function(e,t,n){var r;return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?(n?(r=this._getItem(e)||"",localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)):localStorage.setItem(e,t),!0):(this.info("Local storage is not supported"),!1):this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="",o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t;n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r,i,o,c=n(1),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},a=n(37),u=n(25),l=n(24),d=(r=a.f,s(i=p,o=r),i.prototype=null===o?Object.create(o):(h.prototype=o.prototype,new h),p.prototype.crossDomainSite=function(e,t){return this._cdImpl(l.a,e,t,"site")},p.prototype.crossDomainWeb=function(e,t){return this._cdImpl(u.a,e,t,"web")},p.prototype._cdImpl=function(e,t,n,r){if(!Object(c.isUrlAbsolute)(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!Object(c.isUrlAbsolute)(n))throw Error("The hostWebUrl parameter must be an absolute url.");var i=e(Object(c.combine)(t,"_api/SP.AppContextSite(@target)"),r);return i.query.set("@target","'"+encodeURIComponent(n)+"'"),i.configure(this._options)},new p);function p(){return null!==r&&r.apply(this,arguments)||this}function h(){this.constructor=i}},function(e,t,n){"use strict";n.r(t),n.d(t,"util",function(){return h}),n.d(t,"sp",function(){return b}),n.d(t,"graph",function(){return f}),n.d(t,"storage",function(){return O}),n.d(t,"config",function(){return g}),n.d(t,"log",function(){return y}),n.d(t,"setup",function(){return j});var r=n(15),i=n(1),o=n(36),c=n(50),s=n(47),a=n(48);for(var u in n(39),n(40),i)["util","sp","graph","storage","config","log","setup","default"].indexOf(u)<0&&function(e){n.d(t,e,function(){return i[e]})}(u);n.d(t,"Logger",function(){return r.d}),n.d(t,"LogLevel",function(){return r.c}),n.d(t,"ConsoleListener",function(){return r.a}),n.d(t,"FunctionListener",function(){return r.b}),n.d(t,"Settings",function(){return o.c}),n.d(t,"CachingConfigurationProvider",function(){return o.a}),n.d(t,"SPListConfigurationProvider",function(){return o.b});var l=n(2);n.d(t,"Batch",function(){return l.a}),n.d(t,"CachingOptions",function(){return l.d}),n.d(t,"CachingParserWrapper",function(){return l.e}),n.d(t,"addProp",function(){return l.m}),n.d(t,"invokableFactory",function(){return l.y}),n.d(t,"pipelineBinder",function(){return l.A}),n.d(t,"defaultPipelineBinder",function(){return l.q}),n.d(t,"ODataParser",function(){return l.i}),n.d(t,"TextParser",function(){return l.l}),n.d(t,"BlobParser",function(){return l.b}),n.d(t,"JSONParser",function(){return l.g}),n.d(t,"BufferParser",function(){return l.c}),n.d(t,"LambdaParser",function(){return l.h}),n.d(t,"HttpRequestError",function(){return l.f}),n.d(t,"setResult",function(){return l.C}),n.d(t,"pipe",function(){return l.z}),n.d(t,"requestPipelineMethod",function(){return l.B}),n.d(t,"PipelineMethods",function(){return l.j}),n.d(t,"getDefaultPipeline",function(){return l.w}),n.d(t,"cloneQueryableData",function(){return l.p}),n.d(t,"Queryable",function(){return l.k}),n.d(t,"body",function(){return l.n}),n.d(t,"headers",function(){return l.x}),n.d(t,"extendGlobal",function(){return l.u}),n.d(t,"extendObj",function(){return l.v}),n.d(t,"extendFactory",function(){return l.t}),n.d(t,"clearGlobalExtensions",function(){return l.o}),n.d(t,"enableExtensions",function(){return l.s}),n.d(t,"disableExtensions",function(){return l.r});var d=n(45);n.d(t,"SPNS",function(){return d.a});var p=n(46);n.d(t,"GraphNS",function(){return p.a});var h={assign:i.assign,combine:i.combine,dateAdd:i.dateAdd,getCtxCallback:i.getCtxCallback,getGUID:i.getGUID,getRandomString:i.getRandomString,isArray:i.isArray,isFunc:i.isFunc,isUrlAbsolute:i.isUrlAbsolute,objectDefinedNotNull:i.objectDefinedNotNull,sanitizeGuid:i.sanitizeGuid,stringIsNullOrEmpty:i.stringIsNullOrEmpty},b=c.a,f=a.a,O=new i.PnPClientStorage,g=new o.c,y=r.d,j=s.a,m={config:g,graph:f,log:y,setup:j,sp:b,storage:O,util:h};t.default=m},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}],i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=51);function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r});