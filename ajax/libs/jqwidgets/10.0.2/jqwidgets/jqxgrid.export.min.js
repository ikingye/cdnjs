!function(A){A.extend(A.jqx._jqxGrid.prototype,{_exportData:function(e,t){var h=this,r=(r="string"==typeof t?t:t.fileName)||"jqxGrid";t&&"string"!=typeof t||(t={header:!0,filterBy:null,groupBy:null,style:null,fileName:r,pageOrientation:"portrait",expandChart:"+",collapseChar:"-"});var s=new A.jqx.dataAdapter.DataExporter({exportHeader:t.header});s.expandChar=t.expandChar,s.collapseChar=t.collapseChar,s.pageOrientation=t.pageOrientation,s.style=t.style,s.filterBy=t.filterBy,s.groupBy=t.groupBy;for(var l=[],i=h.columngroups||[],o=0,a=0;a<h.columns.records.length;a++)null!==h.columns.records[a].datafield&&(l[o++]={label:h.columns.records[a].text,dataField:h.columns.records[a].datafield});if(s.header={columns:l,columngroups:i},!t.style){var n=window.getComputedStyle(h.element),d=window.getComputedStyle(0<h.columns.records.length&&h.columns.records[0].element?h.columns.records[0].element:h.host.find(".jqx-grid-header")[0]),f=window.getComputedStyle(h.host.find(".jqx-grid-header")[0]);if(!(0===h.offsetWidth||0===h.offsetHeight)){function c(e){function n(e){return isNaN(e)?"00":i[(e-e%16)/16]+i[e%16]}function t(e){if(-1==e.toString().indexOf("rgba"))return(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))?"#"+n(e[1])+n(e[2])+n(e[3]).toUpperCase():"#ffffff";var t=d.split(","),r=parseInt(t[0].substring(5)),s=parseInt(t[1]),l=parseInt(t[2]),i=parseFloat(t[3].substring(1,4)),o={r:r,g:s,b:l},a=h._rgbToHex(o);return 0==r&&0==s&&0==l&&0==i?"#ffffff":"#"+a}var r=e.fontSize,s=e.borderRightColor,l=e.backgroundColor,d=e.color,i=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");return{borderColor:t(s),fontSize:r,fontFamily:"Helvetica",color:t(d),backgroundColor:t(l)}}for(var g,u,p=c(n),m=c(d),y=c(f),x={height:"30px",border:"1px solid "+p.borderColor,fontFamily:y.fontFamily,fontSize:y.fontSize,color:y.color,backgroundColor:m.backgroundColor,fontWeight:"400"},b={border:"1px solid "+p.borderColor,fontFamily:p.fontFamily,fontSize:p.fontSize},v={height:h.rowsheight+"px"},a=0;a<h.columns.records.length;a++){(j=h.columns.records[a]).exportable&&(x[j.datafield]={textAlign:j.align,width:j.width+"px",format:j.cellsformat||""},g=j.cellsformat||"","date"===j.dataType?g="d":"dateTime"===j.dataType?g="D":"time"===j.dataType&&(g="t"),u={textAlign:j.cellsalign,format:g},b[j.datafield]=u)}h.altrows&&(v.alternationCount=2,v.alternationStart=0,v.alternationEnd=0,v.alternationIndex0Color=p.color,v.alternationIndex0BackgroundColor=p.backgroundColor,v.alternationIndex1Color=p.color,v.alternationIndex1BackgroundColor="#F5F5F5"),s.style={border:"1px solid "+p.borderColor,borderCollapse:"collapse",header:x,columns:b,rows:v}}}for(var w=this.getrows(),C=[],a=0;a<w.length;a++){var S=w[a];if(!S.hidden){for(var j,T={},q=0;q<h.columns.records.length;q++){T[(j=h.columns.records[q]).datafield]=S[j.datafield]}C.push(T)}}return!t.groupBy&&h.groups&&(s.groupBy=h.groups.slice(0)),s.exportData(C,e,t.fileName,null)},exportview:function(e,t){this._exportData(e,t)},exportdata:function(h,e,f,c,t,r,s){if(!A.jqx.dataAdapter.ArrayExporter)throw"jqxGrid: Missing reference to jqxdata.export.js!";if("xlsx"!==h){null==f&&(f=!0);var g=this;if(null==c)if(0==(c=this.getrows()).length)throw"No data to export.";this.exporting=!0,this.pageable||(this.loadondemand=!0),this.altrows&&this._renderrows(this.virtualsizeinfo);var l=this.hScrollInstance.value;this.hScrollInstance.setPosition(0),this._renderrows(this.virtualsizeinfo);var u=null!=t&&t,p={},m={},i=this.host.find(".jqx-grid-cell:first"),o=this.host.find(".jqx-grid-cell-alt:first");i.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),i.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),o.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),o.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),i.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),i.removeClass(this.toThemeProperty("jqx-fill-state-hover")),o.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),o.removeClass(this.toThemeProperty("jqx-fill-state-hover"));for(var y="cell",x=1,b="column",v=1,w=[],a=0;a<this.columns.records.length;a++){var n=this.columns.records[a];if(""!=n.cellclassname)if(n.customCellStyles=new Array,"string"==typeof n.cellclassname)for(var d=0;d<c.length;d++)n.customCellStyles[d]=n.cellclassname;else for(d=0;d<c.length;d++){var C=this.getrowboundindex(d),S=n.cellclassname(C,n.displayfield,c[d][n.displayfield],c[d]);S&&(n.customCellStyles[d]=S)}}var j,T,q,F=new Array,_=null,I=null,P=null;A.each(this.columns.records,function(e){var t,r=A(g.table[0].rows[0].cells[e]);1<g.table[0].rows.length&&(t=A(g.table[0].rows[1].cells[e]),P=P||t),I=I||r;function s(e){if(e.removeClass(g.toThemeProperty("jqx-grid-cell-selected")),e.removeClass(g.toThemeProperty("jqx-fill-state-pressed")),e.removeClass(g.toThemeProperty("jqx-grid-cell-hover")),e.removeClass(g.toThemeProperty("jqx-fill-state-hover")),l.customCellStyles)for(var t in l.customCellStyles)e.removeClass(l.customCellStyles[t])}var l=this;if(s(r),t&&s(t),null==this.displayfield)return!0;g.showaggregates&&g.getcolumnaggregateddata&&w.push(g.getcolumnaggregateddata(this.displayfield,this.aggregates,!0,c));var d=g._getexportcolumntype(this);!this.exportable||this.hidden&&!u||(p[this.displayfield]={},p[this.displayfield].text=this.text,p[this.displayfield].width=parseInt(this.width),isNaN(p[this.displayfield].width)&&(p[this.displayfield].width=60),p[this.displayfield].formatString=this.cellsformat,p[this.displayfield].localization=g.gridlocalization,p[this.displayfield].type=d,p[this.displayfield].cellsAlign=this.cellsalign,p[this.displayfield].hidden=!f,p[this.displayfield].displayfield=this.displayfield,F.push(p[this.displayfield])),y="cell"+x;var i,o=A(this.element);if(null==this.element&&(o=A(this.uielement)),_?l._rendered||(o=_,r=I,t=P,i=g.toTP("jqx-grid-cell")+" "+g.toTP("jqx-item"),r[0].className=i,i+=g.toTP("jqx-grid-cell-alt"),t&&(t[0].className=i)):_=o,b="column"+v,"html"==h||"xls"==h||"pdf"==h){function a(e,t,r,s,l,i,o,a,n){m[e]={},null!=t&&0!=t[0].offsetWidth&&0!=t[0].offsetHeight&&(m[e]["font-size"]=t.css("font-size"),m[e]["font-weight"]=t.css("font-weight"),m[e]["font-style"]=t.css("font-style"),m[e]["background-color"]=i._getexportcolor(t.css("background-color")),m[e].color=i._getexportcolor(t.css("color")),m[e]["border-color"]=i._getexportcolor(t.css("border-top-color")),r?m[e]["text-align"]=l.align:(m[e]["text-align"]=l.cellsalign,m[e].formatString=l.cellsformat,m[e].dataType=d),"html"!=h&&"pdf"!=h||(m[e]["border-top-width"]=t.css("border-top-width"),m[e]["border-left-width"]=t.css("border-left-width"),m[e]["border-right-width"]=t.css("border-right-width"),m[e]["border-bottom-width"]=t.css("border-bottom-width"),m[e]["border-top-style"]=t.css("border-top-style"),m[e]["border-left-style"]=t.css("border-left-style"),m[e]["border-right-style"]=t.css("border-right-style"),m[e]["border-bottom-style"]=t.css("border-bottom-style"),r?(0==o&&(m[e]["border-left-width"]=t.css("border-right-width")),m[e]["border-top-width"]=t.css("border-right-width"),m[e]["border-bottom-width"]=t.css("border-bottom-width")):0==o&&(m[e]["border-left-width"]=t.css("border-right-width")),m[e].height=t.css("height")),!l.exportable||l.hidden&&!u||(1==a?(p[l.displayfield].customCellStyles||(p[l.displayfield].customCellStyles=new Array),p[l.displayfield].customCellStyles[n]=e):r?p[l.displayfield].style=e:s?p[l.displayfield].cellAltStyle=e:p[l.displayfield].cellStyle=e))}if(a(b,o,!0,!1,this,g,e),v++,a(y,r,!1,!1,this,g,e),g.altrows&&a(y="cellalt"+x,t,!1,!0,this,g,e),this.customCellStyles){for(var n in l.customCellStyles)r.removeClass(l.customCellStyles[n]);for(var n in l.customCellStyles)r.addClass(l.customCellStyles[n]),a(y+l.customCellStyles[n],r,!1,!1,this,g,e,!0,n),r.removeClass(l.customCellStyles[n])}x++}}),A.each(this.columns.records,function(e){p[this.displayfield]&&(p[this.displayfield].columnsDataFields=F)}),this.showaggregates&&(j=[],T="xls"==h?"_AG":"",q=this.groupable?this.groups.length:0,this.rowdetails&&q++,"checkbox"===this.selectionmode&&q++,0<w.length&&(A.each(this.columns.records,function(e){if(this.aggregates)for(var t,r,s,l=0;l<this.aggregates.length;l++){j[l]||(j[l]={}),j[l]&&(t=g._getaggregatename(this.aggregates[l]),r=g._getaggregatetype(this.aggregates[l]),(s=w[e-q])&&(j[l][this.displayfield]=T+t+": "+s[r]))}}),A.each(this.columns.records,function(e){for(var t=0;t<j.length;t++)null==j[t][this.displayfield]&&(j[t][this.displayfield]=T)})),A.each(j,function(){c.push(this)}));var z=this,N=A.jqx.dataAdapter.ArrayExporter(c,p,m);if(null==e){this._renderrows(this.virtualsizeinfo);var O=N.exportTo(h);return this.showaggregates&&A.each(j,function(){c.pop(this)}),setTimeout(function(){z.exporting=!1},50),this.hScrollInstance.setPosition(l),this._renderrows(this.virtualsizeinfo),O}N.exportToFile(h,e,r,s),this.showaggregates&&A.each(j,function(){c.pop(this)}),this._renderrows(this.virtualsizeinfo),setTimeout(function(){z.exporting=!1},50),this.hScrollInstance.setPosition(l),this._renderrows(this.virtualsizeinfo)}else this._exportData("xlsx",e)},_getexportcolor:function(e){var t,r="transparent"==e?"#FFFFFF":e;if(r&&r.toString()||(r="#FFFFFF"),-1==r.toString().indexOf("rgb"))return-1!=r.toString().indexOf("#")&&4==r.toString().length&&(t=r.toString().substring(1,4),r+=t),r;var s=r.split(",");if(-1!=r.toString().indexOf("rgba")){var l=parseInt(s[0].substring(5)),i=parseInt(s[1]),o=parseInt(s[2]),a=parseFloat(s[3].substring(1,4)),n={r:l,g:i,b:o},d=this._rgbToHex(n);return 0==l&&0==i&&0==o&&0==a?"#ffffff":"#"+d}n={r:l=parseInt(s[0].substring(4)),g:i=parseInt(s[1]),b:o=parseInt(s[2].substring(1,4))};return"#"+(d=this._rgbToHex(n))},_rgbToHex:function(e){return this._intToHex(e.r)+this._intToHex(e.g)+this._intToHex(e.b)},_intToHex:function(e){var t=parseInt(e).toString(16);return 1==t.length&&(t="0"+t),t.toUpperCase()},_getexportcolumntype:function(e){var t="string",r=this.source.datafields||(this.source._source?this.source._source.datafields:null);if(r){var s="";if(A.each(r,function(){if(this.name==e.displayfield)return this.type&&(s=this.type),!1}),s)return s}if(null!=e){if(null==this.dataview.cachedrecords)return t;var l=null;if(this.virtualmode)A.each(this.dataview.cachedrecords,function(){return l=this[e.displayfield],!1});else{if(0==this.dataview.cachedrecords.length)return t;if(null!=(l=this.dataview.cachedrecords[0][e.displayfield])&&""==l.toString())return"string"}if(null!=l){if(-1!=e.cellsformat.indexOf("c"))return"number";if(-1!=e.cellsformat.indexOf("n"))return"number";if(-1!=e.cellsformat.indexOf("p"))return"number";if(-1!=e.cellsformat.indexOf("d"))return"date";if(-1!=e.cellsformat.indexOf("y"))return"date";if(-1!=e.cellsformat.indexOf("M"))return"date";if(-1!=e.cellsformat.indexOf("m"))return"date";if(-1!=e.cellsformat.indexOf("t"))return"date";if("boolean"==typeof l)t="boolean";else if(A.jqx.dataFormat.isNumber(l))t="number";else{var i=new Date(l);if("NaN"==i.toString()||"Invalid Date"==i.toString())if(A.jqx.dataFormat){if(null!=(i=A.jqx.dataFormat.tryparsedate(l))){if(i&&i.getFullYear()&&1970==i.getFullYear()&&0==i.getMonth()&&1==i.getDate()){var o=new Number(l);return isNaN(o)?"string":"number"}return"date"}t="string"}else t="string";else t="date"}}}return t}})}(jqxBaseFramework);