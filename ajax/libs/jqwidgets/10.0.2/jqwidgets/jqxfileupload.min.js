!function(h){h.jqx.jqxWidget("jqxFileUpload","",{}),h.extend(h.jqx._jqxFileUpload.prototype,{defineInstance:function(){var e={width:null,height:"auto",uploadUrl:"",fileInputName:"",autoUpload:!1,multipleFilesUpload:!0,accept:null,browseTemplate:"",uploadTemplate:"",cancelTemplate:"",localization:null,renderFiles:null,disabled:!1,rtl:!1,events:["select","remove","uploadStart","uploadEnd"]};return this===h.jqx._jqxFileUpload.prototype||h.extend(!0,this,e),e},createInstance:function(){var e=this;if(void 0===e.host.jqxButton)throw new Error("jqxFileUpload: Missing reference to jqxbuttons.js");e._createFromInput("jqxFileUpload"),h.jqx.browser.msie?h.jqx.browser.version<11&&(e._ieOldWebkit=!0,h.jqx.browser.version<8&&(e._ie7=!0)):h.jqx.browser.webkit&&(e._ieOldWebkit=!0),e._fluidWidth="string"==typeof e.width&&"%"===e.width.charAt(e.width.length-1),e._fluidHeight="string"==typeof e.height&&"%"===e.height.charAt(e.height.length-1),e._render(!0)},_createFromInput:function(e){var t,o,l,i,a=this;"input"==a.element.nodeName.toLowerCase()&&(a.field=a.element,a.field.className&&(a._className=a.field.className),t={title:a.field.title},a.field.id.length?t.id=a.field.id.replace(/[^\w]/g,"_")+"_"+e:t.id=h.jqx.utilities.createId()+"_"+e,(o=h("<div></div>",t))[0].style.cssText=a.field.style.cssText,a.width||(a.width=h(a.field).width()),a.height||(a.height=h(a.field).outerHeight()),h(a.field).hide().after(o),l=a.host.data(),a.host=o,a.host.data(l),a.element=o[0],a.element.id=a.field.id,a.field.id=t.id,a._className&&(a.host.addClass(a._className),h(a.field).removeClass(a._className)),a.field.tabIndex&&(i=a.field.tabIndex,a.field.tabIndex=-1,a.element.tabIndex=i))},_render:function(e){var a=this;a._setSize(),a._addClasses(),!0===e?a._appendElements():a._removeHandlers(),a._addHandlers(),a._ie7&&(a._borderAndPadding("width",a.host),"auto"!==a.height&&a._borderAndPadding("height",a.host)),h.jqx.utilities.resize(a.host,null,!0),h.jqx.utilities.resize(a.host,function(){if(a._fluidWidth){a._ie7&&(a.host.css("width",a.width),a._borderAndPadding("width",a.host));for(var e=0;e<a._fileRows.length;e++){var t=a._fileRows[e],o=t.fileRow;a._ie7&&(o.css("width","100%"),a._borderAndPadding("width",o)),a.renderFiles||a._setMaxWidth(t)}if(a.rtl&&a._ieOldWebkit)for(var l=0;l<a._forms.length;l++){var i=a._browseButton.position();a._forms[l].form.css({left:i.left,top:i.top})}}a._ie7&&a._fluidHeight&&(a.host.css("height",a.height),a._borderAndPadding("height",a.host))})},render:function(){this._render(!1)},refresh:function(e){!0!==e&&this._render(!1)},destroy:function(){var e=this;e.cancelAll(),e._removeHandlers(!0),e.host.remove()},browse:function(){var e;h.jqx.browser.msie&&h.jqx.browser.version<10||(!0===(e=this).multipleFilesUpload||!1===e.multipleFilesUpload&&0===e._fileRows.length)&&e._forms[e._forms.length-1].fileInput.click()},_uploadFile:function(e){var t=this;0===t._uploadQueue.length&&t._uploadQueue.push(e),t.renderFiles||(e.uploadFile.add(e.cancelFile).hide(),e.loadingElement.show()),e.fileInput.attr("name",t.fileInputName),t._raiseEvent("2",{file:e.fileName}),e.form[0].submit(),t._fileObjectToRemove=e},uploadFile:function(e){var t=this._fileRows[e];void 0!==t&&this._uploadFile(t)},uploadAll:function(){var e=this;if(0<e._fileRows.length){for(var t=e._fileRows.length-1;0<=t;t--)e._uploadQueue.push(e._fileRows[t]);e._uploadFile(e._fileRows[0])}},cancelFile:function(e){this._removeSingleFileRow(this._fileRows[e])},cancelAll:function(){var e=this;if(0<e._fileRows.length){for(var t=0;t<e._fileRows.length;t++)e._removeFileRow(e._fileRows[t]);setTimeout(function(){e._browseButton.css("margin-bottom",0)},400),e._fileRows.length=0,e._hideButtons(!0)}},propertyChangedHandler:function(i,e,t,o){var l=i.element.id;if("localization"===e)return!o.browseButton||t&&o.browseButton===t.browseButton||(i._browseButton.text(o.browseButton),i._browseButton.jqxButton({width:"auto"})),!o.uploadButton||t&&o.uploadButton===t.uploadButton||(i._uploadButton.text(o.uploadButton),i._uploadButton.jqxButton({width:"auto"})),!o.cancelButton||t&&o.cancelButton===t.cancelButton||(i._cancelButton.text(o.cancelButton),i._cancelButton.jqxButton({width:"auto"})),void(i.renderFiles||(!o.uploadFileTooltip||t&&o.uploadFileTooltip===t.uploadFileTooltip||h("#"+l+" .jqx-file-upload-file-upload").attr("title",o.uploadFileTooltip),!o.uploadFileTooltip||t&&o.cancelFileTooltip===t.cancelFileTooltip||h("#"+l+" .jqx-file-upload-file-cancel").attr("title",o.cancelFileTooltip)));if(o!==t)switch(e){case"width":if(i.host.css("width",o),i._ie7){i._borderAndPadding("width",i.host);for(var a=0;a<i._fileRows.length;a++){var d=i._fileRows[a].fileRow;d.css("width","100%"),i._borderAndPadding("width",d)}}return void(i._fluidWidth="string"==typeof o&&"%"===o.charAt(o.length-1));case"height":return i.host.css("height",o),i._ie7&&i._borderAndPadding("height",i.host),void(i._fluidHeight="string"==typeof o&&"%"===o.charAt(o-1));case"uploadUrl":for(var n=0;n<i._forms.length;n++)i._forms[n].form.attr("action",o);return;case"accept":for(var r=0;r<i._forms.length;r++)i._forms[r].fileInput.attr("accept",o);return;case"theme":return h.jqx.utilities.setTheme(t,o,i.host),i._browseButton.jqxButton({theme:o}),i._uploadButton.jqxButton({theme:o}),void i._cancelButton.jqxButton({theme:o});case"browseTemplate":return void i._browseButton.jqxButton({template:o});case"uploadTemplate":return void i._uploadButton.jqxButton({template:o});case"cancelTemplate":return void i._cancelButton.jqxButton({template:o});case"disabled":return i._browseButton.jqxButton({disabled:o}),i._uploadButton.jqxButton({disabled:o}),i._cancelButton.jqxButton({disabled:o}),void(!0===o?i.host.addClass(i.toThemeProperty("jqx-fill-state-disabled")):i.host.removeClass(i.toThemeProperty("jqx-fill-state-disabled")));case"rtl":return void function(e){var t=e?"addClass":"removeClass";i._browseButton[t](i.toThemeProperty("jqx-file-upload-button-browse-rtl")),i._cancelButton[t](i.toThemeProperty("jqx-file-upload-button-cancel-rtl")),i._uploadButton[t](i.toThemeProperty("jqx-file-upload-button-upload-rtl")),h.jqx.browser.msie&&8<h.jqx.browser.version&&i._uploadButton[t](i.toThemeProperty("jqx-file-upload-button-upload-rtl-ie"));for(var o=0;o<i._fileRows.length;o++){var l=i._fileRows[o];l.fileNameContainer[t](i.toThemeProperty("jqx-file-upload-file-name-rtl")),l.cancelFile[t](i.toThemeProperty("jqx-file-upload-file-cancel-rtl")),l.uploadFile[t](i.toThemeProperty("jqx-file-upload-file-upload-rtl")),l.loadingElement[t](i.toThemeProperty("jqx-file-upload-loading-element-rtl"))}}(o)}},_raiseEvent:function(e,t){void 0===t&&(t={owner:null});var o=this.events[e];t.owner=this;var l=new h.Event(o);return l.owner=this,l.args=t,l.preventDefault&&l.preventDefault(),this.host.trigger(l)},_setSize:function(){var e=this;e.host.css("width",e.width),e.host.css("height",e.height)},_borderAndPadding:function(e,t){var o="width"===e?parseInt(t.css("border-left-width"),10)+parseInt(t.css("border-right-width"),10)+parseInt(t.css("padding-left"),10)+parseInt(t.css("padding-right"),10):parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10)+parseInt(t.css("padding-top"),10)+parseInt(t.css("padding-bottom"),10);t.css(e,t[e]()-o)},_addClasses:function(){var e=this;e.host.addClass(e.toThemeProperty("jqx-widget jqx-widget-content jqx-rc-all jqx-file-upload")),!0===e.disabled&&e.host.addClass(e.toThemeProperty("jqx-fill-state-disabled"))},_appendElements:function(){var e=this,t="Browse",o=90,l="Upload All",i=90,a="Cancel All",d=90,n=e.element.id;e.localization&&(e.localization.browseButton&&(t=e.localization.browseButton,o="auto"),e.localization.uploadButton&&(l=e.localization.uploadButton,i="auto"),e.localization.cancelButton&&(a=e.localization.cancelButton,d="auto")),e._browseButton=h('<button id="'+n+'BrowseButton" class="'+e.toThemeProperty("jqx-file-upload-button-browse")+'">'+t+"</button>"),e.host.append(e._browseButton),e._browseButton.jqxButton({theme:e.theme,width:o,template:e.browseTemplate,disabled:e.disabled}),e._browseButton.after('<div style="clear: both;"></div>'),e._bottomButtonsContainer=h('<div class="'+e.toThemeProperty("jqx-file-upload-buttons-container")+'"></div>'),e.host.append(e._bottomButtonsContainer),e._uploadButton=h('<button id="'+n+'UploadButton" class="'+e.toThemeProperty("jqx-file-upload-button-upload")+'">'+l+"</button>"),e._bottomButtonsContainer.append(e._uploadButton),e._uploadButton.jqxButton({theme:e.theme,width:i,template:e.uploadTemplate,disabled:e.disabled}),e._cancelButton=h('<button id="'+n+'CancelButton" class="'+e.toThemeProperty("jqx-file-upload-button-cancel")+'">'+a+"</button>"),e._bottomButtonsContainer.append(e._cancelButton),e._cancelButton.jqxButton({theme:e.theme,width:d,template:e.cancelTemplate,disabled:e.disabled}),e._bottomButtonsContainer.after('<div style="clear: both;"></div>'),e.rtl&&(e._browseButton.addClass(e.toThemeProperty("jqx-file-upload-button-browse-rtl")),e._cancelButton.addClass(e.toThemeProperty("jqx-file-upload-button-cancel-rtl")),e._uploadButton.addClass(e.toThemeProperty("jqx-file-upload-button-upload-rtl")),h.jqx.browser.msie&&8<h.jqx.browser.version&&e._uploadButton.addClass(e.toThemeProperty("jqx-file-upload-button-upload-rtl-ie"))),e._uploadIframe=h('<iframe name="'+n+'Iframe" class="'+e.toThemeProperty("jqx-file-upload-iframe")+'" src=""></iframe>'),e.host.append(e._uploadIframe),e._iframeInitialized=!1,e._uploadQueue=[],e._forms=[],e._addFormAndFileInput(),e._fileRows=[]},_addFormAndFileInput:function(){var l=this,i=l.element.id,a=h('<form class="'+l.toThemeProperty("jqx-file-upload-form")+'" action="'+l.uploadUrl+'" target="'+i+'Iframe" method="post" enctype="multipart/form-data"></form>');l.host.append(a);var e,t,o,d,n=h('<input type="file" class="'+l.toThemeProperty("jqx-file-upload-file-input")+'" />');l.accept&&n.attr("accept",l.accept),a.append(n),l._ieOldWebkit&&(e=l._browseButton.position(),t=l._browseButton.outerWidth(),o=l._browseButton.outerHeight(),d=l.rtl&&l._ie7?12:0,a.css({left:e.left-d,top:e.top,width:t,height:o}),a.addClass(l.toThemeProperty("jqx-file-upload-form-ie9")),n.addClass(l.toThemeProperty("jqx-file-upload-file-input-ie9")),l.addHandler(a,"mouseenter.jqxFileUpload"+i,function(){l._browseButton.addClass(l.toThemeProperty("jqx-fill-state-hover"))}),l.addHandler(a,"mouseleave.jqxFileUpload"+i,function(){l._browseButton.removeClass(l.toThemeProperty("jqx-fill-state-hover"))}),l.addHandler(a,"mousedown.jqxFileUpload"+i,function(){l._browseButton.addClass(l.toThemeProperty("jqx-fill-state-pressed"))}),l.addHandler(h(document),"mouseup.jqxFileUpload"+i,function(){l._browseButton.hasClass("jqx-fill-state-pressed")&&l._browseButton.removeClass(l.toThemeProperty("jqx-fill-state-pressed"))})),l.addHandler(n,"change.jqxFileUpload"+i,function(){var e=-1!==(e=this.value).indexOf("fakepath")?e.slice(12):e.slice(e.lastIndexOf("\\")+1),t=h.jqx.browser.msie&&h.jqx.browser.version<10?"IE9 and earlier do not support getting the file size.":this.files[0].size,o=l._addFileRow(e,a,n,t);1===l._fileRows.length&&(l._browseButton.css("margin-bottom","10px"),l._hideButtons(!1)),l._ieOldWebkit&&(l.removeHandler(a,"mouseenter.jqxFileUpload"+i),l.removeHandler(a,"mouseleave.jqxFileUpload"+i),l.removeHandler(a,"mousedown.jqxFileUpload"+i)),l._addFormAndFileInput(),l.removeHandler(n,"change.jqxFileUpload"+i),!0===l.autoUpload&&l._uploadFile(o)}),!0===l._ieOldWebkit&&l.addHandler(n,"click.jqxFileUpload"+i,function(e){!1===l.multipleFilesUpload&&0<l._fileRows.length&&e.preventDefault()}),l._forms.push({form:a,fileInput:n})},_addFileRow:function(e,t,o,l){var i,a,d,n,r=this,s="Cancel",u="Upload File",p=h('<div class="'+r.toThemeProperty("jqx-widget-content jqx-rc-all jqx-file-upload-file-row")+'"></div>');0===r._fileRows.length?r._browseButton.after(p):r._fileRows[r._fileRows.length-1].fileRow.after(p),r.renderFiles?p.html(r.renderFiles(e)):(i=h('<div class="'+r.toThemeProperty("jqx-widget-header jqx-rc-all jqx-file-upload-file-name")+'">'+e+"</div>"),p.append(i),r.localization&&(r.localization.cancelFileTooltip&&(s=r.localization.cancelFileTooltip),r.localization.uploadFileTooltip&&(u=r.localization.uploadFileTooltip)),d=h('<div class="'+r.toThemeProperty("jqx-widget-header jqx-rc-all jqx-file-upload-file-cancel")+'" title="'+s+'"><div class="'+r.toThemeProperty("jqx-icon-close jqx-file-upload-icon")+'"></div></div>'),p.append(d),n=h('<div class="'+r.toThemeProperty("jqx-widget-header jqx-rc-all jqx-file-upload-file-upload")+'" title="'+u+'"><div class="'+r.toThemeProperty("jqx-icon-arrow-up jqx-file-upload-icon jqx-file-upload-icon-upload")+'"></div></div>'),p.append(n),a=h('<div class="'+r.toThemeProperty("jqx-file-upload-loading-element")+'"></div>'),p.append(a),r.rtl&&(i.addClass(r.toThemeProperty("jqx-file-upload-file-name-rtl")),d.addClass(r.toThemeProperty("jqx-file-upload-file-cancel-rtl")),n.addClass(r.toThemeProperty("jqx-file-upload-file-upload-rtl")),a.addClass(r.toThemeProperty("jqx-file-upload-loading-element-rtl"))),r._setMaxWidth({fileNameContainer:i,uploadFile:n,cancelFile:d})),r._ie7&&(r._borderAndPadding("width",p),r._borderAndPadding("height",p),r.renderFiles||(r._borderAndPadding("height",i),r._borderAndPadding("height",n),r._borderAndPadding("height",d)));var c={fileRow:p,fileNameContainer:i,fileName:e,uploadFile:n,cancelFile:d,loadingElement:a,form:t,fileInput:o,index:r._fileRows.length};return r._addFileHandlers(c),r._fileRows.push(c),r._raiseEvent("0",{file:e,size:l}),c},_setMaxWidth:function(e){var t=e.cancelFile.outerWidth(!0)+e.uploadFile.outerWidth(!0),o=this._ie7?6:0,l=this.host.width()-parseInt(this.host.css("padding-left"),10)-parseInt(this.host.css("padding-right"),10)-t-o-7;e.fileNameContainer.css("max-width",l)},_addFileHandlers:function(e){var t,o=this;o.renderFiles||(t=o.element.id,o.addHandler(e.uploadFile,"mouseenter.jqxFileUpload"+t,function(){!1===o.disabled&&e.uploadFile.addClass(o.toThemeProperty("jqx-fill-state-hover"))}),o.addHandler(e.uploadFile,"mouseleave.jqxFileUpload"+t,function(){!1===o.disabled&&e.uploadFile.removeClass(o.toThemeProperty("jqx-fill-state-hover"))}),o.addHandler(e.uploadFile,"click.jqxFileUpload"+t,function(){!1===o.disabled&&o._uploadFile(e)}),o.addHandler(e.cancelFile,"mouseenter.jqxFileUpload"+t,function(){!1===o.disabled&&e.cancelFile.addClass(o.toThemeProperty("jqx-fill-state-hover"))}),o.addHandler(e.cancelFile,"mouseleave.jqxFileUpload"+t,function(){!1===o.disabled&&e.cancelFile.removeClass(o.toThemeProperty("jqx-fill-state-hover"))}),o.addHandler(e.cancelFile,"click.jqxFileUpload"+t,function(){!1===o.disabled&&o._removeSingleFileRow(e)}))},_removeSingleFileRow:function(e){var t=this;if(t._removeFileRow(e),t._fileRows.splice(e.index,1),0===t._fileRows.length)setTimeout(function(){t._browseButton.css("margin-bottom",0)},400),t._hideButtons(!0);else for(var o=0;o<t._fileRows.length;o++)t._fileRows[o].index=o},_removeFileRow:function(e){var t=this,o=t.element.id;t.renderFiles||(t.removeHandler(e.uploadFile,"mouseenter.jqxFileUpload"+o),t.removeHandler(e.uploadFile,"mouseleave.jqxFileUpload"+o),t.removeHandler(e.uploadFile,"click.jqxFileUpload"+o),t.removeHandler(e.cancelFile,"mouseenter.jqxFileUpload"+o),t.removeHandler(e.cancelFile,"mouseleave.jqxFileUpload"+o),t.removeHandler(e.cancelFile,"click.jqxFileUpload"+o)),e.fileRow.fadeOut(function(){e.fileRow.remove(),e.form.remove()}),t._raiseEvent("1",{file:e.fileName})},_hideButtons:function(e){!0===e?this._bottomButtonsContainer.fadeOut():this._bottomButtonsContainer.fadeIn()},_addHandlers:function(){var t=this,e=t.element.id;t._ieOldWebkit||t.addHandler(t._browseButton,"click.jqxFileUpload"+e,function(){t.browse()}),t.addHandler(t._uploadButton,"click.jqxFileUpload"+e,function(){t.uploadAll()}),t.addHandler(t._cancelButton,"click.jqxFileUpload"+e,function(){t.cancelAll()}),t.addHandler(t._uploadIframe,"load.jqxFileUpload"+e,function(){var e;(h.jqx.browser.chrome||h.jqx.browser.webkit)&&(t._iframeInitialized=!0),!1===t._iframeInitialized?t._iframeInitialized=!0:(e=t._uploadIframe.contents().find("body").html(),0<t._uploadQueue.length&&t._raiseEvent("3",{file:t._uploadQueue[t._uploadQueue.length-1].fileName,response:e}),t._fileObjectToRemove&&(t._removeSingleFileRow(t._fileObjectToRemove),t._fileObjectToRemove=null),t._uploadQueue.pop(),0<t._uploadQueue.length&&t._uploadFile(t._uploadQueue[t._uploadQueue.length-1]))})},_removeHandlers:function(e){var t,o=this,l=o.element.id;o.removeHandler(o._browseButton,"click.jqxFileUpload"+l),o.removeHandler(o._uploadButton,"click.jqxFileUpload"+l),o.removeHandler(o._cancelButton,"click.jqxFileUpload"+l),o.removeHandler(o._uploadIframe,"load.jqxFileUpload"+l),!0===e&&(t=o._forms[o._forms.length-1],o.removeHandler(t.fileInput,"change.jqxFileUpload"+l),o._ieOldWebkit&&(o.removeHandler(t.form,"mouseenter.jqxFileUpload"+l),o.removeHandler(t.form,"mouseleave.jqxFileUpload"+l),o.removeHandler(t.form,"mousedown.jqxFileUpload"+l),o.removeHandler(h("body"),"mouseup.jqxFileUpload"+l)))}})}(jqxBaseFramework);