!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).immer={})}(this,function(e){"use strict";var t,r="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),n="undefined"!=typeof Map,a="undefined"!=typeof Set,o="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,s=r?Symbol.for("immer-nothing"):((t={})["immer-nothing"]=!0,t),i=r?Symbol.for("immer-draftable"):"__$immer_draftable",l=r?Symbol.for("immer-state"):"__$immer_state",f="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",u={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},19:"plugin not loaded",20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e}};function d(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=u[e],o=a?"function"==typeof a?a.apply(null,r):a:"unknown error nr: "+e;throw new Error("[Immer] "+o)}var c=0,p=1,_=2,h=3,P=0,w=1,O=4,j=5,z=2,x=3;function v(e){return!!e&&!!e[l]}function y(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[i]||!!e.constructor[i]||k(e)||F(e))}var b="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,g=Object.getOwnPropertyDescriptors||function(t){var r={};return b(t).forEach(function(e){r[e]=Object.getOwnPropertyDescriptor(t,e)}),r};function S(r,n,t){void 0===t&&(t=!1),A(r)===c?(t?Object.keys:b)(r).forEach(function(e){t&&"symbol"==typeof e||n(e,r[e],r)}):r.forEach(function(e,t){return n(t,e,r)})}function A(e){var t=e[l];return t?3<t.type_?t.type_-4:t.type_:Array.isArray(e)?p:k(e)?_:F(e)?h:c}function M(e,t){return A(e)===_?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function D(e,t){return A(e)===_?e.get(t):e[t]}function m(e,t,r){var n=A(e);n===_?e.set(t,r):n===h?(e.delete(t),e.add(r)):e[t]=r}function E(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function k(e){return n&&e instanceof Map}function F(e){return a&&e instanceof Set}function I(e){return e.copy_||e.base_}function R(e){if(Array.isArray(e))return e.slice();var t=g(e);delete t[l];for(var r=b(t),n=0;n<r.length;n++){var a=r[n],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function N(e,t){W(e)||v(e)||!y(e)||(1<A(e)&&(e.set=e.add=e.clear=e.delete=T),Object.freeze(e),t&&S(e,function(e,t){return N(t,!0)},!0))}function T(){d(2)}function W(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}var C,U={};function K(e){var t=U[e];return t||d(18,e),t}function J(e,t){U[e]=t}function L(){return C||d(0),C}function $(e,t){t&&(K("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function G(e){q(e),e.drafts_.forEach(H),e.drafts_=null}function q(e){e===C&&(C=e.parent_)}function B(e){return C={drafts_:[],parent_:C,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function H(e){var t=e[l];t.type_===P||t.type_===w?t.revoke_():t.revoked_=!0}function Q(e,t){t.unfinalizedDrafts_=t.drafts_.length;var r=t.drafts_[0],n=void 0!==e&&e!==r;return t.immer_.useProxies_||K("ES5").willFinalizeES5_(t,e,n),n?(r[l].modified_&&(G(t),d(4)),y(e)&&(e=V(t,e),t.parent_||Y(t,e)),t.patches_&&K("Patches").generateReplacementPatches_(r[l],e,t.patches_,t.inversePatches_)):e=V(t,r,[]),G(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==s?e:void 0}function V(r,n,a){if(W(n))return n;var o,i=n[l];return i?i.scope_!==r?n:i.modified_?(i.finalized_||(i.finalized_=!0,i.scope_.unfinalizedDrafts_--,o=i.type_===O||i.type_===j?i.copy_=R(i.draft_):i.copy_,S(i.type_===x?new Set(o):o,function(e,t){return X(r,i,o,e,t,a)}),Y(r,o,!1),a&&r.patches_&&K("Patches").generatePatches_(i,a,r.patches_,r.inversePatches_)),i.copy_):(Y(r,i.base_,!0),i.base_):(S(n,function(e,t){return X(r,i,n,e,t,a)},!0),n)}function X(e,t,r,n,a,o){if(a===r&&d(5),v(a)){var i=V(e,a,o&&t&&t.type_!==x&&!M(t.assigned_,n)?o.concat(n):void 0);if(m(r,n,i),!v(i))return;e.canAutoFreeze_=!1}if(y(a)&&!W(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;V(e,a),t&&t.scope_.parent_||Y(e,a)}}function Y(e,t,r){void 0===r&&(r=!1),e.immer_.autoFreeze_&&e.canAutoFreeze_&&N(t,r)}var Z={get:function(e,t){if(t===l)return e;var r,n,a,o=I(e);if(!M(o,t))return r=e,(a=re(o,t))?"value"in a?a.value:null===(n=a.get)||void 0===n?void 0:n.call(r.draft_):void 0;var i=o[t];return!e.finalized_&&y(i)&&i===te(e.base_,t)?(ae(e),e.copy_[t]=ie(e.scope_.immer_,i,e)):i},has:function(e,t){return t in I(e)},ownKeys:function(e){return Reflect.ownKeys(I(e))},set:function(e,t,r){var n=re(I(e),t);if(null!=n&&n.set)return n.set.call(e.draft_,r),!0;if(e.assigned_[t]=!0,!e.modified_){if(E(r,te(I(e),t))&&(void 0!==r||M(e.base_,t)))return!0;ae(e),ne(e)}return e.copy_[t]=r,!0},deleteProperty:function(e,t){return void 0!==te(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,ae(e),ne(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor:function(e,t){var r=I(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:e.type_!==w||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){d(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base_)},setPrototypeOf:function(){d(12)}},ee={};function te(e,t){var r=e[l];return(r?I(r):e)[t]}function re(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function ne(e){e.modified_||(e.modified_=!0,e.parent_&&ne(e.parent_))}function ae(e){e.copy_||(e.copy_=R(e.base_))}S(Z,function(e,t){ee[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ee.deleteProperty=function(e,t){return isNaN(parseInt(t))&&d(13),Z.deleteProperty.call(this,e[0],t)},ee.set=function(e,t,r){return"length"!==t&&isNaN(parseInt(t))&&d(14),Z.set.call(this,e[0],t,r,e[0])};var oe=function(){function e(e){this.useProxies_=o,this.autoFreeze_=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,o,t){if("function"==typeof e&&"function"!=typeof o){var i=o;o=e;var u=this;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,n=new Array(1<r?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return u.produce(e,function(e){return o.call.apply(o,[t,e].concat(n))})}}var r;if("function"!=typeof o&&d(6),void 0!==t&&"function"!=typeof t&&d(7),y(e)){var n=B(this),a=ie(this,e,void 0),c=!0;try{r=o(a),c=!1}finally{(c?G:q)(n)}return"undefined"!=typeof Promise&&r instanceof Promise?r.then(function(e){return $(n,t),Q(e,n)},function(e){throw G(n),e}):($(n,t),Q(r,n))}if(!e||"object"!=typeof e){if((r=o(e))===s)return;return void 0===r&&(r=e),this.autoFreeze_&&N(r,!0),r}d(21,e)},t.produceWithPatches=function(a,e){var r,n,o=this;return"function"==typeof a?function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o.produceWithPatches(e,function(e){return a.apply(void 0,[e].concat(r))})}:[this.produce(a,e,function(e,t){r=e,n=t}),r,n]},t.createDraft=function(e){y(e)||d(8),v(e)&&(e=ue(e));var t=B(this),r=ie(this,e,void 0);return r[l].isManual_=!0,q(t),r},t.finishDraft=function(e,t){var r=e&&e[l];r&&r.isManual_||d(9),r.finalized_&&d(10);var n=r.scope_;return $(n,t),Q(void 0,n)},t.setAutoFreeze=function(e){this.autoFreeze_=e},t.setUseProxies=function(e){e&&!o&&d(20),this.useProxies_=e},t.applyPatches=function(e,t){for(var r=t.length-1;0<=r;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var a=K("Patches").applyPatches_;return v(e)?a(e,t):this.produce(e,function(e){return a(e,t.slice(r+1))})},e}();function ie(e,t,r){var n=k(t)?K("MapSet").proxyMap_(t,r):F(t)?K("MapSet").proxySet_(t,r):e.useProxies_?function(e,t){var r=Array.isArray(e),n={type_:r?w:P,scope_:t?t.scope_:L(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,o=Z;r&&(a=[n],o=ee);var i=Proxy.revocable(a,o),u=i.revoke,c=i.proxy;return n.draft_=c,n.revoke_=u,c}(t,r):K("ES5").createES5Proxy_(t,r);return(r?r.scope_:L()).drafts_.push(n),n}function ue(e){return v(e)||d(22,e),function r(e){if(!y(e))return e;var n=e[l];var a;var t=A(e);if(n){if(!n.modified_&&(n.type_<4||!K("ES5").hasChanges_(n)))return n.base_;n.finalized_=!0,a=ce(e,t),n.finalized_=!1}else a=ce(e,t);S(a,function(e,t){n&&D(n.base_,e)===t||m(a,e,r(t))});return t===h?new Set(a):a}(e)}function ce(e,t){switch(t){case _:return new Map(e);case h:return Array.from(e)}return R(e)}function se(){var n={};function c(r,e){var t=n[r];return t?t.enumerable=e:n[r]=t={configurable:!0,enumerable:e,get:function(){var e=this[l];return i(e),Z.get(e,r)},set:function(e){var t=this[l];i(t),Z.set(t,r,e)}},t}function a(e){for(var t=e.length-1;0<=t;t--){var r=e[t][l];if(!r.modified_)switch(r.type_){case j:p(r)&&ne(r);break;case O:o(r)&&ne(r)}}}function o(e){for(var t=e.base_,r=e.draft_,n=b(r),a=n.length-1;0<=a;a--){var o=n[a];if(o!==l){var i=t[o];if(void 0===i&&!M(t,o))return!0;var u=r[o],c=u&&u[l];if(c?c.base_!==i:!E(u,i))return!0}}var s=!!t[l];return n.length!==b(t).length+(s?0:1)}function p(e){var t=e.draft_;if(t.length!==e.base_.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}function i(e){e.revoked_&&d(3,JSON.stringify(I(e)))}J("ES5",{createES5Proxy_:function(e,t){var r=Array.isArray(e),n=function(e,t){if(e){for(var r=new Array(t.length),n=0;n<t.length;n++)Object.defineProperty(r,""+n,c(n,!0));return r}var a=g(t);delete a[l];for(var o=b(a),i=0;i<o.length;i++){var u=o[i];a[u]=c(u,e||!!a[u].enumerable)}return Object.create(Object.getPrototypeOf(t),a)}(r,e),a={type_:r?j:O,scope_:t?t.scope_:L(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:n,copy_:null,revoked_:!1,isManual_:!1};return Object.defineProperty(n,l,{value:a,writable:!0}),n},willFinalizeES5_:function(e,t,r){r?v(t)&&t[l].scope_===e&&a(e.drafts_):(e.patches_&&function t(e){if(!e||"object"!=typeof e)return;var r=e[l];if(!r)return;var n=r.base_,a=r.draft_,o=r.assigned_,i=r.type_;if(i===O)S(a,function(e){e!==l&&(void 0!==n[e]||M(n,e)?o[e]||t(a[e]):(o[e]=!0,ne(r)))}),S(n,function(e){void 0!==a[e]||M(a,e)||(o[e]=!1,ne(r))});else if(i===j){if(p(r)&&(ne(r),o.length=!0),a.length<n.length)for(var u=a.length;u<n.length;u++)o[u]=!1;else for(var c=n.length;c<a.length;c++)o[c]=!0;for(var s=Math.min(a.length,n.length),f=0;f<s;f++)void 0===o[f]&&t(a[f])}}(e.drafts_[0]),a(e.drafts_))},hasChanges_:function(e){return(e.type_===O?o:p)(e)}})}function fe(){var y="replace",b="add",g="remove";function s(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(s);if(k(e))return new Map(Array.from(e.entries()).map(function(e){return[e[0],s(e[1])]}));if(F(e))return new Set(Array.from(e).map(s));var t=Object.create(Object.getPrototypeOf(e));for(var r in e)t[r]=s(e[r]);return t}function m(e){return v(e)?s(e):e}J("Patches",{applyPatches_:function(c,e){return e.forEach(function(e){for(var t=e.path,r=e.op,n=c,a=0;a<t.length-1;a++)"object"!=typeof(n=D(n,t[a]))&&d(15,t.join("/"));var o=A(n),i=s(e.value),u=t[t.length-1];switch(r){case y:switch(o){case _:return n.set(u,i);case h:d(16);default:return n[u]=i}case b:switch(o){case p:return n.splice(u,0,i);case _:return n.set(u,i);case h:return n.add(i);default:return n[u]=i}case g:switch(o){case p:return n.splice(u,1);case _:return n.delete(u);case h:return n.delete(e.value);default:return delete n[u]}default:d(17,r)}}),c},generatePatches_:function(e,t,r,n){switch(e.type_){case P:case O:case z:return l=t,d=r,_=n,h=(p=e).base_,v=p.copy_,void S(p.assigned_,function(e,t){var r,n=D(h,e),a=D(v,e),o=t?M(h,e)?y:b:g;n===a&&o===y||(r=l.concat(e),d.push(o===g?{op:o,path:r}:{op:o,path:r,value:a}),_.push(o===b?{op:g,path:r}:o===g?{op:b,path:r,value:m(n)}:{op:y,path:r,value:m(n)}))});case j:case w:return function(e,t,r,n){var a=e.base_,o=e.assigned_,i=e.copy_;{var u,c;i.length<a.length&&(a=(u=[i,a])[0],i=u[1],r=(c=[n,r])[0],n=c[1])}for(var s=0;s<a.length;s++){var f;o[s]&&i[s]!==a[s]&&(f=t.concat([s]),r.push({op:y,path:f,value:m(i[s])}),n.push({op:y,path:f,value:m(a[s])}))}for(var p=a.length;p<i.length;p++){var l=t.concat([p]);r.push({op:b,path:l,value:m(i[p])})}a.length<i.length&&n.push({op:y,path:t.concat(["length"]),value:a.length})}(e,t,r,n);case x:return o=t,i=r,u=n,c=(a=e).base_,s=a.copy_,f=0,c.forEach(function(e){var t;s.has(e)||(t=o.concat([f]),i.push({op:g,path:t,value:e}),u.unshift({op:b,path:t,value:e})),f++}),f=0,void s.forEach(function(e){var t;c.has(e)||(t=o.concat([f]),i.push({op:b,path:t,value:e}),u.unshift({op:g,path:t,value:e})),f++})}var a,o,i,u,c,s,f,p,l,d,_,h,v},generateReplacementPatches_:function(e,t,r,n){r.push({op:y,path:[],value:t}),n.push({op:y,path:[],value:e.base_})}})}function pe(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=(r.prototype=t.prototype,new r)}var a=function(){function e(e,t){return this[l]={type_:z,parent_:t,scope_:t?t.scope_:L(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:e,draft_:this,isManual_:!1,revoked_:!1},this}r(e,Map);var t=e.prototype;return Object.defineProperty(t,"size",{get:function(){return I(this[l]).size}}),t.has=function(e){return I(this[l]).has(e)},t.set=function(e,t){var r=this[l];return c(r),I(r).has(e)&&I(r).get(e)===t||(o(r),ne(r),r.assigned_.set(e,!0),r.copy_.set(e,t),r.assigned_.set(e,!0)),this},t.delete=function(e){if(!this.has(e))return!1;var t=this[l];return c(t),o(t),ne(t),t.assigned_.set(e,!1),t.copy_.delete(e),!0},t.clear=function(){var e=this[l];return c(e),o(e),ne(e),e.assigned_=new Map,e.copy_.clear()},t.forEach=function(n,a){var o=this;I(this[l]).forEach(function(e,t,r){n.call(a,o.get(t),t,o)})},t.get=function(e){var t=this[l];c(t);var r=I(t).get(e);if(t.finalized_||!y(r))return r;if(r!==t.base_.get(e))return r;var n=ie(t.scope_.immer_,r,t);return o(t),t.copy_.set(e,n),n},t.keys=function(){return I(this[l]).keys()},t.values=function(){var t=this,r=this.keys(),e={};return e[f]=function(){return t.values()},e.next=function(){var e=r.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},t.entries=function(){var r=this,n=this.keys(),e={};return e[f]=function(){return r.entries()},e.next=function(){var e=n.next();if(e.done)return e;var t=r.get(e.value);return{done:!1,value:[e.value,t]}},e},t[f]=function(){return this.entries()},e}();function o(e){e.copy_||(e.assigned_=new Map,e.copy_=new Map(e.base_))}var i=function(){function e(e,t){return this[l]={type_:x,parent_:t,scope_:t?t.scope_:L(),modified_:!1,finalized_:!1,copy_:void 0,base_:e,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1},this}r(e,Set);var t=e.prototype;return Object.defineProperty(t,"size",{get:function(){return I(this[l]).size}}),t.has=function(e){var t=this[l];return c(t),t.copy_?!!t.copy_.has(e)||!(!t.drafts_.has(e)||!t.copy_.has(t.drafts_.get(e))):t.base_.has(e)},t.add=function(e){var t=this[l];return c(t),this.has(e)||(u(t),ne(t),t.copy_.add(e)),this},t.delete=function(e){if(!this.has(e))return!1;var t=this[l];return c(t),u(t),ne(t),t.copy_.delete(e)||!!t.drafts_.has(e)&&t.copy_.delete(t.drafts_.get(e))},t.clear=function(){var e=this[l];return c(e),u(e),ne(e),e.copy_.clear()},t.values=function(){var e=this[l];return c(e),u(e),e.copy_.values()},t.entries=function(){var e=this[l];return c(e),u(e),e.copy_.entries()},t.keys=function(){return this.values()},t[f]=function(){return this.values()},t.forEach=function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()},e}();function u(r){r.copy_||(r.copy_=new Set,r.base_.forEach(function(e){var t;y(e)?(t=ie(r.scope_.immer_,e,r),r.drafts_.set(e,t),r.copy_.add(t)):r.copy_.add(e)}))}function c(e){e.revoked_&&d(3,JSON.stringify(I(e)))}J("MapSet",{proxyMap_:function(e,t){return new a(e,t)},proxySet_:function(e,t){return new i(e,t)}})}var le=new oe,de=le.produce,_e=le.produceWithPatches.bind(le),he=le.setAutoFreeze.bind(le),ve=le.setUseProxies.bind(le),ye=le.applyPatches.bind(le),be=le.createDraft.bind(le),ge=le.finishDraft.bind(le);e.Immer=oe,e.applyPatches=ye,e.castDraft=function(e){return e},e.castImmutable=function(e){return e},e.createDraft=be,e.current=ue,e.default=de,e.enableAllPlugins=function(){se(),pe(),fe()},e.enableES5=se,e.enableMapSet=pe,e.enablePatches=fe,e.finishDraft=ge,e.immerable=i,e.isDraft=v,e.isDraftable=y,e.nothing=s,e.original=function(e){return v(e)||d(23,e),e[l].base_},e.produce=de,e.produceWithPatches=_e,e.setAutoFreeze=he,e.setUseProxies=ve,Object.defineProperty(e,"__esModule",{value:!0})});