!function(e,t){var o;"function"==typeof define&&define.amd?define(["exports","../../globals/js/settings","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/evented-state","../../globals/js/mixins/handles","../../globals/js/misc/event-matches","../../globals/js/misc/on"],t):"undefined"!=typeof exports?t(exports,require("../../globals/js/settings"),require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/evented-state"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/event-matches"),require("../../globals/js/misc/on")):(t(o={},e.settings,e.mixin,e.createComponent,e.initComponentBySearch,e.eventedState,e.handles,e.eventMatches,e.on),e.dataTable=o)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,l,r,c,s,i,u,d,p){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function h(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(l){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,o,a,n=m(l);return t=r?(e=m(this).constructor,Reflect.construct(n,arguments,e)):n.apply(this,arguments),o=this,!(a=t)||"object"!==b(a)&&"function"!=typeof a?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(o):a}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,l=t(l),r=t(r),c=t(c),s=t(s),i=t(i),u=t(u),d=t(d),p=t(p);function y(e){return Array.prototype.slice.call(e)}var o=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(n,(0,r.default)(c.default,s.default,i.default,u.default));var e,t,o,a=v(n);function n(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=a.call(this,e,t))._sortToggle=function(e){var o=e.element,t=e.previousValue;y(r.tableHeaders).forEach(function(e){var t=e.querySelector(r.options.selectorTableSort);null!==t&&t!==o&&(t.classList.remove(r.options.classTableSortActive),t.classList.remove(r.options.classTableSortAscending))}),t?"ascending"===t?(o.dataset.previousValue="descending",o.classList.add(r.options.classTableSortActive),o.classList.remove(r.options.classTableSortAscending)):"descending"===t&&(o.removeAttribute("data-previous-value"),o.classList.remove(r.options.classTableSortActive),o.classList.remove(r.options.classTableSortAscending)):(o.dataset.previousValue="ascending",o.classList.add(r.options.classTableSortActive),o.classList.add(r.options.classTableSortAscending))},r._selectToggle=function(e){var t=e.element,o=t.checked;r.state.checkboxCount+=o?1:-1,r.countEl.textContent=r.state.checkboxCount,t.parentNode.parentNode.classList.toggle(r.options.classTableSelected),r._actionBarToggle(0<r.state.checkboxCount)},r._selectAllToggle=function(e){var o=e.element.checked,t=y(r.element.querySelectorAll(r.options.selectorCheckbox));r.state.checkboxCount=o?t.length-1:0,t.forEach(function(e){e.checked=o;var t=e.parentNode.parentNode;o&&t?t.classList.add(r.options.classTableSelected):t.classList.remove(r.options.classTableSelected)}),r._actionBarToggle(0<r.state.checkboxCount),r.batchActionEl&&(r.countEl.textContent=r.state.checkboxCount)},r._actionBarCancel=function(){var e=y(r.element.querySelectorAll(r.options.selectorCheckbox));y(r.element.querySelectorAll(r.options.selectorTableSelected)).forEach(function(e){e.classList.remove(r.options.classTableSelected)}),e.forEach(function(e){e.checked=!1}),r.state.checkboxCount=0,r._actionBarToggle(!1),r.batchActionEl&&(r.countEl.textContent=r.state.checkboxCount)},r._actionBarToggle=function(e){var t;e?(r.batchActionEl.dataset.active=!0,r.batchActionEl.classList.add(r.options.classActionBarActive)):r.batchActionEl&&(r.batchActionEl.dataset.active=!1,r.batchActionEl.classList.remove(r.options.classActionBarActive)),r.batchActionEl&&(t=r.manage((0,p.default)(r.batchActionEl,"transitionend",function(e){t=t&&r.unmanage(t).release(),e.target.matches(r.options.selectorActions)&&("false"===r.batchActionEl.dataset.active?r.batchActionEl.setAttribute("tabIndex",-1):r.batchActionEl.setAttribute("tabIndex",0))})))},r._rowExpandToggle=function(e){var t,o=e.element,a=e.forceExpand,n=o.closest(r.options.eventParentContainer);(null!=a?a:void 0===o.dataset.previousValue||"expanded"===o.dataset.previousValue)?(o.dataset.previousValue="collapsed",n.classList.add(r.options.classExpandableRow)):(n.classList.remove(r.options.classExpandableRow),o.dataset.previousValue="expanded",(t=r.element.querySelector(r.options.selectorExpandHeader))&&(t.dataset.previousValue="expanded"))},r._rowExpandToggleAll=function(e){var t=e.element,o=void 0===t.dataset.previousValue||"expanded"===t.dataset.previousValue;t.dataset.previousValue=o?"collapsed":"expanded";var a=r.element.querySelectorAll(r.options.selectorExpandCells);Array.prototype.forEach.call(a,function(e){r._rowExpandToggle({element:e,forceExpand:o})})},r._expandableHoverToggle=function(e){var t=(0,d.default)(e,r.options.selectorChildRow);t&&t.previousElementSibling.classList.toggle(r.options.classExpandableRowHover,"mouseover"===e.type)},r._toggleState=function(e,t){var o=e.dataset,a=o.label?o.label:"",n=o.previousValue?o.previousValue:"";r.changeState({group:o.event,element:e,label:a,previousValue:n,initialEvt:t})},r._keydownHandler=function(e){var t=r.element.querySelector(r.options.selectorToolbarSearchContainer),o=(0,d.default)(e,r.options.selectorSearchMagnifier),a=t.classList.contains(r.options.classToolbarSearchActive);27===e.which&&r._actionBarCancel(),t&&o&&13===e.which&&r.activateSearch(t),a&&27===e.which&&r.deactivateSearch(t,e)},r.refreshRows=function(){var e,t,o,a=y(r.element.querySelectorAll(r.options.selectorExpandCells)),n=y(r.element.querySelectorAll(r.options.selectorExpandableRows)),l=y(r.element.querySelectorAll(r.options.selectorParentRows));0<r.parentRows.length?(e=l.filter(function(t){return!r.parentRows.some(function(e){return e===t})}),0<n.length&&(t=e.map(function(e){return e.nextElementSibling}),o=[].concat(f(y(r.expandableRows)),f(y(t))),r.expandableRows=o)):0<n.length&&(r.expandableRows=n),r.expandCells=a,r.parentRows=l},r.container=e.parentNode,r.toolbarEl=r.element.querySelector(r.options.selectorToolbar),r.batchActionEl=r.element.querySelector(r.options.selectorActions),r.countEl=r.element.querySelector(r.options.selectorCount),r.cancelEl=r.element.querySelector(r.options.selectorActionCancel),r.tableHeaders=r.element.querySelectorAll("th"),r.tableBody=r.element.querySelector(r.options.selectorTableBody),r.expandCells=[],r.expandableRows=[],r.parentRows=[],r.refreshRows(),r.manage((0,p.default)(r.element,"mouseover",r._expandableHoverToggle)),r.manage((0,p.default)(r.element,"mouseout",r._expandableHoverToggle)),r.manage((0,p.default)(r.element,"click",function(e){var t=(0,d.default)(e,r.options.eventTrigger),o=r.element.querySelector(r.options.selectorToolbarSearchContainer);t&&r._toggleState(t,e),o&&r._handleDocumentClick(e)})),r.manage((0,p.default)(r.element,"keydown",r._keydownHandler)),r.state={checkboxCount:0},r}return e=n,o=[{key:"options",get:function(){var e=l.default.prefix;return{selectorInit:"[data-table]",selectorToolbar:".".concat(e,"--table--toolbar"),selectorActions:".".concat(e,"--batch-actions"),selectorCount:"[data-items-selected]",selectorActionCancel:".".concat(e,"--batch-summary__cancel"),selectorCheckbox:".".concat(e,"--checkbox"),selectorExpandHeader:"th.".concat(e,"--table-expand"),selectorExpandCells:"td.".concat(e,"--table-expand"),selectorExpandableRows:".".concat(e,"--expandable-row"),selectorParentRows:".".concat(e,"--parent-row"),selectorChildRow:"[data-child-row]",selectorTableBody:"tbody",selectorTableSort:".".concat(e,"--table-sort"),selectorTableSelected:".".concat(e,"--data-table--selected"),selectorToolbarSearchContainer:".".concat(e,"--toolbar-search-container-expandable"),selectorSearchMagnifier:".".concat(e,"--search-magnifier"),selectorSearchInput:".".concat(e,"--search-input"),classExpandableRow:"".concat(e,"--expandable-row"),classExpandableRowHidden:"".concat(e,"--expandable-row--hidden"),classExpandableRowHover:"".concat(e,"--expandable-row--hover"),classTableSortAscending:"".concat(e,"--table-sort--ascending"),classTableSortActive:"".concat(e,"--table-sort--active"),classToolbarSearchActive:"".concat(e,"--toolbar-search-container-active"),classActionBarActive:"".concat(e,"--batch-actions--active"),classTableSelected:"".concat(e,"--data-table--selected"),eventBeforeExpand:"data-table-beforetoggleexpand",eventAfterExpand:"data-table-aftertoggleexpand",eventBeforeExpandAll:"data-table-beforetoggleexpandall",eventAfterExpandAll:"data-table-aftertoggleexpandall",eventBeforeSort:"data-table-beforetogglesort",eventAfterSort:"data-table-aftertogglesort",eventTrigger:"[data-event]",eventParentContainer:"[data-parent-row]"}}}],(t=[{key:"_handleDocumentClick",value:function(e){var t=this.element.querySelector(this.options.selectorToolbarSearchContainer),o=(0,d.default)(e,this.options.selectorSearchMagnifier),a=t.classList.contains(this.options.classToolbarSearchActive);t&&o&&this.activateSearch(t),a&&this.deactivateSearch(t,e)}},{key:"activateSearch",value:function(e){var t=e.querySelector(this.options.selectorSearchInput);e.classList.add(this.options.classToolbarSearchActive),t.focus()}},{key:"deactivateSearch",value:function(e,t){var o=e.querySelector(this.options.selectorSearchMagnifier),a=e.querySelector(this.options.selectorSearchInput),n=o.querySelector("svg");0===a.value.length&&t.target!==a&&t.target!==o&&t.target!==n&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus()),27===t.which&&t.target===a&&(e.classList.remove(this.options.classToolbarSearchActive),o.focus())}},{key:"_changeState",value:function(e,t){this[this.constructor.eventHandlers[e.group]](e),t()}}])&&h(e.prototype,t),o&&h(e,o),n.components=new WeakMap,n.eventHandlers={expand:"_rowExpandToggle",expandAll:"_rowExpandToggleAll",sort:"_sortToggle",select:"_selectToggle","select-all":"_selectAllToggle","action-bar-cancel":"_actionBarCancel"},n}();e.default=o});