!function(e,t){var n;"function"==typeof define&&define.amd?define(["exports","../../globals/js/misc/mixin","../../globals/js/mixins/create-component","../../globals/js/mixins/init-component-by-search","../../globals/js/mixins/handles","../../globals/js/misc/on","../../globals/js/settings","../../globals/js/misc/event-matches"],t):"undefined"!=typeof exports?t(exports,require("../../globals/js/misc/mixin"),require("../../globals/js/mixins/create-component"),require("../../globals/js/mixins/init-component-by-search"),require("../../globals/js/mixins/handles"),require("../../globals/js/misc/on"),require("../../globals/js/settings"),require("../../globals/js/misc/event-matches")):(t(n={},e.mixin,e.createComponent,e.initComponentBySearch,e.handles,e.on,e.settings,e.eventMatches),e.headerSubmenu=n)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,c,a,i,s,l,u,f){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,c=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(c){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,n,r,o=E(c);return t=a?(e=E(this).constructor,Reflect.construct(o,arguments,e)):o.apply(this,arguments),n=this,!(r=t)||"object"!==d(r)&&"function"!=typeof r?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(n):r}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,c=t(c),a=t(a),i=t(i),s=t(s),l=t(l),u=t(u),f=t(f);var h=function(){return Array.prototype.forEach}(),n=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,(0,c.default)(a.default,i.default,s.default));var e,t,n,r=_(o);function o(e,t){var u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(u=r.call(this,e,t))._getAction=function(e){if((0,f.default)(e,u.options.selectorFlyoutMenu))return u.constructor.actions.DELEGATE_TO_FLYOUT_MENU;switch(e.type){case"keydown":return{32:u.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,13:u.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS,27:u.constructor.actions.CLOSE_SUBMENU}[e.which];case"click":return(0,f.default)(e,u.options.selectorItem)?u.constructor.actions.CLOSE_SUBMENU:null;case"blur":case"focusout":return u.element.contains(e.relatedTarget)?null:u.constructor.actions.CLOSE_SUBMENU;case"mouseenter":return u.constructor.actions.OPEN_SUBMENU;case"mouseleave":return u.constructor.actions.CLOSE_SUBMENU;default:return null}},u._getNewState=function(e){var t="true"===u.element.querySelector(u.options.selectorTrigger).getAttribute(u.options.attribExpanded);switch(e){case u.constructor.actions.CLOSE_SUBMENU:return!1;case u.constructor.actions.OPEN_SUBMENU:return!0;case u.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:return!t;default:return t}},u._setState=function(e){var t=e.shouldBeExpanded,n=e.shouldFocusOnOpen;u.element.querySelector(u.options.selectorTrigger).setAttribute(u.options.attribExpanded,t),h.call(u.element.querySelectorAll(u.options.selectorItem),function(e){e.tabIndex=t?0:-1}),t&&n&&u.element.querySelector(u.options.selectorItem).focus()},u.getCurrentNavigation=function(){var e=u.element.ownerDocument.activeElement;return e.nodeType===Node.ELEMENT_NODE&&e.matches(u.options.selectorItem)?e:null},u.navigate=function(a){for(var e,i=(e=u.element.querySelectorAll(u.options.selectorItem),Array.prototype.slice.call(e)),t=u.getCurrentNavigation()||u.element.querySelector(u.options.selectorItemSelected),n=function(e){var t,n,r,o,c=Math.max(i.indexOf(e)+a,-1);return i[r=c,o=i.length,t=r-(r<o?0:o),n=i.length,t+(0<=t?0:n)]},r=n(t);r&&r!==t;r=n(r))if(!r.matches(u.options.selectorItemHidden)&&!r.parentNode.matches(u.options.selectorItemHidden)&&!r.matches(u.options.selectorItemSelected)){r.focus();break}},u._handleEvent=function(e){var t,n;!u.element.querySelector(u.options.selectorTrigger)||(t=u._getAction(e))&&(n=u._getNewState(t),u._setState({shouldBeExpanded:n}))},u._handleKeyDown=function(e){var t=u.element.querySelector(u.options.selectorTrigger);if(t){var n=u._getAction(e);switch(32===e.which&&e.preventDefault(),n){case u.constructor.actions.DELEGATE_TO_FLYOUT_MENU:break;case u.constructor.actions.CLOSE_SUBMENU:var r=u._getNewState(n);u._setState({shouldBeExpanded:r});break;case u.constructor.actions.TOGGLE_SUBMENU_WITH_FOCUS:var o=u._getNewState(n);u._setState({shouldBeExpanded:o,shouldFocusOnOpen:!0});break;default:if("true"===t.getAttribute(u.options.attribExpanded)){var c={38:u.constructor.NAVIGATE.BACKWARD,40:u.constructor.NAVIGATE.FORWARD}[e.which];switch(e.which){case 35:e.preventDefault();var a=u.element.querySelectorAll(u.options.selectorItem),i=a[a.length-1];i&&i.focus();break;case 36:e.preventDefault();var s=p(u.element.querySelectorAll(u.options.selectorItem),1)[0];s&&s.focus();break;case 38:case 40:u.navigate(c),e.preventDefault()}}}}};var n="onfocusout"in window;return u.manage((0,l.default)(u.element,n?"focusout":"blur",u._handleEvent,!n)),u.manage((0,l.default)(u.element,"mouseenter",u._handleEvent)),u.manage((0,l.default)(u.element,"mouseleave",u._handleEvent)),u.manage((0,l.default)(u.element,"click",u._handleEvent)),u.manage((0,l.default)(u.element,"keydown",u._handleKeyDown)),u}return e=o,n=[{key:"options",get:function(){var e=u.default.prefix;return{selectorInit:"[data-header-submenu]",selectorTrigger:".".concat(e,"--header__menu-title"),selectorItem:".".concat(e,"--header__menu .").concat(e,"--header__menu-item"),attribExpanded:"aria-expanded"}}}],(t=null)&&m(e.prototype,t),n&&m(e,n),o.components=new WeakMap,o.actions={CLOSE_SUBMENU:"CLOSE_SUBMENU",OPEN_SUBMENU:"OPEN_SUBMENU",TOGGLE_SUBMENU_WITH_FOCUS:"TOGGLE_SUBMENU_WITH_FOCUS",DELEGATE_TO_FLYOUT_MENU:"DELEGATE_TO_FLYOUT_MENU"},o.NAVIGATE={BACKWARD:-1,FORWARD:1},o}();e.default=n});