!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(_d){"use strict";try{(function(){_d=_d&&Object.prototype.hasOwnProperty.call(_d,"default")?_d.default:_d;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=_||self;function k(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function x(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),R=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=S.navigator;if(Y){var $=Y.userAgent;if($){K=$;break t}}K=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=k;var rt,it,ot=Q(K,"Opera"),st=Q(K,"Trident")||Q(K,"MSIE"),ut=Q(K,"Edge"),at=ut||st,ht=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),ct=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ft(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=K,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=S.document&&st&&(ft()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",k,e),S.removeEventListener("test",k,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},j(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),At=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++At,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function kt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ft(r),e&&e[Nt]?e.wa(n,r,x(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[Nt]?t.va(e,n,x(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=x(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=jt(t);if(h||(t[xt]=h=new kt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[xt]=null)):St(t)))}function Vt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(mt)return Mt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}function jt(t){return(t=t[xt])instanceof kt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==D(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Bt(){q.call(this),this.c=new kt(this),(this.J=this).C=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Bt,q),Bt.prototype[Nt]=!0,(A=Bt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=x(i)?!!i.capture:!!i,r=Ft(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=S.JSON.stringify;function Ht(){this.b=this.a=null}var Kt,Wt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Xt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then(Zt)}),$t||(Kt(),$t=!0),Jt.add(t,e)}Ht.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Ht;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var r=Wt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function te(t,e){Bt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Ya,this),this.g=U()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==D(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(te,Bt),(A=te.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},A.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=q),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){q.call(this),this.b=t,this.a={}}j(he,q);var ce=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),le(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Bt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(ge,Et),j(we,Et),j(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ae(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}Ae.prototype.a=null;var ke,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Pe(){Et.call(this,"d")}function xe(){Et.call(this,"c")}function Oe(){}function Re(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Le,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Pe,Et),j(xe,Et),j(Oe,Ae),ke=new Oe;var Le=45e3,Ce={},Ve={};function Me(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=U(),qe(t),t.l=Je(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ve:(o=Number(i.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>i.length?Ve:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ve){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Ge(t))}function qe(t){t.U=U()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(V(t.Ua,t),e)}function Be(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||An(p.b,t)))if(p.I=t.N,!t.C&&An(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Qn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(V(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ar(p,11)}else if(!t.C&&p.a!=t||or(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(_n(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=U()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Sn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Be(f),qe(f)),o.a=c):er(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||ar(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ar(p,7):Wn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Re.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Be(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,h=this.m,c=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Ge(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,u)}this.I?(je(this,e,i),at&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),He(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,qe(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Ge(this)}}}catch(t){}var a,h,c,f,l,p,d},A.Va=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),je(this,t,e),this.b&&4!=t&&qe(this)))},A.cancel=function(){this.A=!0,ze(this)},A.Ua=function(){this.o=null;var t,e,n=U();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Ge(this)):Fe(this,this.U-n)},(A=We.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Qe(this),this.a.concat()},A.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},A.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new $e(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=un(e,ln)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,fn=/[#\?]/g,ln=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new We,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Xe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=G(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function kn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(){}function Pn(){this.a=new Dn}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=kn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var On=S.JSON.parse;function Rn(t){Bt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}j(Rn,Bt);var Ln="",Cn=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Fn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&(!t.s[1]||4!=Gn(t)||2!=t.X()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Wn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Re(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=U(),qe(e)),hr(t)}function Qn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Xn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&$n(t)}function $n(t){Tn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,r=Je(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new Re(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Me(n,r,e)}function Zn(t,n){t.f&&Ke({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ke(t,function(t,e){var n=t;x(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(V(t.Aa,t),ur(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Re(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,Ue(n,t)}function or(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!An(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ee(i)),$n(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(V(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ar(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=V(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ze(n,"https"),on(n)),i=n.toString(),o=r,u=new pe,S.Image?((s=new Image).onload=M(xn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=M(xn,u,s,"TestLoadImage: error",!1,o),s.onabort=M(xn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(xn,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Xn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==kn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof $e?Je(r):new $e(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=S.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new $e(null,void 0),o&&Ze(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Ka)).F=t.C,e}function lr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Bt.call(this),this.a=new Kn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){xe.call(this),this.status=1}function gr(t){this.a=t}(A=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(ke),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new We(this.headers);r&&Ke(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Rn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ta())},A.Ta=function(){qn(this)},A.X=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Kn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Re(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=Je(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&zn(i,this.i,r),_n(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Me(n,i,null)):Me(n,i,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},A.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(V(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),ir(this))},A.Ra=function(){null!=this.m&&(this.m=null,Qn(this),nr(this),be())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(A=lr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},j(dr,Bt),(A=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),$n(t)},A.close=function(){Wn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,dr.S.G.call(this)},j(yr,Pe),j(vr,xe),j(gr,lr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(Se.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.X,Rn.prototype.getResponseJson=Rn.prototype.Na,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ne,WebChannel:Se,XhrIo:Rn},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Er=mr.EventType,Ir=mr.WebChannel,Tr=mr.XhrIo,Nr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _r=new c("@firebase/firestore");function Sr(){return _r.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.DEBUG&&(e=n.map(xr),_r.debug.apply(_r,i(["Firestore (7.17.2): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.ERROR&&(e=n.map(xr),_r.error.apply(_r,i(["Firestore (7.17.2): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.WARN&&(e=n.map(xr),_r.warn.apply(_r,i(["Firestore (7.17.2): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Or(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.2) INTERNAL ASSERTION FAILED: "+t;throw Dr(e),new Error(e)}function Rr(t){t||Or()}var Lr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t){return t+"\0"}function jr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var qr=(Object.defineProperty(Fr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fr.prototype.isEqual=function(t){return t instanceof Fr&&t.projectId===this.projectId&&t.database===this.database},Fr.prototype.o=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Fr);function Fr(t,e){this.projectId=t,this.database=e||"(default)"}function Br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hr,Kr,Wr,Qr=(fi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},fi.prototype.has=function(t){return void 0!==this.get(t)},fi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},fi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},fi.prototype.forEach=function(u){Gr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},fi.prototype._=function(){return zr(this.l)},fi),Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(ci,Wr=Error),ci),$r=(hi.now=function(){return hi.fromMillis(Date.now())},hi.fromDate=function(t){return hi.fromMillis(t.getTime())},hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new hi(e,1e6*(t-1e3*e))},hi.prototype.toDate=function(){return new Date(this.toMillis())},hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hi.prototype.T=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hi),Jr=(ai.I=function(t){return new ai(t)},ai.min=function(){return new ai(new $r(0,0))},ai.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.A=function(){return this.timestamp},ai),Zr=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.P(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ui.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ui.prototype.v=function(){return this.segments[this.offset]},ui.prototype.S=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype._=function(){return 0===this.length},ui.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ui.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Kr=Zr),si.prototype.g=function(t,e,n){return new si(t,e,n)},si.prototype.N=function(){return this.F().join("/")},si.prototype.toString=function(){return this.N()},si.k=function(t){if(0<=t.indexOf("//"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new si(t.split("/").filter(function(t){return 0<t.length}))},si.$=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Hr=Zr),oi.prototype.g=function(t,e,n){return new oi(t,e,n)},oi.M=function(t){return ei.test(t)},oi.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.M(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.N()},oi.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},oi.L=function(){return new oi(["__name__"])},oi.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.$=function(){return new oi([])},oi),ri=(ii.B=function(t){return new ii(ti.k(t).V(5))},ii.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.P(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.P=function(t,e){return ti.P(t.path,e.path)},ii.W=function(t){return t.length%2==0},ii.j=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Hr&&Hr.apply(this,arguments)||this}function si(){return null!==Kr&&Kr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&Or(),void 0===n?n=t.length-e:n>t.length-e&&Or(),this.segments=t,this.offset=e,this.R=n}function ai(t){this.timestamp=t}function hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ci(t,e){var n=this;return(n=Wr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function fi(t,e){this.h=t,this.u=e,this.l={}}function li(t){return null==t}function pi(t){return-0===t&&1/t==-1/0}function di(t){return"number"==typeof t&&Number.isInteger(t)&&!pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yi(t,e,n,r,i,o,s)}function gi(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),li(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=zu(n.startAt)),n.endAt&&(e+="|ub:",e+=zu(n.endAt)),n.K=e),n.K}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ku(t.startAt,e.startAt)&&Ku(t.endAt,e.endAt)}function wi(t){return ri.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=(Ei.fromBase64String=function(t){return new Ei(atob(t))},Ei.fromUint8Array=function(t){return new Ei(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ei.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ei.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ei.prototype.H=function(){return 2*this.G.length},Ei.prototype.o=function(t){return Vr(this.G,t.G)},Ei.prototype.isEqual=function(t){return this.G===t.G},Ei);function Ei(t){this.G=t}function Ii(t){this.count=t}bi.Y=new bi("");var Ti,Ni,Ai=(_i.prototype.Z=function(t){return new _i(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_i.prototype.tt=function(t,e){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_i.prototype.et=function(t){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},_i);function _i(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=bi.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Xr.OK:return Or(),0;case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return 1;default:return Or(),0}}function ki(t){if(void 0===t)return Dr("GRPC error has no .code"),Xr.UNKNOWN;switch(t){case Ti.OK:return Xr.OK;case Ti.CANCELLED:return Xr.CANCELLED;case Ti.UNKNOWN:return Xr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Xr.INTERNAL;case Ti.UNAVAILABLE:return Xr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Xr.NOT_FOUND;case Ti.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case Ti.ABORTED:return Xr.ABORTED;case Ti.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case Ti.DATA_LOSS:return Xr.DATA_LOSS;default:return Or()}}(Ni=Ti=Ti||{})[Ni.OK=0]="OK",Ni[Ni.CANCELLED=1]="CANCELLED",Ni[Ni.UNKNOWN=2]="UNKNOWN",Ni[Ni.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ni[Ni.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ni[Ni.NOT_FOUND=5]="NOT_FOUND",Ni[Ni.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ni[Ni.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ni[Ni.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ni[Ni.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ni[Ni.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ni[Ni.ABORTED=10]="ABORTED",Ni[Ni.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ni[Ni.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ni[Ni.INTERNAL=13]="INTERNAL",Ni[Ni.UNAVAILABLE=14]="UNAVAILABLE",Ni[Ni.DATA_LOSS=15]="DATA_LOSS";var Di=(Li.prototype.nt=function(t,e){return new Li(this.P,this.root.nt(t,e,this.P).copy(null,null,xi.st,null,null))},Li.prototype.remove=function(t){return new Li(this.P,this.root.remove(t,this.P).copy(null,null,xi.st,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype._=function(){return this.root._()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.it=function(){return this.root.it()},Li.prototype.rt=function(){return this.root.rt()},Li.prototype.ot=function(t){return this.root.ot(t)},Li.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.ht=function(t){return this.root.ht(t)},Li.prototype.at=function(){return new Pi(this.root,null,this.P,!1)},Li.prototype.ut=function(t){return new Pi(this.root,t,this.P,!1)},Li.prototype.ct=function(){return new Pi(this.root,null,this.P,!0)},Li.prototype.lt=function(t){return new Pi(this.root,t,this.P,!0)},Li),Pi=(Ri.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ri.prototype.wt=function(){return 0<this.ft.length},Ri.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ri),xi=(Oi.prototype.copy=function(t,e,n,r,i){return new Oi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Oi.prototype._=function(){return!1},Oi.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Oi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Oi.prototype.min=function(){return this.left._()?this:this.left.min()},Oi.prototype.it=function(){return this.min().key},Oi.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Oi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Oi.prototype.It=function(){if(this.left._())return Oi.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Oi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return Oi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Oi.prototype.At=function(){return this.color},Oi.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Oi.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},Oi.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Oi.prototype.Vt=function(){var t=this.copy(null,null,Oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Oi.prototype.Pt=function(){var t=this.copy(null,null,Oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Oi.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Oi.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Oi.prototype.bt=function(){if(this.At()&&this.left.At())throw Or();if(this.right.At())throw Or();var t=this.left.bt();if(t!==this.right.bt())throw Or();return t+(this.At()?0:1)},Oi);function Oi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Oi.RED,this.left=null!=r?r:Oi.EMPTY,this.right=null!=i?i:Oi.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Li(t,e){this.P=t,this.root=e||xi.EMPTY}function Ci(){this.size=0}xi.EMPTY=null,xi.RED=!0,xi.st=!1,xi.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw Or()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.nt=function(t,e,n){return new xi(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype._=function(){return!0},Ci.prototype.ot=function(t){return!1},Ci.prototype.ht=function(t){return!1},Ci.prototype.it=function(){return null},Ci.prototype.rt=function(){return null},Ci.prototype.At=function(){return!1},Ci.prototype.pt=function(){return!0},Ci.prototype.bt=function(){return 0},new Ci);var Vi=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.it()},qi.prototype.last=function(){return this.data.rt()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},qi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},qi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},qi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},qi.prototype.at=function(){return new Mi(this.data.at())},qi.prototype.ut=function(t){return new Mi(this.data.ut(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype._=function(){return this.data._()},qi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},qi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.P);return e.data=t,e},qi),Mi=(ji.prototype.dt=function(){return this.Ft.dt().key},ji.prototype.wt=function(){return this.Ft.wt()},ji),Ui=new Di(ri.P);function ji(t){this.Ft=t}function qi(t){this.P=t,this.data=new Di(this.P)}var Fi=new Di(ri.P),Bi=new Di(ri.P),Gi=new Vi(ri.P);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new Vi(Vr);function Ki(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Wi(t,e){this.targetId=t,this.ee=e}function Qi(t,e,n,r){void 0===n&&(n=bi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Xi=(ao.xt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.Nt.get(t)},ao.prototype.get=function(t){return this.Nt.get(t)},ao.prototype.first=function(){return this.kt.it()},ao.prototype.last=function(){return this.kt.rt()},ao.prototype._=function(){return this.kt._()},ao.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.kt.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.kt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.Nt=t,n.kt=e,n},ao),Yi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.$t.get(e);!n||0!==t.type&&3===n.type?this.$t=this.$t.nt(e,t):3===t.type&&1!==n.type?this.$t=this.$t.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.$t=this.$t.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.$t=this.$t.remove(e):1===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):Or()},uo.prototype.Mt=function(){var n=[];return this.$t.ot(function(t,e){n.push(e)}),n},uo),$i=(so.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Xi.xt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Ji=(oo.Gt=function(t,e){var n=new Map;return n.set(t,Zi.zt(t,e)),new oo(Jr.min(),n,Hi,Ui,zi())},oo),Zi=(io.zt=function(t,e){return new io(bi.Y,e,zi(),zi(),zi())},io),to=(Object.defineProperty(ro.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},ro.prototype.ce=function(){var n=zi(),r=zi(),i=zi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Or()}}),new Zi(this.ie,this.re,n,r,i)},ro.prototype.le=function(){this.oe=!1,this.se=co()},ro.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},ro.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},ro.prototype.de=function(){this.ne+=1},ro.prototype.we=function(){--this.ne},ro.prototype.Te=function(){this.oe=!0,this.re=!0},ro),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof ru?this.ge(r,t.te):t.te instanceof iu&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},no.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Or()}})},no.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},no.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(wi(e=o.target)?0===i?(n=new ri(e.path),this.Ve(r,n,new iu(n,Jr.min()))):Rr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},no.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&wi(r.target)&&(n=new ri(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.Ve(e,n,new iu(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=zi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Ji(i,s,this.Re,this.me,r);return this.me=Ui,this.Ae=ho(),this.Re=new Vi(Vr),t},no.prototype.ge=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.xe(e.key).add(t)))},no.prototype.Ve=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.xe(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},no.prototype.removeTarget=function(t){this.Ie.delete(t)},no.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.$e(t).size+e.Yt.size-e.Xt.size},no.prototype.de=function(t){this.be(t).de()},no.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new to,this.Ie.set(t,e)),e},no.prototype.xe=function(t){var e=this.Ae.get(t);return e||(e=new Vi(Vr),this.Ae=this.Ae.nt(t,e)),e},no.prototype.ve=function(t){var e=null!==this.Ce(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},no.prototype.Se=function(e){var n=this;this.Ie.set(e,new to),this.Ee.$e(e).forEach(function(t){n.Ve(e,t,null)})},no.prototype.ke=function(t,e){return this.Ee.$e(t).has(e)},no);function no(t){this.Ee=t,this.Ie=new Map,this.me=Ui,this.Ae=ho(),this.Re=new Vi(Vr)}function ro(){this.ne=0,this.se=co(),this.ie=bi.Y,this.re=!1,this.oe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function oo(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function uo(){this.$t=new Di(ri.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ri.P(t.key,e.key)}:function(t,e){return ri.P(t.key,e.key)},this.Nt=Fi,this.kt=new Di(this.P)}function ho(){return new Di(ri.P)}function co(){return new Di(ri.P)}function fo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:Or()}function vo(r,i){var t,e,n,o=yo(r);if(o!==yo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Eo(r.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,To(r.bytesValue).isEqual(To(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),r=Io(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Br(t)!==Br(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return Or()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,u,a,h,c,f,l=yo(t),p=yo(e);if(l!==p)return Vr(l,p);switch(l){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Io(t.integerValue||t.doubleValue))<(f=Io(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Vr(Io(n.latitude),Io(r.latitude)))?i:Vr(Io(n.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;var a=mo(n[r[s]],i[o[s]]);if(0!==a)return a}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Or()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Eo(t),r=Eo(e),i=Vr(n.seconds,r.seconds);return 0!==i?i:Vr(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?To(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ri.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Or();var t,e,n}(t)}function Eo(t){if(Rr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e,n=0,r=po.exec(t);Rr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function Ao(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var Po={asc:"ASCENDING",desc:"DESCENDING"},xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oo=function(t,e){this.s=t,this.Oe=e};function Ro(t){return{integerValue:""+t}}function Lo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Co(t,e){return di(e)?Ro(e):Lo(t,e)}function Vo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Uo(t){return Rr(!!t),Jr.I((e=Eo(t),new $r(e.seconds,e.nanos)));var e}function jo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function qo(t){var e=ti.k(t);return Rr(ns(e)),e}function Fo(t,e){return jo(t.s,e.path)}function Bo(t,e){var n=qo(e);return Rr(n.get(1)===t.s.projectId),Rr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ri(Ko(n))}function Go(t,e){return jo(t.s,e)}function zo(t){var e=qo(t);return 4===e.length?ti.$():Ko(e)}function Ho(t){return new ti(["projects",t.s.projectId,"databases",t.s.database]).N()}function Ko(t){return Rr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Wo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Qo(t,e){var n,r,i,o;if(e instanceof Ls)n={update:Wo(t,e.key,e.value)};else if(e instanceof Hs)n={delete:Fo(t,e.key)};else if(e instanceof Cs)n={update:Wo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof qs)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.N(),increment:e.qe};throw Or()})}};else{if(!(e instanceof Ks))return Or();n={verify:Fo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Vo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Or()),n}function Xo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?As.updateTime(Uo(n.updateTime)):void 0!==n.exists?As.exists(n.exists):As.We():As.We();if(t.update){t.update.name;var o=Bo(e,t.update.name),s=new Ws({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Es(r.map(function(t){return ni.q(t)})));return new Cs(o,s,u,i)}return new Ls(o,s,i)}if(t.delete){var a=Bo(e,t.delete);return new Hs(a,i)}if(t.transform){var h=Bo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Rr("REQUEST_TIME"===e.setToServerValue),i=new us):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new as(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ps(r)):"increment"in e?i=new gs(t,e.increment):Or();var o=ni.q(e.fieldPath);return new Is(o,i)}(e,t)});return Rr(!0===i.exists),new qs(h,c)}if(t.verify){var f=Bo(e,t.verify);return new Ks(f,i)}return Or()}function Yo(t,e){return{documents:[Go(t,e.path)]}}function $o(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Go(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,xo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((e=t).field),direction:(n=e.dir,Po[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||li(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Jo(e.endAt)),n}function Jo(t){return{before:t.before,values:t.position}}function Zo(t){var e=!!t.before,n=t.values||[];return new Uu(n,e)}function ts(t){return{fieldPath:t.N()}}function es(t){return ni.q(t.fieldPath)}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function rs(){this.Qe=void 0}function is(t,e){return t instanceof gs?Ao(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var os,ss,us=(n(cs,ss=rs),cs),as=(n(hs,os=rs),hs);function hs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function cs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=rs),ds);function ds(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=rs),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.qe=e,n}function ws(t){return Io(t.integerValue||t.doubleValue)}function bs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=(Ts.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts),Is=function(t,e){this.field=t,this.transform=e};function Ts(t){(this.fields=t).sort(ni.P)}function Ns(t,e){this.version=t,this.transformResults=e}var As=(_s.We=function(){return new _s},_s.exists=function(t){return new _s(void 0,t)},_s.updateTime=function(t){return new _s(t)},Object.defineProperty(_s.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),_s.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},_s);function _s(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}function ks(){}function Ds(t,e,n,r){return t instanceof Ls?function(t,e){if(!Ss(t.Ue,e))return e;var n=xs(e);return new ru(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Cs?function(t,e){if(!Ss(t.Ue,e))return e;var n=xs(e),r=Us(t,e);return new ru(t.key,n,r,{Ke:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Ss(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof ru&&(y=n.field(p.field)),null===y&&r instanceof ru&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof as?fs(i,o):i instanceof ps?ys(i,o):(a=ws(u=is(s=i,o))+ws(s.qe),Ao(u)&&Ao(s.qe)?Ro(a):Lo(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Bs(t,i.data(),o);return new ru(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ss((i=t).Ue,o)?new iu(i.key,Jr.min()):o);var i,o}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof as&&o instanceof as||i instanceof ps&&o instanceof ps?Mr(i.elements,o.elements,vo):i instanceof gs&&o instanceof gs?vo(i.qe,o.qe):i instanceof us&&o instanceof us);var n,r,i,o}))}function xs(t){return t instanceof ru?t.version:Jr.min()}var Os,Rs,Ls=(n(Ms,Rs=ks),Ms),Cs=(n(Vs,Os=ks),Vs);function Vs(t,e,n,r){var i=this;return(i=Os.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Ms(t,e,n){var r=this;return(r=Rs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Us(t,e){return n=t,r=e instanceof ru?e.data():Ws.empty(),i=new Qs(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var js,qs=(n(Fs,js=ks),Fs);function Fs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=As.exists(!0),n}function Bs(t,e,n){for(var r=new Qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Gs,zs,Hs=(n(Js,zs=ks),Js),Ks=(n($s,Gs=ks),$s),Ws=(Ys.empty=function(){return new Ys({mapValue:{}})},Ys.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Ys.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Ys),Qs=(Xs.prototype.set=function(t,e){return this.Ye(t,e),this},Xs.prototype.delete=function(t){return this.Ye(t,null),this},Xs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Xs.prototype.Ge=function(){var t=this.Je(ni.$(),this.He);return null!=t?new Ws(t):this.ze},Xs.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xs);function Xs(t){void 0===t&&(t=Ws.empty()),this.ze=t,this.He=new Map}function Ys(t){this.proto=t}function $s(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Js(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Zs(t,e){this.key=t,this.version=e}var tu,eu,nu,ru=(n(au,nu=Zs),au.prototype.field=function(t){return this.Xe.field(t)},au.prototype.data=function(){return this.Xe},au.prototype.Ze=function(){return this.Xe.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),iu=(n(uu,eu=Zs),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),ou=(n(su,tu=Zs),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su);function su(){return null!==tu&&tu.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=nu.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yr(Xr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var cu=(fu.prototype.rn=function(t){return new fu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},fu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},fu.prototype.hn=function(){return!li(this.limit)&&"F"===this.en},fu.prototype.an=function(){return!li(this.limit)&&"L"===this.en},fu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},fu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},fu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},fu);function fu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function lu(t,e,n,r,i,o,s,u){return new cu(t,e,n,r,i,o,s,u)}function pu(t){return new cu(t)}function du(t){return null!==t.collectionGroup}function yu(t){var e=hu(t,cu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Wu(n)),e.nn.push(new Wu(ni.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Wu(ni.L(),i)))}}return e.nn}function vu(t){var e=hu(t,cu);if(!e.sn)if("F"===e.en)e.sn=vi(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Wu(o.field,s))}var u=e.endAt?new Uu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Uu(e.startAt.position,!e.startAt.before):null;e.sn=vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function gu(t,e,n){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function wu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function bu(t,e){return mi(vu(t),vu(e))&&t.en===e.en}function Eu(t){return gi(vu(t))+"|lt:"+t.en}function Iu(t){return"Query(target="+(n=(e=vu(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+zu(e.startAt)),e.endAt&&(n+=", endAt: "+zu(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Tu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ri.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Hu(e.startAt,yu(e),n))&&(!e.endAt||!Hu(e.endAt,yu(e),n)));var e,n,r,o}function Nu(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.O()?ri.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):Or());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Or()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Au,_u=(n(Su,Au=function(){}),Su.create=function(t,e,n){if(t.O())return"in"===e?new Lu(t,n):new Ru(t,e,n);if(So(n)){if("=="!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Su(t,e,n)}if(ko(n)){if("=="!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Su(t,e,n)}return"array-contains"===e?new Cu(t,n):"in"===e?new Vu(t,n):"array-contains-any"===e?new Mu(t,n):new Su(t,e,n)},Su.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.fn(mo(e,this.value))},Su.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Or()}},Su.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Su);function Su(t,e,n){var r=this;return(r=Au.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,Du,Pu,xu,Ou,Ru=(n(Gu,Ou=_u),Gu.prototype.matches=function(t){var e=ri.P(t.key,this.key);return this.fn(e)},Gu),Lu=(n(Bu,xu=_u),Bu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bu),Cu=(n(Fu,Pu=_u),Fu.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},Fu),Vu=(n(qu,Du=_u),qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},qu),Mu=(n(ju,ku=_u),ju.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},ju),Uu=function(t,e){this.position=t,this.before=e};function ju(t,e){return ku.call(this,t,"array-contains-any",e)||this}function qu(t,e){return Du.call(this,t,"in",e)||this}function Fu(t,e){return Pu.call(this,t,"array-contains",e)||this}function Bu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ri.B(t.referenceValue)}),n}function Gu(t,e,n){var r=this;return(r=Ou.call(this,t,e,n)||this).key=ri.B(n.referenceValue),r}function zu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Hu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?ri.P(ri.B(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ku(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var Wu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Qu=(ca.prototype.wn=function(t,e,n){for(var r,i,o,s=n.Tn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Ls?new ru(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Cs?function(t,e,n){if(!Ss(t.Ue,e))return new ou(t.key,n.version);var r=Us(t,e);return new ru(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof qs?function(t,e,n){if(Rr(null!=n.transformResults),!Ss(t.Ue,e))return new ou(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Rr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof ru&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof as?fs(i,o):i instanceof ps?ys(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Bs(t,r.data(),i);return new ru(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new iu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ca.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ds(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ds(a,e,o,this.dn))}return e},ca.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ca.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},ca.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Ps)&&Mr(this.baseMutations,t.baseMutations,Ps)},ca),Xu=(ha.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new ha(t,e,n,r)},ha),Yu=(aa.prototype.catch=function(t){return this.next(void 0,t)},aa.prototype.next=function(r,i){var o=this;return this.Vn&&Or(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new aa(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},aa.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},aa.prototype.vn=function(t){try{var e=t();return e instanceof aa?e:aa.resolve(e)}catch(t){return aa.reject(t)}},aa.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):aa.resolve(e)},aa.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):aa.reject(e)},aa.resolve=function(n){return new aa(function(t,e){t(n)})},aa.reject=function(n){return new aa(function(t,e){e(n)})},aa.Sn=function(t){return new aa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},aa.Dn=function(t){for(var n=aa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?aa.resolve(t):e()})}(r[e]);return n},aa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},aa),$u=(Object.defineProperty(ua.prototype,"readTime",{get:function(){return this.Nn},set:function(t){this.Nn=t},enumerable:!1,configurable:!0}),ua.prototype.kn=function(t,e){this.xn(),this.readTime=e,this.Cn.set(t.key,t)},ua.prototype.$n=function(t,e){this.xn(),e&&(this.readTime=e),this.Cn.set(t,null)},ua.prototype.Mn=function(t,e){this.xn();var n=this.Cn.get(e);return void 0!==n?Yu.resolve(n):this.On(t,e)},ua.prototype.getEntries=function(t,e){return this.Ln(t,e)},ua.prototype.apply=function(t){return this.xn(),this.Fn=!0,this.qn(t)},ua.prototype.xn=function(){},ua),Ju="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Zu=(sa.prototype.Un=function(t){this.Bn.push(t)},sa.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},sa),ta=(oa.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},oa.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},oa.prototype.Yn=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},oa.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},oa.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=Ui;return e.forEach(function(t,e){e=e||new iu(t,Jr.min()),n=n.nt(t,e)}),n})},oa.prototype.ts=function(t,e,n){return r=e,ri.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):du(e)?this.ns(t,e,n):this.ss(t,e,n);var r},oa.prototype.es=function(t,e){return this.Gn(t,new ri(e)).next(function(t){var e=Fi;return t instanceof ru&&(e=e.nt(t.key,t)),e})},oa.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.Kn.rs(n,s).next(function(t){return Yu.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},oa.prototype.ss=function(e,n,t){var c,f,r=this;return this.Qn.ts(e,n,t).next(function(t){return c=t,r.jn.os(e,n)}).next(function(t){return f=t,r.hs(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Ds(s,a,a,r.dn);c=h instanceof ru?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Tu(n,e)||(c=c.remove(t))}),c})},oa.prototype.hs=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ru&&(h=h.nt(t,e))}),h})},oa),ea=(ia.cs=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ia(t,e.fromCache,n,r)},ia),na=(ra.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ra.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},ra);function ra(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function ia(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function oa(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function sa(){this.Bn=[]}function ua(){this.Cn=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function aa(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function ha(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function ca(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}function fa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}na.ws=-1;var la=(pa.prototype.reset=function(){this.Rs=0},pa.prototype.Vs=function(){this.Rs=this.As},pa.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},pa.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},pa.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},pa.prototype.ps=function(){return(Math.random()-.5)*this.Rs},pa);function pa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function da(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ya(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ya(o)}function ya(t){return t+""}function va(t){var e=t.length;if(Rr(2<=e),2===e)return Rr(""===t.charAt(0)&&""===t.charAt(1)),ti.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Or(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Or()}o=s+2}return new ti(r)}var ga=(Ia.prototype.Cs=function(t,e){return this.Ds.add(e),Yu.resolve()},Ia.prototype.rs=function(t,e){return Yu.resolve(this.Ds.getEntries(e))},Ia),ma=(Ea.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Vi(ti.P),i=!r.has(n);return this.index[e]=r.add(n),i},Ea.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Ea.prototype.getEntries=function(t){return(this.index[t]||new Vi(ti.P)).F()},Ea),wa=(ba.prototype.Cs=function(t,e){var n=this;if(this.Fs.has(e))return Yu.resolve();var r=e.S(),i=e.p();t.Un(function(){n.Fs.add(e)});var o={collectionId:r,parent:da(i)};return Ta(t).put(o)},ba.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ur(i),""],!1,!0);return Ta(t).Ns(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(va(r.parent))}return o})},ba);function ba(){this.Fs=new ma}function Ea(){this.index={}}function Ia(){this.Ds=new ma}function Ta(t){return Ja.ks(t,Ph.store)}var Na=function(t){this.xs=t};function Aa(t,e){if(e.document)return n=t.xs,r=e.document,i=!!e.hasCommittedMutations,o=Bo(n,r.name),s=Uo(r.updateTime),u=new Ws({mapValue:{fields:r.fields}}),new ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ri.j(e.noDocument.path),h=Pa(e.noDocument.readTime);return new iu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ri.j(e.unknownDocument.path),f=Pa(e.unknownDocument.version);return new ou(c,f)}return Or()}function _a(t,e,n){var r,i,o=Sa(n),s=e.key.path.p().F();if(e instanceof ru){var u={name:Fo(r=t.xs,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Vo(r,i.version.A())},a=e.hasCommittedMutations;return new Ah(null,null,u,a,o,s)}if(e instanceof iu){var h=e.key.path.F(),c=Da(e.version),f=e.hasCommittedMutations;return new Ah(null,new Th(h,c),null,f,o,s)}if(e instanceof ou){var l=e.key.path.F(),p=Da(e.version);return new Ah(new Nh(l,p),null,null,!0,o,s)}return Or()}function Sa(t){var e=t.A();return[e.seconds,e.nanoseconds]}function ka(t){var e=new $r(t[0],t[1]);return Jr.I(e)}function Da(t){var e=t.A();return new vh(e.seconds,e.nanoseconds)}function Pa(t){var e=new $r(t.seconds,t.nanoseconds);return Jr.I(e)}function xa(e,t){var n=(t.baseMutations||[]).map(function(t){return Xo(e.xs,t)}),r=t.mutations.map(function(t){return Xo(e.xs,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new Qu(t.batchId,i,n,r)}function Oa(t){var e,n=Pa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Pa(t.lastLimboFreeSnapshotVersion):Jr.min(),i=void 0!==t.query.documents?(Rr(1===(e=t.query).documents.length),vu(pu(zo(e.documents[0])))):function(t){var e,n=zo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Rr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return _u.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return _u.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Or()}}(e)]:void 0!==e.fieldFilter?[(n=e,_u.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Or()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Or():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Wu(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=li(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=Zo(r.startAt));var l=null;return r.endAt&&(l=Zo(r.endAt)),vu(lu(n,o,u,s,c,"F",f,l))}(t.query);return new Ai(i,t.targetId,0,t.lastListenSequenceNumber,n,r,bi.fromBase64String(t.resumeToken))}function Ra(t,e){var n=Da(e.X),r=Da(e.lastLimboFreeSnapshotVersion),i=(wi(e.target)?Yo:$o)(t.xs,e.target),o=e.resumeToken.toBase64();return new Sh(e.targetId,gi(e.target),n,o,e.sequenceNumber,r,i)}var La,Ca=(Va.prototype.kn=function(t,e,n){return Ua(t).put(ja(e),n)},Va.prototype.$n=function(t,e){var n=Ua(t),r=ja(e);return n.delete(r)},Va.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$s(e,t)})},Va.prototype.Mn=function(t,e){var n=this;return Ua(t).get(ja(e)).next(function(t){return n.Ms(t)})},Va.prototype.Os=function(t,e){var n=this;return Ua(t).get(ja(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:qa(t)}:null})},Va.prototype.getEntries=function(t,e){var r=this,i=Ui;return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},Va.prototype.Bs=function(t,e){var r=this,i=Ui,o=new Di(ri.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,qa(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},Va.prototype.qs=function(t,e,i){if(e._())return Yu.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return Ua(t).Qs({range:n},function(t,e,n){for(var r=ri.j(t);s&&ri.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Va.prototype.ts=function(t,i,e){var n,r,o,s=this,u=Fi,a=i.path.length+1,h={};return e.isEqual(Jr.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=Sa(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Ah.collectionReadTimeIndex),Ua(t).Qs(h,function(t,e,n){var r;t.length===a&&(r=Aa(s.serializer,e),i.path.D(r.key.path)?r instanceof ru&&Tu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Va.prototype.Ks=function(t,e){var r=this,i=Ui,o=Sa(e),n=Ua(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:Ah.readTimeIndex,range:s},function(t,e){var n=Aa(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:ka(o)}})},Va.prototype.zs=function(t){var e=Ua(t),r=Jr.min();return e.Qs({index:Ah.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ka(e.readTime)),n.done()}).next(function(){return r})},Va.prototype.Hs=function(t){return new Va.Ys(this,!!t&&t.Js)},Va.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Va.prototype.getMetadata=function(t){return Ma(t).get(_h.key).next(function(t){return Rr(!!t),t})},Va.prototype.$s=function(t,e){return Ma(t).put(_h.key,e)},Va.prototype.Ms=function(t){if(t){var e=Aa(this.serializer,t);return e instanceof iu&&e.version.isEqual(Jr.min())?null:e}return null},Va);function Va(t,e){this.serializer=t,this.Kn=e}function Ma(t){return Ja.ks(t,_h.store)}function Ua(t){return Ja.ks(t,Ah.store)}function ja(t){return t.path.F()}function qa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Or();e=t.noDocument}return JSON.stringify(e).length}function Fa(t,e){var n=this;return(n=La.call(this)||this).Zs=t,n.Js=e,n.ti=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ca.Ys=(n(Fa,La=$u),Fa.prototype.qn=function(s){var u=this,a=[],h=0,c=new Vi(function(t,e){return Vr(t.N(),e.N())});return this.Cn.forEach(function(t,e){var n,r,i,o=u.ti.get(t);e?(n=_a(u.Zs.serializer,e,u.readTime),c=c.add(t.path.p()),r=qa(n),h+=r-o,a.push(u.Zs.kn(s,t,n))):(h-=o,u.Js?(i=_a(u.Zs.serializer,new iu(t,Jr.min()),u.readTime),a.push(u.Zs.kn(s,t,i))):a.push(u.Zs.$n(s,t)))}),c.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,h)),Yu.Sn(a)},Fa.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},Fa.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},Fa);var Ba=(Ha.prototype.next=function(){return this.ei+=2,this.ei},Ha.ni=function(){return new Ha(0)},Ha.si=function(){return new Ha(-1)},Ha),Ga=(za.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new Ba(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},za.prototype.ai=function(t){return this.oi(t).next(function(t){return Jr.I(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},za.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},za.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},za.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},za.prototype.di=function(t,e){return this._i(t,e)},za.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Ka(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return Rr(0<t.targetCount),--t.targetCount,n.hi(e,t)})},za.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Ka(r).Qs(function(t,e){var n=Oa(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return Yu.Sn(a)}).next(function(){return u})},za.prototype.pe=function(t,r){return Ka(t).Qs(function(t,e){var n=Oa(e);r(n)})},za.prototype.oi=function(t){return Wa(t).get(Dh.key).next(function(t){return Rr(null!==t),t})},za.prototype.hi=function(t,e){return Wa(t).put(Dh.key,e)},za.prototype._i=function(t,e){return Ka(t).put(Ra(this.serializer,e))},za.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},za.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},za.prototype.mi=function(t,i){var e=gi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Ka(t).Qs({range:n,index:Sh.queryTargetsIndexName},function(t,e,n){var r=Oa(e);mi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},za.prototype.Ai=function(n,t,r){var i=this,o=[],s=Qa(n);return t.forEach(function(t){var e=da(t.path);o.push(s.put(new kh(r,e))),o.push(i.ii.Ri(n,r,t))}),Yu.Sn(o)},za.prototype.Pi=function(n,t,r){var i=this,o=Qa(n);return Yu.forEach(t,function(t){var e=da(t.path);return Yu.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},za.prototype.Ti=function(t,e){var n=Qa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},za.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Qa(t),o=zi();return r.Qs({range:n,yi:!0},function(t,e,n){var r=va(t[1]),i=new ri(r);o=o.add(i)}).next(function(){return o})},za.prototype.pi=function(t,e){var n=da(e.path),r=IDBKeyRange.bound([n],[Ur(n)],!1,!0),i=0;return Qa(t).Qs({index:kh.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},za.prototype.Me=function(t,e){return Ka(t).get(e).next(function(t){return t?Oa(t):null})},za);function za(t,e){this.ii=t,this.serializer=e}function Ha(t){this.ei=t}function Ka(t){return Ja.ks(t,Sh.store)}function Wa(t){return Ja.ks(t,Dh.store)}function Qa(t){return Ja.ks(t,kh.store)}var Xa,Ya="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$a=(n(th,Xa=Zu),th),Ja=(Za.ks=function(t,e){if(t instanceof $a)return Ch.ks(t.bi,e);throw Or()},Za.prototype.start=function(){var e=this;return Ch.Ui(this.Li,dh,new yh(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Ya);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new na(t,e.Si)}).then(function(){e.Fi=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},Za.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},Za.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Za.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Za.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return nh(e).put(new Oh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(Fh(t))return kr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},Za.prototype.tr=function(t){var e=this;return eh(t).get(gh.key).next(function(t){return Yu.resolve(e.rr(t))})},Za.prototype.or=function(t){return nh(t).delete(this.clientId)},Za.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.$i,18e5)?[3,2]:(this.$i=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Za.ks(t,Oh.store);return r.Ns().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Yu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},Za.prototype.Gi=function(){var t=this;this.xi=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},Za.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},Za.prototype.nr=function(e){var i=this;return this.Di?Yu.resolve(!0):eh(e).get(gh.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Ya);return!1}}return!(!i.networkEnabled||!i.inForeground)||nh(e).Ns().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Za.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Fi=!1,this.dr(),this.xi&&(this.xi.cancel(),this.xi=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){kr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},Za.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},Za.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return nh(t).Ns().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Za.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),Za.prototype.mr=function(t){return uh.Ar(t,this.serializer,this.Kn,this.ii)},Za.prototype.Rr=function(){return this.qi},Za.prototype.Pr=function(){return this.Qn},Za.prototype.gr=function(){return this.Kn},Za.prototype.runTransaction=function(e,n,r){var i=this;kr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Lh,function(t){return o=new $a(t,i.Ci?i.Ci.next():na.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new Yr(Xr.FAILED_PRECONDITION,Ju);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},Za.prototype.Vr=function(t){var e=this;return eh(t).get(gh.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Xr.FAILED_PRECONDITION,Ya)})},Za.prototype.ir=function(t){var e=new gh(this.clientId,this.allowTabSynchronization,Date.now());return eh(t).put(gh.key,e)},Za.Oi=function(){return Ch.Oi()},Za.prototype.sr=function(t){var e=this,n=eh(t);return n.get(gh.key).next(function(t){return e.rr(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(gh.key)):Yu.resolve()})},Za.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},Za.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)},Za.prototype.wr=function(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)},Za.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ni=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.Ni))},Za.prototype.Tr=function(){this.Ni&&(this.window.removeEventListener("unload",this.Ni),this.Ni=null)},Za.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Za.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},Za.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},Za.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Za);function Za(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=h,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.ki=null,this.xi=null,this.$i=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!Za.Oi())throw new Yr(Xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new rh(this,r),this.Li=e+"main",this.serializer=new Na(u),this.qi=new Ga(this.ii,this.serializer),this.Kn=new wa,this.Qn=new Ca(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function th(t,e){var n=this;return(n=Xa.call(this)||this).bi=t,n.vi=e,n}function eh(t){return Ja.ks(t,gh.store)}function nh(t){return Ja.ks(t,Oh.store)}var rh=(ih.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},ih.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},ih.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},ih.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},ih.prototype.Ri=function(t,e,n){return oh(t,n)},ih.prototype.gi=function(t,e,n){return oh(t,n)},ih.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},ih.prototype.Dr=oh,ih.prototype.Cr=function(t,e){return r=e,i=!1,ph(n=t).Fr(function(t){return hh(n,t,r).next(function(t){return t&&(i=!0),Yu.resolve(!t)})}).next(function(){return i});var n,r,i},ih.prototype.Nr=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){var n;t<=i&&(n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.$n(e),Qa(r).delete([0,da(e.path)])})}),u.push(n))}).next(function(){return Yu.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},ih.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},ih.prototype.kr=oh,ih.prototype.Sr=function(t,o){var s,e=Qa(t),u=na.ws;return e.Qs({index:kh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==na.ws&&o(new ri(va(s)),u),u=i,s=r):u=na.ws}).next(function(){u!==na.ws&&o(new ri(va(s)),u)})},ih.prototype.xr=function(t){return this.db.Pr().Xs(t)},ih);function ih(t,e){this.db=t,this.yr=new ac(this,e)}function oh(t,e){return Qa(t).put((n=t.vi,new kh(0,da(e.path),n)));var n}function sh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var uh=(ah.Ar=function(t,e,n,r){return Rr(""!==t.uid),new ah(t.Mr()?t.uid:"",e,n,r)},ah.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fh(t).Qs({index:bh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ah.prototype.Lr=function(d,y,v,g){var m=this,w=lh(d),b=fh(d);return b.add({}).next(function(t){Rr("number"==typeof t);for(var e,n,r,i,o,s=new Qu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Qo(e.xs,t)}),o=r.mutations.map(function(t){return Qo(e.xs,t)}),new bh(n,r.batchId,r.dn.toMillis(),i,o)),a=[],h=new Vi(function(t,e){return Vr(t.N(),e.N())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Eh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Eh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Kn.Cs(d,t))}),d.Un(function(){m.$r[t]=s.keys()}),Yu.Sn(a).next(function(){return s})})},ah.prototype.qr=function(t,e){var n=this;return fh(t).get(e).next(function(t){return t?(Rr(t.userId===n.userId),xa(n.serializer,t)):null})},ah.prototype.Br=function(t,n){var r=this;return this.$r[n]?Yu.resolve(this.$r[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.$r[n]=e}return null})},ah.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return fh(t).Qs({index:bh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Rr(e.batchId>=i),o=xa(r.serializer,e)),n.done()}).next(function(){return o})},ah.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return fh(t).Qs({index:bh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ah.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return fh(t).Ns(bh.userMutationsIndex,n).next(function(t){return t.map(function(t){return xa(e.serializer,t)})})},ah.prototype.zn=function(u,a){var h=this,t=Eh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return lh(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);if(r===h.userId&&a.path.isEqual(s))return fh(u).get(o).next(function(t){if(!t)throw Or();Rr(t.userId===h.userId),c.push(xa(h.serializer,t))});n.done()}).next(function(){return c})},ah.prototype.Zn=function(r,t){var a=this,h=new Vi(Vr),i=[];return t.forEach(function(u){var t=Eh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=lh(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Yu.Sn(i).next(function(){return a.jr(r,h)})},ah.prototype.os=function(t,e){var u=this,a=e.path,h=a.length+1,n=Eh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Vi(Vr);return lh(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.jr(t,c)})},ah.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(fh(e).get(t).next(function(t){if(null===t)throw Or();Rr(t.userId===n.userId),r.push(xa(n.serializer,t))}))}),Yu.Sn(i).next(function(){return r})},ah.prototype.Kr=function(e,n){var r=this;return ch(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),Yu.forEach(t,function(t){return r.ii.Dr(e,t)})})},ah.prototype.Gr=function(t){delete this.$r[t]},ah.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return Yu.resolve();var e=IDBKeyRange.lowerBound(Eh.prefixForUser(o.userId)),i=[];return lh(n).Qs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=va(t[1]),i.push(r)):n.done()}).next(function(){Rr(0===i.length)})})},ah.prototype.pi=function(t,e){return hh(t,this.userId,e)},ah.prototype.Hr=function(t){var e=this;return ph(t).get(this.userId).next(function(t){return t||new wh(e.userId,-1,"")})},ah);function ah(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.$r={}}function hh(t,o,e){var n=Eh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return lh(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ch(t,e,n){var r=t.store(bh.store),i=t.store(Eh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Rr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Eh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Yu.Sn(o).next(function(){return h})}function fh(t){return Ja.ks(t,bh.store)}function lh(t){return Ja.ks(t,Eh.store)}function ph(t){return Ja.ks(t,wh.store)}var dh=10,yh=(mh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Rr(t<e&&0<=t&&e<=dh);var o,s=new Bh(r);t<1&&1<=e&&(n.createObjectStore(gh.store),(o=n).createObjectStore(wh.store,{keyPath:wh.keyPath}),o.createObjectStore(bh.store,{keyPath:bh.keyPath,autoIncrement:!0}).createIndex(bh.userMutationsIndex,bh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Eh.store),xh(n),n.createObjectStore(Ah.store));var u,a=Yu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(kh.store),u.deleteObjectStore(Sh.store),u.deleteObjectStore(Dh.store),xh(n)),a=a.next(function(){return t=s.store(Dh.store),e=new Dh(0,0,Jr.min().A(),0),t.put(Dh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(bh.store).Ns().next(function(t){r.deleteObjectStore(bh.store),r.createObjectStore(bh.store,{keyPath:bh.keyPath,autoIncrement:!0}).createIndex(bh.userMutationsIndex,bh.userMutationsKeyPath,{unique:!0});var e=i.store(bh.store),n=t.map(function(t){return e.put(t)});return Yu.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Oh.store,{keyPath:Oh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(_h.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Ah.store)).createIndex(Ah.readTimeIndex,Ah.readTimeIndexPath,{unique:!1}),t.createIndex(Ah.collectionReadTimeIndex,Ah.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},mh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Ah.store).Qs(function(t,e){n+=qa(e)}).next(function(){var t=new _h(n);return e.store(_h.store).put(_h.key,t)})},mh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(wh.store),e=r.store(bh.store);return t.Ns().next(function(t){return Yu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ns(bh.userMutationsIndex,t).next(function(t){return Yu.forEach(t,function(t){Rr(t.userId===n.userId);var e=xa(i.serializer,t);return ch(r,n.userId,e).next(function(){})})})})})},mh.prototype.ensureSequenceNumbers=function(t){var s=t.store(kh.store),e=t.store(Ah.store);return t.store(Dh.store).get(Dh.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new ti(t),r=[0,da(n)];o.push(s.get(r).next(function(t){return t?Yu.resolve():s.put(new kh(0,da(n),i.highestListenSequenceNumber))}))}).next(function(){return Yu.Sn(o)})})},mh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:da(n)})}}t.createObjectStore(Ph.store,{keyPath:Ph.keyPath});var i=e.store(Ph.store),o=new ma;return e.store(Ah.store).Qs({yi:!0},function(t,e){return r(new ti(t).p())}).next(function(){return e.store(Eh.store).Qs({yi:!0},function(t,e){t[0];var n=t[1];return r((t[2],va(n)).p())})})},mh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Sh.store);return o.Qs(function(t,e){var n=Oa(e),r=Ra(i.serializer,n);return o.put(r)})},mh),vh=function(t,e){this.seconds=t,this.nanoseconds=e},gh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function mh(t){this.serializer=t}gh.store="owner",gh.key="owner";var wh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wh.store="mutationQueues",wh.keyPath="userId";var bh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};bh.store="mutations",bh.keyPath="batchId",bh.userMutationsIndex="userMutationsIndex",bh.userMutationsKeyPath=["userId","batchId"];var Eh=(Ih.prefixForUser=function(t){return[t]},Ih.prefixForPath=function(t,e){return[t,da(e)]},Ih.key=function(t,e,n){return[t,da(e),n]},Ih);function Ih(){}Eh.store="documentMutations",Eh.PLACEHOLDER=new Eh;var Th=function(t,e){this.path=t,this.readTime=e},Nh=function(t,e){this.path=t,this.version=e},Ah=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ah.store="remoteDocuments",Ah.readTimeIndex="readTimeIndex",Ah.readTimeIndexPath="readTime",Ah.collectionReadTimeIndex="collectionReadTimeIndex",Ah.collectionReadTimeIndexPath=["parentPath","readTime"];var _h=function(t){this.byteSize=t};_h.store="remoteDocumentGlobal",_h.key="remoteDocumentGlobalKey";var Sh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sh.store="targets",Sh.keyPath="targetId",Sh.queryTargetsIndexName="queryTargetsIndex",Sh.queryTargetsKeyPath=["canonicalId","targetId"];var kh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};kh.store="targetDocuments",kh.keyPath=["targetId","path"],kh.documentTargetsIndex="documentTargetsIndex",kh.documentTargetsKeyPath=["path","targetId"];var Dh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Dh.key="targetGlobalKey",Dh.store="targetGlobal";var Ph=function(t,e){this.collectionId=t,this.parent=e};function xh(t){t.createObjectStore(kh.store,{keyPath:kh.keyPath}).createIndex(kh.documentTargetsIndex,kh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sh.store,{keyPath:Sh.keyPath}).createIndex(Sh.queryTargetsIndexName,Sh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Dh.store)}Ph.store="collectionParents",Ph.keyPath=["collectionId","parent"];var Oh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Oh.store="clientMetadata",Oh.keyPath="clientId";var Rh,Lh=i(i(i([wh.store,bh.store,Eh.store,Ah.store,Sh.store,gh.store,Dh.store,kh.store],[Oh.store]),[_h.store]),[Ph.store]),Ch=(qh.Ui=function(o,t,s){return kr("SimpleDb","Opening database:",o),new Yu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new qh(e))},i.onblocked=function(){r(new Yr(Xr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Yr(Xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,dh).next(function(){kr("SimpleDb","Database upgrade to version "+dh+" complete")})}}).bn()},qh.delete=function(t){return kr("SimpleDb","Removing database:",t),Kh(window.indexedDB.deleteDatabase(t)).bn()},qh.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(qh.Jr())return!0;var t=p(),e=qh.Yr(t),n=0<e&&e<10,r=qh.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},qh.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},qh.ks=function(t,e){return t.store(e)},qh.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},qh.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},qh.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},qh.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=Bh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Yu.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,kr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},qh.prototype.close=function(){this.db.close()},qh),Vh=(Object.defineProperty(jh.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),jh.prototype.done=function(){this.no=!0},jh.prototype.js=function(t){this.so=t},jh.prototype.delete=function(){return Kh(this.eo.delete())},jh),Mh=(n(Uh,Rh=Yr),Uh);function Uh(t){var e=this;return(e=Rh.call(this,Xr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function jh(t){this.eo=t,this.no=!1,this.so=null}function qh(t){this.db=t,12.2===qh.Yr(p())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Fh(t){return"IndexedDbTransactionError"===t.name}var Bh=(Hh.open=function(t,e,n){return new Hh(t.transaction(n,e))},Object.defineProperty(Hh.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Hh.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Hh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Gh(e)},Hh),Gh=(zh.prototype.put=function(t,e){return Kh(void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},zh.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Kh(this.store.add(t))},zh.prototype.get=function(e){var n=this;return Kh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),kr("SimpleDb","GET",n.store.name,e,t),t})},zh.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Kh(this.store.delete(t))},zh.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Kh(this.store.count())},zh.prototype.Ns=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},zh.prototype.ho=function(t,e){kr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},zh.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},zh.prototype.Fr=function(i){var t=this.cursor({});return new Yu(function(n,r){t.onerror=function(t){var e=Qh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},zh.prototype.oo=function(t,s){var u=[];return new Yu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Vh(i),(n=s(i.primaryKey,i.value,e))instanceof Yu&&(r=n.catch(function(t){return e.done(),Yu.reject(t)}),u.push(r)),e.gn?o():null===e.io?i.continue():i.continue(e.io)):o()}}).next(function(){return Yu.Sn(u)})},zh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},zh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},zh);function zh(t){this.store=t}function Hh(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new fa,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new Mh(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=Qh(t.target.error);n.ro.reject(new Mh(e))}}function Kh(t){return new Yu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Qh(t.target.error);r(e)}})}var Wh=!1;function Qh(t){var e=Ch.Yr(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Wh||(Wh=!0,setTimeout(function(){throw r},0)),r}}return t}function Xh(){return"undefined"!=typeof window?window:null}var Yh=(Zh._o=function(t,e,n,r,i){var o=new Zh(t,e,Date.now()+n,r,i);return o.start(n),o},Zh.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},Zh.prototype.Ss=function(){return this.do()},Zh.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new Yr(Xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Zh.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},Zh.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},Zh),$h=(Object.defineProperty(Jh.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),Jh.prototype.Zi=function(t){this.enqueue(t)},Jh.prototype.po=function(t){this.bo(),this.vo(t)},Jh.prototype.So=function(t){return this.bo(),this.vo(t)},Jh.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=Xh())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jh.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},Jh.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},Jh.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!Fh(e=t.sent()))throw e;return kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},Jh.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},Jh.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=Yh._o(this,t,e,n,function(t){return r.Fo(t)});return this.Io.push(i),i},Jh.prototype.bo=function(){this.mo&&Or()},Jh.prototype.No=function(){},Jh.prototype.ko=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},Jh.prototype.xo=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},Jh.prototype.$o=function(r){var i=this;return this.ko().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.ko()})},Jh.prototype.Mo=function(t){this.Ro.push(t)},Jh.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},Jh);function Jh(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new la(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=Xh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function Zh(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new fa,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function tc(t,e){if(Dr("AsyncQueue",e+": "+t),Fh(t))return new Yr(Xr.UNAVAILABLE,e+": "+t);throw t}function ec(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Vr(n,i);return 0===s?Vr(r,o):s}var nc=(sc.prototype.qo=function(){return++this.Lo},sc.prototype.Bo=function(t){var e,n=[t,this.qo()];this.buffer.size<this.Oo?this.buffer=this.buffer.add(n):ec(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(sc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),sc),rc={Uo:!1,Wo:0,Qo:0,jo:0},ic=(oc.Ho=function(t){return new oc(t,oc.Yo,oc.Jo)},oc);function oc(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function sc(t){this.Oo=t,this.buffer=new Vi(ec),this.Lo=0}ic.Xo=-1,ic.Zo=1048576,ic.th=41943040,ic.Yo=10,ic.Jo=1e3,ic.eh=new ic(ic.th,ic.Yo,ic.Jo),ic.nh=new ic(ic.Xo,0,0);var uc=(lc.prototype.start=function(t){this.yr.params.Ko!==ic.Xo&&this.rh(t)},lc.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(lc.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),lc.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return Fh(e=t.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,dc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},lc),ac=(fc.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},fc.prototype.uh=function(t,e){var n=this;if(0===e)return Yu.resolve(na.ws);var r=new nc(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},fc.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},fc.prototype.Nr=function(t,e){return this.hh.Nr(t,e)},fc.prototype.lh=function(e,n){var r=this;return this.params.Ko===ic.Xo?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),Yu.resolve(rc)):this.xr(e).next(function(t){return t<r.params.Ko?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),rc):r._h(e,n)})},fc.prototype.xr=function(t){return this.hh.xr(t)},fc.prototype._h=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>c.params.zo?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.zo+" from "+t),c.params.zo):t,s=Date.now(),c.uh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Nr(e,r)}).next(function(t){return h=Date.now(),Sr()<=l.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Yu.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},fc),hc=(cc.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.jn.Qr(v).next(function(t){return g=t,e=r.persistence.mr(i),m=new ta(r.Eh,e,r.persistence.gr()),e.Qr(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Jn(v,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},cc.prototype.Vh=function(h){var c,f=this,l=$r.now(),t=h.reduce(function(t,e){return t.add(e.key)},zi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Ih.Jn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof qs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ru?t.field(i.field):void 0,s=is(i.transform,o||null);null!=s&&(e=null==e?(new Qs).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Cs(o.key,s,function u(t){var a=[];return Gr(t.fields||{},function(t,e){var n=new ni([t]);if(Do(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Es(a)}(s.proto.mapValue),As.exists(!0)))}return f.jn.Lr(a,l,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Cn:e}})},cc.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},cc.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return Rr(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},cc.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},cc.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},cc.prototype.vh=function(a){var h=this,c=a.X,f=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Eh.Hs({Js:!0});f=h.dh;var s=[];a.Wt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.qi.Pi(o,t.Xt,e).next(function(){return h.qi.Ai(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.vi),f=f.nt(e,r),cc.Sh(i,r,t)&&s.push(h.qi.di(o,r))))});var t,u=Ui,n=zi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof iu&&e.version.isEqual(Jr.min())?(i.$n(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.kn(e,c),u=u.nt(t,e)):kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.ii.kr(o,t))})})),c.isEqual(Jr.min())||(t=h.qi.ai(o).next(function(t){return h.qi.ci(o,o.vi,c)}),s.push(t)),Yu.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ih.Xn(o,u)})}).then(function(t){return h.dh=f,t})},cc.Sh=function(t,e,n){return Rr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},cc.prototype.Ch=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Yu.forEach(c,function(e){return Yu.forEach(e.as,function(t){return h.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return Yu.forEach(e.us,function(t){return h.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Fh(e=t.sent()))throw e;return kr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},cc.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},cc.prototype.Nh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},cc.prototype.kh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,Yu.resolve(n)):i.qi.ri(e).next(function(t){return n=new Ai(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},cc.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?Yu.resolve(this.dh.get(n)):this.qi.mi(t,e)},cc.prototype.xh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Fh(r=t.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},cc.prototype.$h=function(t,n){var r=this,i=Jr.min(),o=zi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,vu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:Jr.min(),n?o:zi())}).next(function(t){return{documents:t,Mh:o}})})},cc.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Yu.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);Rr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.kn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},cc.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},cc);function cc(t,e,n){this.persistence=t,this.fh=e,this.dh=new Di(Vr),this.wh=new Qr(gi,mi),this.Th=Jr.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new ta(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function fc(t,e){this.hh=t,this.params=e}function lc(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function pc(t,e){var n=t,r=n.qi,i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function dc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Xr.FAILED_PRECONDITION||e.message!==Ju)throw e;return kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}hc.Dh=3e8;var yc=(bc.prototype._=function(){return this.Oh._()},bc.prototype.Ri=function(t,e){var n=new vc(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},bc.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},bc.prototype.gi=function(t,e){this.Wh(new vc(t,e))},bc.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},bc.prototype.jh=function(t){var e=this,n=new ri(new ti([])),r=new vc(n,t),i=new vc(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},bc.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},bc.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},bc.prototype.Gh=function(t){var e=new ri(new ti([])),n=new vc(e,t),r=new vc(e,t+1),i=zi();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},bc.prototype.pi=function(t){var e=new vc(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},bc),vc=(wc.Lh=function(t,e){return ri.P(t.key,e.key)||Vr(t.zh,e.zh)},wc.Bh=function(t,e){return Vr(t.zh,e.zh)||ri.P(t.key,e.key)},wc),gc=(mc.prototype.Mr=function(){return null!=this.uid},mc.prototype.Hh=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},mc.prototype.isEqual=function(t){return t.uid===this.uid},mc);function mc(t){this.uid=t}function wc(t,e){this.key=t,this.zh=e}function bc(){this.Oh=new Vi(vc.Lh),this.qh=new Vi(vc.Bh)}function Ec(t,e){this.user=e,this.type="OAuth",this.Xh={},this.Xh.Authorization="Bearer "+t}gc.UNAUTHENTICATED=new gc(null),gc.Yh=new gc("google-credentials-uid"),gc.Jh=new gc("first-party-uid");var Ic,Tc,Nc,Ac=(zc.prototype.getToken=function(){return Promise.resolve(null)},zc.prototype.ta=function(){},zc.prototype.ea=function(t){(this.Zh=t)(gc.UNAUTHENTICATED)},zc.prototype.na=function(){this.Zh=null},zc),_c=(Gc.prototype.getToken=function(){var e=this,n=this.ra,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ra!==n?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new Ec(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Gc.prototype.ta=function(){this.forceRefresh=!0},Gc.prototype.ea=function(t){this.Zh=t,this.ia&&t(this.currentUser)},Gc.prototype.na=function(){this.auth&&this.auth.removeAuthTokenListener(this.sa),this.sa=null,this.Zh=null},Gc.prototype.oa=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new gc(t)},Gc),Sc=(Object.defineProperty(Bc.prototype,"Xh",{get:function(){var t={"X-Goog-AuthUser":this.aa},e=this.ha.auth.ua([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Bc),kc=(Fc.prototype.getToken=function(){return Promise.resolve(new Sc(this.ha,this.aa))},Fc.prototype.ea=function(t){t(gc.Jh)},Fc.prototype.na=function(){},Fc.prototype.ta=function(){},Fc),Dc=(qc.prototype.wa=function(){return 1===this.state||2===this.state||4===this.state},qc.prototype.Ta=function(){return 2===this.state},qc.prototype.start=function(){3!==this.state?this.auth():this.Ea()},qc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.wa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},qc.prototype.Ia=function(){this.state=0,this.Po.reset()},qc.prototype.ma=function(){var t=this;this.Ta()&&null===this.da&&(this.da=this.Ts.bs(this.ca,6e4,function(){return t.Aa()}))},qc.prototype.Ra=function(t){this.Pa(),this.stream.send(t)},qc.prototype.Aa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ta()?[2,this.close(0)]:[2]})})},qc.prototype.Pa=function(){this.da&&(this.da.cancel(),this.da=null)},qc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Pa(),this.Po.cancel(),this.fa++,3!==e?this.Po.reset():n&&n.code===Xr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Xr.UNAUTHENTICATED&&this._a.ta(),null!==this.stream&&(this.ga(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Va(n)];case 1:return t.sent(),[2]}})})},qc.prototype.ga=function(){},qc.prototype.auth=function(){var n=this;this.state=1;var t=this.ya(this.fa),e=this.fa;this._a.getToken().then(function(t){n.fa===e&&n.pa(t)},function(e){t(function(){var t=new Yr(Xr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ba(t)})})},qc.prototype.pa=function(t){var e=this,n=this.ya(this.fa);this.stream=this.va(t),this.stream.Sa(function(){n(function(){return e.state=2,e.listener.Sa()})}),this.stream.Va(function(t){n(function(){return e.ba(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},qc.prototype.Ea=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},qc.prototype.ba=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},qc.prototype.ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.fa===e?t():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},qc),Pc=(n(jc,Nc=Dc),jc.prototype.va=function(t){return this.la.Da("Listen",t)},jc.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Or(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Rr(void 0===i||"string"==typeof i),bi.fromBase64String(i||"")):(Rr(void 0===i||i instanceof Uint8Array),bi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Qi(s,u,a,h&&(r=void 0===(n=h).code?Xr.UNKNOWN:ki(n.code),new Yr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Bo(t,f.document.name),p=Uo(f.document.updateTime),d=new Ws({mapValue:{fields:f.document.fields}}),y=new ru(l,p,d,{}),c=new Ki(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Bo(t,v.document),m=v.readTime?Uo(v.readTime):Jr.min(),w=new iu(g,m);c=new Ki([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Bo(t,b.document);c=new Ki([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Or();e.filter;var I=e.filter;I.targetId;var T=new Ii(I.count||0);c=new Wi(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Jr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Jr.min():Uo(e.readTime)}(t);return this.listener.Ca(e,n)},jc.prototype.Fa=function(t){var e,n,r,i,o={};o.database=Ho(this.serializer),o.addTarget=(e=this.serializer,(r=wi(i=(n=t).target)?{documents:Yo(e,i)}:{query:$o(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Or()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ra(o)},jc.prototype.Na=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.Ra(e)},jc),xc=(n(Uc,Tc=Dc),Object.defineProperty(Uc.prototype,"xa",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Uc.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,Tc.prototype.start.call(this)},Uc.prototype.ga=function(){this.ka&&this.$a([])},Uc.prototype.va=function(t){return this.la.Da("Write",t)},Uc.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Rr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual(Jr.min())&&(n=Uo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ns(n,r)}(t,i)})):[]),n=Uo(t.commitTime);return this.listener.Ma(n,e)}var r,i;return Rr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Oa()},Uc.prototype.La=function(){var t={};t.database=Ho(this.serializer),this.Ra(t)},Uc.prototype.$a=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qo(e.serializer,t)})};this.Ra(n)},Uc),Oc=(n(Mc,Ic=function(){}),Mc.prototype.Ba=function(){if(this.qa)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Mc.prototype.start=function(t){this.la=t},Mc.prototype.Ua=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Ua(e,n,r,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&i.credentials.ta(),t})},Mc.prototype.Wa=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Wa(e,n,r,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&i.credentials.ta(),t})},Mc.prototype.Qa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.qa=!1,[2]})})},Mc),Rc=(Vc.prototype.Ha=function(){var t=this;0===this.Ka&&(this.Ya("Unknown"),this.Ga=this.ao.bs("online_state_timeout",1e4,function(){return t.Ga=null,t.Ja("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},Vc.prototype.Xa=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ka++,1<=this.Ka&&(this.Za(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},Vc.prototype.set=function(t){this.Za(),this.Ka=0,"Online"===t&&(this.za=!1),this.Ya(t)},Vc.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},Vc.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Dr(e),this.za=!1):kr("OnlineStateTracker",e)},Vc.prototype.Za=function(){null!==this.Ga&&(this.Ga.cancel(),this.Ga=null)},Vc),Lc=(Cc.prototype.start=function(){return this.enableNetwork()},Cc.prototype.enableNetwork=function(){return this.ru.delete(0),this.mu()},Cc.prototype.mu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(this.Au()?this.Ru():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(0),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Cc.prototype.gu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.nu.length&&(kr("RemoteStore","Stopping write stream with "+this.nu.length+" pending writes"),this.nu=[]),this.Vu(),[2]}})})},Cc.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return kr("RemoteStore","RemoteStore shutting down."),this.ru.add(5),[4,this.gu()];case 1:return t.sent(),this.ou._r(),this.cu.set("Unknown"),[2]}})})},Cc.prototype.listen=function(t){this.su.has(t.targetId)||(this.su.set(t.targetId,t),this.Au()?this.Ru():this.lu.Ta()&&this.yu(t))},Cc.prototype.pu=function(t){this.su.delete(t),this.lu.Ta()&&this.bu(t),0===this.su.size&&(this.lu.Ta()?this.lu.ma():this.au()&&this.cu.set("Unknown"))},Cc.prototype.Me=function(t){return this.su.get(t)||null},Cc.prototype.$e=function(t){return this.vu.$e(t)},Cc.prototype.yu=function(t){this.iu.de(t.targetId),this.lu.Fa(t)},Cc.prototype.bu=function(t){this.iu.de(t),this.lu.Na(t)},Cc.prototype.Ru=function(){this.iu=new eo(this),this.lu.start(),this.cu.Ha()},Cc.prototype.Au=function(){return this.au()&&!this.lu.wa()&&0<this.su.size},Cc.prototype.au=function(){return 0===this.ru.size},Cc.prototype.Vu=function(){this.iu=null},Cc.prototype._u=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.su.forEach(function(t,e){n.yu(t)}),[2]})})},Cc.prototype.fu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Vu(),this.Au()?(this.cu.Xa(e),this.Ru()):this.cu.set("Unknown"),[2]})})},Cc.prototype.du=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(i instanceof Qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Su(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Ki?this.iu.Pe(i):i instanceof Wi?this.iu.De(i):this.iu.ye(i),o.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.tu.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Cu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Du(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Cc.prototype.Du=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Fh(n))throw n;return this.ru.add(1),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),r=r||function(){return e.tu.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.ru.delete(1),[4,this.mu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Cc.prototype.Fu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Cc.prototype.Cu=function(r){var i=this,t=this.iu.Ne(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.su.get(e))&&i.su.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.su.get(t);n&&(i.su.set(t,n.tt(bi.Y,n.X)),i.bu(t),e=new Ai(n.target,t,1,n.sequenceNumber),i.yu(e))}),this.vu.vh(t)},Cc.prototype.Su=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.su.has(i)?[4,this.vu.Nu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.su.delete(i),this.iu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Cc.prototype.Pu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.nu.length?this.nu[this.nu.length-1].batchId:-1,t.label=1;case 1:if(!this.ku())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.tu.Fh(e)];case 3:return null===(n=t.sent())?(0===this.nu.length&&this.wu.ma(),[3,7]):(e=n.batchId,this.xu(n),[3,6]);case 4:return r=t.sent(),[4,this.Du(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.$u()&&this.Mu(),[2]}})})},Cc.prototype.ku=function(){return this.au()&&this.nu.length<10},Cc.prototype.Ou=function(){return this.nu.length},Cc.prototype.xu=function(t){this.nu.push(t),this.wu.Ta()&&this.wu.xa&&this.wu.$a(t.mutations)},Cc.prototype.$u=function(){return this.au()&&!this.wu.wa()&&0<this.nu.length},Cc.prototype.Mu=function(){this.wu.start()},Cc.prototype.Tu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.wu.La(),[2]})})},Cc.prototype.Iu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.nu;e<n.length;e++)r=n[e],this.wu.$a(r.mutations);return[2]})})},Cc.prototype.Ma=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.nu.shift(),n=Xu.from(e,i,o),[4,this.Fu(function(){return r.vu.Lu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Cc.prototype.Eu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.wu.xa?[4,this.qu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.$u()&&this.Mu(),[2]}})})},Cc.prototype.qu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Xr.ABORTED?(e=this.nu.shift(),this.wu.Ia(),[4,this.Fu(function(){return r.vu.Bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Cc.prototype.uu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(4),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),this.wu.Ia(),this.lu.Ia(),this.ru.delete(4),[4,this.mu()];case 2:return t.sent(),[2]}})})},Cc.prototype.Uu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.No(),kr("RemoteStore","RemoteStore received new credentials"),this.ru.add(3),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.vu.Uu(e)];case 2:return t.sent(),this.ru.delete(3),[4,this.mu()];case 3:return t.sent(),[2]}})})},Cc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.ru.delete(2),[4,this.mu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.ru.add(2),[4,this.gu()]);case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Cc);function Cc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.tu=t,this.eu=e,this.ao=n,this.nu=[],this.su=new Map,this.iu=null,this.ru=new Set,this.ou=i,this.ou.hu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(kr("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new Rc(n,r),this.lu=(h=this.eu,c=n,f={Sa:this._u.bind(this),Va:this.fu.bind(this),Ca:this.du.bind(this)},(l=h).Ba(),new Pc(c,l.la,l.credentials,l.serializer,f)),this.wu=(o=this.eu,s=n,u={Sa:this.Tu.bind(this),Va:this.Eu.bind(this),Oa:this.Iu.bind(this),Ma:this.Ma.bind(this)},(a=o).Ba(),new xc(s,a.la,a.credentials,a.serializer,u))}function Vc(t,e){this.ao=t,this.ja=e,this.state="Unknown",this.Ka=0,this.Ga=null,this.za=!0}function Mc(t,e){var n=this;return(n=Ic.call(this)||this).credentials=t,n.serializer=e,n.qa=!1,n}function Uc(t,e,n,r,i){var o=this;return(o=Tc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function jc(t,e,n,r,i){var o=this;return(o=Nc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function qc(t,e,n,r,i,o){this.Ts=t,this.ca=n,this.la=r,this._a=i,this.listener=o,this.state=0,this.fa=0,this.da=null,this.stream=null,this.Po=new la(t,e)}function Fc(t,e){this.ha=t,this.aa=e}function Bc(t,e){this.ha=t,this.aa=e,this.type="FirstParty",this.user=gc.Jh}function Gc(t){var e=this;this.sa=null,this.currentUser=gc.UNAUTHENTICATED,this.ia=!1,this.ra=0,this.Zh=null,this.forceRefresh=!1,this.sa=function(){e.ra++,e.currentUser=e.oa(),e.ia=!0,e.Zh&&e.Zh(e.currentUser)},this.ra=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.sa):(this.sa(null),t.get().then(function(t){e.auth=t,e.sa&&e.auth.addAuthTokenListener(e.sa)},function(){}))}function zc(){this.Zh=null}function Hc(t,e){return"firestore_clients_"+t+"_"+e}function Kc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function Wc(t,e){return"firestore_targets_"+t+"_"+e}function Qc(t){this.key=t}function Xc(t){this.key=t}function Yc(t,e,n){this.query=t,this.targetId=e,this.view=n}function $c(t){this.key=t,this.Zc=!1}var Jc=(vf.Qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Yr(r.error.code,r.error.message)),i?new vf(t,e,r.state,o):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},vf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},vf),Zc=(yf.Qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Yr(n.error.code,n.error.message)),r?new yf(t,n.state,i):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},yf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},yf),tf=(df.Qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Hi,o=0;r&&o<n.activeTargetIds.length;++o)r=di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new df(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},df),ef=(pf.Qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new pf(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},pf),nf=(lf.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},lf.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},lf.prototype.ju=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},lf),rf=(ff.Oi=function(t){return!(!t||!t.localStorage)},ff.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.vu.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.zu&&(o=this.getItem(Hc(this.persistenceKey,i)))&&(s=tf.Qu(i,o))&&(this.Ju=this.Ju.nt(s.clientId,s));for(this.rc(),(u=this.storage.getItem(this.ic))&&(a=this.oc(u))&&this.hc(a),h=0,c=this.Xu;h<c.length;h++)f=c[h],this.Yu(f);return this.Xu=[],this.window.addEventListener("unload",function(){return l._r()}),this.Hi=!0,[2]}})})},ff.prototype.ds=function(t){this.setItem(this.tc,JSON.stringify(t))},ff.prototype.ac=function(){return this.uc(this.Ju)},ff.prototype.cc=function(n){var r=!1;return this.Ju.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},ff.prototype.lc=function(t){this._c(t,"pending")},ff.prototype.fc=function(t,e,n){this._c(t,e,n),this.dc(t)},ff.prototype.wc=function(t){var e,n,r="not-current";return this.cc(t)&&(!(e=this.storage.getItem(Wc(this.persistenceKey,t)))||(n=Zc.Qu(t,e))&&(r=n.state)),this.Tc.Ku(t),this.rc(),r},ff.prototype.Ec=function(t){this.Tc.Gu(t),this.rc()},ff.prototype.Ic=function(t){return this.Tc.activeTargetIds.has(t)},ff.prototype.mc=function(t){this.removeItem(Wc(this.persistenceKey,t))},ff.prototype.Ac=function(t,e,n){this.Rc(t,e,n)},ff.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.dc(t)}),this.currentUser=t,n.forEach(function(t){r.lc(t)})},ff.prototype.Pc=function(t){this.gc(t)},ff.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.Hu),this.removeItem(this.Zu),this.Hi=!1)},ff.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},ff.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},ff.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},ff.prototype.Yu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(kr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Zu)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.ec.test(u.key)){if(null==u.newValue)return e=this.Vc(u.key),[2,this.yc(e,null)];if(n=this.pc(u.key,u.newValue))return[2,this.yc(n.clientId,n)]}else if(this.nc.test(u.key)){if(null!==u.newValue&&(r=this.bc(u.key,u.newValue)))return[2,this.vc(r)]}else if(this.sc.test(u.key)){if(null!==u.newValue&&(i=this.Sc(u.key,u.newValue)))return[2,this.Dc(i)]}else if(u.key===this.ic){if(null!==u.newValue&&(o=this.oc(u.newValue)))return[2,this.hc(o)]}else u.key===this.tc&&(s=function(t){var e=na.ws;if(null!=t)try{var n=JSON.parse(t);Rr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==na.ws&&this.ls(s)}else this.Xu.push(u);return[2]})})})}},Object.defineProperty(ff.prototype,"Tc",{get:function(){return this.Ju.get(this.zu)},enumerable:!1,configurable:!0}),ff.prototype.rc=function(){this.setItem(this.Zu,this.Tc.ju())},ff.prototype._c=function(t,e,n){var r=new Jc(this.currentUser,t,e,n),i=Kc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ju())},ff.prototype.dc=function(t){var e=Kc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},ff.prototype.gc=function(t){var e={clientId:this.zu,onlineState:t};this.storage.setItem(this.ic,JSON.stringify(e))},ff.prototype.Rc=function(t,e,n){var r=Wc(this.persistenceKey,t),i=new Zc(t,e,n);this.setItem(r,i.ju())},ff.prototype.Vc=function(t){var e=this.ec.exec(t);return e?e[1]:null},ff.prototype.pc=function(t,e){var n=this.Vc(t);return tf.Qu(n,e)},ff.prototype.bc=function(t,e){var n=this.nc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Jc.Qu(new gc(i),r,e)},ff.prototype.Sc=function(t,e){var n=this.sc.exec(t),r=Number(n[1]);return Zc.Qu(r,e)},ff.prototype.oc=function(t){return ef.Qu(t)},ff.prototype.vc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.vu.Cc(e.batchId,e.state,e.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},ff.prototype.Dc=function(t){return this.vu.Fc(t.targetId,t.state,t.error)},ff.prototype.yc=function(t,e){var n=this,r=e?this.Ju.nt(t,e):this.Ju.remove(t),i=this.uc(this.Ju),o=this.uc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.vu.Nc(s,u).then(function(){n.Ju=r})},ff.prototype.hc=function(t){this.Ju.get(t.clientId)&&this.ja(t.onlineState)},ff.prototype.uc=function(t){var n=Hi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},ff),of=(cf.prototype.lc=function(t){},cf.prototype.fc=function(t,e,n){},cf.prototype.wc=function(t){return this.kc.Ku(t),this.xc[t]||"not-current"},cf.prototype.Ac=function(t,e,n){this.xc[t]=e},cf.prototype.Ec=function(t){this.kc.Gu(t)},cf.prototype.Ic=function(t){return this.kc.activeTargetIds.has(t)},cf.prototype.mc=function(t){delete this.xc[t]},cf.prototype.ac=function(){return this.kc.activeTargetIds},cf.prototype.cc=function(t){return this.kc.activeTargetIds.has(t)},cf.prototype.start=function(){return this.kc=new nf,Promise.resolve()},cf.prototype.Ah=function(t,e,n){},cf.prototype.Pc=function(t){},cf.prototype._r=function(){},cf.prototype.ds=function(t){},cf),sf=(Object.defineProperty(hf.prototype,"Bc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),hf.prototype.Uc=function(t,e){var u=this,a=e?e.Wc:new Yi,h=e?e.qc:this.qc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof ru?e:null)&&(Tu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Qc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Lc(r,p)||d&&u.Lc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{qc:f,Wc:a,jc:l,Lt:c}},hf.prototype.Qc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},hf.prototype.qn=function(t,e,n){var o=this,r=this.qc;this.qc=t.qc,this.Lt=t.Lt;var i=t.Wc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Lc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Or()}}var r,i}),this.Kc(n);var s=e?this.Gc():[],u=0===this.Oc.size&&this.Ht?1:0,a=u!==this.Mc;return this.Mc=u,0!==i.length||a?{snapshot:new $i(this.query,t.qc,r,i,t.Lt,0==u,a,!1),zc:s}:{zc:s}},hf.prototype.Hc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({qc:this.qc,Wc:new Yi,Lt:this.Lt,jc:!1},!1)):{zc:[]}},hf.prototype.Yc=function(t){return!this.$c.has(t)&&!!this.qc.has(t)&&!this.qc.get(t).Ke},hf.prototype.Kc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.$c=e.$c.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.$c=e.$c.delete(t)}),this.Ht=t.Ht)},hf.prototype.Gc=function(){var e=this;if(!this.Ht)return[];var n=this.Oc;this.Oc=zi(),this.qc.forEach(function(t){e.Yc(t.key)&&(e.Oc=e.Oc.add(t.key))});var r=[];return n.forEach(function(t){e.Oc.has(t)||r.push(new Xc(t))}),this.Oc.forEach(function(t){n.has(t)||r.push(new Qc(t))}),r},hf.prototype.Jc=function(t){this.$c=t.Mh,this.Oc=zi();var e=this.Uc(t.documents);return this.qn(e,!0)},hf.prototype.Xc=function(){return $i.Ut(this.query,this.qc,this.Lt,0===this.Mc)},hf),uf=(Object.defineProperty(af.prototype,"dl",{get:function(){return!0===this.fl},enumerable:!1,configurable:!0}),af.prototype.subscribe=function(t){this.sl=t},af.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.wl("listen()"),(r=this.il.get(s))?(e=r.targetId,this.el.wc(e),n=r.view.Xc(),[3,4]):[3,1];case 1:return[4,this.tu.kh(vu(s))];case 2:return i=t.sent(),o=this.el.wc(i.targetId),e=i.targetId,[4,this.Tl(s,e,"current"===o)];case 3:n=t.sent(),this.dl&&this.tl.listen(i),t.label=4;case 4:return[2,n]}})})},af.prototype.Tl=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.tu.$h(u,!0)];case 1:return e=t.sent(),n=new sf(u,e.Mh),r=n.Uc(e.documents),i=Zi.zt(a,h&&"Offline"!==this.onlineState),o=n.qn(r,this.dl,i),this.El(a,o.zc),s=new Yc(u,a,n),[2,(this.il.set(u,s),this.rl.has(a)?this.rl.get(a).push(u):this.rl.set(a,[u]),o.snapshot)]}})})},af.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.wl("unlisten()"),e=this.il.get(i),1<(n=this.rl.get(e.targetId)).length?[2,(this.rl.set(e.targetId,n.filter(function(t){return!bu(t,i)})),void this.il.delete(i))]:this.dl?(this.el.Ec(e.targetId),this.el.cc(e.targetId)?[3,2]:[4,this.tu.xh(e.targetId,!1).then(function(){r.el.mc(e.targetId),r.tl.pu(e.targetId),r.Il(e.targetId)}).catch(dc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Il(e.targetId),[4,this.tu.xh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},af.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.wl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.tu.Vh(i)];case 2:return e=t.sent(),this.el.lc(e.batchId),this.ml(e.batchId,o),[4,this.Al(e.Cn)];case 3:return t.sent(),[4,this.tl.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=tc(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},af.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.wl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.al.get(e);n&&(Rr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Zc=!0:0<t.Jt.size?Rr(n.Zc):0<t.Xt.size&&(Rr(n.Zc),n.Zc=!1))}),[4,this.Al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},af.prototype.Hc=function(r,t){var i;(this.dl&&0===t||!this.dl&&1===t)&&(this.wl("applyOnlineStateChange()"),i=[],this.il.forEach(function(t,e){var n=e.view.Hc(r);n.snapshot&&i.push(n.snapshot)}),this.sl.Rl(r),this.sl.Ca(i),this.onlineState=r,this.dl&&this.el.Pc(r))},af.prototype.Nu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.wl("rejectListens()"),this.el.Ac(u,"rejected",a),e=this.al.get(u),(n=e&&e.key)?(r=(r=new Di(ri.P)).nt(n,new iu(n,Jr.min())),i=zi().add(n),o=new Ji(Jr.min(),new Map,new Vi(Vr),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.hl=this.hl.remove(n),this.al.delete(u),this.Pl(),[3,4];case 2:return[4,this.tu.xh(u,!1).then(function(){return s.Il(u,a)}).catch(dc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},af.prototype.Lu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.wl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.yh(r)];case 2:return n=t.sent(),this.gl(e,null),this.Vl(e),this.el.fc(e,"acknowledged"),[4,this.Al(n)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},af.prototype.Bu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.wl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.bh(n)];case 2:return e=t.sent(),this.gl(n,r),this.Vl(n),this.el.fc(n,"rejected",r),[4,this.Al(e)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},af.prototype.yl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.tl.au()||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.tu.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.ll.get(e)||[]).push(o),this.ll.set(e,n),[3,4]);case 3:return r=t.sent(),i=tc(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},af.prototype.Vl=function(t){(this.ll.get(t)||[]).forEach(function(t){t.resolve()}),this.ll.delete(t)},af.prototype.pl=function(e){this.ll.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Xr.CANCELLED,e))})}),this.ll.clear()},af.prototype.ml=function(t,e){var n=(n=(n=this.cl[this.currentUser.Hh()])||new Di(Vr)).nt(t,e);this.cl[this.currentUser.Hh()]=n},af.prototype.gl=function(t,e){var n,r=this.cl[this.currentUser.Hh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.cl[this.currentUser.Hh()]=r)},af.prototype.Il=function(t,e){var n=this;void 0===e&&(e=null),this.el.Ec(t);for(var r=0,i=this.rl.get(t);r<i.length;r++){var o=i[r];this.il.delete(o),e&&this.sl.bl(o,e)}this.rl.delete(t),this.dl&&this.ul.jh(t).forEach(function(t){n.ul.pi(t)||n.vl(t)})},af.prototype.vl=function(t){var e=this.hl.get(t);null!==e&&(this.tl.pu(e),this.hl=this.hl.remove(t),this.al.delete(e),this.Pl())},af.prototype.El=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Qc?(this.ul.Ri(i.key,t),this.Sl(i)):i instanceof Xc?(kr("SyncEngine","Document no longer in limbo: "+i.key),this.ul.gi(i.key,t),this.ul.pi(i.key)||this.vl(i.key)):Or()}},af.prototype.Sl=function(t){var e=t.key;this.hl.get(e)||(kr("SyncEngine","New document in limbo: "+e),this.ol.push(e),this.Pl())},af.prototype.Pl=function(){for(;0<this.ol.length&&this.hl.size<this.nl;){var t=this.ol.shift(),e=this._l.next();this.al.set(e,new $c(t)),this.hl=this.hl.nt(t,e),this.tl.listen(new Ai(vu(pu(t.path)),e,2,na.ws))}},af.prototype.Dl=function(){return this.hl},af.prototype.Cl=function(){return this.ol},af.prototype.Al=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.il.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Uc(r);return n.jc?u.tu.$h(i.query,!1).then(function(t){var e=t.documents;return i.view.Uc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.qn(t,u.dl,n);u.El(i.targetId,r.zc),r.snapshot&&(u.dl&&u.el.Ac(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ea.cs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.sl.Ca(o),[4,this.tu.Ch(s)];case 2:return t.sent(),[2]}})})},af.prototype.wl=function(t){},af.prototype.Uu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(kr("SyncEngine","User change. New user:",n.Hh()),[4,this.tu.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.pl("'waitForPendingWrites' promise is rejected due to a user change."),this.el.Ah(n,e.Ph,e.gh),[4,this.Al(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},af.prototype.$e=function(t){var e=this.al.get(t);if(e&&e.Zc)return zi().add(e.key);var n=zi(),r=this.rl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.il.get(s),n=n.Ct(u.view.Bc);return n},af);function af(t,e,n,r,i,o){this.tu=t,this.tl=e,this.eu=n,this.el=r,this.currentUser=i,this.nl=o,this.sl=null,this.il=new Qr(Eu,bu),this.rl=new Map,this.ol=[],this.hl=new Di(ri.P),this.al=new Map,this.ul=new yc,this.cl={},this.ll=new Map,this._l=Ba.si(),this.onlineState="Unknown",this.fl=void 0}function hf(t,e){this.query=t,this.$c=e,this.Mc=null,this.Ht=!1,this.Oc=zi(),this.Lt=zi(),this.Lc=Nu(t),this.qc=new Xi(this.Lc)}function cf(){this.kc=new nf,this.xc={},this.ja=null,this.ls=null}function ff(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.zu=r,this.vu=null,this.ja=null,this.ls=null,this.Hu=this.Yu.bind(this),this.Ju=new Di(Vr),this.Hi=!1,this.Xu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Zu=Hc(this.persistenceKey,this.zu),this.tc="firestore_sequence_number_"+this.persistenceKey,this.Ju=this.Ju.nt(this.zu,new nf),this.ec=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.nc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.sc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ic="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Hu)}function lf(){this.activeTargetIds=Hi}function pf(t,e){this.clientId=t,this.onlineState=e}function df(t,e){this.clientId=t,this.activeTargetIds=e}function yf(t,e,n){this.targetId=t,this.state=e,this.error=n}function vf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function gf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.rl.get(s))&&0!==a.length?[4,e.tu.kh(vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.il.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).tu.$h(o.query,!0)];case 1:return n=t.sent(),r=o.view.Jc(n),[2,(e.dl&&e.El(o.targetId,r.zc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,pc(e.tu,s)];case 8:return d=t.sent(),[4,e.tu.kh(d)];case 9:return u=t.sent(),[4,e.Tl(mf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.sl.Ca(r),n)]}})})}function mf(t){return lu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function wf(){this.Fl=void 0,this.listeners=[]}var bf,Ef=(Pf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Nl.get(e))||(n=!0,r=new wf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.vu.listen(e)];case 2:return i.Fl=t.sent(),[3,4];case 3:return o=t.sent(),s=tc(o,"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.Nl.set(e,r),r.listeners.push(u),u.Hc(this.onlineState),r.Fl&&u.xl(r.Fl)&&this.$l(),[2]}})})},Pf.prototype.pu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.Nl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.Nl.delete(e),this.vu.pu(e))]:[2]})})},Pf.prototype.Ca=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].xl(i)&&(e=!0);s.Fl=i}}e&&this.$l()},Pf.prototype.bl=function(t,e){var n=this.Nl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Nl.delete(t)},Pf.prototype.Rl=function(i){this.onlineState=i;var o=!1;this.Nl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Hc(i)&&(o=!0)}),o&&this.$l()},Pf.prototype.Ml=function(t){this.kl.add(t),t.next()},Pf.prototype.Ol=function(t){this.kl.delete(t)},Pf.prototype.$l=function(){this.kl.forEach(function(t){t.next()})},Pf),If=(Df.prototype.xl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.ql?this.Ul(t)&&(this.Ll.next(t),o=!0):this.Wl(t,this.onlineState)&&(this.Ql(t),o=!0),this.Bl=t,o},Df.prototype.onError=function(t){this.Ll.error(t)},Df.prototype.Hc=function(t){this.onlineState=t;var e=!1;return this.Bl&&!this.ql&&this.Wl(this.Bl,t)&&(this.Ql(this.Bl),e=!0),e},Df.prototype.Wl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.jl&&n||t.docs._()&&"Offline"!==e)},Df.prototype.Ul=function(t){if(0<t.docChanges.length)return!0;var e=this.Bl&&this.Bl.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Df.prototype.Ql=function(t){t=$i.Ut(t.query,t.docs,t.Lt,t.fromCache),this.ql=!0,this.Ll.next(t)},Df),Tf=(kf.prototype.mh=function(t){this.Kl=t},kf.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Jr.min())?this.Gl(e,r):this.Kl.Jn(e,o).next(function(t){var n=s.zl(r,t);return(r.hn()||r.an())&&s.jc(r.en,n,o,i)?s.Gl(e,r):(Sr()<=l.DEBUG&&kr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.Kl.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},kf.prototype.zl=function(n,t){var r=new Vi(Nu(n));return t.forEach(function(t,e){e instanceof ru&&Tu(n,e)&&(r=r.add(e))}),r},kf.prototype.jc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},kf.prototype.Gl=function(t,e){return Sr()<=l.DEBUG&&kr("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.Kl.ts(t,e,Jr.min())},kf),Nf=(Sf.prototype.Or=function(t){return Yu.resolve(0===this.jn.length)},Sf.prototype.Lr=function(t,e,n,r){var i=this.Hl;this.Hl++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new Qu(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Yl=this.Yl.add(new vc(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return Yu.resolve(o)},Sf.prototype.qr=function(t,e){return Yu.resolve(this.Jl(e))},Sf.prototype.Ur=function(t,e){var n=e+1,r=this.Xl(n),i=r<0?0:r;return Yu.resolve(this.jn.length>i?this.jn[i]:null)},Sf.prototype.Wr=function(){return Yu.resolve(0===this.jn.length?-1:this.Hl-1)},Sf.prototype.Qr=function(t){return Yu.resolve(this.jn.slice())},Sf.prototype.zn=function(t,e){var n=this,r=new vc(e,0),i=new vc(e,Number.POSITIVE_INFINITY),o=[];return this.Yl.vt([r,i],function(t){var e=n.Jl(t.zh);o.push(e)}),Yu.resolve(o)},Sf.prototype.Zn=function(t,e){var r=this,i=new Vi(Vr);return e.forEach(function(t){var e=new vc(t,0),n=new vc(t,Number.POSITIVE_INFINITY);r.Yl.vt([e,n],function(t){i=i.add(t.zh)})}),Yu.resolve(this.Zl(i))},Sf.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;ri.W(i)||(i=i.child(""));var o=new vc(new ri(i),0),s=new Vi(Vr);return this.Yl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),Yu.resolve(this.Zl(s))},Sf.prototype.Zl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&r.push(e)}),r},Sf.prototype.Kr=function(n,r){var i=this;Rr(0===this.t_(r.batchId,"removed")),this.jn.shift();var o=this.Yl;return Yu.forEach(r.mutations,function(t){var e=new vc(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.Yl=o})},Sf.prototype.Gr=function(t){},Sf.prototype.pi=function(t,e){var n=new vc(e,0),r=this.Yl.Dt(n);return Yu.resolve(e.isEqual(r&&r.key))},Sf.prototype.zr=function(t){return this.jn.length,Yu.resolve()},Sf.prototype.t_=function(t,e){return this.Xl(t)},Sf.prototype.Xl=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},Sf.prototype.Jl=function(t){var e=this.Xl(t);return e<0||e>=this.jn.length?null:this.jn[e]},Sf),Af=(_f.prototype.kn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.e_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},_f.prototype.$n=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},_f.prototype.Mn=function(t,e){var n=this.docs.get(e);return Yu.resolve(n?n.Ls:null)},_f.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),Yu.resolve(r)},_f.prototype.ts=function(t,e,n){for(var r=Fi,i=new ri(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ls,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof ru&&Tu(e,h)&&(r=r.nt(h.key,h))}return Yu.resolve(r)},_f.prototype.n_=function(t,e){return Yu.forEach(this.docs,function(t){return e(t)})},_f.prototype.Hs=function(t){return new _f.Ys(this)},_f.prototype.Xs=function(t){return Yu.resolve(this.size)},_f);function _f(t,e){this.Kn=t,this.e_=e,this.docs=new Di(ri.P),this.size=0}function Sf(t,e){this.Kn=t,this.ii=e,this.jn=[],this.Hl=1,this.Yl=new Vi(vc.Lh)}function kf(){}function Df(t,e,n){this.query=t,this.Ll=e,this.ql=!1,this.Bl=null,this.onlineState="Unknown",this.options=n||{}}function Pf(t){this.vu=t,this.Nl=new Qr(Eu,bu),this.onlineState="Unknown",this.kl=new Set,this.vu.subscribe(this)}function xf(t){var e=this;return(e=bf.call(this)||this).Zs=t,e}Af.Ys=(n(xf,bf=$u),xf.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.kn(n,e,r.readTime)):r.Zs.$n(t)}),Yu.Sn(i)},xf.prototype.On=function(t,e){return this.Zs.Mn(t,e)},xf.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},xf);var Of,Rf,Lf=($f.prototype.pe=function(t,n){return this.s_.forEach(function(t,e){return n(e)}),Yu.resolve()},$f.prototype.ai=function(t){return Yu.resolve(this.lastRemoteSnapshotVersion)},$f.prototype.ui=function(t){return Yu.resolve(this.i_)},$f.prototype.ri=function(t){return this.highestTargetId=this.o_.next(),Yu.resolve(this.highestTargetId)},$f.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.i_&&(this.i_=e),Yu.resolve()},$f.prototype._i=function(t){this.s_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.o_=new Ba(e),this.highestTargetId=e),t.sequenceNumber>this.i_&&(this.i_=t.sequenceNumber)},$f.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,Yu.resolve()},$f.prototype.di=function(t,e){return this._i(e),Yu.resolve()},$f.prototype.wi=function(t,e){return this.s_.delete(e.target),this.r_.jh(e.targetId),--this.targetCount,Yu.resolve()},$f.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.s_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.s_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),Yu.Sn(u).next(function(){return s})},$f.prototype.Ii=function(t){return Yu.resolve(this.targetCount)},$f.prototype.mi=function(t,e){var n=this.s_.get(e)||null;return Yu.resolve(n)},$f.prototype.Ai=function(t,e,n){return this.r_.Uh(e,n),Yu.resolve()},$f.prototype.Pi=function(e,t,n){this.r_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),Yu.Sn(i)},$f.prototype.Ti=function(t,e){return this.r_.jh(e),Yu.resolve()},$f.prototype.Vi=function(t,e){var n=this.r_.Gh(e);return Yu.resolve(n)},$f.prototype.pi=function(t,e){return Yu.resolve(this.r_.pi(e))},$f),Cf=(Yf.prototype.start=function(){return Promise.resolve()},Yf.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(Yf.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),Yf.prototype.Yi=function(){},Yf.prototype.Xi=function(){},Yf.prototype.gr=function(){return this.Kn},Yf.prototype.mr=function(t){var e=this.h_[t.Hh()];return e||(e=new Nf(this.Kn,this.ii),this.h_[t.Hh()]=e),e},Yf.prototype.Rr=function(){return this.qi},Yf.prototype.Pr=function(){return this.Qn},Yf.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new Vf(this.Ci.next());return this.ii.u_(),n(i).next(function(t){return r.ii.c_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},Yf.prototype.l_=function(e,n){return Yu.Dn(Object.values(this.h_).map(function(t){return function(){return t.pi(e,n)}}))},Yf),Vf=(n(Xf,Rf=Zu),Xf),Mf=(Qf.d_=function(t){return new Qf(t)},Object.defineProperty(Qf.prototype,"w_",{get:function(){if(this.f_)return this.f_;throw Or()},enumerable:!1,configurable:!0}),Qf.prototype.Ri=function(t,e,n){return this.__.Ri(n,e),this.w_.delete(n),Yu.resolve()},Qf.prototype.gi=function(t,e,n){return this.__.gi(n,e),this.w_.add(n),Yu.resolve()},Qf.prototype.Dr=function(t,e){return this.w_.add(e),Yu.resolve()},Qf.prototype.removeTarget=function(t,e){var n=this;this.__.jh(e.targetId).forEach(function(t){return n.w_.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.w_.add(t)})}).next(function(){return r.wi(t,e)})},Qf.prototype.u_=function(){this.f_=new Set},Qf.prototype.c_=function(t){var n=this,r=this.persistence.Pr().Hs();return Yu.forEach(this.w_,function(e){return n.T_(t,e).next(function(t){t||r.$n(e)})}).next(function(){return n.f_=null,r.apply(t)})},Qf.prototype.kr=function(t,e){var n=this;return this.T_(t,e).next(function(t){t?n.w_.delete(e):n.w_.add(e)})},Qf.prototype.a_=function(t){return 0},Qf.prototype.T_=function(t,e){var n=this;return Yu.Dn([function(){return Yu.resolve(n.__.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.l_(t,e)}])},Qf),Uf=(Wf.prototype.Sa=function(t){this.m_=t},Wf.prototype.Va=function(t){this.A_=t},Wf.prototype.onMessage=function(t){this.R_=t},Wf.prototype.close=function(){this.I_()},Wf.prototype.send=function(t){this.E_(t)},Wf.prototype.P_=function(){this.m_()},Wf.prototype.g_=function(t){this.A_(t)},Wf.prototype.V_=function(t){this.R_(t)},Wf),jf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},qf=(Kf.prototype.Ua=function(e,t,n,r){var i=this.v_(e,t);kr("RestConnection","Sending: ",i,n);var o={};return this.S_(o,r),this.D_(e,i,o,n).then(function(t){return kr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Kf.prototype.Wa=function(t,e,n,r){return this.Ua(t,e,n,r)},Kf.prototype.S_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2",t["Content-Type"]="text/plain",e)for(var n in e.Xh)e.Xh.hasOwnProperty(n)&&(t[n]=e.Xh[n])},Kf.prototype.v_=function(t,e){var n=jf[t];return this.p_+"/v1/"+e+":"+n},n(Hf,Of=Kf),Hf.prototype.D_=function(a,e,n,r){return new Promise(function(o,s){var u=new Tr;u.listenOnce(Er.COMPLETE,function(){try{switch(u.getLastErrorCode()){case br.NO_ERROR:var t=u.getResponseJson();kr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:kr("Connection",'RPC "'+a+'" timed out'),s(new Yr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=u.getStatus();kr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Xr).indexOf(i)?i:Xr.UNKNOWN,s(new Yr(n,e.message))):s(new Yr(Xr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Yr(Xr.UNAVAILABLE,"Connection failed."));break;default:Or()}}finally{kr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},Hf.prototype.Da=function(t,e){var n,r,i=[this.p_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.S_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}kr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Uf({E_:function(t){f?kr("Connection","Not sending because WebChannel is closed:",t):(c||(kr("Connection","Opening WebChannel transport."),h.open(),c=!0),kr("Connection","WebChannel sending:",t),h.send(t))},I_:function(){return h.close()}});return a(Ir.EventType.OPEN,function(){f||kr("Connection","WebChannel transport opened.")}),a(Ir.EventType.CLOSE,function(){f||(f=!0,kr("Connection","WebChannel transport closed"),l.g_())}),a(Ir.EventType.ERROR,function(t){f||(f=!0,Pr("Connection","WebChannel transport errored:",t),l.g_(new Yr(Xr.UNAVAILABLE,"The operation could not be completed")))}),a(Ir.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Rr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(kr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ti[i];if(void 0!==t)return ki(t)}(),s=r.message,void 0===o&&(o=Xr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.g_(new Yr(o,s)),h.close()):(kr("Connection","WebChannel received:",n),l.V_(n)))}),setTimeout(function(){l.P_()},0),l},Hf),Ff=(zf.prototype.hu=function(t){this.x_.push(t)},zf.prototype._r=function(){window.removeEventListener("online",this.C_),window.removeEventListener("offline",this.N_)},zf.prototype.M_=function(){window.addEventListener("online",this.C_),window.addEventListener("offline",this.N_)},zf.prototype.F_=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(0)},zf.prototype.k_=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(1)},zf.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},zf),Bf=(Gf.prototype.hu=function(t){},Gf.prototype._r=function(){},Gf);function Gf(){}function zf(){var t=this;this.C_=function(){return t.F_()},this.N_=function(){return t.k_()},this.x_=[],this.M_()}function Hf(t){var e=this;return(e=Of.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Kf(t){this.y_=t,this.s=t.s;var e=t.ssl?"https":"http";this.p_=e+"://"+t.host,this.b_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Wf(t){this.E_=t.E_,this.I_=t.I_}function Qf(t){this.persistence=t,this.__=new yc,this.f_=null}function Xf(t){var e=this;return(e=Rf.call(this)||this).vi=t,e}function Yf(t){var e=this;this.h_={},this.Ci=new na(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new Lf(this),this.Kn=new ga,this.Qn=new Af(this.Kn,function(t){return e.ii.a_(t)})}function $f(t){this.persistence=t,this.s_=new Qr(gi,mi),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this.i_=0,this.r_=new yc,this.targetCount=0,this.o_=Ba.ni()}function Jf(t){return new Oo(t,!0)}var Zf,tl,el="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",nl=(al.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.el=this.O_(e),this.persistence=this.L_(e),[4,this.persistence.start()];case 1:return t.sent(),this.q_=this.B_(e),this.tu=this.U_(e),[2]}})})},al.prototype.B_=function(t){return null},al.prototype.U_=function(t){return e=this.persistence,n=new Tf,r=t.W_,new hc(e,n,r);var e,n,r},al.prototype.L_=function(t){if(t.j_.Q_)throw new Yr(Xr.FAILED_PRECONDITION,el);return new Cf(Mf.d_)},al.prototype.O_=function(t){return new of},al.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.el._r()];case 1:return t.sent(),[4,this.persistence._r()];case 2:return t.sent(),[2]}})})},al.prototype.clearPersistence=function(t,e){throw new Yr(Xr.FAILED_PRECONDITION,el)},al),rl=(n(ul,tl=nl),ul.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,tl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Eh,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.tu)];case 2:return t.sent(),[2]}})})},ul.prototype.B_=function(t){var e=this.persistence.ii.yr;return new uc(e,t.ao)},ul.prototype.L_=function(t){var e=sh(t.y_.s,t.y_.persistenceKey),n=Jf(t.y_.s);return new Ja(t.j_.synchronizeTabs,e,t.clientId,ic.Ho(t.j_.cacheSizeBytes),t.ao,Xh(),"undefined"!=typeof document?document:null,n,this.el,t.j_.Di)},ul.prototype.O_=function(t){return new of},ul.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ch.Oi()?(e=n+"main",[4,Ch.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(sh(t,e))},n(sl,Zf=ul),sl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,Zf.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.K_.initialize(this,r)];case 2:return t.sent(),e=this.K_.vu,this.el instanceof rf?(this.el.vu={Cc:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).wl("applyBatchState()"),[4,(e=o.tu,n=a,i=(r=e).jn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.Ih.Jn(e,t):Yu.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.tl.Pu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.gl(a,c||null),o.tu.jn.Gr(a)):Or(),t.label=4;case 4:return[4,o.Al(s)];case 5:return t.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),Fc:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).fl?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.rl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.tu,e=r.Eh,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=Ji.Gt(u,"current"===a),[4,n.Al(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.tu.xh(u,!0)];case 6:return t.sent(),n.Il(u,h),[3,8];case 7:Or(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),Nc:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).fl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.rl.has(i)?(kr("SyncEngine","Adding an already active target "+i),[3,5]):[4,pc(n.tu,i)]):[3,6];case 2:return o=t.sent(),[4,n.tu.kh(o)];case 3:return s=t.sent(),[4,n.Tl(mf(o),s.targetId,!1)];case 4:t.sent(),n.tl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.rl.has(e)?[4,n.tu.xh(e,!1).then(function(){n.tl.pu(e),n.Il(e)}).catch(dc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Ir:function(t){return t.tu.persistence.Ir()}.bind(null,e)},[4,this.el.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.fl?[3,3]:(e=r.el.ac(),[4,gf(r,e.F())]);case 1:return i=t.sent(),r.fl=!0,[4,r.tl.Wu(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.tl.listen(u);return[3,7];case 3:return!1!==f||!1===r.fl?[3,7]:(a=[],h=Promise.resolve(),r.rl.forEach(function(t,e){r.el.Ic(e)?a.push(e):h=h.then(function(){return r.Il(e),r.tu.xh(e,!0)}),r.tl.pu(e)}),[4,h]);case 4:return t.sent(),[4,gf(r,a)];case 5:return t.sent(),(n=r).al.forEach(function(t,e){n.tl.pu(e)}),n.ul.Kh(),n.al=new Map,n.hl=new Di(ri.P),r.fl=!1,[4,r.tl.Wu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.K_.vu,e)];case 1:return t.sent(),this.q_&&(e&&!this.q_.Hi?this.q_.start(this.tu):e||this.q_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},sl.prototype.O_=function(t){if(t.j_.Q_&&t.j_.synchronizeTabs){var e=Xh();if(!rf.Oi(e))throw new Yr(Xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=sh(t.y_.s,t.y_.persistenceKey);return new rf(e,t.ao,n,t.clientId,t.W_)}return new of},sl),il=(ol.prototype.initialize=function(r,i){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.tu?[2]:(this.tu=r.tu,this.el=r.el,this.eu=this.G_(i),[4,this.z_(i)]);case 1:return e=t.sent(),this.eu.start(e),this.tl=this.H_(i),this.vu=this.Y_(i),this.J_=this.X_(i),this.el.ja=function(t){return n.vu.Hc(t,1)},this.tl.vu=this.vu,[4,this.tl.start()];case 2:return t.sent(),[4,this.tl.Wu(this.vu.dl)];case 3:return t.sent(),[2]}})})},ol.prototype.z_=function(t){return e=t.y_,Promise.resolve(new qf(e));var e},ol.prototype.X_=function(t){return new Ef(this.vu)},ol.prototype.G_=function(t){var e=Jf(t.y_.s),n=t.credentials;return new Oc(n,e)},ol.prototype.H_=function(t){var e=this;return new Lc(this.tu,this.eu,t.ao,function(t){return e.vu.Hc(t,0)},new(Ff.Oi()?Ff:Bf))},ol.prototype.Y_=function(t){return e=this.tu,n=this.tl,r=this.eu,i=this.el,o=t.W_,s=t.nl,u=!t.j_.Q_||!t.j_.synchronizeTabs,a=new uf(e,n,r,i,o,s),u&&(a.fl=!0),a;var e,n,r,i,o,s,u,a},ol.prototype.terminate=function(){return this.tl._r()},ol);function ol(){}function sl(t){var e=this;return(e=Zf.call(this)||this).K_=t,e}function ul(){return null!==tl&&tl.apply(this,arguments)||this}function al(){}function hl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var cl=(fl.prototype.next=function(t){this.observer.next&&this.Z_(this.observer.next,t)},fl.prototype.error=function(t){this.observer.error?this.Z_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},fl.prototype.tf=function(){this.muted=!0},fl.prototype.Z_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},fl);function fl(t){this.observer=t,this.muted=!1}function ll(t,e){if(0!==e.length)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Pl(e.length,"argument")+".")}function pl(t,e,n){if(e.length!==n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires "+Pl(n,"argument")+", but was called with "+Pl(e.length,"argument")+".")}function dl(t,e,n){if(e.length<n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Pl(n,"argument")+", but was called with "+Pl(e.length,"argument")+".")}function yl(t,e,n,r){if(e.length<n||e.length>r)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Pl(e.length,"argument")+".")}function vl(t,e,n,r){Il(t,e,Dl(n)+" argument",r)}function gl(t,e,n,r){void 0!==r&&vl(t,e,n,r)}function ml(t,e,n,r){Il(t,e,n+" option",r)}function wl(t,e,n,r){void 0!==r&&ml(t,e,n,r)}function bl(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Nl(s))}var u=Nl(n);throw new Yr(Xr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function El(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid value "+Nl(r)+" provided to function "+t+"() for its "+Dl(n)+" argument. Acceptable values: "+e.join(", "));return r}function Il(t,e,n,r){if(!("object"===e?Tl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Nl(r);throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Tl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Nl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Or();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Al(t,e,n){if(void 0===n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Dl(e)+" argument, but it was undefined.")}function _l(n,t,r){Gr(t,function(t,e){if(r.indexOf(t)<0)throw new Yr(Xr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Sl(t,e,n,r){var i=Nl(r);return new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Dl(n)+" argument to be a "+e+", but it was: "+i)}function kl(t,e,n){if(n<=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Dl(e)+" argument to be a positive number, but it was: "+n+".")}function Dl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Pl(t,e){return t+" "+e+(1===t?"":"s")}function xl(){if("undefined"==typeof Uint8Array)throw new Yr(Xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ol(){if("undefined"==typeof atob)throw new Yr(Xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Rl,Ll,Cl=(Gl.fromBase64String=function(t){pl("Blob.fromBase64String",arguments,1),vl("Blob.fromBase64String","string",1,t),Ol();try{return new Gl(bi.fromBase64String(t))}catch(t){throw new Yr(Xr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Gl.fromUint8Array=function(t){if(pl("Blob.fromUint8Array",arguments,1),xl(),!(t instanceof Uint8Array))throw Sl("Blob.fromUint8Array","Uint8Array",1,t);return new Gl(bi.fromUint8Array(t))},Gl.prototype.toBase64=function(){return pl("Blob.toBase64",arguments,0),Ol(),this.ef.toBase64()},Gl.prototype.toUint8Array=function(){return pl("Blob.toUint8Array",arguments,0),xl(),this.ef.toUint8Array()},Gl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Gl.prototype.isEqual=function(t){return this.ef.isEqual(t.ef)},Gl),Vl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yr(Xr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(vl("FieldPath","string",e,t[e]),0===t[e].length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.nf=new ni(t)},Ml=(n(Bl,Ll=Vl),Bl.documentId=function(){return new Bl(ni.L().N())},Bl.prototype.isEqual=function(t){if(!(t instanceof Bl))throw Sl("isEqual","FieldPath",1,t);return this.nf.isEqual(t.nf)},Bl),Ul=new RegExp("[~\\*/\\[\\]]"),jl=function(){this.sf=this},ql=(n(Fl,Rl=jl),Fl.prototype.rf=function(t){if(2!==t.hf)throw 1===t.hf?t.af(this.if+"() can only appear at the top level of your update data"):t.af(this.if+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Fl.prototype.isEqual=function(t){return t instanceof Fl},Fl);function Fl(t){var e=this;return(e=Rl.call(this)||this).if=t,e}function Bl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ll.call(this,t)||this}function Gl(t){Ol(),this.ef=t}function zl(t,e,n){return new mp({hf:3,uf:e.settings.uf,methodName:t.if,cf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Hl,Kl,Wl,Ql,Xl,Yl,$l=(n(vp,Yl=jl),vp.prototype.rf=function(t){return new Is(t.path,new us)},vp.prototype.isEqual=function(t){return t instanceof vp},vp),Jl=(n(yp,Xl=jl),yp.prototype.rf=function(t){var e=zl(this,t,!0),n=this.lf.map(function(t){return _p(t,e)}),r=new as(n);return new Is(t.path,r)},yp.prototype.isEqual=function(t){return this===t},yp),Zl=(n(dp,Ql=jl),dp.prototype.rf=function(t){var e=zl(this,t,!0),n=this.lf.map(function(t){return _p(t,e)}),r=new ps(n);return new Is(t.path,r)},dp.prototype.isEqual=function(t){return this===t},dp),tp=(n(pp,Wl=jl),pp.prototype.rf=function(t){var e=new gs(t.serializer,Co(t.serializer,this._f));return new Is(t.path,e)},pp.prototype.isEqual=function(t){return this===t},pp),ep=(n(lp,Kl=jl),lp.delete=function(){return ll("FieldValue.delete",arguments),new np(new ql("FieldValue.delete"))},lp.serverTimestamp=function(){return ll("FieldValue.serverTimestamp",arguments),new np(new $l("FieldValue.serverTimestamp"))},lp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dl("FieldValue.arrayUnion",arguments,1),new np(new Jl("FieldValue.arrayUnion",t))},lp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dl("FieldValue.arrayRemove",arguments,1),new np(new Zl("FieldValue.arrayRemove",t))},lp.increment=function(t){return vl("FieldValue.increment","number",1,t),pl("FieldValue.increment",arguments,1),new np(new tp("FieldValue.increment",t))},lp),np=(n(fp,Hl=ep),fp.prototype.rf=function(t){return this.sf.rf(t)},fp.prototype.isEqual=function(t){return t instanceof fp&&this.sf.isEqual(t.sf)},fp),rp=(Object.defineProperty(cp.prototype,"latitude",{get:function(){return this.ff},enumerable:!1,configurable:!0}),Object.defineProperty(cp.prototype,"longitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),cp.prototype.isEqual=function(t){return this.ff===t.ff&&this.df===t.df},cp.prototype.T=function(t){return Vr(this.ff,t.ff)||Vr(this.df,t.df)},cp),ip=/^__.*__$/,op=function(t,e,n){this.wf=t,this.Tf=e,this.Ef=n},sp=(hp.prototype.If=function(t,e){var n=[];return null!==this.Le?n.push(new Cs(t,this.data,this.Le,e)):n.push(new Ls(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},hp),up=(ap.prototype.If=function(t,e){var n=[new Cs(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},ap);function ap(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function hp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function cp(t,e){if(pl("GeoPoint",arguments,2),vl("GeoPoint","number",1,t),vl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ff=t,this.df=e}function fp(t){var e=this;return(e=Hl.call(this)||this).sf=t,e.if=t.if,e}function lp(){return Kl.call(this)||this}function pp(t,e){var n=this;return(n=Wl.call(this)||this).if=t,n._f=e,n}function dp(t,e){var n=this;return(n=Ql.call(this)||this).if=t,n.lf=e,n}function yp(t,e){var n=this;return(n=Xl.call(this)||this).if=t,n.lf=e,n}function vp(t){var e=this;return(e=Yl.call(this)||this).if=t,e}function gp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Or()}}var mp=(Object.defineProperty(Ep.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"hf",{get:function(){return this.settings.hf},enumerable:!1,configurable:!0}),Ep.prototype.Af=function(t){return new Ep(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Ep.prototype.Rf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.Pf(t),r},Ep.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.mf(),r},Ep.prototype.Vf=function(t){return this.Af({path:void 0,cf:!0})},Ep.prototype.af=function(t){return Op(t,this.settings.methodName,this.settings.yf||!1,this.path,this.settings.uf)},Ep.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Ep.prototype.mf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Pf(this.path.get(t))},Ep.prototype.Pf=function(t){if(0===t.length)throw this.af("Document fields must not be empty");if(gp(this.hf)&&ip.test(t))throw this.af('Document fields cannot begin and end with "__"')},Ep),wp=(bp.prototype.pf=function(t,e,n,r){return void 0===r&&(r=!1),new mp({hf:t,methodName:e,uf:n,path:ni.$(),cf:!1,yf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},bp);function bp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Jf(t)}function Ep(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mf(),this.fieldTransforms=i||[],this.Le=o||[]}function Ip(t,e,n,r,i,o){void 0===o&&(o={});var s=t.pf(o.merge||o.mergeFields?2:0,e,n,i);Dp("Data must be an object, but it was:",s,r);var u,a,h=Sp(r,s);if(o.merge)u=new Es(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Vl)d=p.nf;else{if("string"!=typeof p)throw Or();d=xp(e,p,n)}if(!s.contains(d))throw new Yr(Xr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Rp(c,d)||c.push(d)}u=new Es(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new sp(new Ws(h),u,a)}function Tp(t,o,s,e){var u=t.pf(1,o,s);Dp("Data must be an object, but it was:",u,e);var a=[],h=new Qs;Gr(e,function(t,e){var n,r=xp(o,t,s),i=u.gf(r);e instanceof jl&&e.sf instanceof ql?a.push(r):null!=(n=_p(e,i))&&(a.push(r),h.set(r,n))});var n=new Es(a);return new up(h.Ge(),n,u.fieldTransforms)}function Np(t,e,n,r,i,o){var s=t.pf(1,e,n),u=[Pp(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Pp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Qs,v=u.length-1;0<=v;--v)Rp(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof jl&&f.sf instanceof ql?d.push(c):null!=(p=_p(f,l))&&(d.push(c),y.set(c,p)));var g=new Es(d);return new up(y.Ge(),g,s.fieldTransforms)}function Ap(t,e,n,r){return void 0===r&&(r=!1),_p(n,t.pf(r?4:3,e))}function _p(s,t){if(kp(s))return Dp("Unsupported field value:",t,s),Sp(s,t);if(s instanceof jl)return function(t,e){if(!gp(e.hf))throw e.af(t.if+"() can only be used with update() and set()");if(!e.path)throw e.af(t.if+"() is not currently supported inside arrays");var n=t.rf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.cf&&4!==t.hf)throw t.af("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=_p(i[r],t.Vf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof rp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Cl)return{bytesValue:Mo(e.serializer,t)};if(t instanceof op){var i=e.s,o=t.wf;if(!o.isEqual(i))throw e.af("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:jo(t.wf||e.s,t.Tf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.af("Unsupported field value: "+Nl(t))}(s,t)}function Sp(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Gr(t,function(t,e){var n=_p(e,r.Rf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function kp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof rp||t instanceof Cl||t instanceof op||t instanceof jl)}function Dp(t,e,n){if(!kp(n)||!Tl(n)){var r=Nl(n);throw"an object"===r?e.af(t+" a custom object"):e.af(t+" "+r)}}function Pp(t,e,n){if(e instanceof Vl)return e.nf;if("string"==typeof e)return xp(t,e);throw Op("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function xp(t,e,n){try{return function(e){if(0<=e.search(Ul))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ml.bind.apply(Ml,i([void 0],e.split("."))))}catch(t){throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).nf}catch(e){throw Op(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Op(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Yr(Xr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Rp(t,e){return t.some(function(t){return t.isEqual(e)})}var Lp=(jp.prototype.Cf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new Yr(Xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ho((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Fo(i.serializer,t)})},[4,i.Wa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),r=Uo(e.found.updateTime),i=new Ws({mapValue:{fields:e.found.fields}});return new ru(n,r,i,{})}(e,n):"missing"in n?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);var n=Bo(t,e.missing),r=Uo(e.readTime);return new iu(n,r)}(e,n):Or());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Rr(!!e),s.push(e)}),s)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof iu||t instanceof ru?n.Nf(t):Or()}),e)]}})})},jp.prototype.set=function(t,e){this.write(e.If(t,this.Ue(t))),this.Df.add(t)},jp.prototype.update=function(t,e){try{this.write(e.If(t,this.kf(t)))}catch(t){this.Sf=t}this.Df.add(t)},jp.prototype.delete=function(t){this.write([new Hs(t,this.Ue(t))]),this.Df.add(t)},jp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Sf)throw this.Sf;return e=this.bf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ri(ti.k(e));r.mutations.push(new Ks(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Qo(e.serializer,t)})},[4,e.Ua("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.vf=!0,[2]}})})},jp.prototype.Nf=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw Or();e=Jr.min()}var n=this.bf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Xr.ABORTED,"Document version changed between two reads.")}else this.bf.set(t.key.toString(),e)},jp.prototype.Ue=function(t){var e=this.bf.get(t.toString());return!this.Df.has(t)&&e?As.updateTime(e):As.We()},jp.prototype.kf=function(t){var e=this.bf.get(t.toString());if(this.Df.has(t)||!e)return As.exists(!0);if(e.isEqual(Jr.min()))throw new Yr(Xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},jp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},jp.prototype.Ff=function(){},jp),Cp=(Up.prototype.run=function(){this.$f()},Up.prototype.$f=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Lp(this.eu),(n=this.Mf(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.Of(t)})})}).catch(function(t){r.Of(t)}),[2]})})})},Up.prototype.Mf=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},Up.prototype.Of=function(t){var e=this;0<this.xf&&this.Lf(t)?(--this.xf,this.ao.Zi(function(){return e.$f(),Promise.resolve()})):this.lo.reject(t)},Up.prototype.Lf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Si(e)},Up),Vp=(Mp.prototype.start=function(t,e,n,r){var i=this;this.Bf(),this.y_=t;var o=new fa,s=!1;return this.credentials.ea(function(t){return s?void i.ao.er(function(){return i.tl.Uu(t)}):(s=!0,kr("FirestoreClient","Initializing. user=",t.uid),i.Uf(e,n,r,t,o).then(i.qf.resolve,i.qf.reject))}),this.ao.Zi(function(){return i.qf.promise}),o.promise},Mp.prototype.enableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.tl.enableNetwork()})},Mp.prototype.Uf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ao:this.ao,y_:this.y_,clientId:this.clientId,credentials:this.credentials,W_:u,nl:100,j_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.el=i.el,this.tu=i.tu,this.q_=i.q_,this.eu=o.eu,this.tl=o.tl,this.vu=o.vu,this.Wf=o.J_,this.persistence.Yi(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Qf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Uf(new nl,new il,{Q_:!1},u,a))];case 4:return[2]}})})},Mp.prototype.Qf=function(t){return"FirebaseError"===t.name?t.code===Xr.FAILED_PRECONDITION||t.code===Xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Mp.prototype.Bf=function(){if(this.ao.yo)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Mp.prototype.disableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.tl.disableNetwork()})},Mp.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.tl._r()];case 1:return t.sent(),[4,this.el._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.na(),[2]}})})})},Mp.prototype.waitForPendingWrites=function(){var t=this;this.Bf();var e=new fa;return this.ao.Zi(function(){return t.vu.yl(e)}),e.promise},Mp.prototype.listen=function(t,e,n){var r=this;this.Bf();var i=new cl(n),o=new If(t,i,e);return this.ao.Zi(function(){return r.Wf.listen(o)}),function(){i.tf(),r.ao.Zi(function(){return r.Wf.pu(o)})}},Mp.prototype.jf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new fa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.Nh(s)];case 1:return(e=t.sent())instanceof ru?i.resolve(e):e instanceof iu?i.resolve(null):i.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=tc(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ao,this.tu,e))]}})})},Mp.prototype.Kf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new fa,s=qp(e,n,pu(r.path),{includeMetadataChanges:!0,jl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Mp.prototype.Gf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new fa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.$h(h,!0)];case 1:return e=t.sent(),n=new sf(h,e.Mh),r=n.Uc(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=tc(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ao,this.tu,e))]}})})},Mp.prototype.zf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new fa,s=qp(e,n,r,{includeMetadataChanges:!0,jl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Mp.prototype.write=function(t){var e=this;this.Bf();var n=new fa;return this.ao.Zi(function(){return e.vu.write(t,n)}),n.promise},Mp.prototype.s=function(){return this.y_.s},Mp.prototype.Ml=function(t){var e=this;this.Bf();var n=new cl(t);return this.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ml(n)]})})}),function(){n.tf(),e.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ol(n)]})})})}},Object.defineProperty(Mp.prototype,"Hf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Mp.prototype.transaction=function(t){var e=this;this.Bf();var n=new fa;return this.ao.Zi(function(){return new Cp(e.ao,e.eu,t,n).run(),Promise.resolve()}),n.promise},Mp);function Mp(t,e){this.credentials=t,this.ao=e,this.clientId=Lr.t(),this.qf=new fa}function Up(t,e,n,r){this.ao=t,this.eu=e,this.updateFunction=n,this.lo=r,this.xf=5,this.Po=new la(this.ao,"transaction_retry")}function jp(t){this.eu=t,this.bf=new Map,this.mutations=[],this.vf=!1,this.Sf=null,this.Df=new Set}function qp(t,e,n,r,i){var o=new cl(i),s=new If(n,o,r);return t.Zi(function(){return e.listen(s)}),function(){o.tf(),t.Zi(function(){return e.pu(s)})}}var Fp,Bp,Gp=(ud.prototype.Xf=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Zf(t.timestampValue);case 4:return this.td(t);case 5:return t.stringValue;case 6:return new Cl(To(t.bytesValue));case 7:return this.ed(t.referenceValue);case 8:return this.nd(t.geoPointValue);case 9:return this.sd(t.arrayValue);case 10:return this.rd(t.mapValue);default:throw Or()}},ud.prototype.rd=function(t){var n=this,r={};return Gr(t.fields||{},function(t,e){r[t]=n.Xf(e)}),r},ud.prototype.nd=function(t){return new rp(Io(t.latitude),Io(t.longitude))},ud.prototype.sd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Xf(t)})},ud.prototype.td=function(t){switch(this.Yf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return fo(n)?t(n):n}(t);return null==e?null:this.Xf(e);case"estimate":return this.Zf(lo(t));default:return null}},ud.prototype.Zf=function(t){var e=Eo(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},ud.prototype.ed=function(t){var e=ti.k(t);Rr(ns(e));var n=new qr(e.get(1),e.get(3)),r=new ri(e.V(5));return n.isEqual(this.s)||Dr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Jf(r)},ud),zp=ic.Xo,Hp=(sd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},sd),Kp=(Object.defineProperty(od.prototype,"Ed",{get:function(){return this.Id||(this.Id=new wp(this.wf,this.Td.ignoreUndefinedProperties)),this.Id},enumerable:!1,configurable:!0}),od.prototype.settings=function(t){pl("Firestore.settings",arguments,1),vl("Firestore.settings","object",1,t);var e=new Hp(t);if(this._d&&!this.Td.isEqual(e))throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Td=e).credentials&&(this.wd=function(t){if(!t)return new Ac;switch(t.type){case"gapi":var e=t.md;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new kc(e,t.aa||"0");case"provider":return t.md;default:throw new Yr(Xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},od.prototype.enableNetwork=function(){return this.ld(),this._d.enableNetwork()},od.prototype.disableNetwork=function(){return this.ld(),this._d.disableNetwork()},od.prototype.enablePersistence=function(t){var e,n;if(this._d)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Dr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Yr(Xr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ad(this.od,this.hd,{Q_:!0,cacheSizeBytes:this.Td.cacheSizeBytes,synchronizeTabs:r,Di:i})},od.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this._d&&!this._d.Hf)throw new Yr(Xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new fa,[2,(this.ud.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.od.clearPersistence(this.wf,this.dd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},od.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(od.prototype,"Rd",{get:function(){return this.ld(),this._d.Hf},enumerable:!1,configurable:!0}),od.prototype.waitForPendingWrites=function(){return this.ld(),this._d.waitForPendingWrites()},od.prototype.onSnapshotsInSync=function(t){if(this.ld(),hl(t))return this._d.Ml(t);vl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this._d.Ml(e)},od.prototype.ld=function(){return this._d||this.Ad(new nl,new il,{Q_:!1}),this._d},od.prototype.Pd=function(){return new jr(this.wf,this.dd,this.Td.host,this.Td.ssl,this.Td.forceLongPolling)},od.prototype.Ad=function(t,e,n){var r=this.Pd();return this._d=new Vp(this.wd,this.ud),this._d.start(r,t,e,n)},od.fd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yr(Xr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qr(n)},Object.defineProperty(od.prototype,"app",{get:function(){if(!this.ad)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ad},enumerable:!1,configurable:!0}),od.prototype.collection=function(t){return pl("Firestore.collection",arguments,1),vl("Firestore.collection","non-empty string",1,t),this.ld(),new yd(ti.k(t),this,null)},od.prototype.doc=function(t){return pl("Firestore.doc",arguments,1),vl("Firestore.doc","non-empty string",1,t),this.ld(),Xp.gd(ti.k(t),this,null)},od.prototype.collectionGroup=function(t){if(pl("Firestore.collectionGroup",arguments,1),vl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ld(),new pd((e=t,new cu(ti.$(),e)),this,null);var e},od.prototype.runTransaction=function(e){var n=this;return pl("Firestore.runTransaction",arguments,1),vl("Firestore.runTransaction","function",1,e),this.ld().transaction(function(t){return e(new Wp(n,t))})},od.prototype.batch=function(){return this.ld(),new Qp(this)},Object.defineProperty(od,"logLevel",{get:function(){switch(Sr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),od.setLogLevel=function(t){pl("Firestore.setLogLevel",arguments,1),El("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_r.setLogLevel(t)},od.prototype.Vd=function(){return this.Td.timestampsInSnapshots},od),Wp=(id.prototype.get=function(t){var n=this;pl("Transaction.get",arguments,1);var r=Id("Transaction.get",t,this.yd);return this.pd.Cf([r.Tf]).then(function(t){if(!t||1!==t.length)return Or();var e=t[0];if(e instanceof iu)return new $p(n.yd,r.Tf,null,!1,!1,r.Ef);if(e instanceof ru)return new $p(n.yd,r.Tf,e,!1,!1,r.Ef);throw Or()})},id.prototype.set=function(t,e,n){yl("Transaction.set",arguments,2,3);var r=Id("Transaction.set",t,this.yd);n=wd("Transaction.set",n);var i=Td(r.Ef,e,n),o=Ip(this.yd.Ed,"Transaction.set",r.Tf,i,null!==r.Ef,n);return this.pd.set(r.Tf,o),this},id.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Ml?(dl("Transaction.update",arguments,3),r=Id("Transaction.update",t,this.yd),Np(this.yd.Ed,"Transaction.update",r.Tf,e,n,o)):(pl("Transaction.update",arguments,2),r=Id("Transaction.update",t,this.yd),Tp(this.yd.Ed,"Transaction.update",r.Tf,e)),this.pd.update(r.Tf,i),this},id.prototype.delete=function(t){pl("Transaction.delete",arguments,1);var e=Id("Transaction.delete",t,this.yd);return this.pd.delete(e.Tf),this},id),Qp=(rd.prototype.set=function(t,e,n){yl("WriteBatch.set",arguments,2,3),this.Sd();var r=Id("WriteBatch.set",t,this.yd);n=wd("WriteBatch.set",n);var i=Td(r.Ef,e,n),o=Ip(this.yd.Ed,"WriteBatch.set",r.Tf,i,null!==r.Ef,n);return this.bd=this.bd.concat(o.If(r.Tf,As.We())),this},rd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Sd(),i="string"==typeof e||e instanceof Ml?(dl("WriteBatch.update",arguments,3),r=Id("WriteBatch.update",t,this.yd),Np(this.yd.Ed,"WriteBatch.update",r.Tf,e,n,o)):(pl("WriteBatch.update",arguments,2),r=Id("WriteBatch.update",t,this.yd),Tp(this.yd.Ed,"WriteBatch.update",r.Tf,e)),this.bd=this.bd.concat(i.If(r.Tf,As.exists(!0))),this},rd.prototype.delete=function(t){pl("WriteBatch.delete",arguments,1),this.Sd();var e=Id("WriteBatch.delete",t,this.yd);return this.bd=this.bd.concat(new Hs(e.Tf,As.We())),this},rd.prototype.commit=function(){return this.Sd(),this.vd=!0,0<this.bd.length?this.yd.ld().write(this.bd):Promise.resolve()},rd.prototype.Sd=function(){if(this.vd)throw new Yr(Xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},rd),Xp=(n(nd,Bp=op),nd.gd=function(t,e,n){if(t.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new nd(new ri(t),e,n)},Object.defineProperty(nd.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"parent",{get:function(){return new yd(this.Tf.path.p(),this.firestore,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"path",{get:function(){return this.Tf.path.N()},enumerable:!1,configurable:!0}),nd.prototype.collection=function(t){if(pl("DocumentReference.collection",arguments,1),vl("DocumentReference.collection","non-empty string",1,t),!t)throw new Yr(Xr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ti.k(t);return new yd(this.Tf.path.child(e),this.firestore,null)},nd.prototype.isEqual=function(t){if(!(t instanceof nd))throw Sl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Tf.isEqual(t.Tf)&&this.Ef===t.Ef},nd.prototype.set=function(t,e){yl("DocumentReference.set",arguments,1,2),e=wd("DocumentReference.set",e);var n=Td(this.Ef,t,e),r=Ip(this.firestore.Ed,"DocumentReference.set",this.Tf,n,null!==this.Ef,e);return this._d.write(r.If(this.Tf,As.We()))},nd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Ml?(dl("DocumentReference.update",arguments,2),Np(this.firestore.Ed,"DocumentReference.update",this.Tf,t,e,r)):(pl("DocumentReference.update",arguments,1),Tp(this.firestore.Ed,"DocumentReference.update",this.Tf,t)),this._d.write(n.If(this.Tf,As.exists(!0)))},nd.prototype.delete=function(){return pl("DocumentReference.delete",arguments,0),this._d.write([new Hs(this.Tf,As.We())])},nd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];yl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||hl(i[u])||(_l("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),wl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};hl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(vl("DocumentReference.onSnapshot","function",u,i[u]),gl("DocumentReference.onSnapshot","function",u+1,i[u+1]),gl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Dd(t))},error:i[u+1],complete:i[u+2]};return this._d.listen(pu(this.Tf.path),h,c)},nd.prototype.get=function(t){var e=this;yl("DocumentReference.get",arguments,0,1),Ed("DocumentReference.get",t);var n=this.firestore.ld();return t&&"cache"===t.source?n.jf(this.Tf).then(function(t){return new $p(e.firestore,e.Tf,t,!0,t instanceof ru&&t.Ke,e.Ef)}):n.Kf(this.Tf,t).then(function(t){return e.Dd(t)})},nd.prototype.withConverter=function(t){return new nd(this.Tf,this.firestore,t)},nd.prototype.Dd=function(t){var e=t.docs.get(this.Tf);return new $p(this.firestore,this.Tf,e,t.fromCache,t.hasPendingWrites,this.Ef)},nd),Yp=(ed.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ed),$p=(td.prototype.data=function(t){var e=this;if(yl("DocumentSnapshot.data",arguments,0,1),t=bd("DocumentSnapshot.data",t),this.Cd){if(this.Ef){var n=new Jp(this.yd,this.Tf,this.Cd,this.Fd,this.Nd,null);return this.Ef.fromFirestore(n,t)}return new Gp(this.yd.wf,this.yd.Vd(),t.serverTimestamps||"none",function(t){return new Xp(t,e.yd,null)}).Xf(this.Cd.Ze())}},td.prototype.get=function(t,e){var n=this;if(yl("DocumentSnapshot.get",arguments,1,2),e=bd("DocumentSnapshot.get",e),this.Cd){var r=this.Cd.data().field(Pp("DocumentSnapshot.get",t,this.Tf));if(null!==r)return new Gp(this.yd.wf,this.yd.Vd(),e.serverTimestamps||"none",function(t){return new Xp(t,n.yd,n.Ef)}).Xf(r)}},Object.defineProperty(td.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"ref",{get:function(){return new Xp(this.Tf,this.yd,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"exists",{get:function(){return null!==this.Cd},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"metadata",{get:function(){return new Yp(this.Nd,this.Fd)},enumerable:!1,configurable:!0}),td.prototype.isEqual=function(t){if(!(t instanceof td))throw Sl("isEqual","DocumentSnapshot",1,t);return this.yd===t.yd&&this.Fd===t.Fd&&this.Tf.isEqual(t.Tf)&&(null===this.Cd?null===t.Cd:this.Cd.isEqual(t.Cd))&&this.Ef===t.Ef},td),Jp=(n(Zp,Fp=$p),Zp.prototype.data=function(t){return Fp.prototype.data.call(this,t)},Zp);function Zp(){return null!==Fp&&Fp.apply(this,arguments)||this}function td(t,e,n,r,i,o){this.yd=t,this.Tf=e,this.Cd=n,this.Fd=r,this.Nd=i,this.Ef=o}function ed(t,e){this.hasPendingWrites=t,this.fromCache=e}function nd(t,e,n){var r=this;return(r=Bp.call(this,e.wf,t,n)||this).Tf=t,r.firestore=e,r.Ef=n,r._d=r.firestore.ld(),r}function rd(t){this.yd=t,this.bd=[],this.vd=!1}function id(t,e){this.yd=t,this.pd=e}function od(t,e,n,r){var i=this;if(void 0===n&&(n=new nl),void 0===r&&(r=new il),this.od=n,this.hd=r,this.ad=null,this.ud=new $h,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ld(),[4,this._d.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ad=o,this.wf=od.fd(o),this.dd=o.name,this.wd=new _c(e)}else{var s=t;if(!s.projectId)throw new Yr(Xr.INVALID_ARGUMENT,"Must provide projectId");this.wf=new qr(s.projectId,s.database),this.dd="[DEFAULT]",this.wd=new Ac}this.Td=new Hp({})}function sd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ml("settings","non-empty string","host",t.host),this.host=t.host,wl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(_l("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),wl("settings","object","credentials",t.credentials),this.credentials=t.credentials,wl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),wl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Dr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Dr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,wl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ic.th;else{if(t.cacheSizeBytes!==zp&&t.cacheSizeBytes<ic.Zo)throw new Yr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ic.Zo);this.cacheSizeBytes=t.cacheSizeBytes}wl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function ud(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Yf=n,this.Jf=r}function ad(t,e,n){if("string"==typeof n){if(""===n)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ti.k(n));if(!ri.W(r))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return No(t,new ri(r))}if(n instanceof op)return No(t,n.Tf);throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Nl(n)+".")}function hd(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function cd(t,e,n){if(!n.isEqual(e))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function fd(t){if(t.an()&&0===t.tn.length)throw new Yr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ld,pd=(md.prototype.where=function(t,e,n){pl("Query.where",arguments,3),Al("Query.where",3,n);var r,i,o=El("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Pp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.O()){if("array-contains"===i||"array-contains-any"===i)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){hd(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(ad(n,t,c))}s={arrayValue:{values:u}}}else s=ad(n,t,o)}else"in"!==i&&"array-contains-any"!==i||hd(o,i),s=Ap(e,"Query.where",o,"in"===i);var f=_u.create(r,i,s);return function(t,e){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&cd(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}(t,f),f}(this.kd,this.firestore.Ed,this.firestore.wf,s,o,n);return new md((i=(r=this.kd).filters.concat([u]),new cu(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},md.prototype.orderBy=function(t,e){var n;if(yl("Query.orderBy",arguments,1,2),gl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Pp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Wu(e,n),s=o;return null!==(r=t).un()||null!==(i=r.cn())&&cd(0,i,s.field),o}(this.kd,o,n);return new md((i=(r=this.kd).tn.concat([s]),new cu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},md.prototype.limit=function(t){return pl("Query.limit",arguments,1),vl("Query.limit","number",1,t),kl("Query.limit",1,t),new md(gu(this.kd,t,"F"),this.firestore,this.Ef)},md.prototype.limitToLast=function(t){return pl("Query.limitToLast",arguments,1),vl("Query.limitToLast","number",1,t),kl("Query.limitToLast",1,t),new md(gu(this.kd,t,"L"),this.firestore,this.Ef)},md.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];dl("Query.startAt",arguments,1);var r=this.xd("Query.startAt",t,e,!0);return new md(mu(this.kd,r),this.firestore,this.Ef)},md.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];dl("Query.startAfter",arguments,1);var r=this.xd("Query.startAfter",t,e,!1);return new md(mu(this.kd,r),this.firestore,this.Ef)},md.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];dl("Query.endBefore",arguments,1);var r=this.xd("Query.endBefore",t,e,!0);return new md(wu(this.kd,r),this.firestore,this.Ef)},md.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];dl("Query.endAt",arguments,1);var r=this.xd("Query.endAt",t,e,!1);return new md(wu(this.kd,r),this.firestore,this.Ef)},md.prototype.isEqual=function(t){if(!(t instanceof md))throw Sl("isEqual","Query",1,t);return this.firestore===t.firestore&&bu(this.kd,t.kd)&&this.Ef===t.Ef},md.prototype.withConverter=function(t){return new md(this.kd,this.firestore,t)},md.prototype.xd=function(c,t,e,n){if(Al(c,1,t),t instanceof $p)return pl(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Yr(Xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Yr(Xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Uu(i,r)}(this.kd,this.firestore.wf,t.Cd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Yr(Xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!du(t)&&-1!==h.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ti.k(h));if(!ri.W(c))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new ri(c);u.push(No(e,f))}else{var l=Ap(n,r,h);u.push(l)}}return new Uu(u,o)}(this.kd,this.firestore.wf,this.firestore.Ed,c,r,n)},md.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];yl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||hl(i[a])||(_l("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),wl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),hl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(vl("Query.onSnapshot","function",a,i[a]),gl("Query.onSnapshot","function",a+1,i[a+1]),gl("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new dd(r.firestore,r.kd,t,r.Ef))},error:i[a+1],complete:i[a+2]};return fd(this.kd),this.firestore.ld().listen(this.kd,u,h)},md.prototype.get=function(t){var e=this;yl("Query.get",arguments,0,1),Ed("Query.get",t),fd(this.kd);var n=this.firestore.ld();return(t&&"cache"===t.source?n.Gf(this.kd):n.zf(this.kd,t)).then(function(t){return new dd(e.firestore,e.kd,t,e.Ef)})},md),dd=(Object.defineProperty(gd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"empty",{get:function(){return this.Md.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"size",{get:function(){return this.Md.docs.size},enumerable:!1,configurable:!0}),gd.prototype.forEach=function(e,n){var r=this;yl("QuerySnapshot.forEach",arguments,1,2),vl("QuerySnapshot.forEach","function",1,e),this.Md.docs.forEach(function(t){e.call(n,r.qd(t,r.metadata.fromCache,r.Md.Lt.has(t.key)))})},Object.defineProperty(gd.prototype,"query",{get:function(){return new pd(this.$d,this.yd,this.Ef)},enumerable:!1,configurable:!0}),gd.prototype.docChanges=function(t){t&&(_l("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),wl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Md.Bt)throw new Yr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Od&&this.Ld===e||(this.Od=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Or()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Md,e,this.qd.bind(this)),this.Ld=e),this.Od},gd.prototype.isEqual=function(t){if(!(t instanceof gd))throw Sl("isEqual","QuerySnapshot",1,t);return this.yd===t.yd&&bu(this.$d,t.$d)&&this.Md.isEqual(t.Md)&&this.Ef===t.Ef},gd.prototype.qd=function(t,e,n){return new Jp(this.yd,t.key,t,e,n,this.Ef)},gd),yd=(n(vd,ld=pd),Object.defineProperty(vd.prototype,"id",{get:function(){return this.kd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"parent",{get:function(){var t=this.kd.path.p();return t._()?null:new Xp(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"path",{get:function(){return this.kd.path.N()},enumerable:!1,configurable:!0}),vd.prototype.doc=function(t){yl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Lr.t()),vl("CollectionReference.doc","non-empty string",1,t);var e=ti.k(t);return Xp.gd(this.kd.path.child(e),this.firestore,this.Ef)},vd.prototype.add=function(t){pl("CollectionReference.add",arguments,1),vl("CollectionReference.add","object",1,this.Ef?this.Ef.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},vd.prototype.withConverter=function(t){return new vd(this.Bd,this.firestore,t)},vd);function vd(t,e,n){var r=this;if(((r=ld.call(this,pu(t),e,n)||this).Bd=t).length%2!=1)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function gd(t,e,n,r){this.yd=t,this.$d=e,this.Md=n,this.Ef=r,this.Od=null,this.Ld=null,this.metadata=new Yp(n.hasPendingWrites,n.fromCache)}function md(t,e,n){this.kd=t,this.firestore=e,this.Ef=n}function wd(t,e){if(void 0===e)return{merge:!1};if(_l(t,e,["merge","mergeFields"]),wl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Nl(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Ml))throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Nl(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function bd(t,e){return void 0===e?{}:(_l(t,e,["serverTimestamps"]),bl(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ed(t,e){gl(t,"object",1,e),e&&(_l(t,e,["source"]),bl(t,0,"source",e.source,["default","server","cache"]))}function Id(t,e,n){if(e instanceof op){if(e.firestore!==n)throw new Yr(Xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Sl(t,"DocumentReference",1,e)}function Td(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Nd,Ad={Firestore:Kp,GeoPoint:rp,Timestamp:$r,Blob:Cl,Transaction:Wp,WriteBatch:Qp,DocumentReference:Xp,DocumentSnapshot:$p,Query:pd,QueryDocumentSnapshot:Jp,QuerySnapshot:dd,CollectionReference:yd,FieldPath:Ml,FieldValue:ep,setLogLevel:Kp.setLogLevel,CACHE_SIZE_UNLIMITED:zp};(Nd=_d).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new il,i=new rl(r),new Kp(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Ad))),Nd.registerVersion("@firebase/firestore","1.16.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});