!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(hf){"use strict";try{(function(){hf=hf&&Object.prototype.hasOwnProperty.call(hf,"default")?hf.default:hf;var t,a,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function y(n,i){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},h=a.INFO,c=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(n(w,v=Error),w);function w(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R=_||self;function O(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++L))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Q=R.navigator;if(Q){var $=Q.userAgent;if($){K=$;break t}}K=""}function J(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){return nt[" "](t),t}nt[" "]=O;var it,rt,ot=Y(K,"Opera"),st=Y(K,"Trident")||Y(K,"MSIE"),at=Y(K,"Edge"),ut=at||st,ht=Y(K,"Gecko")&&!(Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge"))&&!(Y(K,"Trident")||Y(K,"MSIE"))&&!Y(K,"Edge"),ct=Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var ft="",pt=(rt=K,ht?/rv:([^\);]+)(\)|;)/.exec(rt):at?/Edge\/([\d\.]+)/.exec(rt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):ot?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(pt&&(ft=pt?pt[1]:""),st){var dt=lt();if(null!=dt&&dt>parseFloat(ft)){it=String(dt);break t}}it=ft}var yt={};function vt(a){return t=a,e=function(){for(var t=0,e=W(String(it)).split("."),n=W(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=R.document&&st&&(lt()||parseInt(it,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",O,e),R.removeEventListener("test",O,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},q(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function _t(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++Nt,this.Y=this.Z=!1}function Rt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=j(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var kt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Lt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=jt(i),e&&e[At]?e.wa(n,i,k(r)?!!r.capture:!!r,o):Vt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,i,r);return null}return n=jt(n),t&&t[At]?t.va(e,n,k(i)?!!i.capture:!!i,r):Vt(t,e,n,!1,i,r)}function Vt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=k(r)?!!r.capture:!!r;if(s&&!mt)return null;var a,u,h=qt(t);if(h||(t[kt]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(a=xt,i=u=mt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)bt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ct(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?St(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ut(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=qt(e))?(St(n,t),0==n.b&&(n.src=null,e[kt]=null)):Rt(t)))}function Ut(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Mt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Ct(t),n.call(i,e)}function xt(t,e){if(t.Y)return!0;if(mt)return Mt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=R,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}function qt(t){return(t=t[kt])instanceof Ot?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==S(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new Ot(this),(this.J=this).C=null}function Bt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&St(t.c,u),r=!1!==s.call(a,i)&&r)}return r&&!i.defaultPrevented}q(Gt,F),Gt.prototype[At]=!0,(N=Gt.prototype).addEventListener=function(t,e,n,i){Lt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=k(r)?!!r.capture:!!r,i=jt(i),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Dt(s=e.a[n],i,r,o))&&(Rt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ct(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=Bt(o,i,!0,t)&&s;if(s=Bt(o=t.a=n,i,!0,t)&&s,s=Bt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=Bt(o=t.a=e[r],i,!1,t)&&s;return s},N.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Rt(n[i]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var zt=R.JSON.stringify;function Ht(){this.b=this.a=null}var Kt,Wt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Xt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Qt(t,e){var n;Kt||(n=R.Promise.resolve(void 0),Kt=function(){n.then(Zt)}),$t||(Kt(),$t=!0),Jt.add(t,e)}Ht.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Ht;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var i=Wt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}$t=!1}function te(t,e){Gt.call(this),this.b=t||1,this.a=e||R,this.f=U(this.Ya,this),this.g=x()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==S(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}q(te,Gt),(N=te.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){te.S.G.call(this),ee(this),delete this.a};var ie,re,oe,se=(T(re=ue,oe=ie=F),re.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ie.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=re}function ue(t,e,n){var i=ie.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function he(t){F.call(this),this.b=t,this.a={}}q(he,F);var ce=[];function le(t,e,n,i){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var r=0;r<n.length;r++){var o=Lt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}he.prototype.G=function(){he.S.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Gt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}q(ge,Et),q(we,Et),q(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ne(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Re(){}Ne.prototype.a=null;var Oe,Se={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function De(){Et.call(this,"d")}function ke(){Et.call(this,"c")}function Pe(){}function Le(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new he(this),this.P=Ve,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(De,Et),q(ke,Et),q(Pe,Ne),Oe=new Pe;var Ve=45e3,Ce={},Ue={};function Me(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=x(),Fe(t),t.l=Je(t.i);var s,a,u,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),mn(n.b,"t",i),t.D=0,t.a=li(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function qe(t,e,n){for(var i,r,o,s,a=!0;!t.A&&t.D<n.length;){var u=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?Ue:(o=Number(r.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>r.length?Ue:(r=r.substr(s,o),i.D=s+o,r)));if(u==Ue){4==e&&(t.h=4,be(),a=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}de(t.c,t.f,u,null),He(t,u)}4==e&&0==n.length&&(t.h=1,be(),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ii(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Be(t))}function Fe(t){t.U=x()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function Ge(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||si(t.g,t)}function ze(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,i,r,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Nn(p.b,t)))if(p.I=t.N,!t.C&&Nn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;oi(p),Yn(p)}ni(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ui(p,11)}else if(!t.C&&p.a!=t||oi(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(Y(a,"spdy")||Y(a,"quic")||Y(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(_n(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=x()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=ci(o,o.C?o.ga:null,o.fa),c.C?(Rn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Ge(l),Fe(l)),o.a=c):ei(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||ui(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ui(p,7):Wn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Xe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Xe(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Le.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||me(),Ge(this);var i=this.a.X();this.N=i;var r=this.a.$();if(this.b=200==i,u=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=i,u.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.h=3,be(),ze(this),Be(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,a)}this.I?(qe(this,e,r),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,r,null),He(this,r)),4==e&&ze(this),this.b&&!this.A&&(4==e?si(this.g,this):(this.b=!1,Fe(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Be(this)}}}catch(t){}var u,h,c,l,f,p,d},N.Va=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),qe(this,t,e),this.b&&4!=t&&Fe(this)))},N.cancel=function(){this.A=!0,ze(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Be(this)):je(this,this.U-n)},(N=We.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Ye(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new $e(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var i,r;e instanceof dn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(yn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},i)),i.f=r):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(a){a.a||(a.a=new We,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function vn(t,e){yn(t),e=wn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function gn(t,e){return yn(t),e=wn(t,e),Xe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){yn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Rn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var i=t.c;try{for(var r=A(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Sn(){}function Dn(){this.a=new Sn}function kn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Pn=R.JSON.parse;function Ln(t){Gt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}q(Ln,Gt);var Vn="",Cn=/^https?$/i,Un=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),jn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&(!t.s[1]||4!=Bn(t)||2!=t.X()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Qe)[1]||null)&&R.self&&R.self.location&&(r=(i=R.self.location.protocol).substr(0,i.length-1)),n=!Cn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Bn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",qn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Gn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",J(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new Dn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Wn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.i.toString(),"")),!n&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=li(e.g,null),e.a.ba(e.i)),e.u=x(),Fe(e)),hi(t)}function Yn(t){t.a&&(ii(t),t.a.cancel(),t.a=null)}function Xn(t){Yn(t),t.j&&(R.clearTimeout(t.j),t.j=null),oi(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&$n(t)}function $n(t){Tn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,i=Je(t.B);rn(i,"SID",t.J),rn(i,"RID",n),rn(i,"AID",t.P),Zn(t,i),t.i&&t.l&&zn(i,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ti(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Me(n,i,e)}function Zn(t,n){t.f&&Ke({},function(t,e){rn(n,e,t)})}function ti(t,e,n){n=Math.min(t.g.length,n);var i=t.f?U(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{!function(t,i){var r="req"+h+"_"||"";try{Ke(t,function(t,e){var n=t;k(t)&&(n=zt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ei(t){t.a||t.j||(t.U=1,Qt(t.Aa,t),t.o=0)}function ni(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ai(t,t.o)),t.o++,1)}function ii(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ri(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,xe(n,t)}function oi(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function si(t,e){var n,i=null;if(t.a==e){oi(t),ii(t),t.a=null;var r=2}else{if(!Nn(t.b,e))return;i=e.s,Rn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)1==r?(i=e.j?e.j.length:0,e=x()-e.u,n=t.u,(r=ve()).dispatchEvent(new Ee(r)),$n(t)):ei(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ai(t,t.u)),t.u++,1}}(t,e)||2==r&&ni(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ui(t,5);break;case 4:ui(t,10);break;case 3:ui(t,6);break;default:ui(t,2)}}function ai(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ui(t,e){var n,i,r,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=U(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ze(n,"https"),on(n)),r=n.toString(),o=i,a=new pe,R.Image?((s=new Image).onload=M(kn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=M(kn,a,s,"TestLoadImage: error",!1,o),s.onabort=M(kn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(kn,a,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hi(t),Xn(t)}function hi(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ci(t,e,n){var i,r,o,s,a,u,h,c=(i=n)instanceof $e?Je(i):new $e(i,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(r=R.location).protocol,s=e?e+"."+r.hostname:r.hostname,a=+r.port,u=n,h=new $e(null,void 0),o&&Ze(h,o),s&&tn(h,s),a&&en(h,a),u&&(h.g=u),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function li(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function fi(){}function pi(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function di(t,e){Gt.call(this),this.a=new Kn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gi(this)}function yi(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vi(){ke.call(this),this.status=1}function gi(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Oe),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var r,o=new We(this.headers);i&&Ke(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Mn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=j(Un,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(r=this.a,st&&vt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Ln.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Fn(this):this.Ta())},N.Ta=function(){Fn(this)},N.X=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Kn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),i=this.l;if(this.O&&(i?et(i=Z(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ti(this,n,e),rn(r=Je(this.B),"RID",t),rn(r,"CVER",22),this.A&&rn(r,"X-HTTP-Session-Id",this.A),Zn(this,r),this.i&&i&&zn(r,this.i,i),_n(this.b,n),this.Ga&&rn(r,"TYPE","init"),this.da?(rn(r,"$req",e),rn(r,"SID","null"),n.V=!0,Me(n,r,null)):Me(n,r,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},N.Aa=function(){var t;this.j=null,ri(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),ri(this))},N.Ra=function(){null!=this.m&&(this.m=null,Yn(this),ni(this),be())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(N=fi.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},pi.prototype.a=function(t,e){return new di(t,e)},q(di,Gt),(N=di.prototype).addEventListener=function(t,e,n,i){di.S.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){di.S.removeEventListener.call(this,t,e,n,i)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=ci(t,null,t.fa),$n(t)},N.close=function(){Wn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=zt(t),Qn(this.a,e)):Qn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,di.S.G.call(this)},q(yi,De),q(vi,ke),q(gi,fi),gi.prototype.ta=function(){this.a.dispatchEvent("a")},gi.prototype.sa=function(t){this.a.dispatchEvent(new yi(t))},gi.prototype.ra=function(t){this.a.dispatchEvent(new vi)},gi.prototype.qa=function(){this.a.dispatchEvent("b")},pi.prototype.createWebChannel=pi.prototype.a,di.prototype.send=di.prototype.Pa,di.prototype.open=di.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ae.COMPLETE="complete",(Re.EventType=Se).OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mi={createWebChannelTransport:function(){return new pi},ErrorCode:Te,EventType:Ae,WebChannel:Re,XhrIo:Ln},wi=mi.createWebChannelTransport,bi=mi.ErrorCode,Ei=mi.EventType,Ii=mi.WebChannel,Ti=mi.XhrIo,Ai=(Ni.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ni.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ni.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ni);function Ni(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _i=new l("@firebase/firestore");function Ri(){return _i.logLevel}function Oi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=a.DEBUG&&(e=n.map(ki),_i.debug.apply(_i,r(["Firestore (7.17.2): "+t],e)))}function Si(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=a.ERROR&&(e=n.map(ki),_i.error.apply(_i,r(["Firestore (7.17.2): "+t],e)))}function Di(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=a.WARN&&(e=n.map(ki),_i.warn.apply(_i,r(["Firestore (7.17.2): "+t],e)))}function ki(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.2) INTERNAL ASSERTION FAILED: "+t;throw Si(e),new Error(e)}function Li(t){t||Pi()}var Vi=(Ci.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Ci);function Ci(){}function Ui(t,e){return t<e?-1:e<t?1:0}function Mi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function xi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var qi=(Object.defineProperty(Fi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fi.prototype.isEqual=function(t){return t instanceof Fi&&t.projectId===this.projectId&&t.database===this.database},Fi.prototype.o=function(t){return Ui(this.projectId,t.projectId)||Ui(this.database,t.database)},Fi);function Fi(t,e){this.projectId=t,this.database=e||"(default)"}function ji(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Bi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var zi,Hi,Ki,Wi=(cr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(this.u(s,t))return a}},cr.prototype.has=function(t){return void 0!==this.get(t)},cr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},cr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},cr.prototype.forEach=function(a){Gi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},cr.prototype._=function(){return Bi(this.l)},cr),Yi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Xi=(n(hr,Ki=Error),hr),Qi=(ur.now=function(){return ur.fromMillis(Date.now())},ur.fromDate=function(t){return ur.fromMillis(t.getTime())},ur.fromMillis=function(t){var e=Math.floor(t/1e3);return new ur(e,1e6*(t-1e3*e))},ur.prototype.toDate=function(){return new Date(this.toMillis())},ur.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ur.prototype.T=function(t){return this.seconds===t.seconds?Ui(this.nanoseconds,t.nanoseconds):Ui(this.seconds,t.seconds)},ur.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ur.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ur.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ur),$i=(ar.m=function(t){return new ar(t)},ar.min=function(){return new ar(new Qi(0,0))},ar.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ar.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ar.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ar.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ar.prototype.R=function(){return this.timestamp},ar),Ji=(Object.defineProperty(sr.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),sr.prototype.isEqual=function(t){return 0===sr.P(this,t)},sr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof sr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},sr.prototype.limit=function(){return this.offset+this.length},sr.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},sr.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},sr.prototype.v=function(){return this.segments[this.offset]},sr.prototype.S=function(){return this.get(this.length-1)},sr.prototype.get=function(t){return this.segments[this.offset+t]},sr.prototype._=function(){return 0===this.length},sr.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},sr.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},sr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},sr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},sr.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},sr),Zi=(n(or,Hi=Ji),or.prototype.V=function(t,e,n){return new or(t,e,n)},or.prototype.N=function(){return this.F().join("/")},or.prototype.toString=function(){return this.N()},or.$=function(t){if(0<=t.indexOf("//"))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new or(t.split("/").filter(function(t){return 0<t.length}))},or.k=function(){return new or([])},or),tr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,er=(n(rr,zi=Ji),rr.prototype.V=function(t,e,n){return new rr(t,e,n)},rr.L=function(t){return tr.test(t)},rr.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),rr.L(t)||(t="`"+t+"`"),t}).join(".")},rr.prototype.toString=function(){return this.N()},rr.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},rr.q=function(){return new rr(["__name__"])},rr.M=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Xi(Yi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Xi(Yi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Xi(Yi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new rr(e)},rr.k=function(){return new rr([])},rr),nr=(ir.U=function(t){return new ir(Zi.$(t).p(5))},ir.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ir.prototype.isEqual=function(t){return null!==t&&0===Zi.P(this.path,t.path)},ir.prototype.toString=function(){return this.path.toString()},ir.P=function(t,e){return Zi.P(t.path,e.path)},ir.W=function(t){return t.length%2==0},ir.j=function(t){return new ir(new Zi(t.slice()))},ir);function ir(t){this.path=t}function rr(){return null!==zi&&zi.apply(this,arguments)||this}function or(){return null!==Hi&&Hi.apply(this,arguments)||this}function sr(t,e,n){void 0===e?e=0:e>t.length&&Pi(),void 0===n?n=t.length-e:n>t.length-e&&Pi(),this.segments=t,this.offset=e,this.A=n}function ar(t){this.timestamp=t}function ur(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Xi(Yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Xi(Yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Xi(Yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Xi(Yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hr(t,e){var n=this;return(n=Ki.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function cr(t,e){this.h=t,this.u=e,this.l={}}function lr(t){return null==t}function fr(t){return-0===t&&1/t==-1/0}var pr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.G=null};function dr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new pr(t,e,n,i,r,o,s)}function yr(t){var e,n=t;return null===n.G&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+mo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),lr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=La(n.startAt)),n.endAt&&(e+="|ub:",e+=La(n.endAt)),n.G=e),n.G}function vr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ca(t.startAt,e.startAt)&&Ca(t.endAt,e.endAt)}function gr(t){return nr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mr=(wr.fromBase64String=function(t){return new wr(atob(t))},wr.fromUint8Array=function(t){return new wr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wr.prototype.toBase64=function(){return t=this.K,btoa(t);var t},wr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},wr.prototype.H=function(){return 2*this.K.length},wr.prototype.o=function(t){return Ui(this.K,t.K)},wr.prototype.isEqual=function(t){return this.K===t.K},wr);function wr(t){this.K=t}function br(t){this.count=t}mr.Y=new mr("");var Er,Ir,Tr=(Ar.prototype.Z=function(t){return new Ar(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ar.prototype.tt=function(t,e){return new Ar(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ar.prototype.et=function(t){return new Ar(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ar);function Ar(t,e,n,i,r,o,s){void 0===r&&(r=$i.min()),void 0===o&&(o=$i.min()),void 0===s&&(s=mr.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.J=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Nr(t){switch(t){case Yi.OK:return Pi(),0;case Yi.CANCELLED:case Yi.UNKNOWN:case Yi.DEADLINE_EXCEEDED:case Yi.RESOURCE_EXHAUSTED:case Yi.INTERNAL:case Yi.UNAVAILABLE:case Yi.UNAUTHENTICATED:return;case Yi.INVALID_ARGUMENT:case Yi.NOT_FOUND:case Yi.ALREADY_EXISTS:case Yi.PERMISSION_DENIED:case Yi.FAILED_PRECONDITION:case Yi.ABORTED:case Yi.OUT_OF_RANGE:case Yi.UNIMPLEMENTED:case Yi.DATA_LOSS:return 1;default:return Pi(),0}}function _r(t){if(void 0===t)return Si("GRPC error has no .code"),Yi.UNKNOWN;switch(t){case Er.OK:return Yi.OK;case Er.CANCELLED:return Yi.CANCELLED;case Er.UNKNOWN:return Yi.UNKNOWN;case Er.DEADLINE_EXCEEDED:return Yi.DEADLINE_EXCEEDED;case Er.RESOURCE_EXHAUSTED:return Yi.RESOURCE_EXHAUSTED;case Er.INTERNAL:return Yi.INTERNAL;case Er.UNAVAILABLE:return Yi.UNAVAILABLE;case Er.UNAUTHENTICATED:return Yi.UNAUTHENTICATED;case Er.INVALID_ARGUMENT:return Yi.INVALID_ARGUMENT;case Er.NOT_FOUND:return Yi.NOT_FOUND;case Er.ALREADY_EXISTS:return Yi.ALREADY_EXISTS;case Er.PERMISSION_DENIED:return Yi.PERMISSION_DENIED;case Er.FAILED_PRECONDITION:return Yi.FAILED_PRECONDITION;case Er.ABORTED:return Yi.ABORTED;case Er.OUT_OF_RANGE:return Yi.OUT_OF_RANGE;case Er.UNIMPLEMENTED:return Yi.UNIMPLEMENTED;case Er.DATA_LOSS:return Yi.DATA_LOSS;default:return Pi()}}(Ir=Er=Er||{})[Ir.OK=0]="OK",Ir[Ir.CANCELLED=1]="CANCELLED",Ir[Ir.UNKNOWN=2]="UNKNOWN",Ir[Ir.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ir[Ir.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ir[Ir.NOT_FOUND=5]="NOT_FOUND",Ir[Ir.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ir[Ir.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ir[Ir.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ir[Ir.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ir[Ir.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ir[Ir.ABORTED=10]="ABORTED",Ir[Ir.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ir[Ir.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ir[Ir.INTERNAL=13]="INTERNAL",Ir[Ir.UNAVAILABLE=14]="UNAVAILABLE",Ir[Ir.DATA_LOSS=15]="DATA_LOSS";var Rr=(Pr.prototype.nt=function(t,e){return new Pr(this.P,this.root.nt(t,e,this.P).copy(null,null,Sr.st,null,null))},Pr.prototype.remove=function(t){return new Pr(this.P,this.root.remove(t,this.P).copy(null,null,Sr.st,null,null))},Pr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pr.prototype._=function(){return this.root._()},Object.defineProperty(Pr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pr.prototype.it=function(){return this.root.it()},Pr.prototype.rt=function(){return this.root.rt()},Pr.prototype.ot=function(t){return this.root.ot(t)},Pr.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Pr.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pr.prototype.ht=function(t){return this.root.ht(t)},Pr.prototype.at=function(){return new Or(this.root,null,this.P,!1)},Pr.prototype.ut=function(t){return new Or(this.root,t,this.P,!1)},Pr.prototype.ct=function(){return new Or(this.root,null,this.P,!0)},Pr.prototype.lt=function(t){return new Or(this.root,t,this.P,!0)},Pr),Or=(kr.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},kr.prototype.wt=function(){return 0<this.ft.length},kr.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},kr),Sr=(Dr.prototype.copy=function(t,e,n,i,r){return new Dr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Dr.prototype._=function(){return!1},Dr.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Dr.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Dr.prototype.min=function(){return this.left._()?this:this.left.min()},Dr.prototype.it=function(){return this.min().key},Dr.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Dr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.nt(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.nt(t,e,n))).Et()},Dr.prototype.It=function(){if(this.left._())return Dr.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Dr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.At()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.Rt()&&(i=i.Pt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===e(t,i.key)){if(i.right._())return Dr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.It())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.Et()},Dr.prototype.Rt=function(){return this.color},Dr.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Dr.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Dr.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Dr.prototype.pt=function(){var t=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Dr.prototype.Pt=function(){var t=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Dr.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Dr.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Dr.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Pi();if(this.right.Rt())throw Pi();var t=this.left.vt();if(t!==this.right.vt())throw Pi();return t+(this.Rt()?0:1)},Dr);function Dr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Dr.RED,this.left=null!=i?i:Dr.EMPTY,this.right=null!=r?r:Dr.EMPTY,this.size=this.left.size+1+this.right.size}function kr(t,e,n,i){this._t=i,this.ft=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this._t?t.left:t.right;else{if(0===r){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Pr(t,e){this.P=t,this.root=e||Sr.EMPTY}function Lr(){this.size=0}Sr.EMPTY=null,Sr.RED=!0,Sr.st=!1,Sr.EMPTY=(Object.defineProperty(Lr.prototype,"key",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Lr.prototype,"value",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Lr.prototype,"color",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Lr.prototype,"left",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Object.defineProperty(Lr.prototype,"right",{get:function(){throw Pi()},enumerable:!1,configurable:!0}),Lr.prototype.copy=function(t,e,n,i,r){return this},Lr.prototype.nt=function(t,e,n){return new Sr(t,e)},Lr.prototype.remove=function(t,e){return this},Lr.prototype._=function(){return!0},Lr.prototype.ot=function(t){return!1},Lr.prototype.ht=function(t){return!1},Lr.prototype.it=function(){return null},Lr.prototype.rt=function(){return null},Lr.prototype.Rt=function(){return!1},Lr.prototype.gt=function(){return!0},Lr.prototype.vt=function(){return 0},new Lr);var Vr=(xr.prototype.has=function(t){return null!==this.data.get(t)},xr.prototype.first=function(){return this.data.it()},xr.prototype.last=function(){return this.data.rt()},Object.defineProperty(xr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xr.prototype.indexOf=function(t){return this.data.indexOf(t)},xr.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},xr.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var i=n.dt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},xr.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},xr.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},xr.prototype.at=function(){return new Cr(this.data.at())},xr.prototype.ut=function(t){return new Cr(this.data.ut(t))},xr.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},xr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xr.prototype._=function(){return this.data._()},xr.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xr.prototype.isEqual=function(t){if(!(t instanceof xr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(0!==this.P(i,r))return!1}return!0},xr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xr.prototype.copy=function(t){var e=new xr(this.P);return e.data=t,e},xr),Cr=(Mr.prototype.dt=function(){return this.Ft.dt().key},Mr.prototype.wt=function(){return this.Ft.wt()},Mr),Ur=new Rr(nr.P);function Mr(t){this.Ft=t}function xr(t){this.P=t,this.data=new Rr(this.P)}var qr=new Rr(nr.P),Fr=new Rr(nr.P),jr=new Vr(nr.P);function Gr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=jr,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var Br=new Vr(Ui);function zr(t,e,n,i){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=i}function Hr(t,e){this.targetId=t,this.ee=e}function Kr(t,e,n,i){void 0===n&&(n=mr.Y),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Wr=(so.kt=function(t){return new so(t.P)},so.prototype.has=function(t){return null!=this.Nt.get(t)},so.prototype.get=function(t){return this.Nt.get(t)},so.prototype.first=function(){return this.$t.it()},so.prototype.last=function(){return this.$t.rt()},so.prototype._=function(){return this.$t._()},so.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(so.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),so.prototype.forEach=function(n){this.$t.ot(function(t,e){return n(t),!1})},so.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.$t.nt(t,null))},so.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.$t.remove(e)):this},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.at(),n=t.$t.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(!i.isEqual(r))return!1}return!0},so.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},so.prototype.copy=function(t,e){var n=new so;return n.P=this.P,n.Nt=t,n.$t=e,n},so),Yr=(oo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Pi()},oo.prototype.Lt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},oo),Xr=(ro.Bt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new ro(t,e,Wr.kt(e),r,n,i,!0,!1)},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Mt===t.Mt&&this.qt.isEqual(t.qt)&&ha(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},ro),Qr=(io.zt=function(t,e){var n=new Map;return n.set(t,$r.Kt(t,e)),new io($i.min(),n,Br,Ur,Gr())},io),$r=(no.Kt=function(t,e){return new no(mr.Y,e,Gr(),Gr(),Gr())},no),Jr=(Object.defineProperty(eo.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),eo.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},eo.prototype.ce=function(){var n=Gr(),i=Gr(),r=Gr();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Pi()}}),new $r(this.ie,this.re,n,i,r)},eo.prototype.le=function(){this.oe=!1,this.se=uo()},eo.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},eo.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},eo.prototype.de=function(){this.ne+=1},eo.prototype.we=function(){--this.ne},eo.prototype.Te=function(){this.oe=!0,this.re=!0},eo),Zr=(to.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var i=n[e];t.te instanceof Ws?this.Ve(i,t.te):t.te instanceof Ys&&this.pe(i,t.key,t.te)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.te)}},to.prototype.ye=function(n){var i=this;this.ge(n,function(t){var e=i.ve(t);switch(n.state){case 0:i.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||i.removeTarget(t);break;case 3:i.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:i.be(t)&&(i.Se(t),e.ue(n.resumeToken));break;default:Pi()}})},to.prototype.ge=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ee.forEach(function(t,e){i.be(e)&&n(e)})},to.prototype.Ce=function(t){var e,n,i=t.targetId,r=t.ee.count,o=this.De(i);o&&(gr(e=o.target)?0===r?(n=new nr(e.path),this.pe(i,n,new Ys(n,$i.min()))):Li(1===r):this.Fe(i)!==r&&(this.Se(i),this.Ae=this.Ae.add(i)))},to.prototype.Ne=function(r){var o=this,s=new Map;this.Ee.forEach(function(t,e){var n,i=o.De(e);i&&(t.Ht&&gr(i.target)&&(n=new nr(i.target.path),null!==o.Ie.get(n)||o.$e(e,n)||o.pe(e,n,new Ys(n,r))),t.ae&&(s.set(e,t.ce()),t.le()))});var i=Gr();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Qr(r,s,this.Ae,this.Ie,i);return this.Ie=Ur,this.Re=ao(),this.Ae=new Vr(Ui),t},to.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},to.prototype.pe=function(t,e,n){var i;this.be(t)&&(i=this.ve(t),this.$e(t,e)?i._e(e,1):i.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},to.prototype.removeTarget=function(t){this.Ee.delete(t)},to.prototype.Fe=function(t){var e=this.ve(t).ce();return this.me.xe(t).size+e.Yt.size-e.Jt.size},to.prototype.de=function(t){this.ve(t).de()},to.prototype.ve=function(t){var e=this.Ee.get(t);return e||(e=new Jr,this.Ee.set(t,e)),e},to.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Vr(Ui),this.Re=this.Re.nt(t,e)),e},to.prototype.be=function(t){var e=null!==this.De(t);return e||Oi("WatchChangeAggregator","Detected inactive target",t),e},to.prototype.De=function(t){var e=this.Ee.get(t);return e&&e.he?null:this.me.Le(t)},to.prototype.Se=function(e){var n=this;this.Ee.set(e,new Jr),this.me.xe(e).forEach(function(t){n.pe(e,t,null)})},to.prototype.$e=function(t,e){return this.me.xe(t).has(e)},to);function to(t){this.me=t,this.Ee=new Map,this.Ie=Ur,this.Re=ao(),this.Ae=new Vr(Ui)}function eo(){this.ne=0,this.se=uo(),this.ie=mr.Y,this.re=!1,this.oe=!0}function no(t,e,n,i,r){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=i,this.Jt=r}function io(t,e,n,i,r){this.J=t,this.Wt=e,this.Qt=n,this.jt=i,this.Gt=r}function ro(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.Ot=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Mt=s,this.Ut=a}function oo(){this.xt=new Rr(nr.P)}function so(n){this.P=n?function(t,e){return n(t,e)||nr.P(t.key,e.key)}:function(t,e){return nr.P(t.key,e.key)},this.Nt=qr,this.$t=new Rr(this.P)}function ao(){return new Rr(nr.P)}function uo(){return new Rr(nr.P)}function ho(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function co(t){var e=wo(t.mapValue.fields.__local_write_time__.timestampValue);return new Qi(e.seconds,e.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Pi()}function po(i,r){var t,e,n,o=fo(i);if(o!==fo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return co(i).isEqual(co(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=wo(i.timestampValue),n=wo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,Eo(i.bytesValue).isEqual(Eo(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,bo((t=i).geoPointValue.latitude)===bo(e.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bo(t.integerValue)===bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=bo(t.doubleValue),i=bo(e.doubleValue);return n===i?fr(n)===fr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return Mi(i.arrayValue.values||[],r.arrayValue.values||[],po);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(ji(t)!==ji(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!po(t[n],e[n])))return!1;return!0}();default:return Pi()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,i,r,o,s,a,u,h,c,l,f=fo(t),p=fo(e);if(f!==p)return Ui(f,p);switch(f){case 0:return 0;case 1:return Ui(t.booleanValue,e.booleanValue);case 2:return h=e,(c=bo(t.integerValue||t.doubleValue))<(l=bo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return Ui(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Eo(o),u=Eo(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Ui(n[r],i[r]);if(0!==o)return o}return Ui(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Ui(bo(n.latitude),bo(i.latitude)))?r:Ui(bo(n.longitude),bo(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=vo(n[r],i[r]);if(o)return o}return Ui(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var a=Ui(i[s],o[s]);if(0!==a)return a;var u=vo(n[i[s]],r[o[s]]);if(0!==u)return u}return Ui(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Pi()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ui(t,e);var n=wo(t),i=wo(e),r=Ui(n.seconds,i.seconds);return 0!==r?r:Ui(n.nanos,i.nanos)}function mo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=wo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Eo(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,nr.U(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Pi();var t,e,n}(t)}function wo(t){if(Li(!!t),"string"!=typeof t)return{seconds:bo(t.seconds),nanos:bo(t.nanos)};var e,n=0,i=lo.exec(t);Li(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?mr.fromBase64String(t):mr.fromUint8Array(t)}function Io(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function To(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},So={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Do=function(t,e){this.s=t,this.Oe=e};function ko(t){return{integerValue:""+t}}function Po(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fr(e)?"-0":e}}function Lo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!fr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?ko(e):Po(t,e);var n}function Vo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Co(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Uo(t){return Li(!!t),$i.m((e=wo(t),new Qi(e.seconds,e.nanos)));var e}function Mo(t,e){return new Zi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function xo(t,e){return Mo(t.s,e.path)}function qo(t,e){var n,i,r=(Li(Ko(i=Zi.$(e))),i);return Li(r.get(1)===t.s.projectId),Li(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new nr((Li(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Fo(t,e){return Mo(t.s,e)}function jo(t){return new Zi(["projects",t.s.projectId,"databases",t.s.database]).N()}function Go(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,i,r,o;if(e instanceof As)n={update:Go(t,e.key,e.value)};else if(e instanceof Cs)n={delete:xo(t,e.key)};else if(e instanceof Ns)n={update:Go(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Ds)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof $o)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof is)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.N(),increment:e.Me};throw Pi()})}};else{if(!(e instanceof Us))return Pi();n={verify:xo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:Vo(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Pi()),n}function zo(t){return{before:t.before,values:t.position}}function Ho(t){return{fieldPath:t.N()}}function Ko(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Wo(){this.We=void 0}function Yo(t,e){return t instanceof as?To(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Xo,Qo,$o=(n(ts,Qo=Wo),ts),Jo=(n(Zo,Xo=Wo),Zo);function Zo(t){var e=this;return(e=Xo.call(this)||this).elements=t,e}function ts(){return null!==Qo&&Qo.apply(this,arguments)||this}function es(t,e){for(var n=cs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var ns,is=(n(rs,ns=Wo),rs);function rs(t){var e=this;return(e=ns.call(this)||this).elements=t,e}function os(t,e){for(var n=cs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!po(t,e)})}(r[i]);return{arrayValue:{values:n}}}var ss,as=(n(us,ss=Wo),us);function us(t,e){var n=this;return(n=ss.call(this)||this).serializer=t,n.Me=e,n}function hs(t){return bo(t.integerValue||t.doubleValue)}function cs(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ls(t,e){this.field=t,this.transform=e}var fs=(ps.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ps.prototype.isEqual=function(t){return Mi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ps);function ps(t){(this.fields=t).sort(er.P)}function ds(t,e){this.version=t,this.transformResults=e}var ys=(vs.je=function(){return new vs},vs.exists=function(t){return new vs(void 0,t)},vs.updateTime=function(t){return new vs(t)},Object.defineProperty(vs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),vs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},vs);function vs(t,e){this.updateTime=t,this.exists=e}function gs(t,e){return void 0!==t.updateTime?e instanceof Ws&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ws}function ms(){}function ws(t,e,n,i){return t instanceof As?function(t,e){if(!gs(t.Be,e))return e;var n=Es(e);return new Ws(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Ns?function(t,e){if(!gs(t.Be,e))return e;var n=Es(e),i=Os(t,e);return new Ws(t.key,n,i,{Ge:!0})}(t,e):t instanceof Ds?function(t,e,n,i){if(!gs(t.Be,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Ws&&(y=n.field(p.field)),null===y&&i instanceof Ws&&(y=i.field(p.field)),c.push((o=y,h=u=a=s=void 0,(r=d)instanceof $o?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):r instanceof Jo?es(r,o):r instanceof is?os(r,o):(u=hs(a=Yo(s=r,o))+hs(s.Me),To(a)&&To(s.Me)?ko(u):Po(s.serializer,u))))}return c}(t.fieldTransforms,n,e,i),s=Ps(t,r.data(),o);return new Ws(t.key,r.version,s,{Ge:!0})}(t,e,i,n):(o=e,gs((r=t).Be,o)?new Ys(r.key,$i.min()):o);var r,o}function bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||Mi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof Jo&&o instanceof Jo||r instanceof is&&o instanceof is?Mi(r.elements,o.elements,po):r instanceof as&&o instanceof as?po(r.Me,o.Me):r instanceof $o&&o instanceof $o);var n,i,r,o}))}function Es(t){return t instanceof Ws?t.version:$i.min()}var Is,Ts,As=(n(Rs,Ts=ms),Rs),Ns=(n(_s,Is=ms),_s);function _s(t,e,n,i){var r=this;return(r=Is.call(this)||this).key=t,r.data=e,r.qe=n,r.Be=i,r.type=1,r}function Rs(t,e,n){var i=this;return(i=Ts.call(this)||this).key=t,i.value=e,i.Be=n,i.type=0,i}function Os(t,e){return n=t,i=e instanceof Ws?e.data():Ms.empty(),r=new xs(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Ss,Ds=(n(ks,Ss=ms),ks);function ks(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=ys.exists(!0),n}function Ps(t,e,n){for(var i=new xs(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Ls,Vs,Cs=(n(Gs,Vs=ms),Gs),Us=(n(js,Ls=ms),js),Ms=(Fs.empty=function(){return new Fs({mapValue:{}})},Fs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Fs.prototype.isEqual=function(t){return po(this.proto,t.proto)},Fs),xs=(qs.prototype.set=function(t,e){return this.Ye(t,e),this},qs.prototype.delete=function(t){return this.Ye(t,null),this},qs.prototype.Ye=function(t,e){for(var n=this.He,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},qs.prototype.ze=function(){var t=this.Xe(er.k(),this.He);return null!=t?new Ms(t):this.Ke},qs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.Ke.field(i),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},qs);function qs(t){void 0===t&&(t=Ms.empty()),this.Ke=t,this.He=new Map}function Fs(t){this.proto=t}function js(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.Be=e,n.type=4,n}function Gs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.Be=e,n.type=3,n}function Bs(t,e){this.key=t,this.version=e}var zs,Hs,Ks,Ws=(n(Js,Ks=Bs),Js.prototype.field=function(t){return this.Je.field(t)},Js.prototype.data=function(){return this.Je},Js.prototype.Ze=function(){return this.Je.proto},Js.prototype.isEqual=function(t){return t instanceof Js&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},Js.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js),Ys=(n($s,Hs=Bs),$s.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s),Xs=(n(Qs,zs=Bs),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs);function Qs(){return null!==zs&&zs.apply(this,arguments)||this}function $s(t,e,n){var i=this;return(i=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Js(t,e,n,i){var r=this;return(r=Ks.call(this,t,e)||this).Je=n,r.Ge=!!i.Ge,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Zs(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Xi(Yi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Xi(Yi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ta=(ea.prototype.rn=function(t){return new ea(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},ea.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},ea.prototype.hn=function(){return!lr(this.limit)&&"F"===this.en},ea.prototype.an=function(){return!lr(this.limit)&&"L"===this.en},ea.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},ea.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},ea.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},ea);function ea(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=i,this.limit=r,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function na(t){return new ta(t)}function ia(t){return null!==t.collectionGroup}function ra(t){var e=Zs(t,ta);if(null===e.nn){e.nn=[];var n=e.cn(),i=e.un();if(null!==n&&null===i)n.O()||e.nn.push(new Ua(n)),e.nn.push(new Ua(er.q(),"asc"));else{for(var r,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.O()&&(o=!0)}o||(r=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Ua(er.q(),r)))}}return e.nn}function oa(t){var e=Zs(t,ta);if(!e.sn)if("F"===e.en)e.sn=dr(e.path,e.collectionGroup,ra(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=ra(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new Ua(o.field,s))}var a=e.endAt?new Ra(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ra(e.startAt.position,!e.startAt.before):null;e.sn=dr(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function sa(t,e,n){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function aa(t,e){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function ua(t,e){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function ha(t,e){return vr(oa(t),oa(e))&&t.en===e.en}function ca(t){return yr(oa(t))+"|lt:"+t.en}function la(t){return"Query(target="+(n=(e=oa(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+mo(e.value);var e}).join(", ")+"]"),lr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+La(e.startAt)),e.endAt&&(n+=", endAt: "+La(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function fa(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.B(i.collectionGroup)&&i.path.C(o):nr.W(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.tn;e<n.length;e++){var i=n[e];if(!i.field.O()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Va(e.startAt,ra(e),n))&&(!e.endAt||!Va(e.endAt,ra(e),n)));var e,n,i,o}function pa(a){return function(t,e){for(var n=!1,i=0,r=ra(a);i<r.length;i++){var o=r[i],s=function(t,e,n){var i,r,o,s,a=t.field.O()?nr.P(e.key,n.key):(i=t.field,r=n,o=e.field(i),s=r.field(i),null!==o&&null!==s?vo(o,s):Pi());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return Pi()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var da,ya=(n(va,da=function(){}),va.create=function(t,e,n){if(t.O())return"in"===e?new Ta(t,n):new Ia(t,e,n);if(No(n)){if("=="!==e)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new va(t,e,n)}if(_o(n)){if("=="!==e)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new va(t,e,n)}return"array-contains"===e?new Aa(t,n):"in"===e?new Na(t,n):"array-contains-any"===e?new _a(t,n):new va(t,e,n)},va.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&fo(this.value)===fo(e)&&this.fn(vo(e,this.value))},va.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Pi()}},va.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},va);function va(t,e,n){var i=this;return(i=da.call(this)||this).field=t,i.op=e,i.value=n,i}var ga,ma,wa,ba,Ea,Ia=(n(Pa,Ea=ya),Pa.prototype.matches=function(t){var e=nr.P(t.key,this.key);return this.fn(e)},Pa),Ta=(n(ka,ba=ya),ka.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ka),Aa=(n(Da,wa=ya),Da.prototype.matches=function(t){var e=t.field(this.field);return Ao(e)&&yo(e.arrayValue,this.value)},Da),Na=(n(Sa,ma=ya),Sa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value.arrayValue,e)},Sa),_a=(n(Oa,ga=ya),Oa.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ao(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},Oa),Ra=function(t,e){this.position=t,this.before=e};function Oa(t,e){return ga.call(this,t,"array-contains-any",e)||this}function Sa(t,e){return ma.call(this,t,"in",e)||this}function Da(t,e){return wa.call(this,t,"array-contains",e)||this}function ka(t,e){var n=this;return(n=ba.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return nr.U(t.referenceValue)}),n}function Pa(t,e,n){var i=this;return(i=Ea.call(this,t,e,n)||this).key=nr.U(n.referenceValue),i}function La(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}function Va(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.O()?nr.P(nr.U(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Ca(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var Ua=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Ma=(Ya.prototype.wn=function(t,e,n){for(var i,r,o,s=n.Tn,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(i=u,r=e,o=s[a],e=i instanceof As?new Ws(i.key,o.version,i.value,{hasCommittedMutations:!0}):i instanceof Ns?function(t,e,n){if(!gs(t.Be,e))return new Xs(t.key,n.version);var i=Os(t,e);return new Ws(t.key,n.version,i,{hasCommittedMutations:!0})}(i,r,o):i instanceof Ds?function(t,e,n){if(Li(null!=n.transformResults),!gs(t.Be,e))return new Xs(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Li(t.length===n.length);for(var r,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Ws&&(c=e.field(u.field)),i.push((r=h,o=c,s=n[a],r instanceof Jo?es(r,o):r instanceof is?os(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ps(t,i.data(),r);return new Ws(t.key,o,s,{hasCommittedMutations:!0})}(i,r,o):new Ys(i.key,o.version,{hasCommittedMutations:!0}))}return e},Ya.prototype.mn=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=ws(r,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=ws(u,e,o,this.dn))}return e},Ya.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.mn(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},Ya.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gr())},Ya.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mi(this.mutations,t.mutations,bs)&&Mi(this.baseMutations,t.baseMutations,bs)},Ya),xa=(Wa.from=function(t,e,n){Li(t.mutations.length===n.length);for(var i=Fr,r=t.mutations,o=0;o<r.length;o++)i=i.nt(r[o].key,n[o].version);return new Wa(t,e,n,i)},Wa),qa=(Ka.prototype.catch=function(t){return this.next(void 0,t)},Ka.prototype.next=function(i,r){var o=this;return this.pn&&Pi(),this.pn=!0,this.Vn?this.error?this.yn(r,this.error):this.gn(i,this.result):new Ka(function(e,n){o.An=function(t){o.gn(i,t).next(e,n)},o.Pn=function(t){o.yn(r,t).next(e,n)}})},Ka.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ka.prototype.bn=function(t){try{var e=t();return e instanceof Ka?e:Ka.resolve(e)}catch(t){return Ka.reject(t)}},Ka.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):Ka.resolve(e)},Ka.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):Ka.reject(e)},Ka.resolve=function(n){return new Ka(function(t,e){t(n)})},Ka.reject=function(n){return new Ka(function(t,e){e(n)})},Ka.Sn=function(t){return new Ka(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Ka.Cn=function(t){for(var n=Ka.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?Ka.resolve(t):e()})}(i[e]);return n},Ka.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Sn(r)},Ka),Fa=(Ha.prototype.$n=function(e,n){var i=this;return this.Fn.kn(e,n).next(function(t){return i.xn(e,n,t)})},Ha.prototype.xn=function(t,i,r){return this.Dn.Ln(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].mn(i,t);return t})},Ha.prototype.On=function(t,e,r){var o=Ur;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].mn(t,e);o=o.nt(t,e)}),o},Ha.prototype.qn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},Ha.prototype.Mn=function(i,r){var o=this;return this.Fn.Un(i,r).next(function(t){var e=o.On(i,r,t),n=Ur;return e.forEach(function(t,e){e=e||new Ys(t,$i.min()),n=n.nt(t,e)}),n})},Ha.prototype.Bn=function(t,e,n){return i=e,nr.W(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.Wn(t,e.path):ia(e)?this.Qn(t,e,n):this.jn(t,e,n);var i},Ha.prototype.Wn=function(t,e){return this.$n(t,new nr(e)).next(function(t){var e=qr;return t instanceof Ws&&(e=e.nt(t.key,t)),e})},Ha.prototype.Qn=function(n,i,r){var o=this,s=i.collectionGroup,a=qr;return this.Nn.Gn(n,s).next(function(t){return qa.forEach(t,function(t){var e=i.rn(t.child(s));return o.jn(n,e,r).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Ha.prototype.jn=function(e,n,t){var c,l,i=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,i.Fn.zn(e,n)}).next(function(t){return l=t,i.Kn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=ws(s,u,u,i.dn);c=h instanceof Ws?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){fa(n,e)||(c=c.remove(t))}),c})},Ha.prototype.Kn=function(t,e,n){for(var i=Gr(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof Ns&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.Dn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ws&&(h=h.nt(t,e))}),h})},Ha),ja=(za.Xn=function(t,e){for(var n=Gr(),i=Gr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new za(t,e.fromCache,n,i)},za),Ga=(Ba.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ba.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},Ba);function Ba(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function za(t,e,n,i){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=i}function Ha(t,e,n){this.Dn=t,this.Fn=e,this.Nn=n}function Ka(t){var e=this;this.An=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Wa(t,e,n,i){this.batch=t,this.In=e,this.Tn=n,this.Rn=i}function Ya(t,e,n,i){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=i}function Xa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Ga.ns=-1;var Qa=(iu.prototype.reset=function(){this.us=0},iu.prototype._s=function(){this.us=this.as},iu.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),i=Math.max(0,Date.now()-this.ls),r=Math.max(0,n-i);0<r&&Oi("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.cs=this.ss.ws(this.rs,r,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},iu.prototype.Ts=function(){null!==this.cs&&(this.cs.ms(),this.cs=null)},iu.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},iu.prototype.ds=function(){return(Math.random()-.5)*this.us},iu),$a=(nu.prototype.Is=function(t,e){return this.Es.add(e),qa.resolve()},nu.prototype.Gn=function(t,e){return qa.resolve(this.Es.getEntries(e))},nu),Ja=(eu.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Vr(Zi.P),r=!i.has(n);return this.index[e]=i.add(n),r},eu.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},eu.prototype.getEntries=function(t){return(this.index[t]||new Vr(Zi.P)).F()},eu),Za=(tu.prototype.next=function(){return this.Rs+=2,this.Rs},tu.As=function(){return new tu(0)},tu.Ps=function(){return new tu(-1)},tu);function tu(t){this.Rs=t}function eu(){this.index={}}function nu(){this.Es=new Ja}function iu(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=i,this.as=r,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function ru(t){return"IndexedDbTransactionError"===t.name}function ou(){return"undefined"!=typeof window?window:null}var su=(hu.vs=function(t,e,n,i,r){var o=new hu(t,e,Date.now()+n,i,r);return o.start(n),o},hu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},hu.prototype.ms=function(){return this.Ss()},hu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new Xi(Yi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},hu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},hu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},hu),au=(Object.defineProperty(uu.prototype,"Ms",{get:function(){return this.Ns},enumerable:!1,configurable:!0}),uu.prototype.Cs=function(t){this.enqueue(t)},uu.prototype.Us=function(t){this.Bs(),this.Ws(t)},uu.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},uu.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.Ns?[3,2]:(this.Ns=!0,(e=ou())&&e.removeEventListener("visibilitychange",this.qs),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},uu.prototype.enqueue=function(t){return this.Bs(),this.Ns?new Promise(function(t){}):this.Ws(t)},uu.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.zs()})},uu.prototype.zs=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Os.reset(),[3,4];case 3:if(!ru(e=t.sent()))throw e;return Oi("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Os.fs(function(){return n.zs()}),t.label=5;case 5:return[2]}})})},uu.prototype.Ws=function(t){var i=this,e=this.Ds.then(function(){return i.xs=!0,t().catch(function(t){throw i.ks=t,i.xs=!1,Si("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.xs=!1,t})});return this.Ds=e},uu.prototype.ws=function(t,e,n){var i=this;this.Bs(),-1<this.Ls.indexOf(t)&&(e=0);var r=su.vs(this,t,e,n,function(t){return i.Ks(t)});return this.$s.push(r),r},uu.prototype.Bs=function(){this.ks&&Pi()},uu.prototype.Hs=function(){},uu.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},uu.prototype.Xs=function(t){for(var e=0,n=this.$s;e<n.length;e++)if(n[e].rs===t)return!0;return!1},uu.prototype.Js=function(i){var r=this;return this.Ys().then(function(){r.$s.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=r.$s;t<e.length;t++){var n=e[t];if(n.ms(),"all"!==i&&n.rs===i)break}return r.Ys()})},uu.prototype.Zs=function(t){this.Ls.push(t)},uu.prototype.Ks=function(t){var e=this.$s.indexOf(t);this.$s.splice(e,1)},uu);function uu(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.Ns=!1,this.$s=[],this.ks=null,this.xs=!1,this.Ls=[],this.Os=new Qa(this,"async_queue_retry"),this.qs=function(){return t.Os.Ts()};var e=ou();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qs)}function hu(t,e,n,i,r){this.Vs=t,this.rs=e,this.ps=n,this.op=i,this.ys=r,this.gs=new Xa,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function cu(t,e){if(Si("AsyncQueue",e+": "+t),ru(t))return new Xi(Yi.UNAVAILABLE,e+": "+t);throw t}var lu=(fu.si=function(t){return new fu(t,fu.ii,fu.ri)},fu);function fu(t,e,n){this.ti=t,this.ei=e,this.ni=n}lu.oi=-1,lu.hi=1048576,lu.ai=41943040,lu.ii=10,lu.ri=1e3,lu.ui=new lu(lu.ai,lu.ii,lu.ri),lu.ci=new lu(lu.oi,0,0);var pu=(du.prototype.Vi=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ri,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Fn.pi(v).next(function(t){return g=t,e=i.persistence.wi(r),m=new Fa(i.Ti,e,i.persistence.Ai()),e.pi(v)}).next(function(t){for(var e=[],n=[],i=Gr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.qn(v,i).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ri=m,this.li.Pi(this.Ri),n)]}})})},du.prototype.bi=function(h){var c,l=this,f=Qi.now(),t=h.reduce(function(t,e){return t.add(e.key)},Gr());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ri.qn(u,t).next(function(t){c=t;for(var a,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(a=o,e=c.get(o.key),a instanceof Ds?function(t){for(var e=null,n=0,i=a.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Ws?t.field(r.field):void 0,s=Yo(r.transform,o||null);null!=s&&(e=null==e?(new xs).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Ns(o.key,s,function a(t){var u=[];return Gi(t.fields||{},function(t,e){var n=new er([t]);if(Ro(e)){var i=a(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new fs(u)}(s.proto.mapValue),ys.exists(!0)))}return l.Fn.Si(u,f,n,h)})}).then(function(t){var e=t.En(c);return{batchId:t.batchId,Ci:e}})},du.prototype.Di=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Ti.Fi({Ni:!0});return r.$i(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Fn.ki(t)}).next(function(){return r.Ri.qn(t,e)})})},du.prototype.xi=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Fn.Li(e,t).next(function(t){return Li(null!==t),n=t.keys(),i.Fn.Oi(e,t)}).next(function(){return i.Fn.ki(e)}).next(function(){return i.Ri.qn(e,n)})})},du.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.qi(t)})},du.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ei.Mi(t)})},du.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Ti.Fi({Ni:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n,i,r=l.get(e);r&&(s.push(h.Ei.Bi(o,t.Jt,e).next(function(){return h.Ei.Wi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(i=r.tt(n,c).Z(o.Qi),l=l.nt(e,i),du.ji(r,i,t)&&s.push(h.Ei.Gi(o,i))))});var t,a=Ur,n=Gr();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.jt.forEach(function(t,e){var n=i.get(t);e instanceof Ys&&e.version.isEqual($i.min())?(r.zi(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.Ki(e,c),a=a.nt(t,e)):Oi("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),c.isEqual($i.min())||(t=h.Ei.Mi(o).next(function(t){return h.Ei.Xi(o,o.Qi,c)}),s.push(t)),qa.Sn(s).next(function(){return r.apply(o)}).next(function(){return h.Ri.Mn(o,a)})}).then(function(t){return h._i=l,t})},du.ji=function(t,e,n){return Li(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},du.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return qa.forEach(c,function(e){return qa.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return qa.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!ru(e=t.sent()))throw e;return Oi("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},du.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},du.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ri.$n(t,e)})},du.prototype.rr=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ei.or(e,i).next(function(t){return t?(n=t,qa.resolve(n)):r.Ei.hr(e).next(function(t){return n=new Tr(i,t,0,e.Qi),r.Ei.ar(e,n).next(function(){return n})})})}).then(function(t){var e=r._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(r._i=r._i.nt(t.targetId,t),r.fi.set(i,t.targetId)),t})},du.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?qa.resolve(this._i.get(n)):this.Ei.or(t,e)},du.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,i,r=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return r.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ru(i=t.sent()))throw i;return Oi("LocalStore","Failed to update sequence numbers for target "+o+": "+i),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},du.prototype.cr=function(t,n){var i=this,r=$i.min(),o=Gr();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.or(e,oa(t)).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ei.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return i.li.Bn(e,t,n?r:$i.min(),n?o:Gr())}).next(function(t){return{documents:t,_r:o}})})},du.prototype.$i=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=qa.resolve();return n.forEach(function(i){a=a.next(function(){return o.Ln(t,i)}).next(function(t){var e=t,n=r.Rn.get(i);Li(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(i,e,r))&&o.Ki(e,r.In)})}),a.next(function(){return e.Fn.Oi(t,s)})},du.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},du);function du(t,e,n){this.persistence=t,this.li=e,this._i=new Rr(Ui),this.fi=new Wi(yr,vr),this.di=$i.min(),this.Fn=t.wi(n),this.Ti=t.mi(),this.Ei=t.Ii(),this.Ri=new Fa(this.Ti,this.Fn,this.persistence.Ai()),this.li.Pi(this.Ri)}function yu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Yi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Oi("LocalStore","Unexpectedly lost primary lease"),[2]})})}pu.Ji=3e8;var vu=(Eu.prototype._=function(){return this.Tr._()},Eu.prototype.tr=function(t,e){var n=new gu(t,e);this.Tr=this.Tr.add(n),this.Er=this.Er.add(n)},Eu.prototype.Rr=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},Eu.prototype.er=function(t,e){this.Ar(new gu(t,e))},Eu.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},Eu.prototype.Vr=function(t){var e=this,n=new nr(new Zi([])),i=new gu(n,t),r=new gu(n,t+1),o=[];return this.Er.bt([i,r],function(t){e.Ar(t),o.push(t.key)}),o},Eu.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Ar(t)})},Eu.prototype.Ar=function(t){this.Tr=this.Tr.delete(t),this.Er=this.Er.delete(t)},Eu.prototype.yr=function(t){var e=new nr(new Zi([])),n=new gu(e,t),i=new gu(e,t+1),r=Gr();return this.Er.bt([n,i],function(t){r=r.add(t.key)}),r},Eu.prototype.gr=function(t){var e=new gu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},Eu),gu=(bu.mr=function(t,e){return nr.P(t.key,e.key)||Ui(t.vr,e.vr)},bu.Ir=function(t,e){return Ui(t.vr,e.vr)||nr.P(t.key,e.key)},bu),mu=(wu.prototype.br=function(){return null!=this.uid},wu.prototype.Sr=function(){return this.br()?"uid:"+this.uid:"anonymous-user"},wu.prototype.isEqual=function(t){return t.uid===this.uid},wu);function wu(t){this.uid=t}function bu(t,e){this.key=t,this.vr=e}function Eu(){this.Tr=new Vr(gu.mr),this.Er=new Vr(gu.Ir)}function Iu(t,e){this.user=e,this.type="OAuth",this.Fr={},this.Fr.Authorization="Bearer "+t}function Tu(t){this.key=t}function Au(t){this.key=t}function Nu(t,e,n){this.query=t,this.targetId=e,this.view=n}function _u(t){this.key=t,this.oa=!1}function Ru(){this.qa=void 0,this.listeners=[]}mu.UNAUTHENTICATED=new mu(null),mu.Cr=new mu("google-credentials-uid"),mu.Dr=new mu("first-party-uid");var Ou,Su,Du,ku,Pu=(yh.prototype.getToken=function(){return Promise.resolve(null)},yh.prototype.$r=function(){},yh.prototype.kr=function(t){(this.Nr=t)(mu.UNAUTHENTICATED)},yh.prototype.xr=function(){this.Nr=null},yh),Lu=(dh.prototype.getToken=function(){var e=this,n=this.qr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.qr!==n?(Oi("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Li("string"==typeof t.accessToken),new Iu(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},dh.prototype.$r=function(){this.forceRefresh=!0},dh.prototype.kr=function(t){this.Nr=t,this.Or&&t(this.currentUser)},dh.prototype.xr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Lr),this.Lr=null,this.Nr=null},dh.prototype.Mr=function(){var t=this.auth&&this.auth.getUid();return Li(null===t||"string"==typeof t),new mu(t)},dh),Vu=(Object.defineProperty(ph.prototype,"Fr",{get:function(){var t={"X-Goog-AuthUser":this.Br},e=this.Ur.auth.Wr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ph),Cu=(fh.prototype.getToken=function(){return Promise.resolve(new Vu(this.Ur,this.Br))},fh.prototype.kr=function(t){t(mu.Dr)},fh.prototype.xr=function(){},fh.prototype.$r=function(){},fh),Uu=(lh.prototype.Hr=function(){return 1===this.state||2===this.state||4===this.state},lh.prototype.Yr=function(){return 2===this.state},lh.prototype.start=function(){3!==this.state?this.auth():this.Xr()},lh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Hr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},lh.prototype.Jr=function(){this.state=0,this.Os.reset()},lh.prototype.Zr=function(){var t=this;this.Yr()&&null===this.Kr&&(this.Kr=this.ss.ws(this.Qr,6e4,function(){return t.to()}))},lh.prototype.eo=function(t){this.no(),this.stream.send(t)},lh.prototype.to=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Yr()?[2,this.close(0)]:[2]})})},lh.prototype.no=function(){this.Kr&&(this.Kr.cancel(),this.Kr=null)},lh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.no(),this.Os.cancel(),this.zr++,3!==e?this.Os.reset():n&&n.code===Yi.RESOURCE_EXHAUSTED?(Si(n.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.Os._s()):n&&n.code===Yi.UNAUTHENTICATED&&this.Gr.$r(),null!==this.stream&&(this.so(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.io(n)];case 1:return t.sent(),[2]}})})},lh.prototype.so=function(){},lh.prototype.auth=function(){var n=this;this.state=1;var t=this.ro(this.zr),e=this.zr;this.Gr.getToken().then(function(t){n.zr===e&&n.oo(t)},function(e){t(function(){var t=new Xi(Yi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ho(t)})})},lh.prototype.oo=function(t){var e=this,n=this.ro(this.zr);this.stream=this.ao(t),this.stream.uo(function(){n(function(){return e.state=2,e.listener.uo()})}),this.stream.io(function(t){n(function(){return e.ho(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},lh.prototype.Xr=function(){var t=this;this.state=4,this.Os.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},lh.prototype.ho=function(t){return Oi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},lh.prototype.ro=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.zr===e?t():(Oi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},lh),Mu=(n(ch,Du=Uu),ch.prototype.ao=function(t){return this.jr.co("Listen",t)},ch.prototype.onMessage=function(t){this.Os.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pi(),a=e.targetChange.targetIds||[],u=(r=e.targetChange.resumeToken,t.Oe?(Li(void 0===r||"string"==typeof r),mr.fromBase64String(r||"")):(Li(void 0===r||r instanceof Uint8Array),mr.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=new Kr(s,a,u,h&&(i=void 0===(n=h).code?Yi.UNKNOWN:_r(n.code),new Xi(i,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=qo(t,l.document.name),p=Uo(l.document.updateTime),d=new Ms({mapValue:{fields:l.document.fields}}),y=new Ws(f,p,d,{}),c=new zr(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=qo(t,v.document),m=v.readTime?Uo(v.readTime):$i.min(),w=new Ys(g,m);c=new zr([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=qo(t,b.document);c=new zr([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Pi();e.filter;var I=e.filter;I.targetId;var T=new br(I.count||0);c=new Hr(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return $i.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?$i.min():Uo(e.readTime)}(t);return this.listener.lo(e,n)},ch.prototype._o=function(t){var e,n,i,r,o={};o.database=jo(this.serializer),o.addTarget=(e=this.serializer,(i=gr(r=(n=t).target)?{documents:{documents:[Fo(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Fo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:(e=t.op,So[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Ho((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Oe||lr(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=zo(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.H()&&(i.resumeToken=Co(e,n.resumeToken)),i);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pi()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.eo(o)},ch.prototype.fo=function(t){var e={};e.database=jo(this.serializer),e.removeTarget=t,this.eo(e)},ch),xu=(n(hh,Su=Uu),Object.defineProperty(hh.prototype,"wo",{get:function(){return this.do},enumerable:!1,configurable:!0}),hh.prototype.start=function(){this.do=!1,this.lastStreamToken=void 0,Su.prototype.start.call(this)},hh.prototype.so=function(){this.do&&this.To([])},hh.prototype.ao=function(t){return this.jr.co("Write",t)},hh.prototype.onMessage=function(t){if(Li(!!t.streamToken),this.lastStreamToken=t.streamToken,this.do){this.Os.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Li(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual($i.min())&&(n=Uo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new ds(n,i)}(t,r)})):[]),n=Uo(t.commitTime);return this.listener.mo(n,e)}var i,r;return Li(!t.writeResults||0===t.writeResults.length),this.do=!0,this.listener.Eo()},hh.prototype.Io=function(){var t={};t.database=jo(this.serializer),this.eo(t)},hh.prototype.To=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.eo(n)},hh),qu=(n(uh,Ou=function(){}),uh.prototype.Ao=function(){if(this.Ro)throw new Xi(Yi.FAILED_PRECONDITION,"The client has already been terminated.")},uh.prototype.start=function(t){this.jr=t},uh.prototype.Po=function(e,n,i){var r=this;return this.Ao(),this.credentials.getToken().then(function(t){return r.jr.Po(e,n,i,t)}).catch(function(t){throw t.code===Yi.UNAUTHENTICATED&&r.credentials.$r(),t})},uh.prototype.Vo=function(e,n,i){var r=this;return this.Ao(),this.credentials.getToken().then(function(t){return r.jr.Vo(e,n,i,t)}).catch(function(t){throw t.code===Yi.UNAUTHENTICATED&&r.credentials.$r(),t})},uh.prototype.po=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ro=!1,[2]})})},uh),Fu=(ah.prototype.Co=function(){var t=this;0===this.vo&&(this.Do("Unknown"),this.bo=this.Vs.ws("online_state_timeout",1e4,function(){return t.bo=null,t.Fo("Backend didn't respond within 10 seconds."),t.Do("Offline"),Promise.resolve()}))},ah.prototype.No=function(t){"Online"===this.state?this.Do("Unknown"):(this.vo++,1<=this.vo&&(this.$o(),this.Fo("Connection failed 1 times. Most recent error: "+t.toString()),this.Do("Offline")))},ah.prototype.set=function(t){this.$o(),this.vo=0,"Online"===t&&(this.So=!1),this.Do(t)},ah.prototype.Do=function(t){t!==this.state&&(this.state=t,this.yo(t))},ah.prototype.Fo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.So?(Si(e),this.So=!1):Oi("OnlineStateTracker",e)},ah.prototype.$o=function(){null!==this.bo&&(this.bo.cancel(),this.bo=null)},ah),ju=(sh.prototype.start=function(){return this.enableNetwork()},sh.prototype.enableNetwork=function(){return this.Mo.delete(0),this.th()},sh.prototype.th=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(this.eh()?this.nh():this.jo.set("Unknown"),[4,this.sh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(0),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),[2]}})})},sh.prototype.ih=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Yo.stop()];case 1:return t.sent(),[4,this.Go.stop()];case 2:return t.sent(),0<this.Lo.length&&(Oi("RemoteStore","Stopping write stream with "+this.Lo.length+" pending writes"),this.Lo=[]),this.rh(),[2]}})})},sh.prototype.oh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Oi("RemoteStore","RemoteStore shutting down."),this.Mo.add(5),[4,this.ih()];case 1:return t.sent(),this.Uo.oh(),this.jo.set("Unknown"),[2]}})})},sh.prototype.listen=function(t){this.Oo.has(t.targetId)||(this.Oo.set(t.targetId,t),this.eh()?this.nh():this.Go.Yr()&&this.hh(t))},sh.prototype.ah=function(t){this.Oo.delete(t),this.Go.Yr()&&this.uh(t),0===this.Oo.size&&(this.Go.Yr()?this.Go.Zr():this.Wo()&&this.jo.set("Unknown"))},sh.prototype.Le=function(t){return this.Oo.get(t)||null},sh.prototype.xe=function(t){return this.lh.xe(t)},sh.prototype.hh=function(t){this.qo.de(t.targetId),this.Go._o(t)},sh.prototype.uh=function(t){this.qo.de(t),this.Go.fo(t)},sh.prototype.nh=function(){this.qo=new Zr(this),this.Go.start(),this.jo.Co()},sh.prototype.eh=function(){return this.Wo()&&!this.Go.Hr()&&0<this.Oo.size},sh.prototype.Wo=function(){return 0===this.Mo.size},sh.prototype.rh=function(){this.qo=null},sh.prototype.zo=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Oo.forEach(function(t,e){n.hh(t)}),[2]})})},sh.prototype.Ko=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.rh(),this.eh()?(this.jo.No(e),this.nh()):this.jo.set("Unknown"),[2]})})},sh.prototype.Ho=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.jo.set("Online"),!(r instanceof Kr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this._h(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Oi("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.fh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof zr?this.qo.Pe(r):r instanceof Hr?this.qo.Ce(r):this.qo.ye(r),o.isEqual($i.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.ko.Mi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.dh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Oi("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.fh(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},sh.prototype.fh=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ru(n))throw n;return this.Mo.add(1),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),i=i||function(){return e.ko.Mi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Oi("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.Mo.delete(1),[4,this.th()];case 2:return t.sent(),[2]}})})}),[2]}})})},sh.prototype.wh=function(e){var n=this;return e().catch(function(t){return n.fh(t,e)})},sh.prototype.dh=function(i){var r=this,t=this.qo.Ne(i);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=r.Oo.get(e))&&r.Oo.set(e,n.tt(t.resumeToken,i))}),t.Qt.forEach(function(t){var e,n=r.Oo.get(t);n&&(r.Oo.set(t,n.tt(mr.Y,n.J)),r.uh(t),e=new Tr(n.target,t,1,n.sequenceNumber),r.hh(e))}),this.lh.Ui(t)},sh.prototype._h=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.Oo.has(r)?[4,this.lh.Th(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.Oo.delete(r),this.qo.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},sh.prototype.sh=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:e=0<this.Lo.length?this.Lo[this.Lo.length-1].batchId:-1,t.label=1;case 1:if(!this.mh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.ko.nr(e)];case 3:return null===(n=t.sent())?(0===this.Lo.length&&this.Yo.Zr(),[3,7]):(e=n.batchId,this.Eh(n),[3,6]);case 4:return i=t.sent(),[4,this.fh(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ih()&&this.Rh(),[2]}})})},sh.prototype.mh=function(){return this.Wo()&&this.Lo.length<10},sh.prototype.Ah=function(){return this.Lo.length},sh.prototype.Eh=function(t){this.Lo.push(t),this.Yo.Yr()&&this.Yo.wo&&this.Yo.To(t.mutations)},sh.prototype.Ih=function(){return this.Wo()&&!this.Yo.Hr()&&0<this.Lo.length},sh.prototype.Rh=function(){this.Yo.start()},sh.prototype.Xo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Yo.Io(),[2]})})},sh.prototype.Zo=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this.Lo;e<n.length;e++)i=n[e],this.Yo.To(i.mutations);return[2]})})},sh.prototype.mo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Lo.shift(),n=xa.from(e,r,o),[4,this.wh(function(){return i.lh.Ph(n)})];case 1:return t.sent(),[4,this.sh()];case 2:return t.sent(),[2]}})})},sh.prototype.Jo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Yo.wo?[4,this.Vh(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ih()&&this.Rh(),[2]}})})},sh.prototype.Vh=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Nr(n=r.code)&&n!==Yi.ABORTED?(e=this.Lo.shift(),this.Yo.Jr(),[4,this.wh(function(){return i.lh.ph(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.sh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},sh.prototype.Qo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(4),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),this.Yo.Jr(),this.Go.Jr(),this.Mo.delete(4),[4,this.th()];case 2:return t.sent(),[2]}})})},sh.prototype.yh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Oi("RemoteStore","RemoteStore received new credentials"),this.Mo.add(3),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),[4,this.lh.yh(e)];case 2:return t.sent(),this.Mo.delete(3),[4,this.th()];case 3:return t.sent(),[2]}})})},sh.prototype.gh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Mo.delete(2),[4,this.th()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Mo.add(2),[4,this.ih()]);case 3:t.sent(),this.jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},sh),Gu=(oh.prototype.vh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},oh.prototype.bh=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},oh.prototype.Sh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},oh),Bu=(rh.prototype.Fh=function(t){},rh.prototype.Nh=function(t,e,n){},rh.prototype.$h=function(t){return this.Ch.vh(t),this.Dh[t]||"not-current"},rh.prototype.kh=function(t,e,n){this.Dh[t]=e},rh.prototype.xh=function(t){this.Ch.bh(t)},rh.prototype.Lh=function(t){return this.Ch.activeTargetIds.has(t)},rh.prototype.Oh=function(t){delete this.Dh[t]},rh.prototype.qh=function(){return this.Ch.activeTargetIds},rh.prototype.Mh=function(t){return this.Ch.activeTargetIds.has(t)},rh.prototype.start=function(){return this.Ch=new Gu,Promise.resolve()},rh.prototype.Vi=function(t,e,n){},rh.prototype.Uh=function(t){},rh.prototype.oh=function(){},rh.prototype.es=function(t){},rh),zu=(Object.defineProperty(ih.prototype,"zh",{get:function(){return this.Bh},enumerable:!1,configurable:!0}),ih.prototype.Kh=function(t,e){var a=this,u=e?e.Hh:new Yr,h=e?e.Gh:this.Gh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),i=(i=e instanceof Ws?e:null)&&(fa(a.query,i)?i:null),r=!!n&&a.qt.has(n.key),o=!!i&&(i.Ge||a.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.Yh(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.jh(i,p)||d&&a.jh(i,d)<0)&&(f=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Gh:l,Hh:u,Xh:f,qt:c}},ih.prototype.Yh=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},ih.prototype.Jh=function(t,e,n){var o=this,i=this.Gh;this.Gh=t.Gh,this.qt=t.qt;var r=t.Hh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.jh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pi()}}var i,r}),this.Zh(n);var s=e?this.ta():[],a=0===this.Qh.size&&this.Ht?1:0,u=a!==this.Wh;return this.Wh=a,0!==r.length||u?{snapshot:new Xr(this.query,t.Gh,i,r,t.qt,0==a,u,!1),ea:s}:{ea:s}},ih.prototype.na=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Jh({Gh:this.Gh,Hh:new Yr,qt:this.qt,Xh:!1},!1)):{ea:[]}},ih.prototype.sa=function(t){return!this.Bh.has(t)&&!!this.Gh.has(t)&&!this.Gh.get(t).Ge},ih.prototype.Zh=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Bh=e.Bh.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Bh=e.Bh.delete(t)}),this.Ht=t.Ht)},ih.prototype.ta=function(){var e=this;if(!this.Ht)return[];var n=this.Qh;this.Qh=Gr(),this.Gh.forEach(function(t){e.sa(t.key)&&(e.Qh=e.Qh.add(t.key))});var i=[];return n.forEach(function(t){e.Qh.has(t)||i.push(new Au(t))}),this.Qh.forEach(function(t){n.has(t)||i.push(new Tu(t))}),i},ih.prototype.ia=function(t){this.Bh=t._r,this.Qh=Gr();var e=this.Kh(t.documents);return this.Jh(e,!0)},ih.prototype.ra=function(){return Xr.Bt(this.query,this.Gh,this.qt,0===this.Wh)},ih),Hu=(Object.defineProperty(nh.prototype,"Aa",{get:function(){return!0===this.Ra},enumerable:!1,configurable:!0}),nh.prototype.subscribe=function(t){this.ca=t},nh.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.Pa("listen()"),(i=this.la.get(s))?(e=i.targetId,this.aa.$h(e),n=i.view.ra(),[3,4]):[3,1];case 1:return[4,this.ko.rr(oa(s))];case 2:return r=t.sent(),o=this.aa.$h(r.targetId),e=r.targetId,[4,this.Va(s,e,"current"===o)];case 3:n=t.sent(),this.Aa&&this.ha.listen(r),t.label=4;case 4:return[2,n]}})})},nh.prototype.Va=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.ko.cr(a,!0)];case 1:return e=t.sent(),n=new zu(a,e._r),i=n.Kh(e.documents),r=$r.Kt(u,h&&"Offline"!==this.onlineState),o=n.Jh(i,this.Aa,r),this.pa(u,o.ea),s=new Nu(a,u,n),[2,(this.la.set(a,s),this._a.has(u)?this._a.get(u).push(a):this._a.set(u,[a]),o.snapshot)]}})})},nh.prototype.ah=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("unlisten()"),e=this.la.get(r),1<(n=this._a.get(e.targetId)).length?[2,(this._a.set(e.targetId,n.filter(function(t){return!ha(t,r)})),void this.la.delete(r))]:this.Aa?(this.aa.xh(e.targetId),this.aa.Mh(e.targetId)?[3,2]:[4,this.ko.ur(e.targetId,!1).then(function(){i.aa.Oh(e.targetId),i.ha.ah(e.targetId),i.ya(e.targetId)}).catch(yu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ya(e.targetId),[4,this.ko.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},nh.prototype.write=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:this.Pa("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.ko.bi(r)];case 2:return e=t.sent(),this.aa.Fh(e.batchId),this.ga(e.batchId,o),[4,this.va(e.Ci)];case 3:return t.sent(),[4,this.ha.sh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=cu(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},nh.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.Pa("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=i.wa.get(e);n&&(Li(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.oa=!0:0<t.Xt.size?Li(n.oa):0<t.Jt.size&&(Li(n.oa),n.oa=!1))}),[4,this.va(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},nh.prototype.na=function(i,t){var r;(this.Aa&&0===t||!this.Aa&&1===t)&&(this.Pa("applyOnlineStateChange()"),r=[],this.la.forEach(function(t,e){var n=e.view.na(i);n.snapshot&&r.push(n.snapshot)}),this.ca.ba(i),this.ca.lo(r),this.onlineState=i,this.Aa&&this.aa.Uh(i))},nh.prototype.Th=function(a,u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("rejectListens()"),this.aa.kh(a,"rejected",u),e=this.wa.get(a),(n=e&&e.key)?(i=(i=new Rr(nr.P)).nt(n,new Ys(n,$i.min())),r=Gr().add(n),o=new Qr($i.min(),new Map,new Vr(Ui),i,r),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.da=this.da.remove(n),this.wa.delete(a),this.Sa(),[3,4];case 2:return[4,this.ko.ur(a,!1).then(function(){return s.ya(a,u)}).catch(yu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},nh.prototype.Ph=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.Pa("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Di(i)];case 2:return n=t.sent(),this.Ca(e,null),this.Da(e),this.aa.Nh(e,"acknowledged"),[4,this.va(n)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},nh.prototype.ph=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.Pa("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.xi(n)];case 2:return e=t.sent(),this.Ca(n,i),this.Da(n),this.aa.Nh(n,"rejected",i),[4,this.va(e)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},nh.prototype.Fa=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:this.ha.Wo()||Oi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ko.qi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Ea.get(e)||[]).push(o),this.Ea.set(e,n),[3,4]);case 3:return i=t.sent(),r=cu(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},nh.prototype.Da=function(t){(this.Ea.get(t)||[]).forEach(function(t){t.resolve()}),this.Ea.delete(t)},nh.prototype.Na=function(e){this.Ea.forEach(function(t){t.forEach(function(t){t.reject(new Xi(Yi.CANCELLED,e))})}),this.Ea.clear()},nh.prototype.ga=function(t,e){var n=(n=(n=this.ma[this.currentUser.Sr()])||new Rr(Ui)).nt(t,e);this.ma[this.currentUser.Sr()]=n},nh.prototype.Ca=function(t,e){var n,i=this.ma[this.currentUser.Sr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.ma[this.currentUser.Sr()]=i)},nh.prototype.ya=function(t,e){var n=this;void 0===e&&(e=null),this.aa.xh(t);for(var i=0,r=this._a.get(t);i<r.length;i++){var o=r[i];this.la.delete(o),e&&this.ca.$a(o,e)}this._a.delete(t),this.Aa&&this.Ta.Vr(t).forEach(function(t){n.Ta.gr(t)||n.ka(t)})},nh.prototype.ka=function(t){var e=this.da.get(t);null!==e&&(this.ha.ah(e),this.da=this.da.remove(t),this.wa.delete(e),this.Sa())},nh.prototype.pa=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Tu?(this.Ta.tr(r.key,t),this.xa(r)):r instanceof Au?(Oi("SyncEngine","Document no longer in limbo: "+r.key),this.Ta.er(r.key,t),this.Ta.gr(r.key)||this.ka(r.key)):Pi()}},nh.prototype.xa=function(t){var e=t.key;this.da.get(e)||(Oi("SyncEngine","New document in limbo: "+e),this.fa.push(e),this.Sa())},nh.prototype.Sa=function(){for(;0<this.fa.length&&this.da.size<this.ua;){var t=this.fa.shift(),e=this.Ia.next();this.wa.set(e,new _u(t)),this.da=this.da.nt(t,e),this.ha.listen(new Tr(oa(na(t.path)),e,2,Ga.ns))}},nh.prototype.La=function(){return this.da},nh.prototype.Oa=function(){return this.fa},nh.prototype.va=function(i,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.la.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Kh(i);return n.Xh?a.ko.cr(r.query,!1).then(function(t){var e=t.documents;return r.view.Kh(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(r.targetId),i=r.view.Jh(t,a.Aa,n);a.pa(r.targetId,i.ea),i.snapshot&&(a.Aa&&a.aa.kh(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=ja.Xn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.ca.lo(o),[4,this.ko.Zi(s)];case 2:return t.sent(),[2]}})})},nh.prototype.Pa=function(t){},nh.prototype.yh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Oi("SyncEngine","User change. New user:",n.Sr()),[4,this.ko.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.Na("'waitForPendingWrites' promise is rejected due to a user change."),this.aa.Vi(n,e.gi,e.vi),[4,this.va(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},nh.prototype.xe=function(t){var e=this.wa.get(t);if(e&&e.oa)return Gr().add(e.key);var n=Gr(),i=this._a.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],a=this.la.get(s),n=n.Dt(a.view.zh);return n},nh),Ku=(eh.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(i=this.Ma.get(e))||(n=!0,i=new Ru),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.lh.listen(e)];case 2:return r.qa=t.sent(),[3,4];case 3:return o=t.sent(),s=cu(o,"Initialization of query '"+la(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.Ma.set(e,i),i.listeners.push(a),a.na(this.onlineState),i.qa&&a.Ba(i.qa)&&this.Wa(),[2]}})})},eh.prototype.ah=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.Ma.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.Ma.delete(e),this.lh.ah(e))]:[2]})})},eh.prototype.lo=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.Ma.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Ba(r)&&(e=!0);s.qa=r}}e&&this.Wa()},eh.prototype.$a=function(t,e){var n=this.Ma.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.Ma.delete(t)},eh.prototype.ba=function(r){this.onlineState=r;var o=!1;this.Ma.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].na(r)&&(o=!0)}),o&&this.Wa()},eh.prototype.Qa=function(t){this.Ua.add(t),t.next()},eh.prototype.ja=function(t){this.Ua.delete(t)},eh.prototype.Wa=function(){this.Ua.forEach(function(t){t.next()})},eh),Wu=(th.prototype.Ba=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Xr(t.query,t.docs,t.Ot,e,t.qt,t.fromCache,t.Mt,!0)}var o=!1;return this.za?this.Ha(t)&&(this.Ga.next(t),o=!0):this.Ya(t,this.onlineState)&&(this.Xa(t),o=!0),this.Ka=t,o},th.prototype.onError=function(t){this.Ga.error(t)},th.prototype.na=function(t){this.onlineState=t;var e=!1;return this.Ka&&!this.za&&this.Ya(this.Ka,t)&&(this.Xa(this.Ka),e=!0),e},th.prototype.Ya=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ja&&n||t.docs._()&&"Offline"!==e)},th.prototype.Ha=function(t){if(0<t.docChanges.length)return!0;var e=this.Ka&&this.Ka.hasPendingWrites!==t.hasPendingWrites;return!(!t.Mt&&!e)&&!0===this.options.includeMetadataChanges},th.prototype.Xa=function(t){t=Xr.Bt(t.query,t.docs,t.qt,t.fromCache),this.za=!0,this.Ga.next(t)},th),Yu=(Zu.prototype.Pi=function(t){this.Za=t},Zu.prototype.Bn=function(e,i,r,o){var s=this;return i.on()||r.isEqual($i.min())?this.tu(e,i):this.Za.qn(e,o).next(function(t){var n=s.eu(i,t);return(i.hn()||i.an())&&s.Xh(i.en,n,o,r)?s.tu(e,i):(Ri()<=a.DEBUG&&Oi("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),la(i)),s.Za.Bn(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Zu.prototype.eu=function(n,t){var i=new Vr(pa(n));return t.forEach(function(t,e){e instanceof Ws&&fa(n,e)&&(i=i.add(e))}),i},Zu.prototype.Xh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},Zu.prototype.tu=function(t,e){return Ri()<=a.DEBUG&&Oi("IndexFreeQueryEngine","Using full collection scan to execute query:",la(e)),this.Za.Bn(t,e,$i.min())},Zu),Xu=(Ju.prototype.iu=function(t){return qa.resolve(0===this.Fn.length)},Ju.prototype.Si=function(t,e,n,i){var r=this.nu;this.nu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Ma(r,e,n,i);this.Fn.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.su=this.su.add(new gu(u.key,r)),this.Nn.Is(t,u.key.path.g())}return qa.resolve(o)},Ju.prototype.Li=function(t,e){return qa.resolve(this.ru(e))},Ju.prototype.sr=function(t,e){var n=e+1,i=this.ou(n),r=i<0?0:i;return qa.resolve(this.Fn.length>r?this.Fn[r]:null)},Ju.prototype.qi=function(){return qa.resolve(0===this.Fn.length?-1:this.nu-1)},Ju.prototype.pi=function(t){return qa.resolve(this.Fn.slice())},Ju.prototype.kn=function(t,e){var n=this,i=new gu(e,0),r=new gu(e,Number.POSITIVE_INFINITY),o=[];return this.su.bt([i,r],function(t){var e=n.ru(t.vr);o.push(e)}),qa.resolve(o)},Ju.prototype.Un=function(t,e){var i=this,r=new Vr(Ui);return e.forEach(function(t){var e=new gu(t,0),n=new gu(t,Number.POSITIVE_INFINITY);i.su.bt([e,n],function(t){r=r.add(t.vr)})}),qa.resolve(this.hu(r))},Ju.prototype.zn=function(t,e){var n=e.path,i=n.length+1,r=n;nr.W(r)||(r=r.child(""));var o=new gu(new nr(r),0),s=new Vr(Ui);return this.su.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.vr)),!0)},o),qa.resolve(this.hu(s))},Ju.prototype.hu=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.ru(t);null!==e&&i.push(e)}),i},Ju.prototype.Oi=function(n,i){var r=this;Li(0===this.au(i.batchId,"removed")),this.Fn.shift();var o=this.su;return qa.forEach(i.mutations,function(t){var e=new gu(t.key,i.batchId);return o=o.delete(e),r.Yi.uu(n,t.key)}).next(function(){r.su=o})},Ju.prototype.cu=function(t){},Ju.prototype.gr=function(t,e){var n=new gu(e,0),i=this.su.Ct(n);return qa.resolve(e.isEqual(i&&i.key))},Ju.prototype.ki=function(t){return this.Fn.length,qa.resolve()},Ju.prototype.au=function(t,e){return this.ou(t)},Ju.prototype.ou=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},Ju.prototype.ru=function(t){var e=this.ou(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},Ju),Qu=($u.prototype.Ki=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.lu(e);return this.docs=this.docs.nt(i,{_u:e,size:s,readTime:n}),this.size+=s-o,this.Nn.Is(t,i.path.g())},$u.prototype.zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},$u.prototype.Ln=function(t,e){var n=this.docs.get(e);return qa.resolve(n?n._u:null)},$u.prototype.getEntries=function(t,e){var n=this,i=Ur;return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e._u:null)}),qa.resolve(i)},$u.prototype.Bn=function(t,e,n){for(var i=qr,r=new nr(e.path.child("")),o=this.docs.ut(r);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u._u,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Ws&&fa(e,h)&&(i=i.nt(h.key,h))}return qa.resolve(i)},$u.prototype.fu=function(t,e){return qa.forEach(this.docs,function(t){return e(t)})},$u.prototype.Fi=function(t){return new $u.du(this)},$u.prototype.wu=function(t){return qa.resolve(this.size)},$u);function $u(t,e){this.Nn=t,this.lu=e,this.docs=new Rr(nr.P),this.size=0}function Ju(t,e){this.Nn=t,this.Yi=e,this.Fn=[],this.nu=1,this.su=new Vr(gu.mr)}function Zu(){}function th(t,e,n){this.query=t,this.Ga=e,this.za=!1,this.Ka=null,this.onlineState="Unknown",this.options=n||{}}function eh(t){this.lh=t,this.Ma=new Wi(ca,ha),this.onlineState="Unknown",this.Ua=new Set,this.lh.subscribe(this)}function nh(t,e,n,i,r,o){this.ko=t,this.ha=e,this.xo=n,this.aa=i,this.currentUser=r,this.ua=o,this.ca=null,this.la=new Wi(ca,ha),this._a=new Map,this.fa=[],this.da=new Rr(nr.P),this.wa=new Map,this.Ta=new vu,this.ma={},this.Ea=new Map,this.Ia=Za.Ps(),this.onlineState="Unknown",this.Ra=void 0}function ih(t,e){this.query=t,this.Bh=e,this.Wh=null,this.Ht=!1,this.Qh=Gr(),this.qt=Gr(),this.jh=pa(t),this.Gh=new Wr(this.jh)}function rh(){this.Ch=new Gu,this.Dh={},this.yo=null,this.Jn=null}function oh(){this.activeTargetIds=Br}function sh(t,e,n,i,r){var o,s,a,u,h,c,l,f,p=this;this.ko=t,this.xo=e,this.Vs=n,this.Lo=[],this.Oo=new Map,this.qo=null,this.Mo=new Set,this.Uo=r,this.Uo.Bo(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(Oi("RemoteStore","Restarting streams for network reachability change."),[4,this.Qo()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.jo=new Fu(n,i),this.Go=(h=this.xo,c=n,l={uo:this.zo.bind(this),io:this.Ko.bind(this),lo:this.Ho.bind(this)},(f=h).Ao(),new Mu(c,f.jr,f.credentials,f.serializer,l)),this.Yo=(o=this.xo,s=n,a={uo:this.Xo.bind(this),io:this.Jo.bind(this),Eo:this.Zo.bind(this),mo:this.mo.bind(this)},(u=o).Ao(),new xu(s,u.jr,u.credentials,u.serializer,a))}function ah(t,e){this.Vs=t,this.yo=e,this.state="Unknown",this.vo=0,this.bo=null,this.So=!0}function uh(t,e){var n=this;return(n=Ou.call(this)||this).credentials=t,n.serializer=e,n.Ro=!1,n}function hh(t,e,n,i,r){var o=this;return(o=Su.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.do=!1,o}function ch(t,e,n,i,r){var o=this;return(o=Du.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function lh(t,e,n,i,r,o){this.ss=t,this.Qr=n,this.jr=i,this.Gr=r,this.listener=o,this.state=0,this.zr=0,this.Kr=null,this.stream=null,this.Os=new Qa(t,e)}function fh(t,e){this.Ur=t,this.Br=e}function ph(t,e){this.Ur=t,this.Br=e,this.type="FirstParty",this.user=mu.Dr}function dh(t){var e=this;this.Lr=null,this.currentUser=mu.UNAUTHENTICATED,this.Or=!1,this.qr=0,this.Nr=null,this.forceRefresh=!1,this.Lr=function(){e.qr++,e.currentUser=e.Mr(),e.Or=!0,e.Nr&&e.Nr(e.currentUser)},this.qr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Lr):(this.Lr(null),t.get().then(function(t){e.auth=t,e.Lr&&e.auth.addAuthTokenListener(e.Lr)},function(){}))}function yh(){this.Nr=null}function vh(t){var e=this;return(e=ku.call(this)||this).Au=t,e}function gh(){this.Ci=new Wi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Tu=!1}Qu.du=(Object.defineProperty(gh.prototype,"readTime",{get:function(){return this.mu},set:function(t){this.mu=t},enumerable:!1,configurable:!0}),gh.prototype.Ki=function(t,e){this.Eu(),this.readTime=e,this.Ci.set(t.key,t)},gh.prototype.zi=function(t,e){this.Eu(),e&&(this.readTime=e),this.Ci.set(t,null)},gh.prototype.Ln=function(t,e){this.Eu();var n=this.Ci.get(e);return void 0!==n?qa.resolve(n):this.Iu(t,e)},gh.prototype.getEntries=function(t,e){return this.Ru(t,e)},gh.prototype.apply=function(t){return this.Eu(),this.Tu=!0,this.Jh(t)},gh.prototype.Eu=function(){},n(vh,ku=gh),vh.prototype.Jh=function(n){var i=this,r=[];return this.Ci.forEach(function(t,e){e?r.push(i.Au.Ki(n,e,i.readTime)):i.Au.zi(t)}),qa.Sn(r)},vh.prototype.Iu=function(t,e){return this.Au.Ln(t,e)},vh.prototype.Ru=function(t,e){return this.Au.getEntries(t,e)},vh);var mh,wh,bh=(xh.prototype.ge=function(t,n){return this.Pu.forEach(function(t,e){return n(e)}),qa.resolve()},xh.prototype.Mi=function(t){return qa.resolve(this.lastRemoteSnapshotVersion)},xh.prototype.gu=function(t){return qa.resolve(this.Vu)},xh.prototype.hr=function(t){return this.highestTargetId=this.yu.next(),qa.resolve(this.highestTargetId)},xh.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Vu&&(this.Vu=e),qa.resolve()},xh.prototype.vu=function(t){this.Pu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.yu=new Za(e),this.highestTargetId=e),t.sequenceNumber>this.Vu&&(this.Vu=t.sequenceNumber)},xh.prototype.ar=function(t,e){return this.vu(e),this.targetCount+=1,qa.resolve()},xh.prototype.Gi=function(t,e){return this.vu(e),qa.resolve()},xh.prototype.bu=function(t,e){return this.Pu.delete(e.target),this.pu.Vr(e.targetId),--this.targetCount,qa.resolve()},xh.prototype.Su=function(n,i,r){var o=this,s=0,a=[];return this.Pu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Pu.delete(t),a.push(o.Cu(n,e.targetId)),s++)}),qa.Sn(a).next(function(){return s})},xh.prototype.Du=function(t){return qa.resolve(this.targetCount)},xh.prototype.or=function(t,e){var n=this.Pu.get(e)||null;return qa.resolve(n)},xh.prototype.Wi=function(t,e,n){return this.pu.Rr(e,n),qa.resolve()},xh.prototype.Bi=function(e,t,n){this.pu.Pr(t,n);var i=this.persistence.Yi,r=[];return i&&t.forEach(function(t){r.push(i.uu(e,t))}),qa.Sn(r)},xh.prototype.Cu=function(t,e){return this.pu.Vr(e),qa.resolve()},xh.prototype.lr=function(t,e){var n=this.pu.yr(e);return qa.resolve(n)},xh.prototype.gr=function(t,e){return qa.resolve(this.pu.gr(e))},xh),Eh=(Mh.prototype.start=function(){return Promise.resolve()},Mh.prototype.oh=function(){return this.$u=!1,Promise.resolve()},Object.defineProperty(Mh.prototype,"xu",{get:function(){return this.$u},enumerable:!1,configurable:!0}),Mh.prototype.Lu=function(){},Mh.prototype.Ou=function(){},Mh.prototype.Ai=function(){return this.Nn},Mh.prototype.wi=function(t){var e=this.Fu[t.Sr()];return e||(e=new Xu(this.Nn,this.Yi),this.Fu[t.Sr()]=e),e},Mh.prototype.Ii=function(){return this.Ei},Mh.prototype.mi=function(){return this.Dn},Mh.prototype.runTransaction=function(t,e,n){var i=this;Oi("MemoryPersistence","Starting transaction:",t);var r=new Ih(this.Nu.next());return this.Yi.qu(),n(r).next(function(t){return i.Yi.Mu(r).next(function(){return t})}).vn().then(function(t){return r.Uu(),t})},Mh.prototype.Bu=function(e,n){return qa.Cn(Object.values(this.Fu).map(function(t){return function(){return t.gr(e,n)}}))},Mh),Ih=(Uh.prototype.Qu=function(t){this.Wu.push(t)},Uh.prototype.Uu=function(){this.Wu.forEach(function(t){return t()})},n(Ch,wh=Uh),Ch),Th=(Vh.zu=function(t){return new Vh(t)},Object.defineProperty(Vh.prototype,"Ku",{get:function(){if(this.Gu)return this.Gu;throw Pi()},enumerable:!1,configurable:!0}),Vh.prototype.tr=function(t,e,n){return this.ju.tr(n,e),this.Ku.delete(n),qa.resolve()},Vh.prototype.er=function(t,e,n){return this.ju.er(n,e),this.Ku.add(n),qa.resolve()},Vh.prototype.uu=function(t,e){return this.Ku.add(e),qa.resolve()},Vh.prototype.removeTarget=function(t,e){var n=this;this.ju.Vr(e.targetId).forEach(function(t){return n.Ku.add(t)});var i=this.persistence.Ii();return i.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ku.add(t)})}).next(function(){return i.bu(t,e)})},Vh.prototype.qu=function(){this.Gu=new Set},Vh.prototype.Mu=function(t){var n=this,i=this.persistence.mi().Fi();return qa.forEach(this.Ku,function(e){return n.Hu(t,e).next(function(t){t||i.zi(e)})}).next(function(){return n.Gu=null,i.apply(t)})},Vh.prototype.Hi=function(t,e){var n=this;return this.Hu(t,e).next(function(t){t?n.Ku.delete(e):n.Ku.add(e)})},Vh.prototype.ku=function(t){return 0},Vh.prototype.Hu=function(t,e){var n=this;return qa.Cn([function(){return qa.resolve(n.ju.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.Bu(t,e)}])},Vh),Ah=(Lh.prototype.uo=function(t){this.Ju=t},Lh.prototype.io=function(t){this.Zu=t},Lh.prototype.onMessage=function(t){this.tc=t},Lh.prototype.close=function(){this.Xu()},Lh.prototype.send=function(t){this.Yu(t)},Lh.prototype.ec=function(){this.Ju()},Lh.prototype.nc=function(t){this.Zu(t)},Lh.prototype.sc=function(t){this.tc(t)},Lh),Nh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},_h=(Ph.prototype.Po=function(e,t,n,i){var r=this.hc(e,t);Oi("RestConnection","Sending: ",r,n);var o={};return this.ac(o,i),this.uc(e,r,o,n).then(function(t){return Oi("RestConnection","Received: ",t),t},function(t){throw Di("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Ph.prototype.Vo=function(t,e,n,i){return this.Po(t,e,n,i)},Ph.prototype.ac=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2",t["Content-Type"]="text/plain",e)for(var n in e.Fr)e.Fr.hasOwnProperty(n)&&(t[n]=e.Fr[n])},Ph.prototype.hc=function(t,e){var n=Nh[t];return this.rc+"/v1/"+e+":"+n},n(kh,mh=Ph),kh.prototype.uc=function(u,e,n,i){return new Promise(function(o,s){var a=new Ti;a.listenOnce(Ei.COMPLETE,function(){try{switch(a.getLastErrorCode()){case bi.NO_ERROR:var t=a.getResponseJson();Oi("Connection","XHR received:",JSON.stringify(t)),o(t);break;case bi.TIMEOUT:Oi("Connection",'RPC "'+u+'" timed out'),s(new Xi(Yi.DEADLINE_EXCEEDED,"Request time out"));break;case bi.HTTP_ERROR:var e,n,i=a.getStatus();Oi("Connection",'RPC "'+u+'" failed with status:',i,"response text:",a.getResponseText()),0<i?(e=a.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Yi).indexOf(r)?r:Yi.UNKNOWN,s(new Xi(n,e.message))):s(new Xi(Yi.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Xi(Yi.UNAVAILABLE,"Connection failed."));break;default:Pi()}}finally{Oi("Connection",'RPC "'+u+'" completed.')}var r});var t=JSON.stringify(i);a.send(e,"POST",t,n,15)})},kh.prototype.co=function(t,e){var n,i,r=[this.rc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ac(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Oi("Connection","Creating WebChannel: "+a,s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Ah({Yu:function(t){l?Oi("Connection","Not sending because WebChannel is closed:",t):(c||(Oi("Connection","Opening WebChannel transport."),h.open(),c=!0),Oi("Connection","WebChannel sending:",t),h.send(t))},Xu:function(){return h.close()}});return u(Ii.EventType.OPEN,function(){l||Oi("Connection","WebChannel transport opened.")}),u(Ii.EventType.CLOSE,function(){l||(l=!0,Oi("Connection","WebChannel transport closed"),f.nc())}),u(Ii.EventType.ERROR,function(t){l||(l=!0,Di("Connection","WebChannel transport errored:",t),f.nc(new Xi(Yi.UNAVAILABLE,"The operation could not be completed")))}),u(Ii.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Li(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Oi("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Er[r];if(void 0!==t)return _r(t)}(),s=i.message,void 0===o&&(o=Yi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.nc(new Xi(o,s)),h.close()):(Oi("Connection","WebChannel received:",n),f.sc(n)))}),setTimeout(function(){f.ec()},0),f},kh),Rh=(Dh.prototype.Bo=function(t){this.dc.push(t)},Dh.prototype.oh=function(){window.removeEventListener("online",this.cc),window.removeEventListener("offline",this._c)},Dh.prototype.wc=function(){window.addEventListener("online",this.cc),window.addEventListener("offline",this._c)},Dh.prototype.lc=function(){Oi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(0)},Dh.prototype.fc=function(){Oi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(1)},Dh.Tc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Dh),Oh=(Sh.prototype.Bo=function(t){},Sh.prototype.oh=function(){},Sh);function Sh(){}function Dh(){var t=this;this.cc=function(){return t.lc()},this._c=function(){return t.fc()},this.dc=[],this.wc()}function kh(t){var e=this;return(e=mh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Ph(t){this.ic=t,this.s=t.s;var e=t.ssl?"https":"http";this.rc=e+"://"+t.host,this.oc="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Lh(t){this.Yu=t.Yu,this.Xu=t.Xu}function Vh(t){this.persistence=t,this.ju=new vu,this.Gu=null}function Ch(t){var e=this;return(e=wh.call(this)||this).Qi=t,e}function Uh(){this.Wu=[]}function Mh(t){var e=this;this.Fu={},this.Nu=new Ga(0),this.$u=!1,this.$u=!0,this.Yi=t(this),this.Ei=new bh(this),this.Nn=new $a,this.Dn=new Qu(this.Nn,function(t){return e.Yi.ku(t)})}function xh(t){this.persistence=t,this.Pu=new Wi(yr,vr),this.lastRemoteSnapshotVersion=$i.min(),this.highestTargetId=0,this.Vu=0,this.pu=new vu,this.targetCount=0,this.yu=Za.As()}function qh(t){return new Do(t,!0)}var Fh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",jh=(zh.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.aa=this.mc(e),this.persistence=this.Ec(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ic=this.Rc(e),this.ko=this.Ac(e),[2]}})})},zh.prototype.Rc=function(t){return null},zh.prototype.Ac=function(t){return e=this.persistence,n=new Yu,i=t.Pc,new pu(e,n,i);var e,n,i},zh.prototype.Ec=function(t){if(t.pc.Vc)throw new Xi(Yi.FAILED_PRECONDITION,Fh);return new Eh(Th.zu)},zh.prototype.mc=function(t){return new Bu},zh.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.aa.oh()];case 1:return t.sent(),[4,this.persistence.oh()];case 2:return t.sent(),[2]}})})},zh.prototype.clearPersistence=function(t,e){throw new Xi(Yi.FAILED_PRECONDITION,Fh)},zh),Gh=(Bh.prototype.initialize=function(i,r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.ko?[2]:(this.ko=i.ko,this.aa=i.aa,this.xo=this.yc(r),[4,this.gc(r)]);case 1:return e=t.sent(),this.xo.start(e),this.ha=this.vc(r),this.lh=this.bc(r),this.Sc=this.Cc(r),this.aa.yo=function(t){return n.lh.na(t,1)},this.ha.lh=this.lh,[4,this.ha.start()];case 2:return t.sent(),[4,this.ha.gh(this.lh.Aa)];case 3:return t.sent(),[2]}})})},Bh.prototype.gc=function(t){return e=t.ic,Promise.resolve(new _h(e));var e},Bh.prototype.Cc=function(t){return new Ku(this.lh)},Bh.prototype.yc=function(t){var e=qh(t.ic.s),n=t.credentials;return new qu(n,e)},Bh.prototype.vc=function(t){var e=this;return new ju(this.ko,this.xo,t.Vs,function(t){return e.lh.na(t,0)},new(Rh.Tc()?Rh:Oh))},Bh.prototype.bc=function(t){return e=this.ko,n=this.ha,i=this.xo,r=this.aa,o=t.Pc,s=t.ua,a=!t.pc.Vc||!t.pc.synchronizeTabs,u=new Hu(e,n,i,r,o,s),a&&(u.Ra=!0),u;var e,n,i,r,o,s,a,u},Bh.prototype.terminate=function(){return this.ha.oh()},Bh);function Bh(){}function zh(){}function Hh(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Kh=(Wh.prototype.next=function(t){this.observer.next&&this.Dc(this.observer.next,t)},Wh.prototype.error=function(t){this.observer.error?this.Dc(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Wh.prototype.Fc=function(){this.muted=!0},Wh.prototype.Dc=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Wh);function Wh(t){this.observer=t,this.muted=!1}function Yh(t,e){if(0!==e.length)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fc(e.length,"argument")+".")}function Xh(t,e,n){if(e.length!==n)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires "+fc(n,"argument")+", but was called with "+fc(e.length,"argument")+".")}function Qh(t,e,n){if(e.length<n)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fc(n,"argument")+", but was called with "+fc(e.length,"argument")+".")}function $h(t,e,n,i){if(e.length<n||e.length>i)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+fc(e.length,"argument")+".")}function Jh(t,e,n,i){rc(t,e,lc(n)+" argument",i)}function Zh(t,e,n,i){void 0!==i&&Jh(t,e,n,i)}function tc(t,e,n,i){rc(t,e,n+" option",i)}function ec(t,e,n,i){void 0!==i&&tc(t,e,n,i)}function nc(t,e,n,i,u){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=u;r<o.length;r++){var s=o[r];if(s===n)return;i.push(sc(s))}var a=sc(n);throw new Xi(Yi.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function ic(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid value "+sc(i)+" provided to function "+t+"() for its "+lc(n)+" argument. Acceptable values: "+e.join(", "));return i}function rc(t,e,n,i){if(!("object"===e?oc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=sc(i);throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function sc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pi();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ac(t,e,n){if(void 0===n)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+lc(e)+" argument, but it was undefined.")}function uc(n,t,i){Gi(t,function(t,e){if(i.indexOf(t)<0)throw new Xi(Yi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function hc(t,e,n,i){var r=sc(i);return new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+lc(n)+" argument to be a "+e+", but it was: "+r)}function cc(t,e,n){if(n<=0)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+lc(e)+" argument to be a positive number, but it was: "+n+".")}function lc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fc(t,e){return t+" "+e+(1===t?"":"s")}function pc(){if("undefined"==typeof Uint8Array)throw new Xi(Yi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function dc(){if("undefined"==typeof atob)throw new Xi(Yi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var yc,vc,gc=(Nc.fromBase64String=function(t){Xh("Blob.fromBase64String",arguments,1),Jh("Blob.fromBase64String","string",1,t),dc();try{return new Nc(mr.fromBase64String(t))}catch(t){throw new Xi(Yi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Nc.fromUint8Array=function(t){if(Xh("Blob.fromUint8Array",arguments,1),pc(),!(t instanceof Uint8Array))throw hc("Blob.fromUint8Array","Uint8Array",1,t);return new Nc(mr.fromUint8Array(t))},Nc.prototype.toBase64=function(){return Xh("Blob.toBase64",arguments,0),dc(),this.Nc.toBase64()},Nc.prototype.toUint8Array=function(){return Xh("Blob.toUint8Array",arguments,0),pc(),this.Nc.toUint8Array()},Nc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Nc.prototype.isEqual=function(t){return this.Nc.isEqual(t.Nc)},Nc),mc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Xi(Yi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Jh("FieldPath","string",e,t[e]),0===t[e].length)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.$c=new er(t)},wc=(n(Ac,vc=mc),Ac.documentId=function(){return new Ac(er.q().N())},Ac.prototype.isEqual=function(t){if(!(t instanceof Ac))throw hc("isEqual","FieldPath",1,t);return this.$c.isEqual(t.$c)},Ac),bc=new RegExp("[~\\*/\\[\\]]"),Ec=function(){this.kc=this},Ic=(n(Tc,yc=Ec),Tc.prototype.Lc=function(t){if(2!==t.Oc)throw 1===t.Oc?t.qc(this.xc+"() can only appear at the top level of your update data"):t.qc(this.xc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Tc.prototype.isEqual=function(t){return t instanceof Tc},Tc);function Tc(t){var e=this;return(e=yc.call(this)||this).xc=t,e}function Ac(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return vc.call(this,t)||this}function Nc(t){dc(),this.Nc=t}function _c(t,e,n){return new tl({Oc:3,Mc:e.settings.Mc,methodName:t.xc,Uc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Rc,Oc,Sc,Dc,kc,Pc,Lc=(n(Jc,Pc=Ec),Jc.prototype.Lc=function(t){return new ls(t.path,new $o)},Jc.prototype.isEqual=function(t){return t instanceof Jc},Jc),Vc=(n($c,kc=Ec),$c.prototype.Lc=function(t){var e=_c(this,t,!0),n=this.Bc.map(function(t){return ul(t,e)}),i=new Jo(n);return new ls(t.path,i)},$c.prototype.isEqual=function(t){return this===t},$c),Cc=(n(Qc,Dc=Ec),Qc.prototype.Lc=function(t){var e=_c(this,t,!0),n=this.Bc.map(function(t){return ul(t,e)}),i=new is(n);return new ls(t.path,i)},Qc.prototype.isEqual=function(t){return this===t},Qc),Uc=(n(Xc,Sc=Ec),Xc.prototype.Lc=function(t){var e=new as(t.serializer,Lo(t.serializer,this.Wc));return new ls(t.path,e)},Xc.prototype.isEqual=function(t){return this===t},Xc),Mc=(n(Yc,Oc=Ec),Yc.delete=function(){return Yh("FieldValue.delete",arguments),new xc(new Ic("FieldValue.delete"))},Yc.serverTimestamp=function(){return Yh("FieldValue.serverTimestamp",arguments),new xc(new Lc("FieldValue.serverTimestamp"))},Yc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qh("FieldValue.arrayUnion",arguments,1),new xc(new Vc("FieldValue.arrayUnion",t))},Yc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qh("FieldValue.arrayRemove",arguments,1),new xc(new Cc("FieldValue.arrayRemove",t))},Yc.increment=function(t){return Jh("FieldValue.increment","number",1,t),Xh("FieldValue.increment",arguments,1),new xc(new Uc("FieldValue.increment",t))},Yc),xc=(n(Wc,Rc=Mc),Wc.prototype.Lc=function(t){return this.kc.Lc(t)},Wc.prototype.isEqual=function(t){return t instanceof Wc&&this.kc.isEqual(t.kc)},Wc),qc=(Object.defineProperty(Kc.prototype,"latitude",{get:function(){return this.Qc},enumerable:!1,configurable:!0}),Object.defineProperty(Kc.prototype,"longitude",{get:function(){return this.jc},enumerable:!1,configurable:!0}),Kc.prototype.isEqual=function(t){return this.Qc===t.Qc&&this.jc===t.jc},Kc.prototype.T=function(t){return Ui(this.Qc,t.Qc)||Ui(this.jc,t.jc)},Kc),Fc=/^__.*__$/,jc=function(t,e,n){this.Gc=t,this.zc=e,this.Kc=n},Gc=(Hc.prototype.Hc=function(t,e){var n=[];return null!==this.qe?n.push(new Ns(t,this.data,this.qe,e)):n.push(new As(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},Hc),Bc=(zc.prototype.Hc=function(t,e){var n=[new Ns(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},zc);function zc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Hc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Kc(t,e){if(Xh("GeoPoint",arguments,2),Jh("GeoPoint","number",1,t),Jh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Xi(Yi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Xi(Yi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Qc=t,this.jc=e}function Wc(t){var e=this;return(e=Rc.call(this)||this).kc=t,e.xc=t.xc,e}function Yc(){return Oc.call(this)||this}function Xc(t,e){var n=this;return(n=Sc.call(this)||this).xc=t,n.Wc=e,n}function Qc(t,e){var n=this;return(n=Dc.call(this)||this).xc=t,n.Bc=e,n}function $c(t,e){var n=this;return(n=kc.call(this)||this).xc=t,n.Bc=e,n}function Jc(t){var e=this;return(e=Pc.call(this)||this).xc=t,e}function Zc(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pi()}}var tl=(Object.defineProperty(il.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(il.prototype,"Oc",{get:function(){return this.settings.Oc},enumerable:!1,configurable:!0}),il.prototype.Xc=function(t){return new il(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},il.prototype.Jc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Xc({path:n,Uc:!1});return i.Zc(t),i},il.prototype.tl=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Xc({path:n,Uc:!1});return i.Yc(),i},il.prototype.el=function(t){return this.Xc({path:void 0,Uc:!0})},il.prototype.qc=function(t){return dl(t,this.settings.methodName,this.settings.nl||!1,this.path,this.settings.Mc)},il.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},il.prototype.Yc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Zc(this.path.get(t))},il.prototype.Zc=function(t){if(0===t.length)throw this.qc("Document fields must not be empty");if(Zc(this.Oc)&&Fc.test(t))throw this.qc('Document fields cannot begin and end with "__"')},il),el=(nl.prototype.sl=function(t,e,n,i){return void 0===i&&(i=!1),new tl({Oc:t,methodName:e,Mc:n,path:er.k(),Uc:!1,nl:i},this.s,this.serializer,this.ignoreUndefinedProperties)},nl);function nl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||qh(t)}function il(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Yc(),this.fieldTransforms=r||[],this.qe=o||[]}function rl(t,e,n,i,r,o){void 0===o&&(o={});var s=t.sl(o.merge||o.mergeFields?2:0,e,n,r);ll("Data must be an object, but it was:",s,i);var a,u,h=hl(i,s);if(o.merge)a=new fs(s.qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof mc)d=p.$c;else{if("string"!=typeof p)throw Pi();d=pl(e,p,n)}if(!s.contains(d))throw new Xi(Yi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");yl(c,d)||c.push(d)}a=new fs(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Gc(new Ms(h),a,u)}function ol(t,o,s,e){var a=t.sl(1,o,s);ll("Data must be an object, but it was:",a,e);var u=[],h=new xs;Gi(e,function(t,e){var n,i=pl(o,t,s),r=a.tl(i);e instanceof Ec&&e.kc instanceof Ic?u.push(i):null!=(n=ul(e,r))&&(u.push(i),h.set(i,n))});var n=new fs(u);return new Bc(h.ze(),n,a.fieldTransforms)}function sl(t,e,n,i,r,o){var s=t.sl(1,e,n),a=[fl(e,i,n)],u=[r];if(o.length%2!=0)throw new Xi(Yi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(fl(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new xs,v=a.length-1;0<=v;--v)yl(d,a[v])||(c=a[v],l=u[v],f=s.tl(c),l instanceof Ec&&l.kc instanceof Ic?d.push(c):null!=(p=ul(l,f))&&(d.push(c),y.set(c,p)));var g=new fs(d);return new Bc(y.ze(),g,s.fieldTransforms)}function al(t,e,n,i){return void 0===i&&(i=!1),ul(n,t.sl(i?4:3,e))}function ul(s,t){if(cl(s))return ll("Unsupported field value:",t,s),hl(s,t);if(s instanceof Ec)return function(t,e){if(!Zc(e.Oc))throw e.qc(t.xc+"() can only be used with update() and set()");if(!e.path)throw e.qc(t.xc+"() is not currently supported inside arrays");var n=t.Lc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.Uc&&4!==t.Oc)throw t.qc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=ul(r[i],t.el(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Lo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Qi.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Qi){var i=new Qi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,i)}}if(t instanceof qc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gc)return{bytesValue:Co(e.serializer,t)};if(t instanceof jc){var r=e.s,o=t.Gc;if(!o.isEqual(r))throw e.qc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:Mo(t.Gc||e.s,t.zc.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.qc("Unsupported field value: "+sc(t))}(s,t)}function hl(t,i){var r={};return Bi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):Gi(t,function(t,e){var n=ul(e,i.Jc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function cl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qi||t instanceof qc||t instanceof gc||t instanceof jc||t instanceof Ec)}function ll(t,e,n){if(!cl(n)||!oc(n)){var i=sc(n);throw"an object"===i?e.qc(t+" a custom object"):e.qc(t+" "+i)}}function fl(t,e,n){if(e instanceof mc)return e.$c;if("string"==typeof e)return pl(t,e);throw dl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function pl(t,e,n){try{return function(e){if(0<=e.search(bc))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(wc.bind.apply(wc,r([void 0],e.split("."))))}catch(t){throw new Xi(Yi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).$c}catch(e){throw dl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function dl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+i),s&&(u+=" in document "+r),u+=")"),new Xi(Yi.INVALID_ARGUMENT,(a+=". ")+t+u)}function yl(t,e){return t.some(function(t){return t.isEqual(e)})}var vl=(El.prototype.al=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.ul(),0<this.mutations.length)throw new Xi(Yi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=jo((r=a).serializer)+"/documents",n={documents:u.map(function(t){return xo(r.serializer,t)})},[4,r.Vo("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Li(!!e.found),e.found.name,e.found.updateTime;var n=qo(t,e.found.name),i=Uo(e.found.updateTime),r=new Ms({mapValue:{fields:e.found.fields}});return new Ws(n,i,r,{})}(e,n):"missing"in n?function(t,e){Li(!!e.missing),Li(!!e.readTime);var n=qo(t,e.missing),i=Uo(e.readTime);return new Ys(n,i)}(e,n):Pi());o.set(i.key.toString(),i)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Li(!!e),s.push(e)}),s)]}})})}(this.xo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ys||t instanceof Ws?n.cl(t):Pi()}),e)]}})})},El.prototype.set=function(t,e){this.write(e.Hc(t,this.Be(t))),this.hl.add(t)},El.prototype.update=function(t,e){try{this.write(e.Hc(t,this.ll(t)))}catch(t){this.ol=t}this.hl.add(t)},El.prototype.delete=function(t){this.write([new Cs(t,this.Be(t))]),this.hl.add(t)},El.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.ul(),this.ol)throw this.ol;return e=this.il,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new nr(Zi.$(e));i.mutations.push(new Us(n,i.Be(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=jo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return Bo(e.serializer,t)})},[4,e.Po("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.xo,this.mutations)];case 1:return t.sent(),this.rl=!0,[2]}})})},El.prototype.cl=function(t){var e;if(t instanceof Ws)e=t.version;else{if(!(t instanceof Ys))throw Pi();e=$i.min()}var n=this.il.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Xi(Yi.ABORTED,"Document version changed between two reads.")}else this.il.set(t.key.toString(),e)},El.prototype.Be=function(t){var e=this.il.get(t.toString());return!this.hl.has(t)&&e?ys.updateTime(e):ys.je()},El.prototype.ll=function(t){var e=this.il.get(t.toString());if(this.hl.has(t)||!e)return ys.exists(!0);if(e.isEqual($i.min()))throw new Xi(Yi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ys.updateTime(e)},El.prototype.write=function(t){this.ul(),this.mutations=this.mutations.concat(t)},El.prototype.ul=function(){},El),gl=(bl.prototype.run=function(){this.fl()},bl.prototype.fl=function(){var t=this;this.Os.fs(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new vl(this.xo),(n=this.dl(e))&&n.then(function(t){i.Vs.Cs(function(){return e.commit().then(function(){i.gs.resolve(t)}).catch(function(t){i.wl(t)})})}).catch(function(t){i.wl(t)}),[2]})})})},bl.prototype.dl=function(t){try{var e=this.updateFunction(t);return!lr(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},bl.prototype.wl=function(t){var e=this;0<this._l&&this.Tl(t)?(--this._l,this.Vs.Cs(function(){return e.fl(),Promise.resolve()})):this.gs.reject(t)},bl.prototype.Tl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Nr(e)},bl),ml=(wl.prototype.start=function(t,e,n,i){var r=this;this.El(),this.ic=t;var o=new Xa,s=!1;return this.credentials.kr(function(t){return s?void r.Vs.Gs(function(){return r.ha.yh(t)}):(s=!0,Oi("FirestoreClient","Initializing. user=",t.uid),r.Il(e,n,i,t,o).then(r.ml.resolve,r.ml.reject))}),this.Vs.Cs(function(){return r.ml.promise}),o.promise},wl.prototype.enableNetwork=function(){var t=this;return this.El(),this.Vs.enqueue(function(){return t.persistence.Ou(!0),t.ha.enableNetwork()})},wl.prototype.Il=function(r,o,s,a,u){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Vs:this.Vs,ic:this.ic,clientId:this.clientId,credentials:this.credentials,Pc:a,ua:100,pc:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.aa=r.aa,this.ko=r.ko,this.Ic=r.Ic,this.xo=o.xo,this.ha=o.ha,this.lh=o.lh,this.Rl=o.Sc,this.persistence.Lu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.Al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Il(new jh,new Gh,{Vc:!1},a,u))];case 4:return[2]}})})},wl.prototype.Al=function(t){return"FirebaseError"===t.name?t.code===Yi.FAILED_PRECONDITION||t.code===Yi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},wl.prototype.El=function(){if(this.Vs.Ms)throw new Xi(Yi.FAILED_PRECONDITION,"The client has already been terminated.")},wl.prototype.disableNetwork=function(){var t=this;return this.El(),this.Vs.enqueue(function(){return t.persistence.Ou(!1),t.ha.disableNetwork()})},wl.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.ha.oh()];case 1:return t.sent(),[4,this.aa.oh()];case 2:return t.sent(),[4,this.persistence.oh()];case 3:return t.sent(),this.credentials.xr(),[2]}})})})},wl.prototype.waitForPendingWrites=function(){var t=this;this.El();var e=new Xa;return this.Vs.Cs(function(){return t.lh.Fa(e)}),e.promise},wl.prototype.listen=function(t,e,n){var i=this;this.El();var r=new Kh(n),o=new Wu(t,r,e);return this.Vs.Cs(function(){return i.Rl.listen(o)}),function(){r.Fc(),i.Vs.Cs(function(){return i.Rl.ah(o)})}},wl.prototype.Pl=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),function(n,o,s){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){switch(t.label){case 0:return r=new Xa,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.ir(s)];case 1:return(e=t.sent())instanceof Ws?r.resolve(e):e instanceof Ys?r.resolve(null):r.reject(new Xi(Yi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=cu(n,"Failed to get document '"+s+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})}(this.Vs,this.ko,e))]}})})},wl.prototype.Vl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),e=this.Vs,n=this.Rl,i=a,r=u,o=new Xa,s=Il(e,n,na(i.path),{includeMetadataChanges:!0,Ja:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Xi(Yi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Xi(Yi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},wl.prototype.pl=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),function(n,u,h){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return a=new Xa,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u.cr(h,!0)];case 1:return e=t.sent(),n=new zu(h,e._r),i=n.Kh(e.documents),r=n.Jh(i,!1),a.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=cu(o,"Failed to execute query '"+h+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})}(this.Vs,this.ko,e))]}})})},wl.prototype.yl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),e=this.Vs,n=this.Rl,i=a,r=u,o=new Xa,s=Il(e,n,i,{includeMetadataChanges:!0,Ja:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Xi(Yi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},wl.prototype.write=function(t){var e=this;this.El();var n=new Xa;return this.Vs.Cs(function(){return e.lh.write(t,n)}),n.promise},wl.prototype.s=function(){return this.ic.s},wl.prototype.Qa=function(t){var e=this;this.El();var n=new Kh(t);return this.Vs.Cs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Rl.Qa(n)]})})}),function(){n.Fc(),e.Vs.Cs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Rl.ja(n)]})})})}},Object.defineProperty(wl.prototype,"gl",{get:function(){return this.Vs.Ms},enumerable:!1,configurable:!0}),wl.prototype.transaction=function(t){var e=this;this.El();var n=new Xa;return this.Vs.Cs(function(){return new gl(e.Vs,e.xo,t,n).run(),Promise.resolve()}),n.promise},wl);function wl(t,e){this.credentials=t,this.Vs=e,this.clientId=Vi.t(),this.ml=new Xa}function bl(t,e,n,i){this.Vs=t,this.xo=e,this.updateFunction=n,this.gs=i,this._l=5,this.Os=new Qa(this.Vs,"transaction_retry")}function El(t){this.xo=t,this.il=new Map,this.mutations=[],this.rl=!1,this.ol=null,this.hl=new Set}function Il(t,e,n,i,r){var o=new Kh(r),s=new Wu(n,o,i);return t.Cs(function(){return e.listen(s)}),function(){o.Fc(),t.Cs(function(){return e.ah(s)})}}var Tl,Al,Nl=(Bl.prototype.Sl=function(t){switch(fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.Cl(t.timestampValue);case 4:return this.Dl(t);case 5:return t.stringValue;case 6:return new gc(Eo(t.bytesValue));case 7:return this.Fl(t.referenceValue);case 8:return this.Nl(t.geoPointValue);case 9:return this.$l(t.arrayValue);case 10:return this.kl(t.mapValue);default:throw Pi()}},Bl.prototype.kl=function(t){var n=this,i={};return Gi(t.fields||{},function(t,e){i[t]=n.Sl(e)}),i},Bl.prototype.Nl=function(t){return new qc(bo(t.latitude),bo(t.longitude))},Bl.prototype.$l=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sl(t)})},Bl.prototype.Dl=function(t){switch(this.vl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ho(n)?t(n):n}(t);return null==e?null:this.Sl(e);case"estimate":return this.Cl(co(t));default:return null}},Bl.prototype.Cl=function(t){var e=wo(t),n=new Qi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Bl.prototype.Fl=function(t){var e=Zi.$(t);Li(Ko(e));var n=new qi(e.get(1),e.get(3)),i=new nr(e.p(5));return n.isEqual(this.s)||Si("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.bl(i)},Bl),_l=lu.oi,Rl=(Gl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Gl),Ol=(Object.defineProperty(jl.prototype,"Gl",{get:function(){return this.zl||(this.zl=new el(this.Gc,this.jl.ignoreUndefinedProperties)),this.zl},enumerable:!1,configurable:!0}),jl.prototype.settings=function(t){Xh("Firestore.settings",arguments,1),Jh("Firestore.settings","object",1,t);var e=new Rl(t);if(this.Ul&&!this.jl.isEqual(e))throw new Xi(Yi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.jl=e).credentials&&(this.Ql=function(t){if(!t)return new Pu;switch(t.type){case"gapi":var e=t.Kl;return Li(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Cu(e,t.Br||"0");case"provider":return t.Kl;default:throw new Xi(Yi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},jl.prototype.enableNetwork=function(){return this.Ml(),this.Ul.enableNetwork()},jl.prototype.disableNetwork=function(){return this.Ml(),this.Ul.disableNetwork()},jl.prototype.enablePersistence=function(t){var e,n;if(this.Ul)throw new Xi(Yi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Si("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Xi(Yi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hl(this.xl,this.Ll,{Vc:!0,cacheSizeBytes:this.jl.cacheSizeBytes,synchronizeTabs:i,Yl:r})},jl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Ul&&!this.Ul.gl)throw new Xi(Yi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Xa,[2,(this.ql.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.xl.clearPersistence(this.Gc,this.Wl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},jl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(jl.prototype,"Xl",{get:function(){return this.Ml(),this.Ul.gl},enumerable:!1,configurable:!0}),jl.prototype.waitForPendingWrites=function(){return this.Ml(),this.Ul.waitForPendingWrites()},jl.prototype.onSnapshotsInSync=function(t){if(this.Ml(),Hh(t))return this.Ul.Qa(t);Jh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Ul.Qa(e)},jl.prototype.Ml=function(){return this.Ul||this.Hl(new jh,new Gh,{Vc:!1}),this.Ul},jl.prototype.Jl=function(){return new xi(this.Gc,this.Wl,this.jl.host,this.jl.ssl,this.jl.forceLongPolling)},jl.prototype.Hl=function(t,e,n){var i=this.Jl();return this.Ul=new ml(this.Ql,this.ql),this.Ul.start(i,t,e,n)},jl.Bl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Xi(Yi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Xi(Yi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qi(n)},Object.defineProperty(jl.prototype,"app",{get:function(){if(!this.Ol)throw new Xi(Yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ol},enumerable:!1,configurable:!0}),jl.prototype.collection=function(t){return Xh("Firestore.collection",arguments,1),Jh("Firestore.collection","non-empty string",1,t),this.Ml(),new $l(Zi.$(t),this,null)},jl.prototype.doc=function(t){return Xh("Firestore.doc",arguments,1),Jh("Firestore.doc","non-empty string",1,t),this.Ml(),kl.Zl(Zi.$(t),this,null)},jl.prototype.collectionGroup=function(t){if(Xh("Firestore.collectionGroup",arguments,1),Jh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ml(),new Xl((e=t,new ta(Zi.k(),e)),this,null);var e},jl.prototype.runTransaction=function(e){var n=this;return Xh("Firestore.runTransaction",arguments,1),Jh("Firestore.runTransaction","function",1,e),this.Ml().transaction(function(t){return e(new Sl(n,t))})},jl.prototype.batch=function(){return this.Ml(),new Dl(this)},Object.defineProperty(jl,"logLevel",{get:function(){switch(Ri()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),jl.setLogLevel=function(t){Xh("Firestore.setLogLevel",arguments,1),ic("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_i.setLogLevel(t)},jl.prototype.t_=function(){return this.jl.timestampsInSnapshots},jl),Sl=(Fl.prototype.get=function(t){var n=this;Xh("Transaction.get",arguments,1);var i=of("Transaction.get",t,this.e_);return this.n_.al([i.zc]).then(function(t){if(!t||1!==t.length)return Pi();var e=t[0];if(e instanceof Ys)return new Ll(n.e_,i.zc,null,!1,!1,i.Kc);if(e instanceof Ws)return new Ll(n.e_,i.zc,e,!1,!1,i.Kc);throw Pi()})},Fl.prototype.set=function(t,e,n){$h("Transaction.set",arguments,2,3);var i=of("Transaction.set",t,this.e_);n=ef("Transaction.set",n);var r=sf(i.Kc,e,n),o=rl(this.e_.Gl,"Transaction.set",i.zc,r,null!==i.Kc,n);return this.n_.set(i.zc,o),this},Fl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof wc?(Qh("Transaction.update",arguments,3),i=of("Transaction.update",t,this.e_),sl(this.e_.Gl,"Transaction.update",i.zc,e,n,o)):(Xh("Transaction.update",arguments,2),i=of("Transaction.update",t,this.e_),ol(this.e_.Gl,"Transaction.update",i.zc,e)),this.n_.update(i.zc,r),this},Fl.prototype.delete=function(t){Xh("Transaction.delete",arguments,1);var e=of("Transaction.delete",t,this.e_);return this.n_.delete(e.zc),this},Fl),Dl=(ql.prototype.set=function(t,e,n){$h("WriteBatch.set",arguments,2,3),this.r_();var i=of("WriteBatch.set",t,this.e_);n=ef("WriteBatch.set",n);var r=sf(i.Kc,e,n),o=rl(this.e_.Gl,"WriteBatch.set",i.zc,r,null!==i.Kc,n);return this.s_=this.s_.concat(o.Hc(i.zc,ys.je())),this},ql.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.r_(),r="string"==typeof e||e instanceof wc?(Qh("WriteBatch.update",arguments,3),i=of("WriteBatch.update",t,this.e_),sl(this.e_.Gl,"WriteBatch.update",i.zc,e,n,o)):(Xh("WriteBatch.update",arguments,2),i=of("WriteBatch.update",t,this.e_),ol(this.e_.Gl,"WriteBatch.update",i.zc,e)),this.s_=this.s_.concat(r.Hc(i.zc,ys.exists(!0))),this},ql.prototype.delete=function(t){Xh("WriteBatch.delete",arguments,1),this.r_();var e=of("WriteBatch.delete",t,this.e_);return this.s_=this.s_.concat(new Cs(e.zc,ys.je())),this},ql.prototype.commit=function(){return this.r_(),this.i_=!0,0<this.s_.length?this.e_.Ml().write(this.s_):Promise.resolve()},ql.prototype.r_=function(){if(this.i_)throw new Xi(Yi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ql),kl=(n(xl,Al=jc),xl.Zl=function(t,e,n){if(t.length%2!=0)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new xl(new nr(t),e,n)},Object.defineProperty(xl.prototype,"id",{get:function(){return this.zc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"parent",{get:function(){return new $l(this.zc.path.g(),this.firestore,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(xl.prototype,"path",{get:function(){return this.zc.path.N()},enumerable:!1,configurable:!0}),xl.prototype.collection=function(t){if(Xh("DocumentReference.collection",arguments,1),Jh("DocumentReference.collection","non-empty string",1,t),!t)throw new Xi(Yi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Zi.$(t);return new $l(this.zc.path.child(e),this.firestore,null)},xl.prototype.isEqual=function(t){if(!(t instanceof xl))throw hc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.zc.isEqual(t.zc)&&this.Kc===t.Kc},xl.prototype.set=function(t,e){$h("DocumentReference.set",arguments,1,2),e=ef("DocumentReference.set",e);var n=sf(this.Kc,t,e),i=rl(this.firestore.Gl,"DocumentReference.set",this.zc,n,null!==this.Kc,e);return this.Ul.write(i.Hc(this.zc,ys.je()))},xl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof wc?(Qh("DocumentReference.update",arguments,2),sl(this.firestore.Gl,"DocumentReference.update",this.zc,t,e,i)):(Xh("DocumentReference.update",arguments,1),ol(this.firestore.Gl,"DocumentReference.update",this.zc,t)),this.Ul.write(n.Hc(this.zc,ys.exists(!0)))},xl.prototype.delete=function(){return Xh("DocumentReference.delete",arguments,0),this.Ul.write([new Cs(this.zc,ys.je())])},xl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];$h("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof r[a]||Hh(r[a])||(uc("DocumentReference.onSnapshot",s=r[a],["includeMetadataChanges"]),ec("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};Hh(r[a])?(u=r[a],r[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),r[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),r[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(Jh("DocumentReference.onSnapshot","function",a,r[a]),Zh("DocumentReference.onSnapshot","function",a+1,r[a+1]),Zh("DocumentReference.onSnapshot","function",a+2,r[a+2]));var c={next:function(t){r[a]&&r[a](i.o_(t))},error:r[a+1],complete:r[a+2]};return this.Ul.listen(na(this.zc.path),h,c)},xl.prototype.get=function(t){var e=this;$h("DocumentReference.get",arguments,0,1),rf("DocumentReference.get",t);var n=this.firestore.Ml();return t&&"cache"===t.source?n.Pl(this.zc).then(function(t){return new Ll(e.firestore,e.zc,t,!0,t instanceof Ws&&t.Ge,e.Kc)}):n.Vl(this.zc,t).then(function(t){return e.o_(t)})},xl.prototype.withConverter=function(t){return new xl(this.zc,this.firestore,t)},xl.prototype.o_=function(t){var e=t.docs.get(this.zc);return new Ll(this.firestore,this.zc,e,t.fromCache,t.hasPendingWrites,this.Kc)},xl),Pl=(Ml.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ml),Ll=(Ul.prototype.data=function(t){var e=this;if($h("DocumentSnapshot.data",arguments,0,1),t=nf("DocumentSnapshot.data",t),this.h_){if(this.Kc){var n=new Vl(this.e_,this.zc,this.h_,this.a_,this.u_,null);return this.Kc.fromFirestore(n,t)}return new Nl(this.e_.Gc,this.e_.t_(),t.serverTimestamps||"none",function(t){return new kl(t,e.e_,null)}).Sl(this.h_.Ze())}},Ul.prototype.get=function(t,e){var n=this;if($h("DocumentSnapshot.get",arguments,1,2),e=nf("DocumentSnapshot.get",e),this.h_){var i=this.h_.data().field(fl("DocumentSnapshot.get",t,this.zc));if(null!==i)return new Nl(this.e_.Gc,this.e_.t_(),e.serverTimestamps||"none",function(t){return new kl(t,n.e_,n.Kc)}).Sl(i)}},Object.defineProperty(Ul.prototype,"id",{get:function(){return this.zc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"ref",{get:function(){return new kl(this.zc,this.e_,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"exists",{get:function(){return null!==this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(Ul.prototype,"metadata",{get:function(){return new Pl(this.u_,this.a_)},enumerable:!1,configurable:!0}),Ul.prototype.isEqual=function(t){if(!(t instanceof Ul))throw hc("isEqual","DocumentSnapshot",1,t);return this.e_===t.e_&&this.a_===t.a_&&this.zc.isEqual(t.zc)&&(null===this.h_?null===t.h_:this.h_.isEqual(t.h_))&&this.Kc===t.Kc},Ul),Vl=(n(Cl,Tl=Ll),Cl.prototype.data=function(t){return Tl.prototype.data.call(this,t)},Cl);function Cl(){return null!==Tl&&Tl.apply(this,arguments)||this}function Ul(t,e,n,i,r,o){this.e_=t,this.zc=e,this.h_=n,this.a_=i,this.u_=r,this.Kc=o}function Ml(t,e){this.hasPendingWrites=t,this.fromCache=e}function xl(t,e,n){var i=this;return(i=Al.call(this,e.Gc,t,n)||this).zc=t,i.firestore=e,i.Kc=n,i.Ul=i.firestore.Ml(),i}function ql(t){this.e_=t,this.s_=[],this.i_=!1}function Fl(t,e){this.e_=t,this.n_=e}function jl(t,e,n,i){var r=this;if(void 0===n&&(n=new jh),void 0===i&&(i=new Gh),this.xl=n,this.Ll=i,this.Ol=null,this.ql=new au,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ml(),[4,this.Ul.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Ol=o,this.Gc=jl.Bl(o),this.Wl=o.name,this.Ql=new Lu(e)}else{var s=t;if(!s.projectId)throw new Xi(Yi.INVALID_ARGUMENT,"Must provide projectId");this.Gc=new qi(s.projectId,s.database),this.Wl="[DEFAULT]",this.Ql=new Pu}this.jl=new Rl({})}function Gl(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Xi(Yi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else tc("settings","non-empty string","host",t.host),this.host=t.host,ec("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(uc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ec("settings","object","credentials",t.credentials),this.credentials=t.credentials,ec("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ec("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Si("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Si("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,ec("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=lu.ai;else{if(t.cacheSizeBytes!==_l&&t.cacheSizeBytes<lu.hi)throw new Xi(Yi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+lu.hi);this.cacheSizeBytes=t.cacheSizeBytes}ec("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Bl(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.vl=n,this.bl=i}function zl(t,e,n){if("string"==typeof n){if(""===n)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ia(e)&&-1!==n.indexOf("/"))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(Zi.$(n));if(!nr.W(i))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return Io(t,new nr(i))}if(n instanceof jc)return Io(t,n.zc);throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+sc(n)+".")}function Hl(t,e){if(!Array.isArray(t)||0===t.length)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Kl(t,e,n){if(!n.isEqual(e))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Wl(t){if(t.an()&&0===t.tn.length)throw new Xi(Yi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yl,Xl=(tf.prototype.where=function(t,e,n){Xh("Query.where",arguments,3),ac("Query.where",3,n);var i,r,o=ic("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=fl("Query.where",t),a=function(t,e,n,i,r,o){var s;if(i.O()){if("array-contains"===r||"array-contains-any"===r)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r){Hl(o,r);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(zl(n,t,c))}s={arrayValue:{values:a}}}else s=zl(n,t,o)}else"in"!==r&&"array-contains-any"!==r||Hl(o,r),s=al(e,"Query.where",o,"in"===r);var l=ya.create(i,r,s);return function(t,e){var n=["array-contains","array-contains-any"],i=["in","array-contains-any"],r=0<=n.indexOf(e.op),o=0<=i.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&Kl(0,e.field,a)}else if(o||r){var u=null;if(o&&(u=t._n(i)),null===u&&r&&(u=t._n(n)),null!==u)throw u===e.op?new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}(t,l),l}(this.c_,this.firestore.Gl,this.firestore.Gc,s,o,n);return new tf((r=(i=this.c_).filters.concat([a]),new ta(i.path,i.collectionGroup,i.tn.slice(),r,i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.Kc)},tf.prototype.orderBy=function(t,e){var n;if($h("Query.orderBy",arguments,1,2),Zh("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Xi(Yi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=fl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o=new Ua(e,n),s=o;return null!==(i=t).un()||null!==(r=i.cn())&&Kl(0,r,s.field),o}(this.c_,o,n);return new tf((r=(i=this.c_).tn.concat([s]),new ta(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.Kc)},tf.prototype.limit=function(t){return Xh("Query.limit",arguments,1),Jh("Query.limit","number",1,t),cc("Query.limit",1,t),new tf(sa(this.c_,t,"F"),this.firestore,this.Kc)},tf.prototype.limitToLast=function(t){return Xh("Query.limitToLast",arguments,1),Jh("Query.limitToLast","number",1,t),cc("Query.limitToLast",1,t),new tf(sa(this.c_,t,"L"),this.firestore,this.Kc)},tf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qh("Query.startAt",arguments,1);var i=this.l_("Query.startAt",t,e,!0);return new tf(aa(this.c_,i),this.firestore,this.Kc)},tf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qh("Query.startAfter",arguments,1);var i=this.l_("Query.startAfter",t,e,!1);return new tf(aa(this.c_,i),this.firestore,this.Kc)},tf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qh("Query.endBefore",arguments,1);var i=this.l_("Query.endBefore",t,e,!0);return new tf(ua(this.c_,i),this.firestore,this.Kc)},tf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qh("Query.endAt",arguments,1);var i=this.l_("Query.endAt",t,e,!1);return new tf(ua(this.c_,i),this.firestore,this.Kc)},tf.prototype.isEqual=function(t){if(!(t instanceof tf))throw hc("isEqual","Query",1,t);return this.firestore===t.firestore&&ha(this.c_,t.c_)&&this.Kc===t.Kc},tf.prototype.withConverter=function(t){return new tf(this.c_,this.firestore,t)},tf.prototype.l_=function(c,t,e,n){if(ac(c,1,t),t instanceof Ll)return Xh(c,r([t],e),1),function(t,e,n,i){if(!n)throw new Xi(Yi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=ra(t);o<s.length;o++){var a=s[o];if(a.field.O())r.push(Io(e,n.key));else{var u=n.field(a.field);if(ho(u))throw new Xi(Yi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.N();throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Ra(r,i)}(this.c_,this.firestore.Gc,t.h_,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.tn;if(r.length>s.length)throw new Xi(Yi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<r.length;u++){var h=r[u];if(s[u].field.O()){if("string"!=typeof h)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!ia(t)&&-1!==h.indexOf("/"))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Zi.$(h));if(!nr.W(c))throw new Xi(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new nr(c);a.push(Io(e,l))}else{var f=al(n,i,h);a.push(f)}}return new Ra(a,o)}(this.c_,this.firestore.Gc,this.firestore.Gl,c,i,n)},tf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];$h("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof r[u]||Hh(r[u])||(uc("Query.onSnapshot",a=r[u],["includeMetadataChanges"]),ec("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),Hh(r[u])?(s=r[u],r[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Jh("Query.onSnapshot","function",u,r[u]),Zh("Query.onSnapshot","function",u+1,r[u+1]),Zh("Query.onSnapshot","function",u+2,r[u+2]));var h={next:function(t){r[u]&&r[u](new Ql(i.firestore,i.c_,t,i.Kc))},error:r[u+1],complete:r[u+2]};return Wl(this.c_),this.firestore.Ml().listen(this.c_,a,h)},tf.prototype.get=function(t){var e=this;$h("Query.get",arguments,0,1),rf("Query.get",t),Wl(this.c_);var n=this.firestore.Ml();return(t&&"cache"===t.source?n.pl(this.c_):n.yl(this.c_,t)).then(function(t){return new Ql(e.firestore,e.c_,t,e.Kc)})},tf),Ql=(Object.defineProperty(Zl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"empty",{get:function(){return this.f_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"size",{get:function(){return this.f_.docs.size},enumerable:!1,configurable:!0}),Zl.prototype.forEach=function(e,n){var i=this;$h("QuerySnapshot.forEach",arguments,1,2),Jh("QuerySnapshot.forEach","function",1,e),this.f_.docs.forEach(function(t){e.call(n,i.T_(t,i.metadata.fromCache,i.f_.qt.has(t.key)))})},Object.defineProperty(Zl.prototype,"query",{get:function(){return new Xl(this.__,this.e_,this.Kc)},enumerable:!1,configurable:!0}),Zl.prototype.docChanges=function(t){t&&(uc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ec("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.f_.Ut)throw new Xi(Yi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.d_&&this.w_===e||(this.d_=function(r,e,o){if(r.Ot._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Ot;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pi()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.f_,e,this.T_.bind(this)),this.w_=e),this.d_},Zl.prototype.isEqual=function(t){if(!(t instanceof Zl))throw hc("isEqual","QuerySnapshot",1,t);return this.e_===t.e_&&ha(this.__,t.__)&&this.f_.isEqual(t.f_)&&this.Kc===t.Kc},Zl.prototype.T_=function(t,e,n){return new Vl(this.e_,t.key,t,e,n,this.Kc)},Zl),$l=(n(Jl,Yl=Xl),Object.defineProperty(Jl.prototype,"id",{get:function(){return this.c_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"parent",{get:function(){var t=this.c_.path.g();return t._()?null:new kl(new nr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"path",{get:function(){return this.c_.path.N()},enumerable:!1,configurable:!0}),Jl.prototype.doc=function(t){$h("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Vi.t()),Jh("CollectionReference.doc","non-empty string",1,t);var e=Zi.$(t);return kl.Zl(this.c_.path.child(e),this.firestore,this.Kc)},Jl.prototype.add=function(t){Xh("CollectionReference.add",arguments,1),Jh("CollectionReference.add","object",1,this.Kc?this.Kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Jl.prototype.withConverter=function(t){return new Jl(this.m_,this.firestore,t)},Jl);function Jl(t,e,n){var i=this;if(((i=Yl.call(this,na(t),e,n)||this).m_=t).length%2!=1)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function Zl(t,e,n,i){this.e_=t,this.__=e,this.f_=n,this.Kc=i,this.d_=null,this.w_=null,this.metadata=new Pl(n.hasPendingWrites,n.fromCache)}function tf(t,e,n){this.c_=t,this.firestore=e,this.Kc=n}function ef(t,e){if(void 0===e)return{merge:!1};if(uc(t,e,["merge","mergeFields"]),ec(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+sc(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof wc))throw new Xi(Yi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+sc(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Xi(Yi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function nf(t,e){return void 0===e?{}:(uc(t,e,["serverTimestamps"]),nc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function rf(t,e){Zh(t,"object",1,e),e&&(uc(t,e,["source"]),nc(t,0,"source",e.source,["default","server","cache"]))}function of(t,e,n){if(e instanceof jc){if(e.firestore!==n)throw new Xi(Yi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw hc(t,"DocumentReference",1,e)}function sf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var af,uf={Firestore:Ol,GeoPoint:qc,Timestamp:Qi,Blob:gc,Transaction:Sl,WriteBatch:Dl,DocumentReference:kl,DocumentSnapshot:Ll,Query:Xl,QueryDocumentSnapshot:Vl,QuerySnapshot:Ql,CollectionReference:$l,FieldPath:wc,FieldValue:Mc,setLogLevel:Ol.setLogLevel,CACHE_SIZE_UNLIMITED:_l};(af=hf).INTERNAL.registerComponent(new Ai("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Ol(e,n,new jh,new Gh);var e,n},"PUBLIC").setServiceProps(Object.assign({},uf))),af.registerVersion("@firebase/firestore","1.16.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});