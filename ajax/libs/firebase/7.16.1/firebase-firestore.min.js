!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(gd){"use strict";try{(function(){gd=gd&&Object.prototype.hasOwnProperty.call(gd,"default")?gd.default:gd;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g;function E(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},N=_||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function x(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),k=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:R).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now||function(){return+new Date};function M(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++k))},j.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var Q,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var K=N.navigator;if(K){var X=K.userAgent;if(X){Q=X;break t}}Q=""}function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=W(Q,"Opera"),ot=W(Q,"Trident")||W(Q,"MSIE"),st=W(Q,"Edge"),ut=st||ot,at=W(Q,"Gecko")&&!(W(Q.toLowerCase(),"webkit")&&!W(Q,"Edge"))&&!(W(Q,"Trident")||W(Q,"MSIE"))&&!W(Q,"Edge"),ht=W(Q.toLowerCase(),"webkit")&&!W(Q,"Edge");function ct(){var t=N.document;return t?t.documentMode:void 0}t:{var ft="",lt=(rt=Q,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(ft)){nt=String(pt);break t}}nt=ft}var dt={};function yt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var vt=N.document&&ot&&(ct()||parseInt(nt,10))||void 0,gt=!ot||9<=Number(vt),mt=ot&&!yt("9"),wt=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",S,e),N.removeEventListener("test",S,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},M(It,bt);var Et={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function Nt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=F(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new At(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Ot={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ft(r),e&&e[Tt]?e.sa(n,r,P(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[Tt]?t.ra(e,n,P(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!gt)return null;var u,a,h=Mt(t);if(h||(t[Pt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=gt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Nt(t)))}function Ct(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Rt(t),n.call(r,e)}function Ut(t,e){if(t.V)return!0;if(gt)return Vt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new It(e,this))}function Mt(t){return(t=t[Pt])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==D(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function qt(){j.call(this),this.c=new St(this),(this.J=this).A=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(qt,j),qt.prototype[Tt]=!0,(T=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Ft(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new bt(t,n):t instanceof bt?t.target=t.target||n:(s=t,tt(t=new bt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},T.C=function(){if(qt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=N.JSON.stringify;function Gt(){this.b=this.a=null}var Qt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new $t},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Kt(t){N.setTimeout(function(){throw t},0)}function Xt(t,e){var n;Qt||(n=N.Promise.resolve(void 0),Qt=function(){n.then(Zt)}),Yt||(Qt(),Yt=!0),Jt.add(t,e)}Gt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Gt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Kt(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Yt=!1}function te(t,e){qt.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Ua,this),this.g=U()}function ee(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ne(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}function re(t,e,n){j.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ie(t){t.T=ne(t.b,t.c),t.f.apply(null,t.a)}function oe(t){j.call(this),this.b=t,this.a={}}M(te,qt),(T=te.prototype).Z=!1,T.L=null,T.Ua=function(){var t;this.Z&&(0<(t=U()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ee(this),this.start())))},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=U())},T.C=function(){te.M.C.call(this),ee(this),delete this.a},M(re,j),(T=re.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ie(this)},T.C=function(){re.M.C.call(this),this.T&&(N.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ie(this))},M(oe,j);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function he(){}oe.prototype.C=function(){oe.M.C.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=null;function fe(){return ce=ce||new qt}function le(t){bt.call(this,"serverreachability",t)}function pe(){var t=fe();t.dispatchEvent(new le(t))}function de(t){bt.call(this,"statevent",t)}function ye(){var t=fe();t.dispatchEvent(new de(t))}function ve(t){bt.call(this,"timingevent",t)}function ge(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}M(le,bt),M(de,bt),M(ve,bt);var me={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},we={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function be(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}be.prototype.a=null;var Te,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Ae(){bt.call(this,"d")}function Ne(){bt.call(this,"c")}function Se(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new oe(this),this.N=xe,t=ut?125:void 0,this.O=new te(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}M(Ae,bt),M(Ne,bt),M(Se,be),Te=new Se;var xe=45e3,Pe={},Oe={};function ke(t,e,n){t.B=1,t.f=Ze(We(e)),t.j=n,t.F=!0,Le(t,null)}function Le(t,e){t.s=U(),Ce(t),t.A=We(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),pn(n.b,"t",r),t.w=0,t.a=ir(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(C(t.ya,t,t.a),t.J)),ue(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),pe()}function Re(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Oe:(o=Number(i.substring(o,s)),isNaN(o)?Pe:(s+=1)+o>i.length?Oe:(i=i.substr(s,o),r.w=s+o,i)));if(a==Oe){4==e&&(t.c=4,ye(),u=!1);break}if(a==Pe){t.c=4,ye(),u=!1;break}Fe(t,a)}4==e&&0==n.length&&(t.c=1,ye(),u=!1),t.b=t.b&&u,u||(je(t),Me(t))}function Ce(t){t.P=U()+t.N,Ve(t,t.N)}function Ve(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=ge(C(t.Qa,t),e)}function Ue(t){t.h&&(N.clearTimeout(t.h),t.h=null)}function Me(t){0==t.g.u||t.l||Zn(t.g,t)}function je(t){Ue(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ee(t.O),ae(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Fe(t,e){try{var n,r,i,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||bn(l.b,t)))if(l.A=t.H,!t.o&&bn(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;Jn(l),l.a.cancel(),l.a=null}Yn(l),ye()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=ge(C(l.Na,l),6e3));if(wn(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else er(l,11)}else if(!t.o&&l.a!=t||Jn(l),!G(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(l.D=1.5*r),i=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(W(s,"spdy")||W(s,"quic")||W(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,Je(i.v,i.s,a))),l.u=3,l.c&&l.c.na(),h=t,(i=l).ea=rr(i,i.w?i.R:null,i.P),h.o?(En(i.b,h),c=h,(f=i.D)&&c.setTimeout(f),c.h&&(Ue(c),Ce(c)),i.a=h):Xn(i),0<l.f.length&&Hn(l)):"stop"!=d[0]&&"close"!=d[0]||er(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?er(l,7):zn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}pe()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ge(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ge(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ge(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=De.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==jn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||pe(),Ue(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ye(),je(this),Me(this);break t}this.o=!0,Fe(this,u)}this.F?(Re(this,e,i),ut&&this.b&&3==e&&(ue(this.G,this.O,"tick",this.Ra),this.O.start())):Fe(this,i),4==e&&je(this),this.b&&!this.l&&(4==e?Zn(this.g,this):(this.b=!1,Ce(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ye(),je(this),Me(this)}}}catch(t){}},T.Ra=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.Y(),this.w<e.length&&(Ue(this),Re(this,t,e),this.b&&4!=t&&Ce(this)))},T.cancel=function(){this.l=!0,je(this)},T.Qa=function(){this.h=null;var t=U();0<=t-this.P?(2!=this.B&&(pe(),ye()),je(this),this.c=2,Me(this)):Ve(this,this.P-t)},(T=Be.prototype).I=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return ze(this),this.a.concat()},T.get=function(t,e){return Ge(this.b,t)?this.b[t]:e},T.set=function(t,e){Ge(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Ke(this,t.c),Xe(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ye(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=tn(n[2]||""),Ke(this,n[3]||"",!0),Xe(this,n[4]),this.g=tn(n[5]||"",!0),Ye(this,n[6]||"",!0),this.i=tn(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function We(t){return new He(t)}function $e(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?tn(e,!0):e}function Xe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ye(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,un)),t.b=new hn(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Ze(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",en(n,an)),t.join("")};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,un=/[#\?@]/g,an=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){cn(t),e=dn(t,e),Ge(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ge((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function ln(t,e){return cn(t),e=dn(t,e),Ge(t.a.b,e)}function pn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),z(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=N.PerformanceNavigationTiming?0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(N.ca&&N.ca.ua&&N.ca.ua()&&N.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=hn.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){cn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){cn(this);var e=[];if("string"==typeof t)ln(this,t)&&(e=B(e,this.a.get(dn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return cn(this),this.c=null,ln(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=10;function mn(t){return t.b||t.a&&t.a.size>=t.f}function wn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function En(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=E(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function An(){this.a=new _n}function Nn(t,r,e){var i=e||"";try{qe(t,function(t,e){var n=t;P(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=E(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var Dn=N.JSON.parse;function xn(t){qt.call(this),this.headers=new Be,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Pn,this.B=this.F=!1}M(xn,qt);var Pn="",On=/^https?$/i,kn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Rn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Un(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Vn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=jn(t)||2!=t.S()))if(t.l&&4==jn(t))ne(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(Qe)[1]||null)&&N.self&&N.self.location&&(i=(r=N.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Cn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=qn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=qn("baseRetryDelayMs",5e3,t),this.Ga=qn("retryDelaySeedMs",1e4,t),this.Da=qn("forwardChannelMaxRetries",2,t),this.ga=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new vn(t&&t.concurrentRequestLimit),this.ja=new An,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function zn(t){var e,n;Gn(t),3==t.u&&(e=t.H++,Je(n=We(t.v),"SID",t.B),Je(n,"RID",e),Je(n,"TYPE","terminate"),$n(t,n),(e=new De(t,e,void 0)).B=2,e.f=Ze(We(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.f.toString(),"")),!n&&N.Image&&((new Image).src=e.f,n=!0),n||(e.a=ir(e.g,null),e.a.$(e.f)),e.s=U(),Ce(e)),nr(t)}function Gn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(N.clearTimeout(t.i),t.i=null),Jn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&N.clearTimeout(t.g),t.g=null)}function Qn(t,e){t.f.push(new yn(t.Fa++,e)),3==t.u&&Hn(t)}function Hn(t){mn(t.b)||t.g||(t.g=!0,Xt(t.xa,t),t.o=0)}function Wn(t,e){var n=e?e.W:t.H++,r=We(t.v);Je(r,"SID",t.B),Je(r,"RID",n),Je(r,"AID",t.G),$n(t,r),t.h&&t.j&&Fn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),ke(n,r,e)}function $n(t,n){t.c&&qe({},function(t,e){Je(n,e,t)})}function Kn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Nn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Xn(t){t.a||t.i||(t.J=1,Xt(t.wa,t),t.m=0)}function Yn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=ge(C(t.wa,t),tr(t,t.m)),t.m++,1)}function Jn(t){null!=t.l&&(N.clearTimeout(t.l),t.l=null)}function Zn(t,e){var n,r=null;if(t.a==e){Jn(t),t.a=null;var i=2}else{if(!bn(t.b,e))return;r=e.i,En(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=U()-e.s,n=t.o,(i=fe()).dispatchEvent(new ve(i)),Hn(t)):Xn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(wn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=ge(C(t.xa,t,e),tr(t,t.o)),t.o++,1}}(t,e)||2==i&&Yn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function er(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=C(t.Ta,t),n||(n=new He("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||$e(n,"https"),Ze(n)),i=n.toString(),o=r,u=new he,N.Image?((s=new Image).onload=V(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=V(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=V(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=V(Sn,u,s,"TestLoadImage: timeout",!1,o),N.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ye(),t.u=0,t.c&&t.c.la(e),nr(t),Gn(t)}function nr(t){t.u=0,t.A=-1,t.c&&(0==Tn(t.b).length&&0==t.f.length||(t.b.c.length=0,z(t.f),t.f.length=0),t.c.ka())}function rr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof He?We(r):new He(r,void 0);return""!=c.c?(e&&Ke(c,e+"."+c.c),Xe(c,c.h)):(o=(i=N.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new He(null,void 0),o&&$e(h,o),s&&Ke(h,s),u&&Xe(h,u),a&&(h.g=a),c=h),t.N&&Y(t.N,function(t,e){Je(c,e,t)}),e=t.s,n=t.ha,e&&n&&Je(c,e,n),Je(c,"VER",t.oa),$n(t,c),c}function ir(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ea)).F=t.w,e}function or(){}function sr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function ur(t,e){qt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ne.call(this),this.status=1}function cr(t){this.a=t}(T=xn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Te),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Rn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=N.FormData&&t instanceof N.FormData,0<=F(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ne(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Rn(this,t)}},T.ta=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),xn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Vn(this):this.Oa())},T.Oa=function(){Vn(this)},T.S=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Bn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=J(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),Je(i=We(this.v),"RID",t),Je(i,"CVER",22),this.s&&Je(i,"X-HTTP-Session-Id",this.s),$n(this,i),this.h&&r&&Fn(i,this.h,r),In(this.b,n),this.fa?(Je(i,"$req",e),Je(i,"SID","null"),n.R=!0,ke(n,i,null)):ke(n,i,e),this.u=2}}else 3==this.u&&(t?Wn(this,t):0==this.f.length||mn(this.b)||Wn(this))},T.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=We(this.ea);Je(t,"RID","rpc"),Je(t,"SID",this.B),Je(t,"CI",this.U?"0":"1"),Je(t,"AID",this.G),$n(this,t),Je(t,"TYPE","xmlhttp"),this.h&&this.j&&Fn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Ze(We(t)),e.j=null,e.F=!0,Le(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Yn(this),ye())},T.Ta=function(t){ye()},(T=or.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,qt),(T=ur.prototype).addEventListener=function(t,e,n,r){ur.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){ur.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(),t.P=e,t.N=n||{},t.U=t.W,t.v=rr(t,null,t.P),Hn(t)},T.close=function(){zn(this.a)},T.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=zt(t),Qn(this.a,e)):Qn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,zn(this.a),delete this.a,ur.M.C.call(this)},M(ar,Ae),M(hr,Ne),M(cr,or),cr.prototype.na=function(){this.a.dispatchEvent("a")},cr.prototype.ma=function(t){this.a.dispatchEvent(new ar(t))},cr.prototype.la=function(t){this.a.dispatchEvent(new hr)},cr.prototype.ka=function(){this.a.dispatchEvent("b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.La,ur.prototype.open=ur.prototype.Ka,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ee.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",qt.prototype.listen=qt.prototype.ra,xn.prototype.listenOnce=xn.prototype.sa,xn.prototype.getLastError=xn.prototype.Ma,xn.prototype.getLastErrorCode=xn.prototype.qa,xn.prototype.getStatus=xn.prototype.S,xn.prototype.getResponseJson=xn.prototype.Ja,xn.prototype.getResponseText=xn.prototype.Y,xn.prototype.send=xn.prototype.$;var fr={createWebChannelTransport:function(){return new sr},ErrorCode:me,EventType:we,WebChannel:Ee,XhrIo:xn},lr=fr.createWebChannelTransport,pr=fr.ErrorCode,dr=fr.EventType,yr=fr.WebChannel,vr=fr.XhrIo,gr=(mr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},mr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},mr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},mr);function mr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var wr=gd.SDK_VERSION,br=new h("@firebase/firestore");function Ir(){return br.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.DEBUG&&(e=n.map(_r),br.debug.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.ERROR&&(e=n.map(_r),br.error.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function _r(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ar(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function Nr(t){t||Ar()}function Sr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Dr=(xr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Sr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},xr);function xr(){}function Pr(t,e){return t<e?-1:e<t?1:0}function Or(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function kr(t){return t+"\0"}function Lr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Rr=(Object.defineProperty(Cr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Cr.prototype.isEqual=function(t){return t instanceof Cr&&t.projectId===this.projectId&&t.database===this.database},Cr.prototype.o=function(t){return Pr(this.projectId,t.projectId)||Pr(this.database,t.database)},Cr);function Cr(t,e){this.projectId=t,this.database=e||"(default)"}function Vr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var jr,Fr,qr,Br=(oi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},oi.prototype.has=function(t){return void 0!==this.get(t)},oi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},oi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},oi.prototype.forEach=function(u){Ur(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},oi.prototype._=function(){return Mr(this.l)},oi),zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(ii,qr=Error),ii),Qr=(ri.now=function(){return ri.fromMillis(Date.now())},ri.fromDate=function(t){return ri.fromMillis(t.getTime())},ri.fromMillis=function(t){var e=Math.floor(t/1e3);return new ri(e,1e6*(t-1e3*e))},ri.prototype.toDate=function(){return new Date(this.toMillis())},ri.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ri.prototype.T=function(t){return this.seconds===t.seconds?Pr(this.nanoseconds,t.nanoseconds):Pr(this.seconds,t.seconds)},ri.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ri.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ri.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ri),Hr=(ni.I=function(t){return new ni(t)},ni.min=function(){return new ni(new Qr(0,0))},ni.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ni.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ni.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ni.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ni.prototype.A=function(){return this.timestamp},ni),Wr=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.P(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ei.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},ei.prototype.v=function(){return this.segments[this.offset]},ei.prototype.S=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype._=function(){return 0===this.length},ei.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ei.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),$r=(n(ti,Fr=Wr),ti.prototype.V=function(t,e,n){return new ti(t,e,n)},ti.prototype.N=function(){return this.F().join("/")},ti.prototype.toString=function(){return this.N()},ti.$=function(t){if(0<=t.indexOf("//"))throw new Gr(zr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ti(t.split("/").filter(function(t){return 0<t.length}))},ti.k=function(){return new ti([])},ti),Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xr=(n(Zr,jr=Wr),Zr.prototype.V=function(t,e,n){return new Zr(t,e,n)},Zr.M=function(t){return Kr.test(t)},Zr.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Zr.M(t)||(t="`"+t+"`"),t}).join(".")},Zr.prototype.toString=function(){return this.N()},Zr.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},Zr.L=function(){return new Zr(["__name__"])},Zr.B=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Zr(e)},Zr.k=function(){return new Zr([])},Zr),Yr=(Jr.q=function(t){return new Jr($r.$(t).g(5))},Jr.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Jr.prototype.isEqual=function(t){return null!==t&&0===$r.P(this.path,t.path)},Jr.prototype.toString=function(){return this.path.toString()},Jr.P=function(t,e){return $r.P(t.path,e.path)},Jr.W=function(t){return t.length%2==0},Jr.j=function(t){return new Jr(new $r(t.slice()))},Jr);function Jr(t){this.path=t}function Zr(){return null!==jr&&jr.apply(this,arguments)||this}function ti(){return null!==Fr&&Fr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&Ar(),void 0===n?n=t.length-e:n>t.length-e&&Ar(),this.segments=t,this.offset=e,this.R=n}function ni(t){this.timestamp=t}function ri(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ii(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function oi(t,e){this.h=t,this.u=e,this.l={}}function si(t){return null==t}function ui(t){return-0===t&&1/t==-1/0}function ai(t){return"number"==typeof t&&Number.isInteger(t)&&!ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function hi(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null}function ci(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new hi(t,e,n,r,i,o,s)}function fi(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+po(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),si(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Pu(n.startAt)),n.endAt&&(e+="|ub:",e+=Pu(n.endAt)),n.K=e),n.K}function li(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i,o,s=0;s<t.orderBy.length;s++)if(n=t.orderBy[s],r=e.orderBy[s],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(i=t.filters[u],o=e.filters[u],!(i instanceof lu&&o instanceof lu&&i.op===o.op&&i.field.isEqual(o.field)&&ho(i.value,o.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ku(t.startAt,e.startAt)&&ku(t.endAt,e.endAt)}function pi(t){return Yr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var di=(yi.fromBase64String=function(t){return new yi(atob(t))},yi.fromUint8Array=function(t){return new yi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},yi.prototype.toBase64=function(){return t=this.G,btoa(t);var t},yi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},yi.prototype.H=function(){return 2*this.G.length},yi.prototype.o=function(t){return Pr(this.G,t.G)},yi.prototype.isEqual=function(t){return this.G===t.G},yi);function yi(t){this.G=t}function vi(t){this.count=t}di.Y=new di("");var gi,mi,wi=(bi.prototype.Z=function(t){return new bi(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bi.prototype.tt=function(t,e){return new bi(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bi.prototype.et=function(t){return new bi(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},bi);function bi(t,e,n,r,i,o,s){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===s&&(s=di.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ii(t){switch(t){case zr.OK:return Ar();case zr.CANCELLED:case zr.UNKNOWN:case zr.DEADLINE_EXCEEDED:case zr.RESOURCE_EXHAUSTED:case zr.INTERNAL:case zr.UNAVAILABLE:case zr.UNAUTHENTICATED:return;case zr.INVALID_ARGUMENT:case zr.NOT_FOUND:case zr.ALREADY_EXISTS:case zr.PERMISSION_DENIED:case zr.FAILED_PRECONDITION:case zr.ABORTED:case zr.OUT_OF_RANGE:case zr.UNIMPLEMENTED:case zr.DATA_LOSS:return 1;default:return Ar()}}function Ei(t){if(void 0===t)return Tr("GRPC error has no .code"),zr.UNKNOWN;switch(t){case gi.OK:return zr.OK;case gi.CANCELLED:return zr.CANCELLED;case gi.UNKNOWN:return zr.UNKNOWN;case gi.DEADLINE_EXCEEDED:return zr.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return zr.RESOURCE_EXHAUSTED;case gi.INTERNAL:return zr.INTERNAL;case gi.UNAVAILABLE:return zr.UNAVAILABLE;case gi.UNAUTHENTICATED:return zr.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return zr.INVALID_ARGUMENT;case gi.NOT_FOUND:return zr.NOT_FOUND;case gi.ALREADY_EXISTS:return zr.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return zr.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return zr.FAILED_PRECONDITION;case gi.ABORTED:return zr.ABORTED;case gi.OUT_OF_RANGE:return zr.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return zr.UNIMPLEMENTED;case gi.DATA_LOSS:return zr.DATA_LOSS;default:return Ar()}}(mi=gi=gi||{})[mi.OK=0]="OK",mi[mi.CANCELLED=1]="CANCELLED",mi[mi.UNKNOWN=2]="UNKNOWN",mi[mi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mi[mi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mi[mi.NOT_FOUND=5]="NOT_FOUND",mi[mi.ALREADY_EXISTS=6]="ALREADY_EXISTS",mi[mi.PERMISSION_DENIED=7]="PERMISSION_DENIED",mi[mi.UNAUTHENTICATED=16]="UNAUTHENTICATED",mi[mi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mi[mi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mi[mi.ABORTED=10]="ABORTED",mi[mi.OUT_OF_RANGE=11]="OUT_OF_RANGE",mi[mi.UNIMPLEMENTED=12]="UNIMPLEMENTED",mi[mi.INTERNAL=13]="INTERNAL",mi[mi.UNAVAILABLE=14]="UNAVAILABLE",mi[mi.DATA_LOSS=15]="DATA_LOSS";var Ti=(Di.prototype.nt=function(t,e){return new Di(this.P,this.root.nt(t,e,this.P).copy(null,null,Ai.st,null,null))},Di.prototype.remove=function(t){return new Di(this.P,this.root.remove(t,this.P).copy(null,null,Ai.st,null,null))},Di.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Di.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Di.prototype._=function(){return this.root._()},Object.defineProperty(Di.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Di.prototype.it=function(){return this.root.it()},Di.prototype.rt=function(){return this.root.rt()},Di.prototype.ot=function(t){return this.root.ot(t)},Di.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Di.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Di.prototype.ht=function(t){return this.root.ht(t)},Di.prototype.at=function(){return new _i(this.root,null,this.P,!1)},Di.prototype.ut=function(t){return new _i(this.root,t,this.P,!1)},Di.prototype.ct=function(){return new _i(this.root,null,this.P,!0)},Di.prototype.lt=function(t){return new _i(this.root,t,this.P,!0)},Di),_i=(Si.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Si.prototype.wt=function(){return 0<this.ft.length},Si.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Si),Ai=(Ni.prototype.copy=function(t,e,n,r,i){return new Ni(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ni.prototype._=function(){return!1},Ni.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ni.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ni.prototype.min=function(){return this.left._()?this:this.left.min()},Ni.prototype.it=function(){return this.min().key},Ni.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ni.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ni.prototype.It=function(){if(this.left._())return Ni.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ni.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ni.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ni.prototype.At=function(){return this.color},Ni.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Ni.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).gt()).yt()),t},Ni.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Ni.prototype.gt=function(){var t=this.copy(null,null,Ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ni.prototype.Pt=function(){var t=this.copy(null,null,Ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ni.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ni.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ni.prototype.bt=function(){if(this.At()&&this.left.At())throw Ar();if(this.right.At())throw Ar();var t=this.left.bt();if(t!==this.right.bt())throw Ar();return t+(this.At()?0:1)},Ni);function Ni(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ni.RED,this.left=null!=r?r:Ni.EMPTY,this.right=null!=i?i:Ni.EMPTY,this.size=this.left.size+1+this.right.size}function Si(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Di(t,e){this.P=t,this.root=e||Ai.EMPTY}function xi(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.st=!1,Ai.EMPTY=(Object.defineProperty(xi.prototype,"key",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"value",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"color",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"left",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"right",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),xi.prototype.copy=function(t,e,n,r,i){return this},xi.prototype.nt=function(t,e,n){return new Ai(t,e)},xi.prototype.remove=function(t,e){return this},xi.prototype._=function(){return!0},xi.prototype.ot=function(t){return!1},xi.prototype.ht=function(t){return!1},xi.prototype.it=function(){return null},xi.prototype.rt=function(){return null},xi.prototype.At=function(){return!1},xi.prototype.pt=function(){return!0},xi.prototype.bt=function(){return 0},new xi);var Pi=(Ri.prototype.has=function(t){return null!==this.data.get(t)},Ri.prototype.first=function(){return this.data.it()},Ri.prototype.last=function(){return this.data.rt()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ri.prototype.indexOf=function(t){return this.data.indexOf(t)},Ri.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Ri.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Ri.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Ri.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Ri.prototype.at=function(){return new Oi(this.data.at())},Ri.prototype.ut=function(t){return new Oi(this.data.ut(t))},Ri.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Ri.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ri.prototype._=function(){return this.data._()},Ri.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ri.prototype.isEqual=function(t){if(!(t instanceof Ri))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Ri.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ri.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ri.prototype.copy=function(t){var e=new Ri(this.P);return e.data=t,e},Ri),Oi=(Li.prototype.dt=function(){return this.Ft.dt().key},Li.prototype.wt=function(){return this.Ft.wt()},Li),ki=new Ti(Yr.P);function Li(t){this.Ft=t}function Ri(t){this.P=t,this.data=new Ti(this.P)}var Ci=new Ti(Yr.P);var Vi=new Ti(Yr.P),Ui=new Pi(Yr.P);function Mi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ui,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ji=new Pi(Pr);function Fi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function qi(t,e){this.targetId=t,this.ee=e}function Bi(t,e,n,r){void 0===n&&(n=di.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var zi=(no.kt=function(t){return new no(t.P)},no.prototype.has=function(t){return null!=this.Nt.get(t)},no.prototype.get=function(t){return this.Nt.get(t)},no.prototype.first=function(){return this.$t.it()},no.prototype.last=function(){return this.$t.rt()},no.prototype._=function(){return this.$t._()},no.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(no.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),no.prototype.forEach=function(n){this.$t.ot(function(t,e){return n(t),!1})},no.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.$t.nt(t,null))},no.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.$t.remove(e)):this},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.at(),n=t.$t.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},no.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},no.prototype.copy=function(t,e){var n=new no;return n.P=this.P,n.Nt=t,n.$t=e,n},no),Gi=(eo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Ar()},eo.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},eo),Qi=(to.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new to(t,e,zi.kt(e),i,n,r,!0,!1)},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.Lt.isEqual(t.Lt)&&su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},to),Hi=(Zi.Gt=function(t,e){var n=new Map;return n.set(t,Wi.zt(t,e)),new Zi(Hr.min(),n,ji,ki,Mi())},Zi),Wi=(Ji.zt=function(t,e){return new Ji(di.Y,e,Mi(),Mi(),Mi())},Ji),$i=(Object.defineProperty(Yi.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Yi.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},Yi.prototype.ce=function(){var n=Mi(),r=Mi(),i=Mi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ar()}}),new Wi(this.ie,this.re,n,r,i)},Yi.prototype.le=function(){this.oe=!1,this.se=io()},Yi.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},Yi.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},Yi.prototype.de=function(){this.ne+=1},Yi.prototype.we=function(){--this.ne},Yi.prototype.Te=function(){this.oe=!0,this.re=!0},Yi),Ki=(Xi.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Js?this.Ve(r,t.te):t.te instanceof Zs&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},Xi.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Ar()}})},Xi.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},Xi.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(pi(e=o.target)?0===i?(n=new Yr(e.path),this.ge(r,n,new Zs(n,Hr.min()))):Nr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},Xi.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&pi(r.target)&&(n=new Yr(r.target.path),null!==o.me.get(n)||o.$e(e,n)||o.ge(e,n,new Zs(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Mi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Hi(i,s,this.Re,this.me,r);return this.me=ki,this.Ae=ro(),this.Re=new Pi(Pr),t},Xi.prototype.Ve=function(t,e){var n;this.ve(t)&&(n=this.$e(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t)))},Xi.prototype.ge=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.$e(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},Xi.prototype.removeTarget=function(t){this.Ie.delete(t)},Xi.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},Xi.prototype.de=function(t){this.be(t).de()},Xi.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new $i,this.Ie.set(t,e)),e},Xi.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Pi(Pr),this.Ae=this.Ae.nt(t,e)),e},Xi.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},Xi.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},Xi.prototype.Se=function(e){var n=this;this.Ie.set(e,new $i),this.Ee.xe(e).forEach(function(t){n.ge(e,t,null)})},Xi.prototype.$e=function(t,e){return this.Ee.xe(t).has(e)},Xi);function Xi(t){this.Ee=t,this.Ie=new Map,this.me=ki,this.Ae=ro(),this.Re=new Pi(Pr)}function Yi(){this.ne=0,this.se=io(),this.ie=di.Y,this.re=!1,this.oe=!0}function Ji(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function Zi(t,e,n,r,i){this.X=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function to(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.Bt=s,this.qt=u}function eo(){this.xt=new Ti(Yr.P)}function no(n){this.P=n?function(t,e){return n(t,e)||Yr.P(t.key,e.key)}:function(t,e){return Yr.P(t.key,e.key)},this.Nt=Ci,this.$t=new Ti(this.P)}function ro(){return new Ti(Yr.P)}function io(){return new Ti(Yr.P)}function oo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function so(t){var e=yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Qr(e.seconds,e.nanos)}var uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oo(t)?4:10:Ar()}function ho(r,i){var t,e,n,o=ao(r);if(o!==ao(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return so(r).isEqual(so(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=yo(r.timestampValue),n=yo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,go(r.bytesValue).isEqual(go(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,vo((t=r).geoPointValue.latitude)===vo(e.geoPointValue.latitude)&&vo(t.geoPointValue.longitude)===vo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vo(t.integerValue)===vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=vo(t.doubleValue),r=vo(e.doubleValue);return n===r?ui(n)===ui(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Or(r.arrayValue.values||[],i.arrayValue.values||[],ho);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Vr(t)!==Vr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!ho(t[n],e[n])))return!1;return!0}();default:return Ar()}}function co(t,e){return void 0!==(t.values||[]).find(function(t){return ho(t,e)})}function fo(t,e){var n,r,i,o,s,u,a,h,c,f,l=ao(t),p=ao(e);if(l!==p)return Pr(l,p);switch(l){case 0:return 0;case 1:return Pr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=vo(t.integerValue||t.doubleValue))<(f=vo(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return lo(t.timestampValue,e.timestampValue);case 4:return lo(so(t),so(e));case 5:return Pr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=go(o),a=go(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Pr(n[i],r[i]);if(0!==o)return o}return Pr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Pr(vo(n.latitude),vo(r.latitude)))?i:Pr(vo(n.longitude),vo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=fo(n[i],r[i]);if(o)return o}return Pr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Pr(r[s],o[s]);if(0!==u)return u;var a=fo(n[r[s]],i[o[s]]);if(0!==a)return a}return Pr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ar()}}function lo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Pr(t,e);var n=yo(t),r=yo(e),i=Pr(n.seconds,r.seconds);return 0!==i?i:Pr(n.nanos,r.nanos)}function po(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=yo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?go(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Yr.q(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Ar();var t,e,n}(t)}function yo(t){if(Nr(!!t),"string"!=typeof t)return{seconds:vo(t.seconds),nanos:vo(t.nanos)};var e,n=0,r=uo.exec(t);Nr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function go(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function mo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function wo(t){return t&&"integerValue"in t}function bo(t){return!!t&&"arrayValue"in t}function Io(t){return t&&"nullValue"in t}function Eo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function To(t){return t&&"mapValue"in t}var _o={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},No=function(t,e){this.s=t,this.Oe=e};function So(t){return{integerValue:""+t}}function Do(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function xo(t,e){return ai(e)?So(e):Do(t,e)}function Po(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Oo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function ko(t){return Nr(!!t),Hr.I((e=yo(t),new Qr(e.seconds,e.nanos)));var e}function Lo(t,e){return new $r(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Ro(t){var e=$r.$(t);return Nr(Xo(e)),e}function Co(t,e){return Lo(t.s,e.path)}function Vo(t,e){var n=Ro(e);return Nr(n.get(1)===t.s.projectId),Nr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new Yr(Fo(n))}function Uo(t,e){return Lo(t.s,e)}function Mo(t){var e=Ro(t);return 4===e.length?$r.k():Fo(e)}function jo(t){return new $r(["projects",t.s.projectId,"databases",t.s.database]).N()}function Fo(t){return Nr(4<t.length&&"documents"===t.get(4)),t.g(5)}function qo(t,e,n){return{name:Co(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n,r,i,o;if(e instanceof Ds)n={update:qo(t,e.key,e.value)};else if(e instanceof js)n={delete:Co(t,e.key)};else if(e instanceof xs)n={update:qo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof Rs)n={transform:{document:Co(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof es)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof ns)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof fs)return{fieldPath:t.field.N(),increment:e.Be};throw Ar()})}};else{if(!(e instanceof Fs))return Ar();n={verify:Co(t,e.key)}}return e.Ue.qe||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Po(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Ar()),n}function zo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?ws.updateTime(ko(n.updateTime)):void 0!==n.exists?ws.exists(n.exists):ws.Qe():ws.Qe();if(t.update){t.update.name;var o=Vo(e,t.update.name),s=new qs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new ys(r.map(function(t){return Xr.B(t)})));return new xs(o,s,u,i)}return new Ds(o,s,i)}if(t.delete){var a=Vo(e,t.delete);return new js(a,i)}if(t.transform){var h=Vo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Nr("REQUEST_TIME"===e.setToServerValue),i=new es):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new ns(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new us(r)):"increment"in e?i=new fs(t,e.increment):Ar();var o=Xr.B(e.fieldPath);return new vs(o,i)}(e,t)});return Nr(!0===i.exists),new Rs(h,c)}if(t.verify){var f=Vo(e,t.verify);return new Fs(f,i)}return Ar()}function Go(t,e){return{documents:[Uo(t,e.path)]}}function Qo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof lu?function(t){if("=="===t.op){if(Eo(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NAN"}};if(Io(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:$o(t.field),op:(e=t.op,Ao[e]),value:t.value}};var e}(t):Ar()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:$o((e=t).field),direction:(n=e.dir,_o[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||si(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ho(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ho(e.endAt)),n}function Ho(t){return{before:t.before,values:t.position}}function Wo(t){var e=!!t.before,n=t.values||[];return new _u(n,e)}function $o(t){return{fieldPath:t.N()}}function Ko(t){return Xr.B(t.fieldPath)}function Xo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Yo(){this.je=void 0}function Jo(t,e){return t instanceof fs?wo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Zo,ts,es=(n(is,ts=Yo),is),ns=(n(rs,Zo=Yo),rs);function rs(t){var e=this;return(e=Zo.call(this)||this).elements=t,e}function is(){return null!==ts&&ts.apply(this,arguments)||this}function os(t,e){for(var n=ds(e),r=function(e){n.some(function(t){return ho(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ss,us=(n(as,ss=Yo),as);function as(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function hs(t,e){for(var n=ds(e),r=function(e){n=n.filter(function(t){return!ho(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cs,fs=(n(ls,cs=Yo),ls);function ls(t,e){var n=this;return(n=cs.call(this)||this).serializer=t,n.Be=e,n}function ps(t){return vo(t.integerValue||t.doubleValue)}function ds(t){return bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ys=(gs.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},gs.prototype.isEqual=function(t){return Or(this.fields,t.fields,function(t,e){return t.isEqual(e)})},gs),vs=function(t,e){this.field=t,this.transform=e};function gs(t){(this.fields=t).sort(Xr.P)}function ms(t,e){this.version=t,this.transformResults=e}var ws=(bs.Qe=function(){return new bs},bs.exists=function(t){return new bs(void 0,t)},bs.updateTime=function(t){return new bs(t)},Object.defineProperty(bs.prototype,"qe",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},bs);function bs(t,e){this.updateTime=t,this.exists=e}function Is(t,e){return void 0!==t.updateTime?e instanceof Js&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Js}function Es(){}function Ts(t,e,n,r){return t instanceof Ds?function(t,e){if(!Is(t.Ue,e))return e;var n=As(e);return new Js(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof xs?function(t,e){if(!Is(t.Ue,e))return e;var n=As(e),r=ks(t,e);return new Js(t.key,n,r,{Ge:!0})}(t,e):t instanceof Rs?function(t,e,n,r){if(!Is(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof Js&&(y=n.field(p.field)),null===y&&r instanceof Js&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof es?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof ns?os(i,o):i instanceof us?hs(i,o):(a=ps(u=Jo(s=i,o))+ps(s.Be),wo(u)&&wo(s.Be)?So(a):Do(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Vs(t,i.data(),o);return new Js(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Is((i=t).Ue,o)?new Zs(i.key,Hr.min()):o);var i,o}function _s(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Or(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ns&&o instanceof ns||i instanceof us&&o instanceof us?Or(i.elements,o.elements,ho):i instanceof fs&&o instanceof fs?ho(i.Be,o.Be):i instanceof es&&o instanceof es);var n,r,i,o}))}function As(t){return t instanceof Js?t.version:Hr.min()}var Ns,Ss,Ds=(n(Os,Ss=Es),Os),xs=(n(Ps,Ns=Es),Ps);function Ps(t,e,n,r){var i=this;return(i=Ns.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Os(t,e,n){var r=this;return(r=Ss.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function ks(t,e){return n=t,r=e instanceof Js?e.data():qs.empty(),i=new Bs(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Ls,Rs=(n(Cs,Ls=Es),Cs);function Cs(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=ws.exists(!0),n}function Vs(t,e,n){for(var r=new Bs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Us,Ms,js=(n(Hs,Ms=Es),Hs),Fs=(n(Qs,Us=Es),Qs),qs=(Gs.empty=function(){return new Gs({mapValue:{}})},Gs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!To(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Gs.prototype.isEqual=function(t){return ho(this.proto,t.proto)},Gs),Bs=(zs.prototype.set=function(t,e){return this.Je(t,e),this},zs.prototype.delete=function(t){return this.Je(t,null),this},zs.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ao(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},zs.prototype.ze=function(){var t=this.Xe(Xr.k(),this.Ye);return null!=t?new qs(t):this.He},zs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=To(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},zs);function zs(t){void 0===t&&(t=qs.empty()),this.He=t,this.Ye=new Map}function Gs(t){this.proto=t}function Qs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Hs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Ws(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new Xr([t]);if(To(e)){var r=Ws(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new ys(u)}function $s(t,e){this.key=t,this.version=e}var Ks,Xs,Ys,Js=(n(ou,Ys=$s),ou.prototype.field=function(t){return this.Ze.field(t)},ou.prototype.data=function(){return this.Ze},ou.prototype.tn=function(){return this.Ze.proto},ou.prototype.isEqual=function(t){return t instanceof ou&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},ou.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ou),Zs=(n(iu,Xs=$s),iu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),iu.prototype.isEqual=function(t){return t instanceof iu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},iu),tu=(n(ru,Ks=$s),ru.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ru.prototype.isEqual=function(t){return t instanceof ru&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ru),eu=(nu.hn=function(t){return new nu(t)},Object.defineProperty(nu.prototype,"orderBy",{get:function(){if(null===this.sn){this.sn=[];var t=this.an(),e=this.un();if(null!==t&&null===e)t.O()||this.sn.push(new Lu(t)),this.sn.push(new Lu(Xr.L(),"asc"));else{for(var n,r=!1,i=0,o=this.en;i<o.length;i++){var s=o[i];this.sn.push(s),s.field.O()&&(r=!0)}r||(n=0<this.en.length?this.en[this.en.length-1].dir:"asc",this.sn.push(new Lu(Xr.L(),n)))}}return this.sn},enumerable:!1,configurable:!0}),nu.prototype.cn=function(t){var e=this.filters.concat([t]);return new nu(this.path,this.collectionGroup,this.en.slice(),e,this.limit,this.nn,this.startAt,this.endAt)},nu.prototype.ln=function(t){var e=this.en.concat([t]);return new nu(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},nu.prototype._n=function(t){return new nu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},nu.prototype.fn=function(t){return new nu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},nu.prototype.dn=function(t){return new nu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),this.limit,this.nn,t,this.endAt)},nu.prototype.wn=function(t){return new nu(this.path,this.collectionGroup,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,t)},nu.prototype.Tn=function(t){return new nu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},nu.prototype.En=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.O())},nu.prototype.In=function(){return!si(this.limit)&&"F"===this.nn},nu.prototype.mn=function(){return!si(this.limit)&&"L"===this.nn},nu.prototype.un=function(){return 0<this.en.length?this.en[0].field:null},nu.prototype.an=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof lu&&n.An())return n.field}return null},nu.prototype.Rn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof lu&&0<=t.indexOf(r.op))return r.op}return null},nu.prototype.Pn=function(){return pi(this.We())},nu.prototype.Vn=function(){return null!==this.collectionGroup},nu.prototype.We=function(){if(!this.rn)if("F"===this.nn)this.rn=ci(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Lu(r.field,i))}var o=this.endAt?new _u(this.endAt.position,!this.endAt.before):null,s=this.startAt?new _u(this.startAt.position,!this.startAt.before):null;this.rn=ci(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.rn},nu.prototype.on=function(t){},nu);function nu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt&&this.on(this.startAt),this.endAt&&this.on(this.endAt)}function ru(){return null!==Ks&&Ks.apply(this,arguments)||this}function iu(t,e,n){var r=this;return(r=Xs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ou(t,e,n,r){var i=this;return(i=Ys.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function su(t,e){return li(t.We(),e.We())&&t.nn===e.nn}function uu(t){return fi(t.We())+"|lt:"+t.nn}function au(t){return"Query(target="+(n=(e=t.We()).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+po(e.value);var e}).join(", ")+"]"),si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Pu(e.startAt)),e.endAt&&(n+=", endAt: "+Pu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function hu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):Yr.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ou(e.startAt,e.orderBy,n))&&(!e.endAt||!Ou(e.endAt,e.orderBy,n)));var e,n,r,o}function cu(u){return function(t,e){for(var n=!1,r=0,i=u.orderBy;r<i.length;r++){var o=i[r],s=Ru(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var fu,lu=(n(pu,fu=function(){}),pu.create=function(t,e,n){if(t.O())return"in"===e?new bu(t,n):new wu(t,e,n);if(Io(n)){if("=="!==e)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new pu(t,e,n)}if(Eo(n)){if("=="!==e)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new pu(t,e,n)}return"array-contains"===e?new Iu(t,n):"in"===e?new Eu(t,n):"array-contains-any"===e?new Tu(t,n):new pu(t,e,n)},pu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ao(this.value)===ao(e)&&this.gn(fo(e,this.value))},pu.prototype.gn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Ar()}},pu.prototype.An=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},pu);function pu(t,e,n){var r=this;return(r=fu.call(this)||this).field=t,r.op=e,r.value=n,r}var du,yu,vu,gu,mu,wu=(n(xu,mu=lu),xu.prototype.matches=function(t){var e=Yr.P(t.key,this.key);return this.gn(e)},xu),bu=(n(Du,gu=lu),Du.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Du),Iu=(n(Su,vu=lu),Su.prototype.matches=function(t){var e=t.field(this.field);return bo(e)&&co(e.arrayValue,this.value)},Su),Eu=(n(Nu,yu=lu),Nu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&co(this.value.arrayValue,e)},Nu),Tu=(n(Au,du=lu),Au.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!bo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return co(e.value.arrayValue,t)})},Au),_u=function(t,e){this.position=t,this.before=e};function Au(t,e){return du.call(this,t,"array-contains-any",e)||this}function Nu(t,e){return yu.call(this,t,"in",e)||this}function Su(t,e){return vu.call(this,t,"array-contains",e)||this}function Du(t,e){var n=this;return(n=gu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Yr.q(t.referenceValue)}),n}function xu(t,e,n){var r=this;return(r=mu.call(this,t,e,n)||this).key=Yr.q(n.referenceValue),r}function Pu(t){return(t.before?"b":"a")+":"+t.position.map(po).join(",")}function Ou(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?Yr.P(Yr.q(s.referenceValue),n.key):fo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ku(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ho(t.position[n],e.position[n]))return!1;return!0}var Lu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ru(t,e,n){var r,i,o,s,u=t.field.O()?Yr.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?fo(o,s):Ar());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Ar()}}var Cu=(Yu.prototype.pn=function(t,e,n){for(var r,i,o,s=n.bn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Ds?new Js(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof xs?function(t,e,n){if(!Is(t.Ue,e))return new tu(t.key,n.version);var r=ks(t,e);return new Js(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Rs?function(t,e,n){if(Nr(null!=n.transformResults),!Is(t.Ue,e))return new tu(t.key,n.version);var r=e,i=function(t,e,n){var r,i,o,s=[];Nr(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Js&&(c=e.field(a.field)),s.push((r=h,i=c,o=n[u],r instanceof ns?os(r,i):r instanceof us?hs(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Vs(t,r.data(),i);return new Js(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Zs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Yu.prototype.vn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ts(i,e,e,this.yn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.yn))}return e},Yu.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.vn(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Yu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Mi())},Yu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Or(this.mutations,t.mutations,_s)&&Or(this.baseMutations,t.baseMutations,_s)},Yu),Vu=(Xu.from=function(t,e,n){Nr(t.mutations.length===n.length);for(var r=Vi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Xu(t,e,n,r)},Xu),Uu=(Ku.prototype.catch=function(t){return this.next(void 0,t)},Ku.prototype.next=function(r,i){var o=this;return this.kn&&Ar(),this.kn=!0,this.$n?this.error?this.xn(i,this.error):this.Mn(r,this.result):new Ku(function(e,n){o.Fn=function(t){o.Mn(r,t).next(e,n)},o.Nn=function(t){o.xn(i,t).next(e,n)}})},Ku.prototype.On=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ku.prototype.Ln=function(t){try{var e=t();return e instanceof Ku?e:Ku.resolve(e)}catch(t){return Ku.reject(t)}},Ku.prototype.Mn=function(t,e){return t?this.Ln(function(){return t(e)}):Ku.resolve(e)},Ku.prototype.xn=function(t,e){return t?this.Ln(function(){return t(e)}):Ku.reject(e)},Ku.resolve=function(n){return new Ku(function(t,e){t(n)})},Ku.reject=function(n){return new Ku(function(t,e){e(n)})},Ku.Bn=function(t){return new Ku(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ku.qn=function(t){for(var n=Ku.resolve(!1),e=function(e){n=n.next(function(t){return t?Ku.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},Ku.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Bn(i)},Ku),Mu=(Object.defineProperty($u.prototype,"readTime",{get:function(){return this.Wn},set:function(t){this.Wn=t},enumerable:!1,configurable:!0}),$u.prototype.jn=function(t,e){this.Kn(),this.readTime=e,this.Un.set(t.key,t)},$u.prototype.Gn=function(t,e){this.Kn(),e&&(this.readTime=e),this.Un.set(t,null)},$u.prototype.zn=function(t,e){this.Kn();var n=this.Un.get(e);return void 0!==n?Uu.resolve(n):this.Hn(t,e)},$u.prototype.getEntries=function(t,e){return this.Yn(t,e)},$u.prototype.apply=function(t){return this.Kn(),this.Qn=!0,this.Jn(t)},$u.prototype.Kn=function(){},$u),ju="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fu=(Wu.prototype.Zn=function(t){this.Xn.push(t)},Wu.prototype.ts=function(){this.Xn.forEach(function(t){return t()})},Wu),qu=(Hu.prototype.rs=function(e,n){var r=this;return this.ns.os(e,n).next(function(t){return r.hs(e,n,t)})},Hu.prototype.hs=function(t,r,i){return this.es.zn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].vn(r,t);return t})},Hu.prototype.as=function(t,e,i){var o=ki;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].vn(t,e);o=o.nt(t,e)}),o},Hu.prototype.us=function(e,t){var n=this;return this.es.getEntries(e,t).next(function(t){return n.cs(e,t)})},Hu.prototype.cs=function(r,i){var o=this;return this.ns.ls(r,i).next(function(t){var e=o.as(r,i,t),n=ki;return e.forEach(function(t,e){e=e||new Zs(t,Hr.min()),n=n.nt(t,e)}),n})},Hu.prototype._s=function(t,e,n){return e.Pn()?this.fs(t,e.path):e.Vn()?this.ds(t,e,n):this.ws(t,e,n)},Hu.prototype.fs=function(t,e){return this.rs(t,new Yr(e)).next(function(t){var e=Ci;return t instanceof Js&&(e=e.nt(t.key,t)),e})},Hu.prototype.ds=function(n,r,i){var o=this,s=r.collectionGroup,u=Ci;return this.ss.Ts(n,s).next(function(t){return Uu.forEach(t,function(t){var e=r.Tn(t.child(s));return o.ws(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Hu.prototype.ws=function(e,n,t){var c,f,r=this;return this.es._s(e,n,t).next(function(t){return c=t,r.ns.Es(e,n)}).next(function(t){return f=t,r.Is(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Ts(s,a,a,r.yn);c=h instanceof Js?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){hu(n,e)||(c=c.remove(t))}),c})},Hu.prototype.Is=function(t,e,n){for(var r=Mi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof xs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.es.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Js&&(h=h.nt(t,e))}),h})},Hu),Bu=(Qu.Rs=function(t,e){for(var n=Mi(),r=Mi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Qu(t,e.fromCache,n,r)},Qu),zu=(Gu.prototype.Vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Gu.prototype.next=function(){var t=++this.previousValue;return this.gs&&this.gs(t),t},Gu);function Gu(t,e){var n=this;this.previousValue=t,e&&(e.Ps=function(t){return n.Vs(t)},this.gs=function(t){return e.ys(t)})}function Qu(t,e,n,r){this.targetId=t,this.fromCache=e,this.ms=n,this.As=r}function Hu(t,e,n){this.es=t,this.ns=e,this.ss=n}function Wu(){this.Xn=[]}function $u(){this.Un=new Br(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Qn=!1}function Ku(t){var e=this;this.Fn=null,this.Nn=null,this.result=void 0,this.error=void 0,this.$n=!1,this.kn=!1,t(function(t){e.$n=!0,e.result=t,e.Fn&&e.Fn(t)},function(t){e.$n=!0,e.error=t,e.Nn&&e.Nn(t)})}function Xu(t,e,n,r){this.batch=t,this.Dn=e,this.bn=n,this.Cn=r}function Yu(t,e,n,r){this.batchId=t,this.yn=e,this.baseMutations=n,this.mutations=r}function Ju(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}zu.ps=-1;var Zu=(ta.prototype.reset=function(){this.Fs=0},ta.prototype.ks=function(){this.Fs=this.Cs},ta.prototype.xs=function(t){var e=this;this.cancel();var n=Math.floor(this.Fs+this.Ms()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ns=this.bs.Os(this.vs,i,function(){return e.$s=Date.now(),t()}),this.Fs*=this.Ds,this.Fs<this.Ss&&(this.Fs=this.Ss),this.Fs>this.Cs&&(this.Fs=this.Cs)},ta.prototype.Ls=function(){null!==this.Ns&&(this.Ns.Bs(),this.Ns=null)},ta.prototype.cancel=function(){null!==this.Ns&&(this.Ns.cancel(),this.Ns=null)},ta.prototype.Ms=function(){return(Math.random()-.5)*this.Fs},ta);function ta(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.bs=t,this.vs=e,this.Ss=n,this.Ds=r,this.Cs=i,this.Fs=0,this.Ns=null,this.$s=Date.now(),this.reset()}function ea(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ra(e)),e=na(t.get(n),e);return ra(e)}function na(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ra(t){return t+""}function ia(t){var e=t.length;if(Nr(2<=e),2===e)return Nr(""===t.charAt(0)&&""===t.charAt(1)),$r.k();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Ar(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ar()}o=s+2}return new $r(r)}var oa=(ca.prototype.Us=function(t,e){return this.qs.add(e),Uu.resolve()},ca.prototype.Ts=function(t,e){return Uu.resolve(this.qs.getEntries(e))},ca),sa=(ha.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Pi($r.P),i=!r.has(n);return this.index[e]=r.add(n),i},ha.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},ha.prototype.getEntries=function(t){return(this.index[t]||new Pi($r.P)).F()},ha),ua=(aa.prototype.Us=function(t,e){var n=this;if(this.Qs.has(e))return Uu.resolve();var r=e.S(),i=e.p();t.Zn(function(){n.Qs.add(e)});var o={collectionId:r,parent:ea(i)};return fa(t).put(o)},aa.prototype.Ts=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[kr(i),""],!1,!0);return fa(t).Ws(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ia(r.parent))}return o})},aa);function aa(){this.Qs=new sa}function ha(){this.index={}}function ca(){this.qs=new sa}function fa(t){return Fa.js(t,mh.store)}function la(t){this.Ks=t}function pa(t,e){if(e.document)return n=t.Ks,r=e.document,i=!!e.hasCommittedMutations,o=Vo(n,r.name),s=ko(r.updateTime),u=new qs({mapValue:{fields:r.fields}}),new Js(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=Yr.j(e.noDocument.path),h=ma(e.noDocument.readTime);return new Zs(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=Yr.j(e.unknownDocument.path),f=ma(e.unknownDocument.version);return new tu(c,f)}return Ar()}function da(t,e,n){var r,i,o=ya(n),s=e.key.path.p().F();if(e instanceof Js){var u={name:Co(r=t.Ks,(i=e).key),fields:i.tn().mapValue.fields,updateTime:Po(r,i.version.A())},a=e.hasCommittedMutations;return new ph(null,null,u,a,o,s)}if(e instanceof Zs){var h=e.key.path.F(),c=ga(e.version),f=e.hasCommittedMutations;return new ph(null,new fh(h,c),null,f,o,s)}if(e instanceof tu){var l=e.key.path.F(),p=ga(e.version);return new ph(new lh(l,p),null,null,!0,o,s)}return Ar()}function ya(t){var e=t.A();return[e.seconds,e.nanoseconds]}function va(t){var e=new Qr(t[0],t[1]);return Hr.I(e)}function ga(t){var e=t.A();return new ih(e.seconds,e.nanoseconds)}function ma(t){var e=new Qr(t.seconds,t.nanoseconds);return Hr.I(e)}function wa(e,t){var n=(t.baseMutations||[]).map(function(t){return zo(e.Ks,t)}),r=t.mutations.map(function(t){return zo(e.Ks,t)}),i=Qr.fromMillis(t.localWriteTimeMs);return new Cu(t.batchId,i,n,r)}function ba(t){var e=ma(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ma(t.lastLimboFreeSnapshotVersion):Hr.min(),r=(void 0!==t.query.documents?function(t){Nr(1===t.documents.length);var e=t.documents[0];return eu.hn(Mo(e)).We()}:function(t){var e,n=Mo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Nr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ko(t.unaryFilter.field);return lu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ko(t.unaryFilter.field);return lu.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ar()}}(e)]:void 0!==e.fieldFilter?[(n=e,lu.create(Ko(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ar()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Ar():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Lu(Ko((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=si(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=Wo(r.startAt));var l=null;return r.endAt&&(l=Wo(r.endAt)),new eu(n,o,u,s,c,"F",f,l).We()})(t.query);return new wi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,di.fromBase64String(t.resumeToken))}function Ia(t,e){var n=ga(e.X),r=ga(e.lastLimboFreeSnapshotVersion),i=(pi(e.target)?Go:Qo)(t.Ks,e.target),o=e.resumeToken.toBase64();return new yh(e.targetId,fi(e.target),n,o,e.sequenceNumber,r,i)}var Ea,Ta=(_a.prototype.jn=function(t,e,n){return Na(t).put(Sa(e),n)},_a.prototype.Gn=function(t,e){var n=Na(t),r=Sa(e);return n.delete(r)},_a.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Gs(e,t)})},_a.prototype.zn=function(t,e){var n=this;return Na(t).get(Sa(e)).next(function(t){return n.zs(t)})},_a.prototype.Hs=function(t,e){var n=this;return Na(t).get(Sa(e)).next(function(t){var e=n.zs(t);return e?{Ys:e,size:Da(t)}:null})},_a.prototype.getEntries=function(t,e){var r=this,i=ki;return this.Js(t,e,function(t,e){var n=r.zs(e);i=i.nt(t,n)}).next(function(){return i})},_a.prototype.Xs=function(t,e){var r=this,i=ki,o=new Ti(Yr.P);return this.Js(t,e,function(t,e){var n=r.zs(e);o=n?(i=i.nt(t,n),o.nt(t,Da(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Zs:i,ti:o}})},_a.prototype.Js=function(t,e,i){if(e._())return Uu.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return Na(t).ei({range:n},function(t,e,n){for(var r=Yr.j(t);s&&Yr.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.ni(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},_a.prototype._s=function(t,i,e){var n,r,o,s=this,u=Ci,a=i.path.length+1,h={};return e.isEqual(Hr.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=ya(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=ph.collectionReadTimeIndex),Na(t).ei(h,function(t,e,n){var r;t.length===a&&(r=pa(s.serializer,e),i.path.D(r.key.path)?r instanceof Js&&hu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},_a.prototype.si=function(t,e){var r=this,i=ki,o=ya(e),n=Na(t),s=IDBKeyRange.lowerBound(o,!0);return n.ei({index:ph.readTimeIndex,range:s},function(t,e){var n=pa(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{ii:i,readTime:va(o)}})},_a.prototype.ri=function(t){var e=Na(t),r=Hr.min();return e.ei({index:ph.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=va(e.readTime)),n.done()}).next(function(){return r})},_a.prototype.oi=function(t){return new _a.hi(this,!!t&&t.ai)},_a.prototype.ui=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},_a.prototype.getMetadata=function(t){return Aa(t).get(dh.key).next(function(t){return Nr(!!t),t})},_a.prototype.Gs=function(t,e){return Aa(t).put(dh.key,e)},_a.prototype.zs=function(t){if(t){var e=pa(this.serializer,t);return e instanceof Zs&&e.version.isEqual(Hr.min())?null:e}return null},_a);function _a(t,e){this.serializer=t,this.ss=e}function Aa(t){return Fa.js(t,dh.store)}function Na(t){return Fa.js(t,ph.store)}function Sa(t){return t.path.F()}function Da(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ar();e=t.noDocument}return JSON.stringify(e).length}function xa(t,e){var n=this;return(n=Ea.call(this)||this).ci=t,n.ai=e,n.li=new Br(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ta.hi=(n(xa,Ea=Mu),xa.prototype.Jn=function(s){var u=this,a=[],h=0,c=new Pi(function(t,e){return Pr(t.N(),e.N())});return this.Un.forEach(function(t,e){var n,r,i,o=u.li.get(t);e?(n=da(u.ci.serializer,e,u.readTime),c=c.add(t.path.p()),r=Da(n),h+=r-o,a.push(u.ci.jn(s,t,n))):(h-=o,u.ai?(i=da(u.ci.serializer,new Zs(t,Hr.min()),u.readTime),a.push(u.ci.jn(s,t,i))):a.push(u.ci.Gn(s,t)))}),c.forEach(function(t){a.push(u.ci.ss.Us(s,t))}),a.push(this.ci.updateMetadata(s,h)),Uu.Bn(a)},xa.prototype.Hn=function(t,e){var n=this;return this.ci.Hs(t,e).next(function(t){return null===t?(n.li.set(e,0),null):(n.li.set(e,t.size),t.Ys)})},xa.prototype.Yn=function(t,e){var n=this;return this.ci.Xs(t,e).next(function(t){var e=t.Zs;return t.ti.forEach(function(t,e){n.li.set(t,e)}),e})},xa);var Pa=(La.prototype.next=function(){return this._i+=2,this._i},La.fi=function(){return new La(0)},La.di=function(){return new La(-1)},La),Oa=(ka.prototype.Ti=function(n){var r=this;return this.Ei(n).next(function(t){var e=new Pa(t.highestTargetId);return t.highestTargetId=e.next(),r.Ii(n,t).next(function(){return t.highestTargetId})})},ka.prototype.mi=function(t){return this.Ei(t).next(function(t){return Hr.I(new Qr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ka.prototype.Ai=function(t){return this.Ei(t).next(function(t){return t.highestListenSequenceNumber})},ka.prototype.Ri=function(e,n,r){var i=this;return this.Ei(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ii(e,t)})},ka.prototype.Pi=function(e,n){var r=this;return this.Vi(e,n).next(function(){return r.Ei(e).next(function(t){return t.targetCount+=1,r.gi(n,t),r.Ii(e,t)})})},ka.prototype.yi=function(t,e){return this.Vi(t,e)},ka.prototype.pi=function(e,t){var n=this;return this.bi(e,t.targetId).next(function(){return Ra(e).delete(t.targetId)}).next(function(){return n.Ei(e)}).next(function(t){return Nr(0<t.targetCount),--t.targetCount,n.Ii(e,t)})},ka.prototype.vi=function(r,i,o){var s=this,u=0,a=[];return Ra(r).ei(function(t,e){var n=ba(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.pi(r,n)))}).next(function(){return Uu.Bn(a)}).next(function(){return u})},ka.prototype.pe=function(t,r){return Ra(t).ei(function(t,e){var n=ba(e);r(n)})},ka.prototype.Ei=function(t){return Ca(t).get(gh.key).next(function(t){return Nr(null!==t),t})},ka.prototype.Ii=function(t,e){return Ca(t).put(gh.key,e)},ka.prototype.Vi=function(t,e){return Ra(t).put(Ia(this.serializer,e))},ka.prototype.gi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ka.prototype.Si=function(t){return this.Ei(t).next(function(t){return t.targetCount})},ka.prototype.Di=function(t,i){var e=fi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Ra(t).ei({range:n,index:yh.queryTargetsIndexName},function(t,e,n){var r=ba(e);li(i,r.target)&&(o=r,n.done())}).next(function(){return o})},ka.prototype.Ci=function(n,t,r){var i=this,o=[],s=Va(n);return t.forEach(function(t){var e=ea(t.path);o.push(s.put(new vh(r,e))),o.push(i.wi.Fi(n,r,t))}),Uu.Bn(o)},ka.prototype.Ni=function(n,t,r){var i=this,o=Va(n);return Uu.forEach(t,function(t){var e=ea(t.path);return Uu.Bn([o.delete([r,e]),i.wi.$i(n,r,t)])})},ka.prototype.bi=function(t,e){var n=Va(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ka.prototype.ki=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Va(t),o=Mi();return r.ei({range:n,xi:!0},function(t,e,n){var r=ia(t[1]),i=new Yr(r);o=o.add(i)}).next(function(){return o})},ka.prototype.Mi=function(t,e){var n=ea(e.path),r=IDBKeyRange.bound([n],[kr(n)],!1,!0),i=0;return Va(t).ei({index:vh.documentTargetsIndex,xi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ka.prototype.Me=function(t,e){return Ra(t).get(e).next(function(t){return t?ba(t):null})},ka);function ka(t,e){this.wi=t,this.serializer=e}function La(t){this._i=t}function Ra(t){return Fa.js(t,yh.store)}function Ca(t){return Fa.js(t,gh.store)}function Va(t){return Fa.js(t,vh.store)}var Ua,Ma="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ja=(n(Ba,Ua=Fu),Ba),Fa=(qa.js=function(t,e){if(t instanceof ja)return Th.js(t.Oi,e);throw Ar()},qa.prototype.start=function(){var e=this;return Th.Zi(this.Yi,nh,new rh(this.serializer)).then(function(t){return e.tr=t,e.er()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Gr(zr.FAILED_PRECONDITION,Ma);return e.nr(),e.sr(),e.ir(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ji.Ai(t)})}).then(function(t){e.Ui=new zu(t,e.Bi)}).then(function(){e.Qi=!0}).catch(function(t){return e.tr&&e.tr.close(),Promise.reject(t)})},qa.prototype.rr=function(n){var t=this;return this.zi=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.or?[2,n(e)]:[2]})})},n(this.isPrimary)},qa.prototype.hr=function(n){var t=this;this.tr.ar(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},qa.prototype.ur=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.bs.cr(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.or?[4,this.er()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},qa.prototype.er=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ga(e).put(new bh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.lr(e).next(function(t){t||(n.isPrimary=!1,n.bs._r(function(){return n.zi(!1)}))})}).next(function(){return n.dr(e)}).next(function(t){return n.isPrimary&&!t?n.wr(e).next(function(){return!1}):!!t&&n.Tr(e).next(function(){return!0})})}).catch(function(t){if(xh(t))return Er("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Er("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.bs._r(function(){return n.zi(t)}),n.isPrimary=t})},qa.prototype.lr=function(t){var e=this;return za(t).get(oh.key).next(function(t){return Uu.resolve(e.Er(t))})},qa.prototype.Ir=function(t){return Ga(t).delete(this.clientId)},qa.prototype.mr=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ar(this.Gi,18e5)?[3,2]:(this.Gi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=qa.js(t,bh.store);return r.Ws().next(function(t){var e=o.Rr(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Uu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Xi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Xi.removeItem(this.Pr(i.clientId));t.label=2;case 2:return[2]}})})},qa.prototype.ir=function(){var t=this;this.Ki=this.bs.Os("client_metadata_refresh",4e3,function(){return t.er().then(function(){return t.mr()}).then(function(){return t.ir()})})},qa.prototype.Er=function(t){return!!t&&t.ownerId===this.clientId},qa.prototype.dr=function(e){var i=this;return this.qi?Uu.resolve(!0):za(e).get(oh.key).next(function(t){if(null!==t&&i.Ar(t.leaseTimestampMs,5e3)&&!i.Vr(t.ownerId)){if(i.Er(t)&&i.networkEnabled)return!0;if(!i.Er(t)){if(!t.allowTabSynchronization)throw new Gr(zr.FAILED_PRECONDITION,Ma);return!1}}return!(!i.networkEnabled||!i.inForeground)||Ga(e).Ws().next(function(t){return void 0===i.Rr(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Er("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},qa.prototype.gr=function(){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Qi=!1,this.yr(),this.Ki&&(this.Ki.cancel(),this.Ki=null),this.pr(),this.br(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.wr(t).next(function(){return e.Ir(t)})}).catch(function(t){Er("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.tr.close(),this.vr(),[2]}})})},qa.prototype.Rr=function(t,e){var n=this;return t.filter(function(t){return n.Ar(t.updateTimeMs,e)&&!n.Vr(t.clientId)})},qa.prototype.Sr=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Ga(t).Ws().next(function(t){return e.Rr(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(qa.prototype,"or",{get:function(){return this.Qi},enumerable:!1,configurable:!0}),qa.prototype.Dr=function(t){return Ka.Cr(t,this.serializer,this.ss,this.wi)},qa.prototype.Fr=function(){return this.Ji},qa.prototype.Nr=function(){return this.es},qa.prototype.$r=function(){return this.ss},qa.prototype.runTransaction=function(e,n,r){var i=this;Er("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.tr.runTransaction(t,Eh,function(t){return o=new ja(t,i.Ui?i.Ui.next():zu.ps),"readwrite-primary"===n?i.lr(o).next(function(t){return!!t||i.dr(o)}).next(function(t){if(!t)throw Tr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.bs._r(function(){return i.zi(!1)}),new Gr(zr.FAILED_PRECONDITION,ju);return r(o)}).next(function(t){return i.Tr(o).next(function(){return t})}):i.kr(o).next(function(){return r(o)})}).then(function(t){return o.ts(),t})},qa.prototype.kr=function(t){var e=this;return za(t).get(oh.key).next(function(t){if(null!==t&&e.Ar(t.leaseTimestampMs,5e3)&&!e.Vr(t.ownerId)&&!e.Er(t)&&!(e.qi||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Gr(zr.FAILED_PRECONDITION,Ma)})},qa.prototype.Tr=function(t){var e=new oh(this.clientId,this.allowTabSynchronization,Date.now());return za(t).put(oh.key,e)},qa.Hi=function(){return Th.Hi()},qa.prototype.wr=function(t){var e=this,n=za(t);return n.get(oh.key).next(function(t){return e.Er(t)?(Er("IndexedDbPersistence","Releasing primary lease."),n.delete(oh.key)):Uu.resolve()})},qa.prototype.Ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Tr("Detected an update time that is in the future: "+t+" > "+n),1))},qa.prototype.nr=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ji=function(){t.bs.cr(function(){return t.inForeground="visible"===t.document.visibilityState,t.er()})},this.document.addEventListener("visibilitychange",this.ji),this.inForeground="visible"===this.document.visibilityState)},qa.prototype.pr=function(){this.ji&&(this.document.removeEventListener("visibilitychange",this.ji),this.ji=null)},qa.prototype.sr=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Wi=function(){e.yr(),e.bs.cr(function(){return e.gr()})},this.window.addEventListener("unload",this.Wi))},qa.prototype.br=function(){this.Wi&&(this.window.removeEventListener("unload",this.Wi),this.Wi=null)},qa.prototype.Vr=function(t){var e;try{var n=null!==(null===(e=this.Xi)||void 0===e?void 0:e.getItem(this.Pr(t)));return Er("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},qa.prototype.yr=function(){if(this.Xi)try{this.Xi.setItem(this.Pr(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}},qa.prototype.vr=function(){if(this.Xi)try{this.Xi.removeItem(this.Pr(this.clientId))}catch(t){}},qa.prototype.Pr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},qa);function qa(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.bs=i,this.window=o,this.document=s,this.Bi=a,this.qi=h,this.Ui=null,this.Qi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Wi=null,this.inForeground=!1,this.ji=null,this.Ki=null,this.Gi=Number.NEGATIVE_INFINITY,this.zi=function(t){return Promise.resolve()},!qa.Hi())throw new Gr(zr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.wi=new Qa(this,r),this.Yi=e+"main",this.serializer=new la(u),this.Ji=new Oa(this.wi,this.serializer),this.ss=new ua,this.es=new Ta(this.serializer,this.ss),this.window&&this.window.localStorage?this.Xi=this.window.localStorage:(this.Xi=null,!1===h&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ba(t,e){var n=this;return(n=Ua.call(this)||this).Oi=t,n.Li=e,n}function za(t){return Fa.js(t,oh.store)}function Ga(t){return Fa.js(t,bh.store)}var Qa=(Ha.prototype.Mr=function(t){var n=this.Or(t);return this.db.Fr().Si(t).next(function(e){return n.next(function(t){return e+t})})},Ha.prototype.Or=function(t){var e=0;return this.Lr(t,function(t){e++}).next(function(){return e})},Ha.prototype.pe=function(t,e){return this.db.Fr().pe(t,e)},Ha.prototype.Lr=function(t,n){return this.Br(t,function(t,e){return n(e)})},Ha.prototype.Fi=function(t,e,n){return Wa(t,n)},Ha.prototype.$i=function(t,e,n){return Wa(t,n)},Ha.prototype.vi=function(t,e,n){return this.db.Fr().vi(t,e,n)},Ha.prototype.qr=Wa,Ha.prototype.Ur=function(t,e){return r=e,i=!1,eh(n=t).Qr(function(t){return Ya(n,t,r).next(function(t){return t&&(i=!0),Uu.resolve(!t)})}).next(function(){return i});var n,r,i},Ha.prototype.Wr=function(r,i){var o=this,s=this.db.Nr().oi(),u=[],a=0;return this.Br(r,function(e,t){var n;t<=i&&(n=o.Ur(r,e).next(function(t){if(!t)return a++,s.zn(r,e).next(function(){return s.Gn(e),Va(r).delete([0,ea(e.path)])})}),u.push(n))}).next(function(){return Uu.Bn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},Ha.prototype.removeTarget=function(t,e){var n=e.Z(t.Li);return this.db.Fr().yi(t,n)},Ha.prototype.jr=Wa,Ha.prototype.Br=function(t,o){var s,e=Va(t),u=zu.ps;return e.ei({index:vh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==zu.ps&&o(new Yr(ia(s)),u),u=i,s=r):u=zu.ps}).next(function(){u!==zu.ps&&o(new Yr(ia(s)),u)})},Ha.prototype.Kr=function(t){return this.db.Nr().ui(t)},Ha);function Ha(t,e){this.db=t,this.xr=new Xh(this,e)}function Wa(t,e){return Va(t).put((n=t.Li,new vh(0,ea(e.path),n)));var n}function $a(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ka=(Xa.Cr=function(t,e,n,r){return Nr(""!==t.uid),new Xa(t.zr()?t.uid:"",e,n,r)},Xa.prototype.Hr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Za(t).ei({index:ah.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Xa.prototype.Yr=function(d,y,v,g){var m=this,w=th(d),b=Za(d);return b.add({}).next(function(t){Nr("number"==typeof t);for(var e,n,r,i,o,s=new Cu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Bo(e.Ks,t)}),o=r.mutations.map(function(t){return Bo(e.Ks,t)}),new ah(n,r.batchId,r.yn.toMillis(),i,o)),a=[],h=new Pi(function(t,e){return Pr(t.N(),e.N())}),c=0,f=g;c<f.length;c++){var l=f[c],p=hh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,hh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.ss.Us(d,t))}),d.Zn(function(){m.Gr[t]=s.keys()}),Uu.Bn(a).next(function(){return s})})},Xa.prototype.Jr=function(t,e){var n=this;return Za(t).get(e).next(function(t){return t?(Nr(t.userId===n.userId),wa(n.serializer,t)):null})},Xa.prototype.Xr=function(t,n){var r=this;return this.Gr[n]?Uu.resolve(this.Gr[n]):this.Jr(t,n).next(function(t){if(t){var e=t.keys();return r.Gr[n]=e}return null})},Xa.prototype.Zr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Za(t).ei({index:ah.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Nr(e.batchId>=i),o=wa(r.serializer,e)),n.done()}).next(function(){return o})},Xa.prototype.to=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Za(t).ei({index:ah.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Xa.prototype.eo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Za(t).Ws(ah.userMutationsIndex,n).next(function(t){return t.map(function(t){return wa(e.serializer,t)})})},Xa.prototype.os=function(u,a){var h=this,t=hh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return th(u).ei({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ia(i);if(r===h.userId&&a.path.isEqual(s))return Za(u).get(o).next(function(t){if(!t)throw Ar();Nr(t.userId===h.userId),c.push(wa(h.serializer,t))});n.done()}).next(function(){return c})},Xa.prototype.ls=function(r,t){var a=this,h=new Pi(Pr),i=[];return t.forEach(function(u){var t=hh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=th(r).ei({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ia(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Uu.Bn(i).next(function(){return a.no(r,h)})},Xa.prototype.Es=function(t,e){var u=this,a=e.path,h=a.length+1,n=hh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Pi(Pr);return th(t).ei({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ia(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.no(t,c)})},Xa.prototype.no=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Za(e).get(t).next(function(t){if(null===t)throw Ar();Nr(t.userId===n.userId),r.push(wa(n.serializer,t))}))}),Uu.Bn(i).next(function(){return r})},Xa.prototype.so=function(e,n){var r=this;return Ja(e.Oi,this.userId,n).next(function(t){return e.Zn(function(){r.io(n.batchId)}),Uu.forEach(t,function(t){return r.wi.qr(e,t)})})},Xa.prototype.io=function(t){delete this.Gr[t]},Xa.prototype.ro=function(n){var o=this;return this.Hr(n).next(function(t){if(!t)return Uu.resolve();var e=IDBKeyRange.lowerBound(hh.prefixForUser(o.userId)),i=[];return th(n).ei({range:e},function(t,e,n){var r;t[0]===o.userId?(r=ia(t[1]),i.push(r)):n.done()}).next(function(){Nr(0===i.length)})})},Xa.prototype.Mi=function(t,e){return Ya(t,this.userId,e)},Xa.prototype.oo=function(t){var e=this;return eh(t).get(this.userId).next(function(t){return t||new uh(e.userId,-1,"")})},Xa);function Xa(t,e,n,r){this.userId=t,this.serializer=e,this.ss=n,this.wi=r,this.Gr={}}function Ya(t,o,e){var n=hh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return th(t).ei({range:r,xi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Ja(t,e,n){var r=t.store(ah.store),i=t.store(hh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ei({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Nr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=hh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Uu.Bn(o).next(function(){return h})}function Za(t){return Fa.js(t,ah.store)}function th(t){return Fa.js(t,hh.store)}function eh(t){return Fa.js(t,uh.store)}var nh=10,rh=(sh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Nr(t<e&&0<=t&&e<=nh);var o,s=new Ph(r);t<1&&1<=e&&(n.createObjectStore(oh.store),(o=n).createObjectStore(uh.store,{keyPath:uh.keyPath}),o.createObjectStore(ah.store,{keyPath:ah.keyPath,autoIncrement:!0}).createIndex(ah.userMutationsIndex,ah.userMutationsKeyPath,{unique:!0}),o.createObjectStore(hh.store),wh(n),n.createObjectStore(ph.store));var u,a=Uu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(vh.store),u.deleteObjectStore(yh.store),u.deleteObjectStore(gh.store),wh(n)),a=a.next(function(){return t=s.store(gh.store),e=new gh(0,0,Hr.min().A(),0),t.put(gh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(ah.store).Ws().next(function(t){r.deleteObjectStore(ah.store),r.createObjectStore(ah.store,{keyPath:ah.keyPath,autoIncrement:!0}).createIndex(ah.userMutationsIndex,ah.userMutationsKeyPath,{unique:!0});var e=i.store(ah.store),n=t.map(function(t){return e.put(t)});return Uu.Bn(n)});var r,i})),a=a.next(function(){n.createObjectStore(bh.store,{keyPath:bh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(dh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(ph.store)).createIndex(ph.readTimeIndex,ph.readTimeIndexPath,{unique:!1}),t.createIndex(ph.collectionReadTimeIndex,ph.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},sh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(ph.store).ei(function(t,e){n+=Da(e)}).next(function(){var t=new dh(n);return e.store(dh.store).put(dh.key,t)})},sh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(uh.store),e=r.store(ah.store);return t.Ws().next(function(t){return Uu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ws(ah.userMutationsIndex,t).next(function(t){return Uu.forEach(t,function(t){Nr(t.userId===n.userId);var e=wa(i.serializer,t);return Ja(r,n.userId,e).next(function(){})})})})})},sh.prototype.ensureSequenceNumbers=function(t){var s=t.store(vh.store),e=t.store(ph.store);return t.store(gh.store).get(gh.key).next(function(i){var o=[];return e.ei(function(t,e){var n=new $r(t),r=[0,ea(n)];o.push(s.get(r).next(function(t){return t?Uu.resolve():s.put(new vh(0,ea(n),i.highestListenSequenceNumber))}))}).next(function(){return Uu.Bn(o)})})},sh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:ea(n)})}}t.createObjectStore(mh.store,{keyPath:mh.keyPath});var i=e.store(mh.store),o=new sa;return e.store(ph.store).ei({xi:!0},function(t,e){return r(new $r(t).p())}).next(function(){return e.store(hh.store).ei({xi:!0},function(t,e){t[0];var n=t[1];return r((t[2],ia(n)).p())})})},sh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(yh.store);return o.ei(function(t,e){var n=ba(e),r=Ia(i.serializer,n);return o.put(r)})},sh),ih=function(t,e){this.seconds=t,this.nanoseconds=e},oh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function sh(t){this.serializer=t}oh.store="owner",oh.key="owner";var uh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};uh.store="mutationQueues",uh.keyPath="userId";var ah=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ah.store="mutations",ah.keyPath="batchId",ah.userMutationsIndex="userMutationsIndex",ah.userMutationsKeyPath=["userId","batchId"];var hh=(ch.prefixForUser=function(t){return[t]},ch.prefixForPath=function(t,e){return[t,ea(e)]},ch.key=function(t,e,n){return[t,ea(e),n]},ch);function ch(){}hh.store="documentMutations",hh.PLACEHOLDER=new hh;var fh=function(t,e){this.path=t,this.readTime=e},lh=function(t,e){this.path=t,this.version=e},ph=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ph.store="remoteDocuments",ph.readTimeIndex="readTimeIndex",ph.readTimeIndexPath="readTime",ph.collectionReadTimeIndex="collectionReadTimeIndex",ph.collectionReadTimeIndexPath=["parentPath","readTime"];var dh=function(t){this.byteSize=t};dh.store="remoteDocumentGlobal",dh.key="remoteDocumentGlobalKey";var yh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};yh.store="targets",yh.keyPath="targetId",yh.queryTargetsIndexName="queryTargetsIndex",yh.queryTargetsKeyPath=["canonicalId","targetId"];var vh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};vh.store="targetDocuments",vh.keyPath=["targetId","path"],vh.documentTargetsIndex="documentTargetsIndex",vh.documentTargetsKeyPath=["path","targetId"];var gh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};gh.key="targetGlobalKey",gh.store="targetGlobal";var mh=function(t,e){this.collectionId=t,this.parent=e};function wh(t){t.createObjectStore(vh.store,{keyPath:vh.keyPath}).createIndex(vh.documentTargetsIndex,vh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(yh.store,{keyPath:yh.keyPath}).createIndex(yh.queryTargetsIndexName,yh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(gh.store)}mh.store="collectionParents",mh.keyPath=["collectionId","parent"];var bh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};bh.store="clientMetadata",bh.keyPath="clientId";var Ih,Eh=d(d(d([uh.store,ah.store,hh.store,ph.store,yh.store,oh.store,gh.store,vh.store],[bh.store]),[dh.store]),[mh.store]),Th=(Dh.Zi=function(o,t,s){return Er("SimpleDb","Opening database:",o),new Uu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Dh(e))},i.onblocked=function(){r(new Gr(zr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Gr(zr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Er("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,nh).next(function(){Er("SimpleDb","Database upgrade to version "+nh+" complete")})}}).On()},Dh.delete=function(t){return Er("SimpleDb","Removing database:",t),Rh(window.indexedDB.deleteDatabase(t)).On()},Dh.Hi=function(){if("undefined"==typeof indexedDB)return!1;if(Dh.ao())return!0;var t=g(),e=Dh.ho(t),n=0<e&&e<10,r=Dh.uo(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Dh.ao=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.co)},Dh.js=function(t,e){return t.store(e)},Dh.ho=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Dh.uo=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Dh.prototype.ar=function(e){this.db.onversionchange=function(t){return e(t)}},Dh.prototype.runTransaction=function(r,h,c){return y(this,void 0,void 0,function(){var s,u,e,a,n;return v(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:++u,e=Ph.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Uu.reject(t)}).On(),r={},n.catch(function(){}),[4,e.lo];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Er("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Dh.prototype.close=function(){this.db.close()},Dh),_h=(Object.defineProperty(Sh.prototype,"$n",{get:function(){return this.fo},enumerable:!1,configurable:!0}),Object.defineProperty(Sh.prototype,"wo",{get:function(){return this.do},enumerable:!1,configurable:!0}),Object.defineProperty(Sh.prototype,"cursor",{set:function(t){this._o=t},enumerable:!1,configurable:!0}),Sh.prototype.done=function(){this.fo=!0},Sh.prototype.ni=function(t){this.do=t},Sh.prototype.delete=function(){return Rh(this._o.delete())},Sh),Ah=(n(Nh,Ih=Gr),Nh);function Nh(t){var e=this;return(e=Ih.call(this,zr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Sh(t){this._o=t,this.fo=!1,this.do=null}function Dh(t){this.db=t,12.2===Dh.ho(g())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function xh(t){return"IndexedDbTransactionError"===t.name}var Ph=(Lh.open=function(t,e,n){return new Lh(t.transaction(n,e))},Object.defineProperty(Lh.prototype,"lo",{get:function(){return this.To.promise},enumerable:!1,configurable:!0}),Lh.prototype.abort=function(t){t&&this.To.reject(t),this.aborted||(Er("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Lh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Oh(e)},Lh),Oh=(kh.prototype.put=function(t,e){return Rh(void 0!==e?(Er("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Er("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},kh.prototype.add=function(t){return Er("SimpleDb","ADD",this.store.name,t,t),Rh(this.store.add(t))},kh.prototype.get=function(e){var n=this;return Rh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Er("SimpleDb","GET",n.store.name,e,t),t})},kh.prototype.delete=function(t){return Er("SimpleDb","DELETE",this.store.name,t),Rh(this.store.delete(t))},kh.prototype.count=function(){return Er("SimpleDb","COUNT",this.store.name),Rh(this.store.count())},kh.prototype.Ws=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Eo(n,function(t,e){r.push(e)}).next(function(){return r})},kh.prototype.Io=function(t,e){Er("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.xi=!1;var r=this.cursor(n);return this.Eo(r,function(t,e,n){return n.delete()})},kh.prototype.ei=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Eo(r,e)},kh.prototype.Qr=function(i){var t=this.cursor({});return new Uu(function(n,r){t.onerror=function(t){var e=Vh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},kh.prototype.Eo=function(t,s){var u=[];return new Uu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new _h(i),(n=s(i.primaryKey,i.value,e))instanceof Uu&&(r=n.catch(function(t){return e.done(),Uu.reject(t)}),u.push(r)),e.$n?o():null===e.wo?i.continue():i.continue(e.wo)):o()}}).next(function(){return Uu.Bn(u)})},kh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},kh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.xi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},kh);function kh(t){this.store=t}function Lh(t){var n=this;this.transaction=t,this.aborted=!1,this.To=new Ju,this.transaction.oncomplete=function(){n.To.resolve()},this.transaction.onabort=function(){t.error?n.To.reject(new Ah(t.error)):n.To.resolve()},this.transaction.onerror=function(t){var e=Vh(t.target.error);n.To.reject(new Ah(e))}}function Rh(t){return new Uu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Vh(t.target.error);r(e)}})}var Ch=!1;function Vh(t){var e=Th.ho(g());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Gr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ch||(Ch=!0,setTimeout(function(){throw r},0)),r}}return t}function Uh(){return"undefined"!=typeof window?window:null}var Mh=(qh.Vo=function(t,e,n,r,i){var o=new qh(t,e,Date.now()+n,r,i);return o.start(n),o},qh.prototype.start=function(t){var e=this;this.yo=setTimeout(function(){return e.po()},t)},qh.prototype.Bs=function(){return this.po()},qh.prototype.cancel=function(t){null!==this.yo&&(this.clearTimeout(),this.Po.reject(new Gr(zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},qh.prototype.po=function(){var e=this;this.mo.cr(function(){return null!==e.yo?(e.clearTimeout(),e.op().then(function(t){return e.Po.resolve(t)})):Promise.resolve()})},qh.prototype.clearTimeout=function(){null!==this.yo&&(this.Ro(this),clearTimeout(this.yo),this.yo=null)},qh),jh=(Object.defineProperty(Fh.prototype,"xo",{get:function(){return this.So},enumerable:!1,configurable:!0}),Fh.prototype.cr=function(t){this.enqueue(t)},Fh.prototype.Mo=function(t){this.Oo(),this.Lo(t)},Fh.prototype.Bo=function(t){return this.Oo(),this.Lo(t)},Fh.prototype.qo=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Oo(),this.So?[3,2]:(this.So=!0,(e=Uh())&&e.removeEventListener("visibilitychange",this.ko),[4,this.Bo(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Fh.prototype.enqueue=function(t){return this.Oo(),this.So?new Promise(function(t){}):this.Lo(t)},Fh.prototype._r=function(t){var e=this;this.vo.push(t),this.cr(function(){return e.Uo()})},Fh.prototype.Uo=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.vo.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.vo[0]()];case 2:return t.sent(),this.vo.shift(),this.$o.reset(),[3,4];case 3:if(!xh(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.vo.length&&this.$o.xs(function(){return n.Uo()}),t.label=5;case 5:return[2]}})})},Fh.prototype.Lo=function(t){var r=this,e=this.bo.then(function(){return r.Fo=!0,t().catch(function(t){throw r.Co=t,r.Fo=!1,Tr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Fo=!1,t})});return this.bo=e},Fh.prototype.Os=function(t,e,n){var r=this;this.Oo(),-1<this.No.indexOf(t)&&(e=0);var i=Mh.Vo(this,t,e,n,function(t){return r.Qo(t)});return this.Do.push(i),i},Fh.prototype.Oo=function(){this.Co&&Ar()},Fh.prototype.Wo=function(){},Fh.prototype.jo=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.bo];case 1:t.sent(),t.label=2;case 2:if(e!==this.bo)return[3,0];t.label=3;case 3:return[2]}})})},Fh.prototype.Ko=function(t){for(var e=0,n=this.Do;e<n.length;e++)if(n[e].vs===t)return!0;return!1},Fh.prototype.Go=function(r){var i=this;return this.jo().then(function(){i.Do.sort(function(t,e){return t.Ao-e.Ao});for(var t=0,e=i.Do;t<e.length;t++){var n=e[t];if(n.Bs(),"all"!==r&&n.vs===r)break}return i.jo()})},Fh.prototype.zo=function(t){this.No.push(t)},Fh.prototype.Qo=function(t){var e=this.Do.indexOf(t);this.Do.splice(e,1)},Fh);function Fh(){var t=this;this.bo=Promise.resolve(),this.vo=[],this.So=!1,this.Do=[],this.Co=null,this.Fo=!1,this.No=[],this.$o=new Zu(this,"async_queue_retry"),this.ko=function(){return t.$o.Ls()};var e=Uh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ko)}function qh(t,e,n,r,i){this.mo=t,this.vs=e,this.Ao=n,this.op=r,this.Ro=i,this.Po=new Ju,this.then=this.Po.promise.then.bind(this.Po.promise),this.Po.promise.catch(function(t){})}function Bh(t,e){if(Tr("AsyncQueue",e+": "+t),xh(t))return new Gr(zr.UNAVAILABLE,e+": "+t);throw t}function zh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Pr(n,i);return 0===s?Pr(r,o):s}var Gh=($h.prototype.Jo=function(){return++this.Yo},$h.prototype.Xo=function(t){var e,n=[t,this.Jo()];this.buffer.size<this.Ho?this.buffer=this.buffer.add(n):zh(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty($h.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),$h),Qh={Zo:!1,th:0,eh:0,nh:0},Hh=(Wh.oh=function(t){return new Wh(t,Wh.hh,Wh.ah)},Wh);function Wh(t,e,n){this.sh=t,this.ih=e,this.rh=n}function $h(t){this.Ho=t,this.buffer=new Pi(zh),this.Yo=0}Hh.uh=-1,Hh.lh=1048576,Hh._h=41943040,Hh.hh=10,Hh.ah=1e3,Hh.fh=new Hh(Hh._h,Hh.hh,Hh.ah),Hh.dh=new Hh(Hh.uh,0,0);var Kh=(tc.prototype.start=function(t){this.xr.params.sh!==Hh.uh&&this.Eh(t)},tc.prototype.stop=function(){this.Th&&(this.Th.cancel(),this.Th=null)},Object.defineProperty(tc.prototype,"or",{get:function(){return null!==this.Th},enumerable:!1,configurable:!0}),tc.prototype.Eh=function(n){var t=this,e=this.wh?3e5:6e4;Er("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Th=this.mo.Os("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Th=null,this.wh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ih(this.xr)];case 2:return t.sent(),[3,7];case 3:return xh(e=t.sent())?(Er("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,oc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Eh(n)];case 8:return t.sent(),[2]}})})})},tc),Xh=(Zh.prototype.Ah=function(t,e){return this.mh.Mr(t).next(function(t){return Math.floor(e/100*t)})},Zh.prototype.Rh=function(t,e){var n=this;if(0===e)return Uu.resolve(zu.ps);var r=new Gh(e);return this.mh.pe(t,function(t){return r.Xo(t.sequenceNumber)}).next(function(){return n.mh.Lr(t,function(t){return r.Xo(t)})}).next(function(){return r.maxValue})},Zh.prototype.vi=function(t,e,n){return this.mh.vi(t,e,n)},Zh.prototype.Wr=function(t,e){return this.mh.Wr(t,e)},Zh.prototype.Ph=function(e,n){var r=this;return this.params.sh===Hh.uh?(Er("LruGarbageCollector","Garbage collection skipped; disabled"),Uu.resolve(Qh)):this.Kr(e).next(function(t){return t<r.params.sh?(Er("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.sh),Qh):r.Vh(e,n)})},Zh.prototype.Kr=function(t){return this.mh.Kr(t)},Zh.prototype.Vh=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.Ah(e,this.params.ih).next(function(t){return i=t>c.params.rh?(Er("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.rh+" from "+t),c.params.rh):t,s=Date.now(),c.Rh(e,i)}).next(function(t){return r=t,u=Date.now(),c.vi(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Wr(e,r)}).next(function(t){return h=Date.now(),Ir()<=p.DEBUG&&Er("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Uu.resolve({Zo:!0,th:i,eh:o,nh:t})})},Zh),Yh=(Jh.prototype.start=function(){return Promise.resolve()},Jh.prototype.Ch=function(i){return y(this,void 0,void 0,function(){var e,m,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.ns,m=this.Sh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.ns.eo(v).next(function(t){return g=t,e=r.persistence.Dr(i),m=new qu(r.vh,e,r.persistence.$r()),e.eo(v)}).next(function(t){for(var e=[],n=[],r=Mi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.us(v,r).next(function(t){return{Fh:t,Nh:e,$h:n}})})})];case 1:return n=t.sent(),[2,(this.ns=e,this.Sh=m,this.gh.Dh(this.Sh),n)]}})})},Jh.prototype.kh=function(h){var c,f=this,l=Qr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Mi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Sh.us(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Rs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Js?t.field(i.field):void 0,s=Jo(i.transform,o||null);null!=s&&(e=null==e?(new Bs).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new xs(o.key,s,Ws(s.proto.mapValue),ws.exists(!0)))}return f.ns.Yr(a,l,n,h)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Un:e}})},Jh.prototype.xh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.vh.oi({ai:!0});return i.Mh(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.ns.ro(t)}).next(function(){return i.Sh.us(t,e)})})},Jh.prototype.Oh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.ns.Jr(e,t).next(function(t){return Nr(null!==t),n=t.keys(),r.ns.so(e,t)}).next(function(){return r.ns.ro(e)}).next(function(){return r.Sh.us(e,n)})})},Jh.prototype.to=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.ns.to(t)})},Jh.prototype.mi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ji.mi(t)})},Jh.prototype.Lh=function(a){var h=this,c=a.X,f=this.yh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.vh.oi({ai:!0});f=h.yh;var s=[];a.Qt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.Ji.Ni(o,t.Xt,e).next(function(){return h.Ji.Ci(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Li),f=f.nt(e,r),Jh.Bh(i,r,t)&&s.push(h.Ji.yi(o,r))))});var t,u=ki,n=Mi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof Zs&&e.version.isEqual(Hr.min())?(i.Gn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.jn(e,c),u=u.nt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.wi.jr(o,t))})})),c.isEqual(Hr.min())||(t=h.Ji.mi(o).next(function(t){return h.Ji.Ri(o,o.Li,c)}),s.push(t)),Uu.Bn(s).next(function(){return i.apply(o)}).next(function(){return h.Sh.cs(o,u)})}).then(function(t){return h.yh=f,t})},Jh.Bh=function(t,e,n){return Nr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.qh||0<n.Yt.size+n.Jt.size+n.Xt.size},Jh.prototype.Uh=function(c){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Uu.forEach(c,function(e){return Uu.forEach(e.ms,function(t){return h.persistence.wi.Fi(n,e.targetId,t)}).next(function(){return Uu.forEach(e.As,function(t){return h.persistence.wi.$i(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!xh(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.yh.get(o),u=s.X,a=s.et(u),this.yh=this.yh.nt(o,a));return[2]}})})},Jh.prototype.Qh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.ns.Zr(t,e)})},Jh.prototype.Wh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Sh.rs(t,e)})},Jh.prototype.jh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ji.Di(e,r).next(function(t){return t?(n=t,Uu.resolve(n)):i.Ji.Ti(e).next(function(t){return n=new wi(r,t,0,e.Li),i.Ji.Pi(e,n).next(function(){return n})})})}).then(function(t){var e=i.yh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.yh=i.yh.nt(t.targetId,t),i.ph.set(r,t.targetId)),t})},Jh.prototype.Di=function(t,e){var n=this.ph.get(e);return void 0!==n?Uu.resolve(this.yh.get(n)):this.Ji.Di(t,e)},Jh.prototype.Kh=function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i=this;return v(this,function(t){switch(t.label){case 0:e=this.yh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.wi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!xh(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.yh=this.yh.remove(o),this.ph.delete(e.target),[2]}})})},Jh.prototype.Gh=function(t,n){var r=this,i=Hr.min(),o=Mi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.Di(e,t.We()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ji.ki(e,t.targetId).next(function(t){o=t})}).next(function(){return r.gh._s(e,t,n?i:Hr.min(),n?o:Mi())}).next(function(t){return{documents:t,zh:o}})})},Jh.prototype.Mh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Uu.resolve();return n.forEach(function(r){u=u.next(function(){return o.zn(t,r)}).next(function(t){var e=t,n=i.Cn.get(r);Nr(null!==n),(!e||e.version.o(n)<0)&&(e=s.pn(r,e,i))&&o.jn(e,i.Dn)})}),u.next(function(){return e.ns.so(t,s)})},Jh.prototype.Ih=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ph(t,n.yh)})},Jh);function Jh(t,e,n){this.persistence=t,this.gh=e,this.yh=new Ti(Pr),this.ph=new Br(fi,li),this.bh=Hr.min(),this.ns=t.Dr(n),this.vh=t.Nr(),this.Ji=t.Fr(),this.Sh=new qu(this.vh,this.ns,this.persistence.$r()),this.gh.Dh(this.Sh)}function Zh(t,e){this.mh=t,this.params=e}function tc(t,e){this.xr=t,this.mo=e,this.wh=!1,this.Th=null}function ec(t,e,n){return new Yh(t,e,n)}Yh.qh=3e8;var nc,rc=(n(ic,nc=Yh),ic.prototype.start=function(){return this.Hh()},ic.prototype.Yh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.ns.Xr(e,t).next(function(t){return t?n.Sh.us(e,t):Uu.resolve(null)})})},ic.prototype.Jh=function(t){this.ns.io(t)},ic.prototype.ur=function(t){this.persistence.ur(t)},ic.prototype.Sr=function(){return this.persistence.Sr()},ic.prototype.Xh=function(e){var n=this,t=this.yh.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Ji.Me(t,e).next(function(t){return t?t.target:null})})},ic.prototype.si=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.vh.si(t,r.bh)}).then(function(t){var e=t.ii,n=t.readTime;return r.bh=n,e})},ic.prototype.Hh=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.vh.ri(t)})];case 1:return e.bh=t.sent(),[2]}})})},ic);function ic(t,e,n){var r=this;return(r=nc.call(this,t,e,n)||this).persistence=t,r.ns=t.Dr(n),r.vh=t.Nr(),r.Ji=t.Fr(),r}function oc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==zr.FAILED_PRECONDITION||e.message!==ju)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}var sc=(hc.prototype._=function(){return this.Zh._()},hc.prototype.Fi=function(t,e){var n=new uc(t,e);this.Zh=this.Zh.add(n),this.ea=this.ea.add(n)},hc.prototype.sa=function(t,e){var n=this;t.forEach(function(t){return n.Fi(t,e)})},hc.prototype.$i=function(t,e){this.ia(new uc(t,e))},hc.prototype.ra=function(t,e){var n=this;t.forEach(function(t){return n.$i(t,e)})},hc.prototype.oa=function(t){var e=this,n=new Yr(new $r([])),r=new uc(n,t),i=new uc(n,t+1),o=[];return this.ea.vt([r,i],function(t){e.ia(t),o.push(t.key)}),o},hc.prototype.ha=function(){var e=this;this.Zh.forEach(function(t){return e.ia(t)})},hc.prototype.ia=function(t){this.Zh=this.Zh.delete(t),this.ea=this.ea.delete(t)},hc.prototype.aa=function(t){var e=new Yr(new $r([])),n=new uc(e,t),r=new uc(e,t+1),i=Mi();return this.ea.vt([n,r],function(t){i=i.add(t.key)}),i},hc.prototype.Mi=function(t){var e=new uc(t,0),n=this.Zh.Dt(e);return null!==n&&t.isEqual(n.key)},hc),uc=(ac.ta=function(t,e){return Yr.P(t.key,e.key)||Pr(t.ua,e.ua)},ac.na=function(t,e){return Pr(t.ua,e.ua)||Yr.P(t.key,e.key)},ac);function ac(t,e){this.key=t,this.ua=e}function hc(){this.Zh=new Pi(uc.ta),this.ea=new Pi(uc.na)}function cc(t,e){if(0!==e.length)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Dc(e.length,"argument")+".")}function fc(t,e,n){if(e.length!==n)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires "+Dc(n,"argument")+", but was called with "+Dc(e.length,"argument")+".")}function lc(t,e,n){if(e.length<n)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Dc(n,"argument")+", but was called with "+Dc(e.length,"argument")+".")}function pc(t,e,n,r){if(e.length<n||e.length>r)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Dc(e.length,"argument")+".")}function dc(t,e,n,r){bc(t,e,Sc(n)+" argument",r)}function yc(t,e,n,r){void 0!==r&&dc(t,e,n,r)}function vc(t,e,n,r){bc(t,e,n+" option",r)}function gc(t,e,n,r){void 0!==r&&vc(t,e,n,r)}function mc(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Ec(s))}var u=Ec(n);throw new Gr(zr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function wc(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Gr(zr.INVALID_ARGUMENT,"Invalid value "+Ec(r)+" provided to function "+t+"() for its "+Sc(n)+" argument. Acceptable values: "+e.join(", "));return r}function bc(t,e,n,r){if(!("object"===e?Ic(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Ec(r);throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Ic(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ec(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ar();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Tc(t,e,n){if(void 0===n)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Sc(e)+" argument, but it was undefined.")}function _c(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new Gr(zr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Ac(t,e,n,r){var i=Ec(r);return new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Sc(n)+" argument to be a "+e+", but it was: "+i)}function Nc(t,e,n){if(n<=0)throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Sc(e)+" argument to be a positive number, but it was: "+n+".")}function Sc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Dc(t,e){return t+" "+e+(1===t?"":"s")}function xc(){if("undefined"==typeof Uint8Array)throw new Gr(zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Pc(){if("undefined"==typeof atob)throw new Gr(zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Oc,kc,Lc=(qc.fromBase64String=function(t){fc("Blob.fromBase64String",arguments,1),dc("Blob.fromBase64String","string",1,t),Pc();try{return new qc(di.fromBase64String(t))}catch(t){throw new Gr(zr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},qc.fromUint8Array=function(t){if(fc("Blob.fromUint8Array",arguments,1),xc(),!(t instanceof Uint8Array))throw Ac("Blob.fromUint8Array","Uint8Array",1,t);return new qc(di.fromUint8Array(t))},qc.prototype.toBase64=function(){return fc("Blob.toBase64",arguments,0),Pc(),this.ca.toBase64()},qc.prototype.toUint8Array=function(){return fc("Blob.toUint8Array",arguments,0),xc(),this.ca.toUint8Array()},qc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},qc.prototype.isEqual=function(t){return this.ca.isEqual(t.ca)},qc),Rc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Gr(zr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(dc("FieldPath","string",e,t[e]),0===t[e].length)throw new Gr(zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.la=new Xr(t)},Cc=(n(Fc,kc=Rc),Fc.documentId=function(){return new Fc(Xr.L().N())},Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw Ac("isEqual","FieldPath",1,t);return this.la.isEqual(t.la)},Fc),Vc=new RegExp("[~\\*/\\[\\]]"),Uc=function(){this._a=this},Mc=(n(jc,Oc=Uc),jc.prototype.da=function(t){if(2!==t.wa)throw 1===t.wa?t.Ta(this.fa+"() can only appear at the top level of your update data"):t.Ta(this.fa+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},jc.prototype.isEqual=function(t){return t instanceof jc},jc);function jc(t){var e=this;return(e=Oc.call(this)||this).fa=t,e}function Fc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return kc.call(this,t)||this}function qc(t){Pc(),this.ca=t}function Bc(t,e,n){return new mf({wa:3,Ea:e.settings.Ea,methodName:t.fa,Ia:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var zc,Gc,Qc,Hc,Wc,$c,Kc=(n(hf,$c=Uc),hf.prototype.da=function(t){return new vs(t.path,new es)},hf.prototype.isEqual=function(t){return t instanceof hf},hf),Xc=(n(af,Wc=Uc),af.prototype.da=function(t){var e=Bc(this,t,!0),n=this.ma.map(function(t){return Nf(t,e)}),r=new ns(n);return new vs(t.path,r)},af.prototype.isEqual=function(t){return this===t},af),Yc=(n(uf,Hc=Uc),uf.prototype.da=function(t){var e=Bc(this,t,!0),n=this.ma.map(function(t){return Nf(t,e)}),r=new us(n);return new vs(t.path,r)},uf.prototype.isEqual=function(t){return this===t},uf),Jc=(n(sf,Qc=Uc),sf.prototype.da=function(t){var e=new fs(t.serializer,xo(t.serializer,this.Aa));return new vs(t.path,e)},sf.prototype.isEqual=function(t){return this===t},sf),Zc=(n(of,Gc=Uc),of.delete=function(){return cc("FieldValue.delete",arguments),new tf(new Mc("FieldValue.delete"))},of.serverTimestamp=function(){return cc("FieldValue.serverTimestamp",arguments),new tf(new Kc("FieldValue.serverTimestamp"))},of.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return lc("FieldValue.arrayUnion",arguments,1),new tf(new Xc("FieldValue.arrayUnion",t))},of.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return lc("FieldValue.arrayRemove",arguments,1),new tf(new Yc("FieldValue.arrayRemove",t))},of.increment=function(t){return dc("FieldValue.increment","number",1,t),fc("FieldValue.increment",arguments,1),new tf(new Jc("FieldValue.increment",t))},of),tf=(n(rf,zc=Zc),rf.prototype.da=function(t){return this._a.da(t)},rf.prototype.isEqual=function(t){return t instanceof rf&&this._a.isEqual(t._a)},rf),ef=(Object.defineProperty(nf.prototype,"latitude",{get:function(){return this.Ra},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"longitude",{get:function(){return this.Pa},enumerable:!1,configurable:!0}),nf.prototype.isEqual=function(t){return this.Ra===t.Ra&&this.Pa===t.Pa},nf.prototype.T=function(t){return Pr(this.Ra,t.Ra)||Pr(this.Pa,t.Pa)},nf);function nf(t,e){if(fc("GeoPoint",arguments,2),dc("GeoPoint","number",1,t),dc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Gr(zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ra=t,this.Pa=e}function rf(t){var e=this;return(e=zc.call(this)||this)._a=t,e.fa=t.fa,e}function of(){return Gc.call(this)||this}function sf(t,e){var n=this;return(n=Qc.call(this)||this).fa=t,n.Aa=e,n}function uf(t,e){var n=this;return(n=Hc.call(this)||this).fa=t,n.ma=e,n}function af(t,e){var n=this;return(n=Wc.call(this)||this).fa=t,n.ma=e,n}function hf(t){var e=this;return(e=$c.call(this)||this).fa=t,e}function cf(t){return new No(t,!0)}var ff=/^__.*__$/,lf=function(t,e,n){this.Va=t,this.ga=e,this.ya=n},pf=(vf.prototype.pa=function(t,e){var n=[];return null!==this.Le?n.push(new xs(t,this.data,this.Le,e)):n.push(new Ds(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},vf),df=(yf.prototype.pa=function(t,e){var n=[new xs(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},yf);function yf(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function vf(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function gf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ar()}}var mf=(Object.defineProperty(If.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"wa",{get:function(){return this.settings.wa},enumerable:!1,configurable:!0}),If.prototype.va=function(t){return new If(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},If.prototype.Sa=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.va({path:n,Ia:!1});return r.Da(t),r},If.prototype.Ca=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.va({path:n,Ia:!1});return r.ba(),r},If.prototype.Fa=function(t){return this.va({path:void 0,Ia:!0})},If.prototype.Ta=function(t){return kf(t,this.settings.methodName,this.settings.Na||!1,this.path,this.settings.Ea)},If.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},If.prototype.ba=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Da(this.path.get(t))},If.prototype.Da=function(t){if(0===t.length)throw this.Ta("Document fields must not be empty");if(gf(this.wa)&&ff.test(t))throw this.Ta('Document fields cannot begin and end with "__"')},If),wf=(bf.prototype.$a=function(t,e,n,r){return void 0===r&&(r=!1),new mf({wa:t,methodName:e,Ea:n,path:Xr.k(),Ia:!1,Na:r},this.s,this.serializer,this.ignoreUndefinedProperties)},bf);function bf(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||cf(t)}function If(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ba(),this.fieldTransforms=i||[],this.Le=o||[]}function Ef(t,e,n,r,i,o){void 0===o&&(o={});var s=t.$a(o.merge||o.mergeFields?2:0,e,n,i);xf("Data must be an object, but it was:",s,r);var u,a,h=Sf(r,s);if(o.merge)u=new ys(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Rc)d=p.la;else{if("string"!=typeof p)throw Ar();d=Of(e,p,n)}if(!s.contains(d))throw new Gr(zr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Lf(c,d)||c.push(d)}u=new ys(c),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new pf(new qs(h),u,a)}function Tf(t,o,s,e){var u=t.$a(1,o,s);xf("Data must be an object, but it was:",u,e);var a=[],h=new Bs;Ur(e,function(t,e){var n,r=Of(o,t,s),i=u.Ca(r);e instanceof Uc&&e._a instanceof Mc?a.push(r):null!=(n=Nf(e,i))&&(a.push(r),h.set(r,n))});var n=new ys(a);return new df(h.ze(),n,u.fieldTransforms)}function _f(t,e,n,r,i,o){var s=t.$a(1,e,n),u=[Pf(e,r,n)],a=[i];if(o.length%2!=0)throw new Gr(zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Pf(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Bs,v=u.length-1;0<=v;--v){Lf(d,u[v])||(c=u[v],f=a[v],l=s.Ca(c),f instanceof Uc&&f._a instanceof Mc?d.push(c):null!=(p=Nf(f,l))&&(d.push(c),y.set(c,p)))}var g=new ys(d);return new df(y.ze(),g,s.fieldTransforms)}function Af(t,e,n,r){return void 0===r&&(r=!1),Nf(n,t.$a(r?4:3,e))}function Nf(s,t){if(Df(s))return xf("Unsupported field value:",t,s),Sf(s,t);if(s instanceof Uc)return function(t,e){if(!gf(e.wa))throw e.Ta(t.fa+"() can only be used with update() and set()");if(!e.path)throw e.Ta(t.fa+"() is not currently supported inside arrays");var n=t.da(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.Ia&&4!==t.wa)throw t.Ta("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Nf(i[r],t.Fa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return xo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Qr.fromDate(t);return{timestampValue:Po(e.serializer,n)}}if(t instanceof Qr){var r=new Qr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Po(e.serializer,r)}}if(t instanceof ef)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Lc)return{bytesValue:Oo(e.serializer,t)};if(t instanceof lf){var i=e.s,o=t.Va;if(!o.isEqual(i))throw e.Ta("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Lo(t.Va||e.s,t.ga.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Ta("Unsupported field value: "+Ec(t))}(s,t)}function Sf(t,r){var i={};return Mr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Ur(t,function(t,e){var n=Nf(e,r.Sa(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Df(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof ef||t instanceof Lc||t instanceof lf||t instanceof Uc)}function xf(t,e,n){if(!Df(n)||!Ic(n)){var r=Ec(n);throw"an object"===r?e.Ta(t+" a custom object"):e.Ta(t+" "+r)}}function Pf(t,e,n){if(e instanceof Rc)return e.la;if("string"==typeof e)return Of(t,e);throw kf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Of(t,e,n){try{return function(e){if(0<=e.search(Vc))throw new Gr(zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Cc.bind.apply(Cc,d([void 0],e.split("."))))}catch(t){throw new Gr(zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).la}catch(e){throw kf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function kf(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Gr(zr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Lf(t,e){return t.some(function(t){return t.isEqual(e)})}var Rf=(Cf.prototype.zr=function(){return null!=this.uid},Cf.prototype.ka=function(){return this.zr()?"uid:"+this.uid:"anonymous-user"},Cf.prototype.isEqual=function(t){return t.uid===this.uid},Cf);function Cf(t){this.uid=t}function Vf(t,e){this.user=e,this.type="OAuth",this.Oa={},this.Oa.Authorization="Bearer "+t}Rf.UNAUTHENTICATED=new Rf(null),Rf.xa=new Rf("google-credentials-uid"),Rf.Ma=new Rf("first-party-uid");var Uf,Mf,jf,Ff=(ul.prototype.getToken=function(){return Promise.resolve(null)},ul.prototype.Ba=function(){},ul.prototype.qa=function(t){(this.La=t)(Rf.UNAUTHENTICATED)},ul.prototype.Ua=function(){this.La=null},ul),qf=(sl.prototype.getToken=function(){var e=this,n=this.ja,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ja!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Nr("string"==typeof t.accessToken),new Vf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},sl.prototype.Ba=function(){this.forceRefresh=!0},sl.prototype.qa=function(t){this.La=t,this.Wa&&t(this.currentUser)},sl.prototype.Ua=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qa),this.Qa=null,this.La=null},sl.prototype.Ka=function(){var t=this.auth&&this.auth.getUid();return Nr(null===t||"string"==typeof t),new Rf(t)},sl),Bf=(Object.defineProperty(ol.prototype,"Oa",{get:function(){var t={"X-Goog-AuthUser":this.za},e=this.Ga.auth.Ha([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ol),zf=(il.prototype.getToken=function(){return Promise.resolve(new Bf(this.Ga,this.za))},il.prototype.qa=function(t){t(Rf.Ma)},il.prototype.Ua=function(){},il.prototype.Ba=function(){},il),Gf=(rl.prototype.eu=function(){return 1===this.state||2===this.state||4===this.state},rl.prototype.nu=function(){return 2===this.state},rl.prototype.start=function(){3!==this.state?this.auth():this.su()},rl.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.eu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rl.prototype.iu=function(){this.state=0,this.$o.reset()},rl.prototype.ru=function(){var t=this;this.nu()&&null===this.tu&&(this.tu=this.bs.Os(this.Ya,6e4,function(){return t.ou()}))},rl.prototype.hu=function(t){this.au(),this.stream.send(t)},rl.prototype.ou=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.nu()?[2,this.close(0)]:[2]})})},rl.prototype.au=function(){this.tu&&(this.tu.cancel(),this.tu=null)},rl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.au(),this.$o.cancel(),this.Za++,3!==e?this.$o.reset():n&&n.code===zr.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.$o.ks()):n&&n.code===zr.UNAUTHENTICATED&&this.Xa.Ba(),null!==this.stream&&(this.uu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.cu(n)];case 1:return t.sent(),[2]}})})},rl.prototype.uu=function(){},rl.prototype.auth=function(){var n=this;this.state=1;var t=this.lu(this.Za),e=this.Za;this.Xa.getToken().then(function(t){n.Za===e&&n._u(t)},function(e){t(function(){var t=new Gr(zr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fu(t)})})},rl.prototype._u=function(t){var e=this,n=this.lu(this.Za);this.stream=this.du(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.cu(function(t){n(function(){return e.fu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},rl.prototype.su=function(){var t=this;this.state=4,this.$o.xs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},rl.prototype.fu=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},rl.prototype.lu=function(e){var n=this;return function(t){n.bs.cr(function(){return n.Za===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},rl),Qf=(n(nl,jf=Gf),nl.prototype.du=function(t){return this.Ja.Tu("Listen",t)},nl.prototype.onMessage=function(t){this.$o.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ar(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Nr(void 0===i||"string"==typeof i),di.fromBase64String(i||"")):(Nr(void 0===i||i instanceof Uint8Array),di.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Bi(s,u,a,h&&(r=void 0===(n=h).code?zr.UNKNOWN:Ei(n.code),new Gr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Vo(t,f.document.name),p=ko(f.document.updateTime),d=new qs({mapValue:{fields:f.document.fields}}),y=new Js(l,p,d,{});c=new Fi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Vo(t,v.document),m=v.readTime?ko(v.readTime):Hr.min(),w=new Zs(g,m);c=new Fi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var I=Vo(t,b.document);c=new Fi([],b.removedTargetIds||[],I,null)}else{if(!("filter"in e))return Ar();e.filter;var E=e.filter;E.targetId;var T=new vi(E.count||0);c=new qi(E.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Hr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Hr.min():ko(e.readTime)}(t);return this.listener.Eu(e,n)},nl.prototype.Iu=function(t){var e,n,r,i,o={};o.database=jo(this.serializer),o.addTarget=(e=this.serializer,(r=pi(i=(n=t).target)?{documents:Go(e,i)}:{query:Qo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Oo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ar()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.hu(o)},nl.prototype.mu=function(t){var e={};e.database=jo(this.serializer),e.removeTarget=t,this.hu(e)},nl),Hf=(n(el,Mf=Gf),Object.defineProperty(el.prototype,"Ru",{get:function(){return this.Au},enumerable:!1,configurable:!0}),el.prototype.start=function(){this.Au=!1,this.lastStreamToken=void 0,Mf.prototype.start.call(this)},el.prototype.uu=function(){this.Au&&this.Pu([])},el.prototype.du=function(t){return this.Ja.Tu("Write",t)},el.prototype.onMessage=function(t){if(Nr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Au){this.$o.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Nr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?ko(t.updateTime):ko(e);n.isEqual(Hr.min())&&(n=ko(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new ms(n,r)}(t,i)})):[]),n=ko(t.commitTime);return this.listener.Vu(n,e)}var r,i;return Nr(!t.writeResults||0===t.writeResults.length),this.Au=!0,this.listener.gu()},el.prototype.yu=function(){var t={};t.database=jo(this.serializer),this.hu(t)},el.prototype.Pu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.hu(n)},el),Wf=(n(tl,Uf=function(){this.je=void 0}),tl.prototype.bu=function(){if(this.pu)throw new Gr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},tl.prototype.vu=function(e,n){var r=this;return this.bu(),this.credentials.getToken().then(function(t){return r.Ja.vu(e,n,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.Ba(),t})},tl.prototype.Su=function(e,n){var r=this;return this.bu(),this.credentials.getToken().then(function(t){return r.Ja.Su(e,n,t)}).catch(function(t){throw t.code===zr.UNAUTHENTICATED&&r.credentials.Ba(),t})},tl),$f=(Zf.prototype.ku=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.xu(),0<this.mutations.length)throw new Gr(zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e={database:jo((i=s).serializer),documents:u.map(function(t){return Co(i.serializer,t)})},[4,i.Su("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Nr(!!e.found),e.found.name,e.found.updateTime;var n=Vo(t,e.found.name),r=ko(e.found.updateTime),i=new qs({mapValue:{fields:e.found.fields}});return new Js(n,r,i,{})}(e,n):"missing"in n?function(t,e){Nr(!!e.missing),Nr(!!e.readTime);var n=Vo(t,e.missing),r=ko(e.readTime);return new Zs(n,r)}(e,n):Ar());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Nr(!!e),r.push(e)}),r)]}})})}(this.Du,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Zs||t instanceof Js?n.Mu(t):Ar()}),e)]}})})},Zf.prototype.set=function(t,e){this.write(e.pa(t,this.Ue(t))),this.$u.add(t)},Zf.prototype.update=function(t,e){try{this.write(e.pa(t,this.Ou(t)))}catch(t){this.Nu=t}this.$u.add(t)},Zf.prototype.delete=function(t){this.write([new js(t,this.Ue(t))]),this.$u.add(t)},Zf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:if(this.xu(),this.Nu)throw this.Nu;return e=this.Cu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Yr($r.$(e));r.mutations.push(new Fs(n,r.Ue(n)))}),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return n={database:jo((e=r).serializer),writes:i.map(function(t){return Bo(e.serializer,t)})},[4,e.vu("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Du,this.mutations)];case 1:return t.sent(),this.Fu=!0,[2]}})})},Zf.prototype.Mu=function(t){var e;if(t instanceof Js)e=t.version;else{if(!(t instanceof Zs))throw Ar();e=Hr.min()}var n=this.Cu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(zr.ABORTED,"Document version changed between two reads.")}else this.Cu.set(t.key.toString(),e)},Zf.prototype.Ue=function(t){var e=this.Cu.get(t.toString());return!this.$u.has(t)&&e?ws.updateTime(e):ws.Qe()},Zf.prototype.Ou=function(t){var e=this.Cu.get(t.toString());if(this.$u.has(t)||!e)return ws.exists(!0);if(e.isEqual(Hr.min()))throw new Gr(zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(e)},Zf.prototype.write=function(t){this.xu(),this.mutations=this.mutations.concat(t)},Zf.prototype.xu=function(){},Zf),Kf=(Jf.prototype.Qu=function(){var t=this;0===this.Bu&&(this.Wu("Unknown"),this.qu=this.mo.Os("online_state_timeout",1e4,function(){return t.qu=null,t.ju("Backend didn't respond within 10 seconds."),t.Wu("Offline"),Promise.resolve()}))},Jf.prototype.Ku=function(t){"Online"===this.state?this.Wu("Unknown"):(this.Bu++,1<=this.Bu&&(this.Gu(),this.ju("Connection failed 1 times. Most recent error: "+t.toString()),this.Wu("Offline")))},Jf.prototype.set=function(t){this.Gu(),this.Bu=0,"Online"===t&&(this.Uu=!1),this.Wu(t)},Jf.prototype.Wu=function(t){t!==this.state&&(this.state=t,this.Lu(t))},Jf.prototype.ju=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Uu?(Tr(e),this.Uu=!1):Er("OnlineStateTracker",e)},Jf.prototype.Gu=function(){null!==this.qu&&(this.qu.cancel(),this.qu=null)},Jf),Xf=(Yf.prototype.start=function(){return this.enableNetwork()},Yf.prototype.enableNetwork=function(){return this.Xu.delete(0),this._c()},Yf.prototype._c=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ec()?(this.fc()?this.dc():this.sc.set("Unknown"),[4,this.wc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yf.prototype.disableNetwork=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Xu.add(0),[4,this.Tc()];case 1:return t.sent(),this.sc.set("Offline"),[2]}})})},Yf.prototype.Tc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.ac.stop()];case 1:return t.sent(),[4,this.ic.stop()];case 2:return t.sent(),0<this.Hu.length&&(Er("RemoteStore","Stopping write stream with "+this.Hu.length+" pending writes"),this.Hu=[]),this.Ec(),[2]}})})},Yf.prototype.gr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Er("RemoteStore","RemoteStore shutting down."),this.Xu.add(5),[4,this.Tc()];case 1:return t.sent(),this.Zu.gr(),this.sc.set("Unknown"),[2]}})})},Yf.prototype.listen=function(t){this.Yu.has(t.targetId)||(this.Yu.set(t.targetId,t),this.fc()?this.dc():this.ic.nu()&&this.Ic(t))},Yf.prototype.mc=function(t){this.Yu.delete(t),this.ic.nu()&&this.Ac(t),0===this.Yu.size&&(this.ic.nu()?this.ic.ru():this.ec()&&this.sc.set("Unknown"))},Yf.prototype.Me=function(t){return this.Yu.get(t)||null},Yf.prototype.xe=function(t){return this.Rc.xe(t)},Yf.prototype.Ic=function(t){this.Ju.de(t.targetId),this.ic.Iu(t)},Yf.prototype.Ac=function(t){this.Ju.de(t),this.ic.mu(t)},Yf.prototype.dc=function(){this.Ju=new Ki(this),this.ic.start(),this.sc.Qu()},Yf.prototype.fc=function(){return this.ec()&&!this.ic.eu()&&0<this.Yu.size},Yf.prototype.ec=function(){return 0===this.Xu.size},Yf.prototype.Ec=function(){this.Ju=null},Yf.prototype.rc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){return this.Yu.forEach(function(t,e){n.Ic(t)}),[2]})})},Yf.prototype.oc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Ec(),this.fc()?(this.sc.Ku(e),this.dc()):this.sc.set("Unknown"),[2]})})},Yf.prototype.hc=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:if(this.sc.set("Online"),!(i instanceof Bi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Pc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Vc(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Fi?this.Ju.Pe(i):i instanceof qi?this.Ju.De(i):this.Ju.ye(i),o.isEqual(Hr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.zu.mi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.gc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Vc(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Yf.prototype.Vc=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!xh(n))throw n;return this.Xu.add(1),[4,this.Tc()];case 1:return t.sent(),this.sc.set("Offline"),r=r||function(){return e.zu.mi()},this.mo._r(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Xu.delete(1),[4,this._c()];case 2:return t.sent(),[2]}})})}),[2]}})})},Yf.prototype.yc=function(e){var n=this;return e().catch(function(t){return n.Vc(t,e)})},Yf.prototype.gc=function(r){var i=this,t=this.Ju.Ne(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.H()&&((n=i.Yu.get(e))&&i.Yu.set(e,n.tt(t.resumeToken,r)))}),t.Wt.forEach(function(t){var e,n=i.Yu.get(t);n&&(i.Yu.set(t,n.tt(di.Y,n.X)),i.Ac(t),e=new wi(n.target,t,1,n.sequenceNumber),i.Ic(e))}),this.Rc.Lh(t)},Yf.prototype.Pc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Yu.has(i)?[4,this.Rc.pc(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Yu.delete(i),this.Ju.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Yf.prototype.wc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=0<this.Hu.length?this.Hu[this.Hu.length-1].batchId:-1,t.label=1;case 1:if(!this.bc())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.zu.Qh(e)];case 3:return null===(n=t.sent())?(0===this.Hu.length&&this.ac.ru(),[3,7]):(e=n.batchId,this.vc(n),[3,6]);case 4:return r=t.sent(),[4,this.Vc(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Sc()&&this.Dc(),[2]}})})},Yf.prototype.bc=function(){return this.ec()&&this.Hu.length<10},Yf.prototype.Cc=function(){return this.Hu.length},Yf.prototype.vc=function(t){this.Hu.push(t),this.ac.nu()&&this.ac.Ru&&this.ac.Pu(t.mutations)},Yf.prototype.Sc=function(){return this.ec()&&!this.ac.eu()&&0<this.Hu.length},Yf.prototype.Dc=function(){this.ac.start()},Yf.prototype.uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ac.yu(),[2]})})},Yf.prototype.lc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){for(e=0,n=this.Hu;e<n.length;e++)r=n[e],this.ac.Pu(r.mutations);return[2]})})},Yf.prototype.Vu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Hu.shift(),n=Vu.from(e,i,o),[4,this.yc(function(){return r.Rc.Fc(n)})];case 1:return t.sent(),[4,this.wc()];case 2:return t.sent(),[2]}})})},Yf.prototype.cc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e&&this.ac.Ru?[4,this.Nc(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Sc()&&this.Dc(),[2]}})})},Yf.prototype.Nc=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return Ii(n=i.code)&&n!==zr.ABORTED?(e=this.Hu.shift(),this.ac.iu(),[4,this.yc(function(){return r.Rc.$c(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.wc()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Yf.prototype.kc=function(){return new $f(this.Du)},Yf.prototype.nc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Xu.add(4),[4,this.Tc()];case 1:return t.sent(),this.sc.set("Unknown"),this.ac.iu(),this.ic.iu(),this.Xu.delete(4),[4,this._c()];case 2:return t.sent(),[2]}})})},Yf.prototype.xc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.mo.Wo(),Er("RemoteStore","RemoteStore received new credentials"),this.Xu.add(3),[4,this.Tc()];case 1:return t.sent(),this.sc.set("Unknown"),[4,this.Rc.xc(e)];case 2:return t.sent(),this.Xu.delete(3),[4,this._c()];case 3:return t.sent(),[2]}})})},Yf.prototype.Mc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(this.Xu.delete(2),[4,this._c()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Xu.add(2),[4,this.Tc()]);case 3:t.sent(),this.sc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Yf);function Yf(t,e,n,r,i){var o,s,u,a,h,c,f=this;this.zu=t,this.Du=e,this.mo=n,this.Hu=[],this.Yu=new Map,this.Ju=null,this.Xu=new Set,this.Zu=i,this.Zu.tc(function(t){n.cr(function(){return y(f,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ec()?(Er("RemoteStore","Restarting streams for network reachability change."),[4,this.nc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.sc=new Kf(n,r),this.ic=(a=this.Du,h=n,c={wu:this.rc.bind(this),cu:this.oc.bind(this),Eu:this.hc.bind(this)},new Qf(h,a.Ja,a.credentials,a.serializer,c)),this.ac=(o=this.Du,s=n,u={wu:this.uc.bind(this),cu:this.cc.bind(this),gu:this.lc.bind(this),Vu:this.Vu.bind(this)},new Hf(s,o.Ja,o.credentials,o.serializer,u))}function Jf(t,e){this.mo=t,this.Lu=e,this.state="Unknown",this.Bu=0,this.qu=null,this.Uu=!0}function Zf(t){this.Du=t,this.Cu=new Map,this.mutations=[],this.Fu=!1,this.Nu=null,this.$u=new Set}function tl(t,e,n){var r=this;return(r=Uf.call(this)||this).Ja=t,r.credentials=e,r.serializer=n,r.pu=!1,r}function el(t,e,n,r,i){var o=this;return(o=Mf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Au=!1,o}function nl(t,e,n,r,i){var o=this;return(o=jf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function rl(t,e,n,r,i,o){this.bs=t,this.Ya=n,this.Ja=r,this.Xa=i,this.listener=o,this.state=0,this.Za=0,this.tu=null,this.stream=null,this.$o=new Zu(t,e)}function il(t,e){this.Ga=t,this.za=e}function ol(t,e){this.Ga=t,this.za=e,this.type="FirstParty",this.user=Rf.Ma}function sl(t){var e=this;this.Qa=null,this.currentUser=Rf.UNAUTHENTICATED,this.Wa=!1,this.ja=0,this.La=null,this.forceRefresh=!1,this.Qa=function(){e.ja++,e.currentUser=e.Ka(),e.Wa=!0,e.La&&e.La(e.currentUser)},this.ja=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qa):(this.Qa(null),t.get().then(function(t){e.auth=t,e.Qa&&e.auth.addAuthTokenListener(e.Qa)},function(){}))}function ul(){this.La=null}function al(t,e){return"firestore_clients_"+t+"_"+e}function hl(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.zr()&&(r+="_"+e.uid),r}function cl(t,e){return"firestore_targets_"+t+"_"+e}function fl(t){this.key=t}function ll(t){this.key=t}function pl(t,e,n){this.query=t,this.targetId=e,this.view=n}function dl(t){this.key=t,this.Xl=!1}var yl=(Rl.Oc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Gr(r.error.code,r.error.message)),i?new Rl(t,e,r.state,o):(Tr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Rl.prototype.Lc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rl),vl=(Ll.Oc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Gr(n.error.code,n.error.message)),r?new Ll(t,n.state,i):(Tr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Ll.prototype.Lc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Ll),gl=(kl.Oc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ji,o=0;r&&o<n.activeTargetIds.length;++o)r=ai(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new kl(t,i):(Tr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},kl),ml=(Ol.Oc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Ol(e.clientId,e.onlineState):(Tr("SharedClientState","Failed to parse online state: "+t),null)},Ol),wl=(Pl.prototype.Bc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Pl.prototype.qc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Pl.prototype.Lc=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Pl),bl=(xl.Hi=function(t){return!(!t||!t.localStorage)},xl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.Rc.Sr()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Uc&&(o=this.getItem(al(this.persistenceKey,i)))&&(s=gl.Oc(i,o))&&(this.jc=this.jc.nt(s.clientId,s));for(this.Zc(),(u=this.storage.getItem(this.Xc))&&(a=this.tl(u))&&this.el(a),h=0,c=this.Kc;h<c.length;h++)f=c[h],this.Wc(f);return this.Kc=[],this.window.addEventListener("unload",function(){return l.gr()}),this.or=!0,[2]}})})},xl.prototype.ys=function(t){this.setItem(this.zc,JSON.stringify(t))},xl.prototype.nl=function(){return this.sl(this.jc)},xl.prototype.il=function(n){var r=!1;return this.jc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},xl.prototype.rl=function(t){this.ol(t,"pending")},xl.prototype.hl=function(t,e,n){this.ol(t,e,n),this.al(t)},xl.prototype.ul=function(t){var e,n,r="not-current";return this.il(t)&&(!(e=this.storage.getItem(cl(this.persistenceKey,t)))||(n=vl.Oc(t,e))&&(r=n.state)),this.cl.Bc(t),this.Zc(),r},xl.prototype.ll=function(t){this.cl.qc(t),this.Zc()},xl.prototype._l=function(t){return this.cl.activeTargetIds.has(t)},xl.prototype.fl=function(t){this.removeItem(cl(this.persistenceKey,t))},xl.prototype.dl=function(t,e,n){this.wl(t,e,n)},xl.prototype.Ch=function(t,e,n){var r=this;e.forEach(function(t){r.al(t)}),this.currentUser=t,n.forEach(function(t){r.rl(t)})},xl.prototype.Tl=function(t){this.El(t)},xl.prototype.gr=function(){this.or&&(this.window.removeEventListener("storage",this.Qc),this.removeItem(this.Gc),this.or=!1)},xl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Er("SharedClientState","READ",t,e),e},xl.prototype.setItem=function(t,e){Er("SharedClientState","SET",t,e),this.storage.setItem(t,e)},xl.prototype.removeItem=function(t){Er("SharedClientState","REMOVE",t),this.storage.removeItem(t)},xl.prototype.Wc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Er("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Gc)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.bs._r(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){if(this.or){if(null!==u.key)if(this.Hc.test(u.key)){if(null==u.newValue)return e=this.Il(u.key),[2,this.ml(e,null)];if(n=this.Al(u.key,u.newValue))return[2,this.ml(n.clientId,n)]}else if(this.Yc.test(u.key)){if(null!==u.newValue&&(r=this.Rl(u.key,u.newValue)))return[2,this.Pl(r)]}else if(this.Jc.test(u.key)){if(null!==u.newValue&&(i=this.Vl(u.key,u.newValue)))return[2,this.gl(i)]}else if(u.key===this.Xc){if(null!==u.newValue&&(o=this.tl(u.newValue)))return[2,this.el(o)]}else u.key===this.zc&&(s=function(t){var e=zu.ps;if(null!=t)try{var n=JSON.parse(t);Nr("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==zu.ps&&this.Ps(s)}else this.Kc.push(u);return[2]})})})}},Object.defineProperty(xl.prototype,"cl",{get:function(){return this.jc.get(this.Uc)},enumerable:!1,configurable:!0}),xl.prototype.Zc=function(){this.setItem(this.Gc,this.cl.Lc())},xl.prototype.ol=function(t,e,n){var r=new yl(this.currentUser,t,e,n),i=hl(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Lc())},xl.prototype.al=function(t){var e=hl(this.persistenceKey,this.currentUser,t);this.removeItem(e)},xl.prototype.El=function(t){var e={clientId:this.Uc,onlineState:t};this.storage.setItem(this.Xc,JSON.stringify(e))},xl.prototype.wl=function(t,e,n){var r=cl(this.persistenceKey,t),i=new vl(t,e,n);this.setItem(r,i.Lc())},xl.prototype.Il=function(t){var e=this.Hc.exec(t);return e?e[1]:null},xl.prototype.Al=function(t,e){var n=this.Il(t);return gl.Oc(n,e)},xl.prototype.Rl=function(t,e){var n=this.Yc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return yl.Oc(new Rf(i),r,e)},xl.prototype.Vl=function(t,e){var n=this.Jc.exec(t),r=Number(n[1]);return vl.Oc(r,e)},xl.prototype.tl=function(t){return ml.Oc(t)},xl.prototype.Pl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Rc.yl(e.batchId,e.state,e.error)]:(Er("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},xl.prototype.gl=function(t){return this.Rc.pl(t.targetId,t.state,t.error)},xl.prototype.ml=function(t,e){var n=this,r=e?this.jc.nt(t,e):this.jc.remove(t),i=this.sl(this.jc),o=this.sl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Rc.bl(s,u).then(function(){n.jc=r})},xl.prototype.el=function(t){this.jc.get(t.clientId)&&this.Lu(t.onlineState)},xl.prototype.sl=function(t){var n=ji;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},xl),Il=(Dl.prototype.rl=function(t){},Dl.prototype.hl=function(t,e,n){},Dl.prototype.ul=function(t){return this.vl.Bc(t),this.Sl[t]||"not-current"},Dl.prototype.dl=function(t,e,n){this.Sl[t]=e},Dl.prototype.ll=function(t){this.vl.qc(t)},Dl.prototype._l=function(t){return this.vl.activeTargetIds.has(t)},Dl.prototype.fl=function(t){delete this.Sl[t]},Dl.prototype.nl=function(){return this.vl.activeTargetIds},Dl.prototype.il=function(t){return this.vl.activeTargetIds.has(t)},Dl.prototype.start=function(){return this.vl=new wl,Promise.resolve()},Dl.prototype.Ch=function(t,e,n){},Dl.prototype.Tl=function(t){},Dl.prototype.gr=function(){},Dl.prototype.ys=function(t){},Dl),El=(Object.defineProperty(Sl.prototype,"kl",{get:function(){return this.Dl},enumerable:!1,configurable:!0}),Sl.prototype.xl=function(t,e){var u=this,a=e?e.Ml:new Gi,h=e?e.$l:this.$l,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.In()&&h.size===this.query.limit?h.last():null,d=this.query.mn()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof Js?e:null)&&(hu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ge||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Ol(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Nl(r,p)||d&&u.Nl(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.In()||this.query.mn())for(;f.size>this.query.limit;){var n=this.query.In()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{$l:f,Ml:a,Ll:l,Lt:c}},Sl.prototype.Ol=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Sl.prototype.Jn=function(t,e,n){var o=this,r=this.$l;this.$l=t.$l,this.Lt=t.Lt;var i=t.Ml.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Nl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ar()}}var r,i}),this.Bl(n);var s=e?this.ql():[],u=0===this.Fl.size&&this.Ht?1:0,a=u!==this.Cl;return this.Cl=u,0!==i.length||a?{snapshot:new Qi(this.query,t.$l,r,i,t.Lt,0==u,a,!1),Ul:s}:{Ul:s}},Sl.prototype.Ql=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Jn({$l:this.$l,Ml:new Gi,Lt:this.Lt,Ll:!1},!1)):{Ul:[]}},Sl.prototype.Wl=function(t){return!this.Dl.has(t)&&!!this.$l.has(t)&&!this.$l.get(t).Ge},Sl.prototype.Bl=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Dl=e.Dl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Dl=e.Dl.delete(t)}),this.Ht=t.Ht)},Sl.prototype.ql=function(){var e=this;if(!this.Ht)return[];var n=this.Fl;this.Fl=Mi(),this.$l.forEach(function(t){e.Wl(t.key)&&(e.Fl=e.Fl.add(t.key))});var r=[];return n.forEach(function(t){e.Fl.has(t)||r.push(new ll(t))}),this.Fl.forEach(function(t){n.has(t)||r.push(new fl(t))}),r},Sl.prototype.jl=function(t){this.Dl=t.zh,this.Fl=Mi();var e=this.xl(t.documents);return this.Jn(e,!0)},Sl.prototype.Kl=function(){return Qi.Ut(this.query,this.$l,this.Lt,0===this.Cl)},Sl),Tl=(Nl.prototype.run=function(){this.zl()},Nl.prototype.zl=function(){var t=this;this.$o.xs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new $f(this.Du),(n=this.Hl(e))&&n.then(function(t){r.mo.cr(function(){return e.commit().then(function(){r.Po.resolve(t)}).catch(function(t){r.Yl(t)})})}).catch(function(t){r.Yl(t)}),[2]})})})},Nl.prototype.Hl=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.Po.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Po.reject(t),null}},Nl.prototype.Yl=function(t){var e=this;0<this.Gl&&this.Jl(t)?(--this.Gl,this.mo.cr(function(){return e.zl(),Promise.resolve()})):this.Po.reject(t)},Nl.prototype.Jl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ii(e)},Nl),_l=(Object.defineProperty(Al.prototype,"__",{get:function(){return!0},enumerable:!1,configurable:!0}),Al.prototype.subscribe=function(t){this.n_=t},Al.prototype.listen=function(s){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return this.f_("listen()"),(r=this.s_.get(s))?(e=r.targetId,this.t_.ul(e),n=r.view.Kl(),[3,4]):[3,1];case 1:return[4,this.zu.jh(s.We())];case 2:return i=t.sent(),o=this.t_.ul(i.targetId),e=i.targetId,[4,this.d_(s,e,"current"===o)];case 3:n=t.sent(),this.__&&this.Zl.listen(i),t.label=4;case 4:return[2,n]}})})},Al.prototype.d_=function(u,a,h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.zu.Gh(u,!0)];case 1:return e=t.sent(),n=new El(u,e.zh),r=n.xl(e.documents),i=Wi.zt(a,h&&"Offline"!==this.onlineState),o=n.Jn(r,this.__,i),this.w_(a,o.Ul),s=new pl(u,a,n),[2,(this.s_.set(u,s),this.i_.has(a)?this.i_.get(a).push(u):this.i_.set(a,[u]),o.snapshot)]}})})},Al.prototype.mc=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return this.f_("unlisten()"),e=this.s_.get(i),1<(n=this.i_.get(e.targetId)).length?[2,(this.i_.set(e.targetId,n.filter(function(t){return!su(t,i)})),void this.s_.delete(i))]:this.__?(this.t_.ll(e.targetId),this.t_.il(e.targetId)?[3,2]:[4,this.zu.Kh(e.targetId,!1).then(function(){r.t_.fl(e.targetId),r.Zl.mc(e.targetId),r.T_(e.targetId)}).catch(oc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.T_(e.targetId),[4,this.zu.Kh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Al.prototype.write=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:this.f_("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.zu.kh(i)];case 2:return e=t.sent(),this.t_.rl(e.batchId),this.E_(e.batchId,o),[4,this.I_(e.Un)];case 3:return t.sent(),[4,this.Zl.wc()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Bh(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Al.prototype.runTransaction=function(t,e,n){new Tl(t,this.Du,e,n).run()},Al.prototype.Lh=function(n){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:this.f_("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.zu.Lh(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.h_.get(e);n&&(Nr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Xl=!0:0<t.Jt.size?Nr(n.Xl):0<t.Xt.size&&(Nr(n.Xl),n.Xl=!1))}),[4,this.I_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Al.prototype.Ql=function(r,t){this.f_("applyOnlineStateChange()");var i=[];this.s_.forEach(function(t,e){var n=e.view.Ql(r);n.snapshot&&i.push(n.snapshot)}),this.n_.m_(r),this.n_.Eu(i),this.onlineState=r},Al.prototype.pc=function(u,a){return y(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.f_("rejectListens()"),this.t_.dl(u,"rejected",a),e=this.h_.get(u),(n=e&&e.key)?(r=(r=new Ti(Yr.P)).nt(n,new Zs(n,Hr.min())),i=Mi().add(n),o=new Hi(Hr.min(),new Map,new Pi(Pr),r,i),[4,this.Lh(o)]):[3,2];case 1:return t.sent(),this.o_=this.o_.remove(n),this.h_.delete(u),this.A_(),[3,4];case 2:return[4,this.zu.Kh(u,!1).then(function(){return s.T_(u,a)}).catch(oc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Al.prototype.Fc=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.f_("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.zu.xh(r)];case 2:return n=t.sent(),this.R_(e,null),this.P_(e),this.t_.hl(e,"acknowledged"),[4,this.I_(n)];case 3:return t.sent(),[3,6];case 4:return[4,oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Al.prototype.$c=function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.f_("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.zu.Oh(n)];case 2:return e=t.sent(),this.R_(n,r),this.P_(n),this.t_.hl(n,"rejected",r),[4,this.I_(e)];case 3:return t.sent(),[3,6];case 4:return[4,oc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Al.prototype.V_=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:this.Zl.ec()||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.zu.to()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.c_.get(e)||[]).push(o),this.c_.set(e,n),[3,4]);case 3:return r=t.sent(),i=Bh(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Al.prototype.P_=function(t){(this.c_.get(t)||[]).forEach(function(t){t.resolve()}),this.c_.delete(t)},Al.prototype.g_=function(e){this.c_.forEach(function(t){t.forEach(function(t){t.reject(new Gr(zr.CANCELLED,e))})}),this.c_.clear()},Al.prototype.E_=function(t,e){var n=(n=(n=this.u_[this.currentUser.ka()])||new Ti(Pr)).nt(t,e);this.u_[this.currentUser.ka()]=n},Al.prototype.R_=function(t,e){var n,r=this.u_[this.currentUser.ka()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.u_[this.currentUser.ka()]=r)},Al.prototype.T_=function(t,e){var n=this;void 0===e&&(e=null),this.t_.ll(t);for(var r=0,i=this.i_.get(t);r<i.length;r++){var o=i[r];this.s_.delete(o),e&&this.n_.y_(o,e)}this.i_.delete(t),this.__&&this.a_.oa(t).forEach(function(t){n.a_.Mi(t)||n.p_(t)})},Al.prototype.p_=function(t){var e=this.o_.get(t);null!==e&&(this.Zl.mc(e),this.o_=this.o_.remove(t),this.h_.delete(e),this.A_())},Al.prototype.w_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof fl?(this.a_.Fi(i.key,t),this.b_(i)):i instanceof ll?(Er("SyncEngine","Document no longer in limbo: "+i.key),this.a_.$i(i.key,t),this.a_.Mi(i.key)||this.p_(i.key)):Ar()}},Al.prototype.b_=function(t){var e=t.key;this.o_.get(e)||(Er("SyncEngine","New document in limbo: "+e),this.r_.push(e),this.A_())},Al.prototype.A_=function(){for(;0<this.r_.length&&this.o_.size<this.e_;){var t=this.r_.shift(),e=this.l_.next();this.h_.set(e,new dl(t)),this.o_=this.o_.nt(t,e),this.Zl.listen(new wi(eu.hn(t.path).We(),e,2,zu.ps))}},Al.prototype.v_=function(){return this.o_},Al.prototype.S_=function(){return this.r_},Al.prototype.I_=function(r,a){return y(this,void 0,void 0,function(){var o,s,e,u=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.s_.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.xl(r);return n.Ll?u.zu.Gh(i.query,!1).then(function(t){var e=t.documents;return i.view.xl(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.Jn(t,u.__,n);u.w_(i.targetId,r.Ul),r.snapshot&&(u.__&&u.t_.dl(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Bu.Rs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.n_.Eu(o),[4,this.zu.Uh(s)];case 2:return t.sent(),[2]}})})},Al.prototype.f_=function(t){},Al.prototype.xc=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Er("SyncEngine","User change. New user:",n.ka()),[4,this.zu.Ch(n)]);case 1:return e=t.sent(),this.currentUser=n,this.g_("'waitForPendingWrites' promise is rejected due to a user change."),this.t_.Ch(n,e.Nh,e.$h),[4,this.I_(e.Fh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Al.prototype.enableNetwork=function(){return this.Zl.enableNetwork()},Al.prototype.disableNetwork=function(){return this.Zl.disableNetwork()},Al.prototype.xe=function(t){var e=this.h_.get(t);if(e&&e.Xl)return Mi().add(e.key);var n=Mi(),r=this.i_.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.s_.get(s),n=n.Ct(u.view.kl);return n},Al);function Al(t,e,n,r,i,o){this.zu=t,this.Zl=e,this.Du=n,this.t_=r,this.currentUser=i,this.e_=o,this.n_=null,this.s_=new Br(uu,su),this.i_=new Map,this.r_=[],this.o_=new Ti(Yr.P),this.h_=new Map,this.a_=new sc,this.u_={},this.c_=new Map,this.l_=Pa.di(),this.onlineState="Unknown"}function Nl(t,e,n,r){this.mo=t,this.Du=e,this.updateFunction=n,this.Po=r,this.Gl=5,this.$o=new Zu(this.mo,"transaction_retry")}function Sl(t,e){this.query=t,this.Dl=e,this.Cl=null,this.Ht=!1,this.Fl=Mi(),this.Lt=Mi(),this.Nl=cu(t),this.$l=new zi(this.Nl)}function Dl(){this.vl=new wl,this.Sl={},this.Rc=null,this.Lu=null,this.Ps=null}function xl(t,e,n,r,i){this.window=t,this.bs=e,this.persistenceKey=n,this.Uc=r,this.Rc=null,this.Lu=null,this.Ps=null,this.Qc=this.Wc.bind(this),this.jc=new Ti(Pr),this.or=!1,this.Kc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Gc=al(this.persistenceKey,this.Uc),this.zc="firestore_sequence_number_"+this.persistenceKey,this.jc=this.jc.nt(this.Uc,new wl),this.Hc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Yc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Jc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Xc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Qc)}function Pl(){this.activeTargetIds=ji}function Ol(t,e){this.clientId=t,this.onlineState=e}function kl(t,e){this.clientId=t,this.activeTargetIds=e}function Ll(t,e,n){this.targetId=t,this.state=e,this.error=n}function Rl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Cl(t,e,n,r,i,o){return new _l(t,e,n,r,i,o)}function Vl(){this.x_=void 0,this.listeners=[]}var Ul,Ml,jl=(n(Xl,Ul=_l),Object.defineProperty(Xl.prototype,"__",{get:function(){return!0===this.D_},enumerable:!1,configurable:!0}),Xl.prototype.enableNetwork=function(){return this.zu.ur(!0),Ul.prototype.enableNetwork.call(this)},Xl.prototype.disableNetwork=function(){return this.zu.ur(!1),Ul.prototype.disableNetwork.call(this)},Xl.prototype.C_=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.zu.Gh(r.query,!0)];case 1:return e=t.sent(),n=r.view.jl(e),[2,(this.D_&&this.w_(r.targetId,n.Ul),n)]}})})},Xl.prototype.Ql=function(t,e){this.__&&0===e&&(Ul.prototype.Ql.call(this,t,e),this.t_.Tl(t)),this.__||1!==e||Ul.prototype.Ql.call(this,t,e)},Xl.prototype.yl=function(n,r,i){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.f_("applyBatchState()"),[4,this.zu.Yh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.Zl.wc()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.R_(n,i||null),this.zu.Jh(n)):Ar(),t.label=4;case 4:return[4,this.I_(e)];case 5:return t.sent(),[3,7];case 6:Er("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Xl.prototype.Mc=function(h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.D_?[3,3]:(e=this.t_.nl(),[4,this.F_(e.F(),!0)]);case 1:return n=t.sent(),this.D_=!0,[4,this.Zl.Mc(!0)];case 2:for(t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.Zl.listen(o);return[3,7];case 3:return!1!==h||!1===this.D_?[3,7]:(s=[],u=Promise.resolve(),this.i_.forEach(function(t,e){a.t_._l(e)?s.push(e):u=u.then(function(){return a.T_(e),a.zu.Kh(e,!0)}),a.Zl.mc(e)}),[4,u]);case 4:return t.sent(),[4,this.F_(s,!1)];case 5:return t.sent(),this.N_(),this.D_=!1,[4,this.Zl.Mc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Xl.prototype.N_=function(){var n=this;this.h_.forEach(function(t,e){n.Zl.mc(e)}),this.a_.ha(),this.h_=new Map,this.o_=new Ti(Yr.P)},Xl.prototype.F_=function(d,t){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.i_.get(o))&&0!==u.length?[4,this.zu.jh(u[0].We())]:[3,7]):[3,13];case 2:s=t.sent(),a=0,h=u,t.label=3;case 3:return a<h.length?(c=h[a],f=this.s_.get(c),[4,this.C_(f)]):[3,6];case 4:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=5;case 5:return a++,[3,3];case 6:return[3,11];case 7:return[4,this.zu.Xh(o)];case 8:return p=t.sent(),[4,this.zu.jh(p)];case 9:return s=t.sent(),[4,this.d_(this.k_(p),o,!1)];case 10:t.sent(),t.label=11;case 11:e.push(s),t.label=12;case 12:return r++,[3,1];case 13:return[2,(this.n_.Eu(n),e)]}})})},Xl.prototype.k_=function(t){return new eu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Xl.prototype.Sr=function(){return this.zu.Sr()},Xl.prototype.pl=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.D_?(Er("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.i_.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.zu.si()];case 3:return e=t.sent(),n=Hi.Gt(r,"current"===i),[4,this.I_(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.zu.Kh(r,!0)];case 6:return t.sent(),this.T_(r,o),[3,8];case 7:Ar(),t.label=8;case 8:return[2]}})})},Xl.prototype.bl=function(l,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return v(this,function(t){switch(t.label){case 0:if(!this.D_)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.i_.has(r)?(Er("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.zu.Xh(r)]):[3,6];case 2:return i=t.sent(),[4,this.zu.jh(i)];case 3:return o=t.sent(),[4,this.d_(this.k_(i),o.targetId,!1)];case 4:t.sent(),this.Zl.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return u.i_.has(e)?[4,u.zu.Kh(e,!1).then(function(){f.Zl.mc(e),f.T_(e)}).catch(oc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Xl),Fl=(Kl.prototype.listen=function(u){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.M_.get(e))||(n=!0,r=new Vl),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Rc.listen(e)];case 2:return i.x_=t.sent(),[3,4];case 3:return o=t.sent(),s=Bh(o,"Initialization of query '"+au(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.M_.set(e,r),r.listeners.push(u),u.Ql(this.onlineState),r.x_&&u.L_(r.x_)&&this.B_(),[2]}})})},Kl.prototype.mc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){return e=o.query,n=!1,(r=this.M_.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.M_.delete(e),this.Rc.mc(e))]:[2]})})},Kl.prototype.Eu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.M_.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].L_(i)&&(e=!0);s.x_=i}}e&&this.B_()},Kl.prototype.y_=function(t,e){var n=this.M_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.M_.delete(t)},Kl.prototype.m_=function(i){this.onlineState=i;var o=!1;this.M_.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ql(i)&&(o=!0)}),o&&this.B_()},Kl.prototype.q_=function(t){this.O_.add(t),t.next()},Kl.prototype.U_=function(t){this.O_.delete(t)},Kl.prototype.B_=function(){this.O_.forEach(function(t){t.next()})},Kl),ql=($l.prototype.L_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Qi(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.Bt,!0)}var o=!1;return this.W_?this.K_(t)&&(this.Q_.next(t),o=!0):this.G_(t,this.onlineState)&&(this.z_(t),o=!0),this.j_=t,o},$l.prototype.onError=function(t){this.Q_.error(t)},$l.prototype.Ql=function(t){this.onlineState=t;var e=!1;return this.j_&&!this.W_&&this.G_(this.j_,t)&&(this.z_(this.j_),e=!0),e},$l.prototype.G_=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.H_&&n||t.docs._()&&"Offline"!==e)},$l.prototype.K_=function(t){if(0<t.docChanges.length)return!0;var e=this.j_&&this.j_.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},$l.prototype.z_=function(t){t=Qi.Ut(t.query,t.docs,t.Lt,t.fromCache),this.W_=!0,this.Q_.next(t)},$l),Bl=(Wl.prototype.Dh=function(t){this.Y_=t},Wl.prototype._s=function(e,r,i,o){var s=this;return r.En()||i.isEqual(Hr.min())?this.J_(e,r):this.Y_.us(e,o).next(function(t){var n=s.X_(r,t);return(r.In()||r.mn())&&s.Ll(r.nn,n,o,i)?s.J_(e,r):(Ir()<=p.DEBUG&&Er("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),au(r)),s.Y_._s(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Wl.prototype.X_=function(n,t){var r=new Pi(cu(n));return t.forEach(function(t,e){e instanceof Js&&hu(n,e)&&(r=r.add(e))}),r},Wl.prototype.Ll=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Wl.prototype.J_=function(t,e){return Ir()<=p.DEBUG&&Er("IndexFreeQueryEngine","Using full collection scan to execute query:",au(e)),this.Y_._s(t,e,Hr.min())},Wl),zl=(Hl.prototype.Hr=function(t){return Uu.resolve(0===this.ns.length)},Hl.prototype.Yr=function(t,e,n,r){var i=this.Z_;this.Z_++,0<this.ns.length&&this.ns[this.ns.length-1];var o=new Cu(i,e,n,r);this.ns.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.tf=this.tf.add(new uc(a.key,i)),this.ss.Us(t,a.key.path.p())}return Uu.resolve(o)},Hl.prototype.Jr=function(t,e){return Uu.resolve(this.ef(e))},Hl.prototype.Zr=function(t,e){var n=e+1,r=this.nf(n),i=r<0?0:r;return Uu.resolve(this.ns.length>i?this.ns[i]:null)},Hl.prototype.to=function(){return Uu.resolve(0===this.ns.length?-1:this.Z_-1)},Hl.prototype.eo=function(t){return Uu.resolve(this.ns.slice())},Hl.prototype.os=function(t,e){var n=this,r=new uc(e,0),i=new uc(e,Number.POSITIVE_INFINITY),o=[];return this.tf.vt([r,i],function(t){var e=n.ef(t.ua);o.push(e)}),Uu.resolve(o)},Hl.prototype.ls=function(t,e){var r=this,i=new Pi(Pr);return e.forEach(function(t){var e=new uc(t,0),n=new uc(t,Number.POSITIVE_INFINITY);r.tf.vt([e,n],function(t){i=i.add(t.ua)})}),Uu.resolve(this.sf(i))},Hl.prototype.Es=function(t,e){var n=e.path,r=n.length+1,i=n;Yr.W(i)||(i=i.child(""));var o=new uc(new Yr(i),0),s=new Pi(Pr);return this.tf.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.ua)),!0)},o),Uu.resolve(this.sf(s))},Hl.prototype.sf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.ef(t);null!==e&&r.push(e)}),r},Hl.prototype.so=function(n,r){var i=this;Nr(0===this.if(r.batchId,"removed")),this.ns.shift();var o=this.tf;return Uu.forEach(r.mutations,function(t){var e=new uc(t.key,r.batchId);return o=o.delete(e),i.wi.qr(n,t.key)}).next(function(){i.tf=o})},Hl.prototype.io=function(t){},Hl.prototype.Mi=function(t,e){var n=new uc(e,0),r=this.tf.Dt(n);return Uu.resolve(e.isEqual(r&&r.key))},Hl.prototype.ro=function(t){return this.ns.length,Uu.resolve()},Hl.prototype.if=function(t,e){return this.nf(t)},Hl.prototype.nf=function(t){return 0===this.ns.length?0:t-this.ns[0].batchId},Hl.prototype.ef=function(t){var e=this.nf(t);return e<0||e>=this.ns.length?null:this.ns[e]},Hl),Gl=(Ql.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rf(e);return this.docs=this.docs.nt(r,{Ys:e,size:s,readTime:n}),this.size+=s-o,this.ss.Us(t,r.path.p())},Ql.prototype.Gn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ql.prototype.zn=function(t,e){var n=this.docs.get(e);return Uu.resolve(n?n.Ys:null)},Ql.prototype.getEntries=function(t,e){var n=this,r=ki;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ys:null)}),Uu.resolve(r)},Ql.prototype._s=function(t,e,n){for(var r=Ci,i=new Yr(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ys,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof Js&&hu(e,h)&&(r=r.nt(h.key,h))}return Uu.resolve(r)},Ql.prototype.hf=function(t,e){return Uu.forEach(this.docs,function(t){return e(t)})},Ql.prototype.oi=function(t){return new Ql.hi(this)},Ql.prototype.ui=function(t){return Uu.resolve(this.size)},Ql);function Ql(t,e){this.ss=t,this.rf=e,this.docs=new Ti(Yr.P),this.size=0}function Hl(t,e){this.ss=t,this.wi=e,this.ns=[],this.Z_=1,this.tf=new Pi(uc.ta)}function Wl(){}function $l(t,e,n){this.query=t,this.Q_=e,this.W_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}function Kl(t){this.Rc=t,this.M_=new Br(uu,su),this.onlineState="Unknown",this.O_=new Set,this.Rc.subscribe(this)}function Xl(t,e,n,r,i,o){var s=this;return(s=Ul.call(this,t,e,n,r,i,o)||this).zu=t,s.D_=void 0,s}function Yl(t){var e=this;return(e=Ml.call(this)||this).ci=t,e}Gl.hi=(n(Yl,Ml=Mu),Yl.prototype.Jn=function(n){var r=this,i=[];return this.Un.forEach(function(t,e){e?i.push(r.ci.jn(n,e,r.readTime)):r.ci.Gn(t)}),Uu.Bn(i)},Yl.prototype.Hn=function(t,e){return this.ci.zn(t,e)},Yl.prototype.Yn=function(t,e){return this.ci.getEntries(t,e)},Yl);var Jl,Zl,tp,ep=(Dp.prototype.pe=function(t,n){return this.af.forEach(function(t,e){return n(e)}),Uu.resolve()},Dp.prototype.mi=function(t){return Uu.resolve(this.lastRemoteSnapshotVersion)},Dp.prototype.Ai=function(t){return Uu.resolve(this.uf)},Dp.prototype.Ti=function(t){return this.highestTargetId=this.lf.next(),Uu.resolve(this.highestTargetId)},Dp.prototype.Ri=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.uf&&(this.uf=e),Uu.resolve()},Dp.prototype.Vi=function(t){this.af.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.lf=new Pa(e),this.highestTargetId=e),t.sequenceNumber>this.uf&&(this.uf=t.sequenceNumber)},Dp.prototype.Pi=function(t,e){return this.Vi(e),this.targetCount+=1,Uu.resolve()},Dp.prototype.yi=function(t,e){return this.Vi(e),Uu.resolve()},Dp.prototype.pi=function(t,e){return this.af.delete(e.target),this.cf.oa(e.targetId),--this.targetCount,Uu.resolve()},Dp.prototype.vi=function(n,r,i){var o=this,s=0,u=[];return this.af.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.af.delete(t),u.push(o.bi(n,e.targetId)),s++)}),Uu.Bn(u).next(function(){return s})},Dp.prototype.Si=function(t){return Uu.resolve(this.targetCount)},Dp.prototype.Di=function(t,e){var n=this.af.get(e)||null;return Uu.resolve(n)},Dp.prototype.Ci=function(t,e,n){return this.cf.sa(e,n),Uu.resolve()},Dp.prototype.Ni=function(e,t,n){this.cf.ra(t,n);var r=this.persistence.wi,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),Uu.Bn(i)},Dp.prototype.bi=function(t,e){return this.cf.oa(e),Uu.resolve()},Dp.prototype.ki=function(t,e){var n=this.cf.aa(e);return Uu.resolve(n)},Dp.prototype.Mi=function(t,e){return Uu.resolve(this.cf.Mi(e))},Dp),np=(Sp.prototype.start=function(){return Promise.resolve()},Sp.prototype.gr=function(){return this.Qi=!1,Promise.resolve()},Object.defineProperty(Sp.prototype,"or",{get:function(){return this.Qi},enumerable:!1,configurable:!0}),Sp.prototype.hr=function(){},Sp.prototype.$r=function(){return this.ss},Sp.prototype.Dr=function(t){var e=this._f[t.ka()];return e||(e=new zl(this.ss,this.wi),this._f[t.ka()]=e),e},Sp.prototype.Fr=function(){return this.Ji},Sp.prototype.Nr=function(){return this.es},Sp.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new rp(this.Ui.next());return this.wi.df(),n(i).next(function(t){return r.wi.wf(i).next(function(){return t})}).On().then(function(t){return i.ts(),t})},Sp.prototype.Tf=function(e,n){return Uu.qn(Object.values(this._f).map(function(t){return function(){return t.Mi(e,n)}}))},Sp),rp=(n(Np,tp=Fu),Np),ip=(Ap.mf=function(t){return new Ap(t)},Object.defineProperty(Ap.prototype,"Af",{get:function(){if(this.If)return this.If;throw Ar()},enumerable:!1,configurable:!0}),Ap.prototype.Fi=function(t,e,n){return this.Ef.Fi(n,e),this.Af.delete(n),Uu.resolve()},Ap.prototype.$i=function(t,e,n){return this.Ef.$i(n,e),this.Af.add(n),Uu.resolve()},Ap.prototype.qr=function(t,e){return this.Af.add(e),Uu.resolve()},Ap.prototype.removeTarget=function(t,e){var n=this;this.Ef.oa(e.targetId).forEach(function(t){return n.Af.add(t)});var r=this.persistence.Fr();return r.ki(t,e.targetId).next(function(t){t.forEach(function(t){return n.Af.add(t)})}).next(function(){return r.pi(t,e)})},Ap.prototype.df=function(){this.If=new Set},Ap.prototype.wf=function(t){var n=this,r=this.persistence.Nr().oi();return Uu.forEach(this.Af,function(e){return n.Rf(t,e).next(function(t){t||r.Gn(e)})}).next(function(){return n.If=null,r.apply(t)})},Ap.prototype.jr=function(t,e){var n=this;return this.Rf(t,e).next(function(t){t?n.Af.delete(e):n.Af.add(e)})},Ap.prototype.ff=function(t){return 0},Ap.prototype.Rf=function(t,e){var n=this;return Uu.qn([function(){return Uu.resolve(n.Ef.Mi(e))},function(){return n.persistence.Fr().Mi(t,e)},function(){return n.persistence.Tf(t,e)}])},Ap),op=(_p.prototype.wu=function(t){this.gf=t},_p.prototype.cu=function(t){this.yf=t},_p.prototype.onMessage=function(t){this.pf=t},_p.prototype.close=function(){this.Vf()},_p.prototype.send=function(t){this.Pf(t)},_p.prototype.bf=function(){this.gf()},_p.prototype.vf=function(t){this.yf(t)},_p.prototype.Sf=function(t){this.pf(t)},_p),sp={BatchGetDocuments:"batchGet",Commit:"commit"},up="gl-js/ fire/"+wr,ap=(Tp.prototype.Cf=function(t,e){if(e)for(var n in e.Oa)e.Oa.hasOwnProperty(n)&&(t[n]=e.Oa[n]);t["X-Goog-Api-Client"]=up},Tp.prototype.vu=function(a,r,i){var h=this,c=this.Ff(a);return new Promise(function(o,s){var u=new vr;u.listenOnce(dr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case pr.NO_ERROR:var t=u.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),o(t);break;case pr.TIMEOUT:Er("Connection",'RPC "'+a+'" timed out'),s(new Gr(zr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e,n,r=u.getStatus();Er("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(zr).indexOf(i)?i:zr.UNKNOWN,s(new Gr(n,e.message))):s(new Gr(zr.UNKNOWN,"Server responded with status "+u.getStatus())):(Er("Connection",'RPC "'+a+'" failed'),s(new Gr(zr.UNAVAILABLE,"Connection failed.")));break;default:Ar()}}finally{Er("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Er("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Cf(n,i),u.send(c,"POST",e,n,15)})},Tp.prototype.Su=function(t,e,n){return this.vu(t,e,n)},Tp.prototype.Tu=function(t,e){var n,r,i=[this.Df,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=lr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Cf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Er("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new op({Pf:function(t){f?Er("Connection","Not sending because WebChannel is closed:",t):(c||(Er("Connection","Opening WebChannel transport."),h.open(),c=!0),Er("Connection","WebChannel sending:",t),h.send(t))},Vf:function(){return h.close()}});return a(yr.EventType.OPEN,function(){f||Er("Connection","WebChannel transport opened.")}),a(yr.EventType.CLOSE,function(){f||(f=!0,Er("Connection","WebChannel transport closed"),l.vf())}),a(yr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.WARN&&(e=n.map(_r),br.warn.apply(br,d(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.vf(new Gr(zr.UNAVAILABLE,"The operation could not be completed")))}),a(yr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Nr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Er("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=gi[i];if(void 0!==t)return Ei(t)}(),s=r.message,void 0===o&&(o=zr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.vf(new Gr(o,s)),h.close()):(Er("Connection","WebChannel received:",n),l.Sf(n)))}),setTimeout(function(){l.bf()},0),l},Tp.prototype.Ff=function(t){var e=sp[t];return this.Df+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Tp),hp=(Ep.prototype.tc=function(t){this.Mf.push(t)},Ep.prototype.gr=function(){window.removeEventListener("online",this.Nf),window.removeEventListener("offline",this.kf)},Ep.prototype.Of=function(){window.addEventListener("online",this.Nf),window.addEventListener("offline",this.kf)},Ep.prototype.$f=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Mf;t<e.length;t++)(0,e[t])(0)},Ep.prototype.xf=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Mf;t<e.length;t++)(0,e[t])(1)},Ep.Hi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Ep),cp=(Ip.prototype.tc=function(t){},Ip.prototype.gr=function(){},Ip),fp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",lp=(bp.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.t_=this.Lf(n),this.persistence=this.Bf(n),[4,this.persistence.start()];case 1:return t.sent(),this.qf=this.Uf(n),this.zu=this.Qf(n),this.Zl=this.Wf(n),this.Rc=this.jf(n),this.Kf=this.Gf(n),this.t_.Lu=function(t){return e.Rc.Ql(t,1)},this.Zl.Rc=this.Rc,[4,this.zu.start()];case 2:return t.sent(),[4,this.t_.start()];case 3:return t.sent(),[4,this.Zl.start()];case 4:return t.sent(),[4,this.Zl.Mc(this.Rc.__)];case 5:return t.sent(),[2]}})})},bp.prototype.Gf=function(t){return new Fl(this.Rc)},bp.prototype.Uf=function(t){return null},bp.prototype.Qf=function(t){return ec(this.persistence,new Bl,t.zf)},bp.prototype.Bf=function(t){if(t.Yf.Hf)throw new Gr(zr.FAILED_PRECONDITION,fp);return new np(ip.mf)},bp.prototype.Wf=function(t){var e=this;return new Xf(this.zu,t.Du,t.mo,function(t){return e.Rc.Ql(t,0)},new(hp.Hi()?hp:cp))},bp.prototype.Lf=function(t){return new Il},bp.prototype.jf=function(t){return Cl(this.zu,this.Zl,t.Du,this.t_,t.zf,t.e_)},bp.prototype.clearPersistence=function(t,e){throw new Gr(zr.FAILED_PRECONDITION,fp)},bp),pp=(n(wp,Zl=lp),wp.prototype.Qf=function(t){return ec(this.persistence,new Bl,t.zf)},wp.prototype.jf=function(t){return Cl(this.zu,this.Zl,t.Du,this.t_,t.zf,t.e_)},wp.prototype.Uf=function(t){var e=this.persistence.wi.xr;return new Kh(e,t.mo)},wp.prototype.Bf=function(t){var e=$a(t.Jf.s,t.Jf.persistenceKey),n=cf(t.Jf.s);return new Fa(t.Yf.synchronizeTabs,e,t.clientId,Hh.oh(t.Yf.cacheSizeBytes),t.mo,Uh(),"undefined"!=typeof document?document:null,n,this.t_,t.Yf.qi)},wp.prototype.Lf=function(t){return new Il},wp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Th.Hi()?(e=n+"main",[4,Th.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}($a(t,e))},n(mp,Jl=wp),mp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return[4,Jl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.rr(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Rc.Mc(e)];case 1:return t.sent(),this.qf&&(e&&!this.qf.or?this.qf.start(this.zu):e||this.qf.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},mp.prototype.Qf=function(t){return e=this.persistence,n=new Bl,r=t.zf,new rc(e,n,r);var e,n,r},mp.prototype.jf=function(t){var e,n,r,i,o,s,u=(e=this.zu,n=this.Zl,r=t.Du,i=this.t_,o=t.zf,s=t.e_,new jl(e,n,r,i,o,s));return this.t_ instanceof bl&&(this.t_.Rc=u),u},mp.prototype.Lf=function(t){if(t.Yf.Hf&&t.Yf.synchronizeTabs){var e=Uh();if(!bl.Hi(e))throw new Gr(zr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=$a(t.Jf.s,t.Jf.persistenceKey);return new bl(e,t.mo,n,t.clientId,t.zf)}return new Il},mp),dp=(gp.prototype.start=function(t,e,n){var r=this;this.bu(),this.Jf=t;var i=new Ju,o=new Ju,s=!1;return this.credentials.qa(function(t){if(!s)return s=!0,Er("FirestoreClient","Initializing. user=",t.uid),r.Xf(e,n,t,o).then(i.resolve,i.reject);r.mo._r(function(){return r.Zl.xc(t)})}),this.mo.cr(function(){return i.promise}),o.promise},gp.prototype.enableNetwork=function(){var t=this;return this.bu(),this.mo.enqueue(function(){return t.Rc.enableNetwork()})},gp.prototype.Xf=function(a,h,c,f){return y(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(s=this.Jf,Promise.resolve(new ap(s)))];case 1:return n=t.sent(),r=cf(this.Jf.s),e=this.credentials,i=new Wf(n,e,r),[4,a.initialize({mo:this.mo,Jf:this.Jf,Du:i,clientId:this.clientId,zf:c,e_:100,Yf:h})];case 2:return t.sent(),this.persistence=a.persistence,this.t_=a.t_,this.zu=a.zu,this.Zl=a.Zl,this.Rc=a.Rc,this.qf=a.qf,this.Zf=a.Kf,this.persistence.hr(function(){return y(u,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(o=t.sent(),f.reject(o),!this.td(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.Xf(new lp,{Hf:!1},c,f))];case 4:return[2]}var e})})},gp.prototype.td=function(t){return"FirebaseError"===t.name?t.code===zr.FAILED_PRECONDITION||t.code===zr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},gp.prototype.bu=function(){if(this.mo.xo)throw new Gr(zr.FAILED_PRECONDITION,"The client has already been terminated.")},gp.prototype.disableNetwork=function(){var t=this;return this.bu(),this.mo.enqueue(function(){return t.Rc.disableNetwork()})},gp.prototype.terminate=function(){var t=this;return this.mo.qo(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qf&&this.qf.stop(),[4,this.Zl.gr()];case 1:return t.sent(),[4,this.t_.gr()];case 2:return t.sent(),[4,this.persistence.gr()];case 3:return t.sent(),this.credentials.Ua(),[2]}})})})},gp.prototype.waitForPendingWrites=function(){var t=this;this.bu();var e=new Ju;return this.mo.cr(function(){return t.Rc.V_(e)}),e.promise},gp.prototype.listen=function(t,e,n){var r=this;this.bu();var i=new ql(t,e,n);return this.mo.cr(function(){return r.Zf.listen(i)}),i},gp.prototype.mc=function(t){var e=this;this.ed||this.mo.cr(function(){return e.Zf.mc(t)})},gp.prototype.nd=function(o){return y(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){switch(t.label){case 0:return this.bu(),i=new Ju,[4,this.mo.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zu.Wh(o)];case 1:return(e=t.sent())instanceof Js?i.resolve(e):e instanceof Zs?i.resolve(null):i.reject(new Gr(zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Bh(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},gp.prototype.sd=function(a){return y(this,void 0,void 0,function(){var u,e=this;return v(this,function(t){switch(t.label){case 0:return this.bu(),u=new Ju,[4,this.mo.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zu.Gh(a,!0)];case 1:return e=t.sent(),n=new El(a,e.zh),r=n.xl(e.documents),i=n.Jn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Bh(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},gp.prototype.write=function(t){var e=this;this.bu();var n=new Ju;return this.mo.cr(function(){return e.Rc.write(t,n)}),n.promise},gp.prototype.s=function(){return this.Jf.s},gp.prototype.q_=function(t){var e=this;this.bu(),this.mo.cr(function(){return e.Zf.q_(t),Promise.resolve()})},gp.prototype.U_=function(t){var e=this;this.ed||this.mo.cr(function(){return e.Zf.U_(t),Promise.resolve()})},Object.defineProperty(gp.prototype,"ed",{get:function(){return this.mo.xo},enumerable:!1,configurable:!0}),gp.prototype.transaction=function(t){var e=this;this.bu();var n=new Ju;return this.mo.cr(function(){return e.Rc.runTransaction(e.mo,t,n),Promise.resolve()}),n.promise},gp),yp=(vp.prototype.next=function(t){this.rd(this.observer.next,t)},vp.prototype.error=function(t){this.rd(this.observer.error,t)},vp.prototype.od=function(){this.muted=!0},vp.prototype.rd=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},vp);function vp(t){this.observer=t,this.muted=!1}function gp(t,e){this.credentials=t,this.mo=e,this.clientId=Dr.t()}function mp(){return null!==Jl&&Jl.apply(this,arguments)||this}function wp(){return null!==Zl&&Zl.apply(this,arguments)||this}function bp(){}function Ip(){}function Ep(){var t=this;this.Nf=function(){return t.$f()},this.kf=function(){return t.xf()},this.Mf=[],this.Of()}function Tp(t){this.s=t.s;var e=t.ssl?"https":"http";this.Df=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function _p(t){this.Pf=t.Pf,this.Vf=t.Vf}function Ap(t){this.persistence=t,this.Ef=new sc,this.If=null}function Np(t){var e=this;return(e=tp.call(this)||this).Li=t,e}function Sp(t){var e=this;this._f={},this.Ui=new zu(0),this.Qi=!1,this.Qi=!0,this.wi=t(this),this.Ji=new ep(this),this.ss=new oa,this.es=new Gl(this.ss,function(t){return e.wi.ff(t)})}function Dp(t){this.persistence=t,this.af=new Br(fi,li),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this.uf=0,this.cf=new sc,this.targetCount=0,this.lf=Pa.fi()}function xp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Pp=(Vp.prototype.ud=function(t){switch(ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vo(t.integerValue||t.doubleValue);case 3:return this.ld(t.timestampValue);case 4:return this._d(t);case 5:return t.stringValue;case 6:return new Lc(go(t.bytesValue));case 7:return this.fd(t.referenceValue);case 8:return this.dd(t.geoPointValue);case 9:return this.wd(t.arrayValue);case 10:return this.Td(t.mapValue);default:throw Ar()}},Vp.prototype.Td=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.ud(e)}),r},Vp.prototype.dd=function(t){return new ef(vo(t.latitude),vo(t.longitude))},Vp.prototype.wd=function(t){var e=this;return(t.values||[]).map(function(t){return e.ud(t)})},Vp.prototype._d=function(t){switch(this.hd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return oo(n)?t(n):n}(t);return null==e?null:this.ud(e);case"estimate":return this.ld(so(t));default:return null}},Vp.prototype.ld=function(t){var e=yo(t),n=new Qr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Vp.prototype.fd=function(t){var e=$r.$(t);Nr(Xo(e));var n=new Rr(e.get(1),e.get(3)),r=new Yr(e.g(5));return n.isEqual(this.s)||Tr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.ad(r)},Vp),Op=Hh.uh,kp=(Cp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Cp),Lp=(Object.defineProperty(Rp.prototype,"pd",{get:function(){return this.bd||(this.bd=new wf(this.Va,this.yd.ignoreUndefinedProperties)),this.bd},enumerable:!1,configurable:!0}),Rp.prototype.settings=function(t){fc("Firestore.settings",arguments,1),dc("Firestore.settings","object",1,t);var e=new kp(t);if(this.Ad&&!this.yd.isEqual(e))throw new Gr(zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.yd=e).credentials&&(this.Vd=function(t){if(!t)return new Ff;switch(t.type){case"gapi":var e=t.vd;return Nr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new zf(e,t.za||"0");case"provider":return t.vd;default:throw new Gr(zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Rp.prototype.enableNetwork=function(){return this.md(),this.Ad.enableNetwork()},Rp.prototype.disableNetwork=function(){return this.md(),this.Ad.disableNetwork()},Rp.prototype.enablePersistence=function(t){var e,n;if(this.Ad)throw new Gr(zr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Tr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Gr(zr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Sd(this.gd,{Hf:!0,cacheSizeBytes:this.yd.cacheSizeBytes,synchronizeTabs:r,qi:i})},Rp.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Ad&&!this.Ad.ed)throw new Gr(zr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ju,[2,(this.Id.Mo(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.gd.clearPersistence(this.Va,this.Pd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Rp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Rp.prototype,"Dd",{get:function(){return this.md(),this.Ad.ed},enumerable:!1,configurable:!0}),Rp.prototype.waitForPendingWrites=function(){return this.md(),this.Ad.waitForPendingWrites()},Rp.prototype.onSnapshotsInSync=function(t){if(this.md(),xp(t))return Up(this.Ad,t);dc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Up(this.Ad,e)},Rp.prototype.md=function(){return this.Ad||this.Sd(new lp,{Hf:!1}),this.Ad},Rp.prototype.Cd=function(){return new Lr(this.Va,this.Pd,this.yd.host,this.yd.ssl,this.yd.forceLongPolling)},Rp.prototype.Sd=function(t,e){var n=this.Cd();return this.Ad=new dp(this.Vd,this.Id),this.Ad.start(n,t,e)},Rp.Rd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Gr(zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Gr(zr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Rr(n)},Object.defineProperty(Rp.prototype,"app",{get:function(){if(!this.Ed)throw new Gr(zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ed},enumerable:!1,configurable:!0}),Rp.prototype.collection=function(t){return fc("Firestore.collection",arguments,1),dc("Firestore.collection","non-empty string",1,t),this.md(),new ud($r.$(t),this,null)},Rp.prototype.doc=function(t){return fc("Firestore.doc",arguments,1),dc("Firestore.doc","non-empty string",1,t),this.md(),qp.Fd($r.$(t),this,null)},Rp.prototype.collectionGroup=function(t){if(fc("Firestore.collectionGroup",arguments,1),dc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Gr(zr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.md(),new ed(new eu($r.k(),t),this,null)},Rp.prototype.runTransaction=function(e){var n=this;return fc("Firestore.runTransaction",arguments,1),dc("Firestore.runTransaction","function",1,e),this.md().transaction(function(t){return e(new jp(n,t))})},Rp.prototype.batch=function(){return this.md(),new Fp(this)},Object.defineProperty(Rp,"logLevel",{get:function(){switch(Ir()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Rp.setLogLevel=function(t){fc("Firestore.setLogLevel",arguments,1),wc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),br.setLogLevel(t)},Rp.prototype.Nd=function(){return this.yd.timestampsInSnapshots},Rp);function Rp(t,e,n){var r=this;if(void 0===n&&(n=new lp),this.Ed=null,this.Id=new jh,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.md(),[4,this.Ad.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Ed=i,this.Va=Rp.Rd(i),this.Pd=i.name,this.Vd=new qf(e)}else{var o=t;if(!o.projectId)throw new Gr(zr.INVALID_ARGUMENT,"Must provide projectId");this.Va=new Rr(o.projectId,o.database),this.Pd="[DEFAULT]",this.Vd=new Ff}this.gd=n,this.yd=new kp({})}function Cp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else vc("settings","non-empty string","host",t.host),this.host=t.host,gc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(_c("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),gc("settings","object","credentials",t.credentials),this.credentials=t.credentials,gc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),gc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Tr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Tr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,gc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Hh._h;else{if(t.cacheSizeBytes!==Op&&t.cacheSizeBytes<Hh.lh)throw new Gr(zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Hh.lh);this.cacheSizeBytes=t.cacheSizeBytes}gc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Vp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.hd=n,this.ad=r}function Up(t,e){var n=new yp({next:function(){e.next&&e.next()},error:function(t){throw Ar()}});return t.q_(n),function(){n.od(),t.U_(n)}}var Mp,jp=(Gp.prototype.get=function(t){var n=this;fc("Transaction.get",arguments,1);var r=pd("Transaction.get",t,this.$d);return this.kd.ku([r.ga]).then(function(t){if(!t||1!==t.length)return Ar();var e=t[0];if(e instanceof Zs)return new $p(n.$d,r.ga,null,!1,!1,r.ya);if(e instanceof Js)return new $p(n.$d,r.ga,e,!1,!1,r.ya);throw Ar()})},Gp.prototype.set=function(t,e,n){pc("Transaction.set",arguments,2,3);var r=pd("Transaction.set",t,this.$d);n=cd("Transaction.set",n);var i=dd(r.ya,e,n),o=Ef(this.$d.pd,"Transaction.set",r.ga,i,null!==r.ya,n);return this.kd.set(r.ga,o),this},Gp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Cc?(lc("Transaction.update",arguments,3),r=pd("Transaction.update",t,this.$d),_f(this.$d.pd,"Transaction.update",r.ga,e,n,o)):(fc("Transaction.update",arguments,2),r=pd("Transaction.update",t,this.$d),Tf(this.$d.pd,"Transaction.update",r.ga,e)),this.kd.update(r.ga,i),this},Gp.prototype.delete=function(t){fc("Transaction.delete",arguments,1);var e=pd("Transaction.delete",t,this.$d);return this.kd.delete(e.ga),this},Gp),Fp=(zp.prototype.set=function(t,e,n){pc("WriteBatch.set",arguments,2,3),this.Od();var r=pd("WriteBatch.set",t,this.$d);n=cd("WriteBatch.set",n);var i=dd(r.ya,e,n),o=Ef(this.$d.pd,"WriteBatch.set",r.ga,i,null!==r.ya,n);return this.xd=this.xd.concat(o.pa(r.ga,ws.Qe())),this},zp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Od(),i="string"==typeof e||e instanceof Cc?(lc("WriteBatch.update",arguments,3),r=pd("WriteBatch.update",t,this.$d),_f(this.$d.pd,"WriteBatch.update",r.ga,e,n,o)):(fc("WriteBatch.update",arguments,2),r=pd("WriteBatch.update",t,this.$d),Tf(this.$d.pd,"WriteBatch.update",r.ga,e)),this.xd=this.xd.concat(i.pa(r.ga,ws.exists(!0))),this},zp.prototype.delete=function(t){fc("WriteBatch.delete",arguments,1),this.Od();var e=pd("WriteBatch.delete",t,this.$d);return this.xd=this.xd.concat(new js(e.ga,ws.Qe())),this},zp.prototype.commit=function(){return this.Od(),this.Md=!0,0<this.xd.length?this.$d.md().write(this.xd):Promise.resolve()},zp.prototype.Od=function(){if(this.Md)throw new Gr(zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},zp),qp=(n(Bp,Mp=lf),Bp.Fd=function(t,e,n){if(t.length%2!=0)throw new Gr(zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Bp(new Yr(t),e,n)},Object.defineProperty(Bp.prototype,"id",{get:function(){return this.ga.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"parent",{get:function(){return new ud(this.ga.path.p(),this.firestore,this.ya)},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"path",{get:function(){return this.ga.path.N()},enumerable:!1,configurable:!0}),Bp.prototype.collection=function(t){if(fc("DocumentReference.collection",arguments,1),dc("DocumentReference.collection","non-empty string",1,t),!t)throw new Gr(zr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=$r.$(t);return new ud(this.ga.path.child(e),this.firestore,null)},Bp.prototype.isEqual=function(t){if(!(t instanceof Bp))throw Ac("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ga.isEqual(t.ga)&&this.ya===t.ya},Bp.prototype.set=function(t,e){pc("DocumentReference.set",arguments,1,2),e=cd("DocumentReference.set",e);var n=dd(this.ya,t,e),r=Ef(this.firestore.pd,"DocumentReference.set",this.ga,n,null!==this.ya,e);return this.Ad.write(r.pa(this.ga,ws.Qe()))},Bp.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Cc?(lc("DocumentReference.update",arguments,2),_f(this.firestore.pd,"DocumentReference.update",this.ga,t,e,r)):(fc("DocumentReference.update",arguments,1),Tf(this.firestore.pd,"DocumentReference.update",this.ga,t)),this.Ad.write(n.pa(this.ga,ws.exists(!0)))},Bp.prototype.delete=function(){return fc("DocumentReference.delete",arguments,0),this.Ad.write([new js(this.ga,ws.Qe())])},Bp.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];pc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||xp(i[u])||(_c("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),gc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};xp(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(dc("DocumentReference.onSnapshot","function",u,i[u]),yc("DocumentReference.onSnapshot","function",u+1,i[u+1]),yc("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Ld(t))},error:i[u+1],complete:i[u+2]};return Qp(this.Ad,this.ga,h,c)},Bp.prototype.get=function(t){var e,n,r,i,o,s=this;return pc("DocumentReference.get",arguments,0,1),ld("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.md().nd(this.ga).then(function(t){return new $p(s.firestore,s.ga,t,!0,t instanceof Js&&t.Ge,s.ya)}):(e=this.Ad,n=this.ga,r=t,i=new Ju,o=Qp(e,n,{includeMetadataChanges:!0,H_:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Gr(zr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Gr(zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.Ld(t)}))},Bp.prototype.withConverter=function(t){return new Bp(this.ga,this.firestore,t)},Bp.prototype.Ld=function(t){var e=t.docs.get(this.ga);return new $p(this.firestore,this.ga,e,t.fromCache,t.hasPendingWrites,this.ya)},Bp);function Bp(t,e,n){var r=this;return(r=Mp.call(this,e.Va,t,n)||this).ga=t,r.firestore=e,r.ya=n,r.Ad=r.firestore.md(),r}function zp(t){this.$d=t,this.xd=[],this.Md=!1}function Gp(t,e){this.$d=t,this.kd=e}function Qp(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new yp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(eu.hn(e.path),o,n);return function(){o.od(),t.mc(s)}}var Hp,Wp=(Jp.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Jp),$p=(Yp.prototype.data=function(t){var e=this;if(pc("DocumentSnapshot.data",arguments,0,1),t=fd("DocumentSnapshot.data",t),this.Bd){if(this.ya){var n=new Kp(this.$d,this.ga,this.Bd,this.qd,this.Ud,null);return this.ya.fromFirestore(n,t)}return new Pp(this.$d.Va,this.$d.Nd(),t.serverTimestamps||"none",function(t){return new qp(t,e.$d,null)}).ud(this.Bd.tn())}},Yp.prototype.get=function(t,e){var n=this;if(pc("DocumentSnapshot.get",arguments,1,2),e=fd("DocumentSnapshot.get",e),this.Bd){var r=this.Bd.data().field(Pf("DocumentSnapshot.get",t,this.ga));if(null!==r)return new Pp(this.$d.Va,this.$d.Nd(),e.serverTimestamps||"none",function(t){return new qp(t,n.$d,n.ya)}).ud(r)}},Object.defineProperty(Yp.prototype,"id",{get:function(){return this.ga.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"ref",{get:function(){return new qp(this.ga,this.$d,this.ya)},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"exists",{get:function(){return null!==this.Bd},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"metadata",{get:function(){return new Wp(this.Ud,this.qd)},enumerable:!1,configurable:!0}),Yp.prototype.isEqual=function(t){if(!(t instanceof Yp))throw Ac("isEqual","DocumentSnapshot",1,t);return this.$d===t.$d&&this.qd===t.qd&&this.ga.isEqual(t.ga)&&(null===this.Bd?null===t.Bd:this.Bd.isEqual(t.Bd))&&this.ya===t.ya},Yp),Kp=(n(Xp,Hp=$p),Xp.prototype.data=function(t){return Hp.prototype.data.call(this,t)},Xp);function Xp(){return null!==Hp&&Hp.apply(this,arguments)||this}function Yp(t,e,n,r,i,o){this.$d=t,this.ga=e,this.Bd=n,this.qd=r,this.Ud=i,this.ya=o}function Jp(t,e){this.hasPendingWrites=t,this.fromCache=e}function Zp(t){if(t.mn()&&0===t.en.length)throw new Gr(zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var td,ed=(rd.prototype.Wd=function(t,e,n){var r;if(t.O()){if("array-contains"===e||"array-contains-any"===e)throw new Gr(zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.jd(n,e);for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];i.push(this.Kd(u))}r={arrayValue:{values:i}}}else r=this.Kd(n)}else"in"!==e&&"array-contains-any"!==e||this.jd(n,e),r=Af(this.pd,"Query.where",n,"in"===e);var a=lu.create(t,e,r);return this.Gd(a),a},rd.prototype.zd=function(t,e){if(null!==this.Qd.startAt)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Qd.endAt)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new Lu(t,e);return this.Hd(n),n},rd.prototype.Yd=function(t,e,n){if(!e)throw new Gr(zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var r=[],i=0,o=this.Qd.orderBy;i<o.length;i++){var s=o[i];if(s.field.O())r.push(mo(this.Va,e.key));else{var u=e.field(s.field);if(oo(u))throw new Gr(zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.N();throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}r.push(u)}}return new _u(r,n)},rd.prototype.Jd=function(t,e,n){var r=this.Qd.en;if(e.length>r.length)throw new Gr(zr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.O()){if("string"!=typeof s)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Qd.Vn()&&-1!==s.indexOf("/"))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.Qd.path.child($r.$(s));if(!Yr.W(u))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Yr(u);i.push(mo(this.Va,a))}else{var h=Af(this.pd,t,s);i.push(h)}}return new _u(i,n)},rd.prototype.Kd=function(t){if("string"==typeof t){if(""===t)throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Qd.Vn()&&-1!==t.indexOf("/"))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Qd.path.child($r.$(t));if(!Yr.W(e))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return mo(this.Va,new Yr(e))}if(t instanceof lf)return mo(this.Va,t.ga);throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ec(t)+".")},rd.prototype.jd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Gr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Gr(zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},rd.prototype.Gd=function(t){if(t instanceof lu){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.An()){var o=this.Qd.an();if(null!==o&&!o.isEqual(t.field))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Qd.un();null!==s&&this.Xd(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.Qd.Rn(n)),null===u&&r&&(u=this.Qd.Rn(e)),null!==u)throw u===t.op?new Gr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Gr(zr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},rd.prototype.Hd=function(t){var e;null!==this.Qd.un()||null!==(e=this.Qd.an())&&this.Xd(e,t.field)},rd.prototype.Xd=function(t,e){if(!e.isEqual(t))throw new Gr(zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(nd,td=rd),nd.prototype.where=function(t,e,n){fc("Query.where",arguments,3),Tc("Query.where",3,n);var r=wc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),i=Pf("Query.where",t),o=this.Wd(i,r,n);return new nd(this.Qd.cn(o),this.firestore,this.ya)},nd.prototype.orderBy=function(t,e){var n;if(pc("Query.orderBy",arguments,1,2),yc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Gr(zr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r=Pf("Query.orderBy",t),i=this.zd(r,n);return new nd(this.Qd.ln(i),this.firestore,this.ya)},nd.prototype.limit=function(t){return fc("Query.limit",arguments,1),dc("Query.limit","number",1,t),Nc("Query.limit",1,t),new nd(this.Qd._n(t),this.firestore,this.ya)},nd.prototype.limitToLast=function(t){return fc("Query.limitToLast",arguments,1),dc("Query.limitToLast","number",1,t),Nc("Query.limitToLast",1,t),new nd(this.Qd.fn(t),this.firestore,this.ya)},nd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];lc("Query.startAt",arguments,1);var r=this.Zd("Query.startAt",t,e,!0);return new nd(this.Qd.dn(r),this.firestore,this.ya)},nd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];lc("Query.startAfter",arguments,1);var r=this.Zd("Query.startAfter",t,e,!1);return new nd(this.Qd.dn(r),this.firestore,this.ya)},nd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];lc("Query.endBefore",arguments,1);var r=this.Zd("Query.endBefore",t,e,!0);return new nd(this.Qd.wn(r),this.firestore,this.ya)},nd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];lc("Query.endAt",arguments,1);var r=this.Zd("Query.endAt",t,e,!1);return new nd(this.Qd.wn(r),this.firestore,this.ya)},nd.prototype.isEqual=function(t){if(!(t instanceof nd))throw Ac("isEqual","Query",1,t);return this.firestore===t.firestore&&su(this.Qd,t.Qd)&&this.ya===t.ya},nd.prototype.withConverter=function(t){return new nd(this.Qd,this.firestore,t)},nd.prototype.Zd=function(t,e,n,r){if(Tc(t,1,e),e instanceof $p)return fc(t,d([e],n),1),this.Yd(t,e.Bd,r);var i=[e].concat(n);return this.Jd(t,i,r)},nd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];pc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||xp(i[a])||(_c("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),gc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),xp(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(dc("Query.onSnapshot","function",a,i[a]),yc("Query.onSnapshot","function",a+1,i[a+1]),yc("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new sd(r.firestore,r.Qd,t,r.ya))},error:i[a+1],complete:i[a+2]};return Zp(this.Qd),id(this.firestore.md(),this.Qd,u,h)},nd.prototype.get=function(t){var e=this;pc("Query.get",arguments,0,1),ld("Query.get",t),Zp(this.Qd);var n,r,i,o,s,u=this.firestore.md();return(t&&"cache"===t.source?u.sd(this.Qd):(n=u,r=this.Qd,i=t,o=new Ju,s=id(n,r,{includeMetadataChanges:!0,H_:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Gr(zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new sd(e.firestore,e.Qd,t,e.ya)})},nd);function nd(t,e,n){var r=this;return(r=td.call(this,e.Va,e.pd,t)||this).Qd=t,r.firestore=e,r.ya=n,r}function rd(t,e,n){this.Va=t,this.pd=e,this.Qd=n}function id(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new yp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.od(),t.mc(s)}}var od,sd=(Object.defineProperty(hd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"empty",{get:function(){return this.ew.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"size",{get:function(){return this.ew.docs.size},enumerable:!1,configurable:!0}),hd.prototype.forEach=function(e,n){var r=this;pc("QuerySnapshot.forEach",arguments,1,2),dc("QuerySnapshot.forEach","function",1,e),this.ew.docs.forEach(function(t){e.call(n,r.iw(t,r.metadata.fromCache,r.ew.Lt.has(t.key)))})},Object.defineProperty(hd.prototype,"query",{get:function(){return new ed(this.tw,this.$d,this.ya)},enumerable:!1,configurable:!0}),hd.prototype.docChanges=function(t){t&&(_c("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),gc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.ew.qt)throw new Gr(zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.nw&&this.sw===e||(this.nw=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ar()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.ew,e,this.iw.bind(this)),this.sw=e),this.nw},hd.prototype.isEqual=function(t){if(!(t instanceof hd))throw Ac("isEqual","QuerySnapshot",1,t);return this.$d===t.$d&&su(this.tw,t.tw)&&this.ew.isEqual(t.ew)&&this.ya===t.ya},hd.prototype.iw=function(t,e,n){return new Kp(this.$d,t.key,t,e,n,this.ya)},hd),ud=(n(ad,od=ed),Object.defineProperty(ad.prototype,"id",{get:function(){return this.Qd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"parent",{get:function(){var t=this.Qd.path.p();return t._()?null:new qp(new Yr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"path",{get:function(){return this.Qd.path.N()},enumerable:!1,configurable:!0}),ad.prototype.doc=function(t){pc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Dr.t()),dc("CollectionReference.doc","non-empty string",1,t);var e=$r.$(t);return qp.Fd(this.Qd.path.child(e),this.firestore,this.ya)},ad.prototype.add=function(t){fc("CollectionReference.add",arguments,1),dc("CollectionReference.add","object",1,this.ya?this.ya.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},ad.prototype.withConverter=function(t){return new ad(this.rw,this.firestore,t)},ad);function ad(t,e,n){var r=this;if(((r=od.call(this,eu.hn(t),e,n)||this).rw=t).length%2!=1)throw new Gr(zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function hd(t,e,n,r){this.$d=t,this.tw=e,this.ew=n,this.ya=r,this.nw=null,this.sw=null,this.metadata=new Wp(n.hasPendingWrites,n.fromCache)}function cd(t,e){if(void 0===e)return{merge:!1};if(_c(t,e,["merge","mergeFields"]),gc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ec(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Cc))throw new Gr(zr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Ec(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function fd(t,e){return void 0===e?{}:(_c(t,e,["serverTimestamps"]),mc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ld(t,e){yc(t,"object",1,e),e&&(_c(t,e,["source"]),mc(t,0,"source",e.source,["default","server","cache"]))}function pd(t,e,n){if(e instanceof lf){if(e.firestore!==n)throw new Gr(zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ac(t,"DocumentReference",1,e)}function dd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var yd,vd={Firestore:Lp,GeoPoint:ef,Timestamp:Qr,Blob:Lc,Transaction:jp,WriteBatch:Fp,DocumentReference:qp,DocumentSnapshot:$p,Query:ed,QueryDocumentSnapshot:Kp,QuerySnapshot:sd,CollectionReference:ud,FieldPath:Cc,FieldValue:Zc,setLogLevel:Lp.setLogLevel,CACHE_SIZE_UNLIMITED:Op};(yd=gd).INTERNAL.registerComponent(new gr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Lp(e,n,new pp);var e,n},"PUBLIC").setServiceProps(Object.assign({},vd))),yd.registerVersion("@firebase/firestore","1.16.1")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});