!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.app={}))}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n=n||Promise)(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function i(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}var u=(a.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},a);function a(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}var c,h,l,f="FirebaseError",p=(c=Error,e(h=y,l=c),h.prototype=null===l?Object.create(l):(d.prototype=l.prototype,new d),y);function d(){this.constructor=h}function y(t,e){var n=c.call(this,e)||this;return n.code=t,n.name=f,Object.setPrototypeOf(n,y.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,v.prototype.create),n}var v=(g.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(m,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new p(o,a),h=0,l=Object.keys(i);h<l.length;h++){var f=l[h];"_"!==f.slice(-1)&&(f in c&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),c[f]=i[f])}return c},g);function g(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var m=/\{\$([^}]+)}/g,w=(b.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},b.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},b.prototype.setServiceProps=function(t){return this.serviceProps=t,this},b);function b(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var E="[DEFAULT]",I=(T.prototype.get=function(t){void 0===t&&(t=E);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new u;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},T.prototype.getImmediate=function(t){var e=n({identifier:E,optional:!1},t),r=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(r);try{var s=this.getOrInitializeService(o);if(s)return s;if(i)return null;throw Error("Service "+this.name+" is not available")}catch(t){if(i)return null;throw t}},T.prototype.getComponent=function(){return this.component},T.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=t).instantiationMode)try{this.getOrInitializeService(E)}catch(t){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var u=s(i.value,2),a=u[0],c=u[1],h=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},T.prototype.clearInstance=function(t){void 0===t&&(t=E),this.instancesDeferred.delete(t),this.instances.delete(t)},T.prototype.delete=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2]}})})},T.prototype.isComponentSet=function(){return null!=this.component},T.prototype.getOrInitializeService=function(t){var e,n=this.instances.get(t);return!n&&this.component&&(n=this.component.instanceFactory(this.container,(e=t)===E?void 0:e),this.instances.set(t,n)),n||null},T.prototype.normalizeInstanceIdentifier=function(t){return!this.component||this.component.multipleInstances?t:E},T);function T(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var N,_=(A.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},A.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},A.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new I(t,this);return this.providers.set(t,e),e},A.prototype.getProviders=function(){return Array.from(this.providers.values())},A);function A(t){this.name=t,this.providers=new Map}function S(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var D,O,R=[];function L(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=k[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,S(["["+i+"]  "+t.name+":"],n))}}(O=D=D||{})[O.DEBUG=0]="DEBUG",O[O.VERBOSE=1]="VERBOSE",O[O.INFO=2]="INFO",O[O.WARN=3]="WARN",O[O.ERROR=4]="ERROR",O[O.SILENT=5]="SILENT";var P={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},x=D.INFO,k=((N={})[D.DEBUG]="log",N[D.VERBOSE]="log",N[D.INFO]="info",N[D.WARN]="warn",N[D.ERROR]="error",N),V=(Object.defineProperty(C.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in D))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),C.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?P[t]:t},Object.defineProperty(C.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),C.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,D.DEBUG],t)),this._logHandler.apply(this,S([this,D.DEBUG],t))},C.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,D.VERBOSE],t)),this._logHandler.apply(this,S([this,D.VERBOSE],t))},C.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,D.INFO],t)),this._logHandler.apply(this,S([this,D.INFO],t))},C.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,D.WARN],t)),this._logHandler.apply(this,S([this,D.WARN],t))},C.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,D.ERROR],t)),this._logHandler.apply(this,S([this,D.ERROR],t))},C);function C(t){this.name=t,this._logLevel=x,this._logHandler=L,this._userLogHandler=null,R.push(this)}var U=(F.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if("VERSION"!==(null==(e=t.getComponent())?void 0:e.type))return null;var e,n=t.getImmediate();return n.library+"/"+n.version}).filter(function(t){return t}).join(" ")},F);function F(t){this.container=t}var M,q,j="@firebase/app",G=new V("@firebase/app"),B="[DEFAULT]",z=((M={})[j]="fire-core",M["@firebase/app-compat"]="fire-core-compat",M["@firebase/analytics"]="fire-analytics",M["@firebase/auth"]="fire-auth",M["@firebase/database"]="fire-rtdb",M["@firebase/functions"]="fire-fn",M["@firebase/installations"]="fire-iid",M["@firebase/messaging"]="fire-fcm",M["@firebase/performance"]="fire-perf",M["@firebase/remote-config"]="fire-rc",M["@firebase/storage"]="fire-gcs",M["@firebase/firestore"]="fire-fst",M["fire-js"]="fire-js",M.firebase="fire-js-all",M),H=new Map,W=new Map;function $(t,e){try{t.container.addComponent(e)}catch(n){G.debug("Component "+e.name+" failed to register with FirebaseApp "+t.name,n)}}function K(t){var e,n,r=t.name;if(W.has(r))return G.debug("There were multiple attempts to register component "+r+"."),!1;W.set(r,t);try{for(var i=o(H.values()),s=i.next();!s.done;s=i.next())$(s.value,t)}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0}function Y(t,e){return t.container.getProvider(e)}var Q=((q={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",q["bad-app-name"]="Illegal App name: '{$appName}",q["duplicate-app"]="Firebase App named '{$appName}' already exists",q["app-deleted"]="Firebase App named '{$appName}' already deleted",q["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",q["invalid-log-argument"]="First argument to `onLog` must be null or a function.",q),X=new v("app","Firebase",Q),Z=(Object.defineProperty(J.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),J.prototype.checkDestroyed=function(){if(this.isDeleted)throw X.create("app-deleted",{appName:this.name_})},J);function J(t,e,r){var i=this;this.isDeleted=!1,this.options_=n({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=r,this.container.addComponent(new w("app-exp",function(){return i},"PUBLIC"))}function tt(t,e,n){var r,i=null!==(r=z[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void G.warn(u.join(" "))}K(new w(i+"-version",function(){return{library:i,version:e}},"VERSION"))}K(new w("platform-logger",function(t){return new U(t)},"PRIVATE")),tt(j,"0.0.800-exp.bdae2c966",void 0),tt("fire-js",""),tt("firebase","0.800.6","app"),t.SDK_VERSION="7.19.1",t._DEFAULT_ENTRY_NAME=B,t._addComponent=$,t._addOrOverwriteComponent=function(t,e){t.container.addOrOverwriteComponent(e)},t._apps=H,t._clearComponents=function(){W.clear()},t._components=W,t._getProvider=Y,t._registerComponent=K,t._removeServiceInstance=function(t,e,n){void 0===n&&(n=B),Y(t,e).clearInstance(n)},t.deleteApp=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return e=t.name,H.has(e)?(H.delete(e),[4,Promise.all(t.container.getProviders().map(function(t){return t.delete()}))]):[3,2];case 1:n.sent(),t.isDeleted=!0,n.label=2;case 2:return[2]}})})},t.getApp=function(t){void 0===t&&(t=B);var e=H.get(t);if(!e)throw X.create("no-app",{appName:t});return e},t.getApps=function(){return Array.from(H.values())},t.initializeApp=function(t,e){var r,i;void 0===e&&(e={}),"object"!=typeof e&&(e={name:e});var s=n({name:B,automaticDataCollectionEnabled:!1},e),u=s.name;if("string"!=typeof u||!u)throw X.create("bad-app-name",{appName:String(u)});if(H.has(u))throw X.create("duplicate-app",{appName:u});var a=new _(u);try{for(var c=o(W.values()),h=c.next();!h.done;h=c.next()){var l=h.value;a.addComponent(l)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}var f=new Z(t,s,a);return H.set(u,f),f},t.onLog=function(t,e){if(null!==t&&"function"!=typeof t)throw X.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=0,r=R;n<r.length;n++)!function(n){var r=null;e&&e.level&&(r=P[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:D[n].toLowerCase(),message:s,args:i,type:e.name})}}(r[n])}(t,e)},t.registerVersion=tt,t.setLogLevel=function(t){var e;e=t,R.forEach(function(t){t.setLogLevel(e)})},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.functions=t.firebase.functions||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function o(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var s="FirebaseError",u=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=s,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,a.prototype.create),i}return r(e,t),e}(Error),a=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",h=new u(i,a),l=0,f=Object.keys(r);l<f.length;l++){var p=f[l];"_"!==p.slice(-1)&&(p in h&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),h[p]=r[p])}return h},t}();var c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),l="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";function p(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function d(t){if(null==t)return t;if(t["@type"])switch(t["@type"]){case l:case f:var e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return d(t)}):"function"==typeof t||"object"==typeof t?p(t,function(t){return d(t)}):t}var y="functions",v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},g=function(t){function e(e,n,r){var i=t.call(this,y+"/"+e,n||"")||this;return i.details=r,i}return r(e,t),e}(u);var m=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return[2,null==(t=e.sent())?void 0:t.accessToken];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getMessagingToken=function(){return i(this,void 0,void 0,function(){return o(this,function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]})})},t.prototype.getContext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getMessagingToken()];case 2:return e=n.sent(),[2,{authToken:t,messagingToken:e}]}})})},t}(),w="us-central1";var b=function(){function t(t,e,n,r){var i=this;void 0===r&&(r=w),this.app=t,this.region=r,this.emulatorOrigin=null,this.contextProvider=new m(e,n),this.cancelAllRequests=new Promise(function(t){i.deleteService=function(){return Promise.resolve(t())}})}return t.prototype._delete=function(){return this.deleteService()},t.prototype._url=function(t){var e=this.app.options.projectId,n=this.region;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+n+"/"+t:"https://"+n+"-"+e+".cloudfunctions.net/"+t},t}();function E(t,e,n){return function(r){return function(t,e,n,r){return i(this,void 0,void 0,function(){var s,u,a,c,h,l,f,y;return o(this,function(m){switch(m.label){case 0:return s=t._url(e),n=function t(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t(e)});if("function"==typeof e||"object"==typeof e)return p(e,function(e){return t(e)});throw new Error("Data cannot be encoded in JSON: "+e)}(n),u={data:n},a=new Headers,[4,t.contextProvider.getContext()];case 1:return(c=m.sent()).authToken&&a.append("Authorization","Bearer "+c.authToken),c.messagingToken&&a.append("Firebase-Instance-ID-Token",c.messagingToken),h=r.timeout||7e4,[4,Promise.race([function(t,e,n){return i(this,void 0,void 0,function(){var r,i;return o(this,function(o){switch(o.label){case 0:n.append("Content-Type","application/json"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}})})}(s,u,a),(w=h,new Promise(function(t,e){setTimeout(function(){e(new g("deadline-exceeded","deadline-exceeded"))},w)})),t.cancelAllRequests])];case 2:if(!(l=m.sent()))throw new g("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e){var n=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=n,i=void 0;try{var o=e&&e.error;if(o){var s=o.status;if("string"==typeof s){if(!v[s])return new g("internal","internal");n=v[s],r=s}var u=o.message;"string"==typeof u&&(r=u),void 0!==(i=o.details)&&(i=d(i))}}catch(t){}return"ok"===n?null:new g(n,r,i)}(l.status,l.json))throw f;if(!l.json)throw new g("internal","Response is not valid JSON object.");if(void 0===(y=l.json.data)&&(y=l.json.result),void 0===y)throw new g("internal","Response is missing data field.");return[2,{data:d(y)}]}var w})})}(t,e,r,n||{})}}var I=function(t,e){var n=t.getProvider("app-exp").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new b(n,r,i,e)};var T;T={Functions:b},e._registerComponent(new h(y,I,"PUBLIC").setServiceProps(T).setMultipleInstances(!0)),e.registerVersion("@firebase/functions-exp","0.0.800"),t.getFunctions=function(t,n){return void 0===n&&(n=w),e._getProvider(t,y).getImmediate({identifier:n})},t.httpsCallable=function(t,e,n){return E(t,e,n)},t.useFunctionsEmulator=function(t,e){!function(t,e){t.emulatorOrigin=e}(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-functions.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.firestore=t.firebase.firestore||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n,r,i=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function c(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));var l={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},f=r.INFO,p=((n={})[r.DEBUG]="log",n[r.VERBOSE]="log",n[r.INFO]="info",n[r.WARN]="warn",n[r.ERROR]="error",n),d=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=p[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,h(["["+i+"]  "+t.name+":"],n))}},y=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=d,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.DEBUG],t)),this._logHandler.apply(this,h([this,r.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.VERBOSE],t)),this._logHandler.apply(this,h([this,r.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.INFO],t)),this._logHandler.apply(this,h([this,r.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.WARN],t)),this._logHandler.apply(this,h([this,r.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.ERROR],t)),this._logHandler.apply(this,h([this,r.ERROR],t))},t}();function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g="FirebaseError",m=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=g,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,w.prototype.create),i}return s(e,t),e}(Error),w=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(b,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new m(i,u),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in a&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),a[l]=r[l])}return a},t}();var b=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},A=N||self;function S(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),P=0;function x(t,e,n){return t.call.apply(t.bind,arguments)}function k(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:k).apply(null,arguments)}function C(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var U=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++P)})(this)},M.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function $(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:t>e?1:0}t:{var Y=A.navigator;if(Y){var Q=Y.userAgent;if(Q){H=Q;break t}}H=""}function X(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<J.length;o++)n=J[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=$(H,"Opera"),ot=$(H,"Trident")||$(H,"MSIE"),st=$(H,"Edge"),ut=st||ot,at=$(H,"Gecko")&&!($(H.toLowerCase(),"webkit")&&!$(H,"Edge"))&&!($(H,"Trident")||$(H,"MSIE"))&&!$(H,"Edge"),ct=$(H.toLowerCase(),"webkit")&&!$(H,"Edge");function ht(){var t=A.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ht();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt,yt={};function vt(t){return function(t,e){var n=yt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=W(String(nt)).split("."),r=W(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=K(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||K(0==s[2].length,0==u[2].length)||K(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}if(A.document&&ot){var gt=ht();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!vt("9"),Et=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{A.addEventListener("test",S,e),A.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},F(Tt,It);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),At=0;function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=q(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(St(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++At,this.Y=this.Z=!1}(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Pt={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[_t]?e.wa(n,r,R(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[_t]?t.va(e,n,R(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!wt)return null;var u=Mt(t);if(u||(t[Lt]=u=new Dt(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ft,e=wt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[_t])Ot(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Lt]=null)):St(t)}}}function Ct(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(!wt){if(!e)t:{e=["window","event"];for(var n=A,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new Tt(e,this))}return Ut(t,new Tt(e,this))}function Mt(t){return(t=t[Lt])instanceof Dt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(t){return"function"==D(t)?t:(t[qt]||(t[qt]=function(e){return t.handleEvent(e)}),t[qt])}function Gt(){M.call(this),this.c=new Dt(this),this.J=this,this.C=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Ot(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}F(Gt,M),Gt.prototype[_t]=!0,(T=Gt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=jt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Rt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Rt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new It(t,n);else if(t instanceof It)t.target=t.target||n;else{var i=t;tt(t=new It(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Bt(s,r,!0,t)&&i}if(i=Bt(s=t.a=n,r,!0,t)&&i,i=Bt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Bt(s=t.a=e[o],r,!1,t)&&i;return i},T.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},T.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=A.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,$t=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Yt},function(t){t.reset()},100);function Kt(){var t=Jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Yt(){this.next=this.b=this.a=null}function Qt(t){A.setTimeout(function(){throw t},0)}function Xt(t,e){Wt||function(){var t=A.Promise.resolve(void 0);Wt=function(){t.then(te)}}(),Zt||(Wt(),Zt=!0),Jt.add(t,e)}Ht.prototype.add=function(t,e){var n=$t.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Yt.prototype.reset=function(){this.next=this.b=this.a=null};var Zt=!1,Jt=new Ht;function te(){for(var t;t=Kt();){try{t.a.call(t.b)}catch(t){Qt(t)}var e=$t;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Zt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||A,this.f=V(this.Ya,this),this.g=U()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==D(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:A.setTimeout(t,e||0)}F(ee,Gt),(T=ee.prototype).aa=!1,T.M=null,T.Ya=function(){if(this.aa){var t=U()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start()))}},T.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},T.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(A.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(M);function oe(t){M.call(this),this.b=t,this.a={}}F(oe,M);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){X(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function ce(){this.a=!0}function he(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}oe.prototype.G=function(){oe.S.G.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var le=null;function fe(){return le=le||new Gt}function pe(t){It.call(this,"serverreachability",t)}function de(t){var e=fe();e.dispatchEvent(new pe(e,t))}function ye(t){It.call(this,"statevent",t)}function ve(t){var e=fe();e.dispatchEvent(new ye(e,t))}function ge(t){It.call(this,"timingevent",t)}function me(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){t()},e)}F(pe,It),F(ye,It),F(ge,It);var we={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},be={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ee(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ne,_e={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ae(){It.call(this,"d")}function Se(){It.call(this,"c")}function De(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new oe(this),this.P=Re,t=ut?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Ae,It),F(Se,It),F(De,Ee),Ne=new De;var Re=45e3,Le={},Pe={};function xe(t,e,n){t.H=1,t.i=en(Ye(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=U(),Ue(t),t.l=Ye(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ue(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),de(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.T,t.j)}function Ve(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ce(t,n);if(i==Pe){4==e&&(t.h=4,ve(14),r=!1),he(t.c,t.f,null,"[Incomplete Response]");break}if(i==Le){t.h=4,ve(15),he(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}he(t.c,t.f,i,null),Ge(t,i)}4==e&&0==n.length&&(t.h=1,ve(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(e),e.F=!0)):(he(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),qe(t))}function Ce(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Pe:(n=Number(e.substring(n,r)),isNaN(n)?Le:(r+=1)+n>e.length?Pe:(e=e.substr(r,n),t.D=r+n,e))}function Ue(t){t.U=U()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=me(V(t.Ua,t),e)}function Me(t){t.o&&(A.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),ae(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||En(n.b,t)))if(n.I=t.N,!t.C&&En(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;er(n),zn(n)}Zn(n),ve(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=me(V(n.Ra,n),6e3));if(1>=bn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else ir(n,11)}else if((t.C||n.a==t)&&er(n),!z(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=a.b;!l.a&&($(h,"spdy")||$(h,"quic")||$(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(In(l,l.b),l.b=null))}if(a.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(a.na=f,tn(a.B,a.A,f))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=U()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=sr(a,a.C?a.ga:null,a.fa),p.C){Tn(a.b,p);var d=p,y=a.D;y&&d.setTimeout(y),d.o&&(Me(d),Ue(d)),a.a=p}else Xn(a);0<n.g.length&&$n(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):Bn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);de(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)j(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)We(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Oe.prototype).setTimeout=function(t){this.P=t},T.Wa=function(t){t=t.target;var e=this.F;e&&3==Mn(t)?e.f():this.Ca(t)},T.Ca=function(t){try{if(t==this.a)t:{var e=Mn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||de(8==n||0>=r?3:2),Me(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,ve(12),je(this),qe(this);break t}he(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,a)}this.I?(Ve(this,e,o),ut&&this.b&&3==e&&(ue(this.J,this.R,"tick",this.Va),this.R.start())):(he(this.c,this.f,o,null),Ge(this,o)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ve(12)):(this.h=0,ve(13)),je(this),qe(this)}}}catch(t){}},T.Va=function(){if(this.a){var t=Mn(this.a),e=this.a.$();this.D<e.length&&(Me(this),Ve(this,t,e),this.b&&4!=t&&Ue(this))}},T.cancel=function(){this.A=!0,je(this)},T.Ua=function(){this.o=null;var t=U();0<=t-this.U?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(de(3),ve(17)),je(this),this.h=2,qe(this)):Fe(this,this.U-t)},(T=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.L=function(){return He(this),this.a.concat()},T.get=function(t,e){return We(this.b,t)?this.b[t]:e},T.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke){this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Xe(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b;var n=new ln;n.c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Je(this,n),this.i=t.i}else t&&(n=String(t).match($e))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=nn(n[2]||""),Xe(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ye(t){return new Ke(t)}function Qe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){e instanceof ln?(t.b=e,function(t,e){e&&!t.f&&(fn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=rn(e,cn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(t){t.a||(t.a=new ze,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function pn(t,e){fn(t),e=vn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return fn(t),e=vn(t,e),We(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),B(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t){this.g=t||mn,A.PerformanceNavigationTiming?t=0<(t=A.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(A.ia&&A.ia.ya&&A.ia.ya()&&A.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(t,e){fn(this),this.a.forEach(function(n,r){j(n,function(n){t.call(e,n,r,this)},this)},this)},T.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=G(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},T.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var mn=10;function wn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return B(t.c)}function _n(){}function An(t,e,n){var r=n||"";try{Be(t,function(t,n){var i=t;R(t)&&(i=zt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return A.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return A.JSON.parse(t,void 0)};var Dn=A.JSON.parse;function On(t){Gt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}F(On,Gt);var Rn="",Ln=/^https?$/i,Pn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Un(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Mn(t)||2!=t.X()))if(t.l&&4==Mn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Mn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match($e)[1]||null;if(!o&&A.self&&A.self.location){var s=A.self.location.protocol;o=s.substr(0,s.length-1)}i=!Ln.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Mn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(A.clearTimeout(t.m),t.m=null)}function Mn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return X(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function jn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=jn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=jn("baseRetryDelayMs",5e3,t),this.Ma=jn("retryDelaySeedMs",1e4,t),this.Ja=jn("forwardChannelMaxRetries",2,t),this.ma=jn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new function(){this.a=new _n},this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){if(Hn(t),3==t.v){var e=t.R++,n=Ye(t.B);tn(n,"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Yn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Ye(n)),n=!1,A.navigator&&A.navigator.sendBeacon&&(n=A.navigator.sendBeacon(e.i.toString(),"")),!n&&A.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)}or(t)}function zn(t){t.a&&(Jn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(A.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&A.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new function(t,e){this.b=t,this.a=e}(t.La++,e)),3==t.v&&$n(t)}function $n(t){wn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Kn(t,e){var n;n=e?e.f:t.R++;var r=Ye(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),xe(n,r,e)}function Yn(t,e){t.f&&Be({},function(t,n){tn(e,n,t)})}function Qn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{An(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Xn(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=me(V(t.Aa,t),rr(t,t.o)),t.o++,!0)}function Jn(t){null!=t.s&&(A.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Yn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ye(e)),n.j=null,n.I=!0,ke(n,t)}function er(t){null!=t.m&&(A.clearTimeout(t.m),t.m=null)}function nr(t,e){var n=null;if(t.a==e){er(t),Jn(t),t.a=null;var r=2}else{if(!En(t.b,e))return;n=e.s,Tn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=U()-e.u;var i=t.u;(r=fe()).dispatchEvent(new ge(r,n,e,i)),$n(t)}else Xn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(bn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=me(V(t.Ba,t,e),rr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Zn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=V(t.Xa,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||Qe(n,"https"),en(n)),function(t,e){var n=new ce;if(A.Image){var r=new Image;r.onload=C(Sn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=C(Sn,n,r,"TestLoadImage: error",!1,e),r.onabort=C(Sn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=C(Sn,n,r,"TestLoadImage: timeout",!1,e),A.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ve(2);t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r=function(t){return t instanceof Ke?Ye(t):new Ke(t,void 0)}(n);if(""!=r.c)e&&Xe(r,e+"."+r.c),Ze(r,r.h);else{var i=A.location;r=function(t,e,n,r){var i=new Ke(null,void 0);return t&&Qe(i,t),e&&Xe(i,e),n&&Ze(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&X(t.W,function(t,e){tn(r,e,t)}),e=t.A,n=t.na,e&&n&&tn(r,e,n),tn(r,"VER",t.ha),Yn(t,r),r}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function ar(){}function cr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Gt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function lr(t){Ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(T=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(Ne),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i=new ze(this.headers);r&&Be(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=A.FormData&&t instanceof A.FormData,!(0<=q(Pn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=function(t){return ot&&vt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},T.xa=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},T.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),On.S.G.call(this)},T.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},T.Ta=function(){Cn(this)},T.X=function(){try{return 2<Mn(this)?this.a.status:-1}catch(t){return-1}},T.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.ua=function(){return this.h},T.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Gn.prototype).ha=8,T.v=1,T.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),tn(i=Ye(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),In(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||wn(this.b)||Kn(this))},T.Aa=function(){if(this.j=null,tr(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=me(V(this.Sa,this),t)}},T.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},T.Ra=function(){null!=this.m&&(this.m=null,zn(this),Zn(this),ve(19))},T.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),ve(2)):(this.c.info("Failed to ping google.com"),ve(1))},(T=ar.prototype).ta=function(){},T.sa=function(){},T.ra=function(){},T.qa=function(){},T.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},F(hr,Gt),(T=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},T.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ve(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),$n(t)},T.close=function(){Bn(this.a)},T.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,Wn(this.a,e)}else this.g?((e={}).__data__=zt(t),Wn(this.a,e)):Wn(this.a,t)},T.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},F(lr,Ae),F(fr,Se),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,hr.prototype.close=hr.prototype.close,we.NO_ERROR=0,we.TIMEOUT=8,we.HTTP_ERROR=6,be.COMPLETE="complete",Te.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var dr={createWebChannelTransport:function(){return new cr},ErrorCode:we,EventType:be,WebChannel:Te,XhrIo:On},yr=dr.createWebChannelTransport,vr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Er=new y("@firebase/firestore");function Ir(){return Er.logLevel}function Tr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=r.DEBUG){var i=e.map(Ar);Er.debug.apply(Er,c(["Firestore (7.19.1): "+t],i))}}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=r.ERROR){var i=e.map(Ar);Er.error.apply(Er,c(["Firestore (7.19.1): "+t],i))}}function _r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=r.WARN){var i=e.map(Ar);Er.warn.apply(Er,c(["Firestore (7.19.1): "+t],i))}}function Ar(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Sr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw Nr(e),new Error(e)}function Dr(t,e){t||Sr()}function Or(t,e){return t}function Rr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Lr=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Rr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Pr(t,e){return t<e?-1:t>e?1:0}function xr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function kr(t){return t+"\0"}var Vr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.o=function(t){return Pr(this.projectId,t.projectId)||Pr(this.database,t.database)},t}();function Cr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Fr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr=function(){function t(t,e){this.h=t,this.u=e,this.l={}}return t.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Ur(this.l,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}})},t.prototype._=function(){return Fr(this.l)},t}(),qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},jr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s(e,t),e}(Error),Gr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new jr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new jr(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new jr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new jr(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.T=function(t){return this.seconds===t.seconds?Pr(this.nanoseconds,t.nanoseconds):Pr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Br=function(){function t(t){this.timestamp=t}return t.I=function(e){return new t(e)},t.min=function(){return new t(new Gr(0,0))},t.prototype.o=function(t){return this.timestamp.T(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.A=function(){return this.timestamp},t}(),zr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.R=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.P(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.g(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},t.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},t.prototype.v=function(){return this.segments[this.offset]},t.prototype.S=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype._=function(){return 0===this.length},t.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},t.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.prototype.F=function(){return this.N().join("/")},e.prototype.toString=function(){return this.F()},e.k=function(t){if(t.indexOf("//")>=0)throw new jr(qr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.$=function(){return new e([])},e}(zr),Wr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.O=function(t){return Wr.test(t)},e.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.O(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.F()},e.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},e.L=function(){return new e(["__name__"])},e.q=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new jr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new jr(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new jr(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new jr(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.$=function(){return new e([])},e}(zr),Kr=function(){function t(t){this.path=t}return t.B=function(e){return new t(Hr.k(e))},t.U=function(e){return new t(Hr.k(e).V(5))},t.prototype.W=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Hr.P(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.P=function(t,e){return Hr.P(t.path,e.path)},t.j=function(t){return t.length%2==0},t.K=function(e){return new t(new Hr(e.slice()))},t}();function Yr(t){return null==t}function Qr(t){return-0===t&&1/t==-1/0}function Xr(t){return"number"==typeof t&&Number.isInteger(t)&&!Qr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Zr=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function Jr(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Zr(t,e,n,r,i,o,s)}function ti(t){var e=Or(t);if(null===e.G){var n=e.path.F();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.F()+t.op.toString()+zi(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),Yr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Cs(e.startAt)),e.endAt&&(n+="|ub:",n+=Cs(e.endAt)),e.G=n}return e.G}function ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!js(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!qi(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fs(t.startAt,e.startAt)&&Fs(t.endAt,e.endAt)}function ni(t){return Kr.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ri=function(){function t(t){this.H=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.H,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},t.prototype.Y=function(){return 2*this.H.length},t.prototype.o=function(t){return Pr(this.H,t.H)},t.prototype.isEqual=function(t){return this.H===t.H},t}();ri.J=new ri("");var ii,oi,si=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Br.min()),void 0===o&&(o=Br.min()),void 0===s&&(s=ri.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.tt=function(e){return new t(this.target,this.targetId,this.X,e,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.et=function(e,n){return new t(this.target,this.targetId,this.X,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.nt=function(e){return new t(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,e,this.resumeToken)},t}();function ui(t){switch(t){case qr.OK:return Sr();case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return!1;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return!0;default:return Sr()}}function ai(t){if(void 0===t)return Nr("GRPC error has no .code"),qr.UNKNOWN;switch(t){case ii.OK:return qr.OK;case ii.CANCELLED:return qr.CANCELLED;case ii.UNKNOWN:return qr.UNKNOWN;case ii.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case ii.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case ii.INTERNAL:return qr.INTERNAL;case ii.UNAVAILABLE:return qr.UNAVAILABLE;case ii.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case ii.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case ii.NOT_FOUND:return qr.NOT_FOUND;case ii.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case ii.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case ii.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case ii.ABORTED:return qr.ABORTED;case ii.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case ii.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case ii.DATA_LOSS:return qr.DATA_LOSS;default:return Sr()}}(oi=ii||(ii={}))[oi.OK=0]="OK",oi[oi.CANCELLED=1]="CANCELLED",oi[oi.UNKNOWN=2]="UNKNOWN",oi[oi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oi[oi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oi[oi.NOT_FOUND=5]="NOT_FOUND",oi[oi.ALREADY_EXISTS=6]="ALREADY_EXISTS",oi[oi.PERMISSION_DENIED=7]="PERMISSION_DENIED",oi[oi.UNAUTHENTICATED=16]="UNAUTHENTICATED",oi[oi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oi[oi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oi[oi.ABORTED=10]="ABORTED",oi[oi.OUT_OF_RANGE=11]="OUT_OF_RANGE",oi[oi.UNIMPLEMENTED=12]="UNIMPLEMENTED",oi[oi.INTERNAL=13]="INTERNAL",oi[oi.UNAVAILABLE=14]="UNAVAILABLE",oi[oi.DATA_LOSS=15]="DATA_LOSS";var ci=function(){function t(t,e){this.P=t,this.root=e||li.EMPTY}return t.prototype.st=function(e,n){return new t(this.P,this.root.st(e,n,this.P).copy(null,null,li.it,null,null))},t.prototype.remove=function(e){return new t(this.P,this.root.remove(e,this.P).copy(null,null,li.it,null,null))},t.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype._=function(){return this.root._()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.rt=function(){return this.root.rt()},t.prototype.ot=function(){return this.root.ot()},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.forEach=function(t){this.ht(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.ht(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.at=function(t){return this.root.at(t)},t.prototype.ut=function(){return new hi(this.root,null,this.P,!1)},t.prototype.ct=function(t){return new hi(this.root,t,this.P,!1)},t.prototype.lt=function(){return new hi(this.root,null,this.P,!0)},t.prototype._t=function(t){return new hi(this.root,t,this.P,!0)},t}(),hi=function(){function t(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}return t.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},t.prototype.Tt=function(){return this.dt.length>0},t.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},t}(),li=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype._=function(){return!1},t.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},t.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},t.prototype.min=function(){return this.left._()?this:this.left.min()},t.prototype.rt=function(){return this.min().key},t.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},t.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},t.prototype.At=function(){if(this.left._())return t.EMPTY;var e=this;return e.left.Rt()||e.left.left.Rt()||(e=e.Pt()),(e=e.copy(null,null,null,e.left.At(),null)).It()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Rt()&&(i=i.gt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===n(e,i.key)){if(i.right._())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.At())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.It()},t.prototype.Rt=function(){return this.color},t.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},t.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},t.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},t.prototype.yt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.gt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},t.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Sr();if(this.right.Rt())throw Sr();var t=this.left.vt();if(t!==this.right.vt())throw Sr();return t+(this.Rt()?0:1)},t}();li.EMPTY=null,li.RED=!0,li.it=!1,li.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.st=function(t,e,n){return new li(t,e)},t.prototype.remove=function(t,e){return this},t.prototype._=function(){return!0},t.prototype.ht=function(t){return!1},t.prototype.at=function(t){return!1},t.prototype.rt=function(){return null},t.prototype.ot=function(){return null},t.prototype.Rt=function(){return!1},t.prototype.bt=function(){return!0},t.prototype.vt=function(){return 0},t}());var fi=function(){function t(t){this.P=t,this.data=new ci(this.P)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.rt()},t.prototype.last=function(){return this.data.ot()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ht(function(e,n){return t(e),!1})},t.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(this.P(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Dt=function(t,e){var n;for(n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},t.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},t.prototype.ut=function(){return new pi(this.data.ut())},t.prototype.ct=function(t){return new pi(this.data.ct(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype._=function(){return this.data._()},t.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ut(),r=e.data.ut();n.Tt();){var i=n.wt().key,o=r.wt().key;if(0!==this.P(i,o))return!1}return!0},t.prototype.N=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.P);return n.data=e,n},t}(),pi=function(){function t(t){this.Ft=t}return t.prototype.wt=function(){return this.Ft.wt().key},t.prototype.Tt=function(){return this.Ft.Tt()},t}(),di=new ci(Kr.P);function yi(){return di}function vi(){return yi()}var gi=new ci(Kr.P);function mi(){return gi}var wi=new ci(Kr.P),bi=new fi(Kr.P);function Ei(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=bi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ii=new fi(Pr);function Ti(){return Ii}var Ni=function(){function t(t){this.P=t?function(e,n){return t(e,n)||Kr.P(e.key,n.key)}:function(t,e){return Kr.P(t.key,e.key)},this.kt=mi(),this.$t=new ci(this.P)}return t.xt=function(e){return new t(e.P)},t.prototype.has=function(t){return null!=this.kt.get(t)},t.prototype.get=function(t){return this.kt.get(t)},t.prototype.first=function(){return this.$t.rt()},t.prototype.last=function(){return this.$t.ot()},t.prototype._=function(){return this.$t._()},t.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.$t.ht(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.$t.ut(),r=e.$t.ut();n.Tt();){var i=n.wt().key,o=r.wt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.P=this.P,r.kt=e,r.$t=n,r},t}(),_i=function(){function t(){this.Ot=new ci(Kr.P)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);n?0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):Sr():this.Ot=this.Ot.st(e,t)},t.prototype.Mt=function(){var t=[];return this.Ot.ht(function(e,n){t.push(n)}),t},t}(),Ai=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}return t.Qt=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Ni.xt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&Es(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Si=function(){function t(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}return t.zt=function(e,n){var r=new Map;return r.set(e,Di.Ht(e,n)),new t(Br.min(),r,Ti(),yi(),Ei())},t}(),Di=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}return t.Ht=function(e,n){return new t(ri.J,n,Ei(),Ei(),Ei())},t}(),Oi=function(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r},Ri=function(t,e){this.targetId=t,this.ne=e},Li=function(t,e,n,r){void 0===n&&(n=ri.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Pi=function(){function t(){this.se=0,this.ie=Vi(),this.re=ri.J,this.oe=!1,this.he=!0}return Object.defineProperty(t.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.ce=function(t){t.Y()>0&&(this.he=!0,this.re=t)},t.prototype.le=function(){var t=Ei(),e=Ei(),n=Ei();return this.ie.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Sr()}}),new Di(this.re,this.oe,t,e,n)},t.prototype._e=function(){this.he=!1,this.ie=Vi()},t.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},t.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},t.prototype.we=function(){this.se+=1},t.prototype.Te=function(){this.se-=1},t.prototype.Ee=function(){this.he=!0,this.oe=!0},t}(),xi=function(){function t(t){this.Ie=t,this.me=new Map,this.Ae=yi(),this.Re=ki(),this.Pe=new fi(Pr)}return t.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof as?this.Ve(r,t.ee):t.ee instanceof cs&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},t.prototype.pe=function(t){var e=this;this.be(t,function(n){var r=e.ve(n);switch(t.state){case 0:e.Se(n)&&r.ce(t.resumeToken);break;case 1:r.Te(),r.ae||r._e(),r.ce(t.resumeToken);break;case 2:r.Te(),r.ae||e.removeTarget(n);break;case 3:e.Se(n)&&(r.Ee(),r.ce(t.resumeToken));break;case 4:e.Se(n)&&(e.De(n),r.ce(t.resumeToken));break;default:Sr()}})},t.prototype.be=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.me.forEach(function(t,r){n.Se(r)&&e(r)})},t.prototype.Ce=function(t){var e=t.targetId,n=t.ne.count,r=this.Ne(e);if(r){var i=r.target;if(ni(i))if(0===n){var o=new Kr(i.path);this.ye(e,o,new cs(o,Br.min()))}else Dr(1===n);else this.Fe(e)!==n&&(this.De(e),this.Pe=this.Pe.add(e))}},t.prototype.ke=function(t){var e=this,n=new Map;this.me.forEach(function(r,i){var o=e.Ne(i);if(o){if(r.Yt&&ni(o.target)){var s=new Kr(o.target.path);null!==e.Ae.get(s)||e.$e(i,s)||e.ye(i,s,new cs(s,t))}r.ue&&(n.set(i,r.le()),r._e())}});var r=Ei();this.Re.forEach(function(t,n){var i=!0;n.Dt(function(t){var n=e.Ne(t);return!n||2===n.X||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Si(t,n,this.Pe,this.Ae,r);return this.Ae=yi(),this.Re=ki(),this.Pe=new fi(Pr),i},t.prototype.Ve=function(t,e){if(this.Se(t)){var n=this.$e(t,e.key)?2:0;this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t))}},t.prototype.ye=function(t,e,n){if(this.Se(t)){var r=this.ve(t);this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n))}},t.prototype.removeTarget=function(t){this.me.delete(t)},t.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},t.prototype.we=function(t){this.ve(t).we()},t.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Pi,this.me.set(t,e)),e},t.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new fi(Pr),this.Re=this.Re.st(t,e)),e},t.prototype.Se=function(t){var e=null!==this.Ne(t);return e||Tr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},t.prototype.De=function(t){var e=this;this.me.set(t,new Pi),this.Ie.Oe(t).forEach(function(n){e.ye(t,n,null)})},t.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},t}();function ki(){return new ci(Kr.P)}function Vi(){return new ci(Kr.P)}function Ci(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ui(t){var e=Hi(t.mapValue.fields.__local_write_time__.timestampValue);return new Gr(e.seconds,e.nanos)}var Fi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ci(t)?4:10:Sr()}function qi(t,e){var n=Mi(t);if(n!==Mi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ui(t).isEqual(Ui(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Hi(t.timestampValue),r=Hi(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return $i(t.bytesValue).isEqual($i(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Wi(t.geoPointValue.latitude)===Wi(e.geoPointValue.latitude)&&Wi(t.geoPointValue.longitude)===Wi(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Wi(t.integerValue)===Wi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Wi(t.doubleValue),r=Wi(e.doubleValue);return n===r?Qr(n)===Qr(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return xr(t.arrayValue.values||[],e.arrayValue.values||[],qi);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Cr(n)!==Cr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!qi(n[i],r[i])))return!1;return!0}(t,e);default:return Sr()}}function ji(t,e){return void 0!==(t.values||[]).find(function(t){return qi(t,e)})}function Gi(t,e){var n=Mi(t),r=Mi(e);if(n!==r)return Pr(n,r);switch(n){case 0:return 0;case 1:return Pr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Wi(t.integerValue||t.doubleValue),r=Wi(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Bi(t.timestampValue,e.timestampValue);case 4:return Bi(Ui(t),Ui(e));case 5:return Pr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=$i(t),r=$i(e);return n.o(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Pr(n[i],r[i]);if(0!==o)return o}return Pr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Pr(Wi(t.latitude),Wi(e.latitude));return 0!==n?n:Pr(Wi(t.longitude),Wi(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Gi(n[i],r[i]);if(o)return o}return Pr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Pr(r[s],o[s]);if(0!==u)return u;var a=Gi(n[r[s]],i[o[s]]);if(0!==a)return a}return Pr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function Bi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Pr(t,e);var n=Hi(t),r=Hi(e),i=Pr(n.seconds,r.seconds);return 0!==i?i:Pr(n.nanos,r.nanos)}function zi(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=Hi(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?$i(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,Kr.U(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Sr();var n,r}(t)}function Hi(t){if(Dr(!!t),"string"==typeof t){var e=0,n=Fi.exec(t);if(Dr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Wi(t.seconds),nanos:Wi(t.nanos)}}function Wi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $i(t){return"string"==typeof t?ri.fromBase64String(t):ri.fromUint8Array(t)}function Ki(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function Yi(t){return!!t&&"integerValue"in t}function Qi(t){return!!t&&"arrayValue"in t}function Xi(t){return!!t&&"nullValue"in t}function Zi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ji(t){return!!t&&"mapValue"in t}var to={asc:"ASCENDING",desc:"DESCENDING"},eo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},no=function(t,e){this.s=t,this.Le=e};function ro(t){return{integerValue:""+t}}function io(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qr(e)?"-0":e}}function oo(t,e){return Xr(e)?ro(e):io(t,e)}function so(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function uo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function ao(t){return Dr(!!t),Br.I(function(t){var e=Hi(t);return new Gr(e.seconds,e.nanos)}(t))}function co(t,e){return function(t){return new Hr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).F()}function ho(t){var e=Hr.k(t);return Dr(So(e)),e}function lo(t,e){return co(t.s,e.path)}function fo(t,e){var n=ho(e);return Dr(n.get(1)===t.s.projectId),Dr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new Kr(go(n))}function po(t,e){return co(t.s,e)}function yo(t){var e=ho(t);return 4===e.length?Hr.$():go(e)}function vo(t){return new Hr(["projects",t.s.projectId,"databases",t.s.database]).F()}function go(t){return Dr(t.length>4&&"documents"===t.get(4)),t.V(5)}function mo(t,e,n){return{name:lo(t,e),fields:n.proto.mapValue.fields}}function wo(t,e){var n;if(e instanceof Qo)n={update:mo(t,e.key,e.value)};else if(e instanceof ns)n={delete:lo(t,e.key)};else if(e instanceof Xo)n={update:mo(t,e.key,e.data),updateMask:function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.F())}),{fieldPaths:e}}(e.qe)};else if(e instanceof Jo)n={transform:{document:lo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Po)return{fieldPath:e.field.F(),setToServerValue:"REQUEST_TIME"};if(n instanceof xo)return{fieldPath:e.field.F(),appendMissingElements:{values:n.elements}};if(n instanceof Vo)return{fieldPath:e.field.F(),removeAllFromArray:{values:n.elements}};if(n instanceof Uo)return{fieldPath:e.field.F(),increment:n.Be};throw Sr()}(0,t)})}};else{if(!(e instanceof rs))return Sr();n={verify:lo(t,e.key)}}return e.Qe.Ue||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return so(t,e.A())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Sr()}(t,e.Qe)),n}function bo(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Go.updateTime(ao(t.updateTime)):void 0!==t.exists?Go.exists(t.exists):Go.We()}(e.currentDocument):Go.We();if(e.update){e.update.name;var r=fo(t,e.update.name),i=new is({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new qo(e.map(function(t){return $r.q(t)}))}(e.updateMask);return new Xo(r,i,o,n)}return new Qo(r,i,n)}if(e.delete){var s=fo(t,e.delete);return new ns(s,n)}if(e.transform){var u=fo(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;if("setToServerValue"in e)Dr("REQUEST_TIME"===e.setToServerValue),n=new Po;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new xo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Vo(i)}else"increment"in e?n=new Uo(t,e.increment):Sr();var o=$r.q(e.fieldPath);return new jo(o,n)}(t,e)});return Dr(!0===n.exists),new Jo(u,a)}if(e.verify){var c=fo(t,e.verify);return new rs(c,n)}return Sr()}function Eo(t,e){return{documents:[po(t,e.path)]}}function Io(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=po(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=po(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Zi(t.value))return{unaryFilter:{field:_o(t.field),op:"IS_NAN"}};if(Xi(t.value))return{unaryFilter:{field:_o(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Zi(t.value))return{unaryFilter:{field:_o(t.field),op:"IS_NOT_NAN"}};if(Xi(t.value))return{unaryFilter:{field:_o(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_o(t.field),op:function(t){return eo[t]}(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:_o(t.field),direction:function(t){return to[t]}(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Le||Yr(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=To(e.startAt)),e.endAt&&(n.structuredQuery.endAt=To(e.endAt)),n}function To(t){return{before:t.before,values:t.position}}function No(t){var e=!!t.before,n=t.values||[];return new Vs(n,e)}function _o(t){return{fieldPath:t.F()}}function Ao(t){return $r.q(t.fieldPath)}function So(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Do=function(){this.je=void 0};function Oo(t,e,n){return t instanceof Po?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof xo?ko(t,e):t instanceof Vo?Co(t,e):function(t,e){var n=Lo(t,e),r=Fo(n)+Fo(t.Be);return Yi(n)&&Yi(t.Be)?ro(r):io(t.serializer,r)}(t,e)}function Ro(t,e,n){return t instanceof xo?ko(t,e):t instanceof Vo?Co(t,e):n}function Lo(t,e){return t instanceof Uo?Yi(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(Do),xo=function(t){function e(e){var n;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Do);function ko(t,e){for(var n=Mo(e),r=function(t){n.some(function(e){return qi(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Vo=function(t){function e(e){var n;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Do);function Co(t,e){for(var n=Mo(e),r=function(t){n=n.filter(function(e){return!qi(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Uo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.Be=n,r}return s(e,t),e}(Do);function Fo(t){return Wi(t.integerValue||t.doubleValue)}function Mo(t){return Qi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qo=function(){function t(t){this.fields=t,t.sort($r.P)}return t.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},t.prototype.isEqual=function(t){return xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),jo=function(t,e){this.field=t,this.transform=e},Go=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.We=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Bo(t,e){return void 0!==t.updateTime?e instanceof as&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof as}var zo=function(){};function Ho(t,e,n){return t instanceof Qo?function(t,e,n){return new as(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Xo?function(t,e,n){if(!Bo(t.Qe,e))return new hs(t.key,n.version);var r=Zo(t,e);return new as(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Jo?function(t,e,n){if(Dr(null!=n.transformResults),!Bo(t.Qe,e))return new hs(t.key,n.version);var r=ts(t,e),i=function(t,e,n){var r=[];Dr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof as&&(u=e.field(o.field)),r.push(Ro(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=es(t,r.data(),i);return new as(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new cs(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Wo(t,e,n,r){return t instanceof Qo?function(t,e){if(!Bo(t.Qe,e))return e;var n=Yo(e);return new as(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Xo?function(t,e){if(!Bo(t.Qe,e))return e;var n=Yo(e),r=Zo(t,e);return new as(t.key,n,r,{Ge:!0})}(t,e):t instanceof Jo?function(t,e,n,r){if(!Bo(t.Qe,e))return e;var i=ts(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof as&&(c=n.field(u.field)),null===c&&r instanceof as&&(c=r.field(u.field)),i.push(Oo(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=es(t,i.data(),o);return new as(t.key,i.version,s,{Ge:!0})}(t,e,r,n):function(t,e){return Bo(t.Qe,e)?new cs(t.key,Br.min()):e}(t,e)}function $o(t,e){return t instanceof Jo?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof as?e.field(o.field):void 0,u=Lo(o.transform,s||null);null!=u&&(n=null==n?(new os).set(o.field,u):n.set(o.field,u))}return n?n.ze():null}(t,e):null}function Ko(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||xr(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof xo&&e instanceof xo||t instanceof Vo&&e instanceof Vo?xr(t.elements,e.elements,qi):t instanceof Uo&&e instanceof Uo?qi(t.Be,e.Be):t instanceof Po&&e instanceof Po}(t.transform,e.transform)}(t,e)}))}function Yo(t){return t instanceof as?t.version:Br.min()}var Qo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Qe=r,i.type=0,i}return s(e,t),e}(zo),Xo=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.qe=r,o.Qe=i,o.type=1,o}return s(e,t),e}(zo);function Zo(t,e){return function(t,e){var n=new os(e);return t.qe.fields.forEach(function(e){if(!e._()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.ze()}(t,e instanceof as?e.data():is.empty())}var Jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Qe=Go.exists(!0),r}return s(e,t),e}(zo);function ts(t,e){return e}function es(t,e,n){for(var r=new os(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var ns=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Qe=n,r.type=3,r}return s(e,t),e}(zo),rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Qe=n,r.type=4,r}return s(e,t),e}(zo),is=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ji(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},t.prototype.isEqual=function(t){return qi(this.proto,t.proto)},t}(),os=function(){function t(t){void 0===t&&(t=is.empty()),this.He=t,this.Ye=new Map}return t.prototype.set=function(t,e){return this.Je(t,e),this},t.prototype.delete=function(t){return this.Je(t,null),this},t.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Mi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.S(),e)},t.prototype.ze=function(){var t=this.Xe($r.$(),this.Ye);return null!=t?new is(t):this.He},t.prototype.Xe=function(t,e){var n=this,r=!1,i=this.He.field(t),o=Ji(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.Xe(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function ss(t){var e=[];return Ur(t.fields||{},function(t,n){var r=new $r([t]);if(Ji(n)){var i=ss(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)}),new qo(e)}var us=function(t,e){this.key=t,this.version=e},as=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Ze=r,o.Ge=!!i.Ge,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return s(e,t),e.prototype.field=function(t){return this.Ze.field(t)},e.prototype.data=function(){return this.Ze},e.prototype.tn=function(){return this.Ze.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(us),cs=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(us),hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(us);function ls(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new jr(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new jr(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var fs=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}return t.prototype.on=function(e){return new t(e,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},t.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},t.prototype.an=function(){return!Yr(this.limit)&&"F"===this.nn},t.prototype.un=function(){return!Yr(this.limit)&&"L"===this.nn},t.prototype.cn=function(){return this.en.length>0?this.en[0].field:null},t.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},t.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(t.indexOf(r.op)>=0)return r.op}return null},t}();function ps(t,e,n,r,i,o,s,u){return new fs(t,e,n,r,i,o,s,u)}function ds(t){return new fs(t)}function ys(t){return null!==t.collectionGroup}function vs(t){var e=ls(t,fs);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new Ms(n)),e.sn.push(new Ms($r.L(),"asc"));else{for(var i=!1,o=0,s=e.en;o<s.length;o++){var u=s[o];e.sn.push(u),u.field.M()&&(i=!0)}if(!i){var a=e.en.length>0?e.en[e.en.length-1].dir:"asc";e.sn.push(new Ms($r.L(),a))}}}return e.sn}function gs(t){var e=ls(t,fs);if(!e.rn)if("F"===e.nn)e.rn=Jr(e.path,e.collectionGroup,vs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ms(o.field,s))}var u=e.endAt?new Vs(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Vs(e.startAt.position,!e.startAt.before):null;e.rn=Jr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function ms(t,e,n){return new fs(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ws(t,e){return new fs(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function bs(t,e){return new fs(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function Es(t,e){return ei(gs(t),gs(e))&&t.nn===e.nn}function Is(t){return ti(gs(t))+"|lt:"+t.nn}function Ts(t){return"Query(target="+function(t){var e=t.path.F();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+zi(e.value);var e}).join(", ")+"]"),Yr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Cs(t.startAt)),t.endAt&&(e+=", endAt: "+Cs(t.endAt)),"Target("+e+")"}(gs(t))+"; limitType="+t.nn+")"}function Ns(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.W(t.collectionGroup)&&t.path.D(n):Kr.j(t.path)?t.path.isEqual(n):t.path.C(n)}(t,e)&&function(t,e){for(var n=0,r=t.en;n<r.length;n++){var i=r[n];if(!i.field.M()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Us(t.startAt,vs(t),e)||t.endAt&&Us(t.endAt,vs(t),e))}(t,e)}function _s(t){return function(e,n){for(var r=!1,i=0,o=vs(t);i<o.length;i++){var s=o[i],u=qs(s,e,n);if(0!==u)return u;r=r||s.field.M()}return 0}}var As=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return s(e,t),e.create=function(t,n,r){if(t.M())return"in"===n||"not-in"===n?this.dn(t,n,r):new Ss(t,n,r);if(Xi(r)){if("=="!==n&&"!="!==n)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(Zi(r)){if("=="!==n&&"!="!==n)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return"array-contains"===n?new Ls(t,r):"in"===n?new Ps(t,r):"not-in"===n?new xs(t,r):"array-contains-any"===n?new ks(t,r):new e(t,n,r)},e.dn=function(t,e,n){return"in"===e?new Ds(t,n):new Os(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(Gi(e,this.value)):null!==e&&Mi(this.value)===Mi(e)&&this.wn(Gi(e,this.value))},e.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Sr()}},e.prototype._n=function(){return["<","<=",">",">=","!="].indexOf(this.op)>=0},e}(function(){}),Ss=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).key=Kr.U(r.referenceValue),i}return s(e,t),e.prototype.matches=function(t){var e=Kr.P(t.key,this.key);return this.wn(e)},e}(As),Ds=function(t){function e(e,n){var r;return(r=t.call(this,e,"in",n)||this).keys=Rs("in",n),r}return s(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(As),Os=function(t){function e(e,n){var r;return(r=t.call(this,e,"not-in",n)||this).keys=Rs("not-in",n),r}return s(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(As);function Rs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Kr.U(t.referenceValue)})}var Ls=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Qi(e)&&ji(e.arrayValue,this.value)},e}(As),Ps=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ji(this.value.arrayValue,e)},e}(As),xs=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!ji(this.value.arrayValue,e)},e}(As),ks=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return s(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Qi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ji(e.value.arrayValue,t)})},e}(As),Vs=function(t,e){this.position=t,this.before=e};function Cs(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return zi(t)}).join(",")}function Us(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.M()?Kr.P(Kr.U(s.referenceValue),n.key):Gi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Fs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qi(t.position[n],e.position[n]))return!1;return!0}var Ms=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function qs(t,e,n){var r=t.field.M()?Kr.P(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Gi(r,i):Sr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Sr()}}function js(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Gs=function(){function t(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}return t.prototype.En=function(t,e,n){for(var r=n.In,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ho(o,e,r[i]))}return e},t.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Wo(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Wo(a,e,o,this.Tn))}return e},t.prototype.An=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.mn(r.key,t.get(r.key));i&&(n=n.st(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ei())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&xr(this.mutations,t.mutations,function(t,e){return Ko(t,e)})&&xr(this.baseMutations,t.baseMutations,function(t,e){return Ko(t,e)})},t}(),Bs=function(){function t(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}return t.from=function(e,n,r){Dr(e.mutations.length===r.length);for(var i=wi,o=e.mutations,s=0;s<o.length;s++)i=i.st(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),zs=function(){function t(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.pn&&Sr(),this.pn=!0,this.yn?this.error?this.bn(n,this.error):this.vn(e,this.result):new t(function(t,i){r.gn=function(n){r.vn(e,n).next(t,i)},r.Vn=function(e){r.bn(n,e).next(t,i)}})},t.prototype.Sn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Dn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.vn=function(e,n){return e?this.Dn(function(){return e(n)}):t.resolve(n)},t.prototype.bn=function(e,n){return e?this.Dn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.Cn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Nn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.Cn(r)},t}(),Hs=function(){function t(){this.Fn=new Mr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),t.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},t.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},t.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?zs.resolve(n):this.qn(t,e)},t.prototype.getEntries=function(t,e){return this.Bn(t,e)},t.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},t.prototype.On=function(){},t}(),Ws="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",$s=function(){function t(){this.Qn=[]}return t.prototype.Wn=function(t){this.Qn.push(t)},t.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},t}(),Ks=function(){function t(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}return t.prototype.Hn=function(t,e){var n=this;return this.Gn.Yn(t,e).next(function(r){return n.Jn(t,e,r)})},t.prototype.Jn=function(t,e,n){return this.Kn.Ln(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].mn(e,t);return t})},t.prototype.Xn=function(t,e,n){var r=vi();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].mn(t,e);r=r.st(t,e)}),r},t.prototype.Zn=function(t,e){var n=this;return this.Kn.getEntries(t,e).next(function(e){return n.ts(t,e)})},t.prototype.ts=function(t,e){var n=this;return this.Gn.es(t,e).next(function(r){var i=n.Xn(t,e,r),o=yi();return i.forEach(function(t,e){e||(e=new cs(t,Br.min())),o=o.st(t,e)}),o})},t.prototype.ns=function(t,e,n){return function(t){return Kr.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ss(t,e.path):ys(e)?this.rs(t,e,n):this.os(t,e,n)},t.prototype.ss=function(t,e){return this.Hn(t,new Kr(e)).next(function(t){var e=mi();return t instanceof as&&(e=e.st(t.key,t)),e})},t.prototype.rs=function(t,e,n){var r=this,i=e.collectionGroup,o=mi();return this.zn.hs(t,i).next(function(s){return zs.forEach(s,function(s){var u=e.on(s.child(i));return r.os(t,u,n).next(function(t){t.forEach(function(t,e){o=o.st(t,e)})})}).next(function(){return o})})},t.prototype.os=function(t,e,n){var r,i,o=this;return this.Kn.ns(t,e,n).next(function(n){return r=n,o.Gn.as(t,e)}).next(function(e){return i=e,o.us(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),l=Wo(a,h,h,o.Tn);r=l instanceof as?r.st(c,l):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Ns(e,n)||(r=r.remove(t))}),r})},t.prototype.us=function(t,e,n){for(var r=Ei(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Xo&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof as&&(c=c.st(t,e))}),c})},t}(),Ys=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}return t._s=function(e,n){for(var r=Ei(),i=Ei(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Qs=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}return t.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},t}();Qs.Es=-1;var Xs=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Zs=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}return t.prototype.reset=function(){this.gs=0},t.prototype.ps=function(){this.gs=this.Ps},t.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);i>0&&Tr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},t.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},t.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},t.prototype.vs=function(){return(Math.random()-.5)*this.gs},t}(),Js=function(){function t(e,n,r){this.name=e,this.version=n,this.Ns=r,12.2===t.Fs(v())&&Nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Tr("SimpleDb","Removing database:",t),ou(window.indexedDB.deleteDatabase(t)).Sn()},t.ks=function(){if("undefined"==typeof indexedDB)return!1;if(t.$s())return!0;var e=v(),n=t.Fs(e),r=0<n&&n<10,i=t.xs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},t.Ms=function(t,e){return t.store(e)},t.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Ls=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:return this.db?[3,2]:(Tr("SimpleDb","Opening database:",this.name),t=this,[4,new Promise(function(t,n){var r=indexedDB.open(e.name,e.version);r.onsuccess=function(e){var n=e.target.result;t(n)},r.onblocked=function(){n(new eu("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){var e=t.target.error;"VersionError"===e.name?n(new jr(qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new eu(e))},r.onupgradeneeded=function(t){Tr("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;e.Ns.createOrUpgrade(n,r.transaction,t.oldVersion,e.version).next(function(){Tr("SimpleDb","Database upgrade to version "+e.version+" complete")})}})]);case 1:t.db=n.sent(),n.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return e.qs(t)}),this.db)]}})})},t.prototype.Bs=function(t){this.qs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u;return a(this,function(c){switch(c.label){case 0:r="readonly"===t,i=0,o=function(){var t,o,u,c,h;return a(this,function(a){switch(a.label){case 0:++i,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,s.Ls()];case 2:return s.db=a.sent(),t=ru.open(s.db,r?"readonly":"readwrite",e),o=n(t).catch(function(e){return t.abort(e),zs.reject(e)}).Sn(),u={},o.catch(function(){}),[4,t.Us];case 3:return[2,(u.value=(a.sent(),o),u)];case 4:return c=a.sent(),h="FirebaseError"!==c.name&&i<3,Tr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",c.message,h),s.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},s=this,c.label=1;case 1:return[5,o()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),tu=function(){function t(t){this.Qs=t,this.Ws=!1,this.js=null}return Object.defineProperty(t.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Ws=!0},t.prototype.Gs=function(t){this.js=t},t.prototype.delete=function(){return ou(this.Qs.delete())},t}(),eu=function(t){function e(e){var n;return(n=t.call(this,qr.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return s(e,t),e}(jr);function nu(t){return"IndexedDbTransactionError"===t.name}var ru=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.zs=new Xs,this.transaction.oncomplete=function(){e.zs.resolve()},this.transaction.onabort=function(){t.error?e.zs.reject(new eu(t.error)):e.zs.resolve()},this.transaction.onerror=function(t){var n=uu(t.target.error);e.zs.reject(new eu(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new eu(e)}},Object.defineProperty(t.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(Tr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new iu(e)},t}(),iu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Tr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Tr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ou(n)},t.prototype.add=function(t){return Tr("SimpleDb","ADD",this.store.name,t,t),ou(this.store.add(t))},t.prototype.get=function(t){var e=this;return ou(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Tr("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Tr("SimpleDb","DELETE",this.store.name,t),ou(this.store.delete(t))},t.prototype.count=function(){return Tr("SimpleDb","COUNT",this.store.name),ou(this.store.count())},t.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Js=function(t,e){Tr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},t.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},t.prototype.ti=function(t){var e=this.cursor({});return new zs(function(n,r){e.onerror=function(t){var e=uu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.Ys=function(t,e){var n=[];return new zs(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new tu(i),s=e(i.primaryKey,i.value,o);if(s instanceof zs){var u=s.catch(function(t){return o.done(),zs.reject(t)});n.push(u)}o.yn?r():null===o.Ks?i.continue():i.continue(o.Ks)}else r()}}).next(function(){return zs.Cn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ou(t){return new zs(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=uu(t.target.error);n(e)}})}var su=!1;function uu(t){var e=Js.Fs(v());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return su||(su=!0,setTimeout(function(){throw r},0)),r}}return t}function au(){return"undefined"!=typeof window?window:null}function cu(){return"undefined"!=typeof document?document:null}var hu=function(){function t(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new Xs,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}return t.ri=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},t.prototype.Cs=function(){return this.hi()},t.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new jr(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.hi=function(){var t=this;this.ei.ai(function(){return null!==t.oi?(t.clearTimeout(),t.op().then(function(e){return t.ii.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},t}(),lu=function(){function t(){var t=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new Zs(this,"async_queue_retry"),this.Ei=function(){var e=cu();e&&Tr("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.Ti.Ds()};var e=cu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ei)}return Object.defineProperty(t.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),t.prototype.ai=function(t){this.enqueue(t)},t.prototype.mi=function(t){this.Ai(),this.Ri(t)},t.prototype.Pi=function(){if(!this.li){this.li=!0;var t=cu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei)}},t.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},t.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai(function(){return e.Vi()})},t.prototype.Vi=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:if(0===this.ci.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return n.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!nu(t=n.sent()))throw t;return Tr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.ci.length>0&&this.Ti.bs(function(){return e.Vi()}),n.label=5;case 5:return[2]}})})},t.prototype.Ri=function(t){var e=this,n=this.ui.then(function(){return e.di=!0,t().catch(function(t){throw e.fi=t,e.di=!1,Nr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.di=!1,t})});return this.ui=n,n},t.prototype.Ss=function(t,e,n){var r=this;this.Ai(),this.wi.indexOf(t)>-1&&(e=0);var i=hu.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},t.prototype.Ai=function(){this.fi&&Sr()},t.prototype.pi=function(){},t.prototype.bi=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,t=this.ui];case 1:e.sent(),e.label=2;case 2:if(t!==this.ui)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},t.prototype.Si=function(t){var e=this;return this.bi().then(function(){e._i.sort(function(t,e){return t.ni-e.ni});for(var n=0,r=e._i;n<r.length;n++){var i=r[n];if(i.Cs(),"all"!==t&&i.ms===t)break}return e.bi()})},t.prototype.Di=function(t){this.wi.push(t)},t.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},t}();function fu(t,e){if(Nr("AsyncQueue",e+": "+t),nu(t))return new jr(qr.UNAVAILABLE,e+": "+t);throw t}function pu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Pr(n,i);return 0===s?Pr(r,o):s}var du=function(){function t(t){this.Ci=t,this.buffer=new fi(pu),this.Ni=0}return t.prototype.Fi=function(){return++this.Ni},t.prototype.ki=function(t){var e=[t,this.Fi()];if(this.buffer.size<this.Ci)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();pu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),yu={$i:!1,xi:0,Oi:0,Mi:0},vu=function(){function t(t,e,n){this.Li=t,this.qi=e,this.Bi=n}return t.Ui=function(e){return new t(e,t.Qi,t.Wi)},t}();vu.ji=-1,vu.Ki=1048576,vu.Gi=41943040,vu.Qi=10,vu.Wi=1e3,vu.zi=new vu(vu.Gi,vu.Qi,vu.Wi),vu.Hi=new vu(vu.ji,0,0);var gu=function(){function t(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}return t.prototype.start=function(t){this.Yi.params.Li!==vu.ji&&this.Zi(t)},t.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(t.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),t.prototype.Zi=function(t){var e=this,n=this.Ji?3e5:6e4;Tr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",n,function(){return u(e,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:this.Xi=null,this.Ji=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.er(this.Yi)];case 2:return n.sent(),[3,7];case 3:return nu(e=n.sent())?(Tr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ra(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Zi(t)];case 8:return n.sent(),[2]}})})})},t}(),mu=function(){function t(t,e){this.nr=t,this.params=e}return t.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.rr=function(t,e){var n=this;if(0===e)return zs.resolve(Qs.Es);var r=new du(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},t.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},t.prototype.ar=function(t,e){return this.nr.ar(t,e)},t.prototype.ur=function(t,e){var n=this;return this.params.Li===vu.ji?(Tr("LruGarbageCollector","Garbage collection skipped; disabled"),zs.resolve(yu)):this.cr(t).next(function(r){return r<n.params.Li?(Tr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Li),yu):n.lr(t,e)})},t.prototype.cr=function(t){return this.nr.cr(t)},t.prototype.lr=function(t,e){var n,i,o,s,u,a,c,h=this,l=Date.now();return this.sr(t,this.params.qi).next(function(e){return e>h.params.Bi?(Tr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+e),i=h.params.Bi):i=e,s=Date.now(),h.rr(t,i)}).next(function(r){return n=r,u=Date.now(),h.hr(t,n,e)}).next(function(e){return o=e,a=Date.now(),h.ar(t,n)}).next(function(t){return c=Date.now(),Ir()<=r.DEBUG&&Tr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),zs.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},t}();function wu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Eu(e)),e=bu(t.get(n),e);return Eu(e)}function bu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Eu(t){return t+""}function Iu(t){var e=t.length;if(Dr(e>=2),2===e)return Dr(""===t.charAt(0)&&""===t.charAt(1)),Hr.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Sr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Sr()}o=s+2}return new Hr(r)}var Tu=function(t){this._r=t};function Nu(t,e){if(e.document)return function(t,e,n){var r=fo(t,e.name),i=ao(e.updateTime),o=new is({mapValue:{fields:e.fields}});return new as(r,i,o,{hasCommittedMutations:!!n})}(t._r,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Kr.K(e.noDocument.path),r=Ou(e.noDocument.readTime);return new cs(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Kr.K(e.unknownDocument.path),o=Ou(e.unknownDocument.version);return new hs(i,o)}return Sr()}function _u(t,e,n){var r=Au(n),i=e.key.path.p().N();if(e instanceof as){var o=function(t,e){return{name:lo(t,e.key),fields:e.tn().mapValue.fields,updateTime:so(t,e.version.A())}}(t._r,e),s=e.hasCommittedMutations;return new ta(null,null,o,s,r,i)}if(e instanceof cs){var u=e.key.path.N(),a=Du(e.version),c=e.hasCommittedMutations;return new ta(null,new Zu(u,a),null,c,r,i)}if(e instanceof hs){var h=e.key.path.N(),l=Du(e.version);return new ta(new Ju(h,l),null,null,!0,r,i)}return Sr()}function Au(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Su(t){var e=new Gr(t[0],t[1]);return Br.I(e)}function Du(t){var e=t.A();return new $u(e.seconds,e.nanoseconds)}function Ou(t){var e=new Gr(t.seconds,t.nanoseconds);return Br.I(e)}function Ru(t,e){var n=(e.baseMutations||[]).map(function(e){return bo(t._r,e)}),r=e.mutations.map(function(e){return bo(t._r,e)}),i=Gr.fromMillis(e.localWriteTimeMs);return new Gs(e.batchId,i,n,r)}function Lu(t){var e,n,r=Ou(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ou(t.lastLimboFreeSnapshotVersion):Br.min();return void 0!==t.query.documents?(Dr(1===(n=t.query).documents.length),e=gs(ds(yo(n.documents[0])))):e=function(t){var e=yo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Dr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ao(t.unaryFilter.field);return As.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ao(t.unaryFilter.field);return As.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ao(t.unaryFilter.field);return As.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ao(t.unaryFilter.field);return As.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}(e)]:void 0!==e.fieldFilter?[function(t){return As.create(Ao(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(t.fieldFilter.op),t.fieldFilter.value)}(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(t,e){return t.concat(e)}):Sr():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new Ms(Ao(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return Yr(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=No(n.startAt));var h=null;return n.endAt&&(h=No(n.endAt)),gs(ps(e,i,u,s,a,"F",c,h))}(t.query),new si(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ri.fromBase64String(t.resumeToken))}function Pu(t,e){var n,r=Du(e.Z),i=Du(e.lastLimboFreeSnapshotVersion);n=ni(e.target)?Eo(t._r,e.target):Io(t._r,e.target);var o=e.resumeToken.toBase64();return new na(e.targetId,ti(e.target),r,o,e.sequenceNumber,i,n)}var xu=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}return t.Tr=function(e,n,r,i){return Dr(""!==e.uid),new t(e.Er()?e.uid:"",n,r,i)},t.prototype.Ir=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cu(t).Zs({index:Qu.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.mr=function(t,e,n,r){var i=this,o=Uu(t),s=Cu(t);return s.add({}).next(function(u){Dr("number"==typeof u);for(var a=new Gs(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return wo(t._r,e)}),i=n.mutations.map(function(e){return wo(t._r,e)});return new Qu(e,n.batchId,n.Tn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],l=new fi(function(t,e){return Pr(t.F(),e.F())}),f=0,p=r;f<p.length;f++){var d=p[f],y=Xu.key(i.userId,d.key.path,u);l=l.add(d.key.path.p()),h.push(s.put(c)),h.push(o.put(y,Xu.PLACEHOLDER))}return l.forEach(function(e){h.push(i.zn.Ar(t,e))}),t.Wn(function(){i.wr[u]=a.keys()}),zs.Cn(h).next(function(){return a})})},t.prototype.Rr=function(t,e){var n=this;return Cu(t).get(e).next(function(t){return t?(Dr(t.userId===n.userId),Ru(n.serializer,t)):null})},t.prototype.Pr=function(t,e){var n=this;return this.wr[e]?zs.resolve(this.wr[e]):this.Rr(t,e).next(function(t){if(t){var r=t.keys();return n.wr[e]=r,r}return null})},t.prototype.gr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Cu(t).Zs({index:Qu.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Dr(e.batchId>=r),o=Ru(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Cu(t).Zs({index:Qu.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cu(t).Hs(Qu.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ru(e.serializer,t)})})},t.prototype.Yn=function(t,e){var n=this,r=Xu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Uu(t).Zs({range:i},function(r,i,s){var u=r[0],a=r[1],c=r[2],h=Iu(a);if(u===n.userId&&e.path.isEqual(h))return Cu(t).get(c).next(function(t){if(!t)throw Sr();Dr(t.userId===n.userId),o.push(Ru(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.es=function(t,e){var n=this,r=new fi(Pr),i=[];return e.forEach(function(e){var o=Xu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Uu(t).Zs({range:s},function(t,i,o){var s=t[0],u=t[1],a=t[2],c=Iu(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()});i.push(u)}),zs.Cn(i).next(function(){return n.pr(t,r)})},t.prototype.as=function(t,e){var n=this,r=e.path,i=r.length+1,o=Xu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new fi(Pr);return Uu(t).Zs({range:s},function(t,e,o){var s=t[0],a=t[1],c=t[2],h=Iu(a);s===n.userId&&r.D(h)?h.length===i&&(u=u.add(c)):o.done()}).next(function(){return n.pr(t,u)})},t.prototype.pr=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Cu(t).get(e).next(function(t){if(null===t)throw Sr();Dr(t.userId===n.userId),r.push(Ru(n.serializer,t))}))}),zs.Cn(i).next(function(){return r})},t.prototype.br=function(t,e){var n=this;return Vu(t.vr,this.userId,e).next(function(r){return t.Wn(function(){n.Sr(e.batchId)}),zs.forEach(r,function(e){return n.dr.Dr(t,e)})})},t.prototype.Sr=function(t){delete this.wr[t]},t.prototype.Cr=function(t){var e=this;return this.Ir(t).next(function(n){if(!n)return zs.resolve();var r=IDBKeyRange.lowerBound(Xu.prefixForUser(e.userId)),i=[];return Uu(t).Zs({range:r},function(t,n,r){if(t[0]===e.userId){var o=Iu(t[1]);i.push(o)}else r.done()}).next(function(){Dr(0===i.length)})})},t.prototype.Nr=function(t,e){return ku(t,this.userId,e)},t.prototype.Fr=function(t){var e=this;return Fu(t).get(this.userId).next(function(t){return t||new Yu(e.userId,-1,"")})},t}();function ku(t,e,n){var r=Xu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Uu(t).Zs({range:o,Xs:!0},function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()}).next(function(){return s})}function Vu(t,e,n){var r=t.store(Qu.store),i=t.store(Xu.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Dr(1===u)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Xu.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return zs.Cn(o).next(function(){return c})}function Cu(t){return ma.Ms(t,Qu.store)}function Uu(t){return ma.Ms(t,Xu.store)}function Fu(t){return ma.Ms(t,Yu.store)}var Mu=function(){function t(t,e){this.serializer=t,this.zn=e}return t.prototype.xn=function(t,e,n){return ju(t).put(Gu(e),n)},t.prototype.Mn=function(t,e){var n=ju(t),r=Gu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.kr(t,r)})},t.prototype.Ln=function(t,e){var n=this;return ju(t).get(Gu(e)).next(function(t){return n.$r(t)})},t.prototype.xr=function(t,e){var n=this;return ju(t).get(Gu(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:Bu(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=vi();return this.Mr(t,e,function(t,e){var i=n.$r(e);r=r.st(t,i)}).next(function(){return r})},t.prototype.Lr=function(t,e){var n=this,r=vi(),i=new ci(Kr.P);return this.Mr(t,e,function(t,e){var o=n.$r(e);o?(r=r.st(t,o),i=i.st(t,Bu(e))):(r=r.st(t,null),i=i.st(t,0))}).next(function(){return{qr:r,Br:i}})},t.prototype.Mr=function(t,e,n){if(e._())return zs.resolve();var r=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),i=e.ut(),o=i.wt();return ju(t).Zs({range:r},function(t,e,r){for(var s=Kr.K(t);o&&Kr.P(o,s)<0;)n(o,null),o=i.wt();o&&o.isEqual(s)&&(n(o,e),o=i.Tt()?i.wt():null),o?r.Gs(o.path.N()):r.done()}).next(function(){for(;o;)n(o,null),o=i.Tt()?i.wt():null})},t.prototype.ns=function(t,e,n){var r=this,i=mi(),o=e.path.length+1,s={};if(n.isEqual(Br.min())){var u=e.path.N();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.N(),c=Au(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=ta.collectionReadTimeIndex}return ju(t).Zs(s,function(t,n,s){if(t.length===o){var u=Nu(r.serializer,n);e.path.D(u.key.path)?u instanceof as&&Ns(e,u)&&(i=i.st(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.Ur=function(t,e){var n=this,r=yi(),i=Au(e),o=ju(t),s=IDBKeyRange.lowerBound(i,!0);return o.Zs({index:ta.readTimeIndex,range:s},function(t,e){var o=Nu(n.serializer,e);r=r.st(o.key,o),i=e.readTime}).next(function(){return{Qr:r,readTime:Su(i)}})},t.prototype.Wr=function(t){var e=ju(t),n=Br.min();return e.Zs({index:ta.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Su(e.readTime)),r.done()}).next(function(){return n})},t.prototype.jr=function(e){return new t.Kr(this,!!e&&e.Gr)},t.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return qu(t).get(ea.key).next(function(t){return Dr(!!t),t})},t.prototype.kr=function(t,e){return qu(t).put(ea.key,e)},t.prototype.$r=function(t){if(t){var e=Nu(this.serializer,t);return e instanceof cs&&e.version.isEqual(Br.min())?null:e}return null},t}();function qu(t){return ma.Ms(t,ea.store)}function ju(t){return ma.Ms(t,ta.store)}function Gu(t){return t.path.N()}function Bu(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Sr();e=t.noDocument}return JSON.stringify(e).length}Mu.Kr=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Hr=e,r.Gr=n,r.Yr=new Mr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return s(e,t),e.prototype.Un=function(t){var e=this,n=[],r=0,i=new fi(function(t,e){return Pr(t.F(),e.F())});return this.Fn.forEach(function(o,s){var u=e.Yr.get(o);if(s){var a=_u(e.Hr.serializer,s,e.readTime);i=i.add(o.path.p());var c=Bu(a);r+=c-u,n.push(e.Hr.xn(t,o,a))}else if(r-=u,e.Gr){var h=_u(e.Hr.serializer,new cs(o,Br.min()),e.readTime);n.push(e.Hr.xn(t,o,h))}else n.push(e.Hr.Mn(t,o))}),i.forEach(function(r){n.push(e.Hr.zn.Ar(t,r))}),n.push(this.Hr.updateMetadata(t,r)),zs.Cn(n)},e.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},e.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},e}(Hs);var zu=function(){function t(){this.Jr=new Hu}return t.prototype.Ar=function(t,e){return this.Jr.add(e),zs.resolve()},t.prototype.hs=function(t,e){return zs.resolve(this.Jr.getEntries(e))},t}(),Hu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new fi(Hr.P),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new fi(Hr.P)).N()},t}(),Wu=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Dr(n<r&&n>=0&&r<=10);var o=new ru(e);n<1&&r>=1&&(function(t){t.createObjectStore(Ku.store)}(t),function(t){t.createObjectStore(Yu.store,{keyPath:Yu.keyPath}),t.createObjectStore(Qu.store,{keyPath:Qu.keyPath,autoIncrement:!0}).createIndex(Qu.userMutationsIndex,Qu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Xu.store)}(t),sa(t),function(t){t.createObjectStore(ta.store)}(t));var s=zs.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ra.store),t.deleteObjectStore(na.store),t.deleteObjectStore(ia.store)}(t),sa(t)),s=s.next(function(){return t=o.store(ia.store),e=new ia(0,0,Br.min().A(),0),t.put(ia.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Qu.store).Hs().next(function(n){t.deleteObjectStore(Qu.store),t.createObjectStore(Qu.store,{keyPath:Qu.keyPath,autoIncrement:!0}).createIndex(Qu.userMutationsIndex,Qu.userMutationsKeyPath,{unique:!0});var r=e.store(Qu.store),i=n.map(function(t){return r.put(t)});return zs.Cn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(ua.store,{keyPath:ua.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(ea.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ta.store);e.createIndex(ta.readTimeIndex,ta.readTimeIndexPath,{unique:!1}),e.createIndex(ta.collectionReadTimeIndex,ta.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(ta.store).Zs(function(t,n){e+=Bu(n)}).next(function(){var n=new ea(e);return t.store(ea.store).put(ea.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Yu.store),r=t.store(Qu.store);return n.Hs().next(function(n){return zs.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Hs(Qu.userMutationsIndex,i).next(function(r){return zs.forEach(r,function(r){Dr(r.userId===n.userId);var i=Ru(e.serializer,r);return Vu(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ra.store),n=t.store(ta.store);return t.store(ia.store).get(ia.key).next(function(t){var r=[];return n.Zs(function(n,i){var o=new Hr(n),s=[0,wu(o)];r.push(e.get(s).next(function(n){return n?zs.resolve():function(n){return e.put(new ra(0,wu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return zs.Cn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(oa.store,{keyPath:oa.keyPath});var n=e.store(oa.store),r=new Hu,i=function(t){if(r.add(t)){var e=t.S(),i=t.p();return n.put({collectionId:e,parent:wu(i)})}};return e.store(ta.store).Zs({Xs:!0},function(t,e){var n=new Hr(t);return i(n.p())}).next(function(){return e.store(Xu.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1],r=(t[2],Iu(n));return i(r.p())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(na.store);return n.Zs(function(t,r){var i=Lu(r),o=Pu(e.serializer,i);return n.put(o)})},t}(),$u=function(t,e){this.seconds=t,this.nanoseconds=e},Ku=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ku.store="owner",Ku.key="owner";var Yu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Yu.store="mutationQueues",Yu.keyPath="userId";var Qu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Qu.store="mutations",Qu.keyPath="batchId",Qu.userMutationsIndex="userMutationsIndex",Qu.userMutationsKeyPath=["userId","batchId"];var Xu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,wu(e)]},t.key=function(t,e,n){return[t,wu(e),n]},t}();Xu.store="documentMutations",Xu.PLACEHOLDER=new Xu;var Zu=function(t,e){this.path=t,this.readTime=e},Ju=function(t,e){this.path=t,this.version=e},ta=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ta.store="remoteDocuments",ta.readTimeIndex="readTimeIndex",ta.readTimeIndexPath="readTime",ta.collectionReadTimeIndex="collectionReadTimeIndex",ta.collectionReadTimeIndexPath=["parentPath","readTime"];var ea=function(t){this.byteSize=t};ea.store="remoteDocumentGlobal",ea.key="remoteDocumentGlobalKey";var na=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};na.store="targets",na.keyPath="targetId",na.queryTargetsIndexName="queryTargetsIndex",na.queryTargetsKeyPath=["canonicalId","targetId"];var ra=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ra.store="targetDocuments",ra.keyPath=["targetId","path"],ra.documentTargetsIndex="documentTargetsIndex",ra.documentTargetsKeyPath=["path","targetId"];var ia=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ia.key="targetGlobalKey",ia.store="targetGlobal";var oa=function(t,e){this.collectionId=t,this.parent=e};function sa(t){t.createObjectStore(ra.store,{keyPath:ra.keyPath}).createIndex(ra.documentTargetsIndex,ra.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(na.store,{keyPath:na.keyPath}).createIndex(na.queryTargetsIndexName,na.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ia.store)}oa.store="collectionParents",oa.keyPath=["collectionId","parent"];var ua=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};ua.store="clientMetadata",ua.keyPath="clientId";var aa=c(c(c([Yu.store,Qu.store,Xu.store,ta.store,na.store,Ku.store,ia.store,ra.store],[ua.store]),[ea.store]),[oa.store]),ca=function(){function t(){this.Xr=new Hu}return t.prototype.Ar=function(t,e){var n=this;if(!this.Xr.has(e)){var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:wu(i)};return ha(t).put(o)}return zs.resolve()},t.prototype.hs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[kr(e),""],!1,!0);return ha(t).Hs(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Iu(o.parent))}return n})},t}();function ha(t){return ma.Ms(t,oa.store)}var la=function(){function t(t){this.Zr=t}return t.prototype.next=function(){return this.Zr+=2,this.Zr},t.to=function(){return new t(0)},t.eo=function(){return new t(-1)},t}(),fa=function(){function t(t,e){this.dr=t,this.serializer=e}return t.prototype.no=function(t){var e=this;return this.so(t).next(function(n){var r=new la(n.highestTargetId);return n.highestTargetId=r.next(),e.io(t,n).next(function(){return n.highestTargetId})})},t.prototype.ro=function(t){return this.so(t).next(function(t){return Br.I(new Gr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.ho=function(t,e,n){var r=this;return this.so(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.A()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.io(t,i)})},t.prototype.ao=function(t,e){var n=this;return this.uo(t,e).next(function(){return n.so(t).next(function(r){return r.targetCount+=1,n.co(e,r),n.io(t,r)})})},t.prototype.lo=function(t,e){return this.uo(t,e)},t.prototype._o=function(t,e){var n=this;return this.fo(t,e.targetId).next(function(){return pa(t).delete(e.targetId)}).next(function(){return n.so(t)}).next(function(e){return Dr(e.targetCount>0),e.targetCount-=1,n.io(t,e)})},t.prototype.hr=function(t,e,n){var r=this,i=0,o=[];return pa(t).Zs(function(s,u){var a=Lu(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r._o(t,a)))}).next(function(){return zs.Cn(o)}).next(function(){return i})},t.prototype.be=function(t,e){return pa(t).Zs(function(t,n){var r=Lu(n);e(r)})},t.prototype.so=function(t){return da(t).get(ia.key).next(function(t){return Dr(null!==t),t})},t.prototype.io=function(t,e){return da(t).put(ia.key,e)},t.prototype.uo=function(t,e){return pa(t).put(Pu(this.serializer,e))},t.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},t.prototype.wo=function(t,e){var n=ti(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return pa(t).Zs({range:r,index:na.queryTargetsIndexName},function(t,n,r){var o=Lu(n);ei(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.To=function(t,e,n){var r=this,i=[],o=ya(t);return e.forEach(function(e){var s=wu(e.path);i.push(o.put(new ra(n,s))),i.push(r.dr.Eo(t,n,e))}),zs.Cn(i)},t.prototype.Io=function(t,e,n){var r=this,i=ya(t);return zs.forEach(e,function(e){var o=wu(e.path);return zs.Cn([i.delete([n,o]),r.dr.mo(t,n,e)])})},t.prototype.fo=function(t,e){var n=ya(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ya(t),i=Ei();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=Iu(t[1]),o=new Kr(r);i=i.add(o)}).next(function(){return i})},t.prototype.Nr=function(t,e){var n=wu(e.path),r=IDBKeyRange.bound([n],[kr(n)],!1,!0),i=0;return ya(t).Zs({index:ra.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Me=function(t,e){return pa(t).get(e).next(function(t){return t?Lu(t):null})},t}();function pa(t){return ma.Ms(t,na.store)}function da(t){return ma.Ms(t,ia.store)}function ya(t){return ma.Ms(t,ra.store)}var va="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ga=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).vr=e,r.Ro=n,r}return s(e,t),e}($s),ma=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Is=o,this.window=s,this.document=u,this.Po=c,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!t.ks())throw new jr(qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new Ea(this,i),this.No=n+"main",this.serializer=new Tu(a),this.Fo=new Js(this.No,10,new Wu(this.serializer)),this.ko=new fa(this.dr,this.serializer),this.zn=new ca,this.Kn=new Mu(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===h&&Nr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ms=function(t,e){if(t instanceof ga)return Js.Ms(t.vr,e);throw Sr()},t.prototype.start=function(){var t=this;return this.xo().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new jr(qr.FAILED_PRECONDITION,va);return t.Oo(),t.Mo(),t.Lo(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.ko.oo(e)})}).then(function(e){t.yo=new Qs(e,t.Po)}).then(function(){t.po=!0}).catch(function(e){return t.Fo&&t.Fo.close(),Promise.reject(e)})},t.prototype.qo=function(t){var e=this;return this.Co=function(n){return u(e,void 0,void 0,function(){return a(this,function(e){return this.tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.Bo=function(t){var e=this;this.Fo.Bs(function(n){return u(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai(function(){return u(e,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.xo=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ba(e).put(new ua(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Qo(e).next(function(e){e||(t.isPrimary=!1,t.Is.gi(function(){return t.Co(!1)}))})}).next(function(){return t.Wo(e)}).next(function(n){return t.isPrimary&&!n?t.jo(e).next(function(){return!1}):!!n&&t.Ko(e).next(function(){return!0})})}).catch(function(e){if(nu(e))return Tr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Tr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Is.gi(function(){return t.Co(e)}),t.isPrimary=e})},t.prototype.Qo=function(t){var e=this;return wa(t).get(Ku.key).next(function(t){return zs.resolve(e.Go(t))})},t.prototype.zo=function(t){return ba(t).delete(this.clientId)},t.prototype.Ho=function(){return u(this,void 0,void 0,function(){var e,n,r,i,o=this;return a(this,function(s){switch(s.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Ms(e,ua.store);return n.Hs().next(function(t){var e=o.Jo(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return zs.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=s.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));s.label=2;case 2:return[2]}})})},t.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},t.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Wo=function(t){var e=this;return this.Vo?zs.resolve(!0):wa(t).get(Ku.key).next(function(n){if(null!==n&&e.Yo(n.leaseTimestampMs,5e3)&&!e.Zo(n.ownerId)){if(e.Go(n)&&e.networkEnabled)return!0;if(!e.Go(n)){if(!n.allowTabSynchronization)throw new jr(qr.FAILED_PRECONDITION,va);return!1}}return!(!e.networkEnabled||!e.inForeground)||ba(t).Hs().next(function(t){return void 0===e.Jo(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&Tr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.th=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Ku.store,ua.store],function(e){var n=new ga(e,Qs.Es);return t.jo(n).next(function(){return t.zo(n)})})];case 1:return e.sent(),this.Fo.close(),this.ih(),[2]}})})},t.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},t.prototype.rh=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ba(e).Hs().next(function(e){return t.Jo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),t.prototype.oh=function(t){return xu.Tr(t,this.serializer,this.zn,this.dr)},t.prototype.hh=function(){return this.ko},t.prototype.ah=function(){return this.Kn},t.prototype.uh=function(){return this.zn},t.prototype.runTransaction=function(t,e,n){var r=this;Tr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Fo.runTransaction(o,aa,function(o){return i=new ga(o,r.yo?r.yo.next():Qs.Es),"readwrite-primary"===e?r.Qo(i).next(function(t){return!!t||r.Wo(i)}).next(function(e){if(!e)throw Nr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Is.gi(function(){return r.Co(!1)}),new jr(qr.FAILED_PRECONDITION,Ws);return n(i)}).next(function(t){return r.Ko(i).next(function(){return t})}):r.lh(i).next(function(){return n(i)})}).then(function(t){return i.jn(),t})},t.prototype.lh=function(t){var e=this;return wa(t).get(Ku.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new jr(qr.FAILED_PRECONDITION,va)})},t.prototype.Ko=function(t){var e=new Ku(this.clientId,this.allowTabSynchronization,Date.now());return wa(t).put(Ku.key,e)},t.ks=function(){return Js.ks()},t.prototype.jo=function(t){var e=this,n=wa(t);return n.get(Ku.key).next(function(t){return e.Go(t)?(Tr("IndexedDbPersistence","Releasing primary lease."),n.delete(Ku.key)):zs.resolve()})},t.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Nr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},t.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},t.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},t.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return Tr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Nr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){Nr("Failed to set zombie client id.",t)}},t.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},t.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function wa(t){return ma.Ms(t,Ku.store)}function ba(t){return ma.Ms(t,ua.store)}var Ea=function(){function t(t,e){this.db=t,this.Yi=new mu(this,e)}return t.prototype.ir=function(t){var e=this._h(t);return this.db.hh().do(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},t.prototype.be=function(t,e){return this.db.hh().be(t,e)},t.prototype.or=function(t,e){return this.fh(t,function(t,n){return e(n)})},t.prototype.Eo=function(t,e,n){return Ia(t,n)},t.prototype.mo=function(t,e,n){return Ia(t,n)},t.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},t.prototype.Dr=function(t,e){return Ia(t,e)},t.prototype.dh=function(t,e){return function(t,e){var n=!1;return Fu(t).ti(function(r){return ku(t,r,e).next(function(t){return t&&(n=!0),zs.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.ar=function(t,e){var n=this,r=this.db.ah().jr(),i=[],o=0;return this.fh(t,function(s,u){if(u<=e){var a=n.dh(t,s).next(function(e){if(!e)return o++,r.Ln(t,s).next(function(){return r.Mn(s),ya(t).delete([0,wu(s.path)])})});i.push(a)}}).next(function(){return zs.Cn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},t.prototype.wh=function(t,e){return Ia(t,e)},t.prototype.fh=function(t,e){var n,r=ya(t),i=Qs.Es;return r.Zs({index:ra.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Qs.Es&&e(new Kr(Iu(n)),i),i=u,n=s):i=Qs.Es}).next(function(){i!==Qs.Es&&e(new Kr(Iu(n)),i)})},t.prototype.cr=function(t){return this.db.ah().zr(t)},t}();function Ia(t,e){return ya(t).put(function(t,e){return new ra(0,wu(t.path),e)}(e,t.Ro))}function Ta(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Na=function(){function t(t,e,n){this.persistence=t,this.Th=e,this.Eh=new ci(Pr),this.Ih=new Mr(function(t){return ti(t)},ei),this.mh=Br.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new Ks(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}return t.prototype.er=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.ur(n,e.Eh)})},t}();function _a(t){var e=Or(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Aa(t,e){var n=Or(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.ko.wo(t,e).next(function(i){return i?(r=i,zs.resolve(r)):n.ko.no(t).next(function(i){return r=new si(e,i,0,t.Ro),n.ko.ao(t,r).next(function(){return r})})})}).then(function(t){var r=n.Eh.get(t.targetId);return(null===r||t.Z.o(r.Z)>0)&&(n.Eh=n.Eh.st(t.targetId,t),n.Ih.set(e,t.targetId)),t})}function Sa(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s;return a(this,function(u){switch(u.label){case 0:r=Or(t),i=r.Eh.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.dr.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!nu(s=u.sent()))throw s;return Tr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Eh=r.Eh.remove(e),r.Ih.delete(i.target),[2]}})})}function Da(t,e,n){var r=Or(t),i=Br.min(),o=Ei();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Or(t),i=r.Ih.get(n);return void 0!==i?zs.resolve(r.Eh.get(i)):r.ko.wo(e,n)}(r,t,gs(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.ko.Ao(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Th.ns(t,e,n?i:Br.min(),n?o:Ei())}).next(function(t){return{documents:t,gh:o}})})}function Oa(t,e){var n=Or(t),r=Or(n.ko),i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Ra(t){return u(this,void 0,void 0,function(){return a(this,function(e){if(t.code!==qr.FAILED_PRECONDITION||t.message!==Ws)throw t;return Tr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var La=function(){function t(){this.Vh=new fi(Pa.yh),this.ph=new fi(Pa.bh)}return t.prototype._=function(){return this.Vh._()},t.prototype.Eo=function(t,e){var n=new Pa(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},t.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},t.prototype.mo=function(t,e){this.Sh(new Pa(t,e))},t.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},t.prototype.Ch=function(t){var e=this,n=new Kr(new Hr([])),r=new Pa(n,t),i=new Pa(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},t.prototype.Nh=function(){var t=this;this.Vh.forEach(function(e){return t.Sh(e)})},t.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},t.prototype.Fh=function(t){var e=new Kr(new Hr([])),n=new Pa(e,t),r=new Pa(e,t+1),i=Ei();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},t.prototype.Nr=function(t){var e=new Pa(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},t}(),Pa=function(){function t(t,e){this.key=t,this.kh=e}return t.yh=function(t,e){return Kr.P(t.key,e.key)||Pr(t.kh,e.kh)},t.bh=function(t,e){return Pr(t.kh,e.kh)||Kr.P(t.key,e.key)},t}(),xa=function(){function t(t){this.uid=t}return t.prototype.Er=function(){return null!=this.uid},t.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();xa.UNAUTHENTICATED=new xa(null),xa.xh=new xa("google-credentials-uid"),xa.Oh=new xa("first-party-uid");var ka=function(){function t(){this.Lh=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.qh=function(){},t.prototype.Bh=function(t){this.Lh=t,t(xa.UNAUTHENTICATED)},t.prototype.Uh=function(){this.Lh=null},t}(),Va=function(){function t(t){var e=this;this.Qh=null,this.currentUser=xa.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.jh,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.jh!==e?(Tr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Dr("string"==typeof n.accessToken),new function(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.qh=function(){this.forceRefresh=!0},t.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},t.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},t.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new xa(t)},t}(),Ca=function(){function t(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=xa.Oh}return Object.defineProperty(t.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ua=function(){function t(t,e){this.Gh=t,this.zh=e}return t.prototype.getToken=function(){return Promise.resolve(new Ca(this.Gh,this.zh))},t.prototype.Bh=function(t){t(xa.Oh)},t.prototype.Uh=function(){},t.prototype.qh=function(){},t}(),Fa=function(){function t(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new Zs(t,e)}return t.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.na=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.sa()},t.prototype.stop=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.ia=function(){this.state=0,this.Ti.reset()},t.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,function(){return t.oa()}))},t.prototype.ha=function(t){this.aa(),this.stream.send(t)},t.prototype.oa=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},t.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},t.prototype.close=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==t?this.Ti.reset():e&&e.code===qr.RESOURCE_EXHAUSTED?(Nr(e.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):e&&e.code===qr.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ca(e)];case 1:return n.sent(),[2]}})})},t.prototype.ua=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.la(this.Zh),n=this.Zh;this.Xh.getToken().then(function(e){t.Zh===n&&t._a(e)},function(n){e(function(){var e=new jr(qr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.fa(e)})})},t.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ca(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return u(t,void 0,void 0,function(){return a(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.fa=function(t){return Tr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.la=function(t){var e=this;return function(n){e.Is.ai(function(){return e.Zh===t?n():(Tr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Ma=function(t){function e(e,n,r,i,o){var s;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return s(e,t),e.prototype.da=function(t){return this.Jh.Ta("Listen",t)},e.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Sr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Le?(Dr(void 0===e||"string"==typeof e),ri.fromBase64String(e||"")):(Dr(void 0===e||e instanceof Uint8Array),ri.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?qr.UNKNOWN:ai(t.code);return new jr(e,t.message||"")}(s);n=new Li(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=fo(t,a.document.name),h=ao(a.document.updateTime),l=new is({mapValue:{fields:a.document.fields}}),f=new as(c,h,l,{}),p=a.targetIds||[],d=a.removedTargetIds||[];n=new Oi(p,d,f.key,f)}else if("documentDelete"in e){e.documentDelete;var y=e.documentDelete;y.document;var v=fo(t,y.document),g=y.readTime?ao(y.readTime):Br.min(),m=new cs(v,g),w=y.removedTargetIds||[];n=new Oi([],w,m.key,m)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=fo(t,b.document),I=b.removedTargetIds||[];n=new Oi([],I,E,null)}else{if(!("filter"in e))return Sr();e.filter;var T=e.filter;T.targetId;var N=new function(t){this.count=t}(T.count||0),_=T.targetId;n=new Ri(_,N)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Br.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Br.min():e.readTime?ao(e.readTime):Br.min()}(t);return this.listener.Ea(e,n)},e.prototype.Ia=function(t){var e={};e.database=vo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=ni(r)?{documents:Eo(t,r)}:{query:Io(t,r)}).targetId=e.targetId,e.resumeToken.Y()>0&&(n.resumeToken=uo(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}(0,e.X);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.ha(e)},e.prototype.ma=function(t){var e={};e.database=vo(this.serializer),e.removeTarget=t,this.ha(e)},e}(Fa),qa=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Aa=!1,s}return s(e,t),Object.defineProperty(e.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ua=function(){this.Aa&&this.Pa([])},e.prototype.da=function(t){return this.Jh.Ta("Write",t)},e.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=function(t,e){return t&&t.length>0?(Dr(void 0!==e),t.map(function(t){return function(t,e){var n=t.updateTime?ao(t.updateTime):ao(e);n.isEqual(Br.min())&&(n=ao(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new function(t,e){this.version=t,this.transformResults=e}(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=ao(t.commitTime);return this.listener.ga(n,e)}return Dr(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},e.prototype.ya=function(){var t={};t.database=vo(this.serializer),this.ha(t)},e.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return wo(e.serializer,t)})};this.ha(n)},e}(Fa),ja=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Jh=n,i.serializer=r,i.pa=!1,i}return s(e,t),e.prototype.ba=function(){if(this.pa)throw new jr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.va=function(t,e,n){var r=this;return this.ba(),this.credentials.getToken().then(function(i){return r.Jh.va(t,e,n,i)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&r.credentials.qh(),t})},e.prototype.Sa=function(t,e,n){var r=this;return this.ba(),this.credentials.getToken().then(function(i){return r.Jh.Sa(t,e,n,i)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&r.credentials.qh(),t})},e.prototype.terminate=function(){this.pa=!1},e}(function(){}),Ga=function(){function t(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}return t.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},t.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,this.Ca>=1&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},t.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},t.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},t.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(Nr(e),this.Fa=!1):Tr("OnlineStateTracker",e)},t.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},t}(),Ba=function(){function t(t,e,n,r,i){var o=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return u(o,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Ga()?(Tr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new Ga(n,r),this.Ya=function(t,e,n){var r=Or(t);return r.ba(),new Ma(e,r.Jh,r.credentials,r.serializer,n)}(this.qa,n,{wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)}),this.tu=function(t,e,n){var r=Or(t);return r.ba(),new qa(e,r.Jh,r.credentials,r.serializer,n)}(this.qa,n,{wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},t.prototype.iu=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.disableNetwork=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},t.prototype.au=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),this.Ba.length>0&&(Tr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}})})},t.prototype.th=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return Tr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},t.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},t.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},t.prototype.Me=function(t){return this.Ua.get(t)||null},t.prototype.Oe=function(t){return this.fu.Oe(t)},t.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},t.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},t.prototype.ou=function(){this.Qa=new xi(this),this.Ya.start(),this.Ha.ka()},t.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&this.Ua.size>0},t.prototype.Ga=function(){return 0===this.Wa.size},t.prototype.uu=function(){this.Qa=null},t.prototype.Ja=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){return this.Ua.forEach(function(e,n){t.cu(e)}),[2]})})},t.prototype.Xa=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return this.uu(),this.ru()?(this.Ha.Oa(t),this.ou()):this.Ha.set("Unknown"),[2]})})},t.prototype.Za=function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:if(this.Ha.set("Online"),!(t instanceof Li&&2===t.state&&t.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,this.du(t)];case 2:return o.sent(),[3,5];case 3:return n=o.sent(),Tr("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.wu(n)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Oi?this.Qa.ge(t):t instanceof Ri?this.Qa.Ce(t):this.Qa.pe(t),e.isEqual(Br.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,_a(this.La)];case 8:return r=o.sent(),e.o(r)>=0?[4,this.Tu(e)]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return Tr("RemoteStore","Failed to raise snapshot:",i=o.sent()),[4,this.wu(i)];case 12:return o.sent(),[3,13];case 13:return[2]}})})},t.prototype.wu=function(t,e){return u(this,void 0,void 0,function(){var n=this;return a(this,function(r){switch(r.label){case 0:if(!nu(t))throw t;return this.Wa.add(1),[4,this.au()];case 1:return r.sent(),this.Ha.set("Offline"),e||(e=function(){return _a(n.La)}),this.ei.gi(function(){return u(n,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return Tr("RemoteStore","Retrying IndexedDB access"),[4,e()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},t.prototype.Eu=function(t){var e=this;return t().catch(function(n){return e.wu(n,t)})},t.prototype.Tu=function(t){var e=this,n=this.Qa.ke(t);return n.Wt.forEach(function(n,r){if(n.resumeToken.Y()>0){var i=e.Ua.get(r);i&&e.Ua.set(r,i.et(n.resumeToken,t))}}),n.jt.forEach(function(t){var n=e.Ua.get(t);if(n){e.Ua.set(t,n.et(ri.J,n.Z)),e._u(t);var r=new si(n.target,t,1,n.sequenceNumber);e.cu(r)}}),this.fu.Iu(n)},t.prototype.du=function(t){return u(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){switch(o.label){case 0:e=t.cause,n=0,r=t.targetIds,o.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fu.mu(i,e)]:[3,3]):[3,5];case 2:o.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),o.label=3;case 3:o.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},t.prototype.hu=function(){return u(this,void 0,void 0,function(){var t,e,n;return a(this,function(r){switch(r.label){case 0:t=this.Ba.length>0?this.Ba[this.Ba.length-1].batchId:-1,r.label=1;case 1:if(!this.Au())return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,function(t,e){var n=Or(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Gn.gr(t,e)})}(this.La,t)];case 3:return null===(e=r.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(t=e.batchId,this.Ru(e),[3,6]);case 4:return n=r.sent(),[4,this.wu(n)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}})})},t.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},t.prototype.Vu=function(){return this.Ba.length},t.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},t.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&this.Ba.length>0},t.prototype.gu=function(){this.tu.start()},t.prototype.eu=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return this.tu.ya(),[2]})})},t.prototype.su=function(){return u(this,void 0,void 0,function(){var t,e,n;return a(this,function(r){for(t=0,e=this.Ba;t<e.length;t++)n=e[t],this.tu.Pa(n.mutations);return[2]})})},t.prototype.ga=function(t,e){return u(this,void 0,void 0,function(){var n,r,i=this;return a(this,function(o){switch(o.label){case 0:return n=this.Ba.shift(),r=Bs.from(n,t,e),[4,this.Eu(function(){return i.fu.yu(r)})];case 1:return o.sent(),[4,this.hu()];case 2:return o.sent(),[2]}})})},t.prototype.nu=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t&&this.tu.Ra?[4,this.pu(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.Pu()&&this.gu(),[2]}})})},t.prototype.pu=function(t){return u(this,void 0,void 0,function(){var e,n,r=this;return a(this,function(i){switch(i.label){case 0:return ui(n=t.code)&&n!==qr.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu(function(){return r.fu.bu(e.batchId,t)})]):[3,3];case 1:return i.sent(),[4,this.hu()];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.za=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}})})},t.prototype.vu=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.ei.pi(),Tr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return e.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(t)];case 2:return e.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return e.sent(),[2]}})})},t.prototype.Su=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:e.sent(),this.Ha.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}})})},t}();function za(t,e){return"firestore_clients_"+t+"_"+e}function Ha(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function Wa(t,e){return"firestore_targets_"+t+"_"+e}var $a=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Du=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new jr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Nr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ka=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Du=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new jr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Nr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ya=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Du=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ti(),s=0;i&&s<r.activeTargetIds.length;++s)i=Xr(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Nr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Qa=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Du=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Nr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Xa=function(){function t(){this.activeTargetIds=Ti()}return t.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Za=function(){function t(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new ci(Pr),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=za(this.persistenceKey,this.ku),this.qu=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ou=this.Ou.st(this.ku,new Xa),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.$u)}return t.ks=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return u(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a(this,function(a){switch(a.label){case 0:return[4,this.fu.rh()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.ku&&(i=this.getItem(za(this.persistenceKey,r)))&&(o=Ya.Du(r,i))&&(this.Ou=this.Ou.st(o.clientId,o));for(this.ju(),(s=this.storage.getItem(this.Wu))&&(u=this.Ku(s))&&this.Gu(u),c=0,h=this.Mu;c<h.length;c++)l=h[c],this.xu(l);return this.Mu=[],this.window.addEventListener("unload",function(){return f.th()}),this.tr=!0,[2]}})})},t.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},t.prototype.zu=function(){return this.Hu(this.Ou)},t.prototype.Yu=function(t){var e=!1;return this.Ou.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.Ju=function(t){this.Xu(t,"pending")},t.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},t.prototype.ec=function(t){var e="not-current";if(this.Yu(t)){var n=this.storage.getItem(Wa(this.persistenceKey,t));if(n){var r=Ka.Du(t,n);r&&(e=r.state)}}return this.nc.Nu(t),this.ju(),e},t.prototype.sc=function(t){this.nc.Fu(t),this.ju()},t.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},t.prototype.rc=function(t){this.removeItem(Wa(this.persistenceKey,t))},t.prototype.oc=function(t,e,n){this.hc(t,e,n)},t.prototype.ac=function(t,e,n){var r=this;e.forEach(function(t){r.tc(t)}),this.currentUser=t,n.forEach(function(t){r.Ju(t)})},t.prototype.uc=function(t){this.cc(t)},t.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Tr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Tr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Tr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.xu=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Tr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Lu)return void Nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi(function(){return u(e,void 0,void 0,function(){var t,e,r,i,o,s;return a(this,function(u){if(this.tr){if(null!==n.key)if(this.Bu.test(n.key)){if(null==n.newValue)return t=this.lc(n.key),[2,this._c(t,null)];if(e=this.fc(n.key,n.newValue))return[2,this._c(e.clientId,e)]}else if(this.Uu.test(n.key)){if(null!==n.newValue&&(r=this.dc(n.key,n.newValue)))return[2,this.wc(r)]}else if(this.Qu.test(n.key)){if(null!==n.newValue&&(i=this.Tc(n.key,n.newValue)))return[2,this.Ec(i)]}else if(n.key===this.Wu){if(null!==n.newValue&&(o=this.Ku(n.newValue)))return[2,this.Gu(o)]}else n.key===this.qu&&(s=function(t){var e=Qs.Es;if(null!=t)try{var n=JSON.parse(t);Dr("number"==typeof n),e=n}catch(t){Nr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Qs.Es&&this.fs(s)}else this.Mu.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),t.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},t.prototype.Xu=function(t,e,n){var r=new $a(this.currentUser,t,e,n),i=Ha(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},t.prototype.tc=function(t){var e=Ha(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},t.prototype.hc=function(t,e,n){var r=Wa(this.persistenceKey,t),i=new Ka(t,e,n);this.setItem(r,i.Cu())},t.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},t.prototype.fc=function(t,e){var n=this.lc(t);return Ya.Du(n,e)},t.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return $a.Du(new xa(i),r,e)},t.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return Ka.Du(r,e)},t.prototype.Ku=function(t){return Qa.Du(t)},t.prototype.wc=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fu.Ic(t.batchId,t.state,t.error)]:(Tr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},t.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fu.Ac(s,u).then(function(){n.Ou=r})},t.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},t.prototype.Hu=function(t){var e=Ti();return t.forEach(function(t,n){e=e.Nt(n.activeTargetIds)}),e},t}(),Ja=function(){function t(){this.Rc=new Xa,this.Pc={},this.Da=null,this.fs=null}return t.prototype.Ju=function(t){},t.prototype.Zu=function(t,e,n){},t.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},t.prototype.oc=function(t,e,n){this.Pc[t]=e},t.prototype.sc=function(t){this.Rc.Fu(t)},t.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},t.prototype.rc=function(t){delete this.Pc[t]},t.prototype.zu=function(){return this.Rc.activeTargetIds},t.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},t.prototype.start=function(){return this.Rc=new Xa,Promise.resolve()},t.prototype.ac=function(t,e,n){},t.prototype.uc=function(t){},t.prototype.th=function(){},t.prototype.Ts=function(t){},t}(),tc=function(t){this.key=t},ec=function(t){this.key=t},nc=function(){function t(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=Ei(),this.qt=Ei(),this.pc=_s(t),this.bc=new Ni(this.pc)}return Object.defineProperty(t.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),t.prototype.Sc=function(t,e){var n=this,r=e?e.Dc:new _i,i=e?e.bc:this.bc,o=e?e.qt:this.qt,s=i,u=!1,a=this.query.an()&&i.size===this.query.limit?i.last():null,c=this.query.un()&&i.size===this.query.limit?i.first():null;if(t.ht(function(t,e){var h=i.get(t),l=e instanceof as?e:null;l&&(l=Ns(n.query,l)?l:null);var f=!!h&&n.qt.has(h.key),p=!!l&&(l.Ge||n.qt.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.Cc(h,l)||(r.track({type:2,doc:l}),d=!0,(a&&n.pc(l,a)>0||c&&n.pc(l,c)<0)&&(u=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),this.query.an()||this.query.un())for(;s.size>this.query.limit;){var h=this.query.an()?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{bc:s,Dc:r,Nc:u,qt:o}},t.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},t.prototype.Un=function(t,e,n){var r=this,i=this.bc;this.bc=t.bc,this.qt=t.qt;var o=t.Dc.Mt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}};return n(t)-n(e)}(t.type,e.type)||r.pc(t.doc,e.doc)}),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==o.length||a?{snapshot:new Ai(this.query,t.bc,i,o,t.qt,0===u,a,!1),$c:s}:{$c:s}},t.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new _i,qt:this.qt,Nc:!1},!1)):{$c:[]}},t.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},t.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gc=e.gc.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gc=e.gc.delete(t)}),this.Yt=t.Yt)},t.prototype.kc=function(){var t=this;if(!this.Yt)return[];var e=this.yc;this.yc=Ei(),this.bc.forEach(function(e){t.Oc(e.key)&&(t.yc=t.yc.add(e.key))});var n=[];return e.forEach(function(e){t.yc.has(e)||n.push(new ec(e))}),this.yc.forEach(function(t){e.has(t)||n.push(new tc(t))}),n},t.prototype.Mc=function(t){this.gc=t.gh,this.yc=Ei();var e=this.Sc(t.documents);return this.Un(e,!0)},t.prototype.Lc=function(){return Ai.Qt(this.query,this.bc,this.qt,0===this.Vc)},t}(),rc=function(t){this.key=t,this.qc=!1},ic=function(){function t(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new Mr(function(t){return Is(t)},Es),this.Kc=new Map,this.Gc=[],this.zc=new ci(Kr.P),this.Hc=new Map,this.Yc=new La,this.Jc={},this.Xc=new Map,this.Zc=la.eo(),this.onlineState="Unknown",this.tl=void 0}return Object.defineProperty(t.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){this.Wc=t},t.prototype.listen=function(t){return u(this,void 0,void 0,function(){var e,n,r,i,o;return a(this,function(s){switch(s.label){case 0:return this.nl("listen()"),(r=this.jc.get(t))?(e=r.targetId,this.Uc.ec(e),n=r.view.Lc(),[3,4]):[3,1];case 1:return[4,Aa(this.La,gs(t))];case 2:return i=s.sent(),o=this.Uc.ec(i.targetId),e=i.targetId,[4,this.sl(t,e,"current"===o)];case 3:n=s.sent(),this.el&&this.Bc.listen(i),s.label=4;case 4:return[2,n]}})})},t.prototype.sl=function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u,c;return a(this,function(a){switch(a.label){case 0:return[4,Da(this.La,t,!0)];case 1:return r=a.sent(),i=new nc(t,r.gh),o=i.Sc(r.documents),s=Di.Ht(e,n&&"Offline"!==this.onlineState),u=i.Un(o,this.el,s),this.il(e,u.$c),c=new function(t,e,n){this.query=t,this.targetId=e,this.view=n}(t,e,i),[2,(this.jc.set(t,c),this.Kc.has(e)?this.Kc.get(e).push(t):this.Kc.set(e,[t]),u.snapshot)]}})})},t.prototype.lu=function(t){return u(this,void 0,void 0,function(){var e,n,r=this;return a(this,function(i){switch(i.label){case 0:return this.nl("unlisten()"),e=this.jc.get(t),(n=this.Kc.get(e.targetId)).length>1?[2,(this.Kc.set(e.targetId,n.filter(function(e){return!Es(e,t)})),void this.jc.delete(t))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,Sa(this.La,e.targetId,!1).then(function(){r.Uc.rc(e.targetId),r.Bc.lu(e.targetId),r.rl(e.targetId)}).catch(Ra)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,Sa(this.La,e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:this.nl("write()"),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,function(t,e){var n,r=Or(t),i=Gr.now(),o=e.reduce(function(t,e){return t.add(e.key)},Ei());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Rh.Zn(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=$o(c,n.get(c.key));null!=h&&s.push(new Xo(c.key,h,ss(h.proto.mapValue),Go.exists(!0)))}return r.Gn.mr(t,i,s,e)})}).then(function(t){var e=t.An(n);return{batchId:t.batchId,Fn:e}})}(this.La,t)];case 2:return n=o.sent(),this.Uc.Ju(n.batchId),this.ol(n.batchId,e),[4,this.hl(n.Fn)];case 3:return o.sent(),[4,this.Bc.hu()];case 4:return o.sent(),[3,6];case 5:return r=o.sent(),i=fu(r,"Failed to persist write"),e.reject(i),[3,6];case 6:return[2]}})})},t.prototype.Iu=function(t){return u(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:this.nl("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=Or(t),r=e.Z,i=n.Eh;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Ah.jr({Gr:!0});i=n.Eh;var s=[];e.Wt.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.ko.Io(t,e.Zt,o).next(function(){return n.ko.To(t,e.Jt,o)}));var a=e.resumeToken;if(a.Y()>0){var c=u.et(a,r).tt(t.Ro);i=i.st(o,c),function(t,e,n){return Dr(e.resumeToken.Y()>0),0===t.resumeToken.Y()||e.Z.m()-t.Z.m()>=3e8||n.Jt.size+n.Xt.size+n.Zt.size>0}(u,c,e)&&s.push(n.ko.lo(t,c))}}});var u=yi(),a=Ei();if(e.Kt.forEach(function(t,e){a=a.add(t)}),s.push(o.getEntries(t,a).next(function(i){e.Kt.forEach(function(a,c){var h=i.get(a);c instanceof cs&&c.version.isEqual(Br.min())?(o.Mn(a,r),u=u.st(a,c)):null==h||c.version.o(h.version)>0||0===c.version.o(h.version)&&h.hasPendingWrites?(o.xn(c,r),u=u.st(a,c)):Tr("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Gt.has(a)&&s.push(n.persistence.dr.wh(t,a))})})),!r.isEqual(Br.min())){var c=n.ko.ro(t).next(function(e){return n.ko.ho(t,t.Ro,r)});s.push(c)}return zs.Cn(s).next(function(){return o.apply(t)}).next(function(){return n.Rh.ts(t,u)})}).then(function(t){return n.Eh=i,t})}(this.La,t)];case 2:return e=r.sent(),t.Wt.forEach(function(t,e){var r=n.Hc.get(e);r&&(Dr(t.Jt.size+t.Xt.size+t.Zt.size<=1),t.Jt.size>0?r.qc=!0:t.Xt.size>0?Dr(r.qc):t.Zt.size>0&&(Dr(r.qc),r.qc=!1))}),[4,this.hl(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Ra(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.xc=function(t,e){if(this.el&&0===e||!this.el&&1===e){this.nl("applyOnlineStateChange()");var n=[];this.jc.forEach(function(e,r){var i=r.view.xc(t);i.snapshot&&n.push(i.snapshot)}),this.Wc.al(t),this.Wc.Ea(n),this.onlineState=t,this.el&&this.Uc.uc(t)}},t.prototype.mu=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return a(this,function(a){switch(a.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(t,"rejected",e),n=this.Hc.get(t),(r=n&&n.key)?(i=(i=new ci(Kr.P)).st(r,new cs(r,Br.min())),o=Ei().add(r),s=new Si(Br.min(),new Map,new fi(Pr),i,o),[4,this.Iu(s)]):[3,2];case 1:return a.sent(),this.zc=this.zc.remove(r),this.Hc.delete(t),this.ul(),[3,4];case 2:return[4,Sa(this.La,t,!1).then(function(){return u.rl(t,e)}).catch(Ra)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},t.prototype.yu=function(t){return u(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:this.nl("applySuccessfulWrite()"),e=t.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=Or(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Ah.jr({Gr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=zs.resolve();return o.forEach(function(t){s=s.next(function(){return r.Ln(e,t)}).next(function(e){var o=e,s=n.Pn.get(t);Dr(null!==s),(!o||o.version.o(s)<0)&&(o=i.En(t,o,n))&&r.xn(o,n.Rn)})}),s.next(function(){return t.Gn.br(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Gn.Cr(t)}).next(function(){return n.Rh.Zn(t,r)})})}(this.La,t)];case 2:return n=r.sent(),this.cl(e,null),this.ll(e),this.Uc.Zu(e,"acknowledged"),[4,this.hl(n)];case 3:return r.sent(),[3,6];case 4:return[4,Ra(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype.bu=function(t,e){return u(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:this.nl("rejectFailedWrite()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(t,e){var n=Or(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Gn.Rr(t,e).next(function(e){return Dr(null!==e),r=e.keys(),n.Gn.br(t,e)}).next(function(){return n.Gn.Cr(t)}).next(function(){return n.Rh.Zn(t,r)})})}(this.La,t)];case 2:return n=r.sent(),this.cl(t,e),this.ll(t),this.Uc.Zu(t,"rejected",e),[4,this.hl(n)];case 3:return r.sent(),[3,6];case 4:return[4,Ra(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}})})},t.prototype._l=function(t){return u(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){switch(o.label){case 0:this.Bc.Ga()||Tr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,function(t){var e=Or(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Gn.Vr(t)})}(this.La)];case 2:return-1===(e=o.sent())?[2,void t.resolve()]:((n=this.Xc.get(e)||[]).push(t),this.Xc.set(e,n),[3,4]);case 3:return r=o.sent(),i=fu(r,"Initialization of waitForPendingWrites() operation failed"),t.reject(i),[3,4];case 4:return[2]}})})},t.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach(function(t){t.resolve()}),this.Xc.delete(t)},t.prototype.fl=function(t){this.Xc.forEach(function(e){e.forEach(function(e){e.reject(new jr(qr.CANCELLED,t))})}),this.Xc.clear()},t.prototype.ol=function(t,e){var n=this.Jc[this.currentUser.$h()];n||(n=new ci(Pr)),n=n.st(t,e),this.Jc[this.currentUser.$h()]=n},t.prototype.cl=function(t,e){var n=this.Jc[this.currentUser.$h()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.Jc[this.currentUser.$h()]=n}},t.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach(function(t){n.Yc.Nr(t)||n.wl(t)})},t.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},t.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof tc?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof ec?(Tr("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):Sr()}},t.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(Tr("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},t.prototype.ul=function(){for(;this.Gc.length>0&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new rc(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new si(gs(ds(t.path)),e,2,Qs.Es))}},t.prototype.El=function(){return this.zc},t.prototype.Il=function(){return this.Gc},t.prototype.hl=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o=this;return a(this,function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.jc.forEach(function(s,u){i.push(Promise.resolve().then(function(){var e=u.view.Sc(t);return e.Nc?Da(o.La,u.query,!1).then(function(t){var n=t.documents;return u.view.Sc(n,e)}):e}).then(function(t){var i=e&&e.Wt.get(u.targetId),s=u.view.Un(t,o.el,i);if(o.il(u.targetId,s.$c),s.snapshot){o.el&&o.Uc.oc(u.targetId,s.snapshot.fromCache?"not-current":"current"),n.push(s.snapshot);var a=Ys._s(u.targetId,s.snapshot);r.push(a)}}))}),[4,Promise.all(i)];case 1:return s.sent(),this.Wc.Ea(n),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h,l;return a(this,function(a){switch(a.label){case 0:n=Or(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return zs.forEach(e,function(e){return zs.forEach(e.cs,function(r){return n.persistence.dr.Eo(t,e.targetId,r)}).next(function(){return zs.forEach(e.ls,function(r){return n.persistence.dr.mo(t,e.targetId,r)})})})})];case 2:return a.sent(),[3,4];case 3:if(!nu(r=a.sent()))throw r;return Tr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],u=s.targetId,s.fromCache||(c=n.Eh.get(u),h=c.Z,l=c.nt(h),n.Eh=n.Eh.st(u,l));return[2]}})})}(this.La,r)];case 2:return s.sent(),[2]}})})},t.prototype.nl=function(t){},t.prototype.vu=function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return this.currentUser.isEqual(t)?[3,3]:(Tr("SyncEngine","User change. New user:",t.$h()),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o;return a(this,function(s){switch(s.label){case 0:return n=Or(t),r=n.Gn,i=n.Rh,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.Gn.yr(t).next(function(s){return o=s,r=n.persistence.oh(e),i=new Ks(n.Ah,r,n.persistence.uh()),r.yr(t)}).next(function(e){for(var n=[],r=[],s=Ei(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return i.Zn(t,s).next(function(t){return{ml:t,Al:n,Rl:r}})})})];case 1:return o=s.sent(),[2,(n.Gn=r,n.Rh=i,n.Th.Ph(n.Rh),o)]}})})}(this.La,t)]);case 1:return e=n.sent(),this.currentUser=t,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(t,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return Ei().add(e.key);var n=Ei(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.jc.get(s);n=n.Nt(u.view.vc)}return n},t}();function oc(t,e,n){return u(this,void 0,void 0,function(){var n,r,i,o,s,c,h,l,f,p,d,y,v,g;return a(this,function(m){switch(m.label){case 0:n=Or(t),r=[],i=[],o=0,s=e,m.label=1;case 1:return o<s.length?(c=s[o],h=void 0,(l=n.Kc.get(c))&&0!==l.length?[4,Aa(n.La,gs(l[0]))]:[3,7]):[3,13];case 2:h=m.sent(),f=0,p=l,m.label=3;case 3:return f<p.length?(d=p[f],y=n.jc.get(d),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return[4,Da((n=Or(t)).La,e.query,!0)];case 1:return r=o.sent(),i=e.view.Mc(r),[2,(n.el&&n.il(e.targetId,i.$c),i)]}})})}(n,y)]):[3,6];case 4:(v=m.sent()).snapshot&&i.push(v.snapshot),m.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Oa(n.La,c)];case 8:return g=m.sent(),[4,Aa(n.La,g)];case 9:return h=m.sent(),[4,n.sl(sc(g),c,!1)];case 10:m.sent(),m.label=11;case 11:r.push(h),m.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Wc.Ea(i),r)]}})})}function sc(t){return ps(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}var uc=function(){function t(t){this.fu=t,this.gl=new Mr(function(t){return Is(t)},Es),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}return t.prototype.listen=function(t){return u(this,void 0,void 0,function(){var e,n,r,i,o,s;return a(this,function(u){switch(u.label){case 0:if(e=t.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new function(){this.Pl=void 0,this.listeners=[]}),!n)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),i=r,[4,this.fu.listen(e)];case 2:return i.Pl=u.sent(),[3,4];case 3:return o=u.sent(),s=fu(o,"Initialization of query '"+Ts(t.query)+"' failed"),[2,void t.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(t),t.xc(this.onlineState),r.Pl&&t.yl(r.Pl)&&this.pl(),[2]}})})},t.prototype.lu=function(t){return u(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){return e=t.query,n=!1,(r=this.gl.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]})})},t.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},t.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},t.prototype.al=function(t){this.onlineState=t;var e=!1;this.gl.forEach(function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].xc(t)&&(e=!0)}),e&&this.pl()},t.prototype.bl=function(t){this.Vl.add(t),t.next()},t.prototype.vl=function(t){this.Vl.delete(t)},t.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},t}(),ac=function(){function t(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ai(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},t.prototype.onError=function(t){this.Sl.error(t)},t.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},t.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},t.prototype.Nl=function(t){if(t.docChanges.length>0)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.kl=function(t){t=Ai.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},t}(),cc=function(){function t(){}return t.prototype.Ph=function(t){this.xl=t},t.prototype.ns=function(t,e,n,i){var o=this;return e.hn()||n.isEqual(Br.min())?this.Ol(t,e):this.xl.Zn(t,i).next(function(s){var u=o.Ml(e,s);return(e.an()||e.un())&&o.Nc(e.nn,u,i,n)?o.Ol(t,e):(Ir()<=r.DEBUG&&Tr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ts(e)),o.xl.ns(t,e,n).next(function(t){return u.forEach(function(e){t=t.st(e.key,e)}),t}))})},t.prototype.Ml=function(t,e){var n=new fi(_s(t));return e.forEach(function(e,r){r instanceof as&&Ns(t,r)&&(n=n.add(r))}),n},t.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.o(r)>0)},t.prototype.Ol=function(t,e){return Ir()<=r.DEBUG&&Tr("IndexFreeQueryEngine","Using full collection scan to execute query:",Ts(e)),this.xl.ns(t,e,Br.min())},t}(),hc=function(){function t(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new fi(Pa.yh)}return t.prototype.Ir=function(t){return zs.resolve(0===this.Gn.length)},t.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,this.Gn.length>0&&this.Gn[this.Gn.length-1];var o=new Gs(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Pa(a.key,i)),this.zn.Ar(t,a.key.path.p())}return zs.resolve(o)},t.prototype.Rr=function(t,e){return zs.resolve(this.Bl(e))},t.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return zs.resolve(this.Gn.length>i?this.Gn[i]:null)},t.prototype.Vr=function(){return zs.resolve(0===this.Gn.length?-1:this.Ll-1)},t.prototype.yr=function(t){return zs.resolve(this.Gn.slice())},t.prototype.Yn=function(t,e){var n=this,r=new Pa(e,0),i=new Pa(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),zs.resolve(o)},t.prototype.es=function(t,e){var n=this,r=new fi(Pr);return e.forEach(function(t){var e=new Pa(t,0),i=new Pa(t,Number.POSITIVE_INFINITY);n.ql.St([e,i],function(t){r=r.add(t.kh)})}),zs.resolve(this.Ql(r))},t.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;Kr.j(i)||(i=i.child(""));var o=new Pa(new Kr(i),0),s=new fi(Pr);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),zs.resolve(this.Ql(s))},t.prototype.Ql=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Bl(t);null!==r&&n.push(r)}),n},t.prototype.br=function(t,e){var n=this;Dr(0===this.Wl(e.batchId,"removed")),this.Gn.shift();var r=this.ql;return zs.forEach(e.mutations,function(i){var o=new Pa(i.key,e.batchId);return r=r.delete(o),n.dr.Dr(t,i.key)}).next(function(){n.ql=r})},t.prototype.Sr=function(t){},t.prototype.Nr=function(t,e){var n=new Pa(e,0),r=this.ql.Ct(n);return zs.resolve(e.isEqual(r&&r.key))},t.prototype.Cr=function(t){return this.Gn.length,zs.resolve()},t.prototype.Wl=function(t,e){return this.Ul(t)},t.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},t.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},t}(),lc=function(){function t(t,e){this.zn=t,this.jl=e,this.docs=new ci(Kr.P),this.size=0}return t.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},t.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ln=function(t,e){var n=this.docs.get(e);return zs.resolve(n?n.Or:null)},t.prototype.getEntries=function(t,e){var n=this,r=vi();return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),zs.resolve(r)},t.prototype.ns=function(t,e,n){for(var r=mi(),i=new Kr(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof as&&Ns(e,c)&&(r=r.st(c.key,c))}return zs.resolve(r)},t.prototype.Kl=function(t,e){return zs.forEach(this.docs,function(t){return e(t)})},t.prototype.jr=function(e){return new t.Kr(this)},t.prototype.zr=function(t){return zs.resolve(this.size)},t}();lc.Kr=function(t){function e(e){var n;return(n=t.call(this)||this).Hr=e,n}return s(e,t),e.prototype.Un=function(t){var e=this,n=[];return this.Fn.forEach(function(r,i){i?n.push(e.Hr.xn(t,i,e.readTime)):e.Hr.Mn(r)}),zs.Cn(n)},e.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},e.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},e}(Hs);var fc=function(){function t(t){this.persistence=t,this.Gl=new Mr(function(t){return ti(t)},ei),this.lastRemoteSnapshotVersion=Br.min(),this.highestTargetId=0,this.zl=0,this.Hl=new La,this.targetCount=0,this.Yl=la.to()}return t.prototype.be=function(t,e){return this.Gl.forEach(function(t,n){return e(n)}),zs.resolve()},t.prototype.ro=function(t){return zs.resolve(this.lastRemoteSnapshotVersion)},t.prototype.oo=function(t){return zs.resolve(this.zl)},t.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),zs.resolve(this.highestTargetId)},t.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),zs.resolve()},t.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new la(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},t.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,zs.resolve()},t.prototype.lo=function(t,e){return this.uo(e),zs.resolve()},t.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),this.targetCount-=1,zs.resolve()},t.prototype.hr=function(t,e,n){var r=this,i=0,o=[];return this.Gl.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gl.delete(s),o.push(r.fo(t,u.targetId)),i++)}),zs.Cn(o).next(function(){return i})},t.prototype.do=function(t){return zs.resolve(this.targetCount)},t.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return zs.resolve(n)},t.prototype.To=function(t,e,n){return this.Hl.vh(e,n),zs.resolve()},t.prototype.Io=function(t,e,n){this.Hl.Dh(e,n);var r=this.persistence.dr,i=[];return r&&e.forEach(function(e){i.push(r.Dr(t,e))}),zs.Cn(i)},t.prototype.fo=function(t,e){return this.Hl.Ch(e),zs.resolve()},t.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return zs.resolve(n)},t.prototype.Nr=function(t,e){return zs.resolve(this.Hl.Nr(e))},t}(),pc=function(){function t(t){var e=this;this.Jl={},this.yo=new Qs(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new fc(this),this.zn=new zu,this.Kn=new lc(this.zn,function(t){return e.dr.Xl(t)})}return t.prototype.start=function(){return Promise.resolve()},t.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(t.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),t.prototype.Bo=function(){},t.prototype.Uo=function(){},t.prototype.uh=function(){return this.zn},t.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new hc(this.zn,this.dr),this.Jl[t.$h()]=e),e},t.prototype.hh=function(){return this.ko},t.prototype.ah=function(){return this.Kn},t.prototype.runTransaction=function(t,e,n){var r=this;Tr("MemoryPersistence","Starting transaction:",t);var i=new dc(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},t.prototype.e_=function(t,e){return zs.Nn(Object.values(this.Jl).map(function(n){return function(){return n.Nr(t,e)}}))},t}(),dc=function(t){function e(e){var n;return(n=t.call(this)||this).Ro=e,n}return s(e,t),e}($s),yc=function(){function t(t){this.persistence=t,this.n_=new La,this.s_=null}return t.i_=function(e){return new t(e)},Object.defineProperty(t.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw Sr()},enumerable:!1,configurable:!0}),t.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),zs.resolve()},t.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),zs.resolve()},t.prototype.Dr=function(t,e){return this.r_.add(e.toString()),zs.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},t.prototype.Zl=function(){this.s_=new Set},t.prototype.t_=function(t){var e=this,n=this.persistence.ah().jr();return zs.forEach(this.r_,function(r){var i=Kr.B(r);return e.o_(t,i).next(function(t){t||n.Mn(i)})}).next(function(){return e.s_=null,n.apply(t)})},t.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},t.prototype.Xl=function(t){return 0},t.prototype.o_=function(t,e){var n=this;return zs.Nn([function(){return zs.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},t}(),vc=function(){function t(t){this.h_=t.h_,this.a_=t.a_}return t.prototype.wa=function(t){this.u_=t},t.prototype.ca=function(t){this.c_=t},t.prototype.onMessage=function(t){this.l_=t},t.prototype.close=function(){this.a_()},t.prototype.send=function(t){this.h_(t)},t.prototype.__=function(){this.u_()},t.prototype.f_=function(t){this.c_(t)},t.prototype.d_=function(t){this.l_(t)},t}(),gc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},mc=function(t){function e(e){var n;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n}return s(e,t),e.prototype.A_=function(t,e,n,r){return new Promise(function(i,o){var s=new wr;s.listenOnce(gr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case vr.NO_ERROR:var e=s.getResponseJson();Tr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case vr.TIMEOUT:Tr("Connection",'RPC "'+t+'" timed out'),o(new jr(qr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var n=s.getStatus();if(Tr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(qr).indexOf(e)>=0?e:qr.UNKNOWN}();o(new jr(u,r.message))}else o(new jr(qr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new jr(qr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{Tr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=yr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||v().indexOf("Electron/")>=0||((r=v()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||v().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");Tr("Connection","Creating WebChannel: "+u,s);var a=o.createWebChannel(u,s),c=!1,h=!1,l=new vc({h_:function(t){h?Tr("Connection","Not sending because WebChannel is closed:",t):(c||(Tr("Connection","Opening WebChannel transport."),a.open(),c=!0),Tr("Connection","WebChannel sending:",t),a.send(t))},a_:function(){return a.close()}}),f=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(mr.EventType.OPEN,function(){h||Tr("Connection","WebChannel transport opened.")}),f(mr.EventType.CLOSE,function(){h||(h=!0,Tr("Connection","WebChannel transport closed"),l.f_())}),f(mr.EventType.ERROR,function(t){h||(h=!0,_r("Connection","WebChannel transport errored:",t),l.f_(new jr(qr.UNAVAILABLE,"The operation could not be completed")))}),f(mr.EventType.MESSAGE,function(t){var e;if(!h){var n=t.data[0];Dr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Tr("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=ii[o];if(void 0!==e)return ai(e)}(),u=i.message;void 0===s&&(s=qr.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,l.f_(new jr(s,u)),a.close()}else Tr("Connection","WebChannel received:",n),l.d_(n)}}),setTimeout(function(){l.__()},0),l},e}(function(){function t(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}return t.prototype.va=function(t,e,n,r){var i=this.I_(t,e);Tr("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(t,i,o,n).then(function(t){return Tr("RestConnection","Received: ",t),t},function(e){throw _r("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},t.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},t.prototype.I_=function(t,e){var n=gc[t];return this.T_+"/v1/"+e+":"+n},t}()),wc=function(){function t(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}return t.prototype.Ka=function(t){this.y_.push(t)},t.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},t.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},t.prototype.P_=function(){Tr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},t.prototype.V_=function(){Tr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},t.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),bc=function(){function t(){}return t.prototype.Ka=function(t){},t.prototype.th=function(){},t}();function Ec(t){return new no(t,!0)}var Ic="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tc=function(){function t(){}return t.prototype.initialize=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.Uc=this.b_(t),this.persistence=this.v_(t),[4,this.persistence.start()];case 1:return e.sent(),this.S_=this.D_(t),this.La=this.C_(t),[2]}})})},t.prototype.D_=function(t){return null},t.prototype.C_=function(t){return e=this.persistence,n=new cc,r=t.N_,new Na(e,n,r);var e,n,r},t.prototype.v_=function(t){if(t.k_.F_)throw new jr(qr.FAILED_PRECONDITION,Ic);return new pc(yc.i_)},t.prototype.b_=function(t){return new Ja},t.prototype.terminate=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},t.prototype.clearPersistence=function(t,e){throw new jr(qr.FAILED_PRECONDITION,Ic)},t}(),Nc=function(t){function e(e){var n;return(n=t.call(this)||this).x_=e,n}return s(e,t),e.prototype.initialize=function(e){return u(this,void 0,void 0,function(){var n,r=this;return a(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),[4,this.x_.initialize(this,e)];case 2:return i.sent(),n=this.x_.fu,this.Uc instanceof Za?(this.Uc.fu={Ic:function(t,e,n,r){return u(this,void 0,void 0,function(){var i,o;return a(this,function(s){switch(s.label){case 0:return(i=Or(t)).nl("applyBatchState()"),[4,function(t,e){var n=Or(t),r=Or(n.Gn);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Pr(t,e).next(function(e){return e?n.Rh.Zn(t,e):zs.resolve(null)})})}(i.La,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,i.Bc.hu()];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(i.cl(e,r||null),function(t,e){Or(Or(t).Gn).Sr(e)}(i.La,e)):Sr(),s.label=4;case 4:return[4,i.hl(o)];case 5:return s.sent(),[3,7];case 6:Tr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}.bind(null,n),mc:function(t,e,n,r){return u(this,void 0,void 0,function(){var i,o,s;return a(this,function(u){switch(u.label){case 0:return(i=Or(t)).tl?(Tr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Kc.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=Or(t),n=Or(e.Ah);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return n.Ur(t,e.mh)}).then(function(t){var n=t.Qr,r=t.readTime;return e.mh=r,n})}(i.La)];case 3:return o=u.sent(),s=Si.zt(e,"current"===n),[4,i.hl(o,s)];case 4:return u.sent(),[3,8];case 5:return[4,Sa(i.La,e,!0)];case 6:return u.sent(),i.rl(e,r),[3,8];case 7:Sr(),u.label=8;case 8:return[2]}})})}.bind(null,n),Ac:function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u,c,h,l,f,p;return a(this,function(d){switch(d.label){case 0:if(!(r=Or(t)).tl)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.Kc.has(s)?(Tr("SyncEngine","Adding an already active target "+s),[3,5]):[4,Oa(r.La,s)]):[3,6];case 2:return u=d.sent(),[4,Aa(r.La,u)];case 3:return c=d.sent(),[4,r.sl(sc(u),c.targetId,!1)];case 4:d.sent(),r.Bc.listen(c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return a(this,function(e){switch(e.label){case 0:return r.Kc.has(t)?[4,Sa(r.La,t,!1).then(function(){r.Bc.lu(t),r.rl(t)}).catch(Ra)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}.bind(null,n),rh:function(t){return Or(Or(Or(t).La).persistence).rh()}.bind(null,n)},[4,this.Uc.start()]):[3,4];case 3:i.sent(),i.label=4;case 4:return[4,this.persistence.qo(function(t){return u(r,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h;return a(this,function(a){switch(a.label){case 0:return n=Or(t),!0!==e||!0===n.tl?[3,3]:(r=n.Uc.zu(),[4,oc(n,r.N())]);case 1:return i=a.sent(),n.tl=!0,[4,n.Bc.Su(!0)];case 2:for(a.sent(),o=0,s=i;o<s.length;o++)u=s[o],n.Bc.listen(u);return[3,7];case 3:return!1!==e||!1===n.tl?[3,7]:(c=[],h=Promise.resolve(),n.Kc.forEach(function(t,e){n.Uc.ic(e)?c.push(e):h=h.then(function(){return n.rl(e),Sa(n.La,e,!0)}),n.Bc.lu(e)}),[4,h]);case 4:return a.sent(),[4,oc(n,c)];case 5:return a.sent(),function(t){var e=Or(t);e.Hc.forEach(function(t,n){e.Bc.lu(n)}),e.Yc.Nh(),e.Hc=new Map,e.zc=new ci(Kr.P)}(n),n.tl=!1,[4,n.Bc.Su(!1)];case 6:a.sent(),a.label=7;case 7:return[2]}})})}(this.x_.fu,t)];case 1:return e.sent(),this.S_&&(t&&!this.S_.tr?this.S_.start(this.La):t||this.S_.stop()),[2]}})})})];case 5:return i.sent(),[2]}})})},e.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=au();if(!Za.ks(e))throw new jr(qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ta(t.w_.s,t.w_.persistenceKey);return new Za(e,t.ei,n,t.clientId,t.N_)}return new Ja},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return u(this,void 0,void 0,function(){var e,n;return a(this,function(r){return e=Or(t),n=Or(e.Ah),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.La)];case 2:return n.sent(),[2]}})})},e.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new gu(e,t.ei)},e.prototype.v_=function(t){var e=Ta(t.w_.s,t.w_.persistenceKey),n=Ec(t.w_.s);return new ma(t.k_.synchronizeTabs,e,t.clientId,vu.Ui(t.k_.cacheSizeBytes),t.ei,au(),cu(),n,this.Uc,t.k_.Vo)},e.prototype.b_=function(t){return new Ja},e.prototype.clearPersistence=function(t,e){return function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return Js.ks()?(e=t+"main",[4,Js.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(Ta(t,e))},e}(Tc)),_c=function(){function t(){}return t.prototype.initialize=function(t,e){return u(this,void 0,void 0,function(){var n=this;return a(this,function(r){switch(r.label){case 0:return this.La?[3,3]:(this.La=t.La,this.Uc=t.Uc,this.qa=this.O_(e),this.Bc=this.M_(e),this.fu=this.L_(e),this.q_=this.B_(e),this.Uc.Da=function(t){return n.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return r.sent(),[4,this.Bc.Su(this.fu.el)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.B_=function(t){return new uc(this.fu)},t.prototype.O_=function(t){var e,n=Ec(t.w_.s),r=(e=t.w_,new mc(e));return function(t,e,n){return new ja(t,r,n)}(t.credentials,0,n)},t.prototype.M_=function(t){var e=this;return new Ba(this.La,this.qa,t.ei,function(t){return e.fu.xc(t,0)},wc.ks()?new wc:new bc)},t.prototype.L_=function(t){return function(t,e,n,r,i,o,s){var u=new ic(t,e,n,r,i,o);return s&&(u.tl=!0),u}(this.La,this.Bc,this.qa,this.Uc,t.N_,t.Qc,!t.k_.F_||!t.k_.synchronizeTabs)},t.prototype.terminate=function(){return this.Bc.th()},t}();function Ac(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Sc=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Q_=function(){this.muted=!0},t.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}();function Dc(t,e){if(0!==e.length)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Wc(e.length,"argument")+".")}function Oc(t,e,n){if(e.length!==n)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires "+Wc(n,"argument")+", but was called with "+Wc(e.length,"argument")+".")}function Rc(t,e,n){if(e.length<n)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Wc(n,"argument")+", but was called with "+Wc(e.length,"argument")+".")}function Lc(t,e,n,r){if(e.length<n||e.length>r)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Wc(e.length,"argument")+".")}function Pc(t,e,n,r){Fc(t,e,Hc(n)+" argument",r)}function xc(t,e,n,r){void 0!==r&&Pc(t,e,n,r)}function kc(t,e,n,r){Fc(t,e,n+" option",r)}function Vc(t,e,n,r){void 0!==r&&kc(t,e,n,r)}function Cc(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(qc(a))}var c=qc(r);throw new jr(qr.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function Uc(t,e,n,r){if(!e.some(function(t){return t===r}))throw new jr(qr.INVALID_ARGUMENT,"Invalid value "+qc(r)+" provided to function "+t+"() for its "+Hc(n)+" argument. Acceptable values: "+e.join(", "));return r}function Fc(t,e,n,r){if(!("object"===e?Mc(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=qc(r);throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Mc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function qc(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Sr()}function jc(t,e,n){if(void 0===n)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Hc(e)+" argument, but it was undefined.")}function Gc(t,e,n){Ur(e,function(e,r){if(n.indexOf(e)<0)throw new jr(qr.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function Bc(t,e,n,r){var i=qc(r);return new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Hc(n)+" argument to be a "+e+", but it was: "+i)}function zc(t,e,n){if(n<=0)throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Hc(e)+" argument to be a positive number, but it was: "+n+".")}function Hc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Wc(t,e){return t+" "+e+(1===t?"":"s")}function $c(){if("undefined"==typeof Uint8Array)throw new jr(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kc(){if("undefined"==typeof atob)throw new jr(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Yc=function(){function t(t){Kc(),this.W_=t}return t.fromBase64String=function(e){Oc("Blob.fromBase64String",arguments,1),Pc("Blob.fromBase64String","string",1,e),Kc();try{return new t(ri.fromBase64String(e))}catch(e){throw new jr(qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(Oc("Blob.fromUint8Array",arguments,1),$c(),!(e instanceof Uint8Array))throw Bc("Blob.fromUint8Array","Uint8Array",1,e);return new t(ri.fromUint8Array(e))},t.prototype.toBase64=function(){return Oc("Blob.toBase64",arguments,0),Kc(),this.W_.toBase64()},t.prototype.toUint8Array=function(){return Oc("Blob.toUint8Array",arguments,0),$c(),this.W_.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},t}(),Qc=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new jr(qr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Wc(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(Pc("FieldPath","string",e,t[e]),0===t[e].length)throw new jr(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new $r(t)},Xc=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return s(e,t),e.documentId=function(){return new e($r.L().F())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Bc("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},e}(Qc),Zc=new RegExp("[~\\*/\\[\\]]"),Jc=function(){this.K_=this},th=function(t){function e(e){var n;return(n=t.call(this)||this).G_=e,n}return s(e,t),e.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Jc);function eh(t,e,n){return new dh({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var nh=function(t){function e(e){var n;return(n=t.call(this)||this).G_=e,n}return s(e,t),e.prototype.z_=function(t){return new jo(t.path,new Po)},e.prototype.isEqual=function(t){return t instanceof e},e}(Jc),rh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.Z_=n,r}return s(e,t),e.prototype.z_=function(t){var e=eh(this,t,!0),n=this.Z_.map(function(t){return bh(t,e)}),r=new xo(n);return new jo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Jc),ih=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.Z_=n,r}return s(e,t),e.prototype.z_=function(t){var e=eh(this,t,!0),n=this.Z_.map(function(t){return bh(t,e)}),r=new Vo(n);return new jo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Jc),oh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).G_=e,r.tf=n,r}return s(e,t),e.prototype.z_=function(t){var e=new Uo(t.serializer,oo(t.serializer,this.tf));return new jo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Jc),sh=function(t){function e(){return t.call(this)||this}return s(e,t),e.delete=function(){return Dc("FieldValue.delete",arguments),new uh(new th("FieldValue.delete"))},e.serverTimestamp=function(){return Dc("FieldValue.serverTimestamp",arguments),new uh(new nh("FieldValue.serverTimestamp"))},e.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Rc("FieldValue.arrayUnion",arguments,1),new uh(new rh("FieldValue.arrayUnion",t))},e.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Rc("FieldValue.arrayRemove",arguments,1),new uh(new ih("FieldValue.arrayRemove",t))},e.increment=function(t){return Pc("FieldValue.increment","number",1,t),Oc("FieldValue.increment",arguments,1),new uh(new oh("FieldValue.increment",t))},e}(Jc),uh=function(t){function e(e){var n=this;return(n=t.call(this)||this).K_=e,n.G_=e.G_,n}return s(e,t),e.prototype.z_=function(t){return this.K_.z_(t)},e.prototype.isEqual=function(t){return t instanceof e&&this.K_.isEqual(t.K_)},e}(sh),ah=function(){function t(t,e){if(Oc("GeoPoint",arguments,2),Pc("GeoPoint","number",1,t),Pc("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new jr(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new jr(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},t.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},t.prototype.T=function(t){return Pr(this.ef,t.ef)||Pr(this.nf,t.nf)},t}(),ch=/^__.*__$/,hh=function(t,e,n){this.sf=t,this.if=e,this.rf=n},lh=function(){function t(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}return t.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Xo(t,this.data,this.qe,e)):n.push(new Qo(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Jo(t,this.fieldTransforms)),n},t}(),fh=function(){function t(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}return t.prototype.hf=function(t,e){var n=[new Xo(t,this.data,this.qe,e)];return this.fieldTransforms.length>0&&n.push(new Jo(t,this.fieldTransforms)),n},t}();function ph(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Sr()}}var dh=function(){function t(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),t.prototype.uf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},t.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},t.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},t.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},t.prototype.Y_=function(t){return Ah(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},t.prototype.contains=function(t){return void 0!==this.qe.find(function(e){return t.D(e)})||void 0!==this.fieldTransforms.find(function(e){return t.D(e.field)})},t.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},t.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(ph(this.H_)&&ch.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},t}(),yh=function(){function t(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ec(t)}return t.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new dh({H_:t,methodName:e,J_:n,path:$r.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},t}();function vh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Th("Data must be an object, but it was:",s,r);var u,a,c=Eh(r,s);if(o.merge)u=new qo(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Qc)d=p.j_;else{if("string"!=typeof p)throw Sr();d=_h(e,p,n)}if(!s.contains(d))throw new jr(qr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Sh(h,d)||h.push(d)}u=new qo(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new lh(new is(c),u,a)}function gh(t,e,n,r){var i=t.wf(1,e,n);Th("Data must be an object, but it was:",i,r);var o=[],s=new os;Ur(r,function(t,r){var u=_h(e,t,n),a=i._f(u);if(r instanceof Jc&&r.K_ instanceof th)o.push(u);else{var c=bh(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new qo(o);return new fh(s.ze(),u,i.fieldTransforms)}function mh(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[Nh(e,r,n)],a=[i];if(o.length%2!=0)throw new jr(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Nh(e,o[c])),a.push(o[c+1]);for(var h=[],l=new os,f=u.length-1;f>=0;--f)if(!Sh(h,u[f])){var p=u[f],d=a[f],y=s._f(p);if(d instanceof Jc&&d.K_ instanceof th)h.push(p);else{var v=bh(d,y);null!=v&&(h.push(p),l.set(p,v))}}var g=new qo(h);return new fh(l.ze(),g,s.fieldTransforms)}function wh(t,e,n,r){return void 0===r&&(r=!1),bh(n,t.wf(r?4:3,e))}function bh(t,e){if(Ih(t))return Th("Unsupported field value:",e,t),Eh(t,e);if(t instanceof Jc)return function(t,e){if(!ph(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.qe.push(e.path),t instanceof Array){if(e.settings.X_&&4!==e.H_)throw e.Y_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=bh(o[i],e.ff(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return oo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Gr.fromDate(t);return{timestampValue:so(e.serializer,n)}}if(t instanceof Gr){var r=new Gr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:so(e.serializer,r)}}if(t instanceof ah)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Yc)return{bytesValue:uo(e.serializer,t)};if(t instanceof hh){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:co(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+qc(t))}(t,e)}function Eh(t,e){var n={};return Fr(t)?e.path&&e.path.length>0&&e.qe.push(e.path):Ur(t,function(t,r){var i=bh(r,e.cf(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Ih(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Gr||t instanceof ah||t instanceof Yc||t instanceof hh||t instanceof Jc)}function Th(t,e,n){if(!Ih(n)||!Mc(n)){var r=qc(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function Nh(t,e,n){if(e instanceof Qc)return e.j_;if("string"==typeof e)return _h(t,e);throw Ah("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function _h(t,e,n){try{return function(t){if(t.search(Zc)>=0)throw new jr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Xc.bind.apply(Xc,c([void 0],t.split("."))))}catch(e){throw new jr(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Ah((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Ah(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new jr(qr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Sh(t,e){return t.some(function(t){return t.isEqual(e)})}var Dh=function(){function t(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}return t.prototype.Af=function(t){return u(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:if(this.Rf(),this.mutations.length>0)throw new jr(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return n=Or(t),r=vo(n.serializer)+"/documents",i={documents:e.map(function(t){return lo(n.serializer,t)})},[4,n.Sa("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=fo(t,e.found.name),r=ao(e.found.updateTime),i=new is({mapValue:{fields:e.found.fields}});return new as(n,r,i,{})}(t,e):"missing"in e?function(t,e){Dr(!!e.missing),Dr(!!e.readTime);var n=fo(t,e.missing),r=ao(e.readTime);return new cs(n,r)}(t,e):Sr()}(n.serializer,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Dr(!!e),u.push(e)}),u)]}})})}(this.qa,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof cs||t instanceof as?n.Pf(t):Sr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},t.prototype.delete=function(t){this.write([new ns(t,this.Qe(t))]),this.mf.add(t.toString())},t.prototype.commit=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:if(this.Rf(),this.If)throw this.If;return t=this.Tf,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Kr.B(n);e.mutations.push(new rs(r,e.Qe(r)))}),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return n=Or(t),r=vo(n.serializer)+"/documents",i={writes:e.map(function(t){return wo(n.serializer,t)})},[4,n.va("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return n.sent(),this.Ef=!0,[2]}})})},t.prototype.Pf=function(t){var e;if(t instanceof as)e=t.version;else{if(!(t instanceof cs))throw Sr();e=Br.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new jr(qr.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},t.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?Go.updateTime(e):Go.We()},t.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(!this.mf.has(t.toString())&&e){if(e.isEqual(Br.min()))throw new jr(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Go.updateTime(e)}return Go.exists(!0)},t.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},t.prototype.Rf=function(){},t}(),Oh=function(){function t(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new Zs(this.ei,"transaction_retry")}return t.prototype.run=function(){this.yf()},t.prototype.yf=function(){var t=this;this.Ti.bs(function(){return u(t,void 0,void 0,function(){var t,e,n=this;return a(this,function(r){return t=new Dh(this.qa),(e=this.pf(t))&&e.then(function(e){n.ei.ai(function(){return t.commit().then(function(){n.ii.resolve(e)}).catch(function(t){n.bf(t)})})}).catch(function(t){n.bf(t)}),[2]})})})},t.prototype.pf=function(t){try{var e=this.updateFunction(t);return!Yr(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},t.prototype.bf=function(t){var e=this;this.Vf>0&&this.vf(t)?(this.Vf-=1,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},t.prototype.vf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ui(e)}return!1},t}(),Rh=function(){function t(t,e){this.credentials=t,this.ei=e,this.clientId=Lr.t(),this.Sf=new Xs}return t.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new Xs,s=!1;return this.credentials.Bh(function(t){if(!s)return s=!0,Tr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject);i.ei.gi(function(){return i.Bc.vu(t)})}),this.ei.ai(function(){return i.Sf.promise}),o.promise},t.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()})},t.prototype.Cf=function(t,e,n,r,i){return u(this,void 0,void 0,function(){var o,s,c=this;return a(this,function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),o={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:r,Qc:100,k_:n},[4,t.initialize(o)];case 1:return h.sent(),[4,e.initialize(t,o)];case 2:return h.sent(),this.persistence=t.persistence,this.Uc=t.Uc,this.La=t.La,this.S_=t.S_,this.qa=e.qa,this.Bc=e.Bc,this.fu=e.fu,this.Nf=e.q_,this.persistence.Bo(function(){return u(c,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),i.resolve(),[3,4];case 3:if(s=h.sent(),i.reject(s),!this.Ff(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.Cf(new Tc,new _c,{F_:!1},r,i))];case 4:return[2]}})})},t.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===qr.FAILED_PRECONDITION||t.code===qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.Df=function(){if(this.ei.Ii)throw new jr(qr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()})},t.prototype.terminate=function(){var t=this;this.ei.Pi();var e=new Xs;return this.ei.mi(function(){return u(t,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return r.sent(),[4,this.Uc.th()];case 2:return r.sent(),[4,this.persistence.th()];case 3:return r.sent(),this.credentials.Uh(),e.resolve(),[3,5];case 4:return t=r.sent(),n=fu(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}})})}),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new Xs;return this.ei.ai(function(){return t.fu._l(e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Sc(n),o=new ac(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lu(o)})}},t.prototype.kf=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(e.sent(),function(t,e,n){return u(this,void 0,void 0,function(){var r,i=this;return a(this,function(o){switch(o.label){case 0:return r=new Xs,[4,t.enqueue(function(){return u(i,void 0,void 0,function(){var t,i,o;return a(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,n){var r=Or(e);return r.persistence.runTransaction("read document","readonly",function(t){return r.Rh.Hn(t,n)})}(0,n)];case 1:return(t=s.sent())instanceof as?r.resolve(t):t instanceof cs?r.resolve(null):r.reject(new jr(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=fu(i,"Failed to get document '"+n+" from cache"),r.reject(o),[3,3];case 3:return[2]}})})})];case 1:return[2,(o.sent(),r.promise)]}})})}(this.ei,this.La,t))]}})})},t.prototype.$f=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(n.sent(),function(t,e,n,r){var i=new Xs,o=Lh(t,e,ds(n.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new jr(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new jr(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}});return i.promise}(this.ei,this.Nf,t,e))]}})})},t.prototype.xf=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(e.sent(),function(t,e,n){return u(this,void 0,void 0,function(){var r,i=this;return a(this,function(o){switch(o.label){case 0:return r=new Xs,[4,t.enqueue(function(){return u(i,void 0,void 0,function(){var t,i,o,s,u,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Da(e,n,!0)];case 1:return t=a.sent(),i=new nc(n,t.gh),o=i.Sc(t.documents),s=i.Un(o,!1),r.resolve(s.snapshot),[3,3];case 2:return u=a.sent(),c=fu(u,"Failed to execute query '"+n+" against cache"),r.reject(c),[3,3];case 3:return[2]}})})})];case 1:return[2,(o.sent(),r.promise)]}})})}(this.ei,this.La,t))]}})})},t.prototype.Of=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(n.sent(),function(t,e,n,r){var i=new Xs,o=Lh(t,e,n,{includeMetadataChanges:!0,$l:!0},{next:function(t){o(),t.fromCache&&r&&"server"===r.source?i.reject(new jr(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}});return i.promise}(this.ei,this.Nf,t,e))]}})})},t.prototype.write=function(t){var e=this;this.Df();var n=new Xs;return this.ei.ai(function(){return e.fu.write(t,n)}),n.promise},t.prototype.s=function(){return this.w_.s},t.prototype.bl=function(t){var e=this;this.Df();var n=new Sc(t);return this.ei.ai(function(){return u(e,void 0,void 0,function(){return a(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return u(e,void 0,void 0,function(){return a(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(t.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.Df();var n=new Xs;return this.ei.ai(function(){return new Oh(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},t}();function Lh(t,e,n,r,i){var o=new Sc(i),s=new ac(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lu(s)})}}var Ph=function(){function t(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}return t.prototype.Bf=function(t){switch(Mi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Wi(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new Yc($i(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw Sr()}},t.prototype.Gf=function(t){var e=this,n={};return Ur(t.fields||{},function(t,r){n[t]=e.Bf(r)}),n},t.prototype.jf=function(t){return new ah(Wi(t.latitude),Wi(t.longitude))},t.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},t.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Ci(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(Ui(t));default:return null}},t.prototype.Uf=function(t){var e=Hi(t),n=new Gr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.Wf=function(t){var e=Hr.k(t);Dr(So(e));var n=new Vr(e.get(1),e.get(3)),r=new Kr(e.V(5));return n.isEqual(this.s)||Nr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},t}(),xh=vu.ji,kh=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new jr(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else kc("settings","non-empty string","host",t.host),this.host=t.host,Vc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Gc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Vc("settings","object","credentials",t.credentials),this.credentials=t.credentials,Vc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Vc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Nr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Nr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Vc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=vu.Gi;else{if(t.cacheSizeBytes!==xh&&t.cacheSizeBytes<vu.Ki)throw new jr(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+vu.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Vc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Vh=function(){function t(e,n,r,i){var o=this;if(void 0===r&&(r=new Tc),void 0===i&&(i=new _c),this.zf=r,this.Hf=i,this.Yf=null,this.Jf=new lu,this.INTERNAL={delete:function(){return u(o,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof e.options){var s=e;this.Yf=s,this.sf=t.td(s),this.ed=s.name,this.nd=new Va(n)}else{var c=e;if(!c.projectId)throw new jr(qr.INVALID_ARGUMENT,"Must provide projectId");this.sf=new Vr(c.projectId,c.database),this.ed="[DEFAULT]",this.nd=new ka}this.sd=new kh({})}return Object.defineProperty(t.prototype,"rd",{get:function(){return this.od||(this.od=new yh(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){Oc("Firestore.settings",arguments,1),Pc("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new kh(t);if(this.Zf&&!this.sd.isEqual(e))throw new jr(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.sd=e,void 0!==e.credentials&&(this.nd=function(t){if(!t)return new ka;switch(t.type){case"gapi":var e=t.hd;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ua(e,t.zh||"0");case"provider":return t.hd;default:throw new jr(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},t.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new jr(qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Nr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new jr(qr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},t.prototype.clearPersistence=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){if(void 0!==this.Zf&&!this.Zf.Mf)throw new jr(qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new Xs,[2,(this.Jf.mi(function(){return u(e,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}})})}),t.promise)]})})},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.Xf(),Ac(t))return this.Zf.bl(t);Pc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},t.prototype.Xf=function(){return this.Zf||this.ad(new Tc,new _c,{F_:!1}),this.Zf},t.prototype.ld=function(){return new function(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},t.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new Rh(this.nd,this.Jf),this.Zf.start(r,t,e,n)},t.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new jr(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new jr(qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Vr(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Yf)throw new jr(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return Oc("Firestore.collection",arguments,1),Pc("Firestore.collection","non-empty string",1,t),this.Xf(),new Kh(Hr.k(t),this,null)},t.prototype.doc=function(t){return Oc("Firestore.doc",arguments,1),Pc("Firestore.doc","non-empty string",1,t),this.Xf(),Fh._d(Hr.k(t),this,null)},t.prototype.collectionGroup=function(t){if(Oc("Firestore.collectionGroup",arguments,1),Pc("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new jr(qr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Wh(function(t){return new fs(Hr.$(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return Oc("Firestore.runTransaction",arguments,1),Pc("Firestore.runTransaction","function",1,t),this.Xf().transaction(function(n){return t(new Ch(e,n))})},t.prototype.batch=function(){return this.Xf(),new Uh(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Ir()){case r.DEBUG:return"debug";case r.ERROR:return"error";case r.SILENT:return"silent";case r.WARN:return"warn";case r.INFO:return"info";case r.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;Oc("Firestore.setLogLevel",arguments,1),Uc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,Er.setLogLevel(e)},t.prototype.fd=function(){return this.sd.timestampsInSnapshots},t.prototype.dd=function(){return this.sd},t}(),Ch=function(){function t(t,e){this.wd=t,this.Td=e}return t.prototype.get=function(t){var e=this;Oc("Transaction.get",arguments,1);var n=Zh("Transaction.get",t,this.wd);return this.Td.Af([n.if]).then(function(t){if(!t||1!==t.length)return Sr();var r=t[0];if(r instanceof cs)return new qh(e.wd,n.if,null,!1,!1,n.rf);if(r instanceof as)return new qh(e.wd,n.if,r,!1,!1,n.rf);throw Sr()})},t.prototype.set=function(t,e,n){Lc("Transaction.set",arguments,2,3);var r=Zh("Transaction.set",t,this.wd);n=Yh("Transaction.set",n);var i=Jh(r.rf,e,n),o=vh(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Xc?(Rc("Transaction.update",arguments,3),r=Zh("Transaction.update",t,this.wd),i=mh(this.wd.rd,"Transaction.update",r.if,e,n,o)):(Oc("Transaction.update",arguments,2),r=Zh("Transaction.update",t,this.wd),i=gh(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},t.prototype.delete=function(t){Oc("Transaction.delete",arguments,1);var e=Zh("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},t}(),Uh=function(){function t(t){this.wd=t,this.Ed=[],this.Id=!1}return t.prototype.set=function(t,e,n){Lc("WriteBatch.set",arguments,2,3),this.md();var r=Zh("WriteBatch.set",t,this.wd);n=Yh("WriteBatch.set",n);var i=Jh(r.rf,e,n),o=vh(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,Go.We())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),"string"==typeof e||e instanceof Xc?(Rc("WriteBatch.update",arguments,3),r=Zh("WriteBatch.update",t,this.wd),i=mh(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(Oc("WriteBatch.update",arguments,2),r=Zh("WriteBatch.update",t,this.wd),i=gh(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,Go.exists(!0))),this},t.prototype.delete=function(t){Oc("WriteBatch.delete",arguments,1),this.md();var e=Zh("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new ns(e.if,Go.We())),this},t.prototype.commit=function(){return this.md(),this.Id=!0,this.Ed.length>0?this.wd.Xf().write(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Id)throw new jr(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Fh=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.sf,e,r)||this).if=e,i.firestore=n,i.rf=r,i.Zf=i.firestore.Xf(),i}return s(e,t),e._d=function(t,n,r){if(t.length%2!=0)throw new jr(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new e(new Kr(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Kh(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(Oc("DocumentReference.collection",arguments,1),Pc("DocumentReference.collection","non-empty string",1,t),!t)throw new jr(qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Hr.k(t);return new Kh(this.if.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Bc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},e.prototype.set=function(t,e){Lc("DocumentReference.set",arguments,1,2),e=Yh("DocumentReference.set",e);var n=Jh(this.rf,t,e),r=vh(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,Go.We()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Xc?(Rc("DocumentReference.update",arguments,2),n=mh(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Oc("DocumentReference.update",arguments,1),n=gh(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,Go.exists(!0)))},e.prototype.delete=function(){return Oc("DocumentReference.delete",arguments,0),this.Zf.write([new ns(this.if,Go.We())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Lc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Ac(i[u])||(Gc("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Vc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Ac(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else Pc("DocumentReference.onSnapshot","function",u,i[u]),xc("DocumentReference.onSnapshot","function",u+1,i[u+1]),xc("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(ds(this.if.path),a,h)},e.prototype.get=function(t){var e=this;Lc("DocumentReference.get",arguments,0,1),Xh("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new qh(e.firestore,e.if,t,!0,t instanceof as&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Ad(t)})},e.prototype.withConverter=function(t){return new e(this.if,this.firestore,t)},e.prototype.Ad=function(t){var e=t.docs.get(this.if);return new qh(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},e}(hh),Mh=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),qh=function(){function t(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}return t.prototype.data=function(t){var e=this;if(Lc("DocumentSnapshot.data",arguments,0,1),t=Qh("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new jh(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new Ph(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",function(t){return new Fh(t,e.wd,null)}).Bf(this.Rd.tn())}},t.prototype.get=function(t,e){var n=this;if(Lc("DocumentSnapshot.get",arguments,1,2),e=Qh("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(Nh("DocumentSnapshot.get",t,this.if));if(null!==r)return new Ph(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",function(t){return new Fh(t,n.wd,n.rf)}).Bf(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Fh(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Mh(this.gd,this.Pd)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Bc("isEqual","DocumentSnapshot",1,e);return this.wd===e.wd&&this.Pd===e.Pd&&this.if.isEqual(e.if)&&(null===this.Rd?null===e.Rd:this.Rd.isEqual(e.Rd))&&this.rf===e.rf},t}(),jh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(qh);function Gh(t,e,n){if("string"==typeof n){if(""===n)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ys(e)&&-1!==n.indexOf("/"))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Hr.k(n));if(!Kr.j(r))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ki(t,new Kr(r))}if(n instanceof hh)return Ki(t,n.if);throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+qc(n)+".")}function Bh(t,e){if(!Array.isArray(t)||0===t.length)throw new jr(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new jr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new jr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new jr(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function zh(t,e,n){if(!n.isEqual(e))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Hh(t){if(t.un()&&0===t.en.length)throw new jr(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wh=function(){function t(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}return t.prototype.where=function(e,n,r){var i;Oc("Query.where",arguments,3),jc("Query.where",3,r),i="not-in"===n||"!="===n?n:Uc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,n);var o=Nh("Query.where",e),s=function(t,e,n,r,i,o,s){var u;if(i.M()){if("array-contains"===o||"array-contains-any"===o)throw new jr(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Bh(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var l=h[c];a.push(Gh(r,t,l))}u={arrayValue:{values:a}}}else u=Gh(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Bh(s,o),u=wh(n,e,s,"in"===o||"not-in"===o);var f=As.create(i,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&zh(0,e.field,r)}var i=t.fn(function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new jr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new jr(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.Vd,"Query.where",this.firestore.rd,this.firestore.sf,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new fs(t.path,t.collectionGroup,t.en.slice(),n,t.limit,t.nn,t.startAt,t.endAt)}(this.Vd,s),this.firestore,this.rf)},t.prototype.orderBy=function(e,n){var r;if(Lc("Query.orderBy",arguments,1,2),xc("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new jr(qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=Nh("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ms(e,n);return function(t,e){if(null===t.cn()){var n=t.ln();null!==n&&zh(0,n,e.field)}}(t,r),r}(this.Vd,i,r);return new t(function(t,e){var n=t.en.concat([e]);return new fs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.nn,t.startAt,t.endAt)}(this.Vd,o),this.firestore,this.rf)},t.prototype.limit=function(e){return Oc("Query.limit",arguments,1),Pc("Query.limit","number",1,e),zc("Query.limit",1,e),new t(ms(this.Vd,e,"F"),this.firestore,this.rf)},t.prototype.limitToLast=function(e){return Oc("Query.limitToLast",arguments,1),Pc("Query.limitToLast","number",1,e),zc("Query.limitToLast",1,e),new t(ms(this.Vd,e,"L"),this.firestore,this.rf)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rc("Query.startAt",arguments,1);var i=this.yd("Query.startAt",e,n,!0);return new t(ws(this.Vd,i),this.firestore,this.rf)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rc("Query.startAfter",arguments,1);var i=this.yd("Query.startAfter",e,n,!1);return new t(ws(this.Vd,i),this.firestore,this.rf)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rc("Query.endBefore",arguments,1);var i=this.yd("Query.endBefore",e,n,!0);return new t(bs(this.Vd,i),this.firestore,this.rf)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rc("Query.endAt",arguments,1);var i=this.yd("Query.endAt",e,n,!1);return new t(bs(this.Vd,i),this.firestore,this.rf)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Bc("isEqual","Query",1,e);return this.firestore===e.firestore&&Es(this.Vd,e.Vd)&&this.rf===e.rf},t.prototype.withConverter=function(e){return new t(this.Vd,this.firestore,e)},t.prototype.yd=function(t,e,n,r){if(jc(t,1,e),e instanceof qh)return Oc(t,c([e],n),1),function(t,e,n,r,i){if(!r)throw new jr(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=vs(t);s<u.length;s++){var a=u[s];if(a.field.M())o.push(Ki(e,r.key));else{var c=r.field(a.field);if(Ci(c))throw new jr(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.F();throw new jr(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Vs(o,i)}(this.Vd,this.firestore.sf,t,e.Rd,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new jr(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new jr(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ys(t)&&-1!==c.indexOf("/"))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Hr.k(c));if(!Kr.j(h))throw new jr(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Kr(h);u.push(Ki(e,l))}else{var f=wh(n,r,c);u.push(f)}}return new Vs(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Lc("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||Ac(i[u])||(Gc("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Vc("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),Ac(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else Pc("Query.onSnapshot","function",u,i[u]),xc("Query.onSnapshot","function",u+1,i[u+1]),xc("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new $h(r.firestore,r.Vd,t,r.rf))},error:i[u+1],complete:i[u+2]};return Hh(this.Vd),this.firestore.Xf().listen(this.Vd,s,c)},t.prototype.get=function(t){var e=this;Lc("Query.get",arguments,0,1),Xh("Query.get",t),Hh(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then(function(t){return new $h(e.firestore,e.Vd,t,e.rf)})},t}(),$h=function(){function t(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new Mh(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Lc("QuerySnapshot.forEach",arguments,1,2),Pc("QuerySnapshot.forEach","function",1,t),this.bd.docs.forEach(function(r){t.call(e,n.Dd(r,n.metadata.fromCache,n.bd.qt.has(r.key)))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Wh(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(Gc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Vc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new jr(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(t,e,n){if(t.Lt._()){var r=0;return t.docChanges.map(function(e){var i=n(e.doc,t.fromCache,t.qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}})}var i=t.Lt;return t.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var r=n(e.doc,t.fromCache,t.qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(e.type),doc:r,oldIndex:o,newIndex:s}})}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Bc("isEqual","QuerySnapshot",1,e);return this.wd===e.wd&&Es(this.pd,e.pd)&&this.bd.isEqual(e.bd)&&this.rf===e.rf},t.prototype.Dd=function(t,e,n){return new jh(this.wd,t.key,t,e,n,this.rf)},t}(),Kh=function(t){function e(e,n,r){var i;if((i=t.call(this,ds(e),n,r)||this).Cd=e,e.length%2!=1)throw new jr(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.F()+" has "+e.length);return i}return s(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new Fh(new Kr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){Lc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Lr.t()),Pc("CollectionReference.doc","non-empty string",1,t);var e=Hr.k(t);return Fh._d(this.Vd.path.child(e),this.firestore,this.rf)},e.prototype.add=function(t){Oc("CollectionReference.add",arguments,1),Pc("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},e.prototype.withConverter=function(t){return new e(this.Cd,this.firestore,t)},e}(Wh);function Yh(t,e){if(void 0===e)return{merge:!1};if(Gc(t,e,["merge","mergeFields"]),Vc(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+qc(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new jr(qr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+qc(r[o]))}(t,"mergeFields",0,r,function(t){return"string"==typeof t||t instanceof Xc})}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new jr(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Qh(t,e){return void 0===e?{}:(Gc(t,e,["serverTimestamps"]),Cc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Xh(t,e){xc(t,"object",1,e),e&&(Gc(t,e,["source"]),Cc(t,0,"source",e.source,["default","server","cache"]))}function Zh(t,e,n){if(e instanceof hh){if(e.firestore!==n)throw new jr(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Bc(t,"DocumentReference",1,e)}function Jh(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var tl={Firestore:Vh,GeoPoint:ah,Timestamp:Gr,Blob:Yc,Transaction:Ch,WriteBatch:Uh,DocumentReference:Fh,DocumentSnapshot:qh,Query:Wh,QueryDocumentSnapshot:jh,QuerySnapshot:$h,CollectionReference:Kh,FieldPath:Xc,FieldValue:sh,setLogLevel:Vh.setLogLevel,CACHE_SIZE_UNLIMITED:xh};function el(t){!function(t,e){t.INTERNAL.registerComponent(new br("firestore",function(t){return function(t,e){var n=new _c,r=new Nc(n);return new Vh(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},tl)))}(t),t.registerVersion("@firebase/firestore","1.16.6")}el(i.default),t.__PRIVATE_registerFirestore=el,Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r="FirebaseError",i=function(t){function e(n,i){var s=t.call(this,i)||this;return s.code=n,s.name=r,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,o.prototype.create),s}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?function(t,e){return t.replace(a,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",c=this.serviceName+": "+u+" ("+o+").",h=new i(o,c),l=0,f=Object.keys(r);l<f.length;l++){var p=f[l];"_"!==p.slice(-1)&&(p in h&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),h[p]=r[p])}return h},t}();var s,u,a=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(u||(u={}));var l={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},f=u.INFO,p=((s={})[u.DEBUG]="log",s[u.VERBOSE]="log",s[u.INFO]="info",s[u.WARN]="warn",s[u.ERROR]="error",s),d=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=p[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,h(["["+i+"]  "+t.name+":"],n))}},y=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=d,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,u.DEBUG],t)),this._logHandler.apply(this,h([this,u.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,u.VERBOSE],t)),this._logHandler.apply(this,h([this,u.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,u.INFO],t)),this._logHandler.apply(this,h([this,u.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,u.WARN],t)),this._logHandler.apply(this,h([this,u.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,u.ERROR],t)),this._logHandler.apply(this,h([this,u.ERROR],t))},t}();const v="ok",g="cancelled",m="unknown",w="invalid-argument",b="deadline-exceeded",E="not-found",I="already-exists",T="permission-denied",N="unauthenticated",_="resource-exhausted",A="failed-precondition",S="aborted",D="out-of-range",O="unimplemented",R="internal",L="unavailable",P="data-loss";class x extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}const k=new y("@firebase/firestore");function V(t,...e){if(k.logLevel<=u.DEBUG){const n=e.map(U);k.debug("Firestore (7.19.1): "+t,...n)}}function C(t,...e){if(k.logLevel<=u.ERROR){const n=e.map(U);k.error("Firestore (7.19.1): "+t,...n)}}function U(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function F(t="Unexpected state"){const e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw C(e),new Error(e)}function M(t,e){t||F()}function q(t,e){return t}function j(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class G{static t(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=j(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function B(t,e){return t<e?-1:t>e?1:0}function z(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}class H{constructor(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}class W{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get i(){return"(default)"===this.database}isEqual(t){return t instanceof W&&t.projectId===this.projectId&&t.database===this.database}o(t){return B(this.projectId,t.projectId)||B(this.database,t.database)}}class ${constructor(t){this.uid=t}u(){return null!=this.uid}h(){return this.u()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$.UNAUTHENTICATED=new $(null),$.l=new $("google-credentials-uid"),$._=new $("first-party-uid");class K{constructor(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}}class Y{constructor(t){this.p=null,this.currentUser=$.UNAUTHENTICATED,this.I=!1,this.A=0,this.T=null,this.forceRefresh=!1,this.p=(()=>{this.A++,this.currentUser=this.P(),this.I=!0,this.T&&this.T(this.currentUser)}),this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.p):(this.p(null),t.get().then(t=>{this.auth=t,this.p&&this.auth.addAuthTokenListener(this.p)},()=>{}))}getToken(){const t=this.A,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.A!==t?(V("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(M("string"==typeof e.accessToken),new K(e.accessToken,this.currentUser)):null):Promise.resolve(null)}R(){this.forceRefresh=!0}V(t){this.T=t,this.I&&t(this.currentUser)}g(){this.auth&&this.auth.removeAuthTokenListener(this.p),this.p=null,this.T=null}P(){const t=this.auth&&this.auth.getUid();return M(null===t||"string"==typeof t),new $(t)}}function Q(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new x(w,`Type does not match the expected instance. Did you pass '${e.name}' from a different Firestore SDK?`):new x(w,`Expected type '${e.name}', but was '${t.constructor.name}'`);return t}class X{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new x(w,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new x(w,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new x(w,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new x(w,"Timestamp seconds out of range: "+t)}static now(){return X.fromMillis(Date.now())}static fromDate(t){return X.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new X(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}v(t){return this.seconds===t.seconds?B(this.nanoseconds,t.nanoseconds):B(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Z{constructor(t){this.timestamp=t}static N(t){return new Z(t)}static min(){return new Z(new X(0,0))}o(t){return this.timestamp.v(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}$(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}F(){return this.timestamp}}class J{constructor(t,e,n){void 0===e?e=0:e>t.length&&F(),void 0===n?n=t.length-e:n>t.length-e&&F(),this.segments=t,this.offset=e,this.D=n}get length(){return this.D}isEqual(t){return 0===J.q(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof J?t.forEach(t=>{e.push(t)}):e.push(t),this.S(e)}limit(){return this.offset+this.length}O(t){return t=void 0===t?1:t,this.S(this.segments,this.offset+t,this.length-t)}C(){return this.S(this.segments,this.offset,this.length-1)}L(){return this.segments[this.offset]}U(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}M(){return 0===this.length}j(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}B(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}k(){return this.segments.slice(this.offset,this.limit())}static q(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class tt extends J{S(t,e,n){return new tt(t,e,n)}G(){return this.k().join("/")}toString(){return this.G()}static W(t){if(t.indexOf("//")>=0)throw new x(w,`Invalid path (${t}). Paths must not contain // in them.`);const e=t.split("/").filter(t=>t.length>0);return new tt(e)}static Y(){return new tt([])}}const et=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nt extends J{S(t,e,n){return new nt(t,e,n)}static H(t){return et.test(t)}G(){return this.k().map(t=>(t=t.replace("\\","\\\\").replace("`","\\`"),nt.H(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.G()}K(){return 1===this.length&&"__name__"===this.get(0)}static J(){return new nt(["__name__"])}static Z(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new x(w,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let o=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new x(w,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new x(w,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(o=!o,r++):"."!==e||o?(n+=e,r++):(i(),r++)}if(i(),o)throw new x(w,"Unterminated ` in path: "+t);return new nt(e)}static Y(){return new nt([])}}class rt{constructor(t){this.path=t}static X(t){return new rt(tt.W(t))}static tt(t){return new rt(tt.W(t).O(5))}nt(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===tt.q(this.path,t.path)}toString(){return this.path.toString()}static q(t,e){return tt.q(t.path,e.path)}static et(t){return t.length%2==0}static rt(t){return new rt(new tt(t.slice()))}}function it(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ot(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class st{constructor(t){this.st=t}static fromBase64String(t){const e=atob(t);return new st(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new st(e)}toBase64(){return t=this.st,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.st)}it(){return 2*this.st.length}o(t){return B(this.st,t.st)}isEqual(t){return this.st===t.st}}function ut(t){return null==t}function at(t){return-0===t&&1/t==-1/0}function ct(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ht(t){const e=gt(t.mapValue.fields.__local_write_time__.timestampValue);return new X(e.seconds,e.nanos)}st.ot=new st("");const lt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ft(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ct(t)?4:10:F()}function pt(t,e){const n=ft(t);if(n!==ft(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ht(t).isEqual(ht(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=gt(t.timestampValue),r=gt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return wt(t.bytesValue).isEqual(wt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return mt(t.geoPointValue.latitude)===mt(e.geoPointValue.latitude)&&mt(t.geoPointValue.longitude)===mt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return mt(t.integerValue)===mt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=mt(t.doubleValue),r=mt(e.doubleValue);return n===r?at(n)===at(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return z(t.arrayValue.values||[],e.arrayValue.values||[],pt);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(it(n)!==it(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!pt(n[t],r[t])))return!1;return!0}(t,e);default:return F()}}function dt(t,e){return void 0!==(t.values||[]).find(t=>pt(t,e))}function yt(t,e){const n=ft(t),r=ft(e);if(n!==r)return B(n,r);switch(n){case 0:return 0;case 1:return B(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=mt(t.integerValue||t.doubleValue),r=mt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return vt(t.timestampValue,e.timestampValue);case 4:return vt(ht(t),ht(e));case 5:return B(t.stringValue,e.stringValue);case 6:return function(t,e){const n=wt(t),r=wt(e);return n.o(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=B(n[t],r[t]);if(0!==e)return e}return B(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=B(mt(t.latitude),mt(e.latitude));return 0!==n?n:B(mt(t.longitude),mt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=yt(n[t],r[t]);if(e)return e}return B(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let t=0;t<r.length&&t<o.length;++t){const e=B(r[t],o[t]);if(0!==e)return e;const s=yt(n[r[t]],i[o[t]]);if(0!==s)return s}return B(r.length,o.length)}(t.mapValue,e.mapValue);default:throw F()}}function vt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return B(t,e);const n=gt(t),r=gt(e),i=B(n.seconds,r.seconds);return 0!==i?i:B(n.nanos,r.nanos)}function gt(t){if(M(!!t),"string"==typeof t){let e=0;const n=lt.exec(t);if(M(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(t.seconds),nanos:mt(t.nanos)}}function mt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function wt(t){return"string"==typeof t?st.fromBase64String(t):st.fromUint8Array(t)}function bt(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.G()}`}}function Et(t){return!!t&&"arrayValue"in t}function It(t){return!!t&&"nullValue"in t}function Tt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nt(t){return!!t&&"mapValue"in t}class _t{constructor(t,e=null,n=[],r=[],i=null,o=null,s=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null}}function At(t,e=null,n=[],r=[],i=null,o=null,s=null){return new _t(t,e,n,r,i,o,s)}class St{constructor(t,e=null,n=[],r=[],i=null,o="F",s=null,u=null){this.path=t,this.collectionGroup=e,this.ct=n,this.filters=r,this.limit=i,this.at=o,this.startAt=s,this.endAt=u,this.ht=null,this.lt=null,this.startAt,this.endAt}}function Dt(t){return!ut(t.limit)&&"L"===t.at}function Ot(t){return t.ct.length>0?t.ct[0].field:null}function Rt(t){for(const e of t.filters)if(e.ft())return e.field;return null}function Lt(t){return null!==t.collectionGroup}function Pt(t){const e=Q(t,St);if(null===e.ht){e.ht=[];const t=Rt(e),n=Ot(e);if(null!==t&&null===n)t.K()||e.ht.push(new Ht(t)),e.ht.push(new Ht(nt.J(),"asc"));else{let t=!1;for(const n of e.ct)e.ht.push(n),n.field.K()&&(t=!0);if(!t){const t=e.ct.length>0?e.ct[e.ct.length-1].dir:"asc";e.ht.push(new Ht(nt.J(),t))}}}return e.ht}function xt(t){const e=Q(t,St);if(!e.lt)if("F"===e.at)e.lt=At(e.path,e.collectionGroup,Pt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Pt(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Ht(n.field,e))}const n=e.endAt?new Bt(e.endAt.position,!e.endAt.before):null,r=e.startAt?new Bt(e.startAt.position,!e.startAt.before):null;e.lt=At(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.lt}class kt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){if(t.K())return"in"===e||"not-in"===e?this.dt(t,e,n):new Vt(t,e,n);if(It(n)){if("=="!==e&&"!="!==e)throw new x(w,"Invalid query. Null supports only equality comparisons.");return new kt(t,e,n)}if(Tt(n)){if("=="!==e&&"!="!==e)throw new x(w,"Invalid query. NaN supports only equality comparisons.");return new kt(t,e,n)}return"array-contains"===e?new Mt(t,n):"in"===e?new qt(t,n):"not-in"===e?new jt(t,n):"array-contains-any"===e?new Gt(t,n):new kt(t,e,n)}static dt(t,e,n){return"in"===e?new Ct(t,n):new Ut(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this._t(yt(e,this.value)):null!==e&&ft(this.value)===ft(e)&&this._t(yt(e,this.value))}_t(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return F()}}ft(){return["<","<=",">",">=","!="].indexOf(this.op)>=0}}class Vt extends kt{constructor(t,e,n){super(t,e,n),this.key=rt.tt(n.referenceValue)}matches(t){const e=rt.q(t.key,this.key);return this._t(e)}}class Ct extends kt{constructor(t,e){super(t,"in",e),this.keys=Ft("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Ut extends kt{constructor(t,e){super(t,"not-in",e),this.keys=Ft("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ft(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>rt.tt(t.referenceValue))}class Mt extends kt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Et(e)&&dt(e.arrayValue,this.value)}}class qt extends kt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&dt(this.value.arrayValue,e)}}class jt extends kt{constructor(t,e){super(t,"not-in",e)}matches(t){const e=t.field(this.field);return null!==e&&!dt(this.value.arrayValue,e)}}class Gt extends kt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Et(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>dt(this.value.arrayValue,t))}}class Bt{constructor(t,e){this.position=t,this.before=e}}function zt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!pt(t.position[n],e.position[n]))return!1;return!0}class Ht{constructor(t,e="asc"){this.field=t,this.dir=e}}function Wt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var $t,Kt;function Yt(t){if(void 0===t)return C("RPC_ERROR","HTTP error has no status"),m;switch(t){case 200:return v;case 400:return A;case 401:return N;case 403:return T;case 404:return E;case 409:return S;case 416:return D;case 429:return _;case 499:return g;case 500:return m;case 501:return O;case 503:return L;case 504:return b;default:return t>=200&&t<300?v:t>=400&&t<500?A:t>=500&&t<600?R:m}}(Kt=$t||($t={}))[Kt.OK=0]="OK",Kt[Kt.CANCELLED=1]="CANCELLED",Kt[Kt.UNKNOWN=2]="UNKNOWN",Kt[Kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kt[Kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kt[Kt.NOT_FOUND=5]="NOT_FOUND",Kt[Kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kt[Kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kt[Kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kt[Kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kt[Kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kt[Kt.ABORTED=10]="ABORTED",Kt[Kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kt[Kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kt[Kt.INTERNAL=13]="INTERNAL",Kt[Kt.UNAVAILABLE=14]="UNAVAILABLE",Kt[Kt.DATA_LOSS=15]="DATA_LOSS";const Qt={asc:"ASCENDING",desc:"DESCENDING"},Xt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Zt{constructor(t,e){this.s=t,this.wt=e}}function Jt(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!at(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:at(e)?"-0":e}}(t,e)}function te(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ee(t){return M(!!t),Z.N(function(t){const e=gt(t);return new X(e.seconds,e.nanos)}(t))}function ne(t,e){return function(t){return new tt(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).G()}function re(t,e){return ne(t.s,e.path)}function ie(t,e){const n=function(t){const e=tt.W(t);return M(fe(e)),e}(e);return M(n.get(1)===t.s.projectId),M(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new rt((M((r=n).length>4&&"documents"===r.get(4)),r.O(5)));var r}function oe(t,e){return ne(t.s,e)}function se(t){return new tt(["projects",t.s.projectId,"databases",t.s.database]).G()}function ue(t,e,n){return{name:re(t,e),fields:n.proto.mapValue.fields}}function ae(t,e){let n;if(e instanceof Ie)n={update:ue(t,e.key,e.value)};else if(e instanceof _e)n={delete:re(t,e.key)};else if(e instanceof Te)n={update:ue(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.G())),{fieldPaths:e}}(e.pt)};else if(e instanceof Ne)n={transform:{document:re(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof de)return{fieldPath:e.field.G(),setToServerValue:"REQUEST_TIME"};if(n instanceof ye)return{fieldPath:e.field.G(),appendMissingElements:{values:n.elements}};if(n instanceof ve)return{fieldPath:e.field.G(),removeAllFromArray:{values:n.elements}};if(n instanceof ge)return{fieldPath:e.field.G(),increment:n.yt};throw F()})(0,t))}};else{if(!(e instanceof Ae))return F();n={verify:re(t,e.key)}}return e.It.Et||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return te(t,e.F())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:F()}(t,e.It)),n}function ce(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=oe(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=oe(t,r.C()),n.structuredQuery.from=[{collectionId:r.U()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(Tt(t.value))return{unaryFilter:{field:le(t.field),op:"IS_NAN"}};if(It(t.value))return{unaryFilter:{field:le(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Tt(t.value))return{unaryFilter:{field:le(t.field),op:"IS_NOT_NAN"}};if(It(t.value))return{unaryFilter:{field:le(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:le(t.field),op:function(t){return Xt[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const o=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:le(t.field),direction:function(t){return Qt[t]}(t.dir)}})(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const s=function(t,e){return t.wt||ut(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=he(e.startAt)),e.endAt&&(n.structuredQuery.endAt=he(e.endAt)),n}function he(t){return{before:t.before,values:t.position}}function le(t){return{fieldPath:t.G()}}function fe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class pe{constructor(){this.At=void 0}}class de extends pe{}class ye extends pe{constructor(t){super(),this.elements=t}}class ve extends pe{constructor(t){super(),this.elements=t}}class ge extends pe{constructor(t,e){super(),this.serializer=t,this.yt=e}}class me{constructor(t){this.fields=t,t.sort(nt.q)}Tt(t){for(const e of this.fields)if(e.j(t))return!0;return!1}isEqual(t){return z(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class we{constructor(t,e){this.field=t,this.transform=e}}class be{constructor(t,e){this.updateTime=t,this.exists=e}static Pt(){return new be}static exists(t){return new be(void 0,t)}static updateTime(t){return new be(t)}get Et(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Ee{}class Ie extends Ee{constructor(t,e,n){super(),this.key=t,this.value=e,this.It=n,this.type=0}}class Te extends Ee{constructor(t,e,n,r){super(),this.key=t,this.data=e,this.pt=n,this.It=r,this.type=1}}class Ne extends Ee{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.It=be.exists(!0)}}class _e extends Ee{constructor(t,e){super(),this.key=t,this.It=e,this.type=3}}class Ae extends Ee{constructor(t,e){super(),this.key=t,this.It=e,this.type=4}}class Se{constructor(t){this.proto=t}static empty(){return new Se({mapValue:{}})}field(t){if(t.M())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Nt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null}}isEqual(t){return pt(this.proto,t.proto)}}class De{constructor(t=Se.empty()){this.Rt=t,this.Vt=new Map}set(t,e){return this.gt(t,e),this}delete(t){return this.gt(t,null),this}gt(t,e){let n=this.Vt;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===ft(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.U(),e)}bt(){const t=this.vt(nt.Y(),this.Vt);return null!=t?new Se(t):this.Rt}vt(t,e){let n=!1;const r=this.Rt.field(t),i=Nt(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const o=this.vt(t.child(r),e);null!=o&&(i[r]=o,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}class Oe{constructor(t,e){this.key=t,this.version=e}}class Re extends Oe{constructor(t,e,n,r){super(t,e),this.Nt=n,this.$t=!!r.$t,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.Nt.field(t)}data(){return this.Nt}Ft(){return this.Nt.proto}isEqual(t){return t instanceof Re&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.$t===t.$t&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Nt.isEqual(t.Nt)}toString(){return`Document(${this.key}, ${this.version}, ${this.Nt.toString()}, {hasLocalMutations: ${this.$t}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.$t||this.hasCommittedMutations}}class Le extends Oe{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Le&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Pe{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class xe{constructor(t,e,n=1e3,r=1.5,i=6e4){this.Dt=t,this.qt=e,this.xt=n,this.St=r,this.Ot=i,this.Ct=0,this.Lt=null,this.Ut=Date.now(),this.reset()}reset(){this.Ct=0}Mt(){this.Ct=this.Ot}jt(t){this.cancel();const e=Math.floor(this.Ct+this.Bt()),n=Math.max(0,Date.now()-this.Ut),r=Math.max(0,e-n);r>0&&V("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ct} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Lt=this.Dt.kt(this.qt,r,()=>(this.Ut=Date.now(),t())),this.Ct*=this.St,this.Ct<this.xt&&(this.Ct=this.xt),this.Ct>this.Ot&&(this.Ct=this.Ot)}Qt(){null!==this.Lt&&(this.Lt.Gt(),this.Lt=null)}cancel(){null!==this.Lt&&(this.Lt.cancel(),this.Lt=null)}Bt(){return(Math.random()-.5)*this.Ct}}function ke(){return"undefined"!=typeof document?document:null}class Ve{constructor(t,e,n,r,i){this.Wt=t,this.qt=e,this.Yt=n,this.op=r,this.zt=i,this.Ht=new Pe,this.then=this.Ht.promise.then.bind(this.Ht.promise),this.Ht.promise.catch(t=>{})}static Kt(t,e,n,r,i){const o=Date.now()+n,s=new Ve(t,e,o,r,i);return s.start(n),s}start(t){this.Jt=setTimeout(()=>this.Zt(),t)}Gt(){return this.Zt()}cancel(t){null!==this.Jt&&(this.clearTimeout(),this.Ht.reject(new x(g,"Operation cancelled"+(t?": "+t:""))))}Zt(){this.Wt.Xt(()=>null!==this.Jt?(this.clearTimeout(),this.op().then(t=>this.Ht.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.Jt&&(this.zt(this),clearTimeout(this.Jt),this.Jt=null)}}class Ce{constructor(){this.tn=Promise.resolve(),this.nn=[],this.en=!1,this.rn=[],this.sn=null,this.on=!1,this.un=[],this.cn=new xe(this,"async_queue_retry"),this.an=(()=>{const t=ke();t&&V("AsyncQueue","Visibility state changed to  ",t.visibilityState),this.cn.Qt()});const t=ke();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.an)}get hn(){return this.en}Xt(t){this.enqueue(t)}ln(t){this.fn(),this.dn(t)}_n(){if(!this.en){this.en=!0;const t=ke();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.an)}}enqueue(t){return this.fn(),this.en?new Promise(t=>{}):this.dn(t)}wn(t){this.nn.push(t),this.Xt(()=>this.mn())}async mn(){if(0!==this.nn.length){try{await this.nn[0](),this.nn.shift(),this.cn.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;V("AsyncQueue","Operation failed with retryable error: "+t)}this.nn.length>0&&this.cn.jt(()=>this.mn())}}dn(t){const e=this.tn.then(()=>(this.on=!0,t().catch(t=>{throw this.sn=t,this.on=!1,C("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.on=!1,t))));return this.tn=e,e}kt(t,e,n){this.fn(),this.un.indexOf(t)>-1&&(e=0);const r=Ve.Kt(this,t,e,n,t=>this.pn(t));return this.rn.push(r),r}fn(){this.sn&&F()}yn(){}async En(){let t;do{t=this.tn,await t}while(t!==this.tn)}In(t){for(const e of this.rn)if(e.qt===t)return!0;return!1}An(t){return this.En().then(()=>{this.rn.sort((t,e)=>t.Yt-e.Yt);for(const e of this.rn)if(e.Gt(),"all"!==t&&e.qt===t)break;return this.En()})}Tn(t){this.un.push(t)}pn(t){const e=this.rn.indexOf(t);this.rn.splice(e,1)}}class Ue extends class{}{constructor(t,e,n){super(),this.credentials=t,this.Pn=e,this.serializer=n,this.Rn=!1}Vn(){if(this.Rn)throw new x(A,"The client has already been terminated.")}gn(t,e,n){return this.Vn(),this.credentials.getToken().then(r=>this.Pn.gn(t,e,n,r)).catch(t=>{throw t.code===N&&this.credentials.R(),t})}bn(t,e,n){return this.Vn(),this.credentials.getToken().then(r=>this.Pn.bn(t,e,n,r)).catch(t=>{throw t.code===N&&this.credentials.R(),t})}terminate(){this.Rn=!1}}async function Fe(t,e){const n=q(t),r=se(n.serializer)+"/documents",i={writes:e.map(t=>ae(n.serializer,t))};await n.gn("Commit",r,i)}async function Me(t,e){const n=q(t),r=se(n.serializer)+"/documents",i={documents:e.map(t=>re(n.serializer,t))},o=await n.bn("BatchGetDocuments",r,i),s=new Map;o.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){M(!!e.found),e.found.name,e.found.updateTime;const n=ie(t,e.found.name),r=ee(e.found.updateTime),i=new Se({mapValue:{fields:e.found.fields}});return new Re(n,r,i,{})}(t,e):"missing"in e?function(t,e){M(!!e.missing),M(!!e.readTime);const n=ie(t,e.missing),r=ee(e.readTime);return new Le(n,r)}(t,e):F()}(n.serializer,t);s.set(e.key.toString(),e)});const u=[];return e.forEach(t=>{const e=s.get(t.toString());M(!!e),u.push(e)}),u}const qe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class je extends class{constructor(t){this.vn=t,this.s=t.s;const e=t.ssl?"https":"http";this.Nn=e+"://"+t.host,this.$n="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}gn(t,e,n,r){const i=this.Fn(t,e);V("RestConnection","Sending: ",i,n);const o={};return this.Dn(o,r),this.qn(t,i,o,n).then(t=>(V("RestConnection","Received: ",t),t),e=>{throw function(t,...e){if(k.logLevel<=u.WARN){const t=e.map(U);k.warn("Firestore (7.19.1): RestConnection",...t)}}(0,t+" failed with error: ",e,"url: ",i,"request:",n),e})}bn(t,e,n,r){return this.gn(t,e,n,r)}Dn(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(const n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])}Fn(t,e){const n=qe[t];return`${this.Nn}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.xn=e}Sn(t,e){throw new Error("Not supported by FetchConnection")}async qn(t,e,n,r){const i=JSON.stringify(r);let o;try{o=await this.xn(e,{method:"POST",headers:n,body:i})}catch(t){throw new x(Yt(t.status),"Request failed with error: "+t.statusText)}if(!o.ok)throw new x(Yt(o.status),"Request failed with error: "+o.statusText);return o.json()}}function Ge(t){return new Zt(t,!0)}const Be=new Map;function ze(t){var e,n;if(t.On)throw new x(A,"The client has already been terminated.");if(!Be.has(t)){V("ComponentProvider","Initializing Datastore");const r=t.Cn(),i=new H(t.Ln,t.Un,null!==(e=r.host)&&void 0!==e?e:"firestore.googleapis.com",null===(n=r.ssl)||void 0===n||n,!1),o=new je(i,fetch.bind(null)),s=Ge(i.s),u=function(t,e,n){return new Ue(t,o,s)}(t.Mn);Be.set(t,u)}return Be.get(t)}class He{constructor(t,e){this.app=t,this.Un="(lite)",this.jn=!1,this.INTERNAL={delete:()=>this._delete()},this.Ln=He.Bn(t),this.Mn=new Y(e)}get kn(){return this.jn}get On(){return void 0!==this.Qn}Gn(t){if(this.jn)throw new x(A,"Firestore has already been started and its settings can no longer be changed. initializeFirestore() cannot be called after calling getFirestore().");this.Wn=t}Cn(){return this.Wn||(this.Wn={}),this.jn=!0,this.Wn}static Bn(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new x(w,'"projectId" not provided in firebase.initializeApp.');return new W(t.options.projectId)}_delete(){return this.Qn||(this.Qn=this.Yn()),this.Qn}Yn(){return function(t){const e=Be.get(t);e&&(V("ComponentProvider","Removing Datastore"),Be.delete(t),e.terminate())}(this),Promise.resolve()}}function We(t,e,n){if(e.length!==n)throw new x(w,`Function ${t}() requires `+en(n,"argument")+", but was called with "+en(e.length,"argument")+".")}function $e(t,e,n){if(e.length<n)throw new x(w,`Function ${t}() requires at least `+en(n,"argument")+", but was called with "+en(e.length,"argument")+".")}function Ke(t,e,n,r){!function(t,e,n,r){let i=!1;if(!(i="object"===e?Xe(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){const i=Ze(r);throw new x(w,`Function ${t}() requires its ${n} to be of type ${e}, but it was: ${i}`)}}(t,e,tn(n)+" argument",r)}function Ye(t){if(!rt.et(t))throw new x(w,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qe(t){if(rt.et(t))throw new x(w,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Xe(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ze(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":F()}function Je(t,e,n){if(n<=0)throw new x(w,`Function ${t}() requires its ${tn(e)} argument to be a positive number, but it was: ${n}.`)}function tn(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function en(t,e){return`${t} ${e}`+(1===t?"":"s")}class nn{constructor(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new x(w,"Function FieldPath() requires its fieldNames argument to be an array with at least "+en(1,"element")+".")}(0,t);for(let e=0;e<t.length;++e)if(Ke("FieldPath","string",e,t[e]),0===t[e].length)throw new x(w,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.zn=new nt(t)}}class rn extends nn{constructor(...t){super(t)}static documentId(){return new rn(nt.J().G())}isEqual(t){if(!(t instanceof rn))throw function(t,e,n,r){const i=Ze(r);return new x(w,`Function isEqual() requires its ${tn(1)} argument to be a FieldPath, but it was: ${i}`)}(0,0,0,t);return this.zn.isEqual(t.zn)}}const on=new RegExp("[~\\*/\\[\\]]");class sn{constructor(){this.Hn=this}}class un extends sn{constructor(t){super(),this.Kn=t}Jn(t){if(2!==t.Zn)throw 1===t.Zn?t.Xn(this.Kn+"() can only appear at the top level of your update data"):t.Xn(this.Kn+"() cannot be used with set() unless you pass {merge:true}");return t.pt.push(t.path),null}isEqual(t){return t instanceof un}}function an(t,e,n){return new bn({Zn:3,te:e.settings.te,methodName:t.Kn,ne:n},e.s,e.serializer,e.ignoreUndefinedProperties)}class cn extends sn{constructor(t){super(),this.Kn=t}Jn(t){return new we(t.path,new de)}isEqual(t){return t instanceof cn}}class hn extends sn{constructor(t,e){super(),this.Kn=t,this.ee=e}Jn(t){const e=an(this,t,!0),n=this.ee.map(t=>An(t,e)),r=new ye(n);return new we(t.path,r)}isEqual(t){return this===t}}class ln extends sn{constructor(t,e){super(),this.Kn=t,this.ee=e}Jn(t){const e=an(this,t,!0),n=this.ee.map(t=>An(t,e)),r=new ve(n);return new we(t.path,r)}isEqual(t){return this===t}}class fn extends sn{constructor(t,e){super(),this.Kn=t,this.re=e}Jn(t){const e=new ge(t.serializer,Jt(t.serializer,this.re));return new we(t.path,e)}isEqual(t){return this===t}}class pn{constructor(t,e){if(We("GeoPoint",arguments,2),Ke("GeoPoint","number",1,t),Ke("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new x(w,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new x(w,"Longitude must be a number between -180 and 180, but was: "+e);this.se=t,this.ie=e}get latitude(){return this.se}get longitude(){return this.ie}isEqual(t){return this.se===t.se&&this.ie===t.ie}toJSON(){return{latitude:this.se,longitude:this.ie}}v(t){return B(this.se,t.se)||B(this.ie,t.ie)}}class dn{constructor(t){this.oe=t}static fromBase64String(t){try{return new dn(st.fromBase64String(t))}catch(t){throw new x(w,"Failed to construct Bytes from Base64 string: "+t)}}static fromUint8Array(t){return new dn(st.fromUint8Array(t))}toBase64(){return this.oe.toBase64()}toUint8Array(){return this.oe.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.oe.isEqual(t.oe)}}const yn=/^__.*__$/;class vn{constructor(t,e,n){this.Ln=t,this.ue=e,this.ce=n}}class gn{constructor(t,e,n){this.data=t,this.pt=e,this.fieldTransforms=n}ae(t,e){const n=[];return null!==this.pt?n.push(new Te(t,this.data,this.pt,e)):n.push(new Ie(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ne(t,this.fieldTransforms)),n}}class mn{constructor(t,e,n){this.data=t,this.pt=e,this.fieldTransforms=n}ae(t,e){const n=[new Te(t,this.data,this.pt,e)];return this.fieldTransforms.length>0&&n.push(new Ne(t,this.fieldTransforms)),n}}function wn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}class bn{constructor(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.he(),this.fieldTransforms=i||[],this.pt=o||[]}get path(){return this.settings.path}get Zn(){return this.settings.Zn}le(t){return new bn(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.pt)}fe(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.le({path:n,ne:!1});return r.de(t),r}_e(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.le({path:n,ne:!1});return r.he(),r}we(t){return this.le({path:void 0,ne:!0})}Xn(t){return Pn(t,this.settings.methodName,this.settings.me||!1,this.path,this.settings.te)}contains(t){return void 0!==this.pt.find(e=>t.j(e))||void 0!==this.fieldTransforms.find(e=>t.j(e.field))}he(){if(this.path)for(let t=0;t<this.path.length;t++)this.de(this.path.get(t))}de(t){if(0===t.length)throw this.Xn("Document fields must not be empty");if(wn(this.Zn)&&yn.test(t))throw this.Xn('Document fields cannot begin and end with "__"')}}class En{constructor(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ge(t)}pe(t,e,n,r=!1){return new bn({Zn:t,methodName:e,te:n,path:nt.Y(),ne:!1,me:r},this.s,this.serializer,this.ignoreUndefinedProperties)}}function In(t,e,n,r,i,o={}){const s=t.pe(o.merge||o.mergeFields?2:0,e,n,i);On("Data must be an object, but it was:",s,r);const u=Sn(r,s);let a,c;if(o.merge)a=new me(s.pt),c=s.fieldTransforms;else if(o.mergeFields){const t=[];for(const r of o.mergeFields){let i;if(r instanceof nn)i=r.zn;else{if("string"!=typeof r)throw F();i=Ln(e,r,n)}if(!s.contains(i))throw new x(w,`Field '${i}' is specified in your field mask but missing from your input data.`);xn(t,i)||t.push(i)}a=new me(t),c=s.fieldTransforms.filter(t=>a.Tt(t.field))}else a=null,c=s.fieldTransforms;return new gn(new Se(u),a,c)}function Tn(t,e,n,r){const i=t.pe(1,e,n);On("Data must be an object, but it was:",i,r);const o=[],s=new De;ot(r,(t,r)=>{const u=Ln(e,t,n),a=i._e(u);if(r instanceof sn&&r.Hn instanceof un)o.push(u);else{const t=An(r,a);null!=t&&(o.push(u),s.set(u,t))}});const u=new me(o);return new mn(s.bt(),u,i.fieldTransforms)}function Nn(t,e,n,r,i,o){const s=t.pe(1,e,n),u=[Rn(e,r,n)],a=[i];if(o.length%2!=0)throw new x(w,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<o.length;t+=2)u.push(Rn(e,o[t])),a.push(o[t+1]);const c=[],h=new De;for(let t=u.length-1;t>=0;--t)if(!xn(c,u[t])){const e=u[t],n=a[t],r=s._e(e);if(n instanceof sn&&n.Hn instanceof un)c.push(e);else{const t=An(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new me(c);return new mn(h.bt(),l,s.fieldTransforms)}function _n(t,e,n,r=!1){return An(n,t.pe(r?4:3,e))}function An(t,e){if(Dn(t))return On("Unsupported field value:",e,t),Sn(t,e);if(t instanceof sn)return function(t,e){if(!wn(e.Zn))throw e.Xn(t.Kn+"() can only be used with update() and set()");if(!e.path)throw e.Xn(t.Kn+"() is not currently supported inside arrays");const n=t.Jn(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.pt.push(e.path),t instanceof Array){if(e.settings.ne&&4!==e.Zn)throw e.Xn("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=An(i,e.we(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Jt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=X.fromDate(t);return{timestampValue:te(e.serializer,n)}}if(t instanceof X){const n=new X(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:te(e.serializer,n)}}if(t instanceof pn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof dn)return{bytesValue:function(t,e){return t.wt?e.toBase64():e.toUint8Array()}(e.serializer,t.oe)};if(t instanceof vn){const n=e.s,r=t.Ln;if(!r.isEqual(n))throw e.Xn(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ne(t.Ln||e.s,t.ue.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Xn("Unsupported field value: "+Ze(t))}(t,e)}function Sn(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.pt.push(e.path):ot(t,(t,r)=>{const i=An(r,e.fe(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Dn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof X||t instanceof pn||t instanceof dn||t instanceof vn||t instanceof sn)}function On(t,e,n){if(!Dn(n)||!Xe(n)){const r=Ze(n);throw"an object"===r?e.Xn(t+" a custom object"):e.Xn(t+" "+r)}}function Rn(t,e,n){if(e instanceof nn)return e.zn;if("string"==typeof e)return Ln(t,e);throw Pn("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ln(t,e,n){try{return function(t){if(t.search(on)>=0)throw new x(w,`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`);try{return new rn(...t.split("."))}catch(e){throw new x(w,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`)}}(e).zn}catch(e){throw Pn((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Pn(t,e,n,r,i){const o=r&&!r.M(),s=void 0!==i;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)");let a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new x(w,(u+=". ")+t+a)}function xn(t,e){return t.some(t=>t.isEqual(e))}class kn extends nn{constructor(...t){super(t)}isEqual(t){const e=Q(t,kn);return this.zn.isEqual(e.zn)}}class Vn{constructor(t,e,n,r,i){this.s=t,this.timestampsInSnapshots=e,this.ye=n,this.Ee=r,this.Ie=i}Ae(t){switch(ft(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mt(t.integerValue||t.doubleValue);case 3:return this.Te(t.timestampValue);case 4:return this.Pe(t);case 5:return t.stringValue;case 6:return this.Ie(wt(t.bytesValue));case 7:return this.Re(t.referenceValue);case 8:return this.Ve(t.geoPointValue);case 9:return this.ge(t.arrayValue);case 10:return this.be(t.mapValue);default:throw F()}}be(t){const e={};return ot(t.fields||{},(t,n)=>{e[t]=this.Ae(n)}),e}Ve(t){return new pn(mt(t.latitude),mt(t.longitude))}ge(t){return(t.values||[]).map(t=>this.Ae(t))}Pe(t){switch(this.ye){case"previous":const e=function t(e){const n=e.mapValue.fields.__previous_value__;return ct(n)?t(n):n}(t);return null==e?null:this.Ae(e);case"estimate":return this.Te(ht(t));default:return null}}Te(t){const e=gt(t),n=new X(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()}Re(t){const e=tt.W(t);M(fe(e));const n=new W(e.get(1),e.get(3)),r=new rt(e.O(5));return n.isEqual(this.s)||C(`Document ${r} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${this.s.projectId}/${this.s.database}) instead.`),this.Ee(r)}}class Cn{constructor(t,e,n,r){this.ve=t,this.ue=e,this.Ne=n,this.ce=r}get id(){return this.ue.path.U()}get ref(){return new Wn(this.ve,this.ce,this.ue.path)}exists(){return null!==this.Ne}data(){if(this.Ne){if(this.ce){const t=new Un(this.ve,this.ue,this.Ne,null);return this.ce.fromFirestore(t)}return new Vn(this.ve.Ln,!0,"none",t=>new Wn(this.ve,null,t.path),t=>new dn(t)).Ae(this.Ne.Ft())}}get(t){if(this.Ne){const e=this.Ne.data().field(Mn("DocumentSnapshot.get",t));if(null!==e)return new Vn(this.ve.Ln,!0,"none",t=>new Wn(this.ve,this.ce,t.path),t=>new dn(t)).Ae(e)}}}class Un extends Cn{data(){return super.data()}}class Fn{constructor(t,e){this.query=t,this.$e=e}get docs(){return[...this.$e]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.$e.forEach(t,e)}}function Mn(t,e){return"string"==typeof e?Ln(t,e):Q(e,kn).zn}class qn{constructor(t){this.Fe=t,this.De=new Map,this.mutations=[],this.qe=!1,this.xe=null,this.Se=new Set}async Oe(t){if(this.Ce(),this.mutations.length>0)throw new x(w,"Firestore transactions require all reads to be executed before all writes.");const e=await Me(this.Fe,t);return e.forEach(t=>{t instanceof Le||t instanceof Re?this.Le(t):F()}),e}set(t,e){this.write(e.ae(t,this.It(t))),this.Se.add(t.toString())}update(t,e){try{this.write(e.ae(t,this.Ue(t)))}catch(t){this.xe=t}this.Se.add(t.toString())}delete(t){this.write([new _e(t,this.It(t))]),this.Se.add(t.toString())}async commit(){if(this.Ce(),this.xe)throw this.xe;const t=this.De;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=rt.X(e);this.mutations.push(new Ae(n,this.It(n)))}),await Fe(this.Fe,this.mutations),this.qe=!0}Le(t){let e;if(t instanceof Re)e=t.version;else{if(!(t instanceof Le))throw F();e=Z.min()}const n=this.De.get(t.key.toString());if(n){if(!e.isEqual(n))throw new x(S,"Document version changed between two reads.")}else this.De.set(t.key.toString(),e)}It(t){const e=this.De.get(t.toString());return!this.Se.has(t.toString())&&e?be.updateTime(e):be.Pt()}Ue(t){const e=this.De.get(t.toString());if(!this.Se.has(t.toString())&&e){if(e.isEqual(Z.min()))throw new x(w,"Can't update a document that doesn't exist.");return be.updateTime(e)}return be.exists(!0)}write(t){this.Ce(),this.mutations=this.mutations.concat(t)}Ce(){}}class jn{constructor(t,e,n,r){this.Wt=t,this.Fe=e,this.updateFunction=n,this.Ht=r,this.Me=5,this.cn=new xe(this.Wt,"transaction_retry")}run(){this.je()}je(){this.cn.jt(async()=>{const t=new qn(this.Fe),e=this.Be(t);e&&e.then(e=>{this.Wt.Xt(()=>t.commit().then(()=>{this.Ht.resolve(e)}).catch(t=>{this.ke(t)}))}).catch(t=>{this.ke(t)})})}Be(t){try{const e=this.updateFunction(t);return!ut(e)&&e.catch&&e.then?e:(this.Ht.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ht.reject(t),null}}ke(t){this.Me>0&&this.Qe(t)?(this.Me-=1,this.Wt.Xt(()=>(this.je(),Promise.resolve()))):this.Ht.reject(t)}Qe(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case v:return F();case g:case m:case b:case _:case R:case L:case N:return!1;case w:case E:case I:case T:case A:case S:case D:case O:case P:return!0;default:return F()}}()}return!1}}function Gn(t,e,n){if("string"==typeof n){if(""===n)throw new x(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lt(e)&&-1!==n.indexOf("/"))throw new x(w,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(tt.W(n));if(!rt.et(r))throw new x(w,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bt(t,new rt(r))}if(n instanceof vn)return bt(t,n.ue);throw new x(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ze(n)+".")}function Bn(t,e){if(!Array.isArray(t)||0===t.length)throw new x(w,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new x(w,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`);if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new x(w,`Invalid Query. '${e.toString()}' filters cannot contain 'null' in the value array.`);if(t.filter(t=>Number.isNaN(t)).length>0)throw new x(w,`Invalid Query. '${e.toString()}' filters cannot contain 'NaN' in the value array.`)}}function zn(t,e,n){if(!n.isEqual(e))throw new x(w,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function Hn(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Wn extends vn{constructor(t,e,n){super(t.Ln,new rt(n),e),this.firestore=t,this.converter=e,this.Ge=n,this.type="document"}get id(){return this.Ge.U()}get path(){return this.Ge.G()}get parent(){return new er(this.firestore,this.ce,this.ue.path.C())}collection(t){or("DocumentReference.collection","path",t);const e=tt.W(this.path).child(tt.W(t));return Qe(e),new er(this.firestore,null,e)}withConverter(t){return new Wn(this.firestore,t,this.Ge)}}class $n{constructor(t,e,n){this.firestore=t,this.converter=e,this.We=n,this.type="query"}withConverter(t){return new $n(this.firestore,t,this.We)}}class Kn{}class Yn extends Kn{constructor(t,e,n){super(),this.Ye=t,this.ze=e,this.He=n,this.type="where"}apply(t){const e=ir(t.firestore),n=function(t,e,n,r,i,o,s){let u;if(i.K()){if("array-contains"===o||"array-contains-any"===o)throw new x(w,`Invalid Query. You can't perform '${o}' queries on FieldPath.documentId().`);if("in"===o||"not-in"===o){Bn(s,o);const e=[];for(const n of s)e.push(Gn(r,t,n));u={arrayValue:{values:e}}}else u=Gn(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Bn(s,o),u=_n(n,e,s,"in"===o||"not-in"===o);const a=kt.create(i,o,u);return function(t,e){if(e.ft()){const n=Rt(t);if(null!==n&&!n.isEqual(e.field))throw new x(w,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=Ot(t);null!==r&&zn(0,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new x(w,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(w,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,a),a}(t.We,"where",e,t.firestore.Ln,this.Ye,this.ze,this.He);return new $n(t.firestore,t.converter,function(t,e){const n=t.filters.concat([e]);return new St(t.path,t.collectionGroup,t.ct.slice(),n,t.limit,t.at,t.startAt,t.endAt)}(t.We,n))}}class Qn extends Kn{constructor(t,e){super(),this.Ye=t,this.Ke=e,this.type="orderBy"}apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new x(w,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new x(w,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ht(e,n);return function(t,e){if(null===Ot(t)){const n=Rt(t);null!==n&&zn(0,n,e.field)}}(t,r),r}(t.We,this.Ye,this.Ke);return new $n(t.firestore,t.converter,function(t,e){const n=t.ct.concat([e]);return new St(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.at,t.startAt,t.endAt)}(t.We,e))}}class Xn extends Kn{constructor(t,e,n){super(),this.type=t,this.Je=e,this.Ze=n}apply(t){return new $n(t.firestore,t.converter,function(t,e,n){return new St(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.We,this.Je,this.Ze))}}class Zn extends Kn{constructor(t,e,n){super(),this.type=t,this.Xe=e,this.tr=n}apply(t){const e=tr(t,this.type,this.Xe,this.tr);return new $n(t.firestore,t.converter,function(t,e){return new St(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.at,e,t.endAt)}(t.We,e))}}class Jn extends Kn{constructor(t,e,n){super(),this.type=t,this.Xe=e,this.tr=n}apply(t){const e=tr(t,this.type,this.Xe,this.tr);return new $n(t.firestore,t.converter,function(t,e){return new St(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.at,t.startAt,e)}(t.We,e))}}function tr(t,e,n,r){if(n[0]instanceof Cn)return We(e,n,1),function(t,e,n,r,i){if(!r)throw new x(E,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const o=[];for(const n of Pt(t))if(n.field.K())o.push(bt(e,r.key));else{const t=r.field(n.field);if(ct(t))throw new x(w,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.G();throw new x(w,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}o.push(t)}return new Bt(o,i)}(t.We,t.firestore.Ln,e,n[0].Ne,r);{const i=ir(t.firestore);return function(t,e,n,r,i,o){const s=t.ct;if(i.length>s.length)throw new x(w,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const u=[];for(let o=0;o<i.length;o++){const a=i[o];if(s[o].field.K()){if("string"!=typeof a)throw new x(w,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof a}`);if(!Lt(t)&&-1!==a.indexOf("/"))throw new x(w,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${a}' contains a slash.`);const n=t.path.child(tt.W(a));if(!rt.et(n))throw new x(w,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new rt(n);u.push(bt(e,i))}else{const t=_n(n,r,a);u.push(t)}}return new Bt(u,o)}(t.We,t.firestore.Ln,i,e,n,r)}}class er extends $n{constructor(t,e,n){super(t,e,new St(n)),this.firestore=t,this.Ge=n,this.type="collection"}get id(){return this.We.path.U()}get path(){return this.We.path.G()}get parent(){const t=this.Ge.C();return t.M()?null:new Wn(this.firestore,null,t)}doc(t){0===arguments.length&&(t=G.t()),or("CollectionReference.doc","path",t);const e=this.Ge.child(tt.W(t));return Ye(e),new Wn(this.firestore,this.converter,e)}withConverter(t){return new er(this.firestore,t,this.Ge)}}function nr(t,e){if(1===arguments.length&&(e=G.t()),or("doc","path",e),t instanceof He){const n=tt.W(e);return Ye(n),new Wn(t,null,n)}{if(!(t instanceof Wn||t instanceof er))throw new x(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t.Ge.child(tt.W(e));return Ye(n),new Wn(t.firestore,t instanceof er?t.converter:null,n)}}function rr(t,e){return t instanceof $n&&e instanceof $n&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Wt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!pt(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zt(t.startAt,e.startAt)&&zt(t.endAt,e.endAt)}(xt(t),xt(e))&&t.at===e.at}(t.We,e.We)&&t.converter===e.converter}function ir(t){const e=t.Cn(),n=Ge(t.Ln);return new En(t.Ln,!!e.ignoreUndefinedProperties,n)}function or(t,e,n){if(!n)throw new x(w,`Function ${t}() cannot be called with an empty ${e}.`)}class sr extends sn{}class ur extends sr{constructor(t){super(),this.Hn=t,this.Kn=t.Kn}Jn(t){return this.Hn.Jn(t)}isEqual(t){return t instanceof ur&&this.Hn.isEqual(t.Hn)}}class ar{constructor(t,e){this.ve=t,this.nr=e,this.er=[],this.rr=!1,this.sr=ir(t)}set(t,e,n){this.ir();const r=cr(t,this.ve),i=Hn(r.ce,e,n),o=In(this.sr,"WriteBatch.set",r.ue,i,null!==r.ce,n);return this.er=this.er.concat(o.ae(r.ue,be.Pt())),this}update(t,e,n,...r){this.ir();const i=cr(t,this.ve);let o;return o="string"==typeof e||e instanceof kn?Nn(this.sr,"WriteBatch.update",i.ue,e,n,r):Tn(this.sr,"WriteBatch.update",i.ue,e),this.er=this.er.concat(o.ae(i.ue,be.exists(!0))),this}delete(t){this.ir();const e=cr(t,this.ve);return this.er=this.er.concat(new _e(e.ue,be.Pt())),this}commit(){return this.ir(),this.rr=!0,this.er.length>0?this.nr(this.er):Promise.resolve()}ir(){if(this.rr)throw new x(A,"A write batch can no longer be used after commit() has been called.")}}function cr(t,e){if(t.firestore!==e)throw new x(w,"Provided document reference is from a different Firestore instance.");return Q(t,Wn)}class hr{constructor(t,e){this.ve=t,this.or=e,this.sr=ir(t)}get(t){const e=cr(t,this.ve);return this.or.Oe([e.ue]).then(t=>{if(!t||1!==t.length)return F();const n=t[0];if(n instanceof Le)return new Cn(this.ve,e.ue,null,e.ce);if(n instanceof Re)return new Cn(this.ve,n.key,n,e.ce);throw F()})}set(t,e,n){const r=cr(t,this.ve),i=Hn(r.ce,e,n),o=In(this.sr,"Transaction.set",r.ue,i,null!==r.ce,n);return this.or.set(r.ue,o),this}update(t,e,n,...r){const i=cr(t,this.ve);let o;return o="string"==typeof e||e instanceof kn?Nn(this.sr,"Transaction.update",i.ue,e,n,r):Tn(this.sr,"Transaction.update",i.ue,e),this.or.update(i.ue,o),this}delete(t){const e=cr(t,this.ve);return this.or.delete(e.ue),this}}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new He(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.800","node"),t.Bytes=dn,t.CollectionReference=er,t.DocumentReference=Wn,t.DocumentSnapshot=Cn,t.FieldPath=kn,t.FieldValue=sr,t.FirebaseFirestore=He,t.GeoPoint=pn,t.Query=$n,t.QueryConstraint=Kn,t.QueryDocumentSnapshot=Un,t.QuerySnapshot=Fn,t.Timestamp=X,t.Transaction=hr,t.WriteBatch=ar,t.addDoc=function(t,e){const n=Q(t,er),r=nr(n),i=Hn(n.converter,e),o=In(ir(n.firestore),"addDoc",r.ue,i,null!==r.ce,{});return Fe(ze(n.firestore),o.ae(r.ue,be.exists(!1))).then(()=>r)},t.arrayRemove=function(...t){return $e("arrayRemove()",arguments,1),new ur(new ln("arrayRemove",t))},t.arrayUnion=function(...t){return $e("arrayUnion()",arguments,1),new ur(new hn("arrayUnion",t))},t.collection=function(t,e){if(or("collection","path",e),t instanceof He){const n=tt.W(e);return Qe(n),new er(t,null,n)}{if(!(t instanceof Wn||t instanceof er))throw new x(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=tt.W(t.path).child(tt.W(e));return Qe(n),new er(t.firestore,null,n)}},t.collectionGroup=function(t,e){const n=Q(t,He);if(or("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new x(w,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $n(n,null,function(t){return new St(tt.Y(),t)}(e))},t.deleteDoc=function(t){const e=Q(t,Wn);return Fe(ze(e.firestore),[new _e(e.ue,be.Pt())])},t.deleteField=function(){return new ur(new un("deleteField"))},t.doc=nr,t.documentId=function(){return new kn("__name__")},t.endAt=function(...t){return new Jn("endAt",t,!1)},t.endBefore=function(...t){return new Jn("endBefore",t,!0)},t.getDoc=function(t){const e=Q(t,Wn);return Me(ze(e.firestore),[e.ue]).then(t=>{M(1===t.length);const n=t[0];return new Cn(e.firestore,e.ue,n instanceof Re?n:null,e.ce)})},t.getDocs=function(t){const e=Q(t,$n);return function(t){if(Dt(t)&&0===t.ct.length)throw new x(O,"limitToLast() queries require specifying at least one orderBy() clause")}(e.We),async function(t,e){const n=q(t),r=ce(n.serializer,xt(e));return(await n.bn("RunQuery",r.parent,{structuredQuery:r.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const r=ie(t,e.name),i=ee(e.updateTime),o=new Se({mapValue:{fields:e.fields}});return new Re(r,i,o,{hasCommittedMutations:!1})})(n.serializer,t.document))}(ze(e.firestore),e.We).then(n=>{const r=n.map(t=>new Un(e.firestore,t.key,t,e.converter));return Dt(e.We)&&r.reverse(),new Fn(t,r)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new ur(new fn("increment",t))},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore/lite").getImmediate();return r.Gn(n),r},t.limit=function(t){return Je("limit",1,t),new Xn("limit",t,"F")},t.limitToLast=function(t){return Je("limitToLast",1,t),new Xn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,r=Mn("orderBy",t);return new Qn(r,n)},t.query=function(t,...e){let n=Q(t,$n);for(const t of e)n=t.apply(n);return n},t.queryEqual=rr,t.refEqual=function(t,e){return(t instanceof Wn||t instanceof er)&&(e instanceof Wn||e instanceof er)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter},t.runTransaction=function(t,e){const n=Q(t,He),r=ze(n),i=new Pe;return new jn(new Ce,r,t=>e(new hr(n,t)),i).run(),i.promise},t.serverTimestamp=function(){return new ur(new cn("serverTimestamp"))},t.setDoc=function(t,e,n){const r=Q(t,Wn),i=Hn(r.ce,e,n),o=In(ir(r.firestore),"setDoc",r.ue,i,null!==r.ce,n);return Fe(ze(r.firestore),o.ae(r.ue,be.Pt()))},t.setLogLevel=function(t){k.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof Cn&&n instanceof Cn?e.ve===n.ve&&e.ue.isEqual(n.ue)&&(null===e.Ne?null===n.Ne:e.Ne.isEqual(n.Ne))&&e.ce===n.ce:e instanceof Fn&&n instanceof Fn&&rr(e.query,n.query)&&z(e.docs,n.docs,t)},t.startAfter=function(...t){return new Zn("startAfter",t,!1)},t.startAt=function(...t){return new Zn("startAt",t,!0)},t.terminate=function(t){return e._removeServiceInstance(t.app,"firestore/lite"),Q(t,He)._delete()},t.updateDoc=function(t,e,n,...r){const i=Q(t,Wn),o=ir(i.firestore);let s;return s="string"==typeof e||e instanceof kn?Nn(o,"updateDoc",i.ue,e,n,r):Tn(o,"updateDoc",i.ue,e),Fe(ze(i.firestore),s.ae(i.ue,be.exists(!0)))},t.where=function(t,e,n){const r=e,i=Mn("where",t);return new Yn(i,r,n)},t.writeBatch=function(t){const e=Q(t,He),n=ze(e);return new ar(e,t=>Fe(n,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}});