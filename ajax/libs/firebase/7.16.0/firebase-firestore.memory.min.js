!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Xl){"use strict";try{(function(){Xl=Xl&&Object.prototype.hasOwnProperty.call(Xl,"default")?Xl.default:Xl;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function f(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function d(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,g=(n(m,l=Error),m);function m(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new g(o,a),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N||self;function S(){}function R(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function L(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),O=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:U).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++O))},j.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=_.navigator;if(Y){var Z=Y.userAgent;if(Z){H=Z;break t}}H=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function K(t){var e={};for(var n in t)e[n]=t[n];return e}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<$.length;o++)n=$[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=Q(H,"Opera"),ot=Q(H,"Trident")||Q(H,"MSIE"),st=Q(H,"Edge"),ut=st||ot,at=Q(H,"Gecko")&&!(Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge"))&&!(Q(H,"Trident")||Q(H,"MSIE"))&&!Q(H,"Edge"),ht=Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge");function ct(){var t=_.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt={};function yt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var vt=_.document&&ot&&(ct()||parseInt(nt,10))||void 0,gt=!ot||9<=Number(vt),mt=ot&&!yt("9"),wt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},x(Et,bt);var It={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++Nt,this.V=this.X=!1}function _t(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=q(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new Tt(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=qt(r),e&&e[At]?e.sa(n,r,D(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=qt(n),t&&t[At]?t.ra(e,n,D(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!gt)return null;var u,a,h=xt(t);if(h||(t[Dt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=gt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[At]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):_t(t)))}function Vt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ut(t),n.call(r,e)}function Mt(t,e){if(t.V)return!0;if(gt)return Ct(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new Et(e,this))}function xt(t){return(t=t[Dt])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==R(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Ft(){j.call(this),this.c=new St(this),(this.J=this).A=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(Ft,j),Ft.prototype[At]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=qt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Lt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new bt(t,n):t instanceof bt?t.target=t.target||n:(s=t,tt(t=new bt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},A.C=function(){if(Ft.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.A=null},A.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=_.JSON.stringify;function zt(){this.b=this.a=null}var Ht,Wt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Xt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Yt(t){_.setTimeout(function(){throw t},0)}function Zt(t,e){var n;Ht||(n=_.Promise.resolve(void 0),Ht=function(){n.then($t)}),Jt||(Ht(),Jt=!0),Kt.add(t,e)}zt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new zt;function $t(){for(var t,e,n;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Yt(t)}var r=Wt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function te(t,e){Ft.call(this),this.b=t||1,this.a=e||_,this.f=V(this.Ua,this),this.g=M()}function ee(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ne(t,e,n){if("function"==R(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function re(t,e,n){j.call(this),this.f=null!=n?V(t,n):t,this.c=e,this.b=V(this.Pa,this),this.a=[]}function ie(t){t.T=ne(t.b,t.c),t.f.apply(null,t.a)}function oe(t){j.call(this),this.b=t,this.a={}}x(te,Ft),(A=te.prototype).Z=!1,A.L=null,A.Ua=function(){var t;this.Z&&(0<(t=M()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ee(this),this.start())))},A.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=M())},A.C=function(){te.M.C.call(this),ee(this),delete this.a},x(re,j),(A=re.prototype).ba=!1,A.T=null,A.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ie(this)},A.C=function(){re.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},A.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ie(this))},x(oe,j);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function he(){}oe.prototype.C=function(){oe.M.C.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=null;function le(){return ce=ce||new Ft}function fe(t){bt.call(this,"serverreachability",t)}function pe(){var t=le();t.dispatchEvent(new fe(t))}function de(t){bt.call(this,"statevent",t)}function ye(){var t=le();t.dispatchEvent(new de(t))}function ve(t){bt.call(this,"timingevent",t)}function ge(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}x(fe,bt),x(de,bt),x(ve,bt);var me={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},we={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function be(){}function Ee(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}be.prototype.a=null;var Ae,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Te(){bt.call(this,"d")}function _e(){bt.call(this,"c")}function Se(){}function Re(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new oe(this),this.N=Le,t=ut?125:void 0,this.O=new te(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(Te,bt),x(_e,bt),x(Se,be),Ae=new Se;var Le=45e3,De={},Pe={};function Oe(t,e,n){t.B=1,t.f=$e(Qe(e)),t.j=n,t.F=!0,ke(t,null)}function ke(t,e){t.s=M(),Ve(t),t.A=Qe(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),pn(n.b,"t",r),t.w=0,t.a=ir(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(V(t.ya,t,t.a),t.J)),ue(t.G,t.a,"readystatechange",t.Sa),e=t.m?K(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),pe()}function Ue(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Pe:(o=Number(i.substring(o,s)),isNaN(o)?De:(s+=1)+o>i.length?Pe:(i=i.substr(s,o),r.w=s+o,i)));if(a==Pe){4==e&&(t.c=4,ye(),u=!1);break}if(a==De){t.c=4,ye(),u=!1;break}qe(t,a)}4==e&&0==n.length&&(t.c=1,ye(),u=!1),t.b=t.b&&u,u||(je(t),xe(t))}function Ve(t){t.P=M()+t.N,Ce(t,t.N)}function Ce(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=ge(V(t.Qa,t),e)}function Me(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function xe(t){0==t.g.u||t.l||$n(t.g,t)}function je(t){Me(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ee(t.O),ae(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function qe(t,e){try{var n,r,i,o,s,u,a,h,c,l,f=t.g;if(0!=f.u&&(f.a==t||bn(f.b,t)))if(f.A=t.H,!t.o&&bn(f.b,t)&&3==f.u){try{var p=f.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!f.i){if(f.a){if(!(f.a.s+3e3<t.s))break t;Kn(f),f.a.cancel(),f.a=null}Jn(f),ye()}}else f.ia=d[1],0<f.ia-f.G&&d[2]<37500&&f.U&&0==f.m&&!f.l&&(f.l=ge(V(f.Na,f),6e3));if(wn(f.b)<=1&&f.O){try{f.O()}catch(t){}f.O=void 0}}else er(f,11)}else if(!t.o&&f.a!=t||Kn(f),!z(e))for(e=p=f.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],f.G=d[0],d=d[1],2==f.u?"c"==d[0]?(f.B=d[1],f.R=d[2],null!=(n=d[3])&&(f.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(f.D=1.5*r),i=f,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(Q(s,"spdy")||Q(s,"quic")||Q(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(En(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,Ke(i.v,i.s,a))),f.u=3,f.c&&f.c.na(),h=t,(i=f).ea=rr(i,i.w?i.R:null,i.P),h.o?(In(i.b,h),c=h,(l=i.D)&&c.setTimeout(l),c.h&&(Me(c),Ve(c)),i.a=h):Zn(i),0<f.f.length&&Wn(f)):"stop"!=d[0]&&"close"!=d[0]||er(f,7):3==f.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?er(f,7):Bn(f):"noop"!=d[0]&&f.c&&f.c.ma(d),f.m=0)}pe()}catch(t){}}function Fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)F(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Re.prototype).setTimeout=function(t){this.N=t},A.Sa=function(t){t=t.target;var e=this.D;e&&3==jn(t)?e.Ia():this.ya(t)},A.ya=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||pe(),Me(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ye(),je(this),xe(this);break t}this.o=!0,qe(this,u)}this.F?(Ue(this,e,i),ut&&this.b&&3==e&&(ue(this.G,this.O,"tick",this.Ra),this.O.start())):qe(this,i),4==e&&je(this),this.b&&!this.l&&(4==e?$n(this.g,this):(this.b=!1,Ve(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ye(),je(this),xe(this)}}}catch(t){}},A.Ra=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.Y(),this.w<e.length&&(Me(this),Ue(this,t,e),this.b&&4!=t&&Ve(this)))},A.cancel=function(){this.l=!0,je(this)},A.Qa=function(){this.h=null;var t=M();0<=t-this.P?(2!=this.B&&(pe(),ye()),je(this),this.c=2,xe(this)):Ce(this,this.P-t)},(A=Ge.prototype).I=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.K=function(){return Be(this),this.a.concat()},A.get=function(t,e){return ze(this.b,t)?this.b[t]:e},A.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ye(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=tn(n[2]||""),Ye(this,n[3]||"",!0),Ze(this,n[4]),this.g=tn(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=tn(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Qe(t){return new We(t)}function Xe(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?tn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,un)),t.b=new hn(e,t.a))}function Ke(t,e,n){t.b.set(e,n)}function $e(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",en(n,an)),t.join("")};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,un=/[#\?@]/g,an=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){cn(t),e=dn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function fn(t,e){return cn(t),e=dn(t,e),ze(t.a.b,e)}function pn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),B(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},A.K=function(){cn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.I=function(t){cn(this);var e=[];if("string"==typeof t)fn(this,t)&&(e=G(e,this.a.get(dn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return cn(this),this.c=null,fn(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=10;function mn(t){return t.b||t.a&&t.a.size>=t.f}function wn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Tn(){this.a=new Nn}function _n(t,r,e){var i=e||"";try{Fe(t,function(t,e){var n=t;D(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Rn=_.JSON.parse;function Ln(t){Ft.call(this),this.headers=new Ge,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Dn,this.B=this.F=!1}x(Ln,Ft);var Dn="",Pn=/^https?$/i,On=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Mn(t)}function Vn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=jn(t)||2!=t.S()))if(t.l&&4==jn(t))ne(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(He)[1]||null)&&_.self&&_.self.location&&(i=(r=_.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Vn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ke(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Fn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Fn("baseRetryDelayMs",5e3,t),this.Ga=Fn("retryDelaySeedMs",1e4,t),this.Da=Fn("forwardChannelMaxRetries",2,t),this.ga=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new vn(t&&t.concurrentRequestLimit),this.ja=new Tn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Bn(t){var e,n;zn(t),3==t.u&&(e=t.H++,Ke(n=Qe(t.v),"SID",t.B),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),Xn(t,n),(e=new Re(t,e,void 0)).B=2,e.f=$e(Qe(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ir(e.g,null),e.a.$(e.f)),e.s=M(),Ve(e)),nr(t)}function zn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),Kn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function Hn(t,e){t.f.push(new yn(t.Fa++,e)),3==t.u&&Wn(t)}function Wn(t){mn(t.b)||t.g||(t.g=!0,Zt(t.xa,t),t.o=0)}function Qn(t,e){var n=e?e.W:t.H++,r=Qe(t.v);Ke(r,"SID",t.B),Ke(r,"RID",n),Ke(r,"AID",t.G),Xn(t,r),t.h&&t.j&&qn(r,t.h,t.j),n=new Re(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),En(t.b,n),Oe(n,r,e)}function Xn(t,n){t.c&&Fe({},function(t,e){Ke(n,e,t)})}function Yn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?V(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{_n(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Zn(t){t.a||t.i||(t.J=1,Zt(t.wa,t),t.m=0)}function Jn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=ge(V(t.wa,t),tr(t,t.m)),t.m++,1)}function Kn(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function $n(t,e){var n,r=null;if(t.a==e){Kn(t),t.a=null;var i=2}else{if(!bn(t.b,e))return;r=e.i,In(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.s,n=t.o,(i=le()).dispatchEvent(new ve(i)),Wn(t)):Zn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(wn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=ge(V(t.xa,t,e),tr(t,t.o)),t.o++,1}}(t,e)||2==i&&Jn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function er(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=V(t.Ta,t),n||(n=new We("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Xe(n,"https"),$e(n)),i=n.toString(),o=r,u=new he,_.Image?((s=new Image).onload=C(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=C(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=C(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=C(Sn,u,s,"TestLoadImage: timeout",!1,o),_.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ye(),t.u=0,t.c&&t.c.la(e),nr(t),zn(t)}function nr(t){t.u=0,t.A=-1,t.c&&(0==An(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.ka())}function rr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof We?Qe(r):new We(r,void 0);return""!=c.c?(e&&Ye(c,e+"."+c.c),Ze(c,c.h)):(o=(i=_.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new We(null,void 0),o&&Xe(h,o),s&&Ye(h,s),u&&Ze(h,u),a&&(h.g=a),c=h),t.N&&J(t.N,function(t,e){Ke(c,e,t)}),e=t.s,n=t.ha,e&&n&&Ke(c,e,n),Ke(c,"VER",t.oa),Xn(t,c),c}function ir(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ea)).F=t.w,e}function or(){}function sr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function ur(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Te.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){_e.call(this),this.status=1}function cr(t){this.a=t}(A=Ln.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ee(this.G):Ee(Ae),this.a.onreadystatechange=V(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Fe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=q(On,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.ta,this)):this.m=ne(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},A.ta=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Ln.M.C.call(this)},A.va=function(){this.j||(this.w||this.l||this.g?Cn(this):this.Oa())},A.Oa=function(){Cn(this)},A.S=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.qa=function(){return this.h},A.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Gn.prototype).oa=8,A.u=1,A.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Re(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=K(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ke(i=Qe(this.v),"RID",t),Ke(i,"CVER",22),this.s&&Ke(i,"X-HTTP-Session-Id",this.s),Xn(this,i),this.h&&r&&qn(i,this.h,r),En(this.b,n),this.fa?(Ke(i,"$req",e),Ke(i,"SID","null"),n.R=!0,Oe(n,i,null)):Oe(n,i,e),this.u=2}}else 3==this.u&&(t?Qn(this,t):0==this.f.length||mn(this.b)||Qn(this))},A.wa=function(){this.i=null,this.a=new Re(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Qe(this.ea);Ke(t,"RID","rpc"),Ke(t,"SID",this.B),Ke(t,"CI",this.U?"0":"1"),Ke(t,"AID",this.G),Xn(this,t),Ke(t,"TYPE","xmlhttp"),this.h&&this.j&&qn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=$e(Qe(t)),e.j=null,e.F=!0,ke(e,n)},A.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Jn(this),ye())},A.Ta=function(t){ye()},(A=or.prototype).na=function(){},A.ma=function(){},A.la=function(){},A.ka=function(){},A.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},x(ur,Ft),(A=ur.prototype).addEventListener=function(t,e,n,r){ur.M.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){ur.M.removeEventListener.call(this,t,e,n,r)},A.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(),t.P=e,t.N=n||{},t.U=t.W,t.v=rr(t,null,t.P),Wn(t)},A.close=function(){Bn(this.a)},A.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Bt(t),Hn(this.a,e)):Hn(this.a,t)},A.C=function(){this.a.c=null,delete this.f,Bn(this.a),delete this.a,ur.M.C.call(this)},x(ar,Te),x(hr,_e),x(cr,or),cr.prototype.na=function(){this.a.dispatchEvent("a")},cr.prototype.ma=function(t){this.a.dispatchEvent(new ar(t))},cr.prototype.la=function(t){this.a.dispatchEvent(new hr)},cr.prototype.ka=function(){this.a.dispatchEvent("b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.La,ur.prototype.open=ur.prototype.Ka,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ie.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Ft.prototype.listen=Ft.prototype.ra,Ln.prototype.listenOnce=Ln.prototype.sa,Ln.prototype.getLastError=Ln.prototype.Ma,Ln.prototype.getLastErrorCode=Ln.prototype.qa,Ln.prototype.getStatus=Ln.prototype.S,Ln.prototype.getResponseJson=Ln.prototype.Ja,Ln.prototype.getResponseText=Ln.prototype.Y,Ln.prototype.send=Ln.prototype.$;var lr={createWebChannelTransport:function(){return new sr},ErrorCode:me,EventType:we,WebChannel:Ie,XhrIo:Ln},fr=lr.createWebChannelTransport,pr=lr.ErrorCode,dr=lr.EventType,yr=lr.WebChannel,vr=lr.XhrIo,gr=(mr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},mr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},mr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},mr);function mr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var wr=Xl.SDK_VERSION,br=new h("@firebase/firestore");function Er(){return br.logLevel}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.DEBUG&&(e=n.map(Nr),br.debug.apply(br,y(["Firestore ("+wr+"): "+t],e)))}function Ar(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.ERROR&&(e=n.map(Nr),br.error.apply(br,y(["Firestore ("+wr+"): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Tr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Ar(e),new Error(e)}function _r(t){t||Tr()}function Sr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Rr=(Lr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Sr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Lr);function Lr(){}function Dr(t,e){return t<e?-1:e<t?1:0}function Pr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Or(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var kr=(Object.defineProperty(Ur.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ur.prototype.isEqual=function(t){return t instanceof Ur&&t.projectId===this.projectId&&t.database===this.database},Ur.prototype.o=function(t){return Dr(this.projectId,t.projectId)||Dr(this.database,t.database)},Ur);function Ur(t,e){this.projectId=t,this.database=e||"(default)"}function Vr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var xr,jr,qr,Fr=(ii.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},ii.prototype.has=function(t){return void 0!==this.get(t)},ii.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ii.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ii.prototype.forEach=function(u){Cr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},ii.prototype._=function(){return Mr(this.l)},ii),Gr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=(n(ri,qr=Error),ri),zr=(ni.now=function(){return ni.fromMillis(Date.now())},ni.fromDate=function(t){return ni.fromMillis(t.getTime())},ni.fromMillis=function(t){var e=Math.floor(t/1e3);return new ni(e,1e6*(t-1e3*e))},ni.prototype.toDate=function(){return new Date(this.toMillis())},ni.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ni.prototype.T=function(t){return this.seconds===t.seconds?Dr(this.nanoseconds,t.nanoseconds):Dr(this.seconds,t.seconds)},ni.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ni.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ni.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ni),Hr=(ei.m=function(t){return new ei(t)},ei.min=function(){return new ei(new zr(0,0))},ei.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ei.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ei.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ei.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ei.prototype.A=function(){return this.timestamp},ei),Wr=(Object.defineProperty(ti.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ti.prototype.isEqual=function(t){return 0===ti.P(this,t)},ti.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ti?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ti.prototype.limit=function(){return this.offset+this.length},ti.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ti.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ti.prototype.v=function(){return this.segments[this.offset]},ti.prototype.S=function(){return this.get(this.length-1)},ti.prototype.get=function(t){return this.segments[this.offset+t]},ti.prototype._=function(){return 0===this.length},ti.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ti.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ti.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ti),Qr=(n($r,jr=Wr),$r.prototype.V=function(t,e,n){return new $r(t,e,n)},$r.prototype.$=function(){return this.F().join("/")},$r.prototype.toString=function(){return this.$()},$r.N=function(t){if(0<=t.indexOf("//"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new $r(t.split("/").filter(function(t){return 0<t.length}))},$r.k=function(){return new $r([])},$r),Xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yr=(n(Kr,xr=Wr),Kr.prototype.V=function(t,e,n){return new Kr(t,e,n)},Kr.O=function(t){return Xr.test(t)},Kr.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Kr.O(t)||(t="`"+t+"`"),t}).join(".")},Kr.prototype.toString=function(){return this.$()},Kr.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},Kr.M=function(){return new Kr(["__name__"])},Kr.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Br(Gr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Br(Gr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Br(Gr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Kr(e)},Kr.k=function(){return new Kr([])},Kr),Zr=(Jr.B=function(t){return new Jr(Qr.N(t).p(5))},Jr.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Jr.prototype.isEqual=function(t){return null!==t&&0===Qr.P(this.path,t.path)},Jr.prototype.toString=function(){return this.path.toString()},Jr.P=function(t,e){return Qr.P(t.path,e.path)},Jr.W=function(t){return t.length%2==0},Jr.j=function(t){return new Jr(new Qr(t.slice()))},Jr);function Jr(t){this.path=t}function Kr(){return null!==xr&&xr.apply(this,arguments)||this}function $r(){return null!==jr&&jr.apply(this,arguments)||this}function ti(t,e,n){void 0===e?e=0:e>t.length&&Tr(),void 0===n?n=t.length-e:n>t.length-e&&Tr(),this.segments=t,this.offset=e,this.R=n}function ei(t){this.timestamp=t}function ni(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Br(Gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ri(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ii(t,e){this.h=t,this.u=e,this.l={}}function oi(t){return null==t}function si(t){return-0===t&&1/t==-1/0}function ui(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null}function ai(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ui(t,e,n,r,i,o,s)}function hi(t){var e,n=t;return null===n.G&&(e=n.path.$(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.$()+e.op.toString()+lo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),oi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=bu(n.startAt)),n.endAt&&(e+="|ub:",e+=bu(n.endAt)),n.G=e),n.G}function ci(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i,o,s=0;s<t.orderBy.length;s++)if(n=t.orderBy[s],r=e.orderBy[s],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(i=t.filters[u],o=e.filters[u],!(i instanceof nu&&o instanceof nu&&i.op===o.op&&i.field.isEqual(o.field)&&uo(i.value,o.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Iu(t.startAt,e.startAt)&&Iu(t.endAt,e.endAt)}function li(t){return Zr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var fi=(pi.fromBase64String=function(t){return new pi(atob(t))},pi.fromUint8Array=function(t){return new pi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},pi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},pi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},pi.prototype.H=function(){return 2*this.K.length},pi.prototype.o=function(t){return Dr(this.K,t.K)},pi.prototype.isEqual=function(t){return this.K===t.K},pi);function pi(t){this.K=t}function di(t){this.count=t}fi.Y=new fi("");var yi,vi,gi=(mi.prototype.Z=function(t){return new mi(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},mi.prototype.tt=function(t,e){return new mi(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},mi.prototype.et=function(t){return new mi(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},mi);function mi(t,e,n,r,i,o,s){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===s&&(s=fi.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function wi(t){switch(t){case Gr.OK:return Tr();case Gr.CANCELLED:case Gr.UNKNOWN:case Gr.DEADLINE_EXCEEDED:case Gr.RESOURCE_EXHAUSTED:case Gr.INTERNAL:case Gr.UNAVAILABLE:case Gr.UNAUTHENTICATED:return;case Gr.INVALID_ARGUMENT:case Gr.NOT_FOUND:case Gr.ALREADY_EXISTS:case Gr.PERMISSION_DENIED:case Gr.FAILED_PRECONDITION:case Gr.ABORTED:case Gr.OUT_OF_RANGE:case Gr.UNIMPLEMENTED:case Gr.DATA_LOSS:return 1;default:return Tr()}}function bi(t){if(void 0===t)return Ar("GRPC error has no .code"),Gr.UNKNOWN;switch(t){case yi.OK:return Gr.OK;case yi.CANCELLED:return Gr.CANCELLED;case yi.UNKNOWN:return Gr.UNKNOWN;case yi.DEADLINE_EXCEEDED:return Gr.DEADLINE_EXCEEDED;case yi.RESOURCE_EXHAUSTED:return Gr.RESOURCE_EXHAUSTED;case yi.INTERNAL:return Gr.INTERNAL;case yi.UNAVAILABLE:return Gr.UNAVAILABLE;case yi.UNAUTHENTICATED:return Gr.UNAUTHENTICATED;case yi.INVALID_ARGUMENT:return Gr.INVALID_ARGUMENT;case yi.NOT_FOUND:return Gr.NOT_FOUND;case yi.ALREADY_EXISTS:return Gr.ALREADY_EXISTS;case yi.PERMISSION_DENIED:return Gr.PERMISSION_DENIED;case yi.FAILED_PRECONDITION:return Gr.FAILED_PRECONDITION;case yi.ABORTED:return Gr.ABORTED;case yi.OUT_OF_RANGE:return Gr.OUT_OF_RANGE;case yi.UNIMPLEMENTED:return Gr.UNIMPLEMENTED;case yi.DATA_LOSS:return Gr.DATA_LOSS;default:return Tr()}}(vi=yi=yi||{})[vi.OK=0]="OK",vi[vi.CANCELLED=1]="CANCELLED",vi[vi.UNKNOWN=2]="UNKNOWN",vi[vi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vi[vi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vi[vi.NOT_FOUND=5]="NOT_FOUND",vi[vi.ALREADY_EXISTS=6]="ALREADY_EXISTS",vi[vi.PERMISSION_DENIED=7]="PERMISSION_DENIED",vi[vi.UNAUTHENTICATED=16]="UNAUTHENTICATED",vi[vi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vi[vi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vi[vi.ABORTED=10]="ABORTED",vi[vi.OUT_OF_RANGE=11]="OUT_OF_RANGE",vi[vi.UNIMPLEMENTED=12]="UNIMPLEMENTED",vi[vi.INTERNAL=13]="INTERNAL",vi[vi.UNAVAILABLE=14]="UNAVAILABLE",vi[vi.DATA_LOSS=15]="DATA_LOSS";var Ei=(_i.prototype.nt=function(t,e){return new _i(this.P,this.root.nt(t,e,this.P).copy(null,null,Ai.st,null,null))},_i.prototype.remove=function(t){return new _i(this.P,this.root.remove(t,this.P).copy(null,null,Ai.st,null,null))},_i.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},_i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},_i.prototype._=function(){return this.root._()},Object.defineProperty(_i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),_i.prototype.it=function(){return this.root.it()},_i.prototype.rt=function(){return this.root.rt()},_i.prototype.ot=function(t){return this.root.ot(t)},_i.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},_i.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},_i.prototype.ht=function(t){return this.root.ht(t)},_i.prototype.at=function(){return new Ii(this.root,null,this.P,!1)},_i.prototype.ut=function(t){return new Ii(this.root,t,this.P,!1)},_i.prototype.ct=function(){return new Ii(this.root,null,this.P,!0)},_i.prototype.lt=function(t){return new Ii(this.root,t,this.P,!0)},_i),Ii=(Ti.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ti.prototype.wt=function(){return 0<this.ft.length},Ti.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ti),Ai=(Ni.prototype.copy=function(t,e,n,r,i){return new Ni(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ni.prototype._=function(){return!1},Ni.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ni.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ni.prototype.min=function(){return this.left._()?this:this.left.min()},Ni.prototype.it=function(){return this.min().key},Ni.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ni.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ni.prototype.It=function(){if(this.left._())return Ni.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ni.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ni.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ni.prototype.At=function(){return this.color},Ni.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.yt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.pt()),t},Ni.prototype.Rt=function(){var t=this.pt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).yt()).pt()),t},Ni.prototype.Vt=function(){var t=this.pt();return t.left.left.At()&&(t=(t=t.Pt()).pt()),t},Ni.prototype.yt=function(){var t=this.copy(null,null,Ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ni.prototype.Pt=function(){var t=this.copy(null,null,Ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ni.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ni.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Ni.prototype.vt=function(){if(this.At()&&this.left.At())throw Tr();if(this.right.At())throw Tr();var t=this.left.vt();if(t!==this.right.vt())throw Tr();return t+(this.At()?0:1)},Ni);function Ni(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ni.RED,this.left=null!=r?r:Ni.EMPTY,this.right=null!=i?i:Ni.EMPTY,this.size=this.left.size+1+this.right.size}function Ti(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function _i(t,e){this.P=t,this.root=e||Ai.EMPTY}function Si(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.st=!1,Ai.EMPTY=(Object.defineProperty(Si.prototype,"key",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"value",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"color",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"left",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Object.defineProperty(Si.prototype,"right",{get:function(){throw Tr()},enumerable:!1,configurable:!0}),Si.prototype.copy=function(t,e,n,r,i){return this},Si.prototype.nt=function(t,e,n){return new Ai(t,e)},Si.prototype.remove=function(t,e){return this},Si.prototype._=function(){return!0},Si.prototype.ot=function(t){return!1},Si.prototype.ht=function(t){return!1},Si.prototype.it=function(){return null},Si.prototype.rt=function(){return null},Si.prototype.At=function(){return!1},Si.prototype.gt=function(){return!0},Si.prototype.vt=function(){return 0},new Si);var Ri=(Oi.prototype.has=function(t){return null!==this.data.get(t)},Oi.prototype.first=function(){return this.data.it()},Oi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Oi.prototype.indexOf=function(t){return this.data.indexOf(t)},Oi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Oi.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Oi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Oi.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Oi.prototype.at=function(){return new Li(this.data.at())},Oi.prototype.ut=function(t){return new Li(this.data.ut(t))},Oi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Oi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Oi.prototype._=function(){return this.data._()},Oi.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Oi.prototype.isEqual=function(t){if(!(t instanceof Oi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Oi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Oi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Oi.prototype.copy=function(t){var e=new Oi(this.P);return e.data=t,e},Oi),Li=(Pi.prototype.dt=function(){return this.Ft.dt().key},Pi.prototype.wt=function(){return this.Ft.wt()},Pi),Di=new Ei(Zr.P);function Pi(t){this.Ft=t}function Oi(t){this.P=t,this.data=new Ei(this.P)}var ki=new Ei(Zr.P);var Ui=new Ei(Zr.P),Vi=new Ri(Zr.P);function Ci(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Vi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mi=new Ri(Dr);function xi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function ji(t,e){this.targetId=t,this.ee=e}function qi(t,e,n,r){void 0===n&&(n=fi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Fi=(to.kt=function(t){return new to(t.P)},to.prototype.has=function(t){return null!=this.$t.get(t)},to.prototype.get=function(t){return this.$t.get(t)},to.prototype.first=function(){return this.Nt.it()},to.prototype.last=function(){return this.Nt.rt()},to.prototype._=function(){return this.Nt._()},to.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(to.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),to.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},to.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},to.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},to.prototype.isEqual=function(t){if(!(t instanceof to))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},to.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},to.prototype.copy=function(t,e){var n=new to;return n.P=this.P,n.$t=t,n.Nt=e,n},to),Gi=($i.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Tr()},$i.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},$i),Bi=(Ki.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ki(t,e,Fi.kt(e),i,n,r,!0,!1)},Object.defineProperty(Ki.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),Ki.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&Zs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ki),zi=(Ji.Kt=function(t,e){var n=new Map;return n.set(t,Hi.zt(t,e)),new Ji(Hr.min(),n,Mi,Di,Ci())},Ji),Hi=(Zi.zt=function(t,e){return new Zi(fi.Y,e,Ci(),Ci(),Ci())},Zi),Wi=(Object.defineProperty(Yi.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(Yi.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Yi.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},Yi.prototype.ce=function(){var n=Ci(),r=Ci(),i=Ci();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Tr()}}),new Hi(this.ie,this.re,n,r,i)},Yi.prototype.le=function(){this.oe=!1,this.se=no()},Yi.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},Yi.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},Yi.prototype.de=function(){this.ne+=1},Yi.prototype.we=function(){--this.ne},Yi.prototype.Te=function(){this.oe=!0,this.re=!0},Yi),Qi=(Xi.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Gs?this.Ve(r,t.te):t.te instanceof Bs&&this.ye(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.te)}},Xi.prototype.pe=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Tr()}})},Xi.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},Xi.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.De(r);o&&(li(e=o.target)?0===i?(n=new Zr(e.path),this.ye(r,n,new Bs(n,Hr.min()))):_r(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},Xi.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.De(e);r&&(t.Ht&&li(r.target)&&(n=new Zr(r.target.path),null!==o.Ie.get(n)||o.Ne(e,n)||o.ye(e,n,new Bs(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Ci();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new zi(i,s,this.Re,this.Ie,r);return this.Ie=Di,this.Ae=eo(),this.Re=new Ri(Dr),t},Xi.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.Ne(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t)))},Xi.prototype.ye=function(t,e,n){var r;this.be(t)&&(r=this.ve(t),this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},Xi.prototype.removeTarget=function(t){this.me.delete(t)},Xi.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},Xi.prototype.de=function(t){this.ve(t).de()},Xi.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Wi,this.me.set(t,e)),e},Xi.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Ri(Dr),this.Ae=this.Ae.nt(t,e)),e},Xi.prototype.be=function(t){var e=null!==this.De(t);return e||Ir("WatchChangeAggregator","Detected inactive target",t),e},Xi.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},Xi.prototype.Se=function(e){var n=this;this.me.set(e,new Wi),this.Ee.xe(e).forEach(function(t){n.ye(e,t,null)})},Xi.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},Xi);function Xi(t){this.Ee=t,this.me=new Map,this.Ie=Di,this.Ae=eo(),this.Re=new Ri(Dr)}function Yi(){this.ne=0,this.se=no(),this.ie=fi.Y,this.re=!1,this.oe=!0}function Zi(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function Ji(t,e,n,r,i){this.J=t,this.Qt=e,this.Wt=n,this.jt=r,this.Gt=i}function Ki(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Bt=u}function $i(){this.xt=new Ei(Zr.P)}function to(n){this.P=n?function(t,e){return n(t,e)||Zr.P(t.key,e.key)}:function(t,e){return Zr.P(t.key,e.key)},this.$t=ki,this.Nt=new Ei(this.P)}function eo(){return new Ei(Zr.P)}function no(){return new Ei(Zr.P)}function ro(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function io(t){var e=fo(t.mapValue.fields.__local_write_time__.timestampValue);return new zr(e.seconds,e.nanos)}var oo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function so(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ro(t)?4:10:Tr()}function uo(r,i){var t,e,n,o=so(r);if(o!==so(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return io(r).isEqual(io(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=fo(r.timestampValue),n=fo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,yo(r.bytesValue).isEqual(yo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,po((t=r).geoPointValue.latitude)===po(e.geoPointValue.latitude)&&po(t.geoPointValue.longitude)===po(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return po(t.integerValue)===po(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=po(t.doubleValue),r=po(e.doubleValue);return n===r?si(n)===si(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Pr(r.arrayValue.values||[],i.arrayValue.values||[],uo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Vr(t)!==Vr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!uo(t[n],e[n])))return!1;return!0}();default:return Tr()}}function ao(t,e){return void 0!==(t.values||[]).find(function(t){return uo(t,e)})}function ho(t,e){var n,r,i,o,s,u,a,h,c,l,f=so(t),p=so(e);if(f!==p)return Dr(f,p);switch(f){case 0:return 0;case 1:return Dr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=po(t.integerValue||t.doubleValue))<(l=po(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return co(t.timestampValue,e.timestampValue);case 4:return co(io(t),io(e));case 5:return Dr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=yo(o),a=yo(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Dr(n[i],r[i]);if(0!==o)return o}return Dr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Dr(po(n.latitude),po(r.latitude)))?i:Dr(po(n.longitude),po(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ho(n[i],r[i]);if(o)return o}return Dr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Dr(r[s],o[s]);if(0!==u)return u;var a=ho(n[r[s]],i[o[s]]);if(0!==a)return a}return Dr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Tr()}}function co(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Dr(t,e);var n=fo(t),r=fo(e),i=Dr(n.seconds,r.seconds);return 0!==i?i:Dr(n.nanos,r.nanos)}function lo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=fo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?yo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Zr.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Tr();var t,e,n}(t)}function fo(t){if(_r(!!t),"string"!=typeof t)return{seconds:po(t.seconds),nanos:po(t.nanos)};var e,n=0,r=oo.exec(t);_r(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function po(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yo(t){return"string"==typeof t?fi.fromBase64String(t):fi.fromUint8Array(t)}function vo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function go(t){return t&&"integerValue"in t}function mo(t){return!!t&&"arrayValue"in t}function wo(t){return t&&"nullValue"in t}function bo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eo(t){return t&&"mapValue"in t}var Io={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},No=function(t,e){this.s=t,this.Le=e};function To(t){return{integerValue:""+t}}function _o(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:si(e)?"-0":e}}function So(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!si(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?To(e):_o(t,e);var n}function Ro(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Do(t){return _r(!!t),Hr.m((e=fo(t),new zr(e.seconds,e.nanos)));var e}function Po(t,e){return new Qr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function Oo(t,e){return Po(t.s,e.path)}function ko(t,e){var n,r,i=(_r(qo(r=Qr.N(e))),r);return _r(i.get(1)===t.s.projectId),_r(!i.get(3)&&!t.s.database||i.get(3)===t.s.database),new Zr((_r(4<(n=i).length&&"documents"===n.get(4)),n.p(5)))}function Uo(t,e){return Po(t.s,e)}function Vo(t){return new Qr(["projects",t.s.projectId,"databases",t.s.database]).$()}function Co(t,e,n){return{name:Oo(t,e),fields:n.proto.mapValue.fields}}function Mo(t,e){var n,r,i,o;if(e instanceof ms)n={update:Co(t,e.key,e.value)};else if(e instanceof Ls)n={delete:Oo(t,e.key)};else if(e instanceof ws)n={update:Co(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Ns)n={transform:{document:Oo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ho)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof Wo)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof Jo)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof es)return{fieldPath:t.field.$(),increment:e.qe};throw Tr()})}};else{if(!(e instanceof Ds))return Tr();n={verify:Oo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Ro(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Tr()),n}function xo(t){return{before:t.before,values:t.position}}function jo(t){return{fieldPath:t.$()}}function qo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Fo(){this.Qe=void 0}function Go(t,e){return t instanceof es?go(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Bo,zo,Ho=(n(Xo,zo=Fo),Xo),Wo=(n(Qo,Bo=Fo),Qo);function Qo(t){var e=this;return(e=Bo.call(this)||this).elements=t,e}function Xo(){return null!==zo&&zo.apply(this,arguments)||this}function Yo(t,e){for(var n=is(e),r=function(e){n.some(function(t){return uo(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Zo,Jo=(n(Ko,Zo=Fo),Ko);function Ko(t){var e=this;return(e=Zo.call(this)||this).elements=t,e}function $o(t,e){for(var n=is(e),r=function(e){n=n.filter(function(t){return!uo(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ts,es=(n(ns,ts=Fo),ns);function ns(t,e){var n=this;return(n=ts.call(this)||this).serializer=t,n.qe=e,n}function rs(t){return po(t.integerValue||t.doubleValue)}function is(t){return mo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function os(t,e){this.field=t,this.transform=e}var ss=(us.prototype.We=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},us.prototype.isEqual=function(t){return Pr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},us);function us(t){(this.fields=t).sort(Yr.P)}function as(t,e){this.version=t,this.transformResults=e}var hs=(cs.je=function(){return new cs},cs.exists=function(t){return new cs(void 0,t)},cs.updateTime=function(t){return new cs(t)},Object.defineProperty(cs.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),cs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},cs);function cs(t,e){this.updateTime=t,this.exists=e}function ls(t,e){return void 0!==t.updateTime?e instanceof Gs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Gs}function fs(){}function ps(t,e,n,r){return t instanceof ms?function(t,e){if(!ls(t.Ue,e))return e;var n=ys(e);return new Gs(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof ws?function(t,e){if(!ls(t.Ue,e))return e;var n=ys(e),r=Is(t,e);return new Gs(t.key,n,r,{Ge:!0})}(t,e):t instanceof Ns?function(t,e,n,r){if(!ls(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Gs&&(y=n.field(p.field)),null===y&&r instanceof Gs&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof Ho?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof Wo?Yo(i,o):i instanceof Jo?$o(i,o):(a=rs(u=Go(s=i,o))+rs(s.qe),go(u)&&go(s.qe)?To(a):_o(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=_s(t,i.data(),o);return new Gs(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,ls((i=t).Ue,o)?new Bs(i.key,Hr.min()):o);var i,o}function ds(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||Pr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Wo&&o instanceof Wo||i instanceof Jo&&o instanceof Jo?Pr(i.elements,o.elements,uo):i instanceof es&&o instanceof es?uo(i.qe,o.qe):i instanceof Ho&&o instanceof Ho);var n,r,i,o}))}function ys(t){return t instanceof Gs?t.version:Hr.min()}var vs,gs,ms=(n(Es,gs=fs),Es),ws=(n(bs,vs=fs),bs);function bs(t,e,n,r){var i=this;return(i=vs.call(this)||this).key=t,i.data=e,i.Me=n,i.Ue=r,i.type=1,i}function Es(t,e,n){var r=this;return(r=gs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Is(t,e){return n=t,r=e instanceof Gs?e.data():Ps.empty(),i=new Os(r),n.Me.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ke();var n,r,i}var As,Ns=(n(Ts,As=fs),Ts);function Ts(t,e){var n=this;return(n=As.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=hs.exists(!0),n}function _s(t,e,n){for(var r=new Os(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ke()}var Ss,Rs,Ls=(n(Cs,Rs=fs),Cs),Ds=(n(Vs,Ss=fs),Vs),Ps=(Us.empty=function(){return new Us({mapValue:{}})},Us.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Eo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Us.prototype.isEqual=function(t){return uo(this.proto,t.proto)},Us),Os=(ks.prototype.set=function(t,e){return this.Ye(t,e),this},ks.prototype.delete=function(t){return this.Ye(t,null),this},ks.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===so(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},ks.prototype.Ke=function(){var t=this.Xe(Yr.k(),this.He);return null!=t?new Ps(t):this.ze},ks.prototype.Xe=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Eo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},ks);function ks(t){void 0===t&&(t=Ps.empty()),this.ze=t,this.He=new Map}function Us(t){this.proto=t}function Vs(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Cs(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Ms(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new Yr([t]);if(Eo(e)){var r=Ms(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new ss(u)}function xs(t,e){this.key=t,this.version=e}var js,qs,Fs,Gs=(n(Ys,Fs=xs),Ys.prototype.field=function(t){return this.Je.field(t)},Ys.prototype.data=function(){return this.Je},Ys.prototype.Ze=function(){return this.Je.proto},Ys.prototype.isEqual=function(t){return t instanceof Ys&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},Ys.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ys.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ys),Bs=(n(Xs,qs=xs),Xs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Xs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Xs.prototype.isEqual=function(t){return t instanceof Xs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Xs),zs=(n(Qs,js=xs),Qs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return t instanceof Qs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qs),Hs=(Ws.on=function(t){return new Ws(t)},Object.defineProperty(Ws.prototype,"orderBy",{get:function(){if(null===this.nn){this.nn=[];var t=this.hn(),e=this.an();if(null!==t&&null===e)t.L()||this.nn.push(new Au(t)),this.nn.push(new Au(Yr.M(),"asc"));else{for(var n,r=!1,i=0,o=this.tn;i<o.length;i++){var s=o[i];this.nn.push(s),s.field.L()&&(r=!0)}r||(n=0<this.tn.length?this.tn[this.tn.length-1].dir:"asc",this.nn.push(new Au(Yr.M(),n)))}}return this.nn},enumerable:!1,configurable:!0}),Ws.prototype.un=function(t){var e=this.filters.concat([t]);return new Ws(this.path,this.collectionGroup,this.tn.slice(),e,this.limit,this.en,this.startAt,this.endAt)},Ws.prototype.cn=function(t){var e=this.tn.concat([t]);return new Ws(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},Ws.prototype.ln=function(t){return new Ws(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Ws.prototype._n=function(t){return new Ws(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Ws.prototype.fn=function(t){return new Ws(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),this.limit,this.en,t,this.endAt)},Ws.prototype.dn=function(t){return new Ws(this.path,this.collectionGroup,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,t)},Ws.prototype.wn=function(t){return new Ws(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},Ws.prototype.Tn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},Ws.prototype.En=function(){return!oi(this.limit)&&"F"===this.en},Ws.prototype.mn=function(){return!oi(this.limit)&&"L"===this.en},Ws.prototype.an=function(){return 0<this.tn.length?this.tn[0].field:null},Ws.prototype.hn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof nu&&n.In())return n.field}return null},Ws.prototype.An=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof nu&&0<=t.indexOf(r.op))return r.op}return null},Ws.prototype.Rn=function(){return li(this.Pn())},Ws.prototype.Vn=function(){return null!==this.collectionGroup},Ws.prototype.Pn=function(){if(!this.sn)if("F"===this.en)this.sn=ai(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Au(r.field,i))}var o=this.endAt?new du(this.endAt.position,!this.endAt.before):null,s=this.startAt?new du(this.startAt.position,!this.startAt.before):null;this.sn=ai(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.sn},Ws.prototype.rn=function(t){},Ws);function Ws(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt&&this.rn(this.startAt),this.endAt&&this.rn(this.endAt)}function Qs(){return null!==js&&js.apply(this,arguments)||this}function Xs(t,e,n){var r=this;return(r=qs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Ys(t,e,n,r){var i=this;return(i=Fs.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Zs(t,e){return ci(t.Pn(),e.Pn())&&t.en===e.en}function Js(t){return hi(t.Pn())+"|lt:"+t.en}function Ks(t){return"Query(target="+(n=(e=t.Pn()).path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+lo(e.value);var e}).join(", ")+"]"),oi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+bu(e.startAt)),e.endAt&&(n+=", endAt: "+bu(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function $s(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.C(o):Zr.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Eu(e.startAt,e.orderBy,n))&&(!e.endAt||!Eu(e.endAt,e.orderBy,n)));var e,n,r,o}function tu(u){return function(t,e){for(var n=!1,r=0,i=u.orderBy;r<i.length;r++){var o=i[r],s=Nu(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var eu,nu=(n(ru,eu=function(){}),ru.create=function(t,e,n){if(t.L())return"in"===e?new cu(t,n):new hu(t,e,n);if(wo(n)){if("=="!==e)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ru(t,e,n)}if(bo(n)){if("=="!==e)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ru(t,e,n)}return"array-contains"===e?new lu(t,n):"in"===e?new fu(t,n):"array-contains-any"===e?new pu(t,n):new ru(t,e,n)},ru.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&so(this.value)===so(e)&&this.yn(ho(e,this.value))},ru.prototype.yn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Tr()}},ru.prototype.In=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},ru);function ru(t,e,n){var r=this;return(r=eu.call(this)||this).field=t,r.op=e,r.value=n,r}var iu,ou,su,uu,au,hu=(n(wu,au=nu),wu.prototype.matches=function(t){var e=Zr.P(t.key,this.key);return this.yn(e)},wu),cu=(n(mu,uu=nu),mu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},mu),lu=(n(gu,su=nu),gu.prototype.matches=function(t){var e=t.field(this.field);return mo(e)&&ao(e.arrayValue,this.value)},gu),fu=(n(vu,ou=nu),vu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ao(this.value.arrayValue,e)},vu),pu=(n(yu,iu=nu),yu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!mo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ao(e.value.arrayValue,t)})},yu),du=function(t,e){this.position=t,this.before=e};function yu(t,e){return iu.call(this,t,"array-contains-any",e)||this}function vu(t,e){return ou.call(this,t,"in",e)||this}function gu(t,e){return su.call(this,t,"array-contains",e)||this}function mu(t,e){var n=this;return(n=uu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Zr.B(t.referenceValue)}),n}function wu(t,e,n){var r=this;return(r=au.call(this,t,e,n)||this).key=Zr.B(n.referenceValue),r}function bu(t){return(t.before?"b":"a")+":"+t.position.map(lo).join(",")}function Eu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.L()?Zr.P(Zr.B(s.referenceValue),n.key):ho(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Iu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!uo(t.position[n],e.position[n]))return!1;return!0}var Au=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Nu(t,e,n){var r,i,o,s,u=t.field.L()?Zr.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?ho(o,s):Tr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Tr()}}var Tu=(Cu.prototype.gn=function(t,e,n){for(var r,i,o,s=n.vn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof ms?new Gs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof ws?function(t,e,n){if(!ls(t.Ue,e))return new zs(t.key,n.version);var r=Is(t,e);return new Gs(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Ns?function(t,e,n){if(_r(null!=n.transformResults),!ls(t.Ue,e))return new zs(t.key,n.version);var r=e,i=function(t,e,n){var r,i,o,s=[];_r(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Gs&&(c=e.field(a.field)),s.push((r=h,i=c,o=n[u],r instanceof Wo?Yo(r,i):r instanceof Jo?$o(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=_s(t,r.data(),i);return new Gs(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Bs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Cu.prototype.bn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ps(i,e,e,this.pn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ps(a,e,o,this.pn))}return e},Cu.prototype.Sn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.bn(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Cu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ci())},Cu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Pr(this.mutations,t.mutations,ds)&&Pr(this.baseMutations,t.baseMutations,ds)},Cu),_u=(Vu.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=Ui,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Vu(t,e,n,r)},Vu),Su=(Uu.prototype.catch=function(t){return this.next(void 0,t)},Uu.prototype.next=function(r,i){var o=this;return this.kn&&Tr(),this.kn=!0,this.Nn?this.error?this.xn(i,this.error):this.On(r,this.result):new Uu(function(e,n){o.Fn=function(t){o.On(r,t).next(e,n)},o.$n=function(t){o.xn(i,t).next(e,n)}})},Uu.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Uu.prototype.Mn=function(t){try{var e=t();return e instanceof Uu?e:Uu.resolve(e)}catch(t){return Uu.reject(t)}},Uu.prototype.On=function(t,e){return t?this.Mn(function(){return t(e)}):Uu.resolve(e)},Uu.prototype.xn=function(t,e){return t?this.Mn(function(){return t(e)}):Uu.reject(e)},Uu.resolve=function(n){return new Uu(function(t,e){t(n)})},Uu.reject=function(n){return new Uu(function(t,e){e(n)})},Uu.qn=function(t){return new Uu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Uu.Bn=function(t){for(var n=Uu.resolve(!1),e=function(e){n=n.next(function(t){return t?Uu.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},Uu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},Uu),Ru=(ku.prototype.jn=function(e,n){var r=this;return this.Qn.Gn(e,n).next(function(t){return r.Kn(e,n,t)})},ku.prototype.Kn=function(t,r,i){return this.Un.zn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].bn(r,t);return t})},ku.prototype.Hn=function(t,e,i){var o=Di;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].bn(t,e);o=o.nt(t,e)}),o},ku.prototype.Yn=function(e,t){var n=this;return this.Un.getEntries(e,t).next(function(t){return n.Xn(e,t)})},ku.prototype.Xn=function(r,i){var o=this;return this.Qn.Jn(r,i).next(function(t){var e=o.Hn(r,i,t),n=Di;return e.forEach(function(t,e){e=e||new Bs(t,Hr.min()),n=n.nt(t,e)}),n})},ku.prototype.Zn=function(t,e,n){return e.Rn()?this.ts(t,e.path):e.Vn()?this.es(t,e,n):this.ns(t,e,n)},ku.prototype.ts=function(t,e){return this.jn(t,new Zr(e)).next(function(t){var e=ki;return t instanceof Gs&&(e=e.nt(t.key,t)),e})},ku.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=ki;return this.Wn.ss(n,s).next(function(t){return Su.forEach(t,function(t){var e=r.wn(t.child(s));return o.ns(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},ku.prototype.ns=function(e,n,t){var c,l,r=this;return this.Un.Zn(e,n,t).next(function(t){return c=t,r.Qn.rs(e,n)}).next(function(t){return l=t,r.os(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=ps(s,a,a,r.pn);c=h instanceof Gs?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){$s(n,e)||(c=c.remove(t))}),c})},ku.prototype.os=function(t,e,n){for(var r=Ci(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ws&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Un.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Gs&&(h=h.nt(t,e))}),h})},ku),Lu=(Ou.us=function(t,e){for(var n=Ci(),r=Ci(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ou(t,e.fromCache,n,r)},Ou),Du=(Pu.prototype.ls=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Pu.prototype.next=function(){var t=++this.previousValue;return this._s&&this._s(t),t},Pu);function Pu(t,e){var n=this;this.previousValue=t,e&&(e.cs=function(t){return n.ls(t)},this._s=function(t){return e.fs(t)})}function Ou(t,e,n,r){this.targetId=t,this.fromCache=e,this.hs=n,this.as=r}function ku(t,e,n){this.Un=t,this.Qn=e,this.Wn=n}function Uu(t){var e=this;this.Fn=null,this.$n=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.kn=!1,t(function(t){e.Nn=!0,e.result=t,e.Fn&&e.Fn(t)},function(t){e.Nn=!0,e.error=t,e.$n&&e.$n(t)})}function Vu(t,e,n,r){this.batch=t,this.Cn=e,this.vn=n,this.Dn=r}function Cu(t,e,n,r){this.batchId=t,this.pn=e,this.baseMutations=n,this.mutations=r}function Mu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Du.ds=-1;var xu=(Hu.prototype.reset=function(){this.As=0},Hu.prototype.Vs=function(){this.As=this.Is},Hu.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.As+this.ps()),r=Math.max(0,Date.now()-this.Ps),i=Math.max(0,n-r);0<i&&Ir("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.As+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Rs=this.ws.gs(this.Ts,i,function(){return e.Ps=Date.now(),t()}),this.As*=this.ms,this.As<this.Es&&(this.As=this.Es),this.As>this.Is&&(this.As=this.Is)},Hu.prototype.vs=function(){null!==this.Rs&&(this.Rs.bs(),this.Rs=null)},Hu.prototype.cancel=function(){null!==this.Rs&&(this.Rs.cancel(),this.Rs=null)},Hu.prototype.ps=function(){return(Math.random()-.5)*this.As},Hu),ju=(zu.prototype.Cs=function(t,e){return this.Ss.add(e),Su.resolve()},zu.prototype.ss=function(t,e){return Su.resolve(this.Ss.getEntries(e))},zu),qu=(Bu.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Ri(Qr.P),i=!r.has(n);return this.index[e]=r.add(n),i},Bu.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},Bu.prototype.getEntries=function(t){return(this.index[t]||new Ri(Qr.P)).F()},Bu),Fu=(Gu.prototype.next=function(){return this.Ds+=2,this.Ds},Gu.Fs=function(){return new Gu(0)},Gu.$s=function(){return new Gu(-1)},Gu);function Gu(t){this.Ds=t}function Bu(){this.index={}}function zu(){this.Ss=new qu}function Hu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ws=t,this.Ts=e,this.Es=n,this.ms=r,this.Is=i,this.As=0,this.Rs=null,this.Ps=Date.now(),this.reset()}function Wu(t){return"IndexedDbTransactionError"===t.name}function Qu(){return"undefined"!=typeof window?window:null}var Xu=(Ju.Ls=function(t,e,n,r,i){var o=new Ju(t,e,Date.now()+n,r,i);return o.start(n),o},Ju.prototype.start=function(t){var e=this;this.Ms=setTimeout(function(){return e.qs()},t)},Ju.prototype.bs=function(){return this.qs()},Ju.prototype.cancel=function(t){null!==this.Ms&&(this.clearTimeout(),this.Os.reject(new Br(Gr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ju.prototype.qs=function(){var e=this;this.Ns.Bs(function(){return null!==e.Ms?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},Ju.prototype.clearTimeout=function(){null!==this.Ms&&(this.xs(this),clearTimeout(this.Ms),this.Ms=null)},Ju),Yu=(Object.defineProperty(Zu.prototype,"Xs",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Zu.prototype.Bs=function(t){this.enqueue(t)},Zu.prototype.Js=function(t){this.Zs(),this.ti(t)},Zu.prototype.ei=function(t){return this.Zs(),this.ti(t)},Zu.prototype.ni=function(n){return f(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.Zs(),this.Ws?[3,2]:(this.Ws=!0,(e=Qu())&&e.removeEventListener("visibilitychange",this.Ys),[4,this.ei(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Zu.prototype.enqueue=function(t){return this.Zs(),this.Ws?new Promise(function(t){}):this.ti(t)},Zu.prototype.si=function(t){var e=this;this.Qs.push(t),this.Bs(function(){return e.ii()})},Zu.prototype.ii=function(){return f(this,void 0,void 0,function(){var e,n=this;return d(this,function(t){switch(t.label){case 0:if(0===this.Qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Qs[0]()];case 2:return t.sent(),this.Qs.shift(),this.Hs.reset(),[3,4];case 3:if(!Wu(e=t.sent()))throw e;return Ir("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Qs.length&&this.Hs.ys(function(){return n.ii()}),t.label=5;case 5:return[2]}})})},Zu.prototype.ti=function(t){var r=this,e=this.Us.then(function(){return r.Ks=!0,t().catch(function(t){throw r.Gs=t,r.Ks=!1,Ar("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ks=!1,t})});return this.Us=e},Zu.prototype.gs=function(t,e,n){var r=this;this.Zs(),-1<this.zs.indexOf(t)&&(e=0);var i=Xu.Ls(this,t,e,n,function(t){return r.ri(t)});return this.js.push(i),i},Zu.prototype.Zs=function(){this.Gs&&Tr()},Zu.prototype.oi=function(){},Zu.prototype.hi=function(){return f(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},Zu.prototype.ai=function(t){for(var e=0,n=this.js;e<n.length;e++)if(n[e].Ts===t)return!0;return!1},Zu.prototype.ui=function(r){var i=this;return this.hi().then(function(){i.js.sort(function(t,e){return t.ks-e.ks});for(var t=0,e=i.js;t<e.length;t++){var n=e[t];if(n.bs(),"all"!==r&&n.Ts===r)break}return i.hi()})},Zu.prototype.ci=function(t){this.zs.push(t)},Zu.prototype.ri=function(t){var e=this.js.indexOf(t);this.js.splice(e,1)},Zu);function Zu(){var t=this;this.Us=Promise.resolve(),this.Qs=[],this.Ws=!1,this.js=[],this.Gs=null,this.Ks=!1,this.zs=[],this.Hs=new xu(this,"async_queue_retry"),this.Ys=function(){return t.Hs.vs()};var e=Qu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ys)}function Ju(t,e,n,r,i){this.Ns=t,this.Ts=e,this.ks=n,this.op=r,this.xs=i,this.Os=new Mu,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function Ku(t,e){if(Ar("AsyncQueue",e+": "+t),Wu(t))return new Br(Gr.UNAVAILABLE,e+": "+t);throw t}var $u=(ta.di=function(t){return new ta(t,ta.wi,ta.Ti)},ta);function ta(t,e,n){this.li=t,this._i=e,this.fi=n}$u.Ei=-1,$u.mi=1048576,$u.Ii=41943040,$u.wi=10,$u.Ti=1e3,$u.Ai=new $u($u.Ii,$u.wi,$u.Ti),$u.Ri=new $u($u.Ei,0,0);var ea=(na.prototype.start=function(){return Promise.resolve()},na.prototype.Ni=function(i){return f(this,void 0,void 0,function(){var e,m,n,r=this;return d(this,function(t){switch(t.label){case 0:return e=this.Qn,m=this.Di,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Qn.ki(v).next(function(t){return g=t,e=r.persistence.gi(i),m=new Ru(r.vi,e,r.persistence.Fi()),e.ki(v)}).next(function(t){for(var e=[],n=[],r=Ci(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Yn(v,r).next(function(t){return{xi:t,Oi:e,Li:n}})})})];case 1:return n=t.sent(),[2,(this.Qn=e,this.Di=m,this.Pi.$i(this.Di),n)]}})})},na.prototype.Mi=function(h){var c,l=this,f=zr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Ci());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Di.Yn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Ns?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Gs?t.field(i.field):void 0,s=Go(i.transform,o||null);null!=s&&(e=null==e?(new Os).set(i.field,s):e.set(i.field,s))}return e?e.Ke():null}(e):null);null!=s&&n.push(new ws(o.key,s,Ms(s.proto.mapValue),hs.exists(!0)))}return l.Qn.qi(a,f,n,h)})}).then(function(t){var e=t.Sn(c);return{batchId:t.batchId,Bi:e}})},na.prototype.Ui=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.vi.Qi({Wi:!0});return i.ji(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Qn.Gi(t)}).next(function(){return i.Di.Yn(t,e)})})},na.prototype.Ki=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Qn.zi(e,t).next(function(t){return _r(null!==t),n=t.keys(),r.Qn.Hi(e,t)}).next(function(){return r.Qn.Gi(e)}).next(function(){return r.Di.Yn(e,n)})})},na.prototype.Yi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Qn.Yi(t)})},na.prototype.Xi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Si.Xi(t)})},na.prototype.Ji=function(a){var h=this,c=a.J,l=this.Vi;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.vi.Qi({Wi:!0});l=h.Vi;var s=[];a.Qt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.Si.Zi(o,t.Jt,e).next(function(){return h.Si.tr(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.er),l=l.nt(e,r),na.nr(i,r,t)&&s.push(h.Si.sr(o,r))))});var t,u=Di,n=Ci();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof Bs&&e.version.isEqual(Hr.min())?(i.ir(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.rr(e,c),u=u.nt(t,e)):Ir("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Gt.has(t)&&s.push(h.persistence.hr.or(o,t))})})),c.isEqual(Hr.min())||(t=h.Si.Xi(o).next(function(t){return h.Si.ar(o,o.er,c)}),s.push(t)),Su.qn(s).next(function(){return i.apply(o)}).next(function(){return h.Di.Xn(o,u)})}).then(function(t){return h.Vi=l,t})},na.nr=function(t,e,n){return _r(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.ur||0<n.Yt.size+n.Xt.size+n.Jt.size},na.prototype.cr=function(c){return f(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Su.forEach(c,function(e){return Su.forEach(e.hs,function(t){return h.persistence.hr.lr(n,e.targetId,t)}).next(function(){return Su.forEach(e.as,function(t){return h.persistence.hr._r(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Wu(e=t.sent()))throw e;return Ir("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Vi.get(o),u=s.J,a=s.et(u),this.Vi=this.Vi.nt(o,a));return[2]}})})},na.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Qn.wr(t,e)})},na.prototype.Tr=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Di.jn(t,e)})},na.prototype.Er=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Si.mr(e,r).next(function(t){return t?(n=t,Su.resolve(n)):i.Si.Ir(e).next(function(t){return n=new gi(r,t,0,e.er),i.Si.Ar(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vi.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i.Vi=i.Vi.nt(t.targetId,t),i.yi.set(r,t.targetId)),t})},na.prototype.mr=function(t,e){var n=this.yi.get(e);return void 0!==n?Su.resolve(this.Vi.get(n)):this.Si.mr(t,e)},na.prototype.Rr=function(t,e){var n=this,r=this.Vi.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?Su.resolve():n.persistence.hr.removeTarget(t,r)}).then(function(){n.Vi=n.Vi.remove(t),n.yi.delete(r.target)})},na.prototype.Pr=function(t,n){var r=this,i=Hr.min(),o=Ci();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mr(e,t.Pn()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Si.Vr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Pi.Zn(e,t,n?i:Hr.min(),n?o:Ci())}).next(function(t){return{documents:t,yr:o}})})},na.prototype.ji=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Su.resolve();return n.forEach(function(r){u=u.next(function(){return o.zn(t,r)}).next(function(t){var e=t,n=i.Dn.get(r);_r(null!==n),(!e||e.version.o(n)<0)&&(e=s.gn(r,e,i))&&o.rr(e,i.Cn)})}),u.next(function(){return e.Qn.Hi(t,s)})},na.prototype.pr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.gr(t,n.Vi)})},na);function na(t,e,n){this.persistence=t,this.Pi=e,this.Vi=new Ei(Dr),this.yi=new Fr(hi,ci),this.pi=Hr.min(),this.Qn=t.gi(n),this.vi=t.bi(),this.Si=t.Ci(),this.Di=new Ru(this.vi,this.Qn,this.persistence.Fi()),this.Pi.$i(this.Di)}function ra(e){return f(this,void 0,void 0,function(){return d(this,function(t){if(e.code!==Gr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ir("LocalStore","Unexpectedly lost primary lease"),[2]})})}ea.ur=3e8;var ia=(ua.prototype._=function(){return this.vr._()},ua.prototype.lr=function(t,e){var n=new oa(t,e);this.vr=this.vr.add(n),this.Sr=this.Sr.add(n)},ua.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.lr(t,e)})},ua.prototype._r=function(t,e){this.Fr(new oa(t,e))},ua.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n._r(t,e)})},ua.prototype.Nr=function(t){var e=this,n=new Zr(new Qr([])),r=new oa(n,t),i=new oa(n,t+1),o=[];return this.Sr.bt([r,i],function(t){e.Fr(t),o.push(t.key)}),o},ua.prototype.kr=function(){var e=this;this.vr.forEach(function(t){return e.Fr(t)})},ua.prototype.Fr=function(t){this.vr=this.vr.delete(t),this.Sr=this.Sr.delete(t)},ua.prototype.xr=function(t){var e=new Zr(new Qr([])),n=new oa(e,t),r=new oa(e,t+1),i=Ci();return this.Sr.bt([n,r],function(t){i=i.add(t.key)}),i},ua.prototype.Or=function(t){var e=new oa(t,0),n=this.vr.Ct(e);return null!==n&&t.isEqual(n.key)},ua),oa=(sa.br=function(t,e){return Zr.P(t.key,e.key)||Dr(t.Lr,e.Lr)},sa.Cr=function(t,e){return Dr(t.Lr,e.Lr)||Zr.P(t.key,e.key)},sa);function sa(t,e){this.key=t,this.Lr=e}function ua(){this.vr=new Ri(oa.br),this.Sr=new Ri(oa.Cr)}function aa(t,e){if(0!==e.length)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+_a(e.length,"argument")+".")}function ha(t,e,n){if(e.length!==n)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires "+_a(n,"argument")+", but was called with "+_a(e.length,"argument")+".")}function ca(t,e,n){if(e.length<n)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+_a(n,"argument")+", but was called with "+_a(e.length,"argument")+".")}function la(t,e,n,r){if(e.length<n||e.length>r)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+_a(e.length,"argument")+".")}function fa(t,e,n,r){ma(t,e,Ta(n)+" argument",r)}function pa(t,e,n,r){void 0!==r&&fa(t,e,n,r)}function da(t,e,n,r){ma(t,e,n+" option",r)}function ya(t,e,n,r){void 0!==r&&da(t,e,n,r)}function va(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ba(s))}var u=ba(n);throw new Br(Gr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ga(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Br(Gr.INVALID_ARGUMENT,"Invalid value "+ba(r)+" provided to function "+t+"() for its "+Ta(n)+" argument. Acceptable values: "+e.join(", "));return r}function ma(t,e,n,r){if(!("object"===e?wa(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=ba(r);throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function wa(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ba(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Tr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ea(t,e,n){if(void 0===n)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ta(e)+" argument, but it was undefined.")}function Ia(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Br(Gr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Aa(t,e,n,r){var i=ba(r);return new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ta(n)+" argument to be a "+e+", but it was: "+i)}function Na(t,e,n){if(n<=0)throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ta(e)+" argument to be a positive number, but it was: "+n+".")}function Ta(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function _a(t,e){return t+" "+e+(1===t?"":"s")}function Sa(){if("undefined"==typeof Uint8Array)throw new Br(Gr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ra(){if("undefined"==typeof atob)throw new Br(Gr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var La,Da,Pa=(ja.fromBase64String=function(t){ha("Blob.fromBase64String",arguments,1),fa("Blob.fromBase64String","string",1,t),Ra();try{return new ja(fi.fromBase64String(t))}catch(t){throw new Br(Gr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ja.fromUint8Array=function(t){if(ha("Blob.fromUint8Array",arguments,1),Sa(),!(t instanceof Uint8Array))throw Aa("Blob.fromUint8Array","Uint8Array",1,t);return new ja(fi.fromUint8Array(t))},ja.prototype.toBase64=function(){return ha("Blob.toBase64",arguments,0),Ra(),this.Mr.toBase64()},ja.prototype.toUint8Array=function(){return ha("Blob.toUint8Array",arguments,0),Sa(),this.Mr.toUint8Array()},ja.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ja.prototype.isEqual=function(t){return this.Mr.isEqual(t.Mr)},ja),Oa=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Br(Gr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(fa("FieldPath","string",e,t[e]),0===t[e].length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.qr=new Yr(t)},ka=(n(xa,Da=Oa),xa.documentId=function(){return new xa(Yr.M().$())},xa.prototype.isEqual=function(t){if(!(t instanceof xa))throw Aa("isEqual","FieldPath",1,t);return this.qr.isEqual(t.qr)},xa),Ua=new RegExp("[~\\*/\\[\\]]"),Va=function(){this.Br=this},Ca=(n(Ma,La=Va),Ma.prototype.Qr=function(t){if(2!==t.Wr)throw 1===t.Wr?t.jr(this.Ur+"() can only appear at the top level of your update data"):t.jr(this.Ur+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},Ma.prototype.isEqual=function(t){return t instanceof Ma},Ma);function Ma(t){var e=this;return(e=La.call(this)||this).Ur=t,e}function xa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Da.call(this,t)||this}function ja(t){Ra(),this.Mr=t}function qa(t,e,n){return new yh({Wr:3,Gr:e.settings.Gr,methodName:t.Ur,Kr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Fa,Ga,Ba,za,Ha,Wa,Qa=(n(sh,Wa=Va),sh.prototype.Qr=function(t){return new os(t.path,new Ho)},sh.prototype.isEqual=function(t){return t instanceof sh},sh),Xa=(n(oh,Ha=Va),oh.prototype.Qr=function(t){var e=qa(this,t,!0),n=this.zr.map(function(t){return Ah(t,e)}),r=new Wo(n);return new os(t.path,r)},oh.prototype.isEqual=function(t){return this===t},oh),Ya=(n(ih,za=Va),ih.prototype.Qr=function(t){var e=qa(this,t,!0),n=this.zr.map(function(t){return Ah(t,e)}),r=new Jo(n);return new os(t.path,r)},ih.prototype.isEqual=function(t){return this===t},ih),Za=(n(rh,Ba=Va),rh.prototype.Qr=function(t){var e=new es(t.serializer,So(t.serializer,this.Hr));return new os(t.path,e)},rh.prototype.isEqual=function(t){return this===t},rh),Ja=(n(nh,Ga=Va),nh.delete=function(){return aa("FieldValue.delete",arguments),new Ka(new Ca("FieldValue.delete"))},nh.serverTimestamp=function(){return aa("FieldValue.serverTimestamp",arguments),new Ka(new Qa("FieldValue.serverTimestamp"))},nh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ca("FieldValue.arrayUnion",arguments,1),new Ka(new Xa("FieldValue.arrayUnion",t))},nh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ca("FieldValue.arrayRemove",arguments,1),new Ka(new Ya("FieldValue.arrayRemove",t))},nh.increment=function(t){return fa("FieldValue.increment","number",1,t),ha("FieldValue.increment",arguments,1),new Ka(new Za("FieldValue.increment",t))},nh),Ka=(n(eh,Fa=Ja),eh.prototype.Qr=function(t){return this.Br.Qr(t)},eh.prototype.isEqual=function(t){return t instanceof eh&&this.Br.isEqual(t.Br)},eh),$a=(Object.defineProperty(th.prototype,"latitude",{get:function(){return this.Yr},enumerable:!1,configurable:!0}),Object.defineProperty(th.prototype,"longitude",{get:function(){return this.Xr},enumerable:!1,configurable:!0}),th.prototype.isEqual=function(t){return this.Yr===t.Yr&&this.Xr===t.Xr},th.prototype.T=function(t){return Dr(this.Yr,t.Yr)||Dr(this.Xr,t.Xr)},th);function th(t,e){if(ha("GeoPoint",arguments,2),fa("GeoPoint","number",1,t),fa("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Br(Gr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Br(Gr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Yr=t,this.Xr=e}function eh(t){var e=this;return(e=Fa.call(this)||this).Br=t,e.Ur=t.Ur,e}function nh(){return Ga.call(this)||this}function rh(t,e){var n=this;return(n=Ba.call(this)||this).Ur=t,n.Hr=e,n}function ih(t,e){var n=this;return(n=za.call(this)||this).Ur=t,n.zr=e,n}function oh(t,e){var n=this;return(n=Ha.call(this)||this).Ur=t,n.zr=e,n}function sh(t){var e=this;return(e=Wa.call(this)||this).Ur=t,e}function uh(t){return new No(t,!0)}var ah=/^__.*__$/,hh=function(t,e,n){this.Jr=t,this.Zr=e,this.to=n},ch=(ph.prototype.eo=function(t,e){var n=[];return null!==this.Me?n.push(new ws(t,this.data,this.Me,e)):n.push(new ms(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ns(t,this.fieldTransforms)),n},ph),lh=(fh.prototype.eo=function(t,e){var n=[new ws(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new Ns(t,this.fieldTransforms)),n},fh);function fh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function ph(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function dh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Tr()}}var yh=(Object.defineProperty(mh.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(mh.prototype,"Wr",{get:function(){return this.settings.Wr},enumerable:!1,configurable:!0}),mh.prototype.so=function(t){return new mh(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},mh.prototype.io=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.so({path:n,Kr:!1});return r.ro(t),r},mh.prototype.oo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.so({path:n,Kr:!1});return r.no(),r},mh.prototype.ho=function(t){return this.so({path:void 0,Kr:!0})},mh.prototype.jr=function(t){return Lh(t,this.settings.methodName,this.settings.ao||!1,this.path,this.settings.Gr)},mh.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},mh.prototype.no=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.ro(this.path.get(t))},mh.prototype.ro=function(t){if(0===t.length)throw this.jr("Document fields must not be empty");if(dh(this.Wr)&&ah.test(t))throw this.jr('Document fields cannot begin and end with "__"')},mh),vh=(gh.prototype.uo=function(t,e,n,r){return void 0===r&&(r=!1),new yh({Wr:t,methodName:e,Gr:n,path:Yr.k(),Kr:!1,ao:r},this.s,this.serializer,this.ignoreUndefinedProperties)},gh);function gh(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||uh(t)}function mh(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.no(),this.fieldTransforms=i||[],this.Me=o||[]}function wh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.uo(o.merge||o.mergeFields?2:0,e,n,i);_h("Data must be an object, but it was:",s,r);var u,a,h=Nh(r,s);if(o.merge)u=new ss(s.Me),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Oa)d=p.qr;else{if("string"!=typeof p)throw Tr();d=Rh(e,p,n)}if(!s.contains(d))throw new Br(Gr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Dh(c,d)||c.push(d)}u=new ss(c),a=s.fieldTransforms.filter(function(t){return u.We(t.field)})}else u=null,a=s.fieldTransforms;return new ch(new Ps(h),u,a)}function bh(t,o,s,e){var u=t.uo(1,o,s);_h("Data must be an object, but it was:",u,e);var a=[],h=new Os;Cr(e,function(t,e){var n,r=Rh(o,t,s),i=u.oo(r);e instanceof Va&&e.Br instanceof Ca?a.push(r):null!=(n=Ah(e,i))&&(a.push(r),h.set(r,n))});var n=new ss(a);return new lh(h.Ke(),n,u.fieldTransforms)}function Eh(t,e,n,r,i,o){var s=t.uo(1,e,n),u=[Sh(e,r,n)],a=[i];if(o.length%2!=0)throw new Br(Gr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Sh(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new Os,v=u.length-1;0<=v;--v){Dh(d,u[v])||(c=u[v],l=a[v],f=s.oo(c),l instanceof Va&&l.Br instanceof Ca?d.push(c):null!=(p=Ah(l,f))&&(d.push(c),y.set(c,p)))}var g=new ss(d);return new lh(y.Ke(),g,s.fieldTransforms)}function Ih(t,e,n,r){return void 0===r&&(r=!1),Ah(n,t.uo(r?4:3,e))}function Ah(s,t){if(Th(s))return _h("Unsupported field value:",t,s),Nh(s,t);if(s instanceof Va)return function(t,e){if(!dh(e.Wr))throw e.jr(t.Ur+"() can only be used with update() and set()");if(!e.path)throw e.jr(t.Ur+"() is not currently supported inside arrays");var n=t.Qr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.Kr&&4!==t.Wr)throw t.jr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ah(i[r],t.ho(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return So(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=zr.fromDate(t);return{timestampValue:Ro(e.serializer,n)}}if(t instanceof zr){var r=new zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ro(e.serializer,r)}}if(t instanceof $a)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Pa)return{bytesValue:Lo(e.serializer,t)};if(t instanceof hh){var i=e.s,o=t.Jr;if(!o.isEqual(i))throw e.jr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Po(t.Jr||e.s,t.Zr.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.jr("Unsupported field value: "+ba(t))}(s,t)}function Nh(t,r){var i={};return Mr(t)?r.path&&0<r.path.length&&r.Me.push(r.path):Cr(t,function(t,e){var n=Ah(e,r.io(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Th(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof zr||t instanceof $a||t instanceof Pa||t instanceof hh||t instanceof Va)}function _h(t,e,n){if(!Th(n)||!wa(n)){var r=ba(n);throw"an object"===r?e.jr(t+" a custom object"):e.jr(t+" "+r)}}function Sh(t,e,n){if(e instanceof Oa)return e.qr;if("string"==typeof e)return Rh(t,e);throw Lh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Rh(t,e,n){try{return function(e){if(0<=e.search(Ua))throw new Br(Gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ka.bind.apply(ka,y([void 0],e.split("."))))}catch(t){throw new Br(Gr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).qr}catch(e){throw Lh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Lh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Br(Gr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Dh(t,e){return t.some(function(t){return t.isEqual(e)})}var Ph=(Oh.prototype.co=function(){return null!=this.uid},Oh.prototype.lo=function(){return this.co()?"uid:"+this.uid:"anonymous-user"},Oh.prototype.isEqual=function(t){return t.uid===this.uid},Oh);function Oh(t){this.uid=t}function kh(t,e){this.user=e,this.type="OAuth",this.do={},this.do.Authorization="Bearer "+t}function Uh(t){this.key=t}function Vh(t){this.key=t}function Ch(t,e,n){this.query=t,this.targetId=e,this.view=n}function Mh(t){this.key=t,this.eu=!1}function xh(){this.$u=void 0,this.listeners=[]}Ph.UNAUTHENTICATED=new Ph(null),Ph._o=new Ph("google-credentials-uid"),Ph.fo=new Ph("first-party-uid");var jh,qh,Fh,Gh,Bh=(Dc.prototype.getToken=function(){return Promise.resolve(null)},Dc.prototype.To=function(){},Dc.prototype.Eo=function(t){(this.wo=t)(Ph.UNAUTHENTICATED)},Dc.prototype.mo=function(){this.wo=null},Dc),zh=(Lc.prototype.getToken=function(){var e=this,n=this.Ro,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Ro!==n?(Ir("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new kh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Lc.prototype.To=function(){this.forceRefresh=!0},Lc.prototype.Eo=function(t){this.wo=t,this.Ao&&t(this.currentUser)},Lc.prototype.mo=function(){this.auth&&this.auth.removeAuthTokenListener(this.Io),this.Io=null,this.wo=null},Lc.prototype.Po=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Ph(t)},Lc),Hh=(Object.defineProperty(Rc.prototype,"do",{get:function(){var t={"X-Goog-AuthUser":this.yo},e=this.Vo.auth.po([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Rc),Wh=(Sc.prototype.getToken=function(){return Promise.resolve(new Hh(this.Vo,this.yo))},Sc.prototype.Eo=function(t){t(Ph.fo)},Sc.prototype.mo=function(){},Sc.prototype.To=function(){},Sc),Qh=(_c.prototype.Fo=function(){return 1===this.state||2===this.state||4===this.state},_c.prototype.$o=function(){return 2===this.state},_c.prototype.start=function(){3!==this.state?this.auth():this.No()},_c.prototype.stop=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Fo()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},_c.prototype.ko=function(){this.state=0,this.Hs.reset()},_c.prototype.xo=function(){var t=this;this.$o()&&null===this.Do&&(this.Do=this.ws.gs(this.vo,6e4,function(){return t.Oo()}))},_c.prototype.Lo=function(t){this.Mo(),this.stream.send(t)},_c.prototype.Oo=function(){return f(this,void 0,void 0,function(){return d(this,function(t){return this.$o()?[2,this.close(0)]:[2]})})},_c.prototype.Mo=function(){this.Do&&(this.Do.cancel(),this.Do=null)},_c.prototype.close=function(e,n){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Mo(),this.Hs.cancel(),this.Co++,3!==e?this.Hs.reset():n&&n.code===Gr.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Hs.Vs()):n&&n.code===Gr.UNAUTHENTICATED&&this.So.To(),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Bo(n)];case 1:return t.sent(),[2]}})})},_c.prototype.qo=function(){},_c.prototype.auth=function(){var n=this;this.state=1;var t=this.Uo(this.Co),e=this.Co;this.So.getToken().then(function(t){n.Co===e&&n.Qo(t)},function(e){t(function(){var t=new Br(Gr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Wo(t)})})},_c.prototype.Qo=function(t){var e=this,n=this.Uo(this.Co);this.stream=this.jo(t),this.stream.Go(function(){n(function(){return e.state=2,e.listener.Go()})}),this.stream.Bo(function(t){n(function(){return e.Wo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},_c.prototype.No=function(){var t=this;this.state=4,this.Hs.ys(function(){return f(t,void 0,void 0,function(){return d(this,function(t){return this.state=0,this.start(),[2]})})})},_c.prototype.Wo=function(t){return Ir("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},_c.prototype.Uo=function(e){var n=this;return function(t){n.ws.Bs(function(){return n.Co===e?t():(Ir("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},_c),Xh=(n(Tc,Fh=Qh),Tc.prototype.jo=function(t){return this.bo.Ko("Listen",t)},Tc.prototype.onMessage=function(t){this.Hs.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Tr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(_r(void 0===i||"string"==typeof i),fi.fromBase64String(i||"")):(_r(void 0===i||i instanceof Uint8Array),fi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new qi(s,u,a,h&&(r=void 0===(n=h).code?Gr.UNKNOWN:bi(n.code),new Br(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=ko(t,l.document.name),p=Do(l.document.updateTime),d=new Ps({mapValue:{fields:l.document.fields}}),y=new Gs(f,p,d,{});c=new xi(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=ko(t,v.document),m=v.readTime?Do(v.readTime):Hr.min(),w=new Bs(g,m);c=new xi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=ko(t,b.document);c=new xi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Tr();e.filter;var I=e.filter;I.targetId;var A=new di(I.count||0);c=new ji(I.targetId,A)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Hr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Hr.min():Do(e.readTime)}(t);return this.listener.zo(e,n)},Tc.prototype.Ho=function(t){var e,n,r,i,o={};o.database=Vo(this.serializer),o.addTarget=(e=this.serializer,(r=li(i=(n=t).target)?{documents:{documents:[Uo(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof nu?function(t){if("=="===t.op){if(bo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(wo(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:jo(t.field),op:(e=t.op,Ao[e]),value:t.value}};var e}(t):Tr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:jo((e=t).field),direction:(n=e.dir,Io[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||oi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=xo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=xo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Lo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Tr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Lo(o)},Tc.prototype.Yo=function(t){var e={};e.database=Vo(this.serializer),e.removeTarget=t,this.Lo(e)},Tc),Yh=(n(Nc,qh=Qh),Object.defineProperty(Nc.prototype,"Jo",{get:function(){return this.Xo},enumerable:!1,configurable:!0}),Nc.prototype.start=function(){this.Xo=!1,this.lastStreamToken=void 0,qh.prototype.start.call(this)},Nc.prototype.qo=function(){this.Xo&&this.Zo([])},Nc.prototype.jo=function(t){return this.bo.Ko("Write",t)},Nc.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Xo){this.Hs.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(_r(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Do(t.updateTime):Do(e);n.isEqual(Hr.min())&&(n=Do(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new as(n,r)}(t,i)})):[]),n=Do(t.commitTime);return this.listener.th(n,e)}var r,i;return _r(!t.writeResults||0===t.writeResults.length),this.Xo=!0,this.listener.eh()},Nc.prototype.nh=function(){var t={};t.database=Vo(this.serializer),this.Lo(t)},Nc.prototype.Zo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Mo(e.serializer,t)})};this.Lo(n)},Nc),Zh=(n(Ac,jh=function(){this.Qe=void 0}),Ac.prototype.ih=function(){if(this.sh)throw new Br(Gr.FAILED_PRECONDITION,"The client has already been terminated.")},Ac.prototype.rh=function(e,n){var r=this;return this.ih(),this.credentials.getToken().then(function(t){return r.bo.rh(e,n,t)}).catch(function(t){throw t.code===Gr.UNAUTHENTICATED&&r.credentials.To(),t})},Ac.prototype.oh=function(e,n){var r=this;return this.ih(),this.credentials.getToken().then(function(t){return r.bo.oh(e,n,t)}).catch(function(t){throw t.code===Gr.UNAUTHENTICATED&&r.credentials.To(),t})},Ac),Jh=(Ic.prototype.fh=function(r){return f(this,void 0,void 0,function(){var e,n=this;return d(this,function(t){switch(t.label){case 0:if(this.dh(),0<this.mutations.length)throw new Br(Gr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return f(this,void 0,void 0,function(){var i,e,n,o,r;return d(this,function(t){switch(t.label){case 0:return e={database:Vo((i=s).serializer),documents:u.map(function(t){return Oo(i.serializer,t)})},[4,i.oh("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=ko(t,e.found.name),r=Do(e.found.updateTime),i=new Ps({mapValue:{fields:e.found.fields}});return new Gs(n,r,i,{})}(e,n):"missing"in n?function(t,e){_r(!!e.missing),_r(!!e.readTime);var n=ko(t,e.missing),r=Do(e.readTime);return new Bs(n,r)}(e,n):Tr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());_r(!!e),r.push(e)}),r)]}})})}(this.hh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Bs||t instanceof Gs?n.wh(t):Tr()}),e)]}})})},Ic.prototype.set=function(t,e){this.write(e.eo(t,this.Ue(t))),this._h.add(t)},Ic.prototype.update=function(t,e){try{this.write(e.eo(t,this.Th(t)))}catch(t){this.lh=t}this._h.add(t)},Ic.prototype.delete=function(t){this.write([new Ls(t,this.Ue(t))]),this._h.add(t)},Ic.prototype.commit=function(){return f(this,void 0,void 0,function(){var e,r=this;return d(this,function(t){switch(t.label){case 0:if(this.dh(),this.lh)throw this.lh;return e=this.ah,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Zr(Qr.N(e));r.mutations.push(new Ds(n,r.Ue(n)))}),[4,function(r,i){return f(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return n={database:Vo((e=r).serializer),writes:i.map(function(t){return Mo(e.serializer,t)})},[4,e.rh("Commit",n)];case 1:return t.sent(),[2]}})})}(this.hh,this.mutations)];case 1:return t.sent(),this.uh=!0,[2]}})})},Ic.prototype.wh=function(t){var e;if(t instanceof Gs)e=t.version;else{if(!(t instanceof Bs))throw Tr();e=Hr.min()}var n=this.ah.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(Gr.ABORTED,"Document version changed between two reads.")}else this.ah.set(t.key.toString(),e)},Ic.prototype.Ue=function(t){var e=this.ah.get(t.toString());return!this._h.has(t)&&e?hs.updateTime(e):hs.je()},Ic.prototype.Th=function(t){var e=this.ah.get(t.toString());if(this._h.has(t)||!e)return hs.exists(!0);if(e.isEqual(Hr.min()))throw new Br(Gr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hs.updateTime(e)},Ic.prototype.write=function(t){this.dh(),this.mutations=this.mutations.concat(t)},Ic.prototype.dh=function(){},Ic),Kh=(Ec.prototype.Rh=function(){var t=this;0===this.mh&&(this.Ph("Unknown"),this.Ih=this.Ns.gs("online_state_timeout",1e4,function(){return t.Ih=null,t.Vh("Backend didn't respond within 10 seconds."),t.Ph("Offline"),Promise.resolve()}))},Ec.prototype.yh=function(t){"Online"===this.state?this.Ph("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.Ph("Offline")))},Ec.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Ah=!1),this.Ph(t)},Ec.prototype.Ph=function(t){t!==this.state&&(this.state=t,this.Eh(t))},Ec.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ah?(Ar(e),this.Ah=!1):Ir("OnlineStateTracker",e)},Ec.prototype.ph=function(){null!==this.Ih&&(this.Ih.cancel(),this.Ih=null)},Ec),$h=(bc.prototype.start=function(){return this.enableNetwork()},bc.prototype.enableNetwork=function(){return this.Ch.delete(0),this.Wh()},bc.prototype.Wh=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.$h()?(this.jh()?this.Gh():this.kh.set("Unknown"),[4,this.Kh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},bc.prototype.disableNetwork=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Ch.add(0),[4,this.zh()];case 1:return t.sent(),this.kh.set("Offline"),[2]}})})},bc.prototype.zh=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.qh.stop()];case 1:return t.sent(),[4,this.xh.stop()];case 2:return t.sent(),0<this.vh.length&&(Ir("RemoteStore","Stopping write stream with "+this.vh.length+" pending writes"),this.vh=[]),this.Hh(),[2]}})})},bc.prototype.Yh=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","RemoteStore shutting down."),this.Ch.add(5),[4,this.zh()];case 1:return t.sent(),this.Dh.Yh(),this.kh.set("Unknown"),[2]}})})},bc.prototype.listen=function(t){this.bh.has(t.targetId)||(this.bh.set(t.targetId,t),this.jh()?this.Gh():this.xh.$o()&&this.Xh(t))},bc.prototype.Jh=function(t){this.bh.delete(t),this.xh.$o()&&this.Zh(t),0===this.bh.size&&(this.xh.$o()?this.xh.xo():this.$h()&&this.kh.set("Unknown"))},bc.prototype.Oe=function(t){return this.bh.get(t)||null},bc.prototype.xe=function(t){return this.ta.xe(t)},bc.prototype.Xh=function(t){this.Sh.de(t.targetId),this.xh.Ho(t)},bc.prototype.Zh=function(t){this.Sh.de(t),this.xh.Yo(t)},bc.prototype.Gh=function(){this.Sh=new Qi(this),this.xh.start(),this.kh.Rh()},bc.prototype.jh=function(){return this.$h()&&!this.xh.Fo()&&0<this.bh.size},bc.prototype.$h=function(){return 0===this.Ch.size},bc.prototype.Hh=function(){this.Sh=null},bc.prototype.Oh=function(){return f(this,void 0,void 0,function(){var n=this;return d(this,function(t){return this.bh.forEach(function(t,e){n.Xh(t)}),[2]})})},bc.prototype.Lh=function(e){return f(this,void 0,void 0,function(){return d(this,function(t){return this.Hh(),this.jh()?(this.kh.yh(e),this.Gh()):this.kh.set("Unknown"),[2]})})},bc.prototype.Mh=function(i,o){return f(this,void 0,void 0,function(){var e,n,r;return d(this,function(t){switch(t.label){case 0:if(this.kh.set("Online"),!(i instanceof qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.ea(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Ir("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.na(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof xi?this.Sh.Pe(i):i instanceof ji?this.Sh.Ce(i):this.Sh.pe(i),o.isEqual(Hr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.gh.Xi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.sa(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ir("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.na(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},bc.prototype.na=function(n,r){return f(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:if(!Wu(n))throw n;return this.Ch.add(1),[4,this.zh()];case 1:return t.sent(),this.kh.set("Offline"),r=r||function(){return e.gh.Xi()},this.Ns.si(function(){return f(e,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Ch.delete(1),[4,this.Wh()];case 2:return t.sent(),[2]}})})}),[2]}})})},bc.prototype.ia=function(e){var n=this;return e().catch(function(t){return n.na(t,e)})},bc.prototype.sa=function(r){var i=this,t=this.Sh.$e(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.H()&&((n=i.bh.get(e))&&i.bh.set(e,n.tt(t.resumeToken,r)))}),t.Wt.forEach(function(t){var e,n=i.bh.get(t);n&&(i.bh.set(t,n.tt(fi.Y,n.J)),i.Zh(t),e=new gi(n.target,t,1,n.sequenceNumber),i.Xh(e))}),this.ta.Ji(t)},bc.prototype.ea=function(o){return f(this,void 0,void 0,function(){var e,n,r,i;return d(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.bh.has(i)?[4,this.ta.ra(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.bh.delete(i),this.Sh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},bc.prototype.Kh=function(){return f(this,void 0,void 0,function(){var e,n,r;return d(this,function(t){switch(t.label){case 0:e=0<this.vh.length?this.vh[this.vh.length-1].batchId:-1,t.label=1;case 1:if(!this.oa())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.gh.dr(e)];case 3:return null===(n=t.sent())?(0===this.vh.length&&this.qh.xo(),[3,7]):(e=n.batchId,this.ha(n),[3,6]);case 4:return r=t.sent(),[4,this.na(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.aa()&&this.ua(),[2]}})})},bc.prototype.oa=function(){return this.$h()&&this.vh.length<10},bc.prototype.ca=function(){return this.vh.length},bc.prototype.ha=function(t){this.vh.push(t),this.qh.$o()&&this.qh.Jo&&this.qh.Zo(t.mutations)},bc.prototype.aa=function(){return this.$h()&&!this.qh.Fo()&&0<this.vh.length},bc.prototype.ua=function(){this.qh.start()},bc.prototype.Bh=function(){return f(this,void 0,void 0,function(){return d(this,function(t){return this.qh.nh(),[2]})})},bc.prototype.Qh=function(){return f(this,void 0,void 0,function(){var e,n,r;return d(this,function(t){for(e=0,n=this.vh;e<n.length;e++)r=n[e],this.qh.Zo(r.mutations);return[2]})})},bc.prototype.th=function(i,o){return f(this,void 0,void 0,function(){var e,n,r=this;return d(this,function(t){switch(t.label){case 0:return e=this.vh.shift(),n=_u.from(e,i,o),[4,this.ia(function(){return r.ta.la(n)})];case 1:return t.sent(),[4,this.Kh()];case 2:return t.sent(),[2]}})})},bc.prototype.Uh=function(e){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return e&&this.qh.Jo?[4,this._a(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.aa()&&this.ua(),[2]}})})},bc.prototype._a=function(i){return f(this,void 0,void 0,function(){var e,n,r=this;return d(this,function(t){switch(t.label){case 0:return wi(n=i.code)&&n!==Gr.ABORTED?(e=this.vh.shift(),this.qh.ko(),[4,this.ia(function(){return r.ta.fa(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Kh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},bc.prototype.da=function(){return new Jh(this.hh)},bc.prototype.Nh=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Ch.add(4),[4,this.zh()];case 1:return t.sent(),this.kh.set("Unknown"),this.Ch.delete(4),[4,this.Wh()];case 2:return t.sent(),[2]}})})},bc.prototype.wa=function(e){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Ns.oi(),Ir("RemoteStore","RemoteStore received new credentials"),this.Ch.add(3),[4,this.zh()];case 1:return t.sent(),this.kh.set("Unknown"),[4,this.ta.wa(e)];case 2:return t.sent(),this.Ch.delete(3),[4,this.Wh()];case 3:return t.sent(),[2]}})})},bc.prototype.Ta=function(e){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return e?(this.Ch.delete(2),[4,this.Wh()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Ch.add(2),[4,this.zh()]);case 3:t.sent(),this.kh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},bc),tc=(wc.prototype.Ea=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},wc.prototype.ma=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},wc.prototype.Ia=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},wc),ec=(mc.prototype.Pa=function(t){},mc.prototype.Va=function(t,e,n){},mc.prototype.ya=function(t){return this.Aa.Ea(t),this.Ra[t]||"not-current"},mc.prototype.pa=function(t,e,n){this.Ra[t]=e},mc.prototype.ga=function(t){this.Aa.ma(t)},mc.prototype.va=function(t){return this.Aa.activeTargetIds.has(t)},mc.prototype.ba=function(t){delete this.Ra[t]},mc.prototype.Sa=function(){return this.Aa.activeTargetIds},mc.prototype.Ca=function(t){return this.Aa.activeTargetIds.has(t)},mc.prototype.start=function(){return this.Aa=new tc,Promise.resolve()},mc.prototype.Ni=function(t,e,n){},mc.prototype.Da=function(t){},mc.prototype.Yh=function(){},mc.prototype.fs=function(t){},mc),nc=(Object.defineProperty(gc.prototype,"Oa",{get:function(){return this.Fa},enumerable:!1,configurable:!0}),gc.prototype.La=function(t,e){var u=this,a=e?e.Ma:new Gi,h=e?e.xa:this.xa,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.En()&&h.size===this.query.limit?h.last():null,d=this.query.mn()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof Gs?e:null)&&($s(u.query,r)?r:null),i=!!n&&u.Mt.has(n.key),o=!!r&&(r.Ge||u.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.qa(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.ka(r,p)||d&&u.ka(r,d)<0)&&(f=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.En()||this.query.mn())for(;l.size>this.query.limit;){var n=this.query.En()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{xa:l,Ma:a,Ba:f,Mt:c}},gc.prototype.qa=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},gc.prototype.Ua=function(t,e,n){var o=this,r=this.xa;this.xa=t.xa,this.Mt=t.Mt;var i=t.Ma.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ka(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tr()}}var r,i}),this.Qa(n);var s=e?this.Wa():[],u=0===this.Na.size&&this.Ht?1:0,a=u!==this.$a;return this.$a=u,0!==i.length||a?{snapshot:new Bi(this.query,t.xa,r,i,t.Mt,0==u,a,!1),ja:s}:{ja:s}},gc.prototype.Ga=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Ua({xa:this.xa,Ma:new Gi,Mt:this.Mt,Ba:!1},!1)):{ja:[]}},gc.prototype.Ka=function(t){return!this.Fa.has(t)&&!!this.xa.has(t)&&!this.xa.get(t).Ge},gc.prototype.Qa=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Fa=e.Fa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Fa=e.Fa.delete(t)}),this.Ht=t.Ht)},gc.prototype.Wa=function(){var e=this;if(!this.Ht)return[];var n=this.Na;this.Na=Ci(),this.xa.forEach(function(t){e.Ka(t.key)&&(e.Na=e.Na.add(t.key))});var r=[];return n.forEach(function(t){e.Na.has(t)||r.push(new Vh(t))}),this.Na.forEach(function(t){n.has(t)||r.push(new Uh(t))}),r},gc.prototype.za=function(t){this.Fa=t.yr,this.Na=Ci();var e=this.La(t.documents);return this.Ua(e,!0)},gc.prototype.Ha=function(){return Bi.Ut(this.query,this.xa,this.Mt,0===this.$a)},gc),rc=(vc.prototype.run=function(){this.Xa()},vc.prototype.Xa=function(){var t=this;this.Hs.ys(function(){return f(t,void 0,void 0,function(){var e,n,r=this;return d(this,function(t){return e=new Jh(this.hh),(n=this.Ja(e))&&n.then(function(t){r.Ns.Bs(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Za(t)})})}).catch(function(t){r.Za(t)}),[2]})})})},vc.prototype.Ja=function(t){try{var e=this.updateFunction(t);return!oi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},vc.prototype.Za=function(t){var e=this;0<this.Ya&&this.tu(t)?(--this.Ya,this.Ns.Bs(function(){return e.Xa(),Promise.resolve()})):this.Os.reject(t)},vc.prototype.tu=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!wi(e)},vc),ic=(Object.defineProperty(yc.prototype,"wu",{get:function(){return!0},enumerable:!1,configurable:!0}),yc.prototype.subscribe=function(t){this.ru=t},yc.prototype.listen=function(s){return f(this,void 0,void 0,function(){var e,n,r,i,o;return d(this,function(t){switch(t.label){case 0:return this.Tu("listen()"),(r=this.ou.get(s))?(e=r.targetId,this.su.ya(e),n=r.view.Ha(),[3,4]):[3,1];case 1:return[4,this.gh.Er(s.Pn())];case 2:return i=t.sent(),o=this.su.ya(i.targetId),e=i.targetId,[4,this.Eu(s,e,"current"===o)];case 3:n=t.sent(),this.wu&&this.nu.listen(i),t.label=4;case 4:return[2,n]}})})},yc.prototype.Eu=function(u,a,h){return f(this,void 0,void 0,function(){var e,n,r,i,o,s;return d(this,function(t){switch(t.label){case 0:return[4,this.gh.Pr(u,!0)];case 1:return e=t.sent(),n=new nc(u,e.yr),r=n.La(e.documents),i=Hi.zt(a,h&&"Offline"!==this.onlineState),o=n.Ua(r,this.wu,i),this.mu(a,o.ja),s=new Ch(u,a,n),[2,(this.ou.set(u,s),this.hu.has(a)?this.hu.get(a).push(u):this.hu.set(a,[u]),o.snapshot)]}})})},yc.prototype.Jh=function(i){return f(this,void 0,void 0,function(){var e,n,r=this;return d(this,function(t){switch(t.label){case 0:return this.Tu("unlisten()"),e=this.ou.get(i),1<(n=this.hu.get(e.targetId)).length?[2,(this.hu.set(e.targetId,n.filter(function(t){return!Zs(t,i)})),void this.ou.delete(i))]:this.wu?(this.su.ga(e.targetId),this.su.Ca(e.targetId)?[3,2]:[4,this.gh.Rr(e.targetId,!1).then(function(){r.su.ba(e.targetId),r.nu.Jh(e.targetId),r.Iu(e.targetId)}).catch(ra)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Iu(e.targetId),[4,this.gh.Rr(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},yc.prototype.write=function(i,o){return f(this,void 0,void 0,function(){var e,n,r;return d(this,function(t){switch(t.label){case 0:this.Tu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.gh.Mi(i)];case 2:return e=t.sent(),this.su.Pa(e.batchId),this.Au(e.batchId,o),[4,this.Ru(e.Bi)];case 3:return t.sent(),[4,this.nu.Kh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Ku(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},yc.prototype.runTransaction=function(t,e,n){new rc(t,this.hh,e,n).run()},yc.prototype.Ji=function(n){return f(this,void 0,void 0,function(){var e,r=this;return d(this,function(t){switch(t.label){case 0:this.Tu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ji(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.cu.get(e);n&&(_r(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.eu=!0:0<t.Xt.size?_r(n.eu):0<t.Jt.size&&(_r(n.eu),n.eu=!1))}),[4,this.Ru(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,ra(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yc.prototype.Ga=function(r,t){this.Tu("applyOnlineStateChange()");var i=[];this.ou.forEach(function(t,e){var n=e.view.Ga(r);n.snapshot&&i.push(n.snapshot)}),this.ru.Pu(r),this.ru.zo(i),this.onlineState=r},yc.prototype.ra=function(u,a){return f(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return d(this,function(t){switch(t.label){case 0:return this.Tu("rejectListens()"),this.su.pa(u,"rejected",a),e=this.cu.get(u),(n=e&&e.key)?(r=(r=new Ei(Zr.P)).nt(n,new Bs(n,Hr.min())),i=Ci().add(n),o=new zi(Hr.min(),new Map,new Ri(Dr),r,i),[4,this.Ji(o)]):[3,2];case 1:return t.sent(),this.uu=this.uu.remove(n),this.cu.delete(u),this.Vu(),[3,4];case 2:return[4,this.gh.Rr(u,!1).then(function(){return s.Iu(u,a)}).catch(ra)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},yc.prototype.la=function(r){return f(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:this.Tu("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ui(r)];case 2:return n=t.sent(),this.yu(e,null),this.pu(e),this.su.Va(e,"acknowledged"),[4,this.Ru(n)];case 3:return t.sent(),[3,6];case 4:return[4,ra(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yc.prototype.fa=function(n,r){return f(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:this.Tu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.gh.Ki(n)];case 2:return e=t.sent(),this.yu(n,r),this.pu(n),this.su.Va(n,"rejected",r),[4,this.Ru(e)];case 3:return t.sent(),[3,6];case 4:return[4,ra(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yc.prototype.gu=function(o){return f(this,void 0,void 0,function(){var e,n,r,i;return d(this,function(t){switch(t.label){case 0:this.nu.$h()||Ir("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gh.Yi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.fu.get(e)||[]).push(o),this.fu.set(e,n),[3,4]);case 3:return r=t.sent(),i=Ku(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},yc.prototype.pu=function(t){(this.fu.get(t)||[]).forEach(function(t){t.resolve()}),this.fu.delete(t)},yc.prototype.vu=function(e){this.fu.forEach(function(t){t.forEach(function(t){t.reject(new Br(Gr.CANCELLED,e))})}),this.fu.clear()},yc.prototype.Au=function(t,e){var n=(n=(n=this._u[this.currentUser.lo()])||new Ei(Dr)).nt(t,e);this._u[this.currentUser.lo()]=n},yc.prototype.yu=function(t,e){var n,r=this._u[this.currentUser.lo()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this._u[this.currentUser.lo()]=r)},yc.prototype.Iu=function(t,e){var n=this;void 0===e&&(e=null),this.su.ga(t);for(var r=0,i=this.hu.get(t);r<i.length;r++){var o=i[r];this.ou.delete(o),e&&this.ru.bu(o,e)}this.hu.delete(t),this.wu&&this.lu.Nr(t).forEach(function(t){n.lu.Or(t)||n.Su(t)})},yc.prototype.Su=function(t){var e=this.uu.get(t);null!==e&&(this.nu.Jh(e),this.uu=this.uu.remove(t),this.cu.delete(e),this.Vu())},yc.prototype.mu=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Uh?(this.lu.lr(i.key,t),this.Cu(i)):i instanceof Vh?(Ir("SyncEngine","Document no longer in limbo: "+i.key),this.lu._r(i.key,t),this.lu.Or(i.key)||this.Su(i.key)):Tr()}},yc.prototype.Cu=function(t){var e=t.key;this.uu.get(e)||(Ir("SyncEngine","New document in limbo: "+e),this.au.push(e),this.Vu())},yc.prototype.Vu=function(){for(;0<this.au.length&&this.uu.size<this.iu;){var t=this.au.shift(),e=this.du.next();this.cu.set(e,new Mh(t)),this.uu=this.uu.nt(t,e),this.nu.listen(new gi(Hs.on(t.path).Pn(),e,2,Du.ds))}},yc.prototype.Du=function(){return this.uu},yc.prototype.Fu=function(){return this.au},yc.prototype.Ru=function(r,a){return f(this,void 0,void 0,function(){var o,s,e,u=this;return d(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ou.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.La(r);return n.Ba?u.gh.Pr(i.query,!1).then(function(t){var e=t.documents;return i.view.La(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.Ua(t,u.wu,n);u.mu(i.targetId,r.ja),r.snapshot&&(u.wu&&u.su.pa(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Lu.us(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.ru.zo(o),[4,this.gh.cr(s)];case 2:return t.sent(),[2]}})})},yc.prototype.Tu=function(t){},yc.prototype.wa=function(n){return f(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Ir("SyncEngine","User change. New user:",n.lo()),[4,this.gh.Ni(n)]);case 1:return e=t.sent(),this.currentUser=n,this.vu("'waitForPendingWrites' promise is rejected due to a user change."),this.su.Ni(n,e.Oi,e.Li),[4,this.Ru(e.xi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},yc.prototype.enableNetwork=function(){return this.nu.enableNetwork()},yc.prototype.disableNetwork=function(){return this.nu.disableNetwork()},yc.prototype.xe=function(t){var e=this.cu.get(t);if(e&&e.eu)return Ci().add(e.key);var n=Ci(),r=this.hu.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.ou.get(s),n=n.Dt(u.view.Oa);return n},yc),oc=(dc.prototype.listen=function(u){return f(this,void 0,void 0,function(){var e,n,r,i,o,s;return d(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Nu.get(e))||(n=!0,r=new xh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.ta.listen(e)];case 2:return i.$u=t.sent(),[3,4];case 3:return o=t.sent(),s=Ku(o,"Initialization of query '"+Ks(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.Nu.set(e,r),r.listeners.push(u),u.Ga(this.onlineState),r.$u&&u.xu(r.$u)&&this.Ou(),[2]}})})},dc.prototype.Jh=function(o){return f(this,void 0,void 0,function(){var e,n,r,i;return d(this,function(t){return e=o.query,n=!1,(r=this.Nu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.Nu.delete(e),this.ta.Jh(e))]:[2]})})},dc.prototype.zo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nu.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].xu(i)&&(e=!0);s.$u=i}}e&&this.Ou()},dc.prototype.bu=function(t,e){var n=this.Nu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Nu.delete(t)},dc.prototype.Pu=function(i){this.onlineState=i;var o=!1;this.Nu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ga(i)&&(o=!0)}),o&&this.Ou()},dc.prototype.Lu=function(t){this.ku.add(t),t.next()},dc.prototype.Mu=function(t){this.ku.delete(t)},dc.prototype.Ou=function(){this.ku.forEach(function(t){t.next()})},dc),sc=(pc.prototype.xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bi(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Bu?this.Qu(t)&&(this.qu.next(t),o=!0):this.Wu(t,this.onlineState)&&(this.ju(t),o=!0),this.Uu=t,o},pc.prototype.onError=function(t){this.qu.error(t)},pc.prototype.Ga=function(t){this.onlineState=t;var e=!1;return this.Uu&&!this.Bu&&this.Wu(this.Uu,t)&&(this.ju(this.Uu),e=!0),e},pc.prototype.Wu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Gu&&n||t.docs._()&&"Offline"!==e)},pc.prototype.Qu=function(t){if(0<t.docChanges.length)return!0;var e=this.Uu&&this.Uu.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},pc.prototype.ju=function(t){t=Bi.Ut(t.query,t.docs,t.Mt,t.fromCache),this.Bu=!0,this.qu.next(t)},pc),uc=(fc.prototype.$i=function(t){this.Ku=t},fc.prototype.Zn=function(e,r,i,o){var s=this;return r.Tn()||i.isEqual(Hr.min())?this.zu(e,r):this.Ku.Yn(e,o).next(function(t){var n=s.Hu(r,t);return(r.En()||r.mn())&&s.Ba(r.en,n,o,i)?s.zu(e,r):(Er()<=p.DEBUG&&Ir("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ks(r)),s.Ku.Zn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},fc.prototype.Hu=function(n,t){var r=new Ri(tu(n));return t.forEach(function(t,e){e instanceof Gs&&$s(n,e)&&(r=r.add(e))}),r},fc.prototype.Ba=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},fc.prototype.zu=function(t,e){return Er()<=p.DEBUG&&Ir("IndexFreeQueryEngine","Using full collection scan to execute query:",Ks(e)),this.Ku.Zn(t,e,Hr.min())},fc),ac=(lc.prototype.Ju=function(t){return Su.resolve(0===this.Qn.length)},lc.prototype.qi=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Qn.length&&this.Qn[this.Qn.length-1];var o=new Tu(i,e,n,r);this.Qn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xu=this.Xu.add(new oa(a.key,i)),this.Wn.Cs(t,a.key.path.g())}return Su.resolve(o)},lc.prototype.zi=function(t,e){return Su.resolve(this.Zu(e))},lc.prototype.wr=function(t,e){var n=e+1,r=this.tc(n),i=r<0?0:r;return Su.resolve(this.Qn.length>i?this.Qn[i]:null)},lc.prototype.Yi=function(){return Su.resolve(0===this.Qn.length?-1:this.Yu-1)},lc.prototype.ki=function(t){return Su.resolve(this.Qn.slice())},lc.prototype.Gn=function(t,e){var n=this,r=new oa(e,0),i=new oa(e,Number.POSITIVE_INFINITY),o=[];return this.Xu.bt([r,i],function(t){var e=n.Zu(t.Lr);o.push(e)}),Su.resolve(o)},lc.prototype.Jn=function(t,e){var r=this,i=new Ri(Dr);return e.forEach(function(t){var e=new oa(t,0),n=new oa(t,Number.POSITIVE_INFINITY);r.Xu.bt([e,n],function(t){i=i.add(t.Lr)})}),Su.resolve(this.ec(i))},lc.prototype.rs=function(t,e){var n=e.path,r=n.length+1,i=n;Zr.W(i)||(i=i.child(""));var o=new oa(new Zr(i),0),s=new Ri(Dr);return this.Xu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.Lr)),!0)},o),Su.resolve(this.ec(s))},lc.prototype.ec=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Zu(t);null!==e&&r.push(e)}),r},lc.prototype.Hi=function(n,r){var i=this;_r(0===this.nc(r.batchId,"removed")),this.Qn.shift();var o=this.Xu;return Su.forEach(r.mutations,function(t){var e=new oa(t.key,r.batchId);return o=o.delete(e),i.hr.sc(n,t.key)}).next(function(){i.Xu=o})},lc.prototype.ic=function(t){},lc.prototype.Or=function(t,e){var n=new oa(e,0),r=this.Xu.Ct(n);return Su.resolve(e.isEqual(r&&r.key))},lc.prototype.Gi=function(t){return this.Qn.length,Su.resolve()},lc.prototype.nc=function(t,e){return this.tc(t)},lc.prototype.tc=function(t){return 0===this.Qn.length?0:t-this.Qn[0].batchId},lc.prototype.Zu=function(t){var e=this.tc(t);return e<0||e>=this.Qn.length?null:this.Qn[e]},lc),hc=(cc.prototype.rr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rc(e);return this.docs=this.docs.nt(r,{oc:e,size:s,readTime:n}),this.size+=s-o,this.Wn.Cs(t,r.path.g())},cc.prototype.ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},cc.prototype.zn=function(t,e){var n=this.docs.get(e);return Su.resolve(n?n.oc:null)},cc.prototype.getEntries=function(t,e){var n=this,r=Di;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.oc:null)}),Su.resolve(r)},cc.prototype.Zn=function(t,e,n){for(var r=ki,i=new Zr(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.oc,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Gs&&$s(e,h)&&(r=r.nt(h.key,h))}return Su.resolve(r)},cc.prototype.hc=function(t,e){return Su.forEach(this.docs,function(t){return e(t)})},cc.prototype.Qi=function(t){return new cc.ac(this)},cc.prototype.uc=function(t){return Su.resolve(this.size)},cc);function cc(t,e){this.Wn=t,this.rc=e,this.docs=new Ei(Zr.P),this.size=0}function lc(t,e){this.Wn=t,this.hr=e,this.Qn=[],this.Yu=1,this.Xu=new Ri(oa.br)}function fc(){}function pc(t,e,n){this.query=t,this.qu=e,this.Bu=!1,this.Uu=null,this.onlineState="Unknown",this.options=n||{}}function dc(t){this.ta=t,this.Nu=new Fr(Js,Zs),this.onlineState="Unknown",this.ku=new Set,this.ta.subscribe(this)}function yc(t,e,n,r,i,o){this.gh=t,this.nu=e,this.hh=n,this.su=r,this.currentUser=i,this.iu=o,this.ru=null,this.ou=new Fr(Js,Zs),this.hu=new Map,this.au=[],this.uu=new Ei(Zr.P),this.cu=new Map,this.lu=new ia,this._u={},this.fu=new Map,this.du=Fu.$s(),this.onlineState="Unknown"}function vc(t,e,n,r){this.Ns=t,this.hh=e,this.updateFunction=n,this.Os=r,this.Ya=5,this.Hs=new xu(this.Ns,"transaction_retry")}function gc(t,e){this.query=t,this.Fa=e,this.$a=null,this.Ht=!1,this.Na=Ci(),this.Mt=Ci(),this.ka=tu(t),this.xa=new Fi(this.ka)}function mc(){this.Aa=new tc,this.Ra={},this.ta=null,this.Eh=null,this.cs=null}function wc(){this.activeTargetIds=Mi}function bc(t,e,n,r,i){var o,s,u,a,h,c,l=this;this.gh=t,this.hh=e,this.Ns=n,this.vh=[],this.bh=new Map,this.Sh=null,this.Ch=new Set,this.Dh=i,this.Dh.Fh(function(t){n.Bs(function(){return f(l,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.$h()?(Ir("RemoteStore","Restarting streams for network reachability change."),[4,this.Nh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.kh=new Kh(n,r),this.xh=(a=this.hh,h=n,c={Go:this.Oh.bind(this),Bo:this.Lh.bind(this),zo:this.Mh.bind(this)},new Xh(h,a.bo,a.credentials,a.serializer,c)),this.qh=(o=this.hh,s=n,u={Go:this.Bh.bind(this),Bo:this.Uh.bind(this),eh:this.Qh.bind(this),th:this.th.bind(this)},new Yh(s,o.bo,o.credentials,o.serializer,u))}function Ec(t,e){this.Ns=t,this.Eh=e,this.state="Unknown",this.mh=0,this.Ih=null,this.Ah=!0}function Ic(t){this.hh=t,this.ah=new Map,this.mutations=[],this.uh=!1,this.lh=null,this._h=new Set}function Ac(t,e,n){var r=this;return(r=jh.call(this)||this).bo=t,r.credentials=e,r.serializer=n,r.sh=!1,r}function Nc(t,e,n,r,i){var o=this;return(o=qh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Xo=!1,o}function Tc(t,e,n,r,i){var o=this;return(o=Fh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function _c(t,e,n,r,i,o){this.ws=t,this.vo=n,this.bo=r,this.So=i,this.listener=o,this.state=0,this.Co=0,this.Do=null,this.stream=null,this.Hs=new xu(t,e)}function Sc(t,e){this.Vo=t,this.yo=e}function Rc(t,e){this.Vo=t,this.yo=e,this.type="FirstParty",this.user=Ph.fo}function Lc(t){var e=this;this.Io=null,this.currentUser=Ph.UNAUTHENTICATED,this.Ao=!1,this.Ro=0,this.wo=null,this.forceRefresh=!1,this.Io=function(){e.Ro++,e.currentUser=e.Po(),e.Ao=!0,e.wo&&e.wo(e.currentUser)},this.Ro=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Io):(this.Io(null),t.get().then(function(t){e.auth=t,e.Io&&e.auth.addAuthTokenListener(e.Io)},function(){}))}function Dc(){this.wo=null}function Pc(t){var e=this;return(e=Gh.call(this)||this).wc=t,e}function Oc(){this.Bi=new Fr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.cc=!1}hc.ac=(Object.defineProperty(Oc.prototype,"readTime",{get:function(){return this.lc},set:function(t){this.lc=t},enumerable:!1,configurable:!0}),Oc.prototype.rr=function(t,e){this._c(),this.readTime=e,this.Bi.set(t.key,t)},Oc.prototype.ir=function(t,e){this._c(),e&&(this.readTime=e),this.Bi.set(t,null)},Oc.prototype.zn=function(t,e){this._c();var n=this.Bi.get(e);return void 0!==n?Su.resolve(n):this.fc(t,e)},Oc.prototype.getEntries=function(t,e){return this.dc(t,e)},Oc.prototype.apply=function(t){return this._c(),this.cc=!0,this.Ua(t)},Oc.prototype._c=function(){},n(Pc,Gh=Oc),Pc.prototype.Ua=function(n){var r=this,i=[];return this.Bi.forEach(function(t,e){e?i.push(r.wc.rr(n,e,r.readTime)):r.wc.ir(t)}),Su.qn(i)},Pc.prototype.fc=function(t,e){return this.wc.zn(t,e)},Pc.prototype.dc=function(t,e){return this.wc.getEntries(t,e)},Pc);var kc,Uc=(ol.prototype.ge=function(t,n){return this.Tc.forEach(function(t,e){return n(e)}),Su.resolve()},ol.prototype.Xi=function(t){return Su.resolve(this.lastRemoteSnapshotVersion)},ol.prototype.Ac=function(t){return Su.resolve(this.Ec)},ol.prototype.Ir=function(t){return this.highestTargetId=this.Ic.next(),Su.resolve(this.highestTargetId)},ol.prototype.ar=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ec&&(this.Ec=e),Su.resolve()},ol.prototype.Rc=function(t){this.Tc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ic=new Fu(e),this.highestTargetId=e),t.sequenceNumber>this.Ec&&(this.Ec=t.sequenceNumber)},ol.prototype.Ar=function(t,e){return this.Rc(e),this.targetCount+=1,Su.resolve()},ol.prototype.sr=function(t,e){return this.Rc(e),Su.resolve()},ol.prototype.Pc=function(t,e){return this.Tc.delete(e.target),this.mc.Nr(e.targetId),--this.targetCount,Su.resolve()},ol.prototype.Vc=function(n,r,i){var o=this,s=0,u=[];return this.Tc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Tc.delete(t),u.push(o.yc(n,e.targetId)),s++)}),Su.qn(u).next(function(){return s})},ol.prototype.pc=function(t){return Su.resolve(this.targetCount)},ol.prototype.mr=function(t,e){var n=this.Tc.get(e)||null;return Su.resolve(n)},ol.prototype.tr=function(t,e,n){return this.mc.Dr(e,n),Su.resolve()},ol.prototype.Zi=function(e,t,n){this.mc.$r(t,n);var r=this.persistence.hr,i=[];return r&&t.forEach(function(t){i.push(r.sc(e,t))}),Su.qn(i)},ol.prototype.yc=function(t,e){return this.mc.Nr(e),Su.resolve()},ol.prototype.Vr=function(t,e){var n=this.mc.xr(e);return Su.resolve(n)},ol.prototype.Or=function(t,e){return Su.resolve(this.mc.Or(e))},ol),Vc=(il.prototype.start=function(){return Promise.resolve()},il.prototype.Yh=function(){return this.bc=!1,Promise.resolve()},Object.defineProperty(il.prototype,"Cc",{get:function(){return this.bc},enumerable:!1,configurable:!0}),il.prototype.Dc=function(){},il.prototype.Fi=function(){return this.Wn},il.prototype.gi=function(t){var e=this.gc[t.lo()];return e||(e=new ac(this.Wn,this.hr),this.gc[t.lo()]=e),e},il.prototype.Ci=function(){return this.Si},il.prototype.bi=function(){return this.Un},il.prototype.runTransaction=function(t,e,n){var r=this;Ir("MemoryPersistence","Starting transaction:",t);var i=new Cc(this.vc.next());return this.hr.Fc(),n(i).next(function(t){return r.hr.$c(i).next(function(){return t})}).Ln().then(function(t){return i.Nc(),t})},il.prototype.kc=function(e,n){return Su.Bn(Object.values(this.gc).map(function(t){return function(){return t.Or(e,n)}}))},il),Cc=(rl.prototype.Oc=function(t){this.xc.push(t)},rl.prototype.Nc=function(){this.xc.forEach(function(t){return t()})},n(nl,kc=rl),nl),Mc=(el.qc=function(t){return new el(t)},Object.defineProperty(el.prototype,"Bc",{get:function(){if(this.Mc)return this.Mc;throw Tr()},enumerable:!1,configurable:!0}),el.prototype.lr=function(t,e,n){return this.Lc.lr(n,e),this.Bc.delete(n),Su.resolve()},el.prototype._r=function(t,e,n){return this.Lc._r(n,e),this.Bc.add(n),Su.resolve()},el.prototype.sc=function(t,e){return this.Bc.add(e),Su.resolve()},el.prototype.removeTarget=function(t,e){var n=this;this.Lc.Nr(e.targetId).forEach(function(t){return n.Bc.add(t)});var r=this.persistence.Ci();return r.Vr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Bc.add(t)})}).next(function(){return r.Pc(t,e)})},el.prototype.Fc=function(){this.Mc=new Set},el.prototype.$c=function(t){var n=this,r=this.persistence.bi().Qi();return Su.forEach(this.Bc,function(e){return n.Uc(t,e).next(function(t){t||r.ir(e)})}).next(function(){return n.Mc=null,r.apply(t)})},el.prototype.or=function(t,e){var n=this;return this.Uc(t,e).next(function(t){t?n.Bc.delete(e):n.Bc.add(e)})},el.prototype.Sc=function(t){return 0},el.prototype.Uc=function(t,e){var n=this;return Su.Bn([function(){return Su.resolve(n.Lc.Or(e))},function(){return n.persistence.Ci().Or(t,e)},function(){return n.persistence.kc(t,e)}])},el),xc=(tl.prototype.Go=function(t){this.jc=t},tl.prototype.Bo=function(t){this.Gc=t},tl.prototype.onMessage=function(t){this.Kc=t},tl.prototype.close=function(){this.Wc()},tl.prototype.send=function(t){this.Qc(t)},tl.prototype.zc=function(){this.jc()},tl.prototype.Hc=function(t){this.Gc(t)},tl.prototype.Yc=function(t){this.Kc(t)},tl),jc={BatchGetDocuments:"batchGet",Commit:"commit"},qc="gl-js/ fire/"+wr,Fc=($c.prototype.Jc=function(t,e){if(e)for(var n in e.do)e.do.hasOwnProperty(n)&&(t[n]=e.do[n]);t["X-Goog-Api-Client"]=qc},$c.prototype.rh=function(a,r,i){var h=this,c=this.Zc(a);return new Promise(function(o,s){var u=new vr;u.listenOnce(dr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case pr.NO_ERROR:var t=u.getResponseJson();Ir("Connection","XHR received:",JSON.stringify(t)),o(t);break;case pr.TIMEOUT:Ir("Connection",'RPC "'+a+'" timed out'),s(new Br(Gr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e,n,r=u.getStatus();Ir("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Gr).indexOf(i)?i:Gr.UNKNOWN,s(new Br(n,e.message))):s(new Br(Gr.UNKNOWN,"Server responded with status "+u.getStatus())):(Ir("Connection",'RPC "'+a+'" failed'),s(new Br(Gr.UNAVAILABLE,"Connection failed.")));break;default:Tr()}}finally{Ir("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Ir("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Jc(n,i),u.send(c,"POST",e,n,15)})},$c.prototype.oh=function(t,e,n){return this.rh(t,e,n)},$c.prototype.Ko=function(t,e){var n,r,i=[this.Xc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=fr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Jc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Ir("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new xc({Qc:function(t){l?Ir("Connection","Not sending because WebChannel is closed:",t):(c||(Ir("Connection","Opening WebChannel transport."),h.open(),c=!0),Ir("Connection","WebChannel sending:",t),h.send(t))},Wc:function(){return h.close()}});return a(yr.EventType.OPEN,function(){l||Ir("Connection","WebChannel transport opened.")}),a(yr.EventType.CLOSE,function(){l||(l=!0,Ir("Connection","WebChannel transport closed"),f.Hc())}),a(yr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.WARN&&(e=n.map(Nr),br.warn.apply(br,y(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.Hc(new Br(Gr.UNAVAILABLE,"The operation could not be completed")))}),a(yr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(_r(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Ir("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=yi[i];if(void 0!==t)return bi(t)}(),s=r.message,void 0===o&&(o=Gr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.Hc(new Br(o,s)),h.close()):(Ir("Connection","WebChannel received:",n),f.Yc(n)))}),setTimeout(function(){f.zc()},0),f},$c.prototype.Zc=function(t){var e=jc[t];return this.Xc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},$c),Gc=(Kc.prototype.Fh=function(t){this.il.push(t)},Kc.prototype.Yh=function(){window.removeEventListener("online",this.tl),window.removeEventListener("offline",this.nl)},Kc.prototype.rl=function(){window.addEventListener("online",this.tl),window.addEventListener("offline",this.nl)},Kc.prototype.el=function(){Ir("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.il;t<e.length;t++)(0,e[t])(0)},Kc.prototype.sl=function(){Ir("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.il;t<e.length;t++)(0,e[t])(1)},Kc.ol=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Kc),Bc=(Jc.prototype.Fh=function(t){},Jc.prototype.Yh=function(){},Jc),zc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Hc=(Zc.prototype.initialize=function(n){return f(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:return this.su=this.hl(n),this.persistence=this.al(n),[4,this.persistence.start()];case 1:return t.sent(),this.ul=this.cl(n),this.gh=this.ll(n),this.nu=this._l(n),this.ta=this.fl(n),this.dl=this.wl(n),this.su.Eh=function(t){return e.ta.Ga(t,1)},this.nu.ta=this.ta,[4,this.gh.start()];case 2:return t.sent(),[4,this.su.start()];case 3:return t.sent(),[4,this.nu.start()];case 4:return t.sent(),[4,this.nu.Ta(this.ta.wu)];case 5:return t.sent(),[2]}})})},Zc.prototype.wl=function(t){return new oc(this.ta)},Zc.prototype.cl=function(t){return null},Zc.prototype.ll=function(t){return e=this.persistence,n=new uc,r=t.Tl,new ea(e,n,r);var e,n,r},Zc.prototype.al=function(t){if(t.ml.El)throw new Br(Gr.FAILED_PRECONDITION,zc);return new Vc(Mc.qc)},Zc.prototype._l=function(t){var e=this;return new $h(this.gh,t.hh,t.Ns,function(t){return e.ta.Ga(t,0)},new(Gc.ol()?Gc:Bc))},Zc.prototype.hl=function(t){return new ec},Zc.prototype.fl=function(t){return e=this.gh,n=this.nu,r=t.hh,i=this.su,o=t.Tl,s=t.iu,new ic(e,n,r,i,o,s);var e,n,r,i,o,s},Zc.prototype.clearPersistence=function(t){throw new Br(Gr.FAILED_PRECONDITION,zc)},Zc),Wc=(Yc.prototype.start=function(t,e,n){var r=this;this.ih(),this.Il=t;var i=new Mu,o=new Mu,s=!1;return this.credentials.Eo(function(t){if(!s)return s=!0,Ir("FirestoreClient","Initializing. user=",t.uid),r.Al(e,n,t,o).then(i.resolve,i.reject);r.Ns.si(function(){return r.nu.wa(t)})}),this.Ns.Bs(function(){return i.promise}),o.promise},Yc.prototype.enableNetwork=function(){var t=this;return this.ih(),this.Ns.enqueue(function(){return t.ta.enableNetwork()})},Yc.prototype.Al=function(a,h,c,l){return f(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(s=this.Il,Promise.resolve(new Fc(s)))];case 1:return n=t.sent(),r=uh(this.Il.s),e=this.credentials,i=new Zh(n,e,r),[4,a.initialize({Ns:this.Ns,Il:this.Il,hh:i,clientId:this.clientId,Tl:c,iu:100,ml:h})];case 2:return t.sent(),this.persistence=a.persistence,this.su=a.su,this.gh=a.gh,this.nu=a.nu,this.ta=a.ta,this.ul=a.ul,this.Rl=a.dl,this.persistence.Dc(function(){return f(u,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),l.resolve(),[3,4];case 3:if(o=t.sent(),l.reject(o),!this.Pl(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.Al(new Hc,{El:!1},c,l))];case 4:return[2]}var e})})},Yc.prototype.Pl=function(t){return"FirebaseError"===t.name?t.code===Gr.FAILED_PRECONDITION||t.code===Gr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Yc.prototype.ih=function(){if(this.Ns.Xs)throw new Br(Gr.FAILED_PRECONDITION,"The client has already been terminated.")},Yc.prototype.disableNetwork=function(){var t=this;return this.ih(),this.Ns.enqueue(function(){return t.ta.disableNetwork()})},Yc.prototype.terminate=function(){var t=this;return this.Ns.ni(function(){return f(t,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.ul&&this.ul.stop(),[4,this.nu.Yh()];case 1:return t.sent(),[4,this.su.Yh()];case 2:return t.sent(),[4,this.persistence.Yh()];case 3:return t.sent(),this.credentials.mo(),[2]}})})})},Yc.prototype.waitForPendingWrites=function(){var t=this;this.ih();var e=new Mu;return this.Ns.Bs(function(){return t.ta.gu(e)}),e.promise},Yc.prototype.listen=function(t,e,n){var r=this;this.ih();var i=new sc(t,e,n);return this.Ns.Bs(function(){return r.Rl.listen(i)}),i},Yc.prototype.Jh=function(t){var e=this;this.Vl||this.Ns.Bs(function(){return e.Rl.Jh(t)})},Yc.prototype.yl=function(o){return f(this,void 0,void 0,function(){var i,e=this;return d(this,function(t){switch(t.label){case 0:return this.ih(),i=new Mu,[4,this.Ns.enqueue(function(){return f(e,void 0,void 0,function(){var e,n,r;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.gh.Tr(o)];case 1:return(e=t.sent())instanceof Gs?i.resolve(e):e instanceof Bs?i.resolve(null):i.reject(new Br(Gr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Ku(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Yc.prototype.pl=function(a){return f(this,void 0,void 0,function(){var u,e=this;return d(this,function(t){switch(t.label){case 0:return this.ih(),u=new Mu,[4,this.Ns.enqueue(function(){return f(e,void 0,void 0,function(){var e,n,r,i,o,s;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.gh.Pr(a,!0)];case 1:return e=t.sent(),n=new nc(a,e.yr),r=n.La(e.documents),i=n.Ua(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ku(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Yc.prototype.write=function(t){var e=this;this.ih();var n=new Mu;return this.Ns.Bs(function(){return e.ta.write(t,n)}),n.promise},Yc.prototype.s=function(){return this.Il.s},Yc.prototype.Lu=function(t){var e=this;this.ih(),this.Ns.Bs(function(){return e.Rl.Lu(t),Promise.resolve()})},Yc.prototype.Mu=function(t){var e=this;this.Vl||this.Ns.Bs(function(){return e.Rl.Mu(t),Promise.resolve()})},Object.defineProperty(Yc.prototype,"Vl",{get:function(){return this.Ns.Xs},enumerable:!1,configurable:!0}),Yc.prototype.transaction=function(t){var e=this;this.ih();var n=new Mu;return this.Ns.Bs(function(){return e.ta.runTransaction(e.Ns,t,n),Promise.resolve()}),n.promise},Yc),Qc=(Xc.prototype.next=function(t){this.gl(this.observer.next,t)},Xc.prototype.error=function(t){this.gl(this.observer.error,t)},Xc.prototype.vl=function(){this.muted=!0},Xc.prototype.gl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Xc);function Xc(t){this.observer=t,this.muted=!1}function Yc(t,e){this.credentials=t,this.Ns=e,this.clientId=Rr.t()}function Zc(){}function Jc(){}function Kc(){var t=this;this.tl=function(){return t.el()},this.nl=function(){return t.sl()},this.il=[],this.rl()}function $c(t){this.s=t.s;var e=t.ssl?"https":"http";this.Xc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function tl(t){this.Qc=t.Qc,this.Wc=t.Wc}function el(t){this.persistence=t,this.Lc=new ia,this.Mc=null}function nl(t){var e=this;return(e=kc.call(this)||this).er=t,e}function rl(){this.xc=[]}function il(t){var e=this;this.gc={},this.vc=new Du(0),this.bc=!1,this.bc=!0,this.hr=t(this),this.Si=new Uc(this),this.Wn=new ju,this.Un=new hc(this.Wn,function(t){return e.hr.Sc(t)})}function ol(t){this.persistence=t,this.Tc=new Fr(hi,ci),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this.Ec=0,this.mc=new ia,this.targetCount=0,this.Ic=Fu.Fs()}function sl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ul=(pl.prototype.Cl=function(t){switch(so(t)){case 0:return null;case 1:return t.booleanValue;case 2:return po(t.integerValue||t.doubleValue);case 3:return this.Dl(t.timestampValue);case 4:return this.Fl(t);case 5:return t.stringValue;case 6:return new Pa(yo(t.bytesValue));case 7:return this.$l(t.referenceValue);case 8:return this.Nl(t.geoPointValue);case 9:return this.kl(t.arrayValue);case 10:return this.xl(t.mapValue);default:throw Tr()}},pl.prototype.xl=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.Cl(e)}),r},pl.prototype.Nl=function(t){return new $a(po(t.latitude),po(t.longitude))},pl.prototype.kl=function(t){var e=this;return(t.values||[]).map(function(t){return e.Cl(t)})},pl.prototype.Fl=function(t){switch(this.bl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ro(n)?t(n):n}(t);return null==e?null:this.Cl(e);case"estimate":return this.Dl(io(t));default:return null}},pl.prototype.Dl=function(t){var e=fo(t),n=new zr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},pl.prototype.$l=function(t){var e=Qr.N(t);_r(qo(e));var n=new kr(e.get(1),e.get(3)),r=new Zr(e.p(5));return n.isEqual(this.s)||Ar("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Sl(r)},pl),al=$u.Ei,hl=(fl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},fl),cl=(Object.defineProperty(ll.prototype,"Gl",{get:function(){return this.Kl||(this.Kl=new vh(this.Jr,this.jl.ignoreUndefinedProperties)),this.Kl},enumerable:!1,configurable:!0}),ll.prototype.settings=function(t){ha("Firestore.settings",arguments,1),fa("Firestore.settings","object",1,t);var e=new hl(t);if(this.ql&&!this.jl.isEqual(e))throw new Br(Gr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.jl=e).credentials&&(this.Ql=function(t){if(!t)return new Bh;switch(t.type){case"gapi":var e=t.zl;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wh(e,t.yo||"0");case"provider":return t.zl;default:throw new Br(Gr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},ll.prototype.enableNetwork=function(){return this.Ml(),this.ql.enableNetwork()},ll.prototype.disableNetwork=function(){return this.Ml(),this.ql.disableNetwork()},ll.prototype.enablePersistence=function(t){var e,n;if(this.ql)throw new Br(Gr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Ar("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Br(Gr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hl(this.Wl,{El:!0,cacheSizeBytes:this.jl.cacheSizeBytes,synchronizeTabs:r,Yl:i})},ll.prototype.clearPersistence=function(){return f(this,void 0,void 0,function(){var r,e=this;return d(this,function(t){if(void 0!==this.ql&&!this.ql.Vl)throw new Br(Gr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return r=new Mu,[2,(this.Ll.Js(function(){return f(e,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.Xl(),[4,this.Wl.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},ll.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(ll.prototype,"Jl",{get:function(){return this.Ml(),this.ql.Vl},enumerable:!1,configurable:!0}),ll.prototype.waitForPendingWrites=function(){return this.Ml(),this.ql.waitForPendingWrites()},ll.prototype.onSnapshotsInSync=function(t){if(this.Ml(),sl(t))return dl(this.ql,t);fa("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return dl(this.ql,e)},ll.prototype.Ml=function(){return this.ql||this.Hl(new Hc,{El:!1}),this.ql},ll.prototype.Xl=function(){return new Or(this.Jr,this.Ul,this.jl.host,this.jl.ssl,this.jl.forceLongPolling)},ll.prototype.Hl=function(t,e){var n=this.Xl();return this.ql=new Wc(this.Ql,this.Ll),this.ql.start(n,t,e)},ll.Bl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Br(Gr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Br(Gr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new kr(n)},Object.defineProperty(ll.prototype,"app",{get:function(){if(!this.Ol)throw new Br(Gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ol},enumerable:!1,configurable:!0}),ll.prototype.collection=function(t){return ha("Firestore.collection",arguments,1),fa("Firestore.collection","non-empty string",1,t),this.Ml(),new xl(Qr.N(t),this,null)},ll.prototype.doc=function(t){return ha("Firestore.doc",arguments,1),fa("Firestore.doc","non-empty string",1,t),this.Ml(),ml.Zl(Qr.N(t),this,null)},ll.prototype.collectionGroup=function(t){if(ha("Firestore.collectionGroup",arguments,1),fa("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ml(),new Ol(new Hs(Qr.k(),t),this,null)},ll.prototype.runTransaction=function(e){var n=this;return ha("Firestore.runTransaction",arguments,1),fa("Firestore.runTransaction","function",1,e),this.Ml().transaction(function(t){return e(new vl(n,t))})},ll.prototype.batch=function(){return this.Ml(),new gl(this)},Object.defineProperty(ll,"logLevel",{get:function(){switch(Er()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),ll.setLogLevel=function(t){ha("Firestore.setLogLevel",arguments,1),ga("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),br.setLogLevel(t)},ll.prototype.t_=function(){return this.jl.timestampsInSnapshots},ll);function ll(t,e,n){var r=this;if(void 0===n&&(n=new Hc),this.Ol=null,this.Ll=new Yu,this.INTERNAL={delete:function(){return f(r,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.Ml(),[4,this.ql.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Ol=i,this.Jr=ll.Bl(i),this.Ul=i.name,this.Ql=new zh(e)}else{var o=t;if(!o.projectId)throw new Br(Gr.INVALID_ARGUMENT,"Must provide projectId");this.Jr=new kr(o.projectId,o.database),this.Ul="[DEFAULT]",this.Ql=new Bh}this.Wl=n,this.jl=new hl({})}function fl(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(Gr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else da("settings","non-empty string","host",t.host),this.host=t.host,ya("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ia("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ya("settings","object","credentials",t.credentials),this.credentials=t.credentials,ya("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ya("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Ar("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Ar("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ya("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=$u.Ii;else{if(t.cacheSizeBytes!==al&&t.cacheSizeBytes<$u.mi)throw new Br(Gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+$u.mi);this.cacheSizeBytes=t.cacheSizeBytes}ya("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function pl(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.bl=n,this.Sl=r}function dl(t,e){var n=new Qc({next:function(){e.next&&e.next()},error:function(t){throw Tr()}});return t.Lu(n),function(){n.vl(),t.Mu(n)}}var yl,vl=(El.prototype.get=function(t){var n=this;ha("Transaction.get",arguments,1);var r=zl("Transaction.get",t,this.e_);return this.n_.fh([r.Zr]).then(function(t){if(!t||1!==t.length)return Tr();var e=t[0];if(e instanceof Bs)return new Tl(n.e_,r.Zr,null,!1,!1,r.to);if(e instanceof Gs)return new Tl(n.e_,r.Zr,e,!1,!1,r.to);throw Tr()})},El.prototype.set=function(t,e,n){la("Transaction.set",arguments,2,3);var r=zl("Transaction.set",t,this.e_);n=Fl("Transaction.set",n);var i=Hl(r.to,e,n),o=wh(this.e_.Gl,"Transaction.set",r.Zr,i,null!==r.to,n);return this.n_.set(r.Zr,o),this},El.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ka?(ca("Transaction.update",arguments,3),r=zl("Transaction.update",t,this.e_),Eh(this.e_.Gl,"Transaction.update",r.Zr,e,n,o)):(ha("Transaction.update",arguments,2),r=zl("Transaction.update",t,this.e_),bh(this.e_.Gl,"Transaction.update",r.Zr,e)),this.n_.update(r.Zr,i),this},El.prototype.delete=function(t){ha("Transaction.delete",arguments,1);var e=zl("Transaction.delete",t,this.e_);return this.n_.delete(e.Zr),this},El),gl=(bl.prototype.set=function(t,e,n){la("WriteBatch.set",arguments,2,3),this.r_();var r=zl("WriteBatch.set",t,this.e_);n=Fl("WriteBatch.set",n);var i=Hl(r.to,e,n),o=wh(this.e_.Gl,"WriteBatch.set",r.Zr,i,null!==r.to,n);return this.s_=this.s_.concat(o.eo(r.Zr,hs.je())),this},bl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.r_(),i="string"==typeof e||e instanceof ka?(ca("WriteBatch.update",arguments,3),r=zl("WriteBatch.update",t,this.e_),Eh(this.e_.Gl,"WriteBatch.update",r.Zr,e,n,o)):(ha("WriteBatch.update",arguments,2),r=zl("WriteBatch.update",t,this.e_),bh(this.e_.Gl,"WriteBatch.update",r.Zr,e)),this.s_=this.s_.concat(i.eo(r.Zr,hs.exists(!0))),this},bl.prototype.delete=function(t){ha("WriteBatch.delete",arguments,1),this.r_();var e=zl("WriteBatch.delete",t,this.e_);return this.s_=this.s_.concat(new Ls(e.Zr,hs.je())),this},bl.prototype.commit=function(){return this.r_(),this.i_=!0,0<this.s_.length?this.e_.Ml().write(this.s_):Promise.resolve()},bl.prototype.r_=function(){if(this.i_)throw new Br(Gr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},bl),ml=(n(wl,yl=hh),wl.Zl=function(t,e,n){if(t.length%2!=0)throw new Br(Gr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new wl(new Zr(t),e,n)},Object.defineProperty(wl.prototype,"id",{get:function(){return this.Zr.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(wl.prototype,"parent",{get:function(){return new xl(this.Zr.path.g(),this.firestore,this.to)},enumerable:!1,configurable:!0}),Object.defineProperty(wl.prototype,"path",{get:function(){return this.Zr.path.$()},enumerable:!1,configurable:!0}),wl.prototype.collection=function(t){if(ha("DocumentReference.collection",arguments,1),fa("DocumentReference.collection","non-empty string",1,t),!t)throw new Br(Gr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Qr.N(t);return new xl(this.Zr.path.child(e),this.firestore,null)},wl.prototype.isEqual=function(t){if(!(t instanceof wl))throw Aa("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Zr.isEqual(t.Zr)&&this.to===t.to},wl.prototype.set=function(t,e){la("DocumentReference.set",arguments,1,2),e=Fl("DocumentReference.set",e);var n=Hl(this.to,t,e),r=wh(this.firestore.Gl,"DocumentReference.set",this.Zr,n,null!==this.to,e);return this.ql.write(r.eo(this.Zr,hs.je()))},wl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ka?(ca("DocumentReference.update",arguments,2),Eh(this.firestore.Gl,"DocumentReference.update",this.Zr,t,e,r)):(ha("DocumentReference.update",arguments,1),bh(this.firestore.Gl,"DocumentReference.update",this.Zr,t)),this.ql.write(n.eo(this.Zr,hs.exists(!0)))},wl.prototype.delete=function(){return ha("DocumentReference.delete",arguments,0),this.ql.write([new Ls(this.Zr,hs.je())])},wl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];la("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||sl(i[u])||(Ia("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),ya("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};sl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(fa("DocumentReference.onSnapshot","function",u,i[u]),pa("DocumentReference.onSnapshot","function",u+1,i[u+1]),pa("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.o_(t))},error:i[u+1],complete:i[u+2]};return Il(this.ql,this.Zr,h,c)},wl.prototype.get=function(t){var e,n,r,i,o,s=this;return la("DocumentReference.get",arguments,0,1),Bl("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.Ml().yl(this.Zr).then(function(t){return new Tl(s.firestore,s.Zr,t,!0,t instanceof Gs&&t.Ge,s.to)}):(e=this.ql,n=this.Zr,r=t,i=new Mu,o=Il(e,n,{includeMetadataChanges:!0,Gu:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Br(Gr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Br(Gr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.o_(t)}))},wl.prototype.withConverter=function(t){return new wl(this.Zr,this.firestore,t)},wl.prototype.o_=function(t){var e=t.docs.get(this.Zr);return new Tl(this.firestore,this.Zr,e,t.fromCache,t.hasPendingWrites,this.to)},wl);function wl(t,e,n){var r=this;return(r=yl.call(this,e.Jr,t,n)||this).Zr=t,r.firestore=e,r.to=n,r.ql=r.firestore.Ml(),r}function bl(t){this.e_=t,this.s_=[],this.i_=!1}function El(t,e){this.e_=t,this.n_=e}function Il(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Qc({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(Hs.on(e.path),o,n);return function(){o.vl(),t.Jh(s)}}var Al,Nl=(Ll.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ll),Tl=(Rl.prototype.data=function(t){var e=this;if(la("DocumentSnapshot.data",arguments,0,1),t=Gl("DocumentSnapshot.data",t),this.h_){if(this.to){var n=new _l(this.e_,this.Zr,this.h_,this.a_,this.u_,null);return this.to.fromFirestore(n,t)}return new ul(this.e_.Jr,this.e_.t_(),t.serverTimestamps||"none",function(t){return new ml(t,e.e_,null)}).Cl(this.h_.Ze())}},Rl.prototype.get=function(t,e){var n=this;if(la("DocumentSnapshot.get",arguments,1,2),e=Gl("DocumentSnapshot.get",e),this.h_){var r=this.h_.data().field(Sh("DocumentSnapshot.get",t,this.Zr));if(null!==r)return new ul(this.e_.Jr,this.e_.t_(),e.serverTimestamps||"none",function(t){return new ml(t,n.e_,n.to)}).Cl(r)}},Object.defineProperty(Rl.prototype,"id",{get:function(){return this.Zr.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Rl.prototype,"ref",{get:function(){return new ml(this.Zr,this.e_,this.to)},enumerable:!1,configurable:!0}),Object.defineProperty(Rl.prototype,"exists",{get:function(){return null!==this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(Rl.prototype,"metadata",{get:function(){return new Nl(this.u_,this.a_)},enumerable:!1,configurable:!0}),Rl.prototype.isEqual=function(t){if(!(t instanceof Rl))throw Aa("isEqual","DocumentSnapshot",1,t);return this.e_===t.e_&&this.a_===t.a_&&this.Zr.isEqual(t.Zr)&&(null===this.h_?null===t.h_:this.h_.isEqual(t.h_))&&this.to===t.to},Rl),_l=(n(Sl,Al=Tl),Sl.prototype.data=function(t){return Al.prototype.data.call(this,t)},Sl);function Sl(){return null!==Al&&Al.apply(this,arguments)||this}function Rl(t,e,n,r,i,o){this.e_=t,this.Zr=e,this.h_=n,this.a_=r,this.u_=i,this.to=o}function Ll(t,e){this.hasPendingWrites=t,this.fromCache=e}function Dl(t){if(t.mn()&&0===t.tn.length)throw new Br(Gr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Pl,Ol=(Ul.prototype.l_=function(t,e,n){var r;if(t.L()){if("array-contains"===e||"array-contains-any"===e)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.__(n,e);for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];i.push(this.f_(u))}r={arrayValue:{values:i}}}else r=this.f_(n)}else"in"!==e&&"array-contains-any"!==e||this.__(n,e),r=Ih(this.Gl,"Query.where",n,"in"===e);var a=nu.create(t,e,r);return this.d_(a),a},Ul.prototype.w_=function(t,e){if(null!==this.c_.startAt)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.c_.endAt)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new Au(t,e);return this.T_(n),n},Ul.prototype.E_=function(t,e,n){if(!e)throw new Br(Gr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var r=[],i=0,o=this.c_.orderBy;i<o.length;i++){var s=o[i];if(s.field.L())r.push(vo(this.Jr,e.key));else{var u=e.field(s.field);if(ro(u))throw new Br(Gr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.$();throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}r.push(u)}}return new du(r,n)},Ul.prototype.m_=function(t,e,n){var r=this.c_.tn;if(e.length>r.length)throw new Br(Gr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.L()){if("string"!=typeof s)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.c_.Vn()&&-1!==s.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.c_.path.child(Qr.N(s));if(!Zr.W(u))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Zr(u);i.push(vo(this.Jr,a))}else{var h=Ih(this.Gl,t,s);i.push(h)}}return new du(i,n)},Ul.prototype.f_=function(t){if("string"==typeof t){if(""===t)throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.c_.Vn()&&-1!==t.indexOf("/"))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.c_.path.child(Qr.N(t));if(!Zr.W(e))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return vo(this.Jr,new Zr(e))}if(t instanceof hh)return vo(this.Jr,t.Zr);throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ba(t)+".")},Ul.prototype.__=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Br(Gr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Ul.prototype.d_=function(t){if(t instanceof nu){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.In()){var o=this.c_.hn();if(null!==o&&!o.isEqual(t.field))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.c_.an();null!==s&&this.I_(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.c_.An(n)),null===u&&r&&(u=this.c_.An(e)),null!==u)throw u===t.op?new Br(Gr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Br(Gr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Ul.prototype.T_=function(t){var e;null!==this.c_.an()||null!==(e=this.c_.hn())&&this.I_(e,t.field)},Ul.prototype.I_=function(t,e){if(!e.isEqual(t))throw new Br(Gr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(kl,Pl=Ul),kl.prototype.where=function(t,e,n){ha("Query.where",arguments,3),Ea("Query.where",3,n);var r=ga("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),i=Sh("Query.where",t),o=this.l_(i,r,n);return new kl(this.c_.un(o),this.firestore,this.to)},kl.prototype.orderBy=function(t,e){var n;if(la("Query.orderBy",arguments,1,2),pa("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Br(Gr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r=Sh("Query.orderBy",t),i=this.w_(r,n);return new kl(this.c_.cn(i),this.firestore,this.to)},kl.prototype.limit=function(t){return ha("Query.limit",arguments,1),fa("Query.limit","number",1,t),Na("Query.limit",1,t),new kl(this.c_.ln(t),this.firestore,this.to)},kl.prototype.limitToLast=function(t){return ha("Query.limitToLast",arguments,1),fa("Query.limitToLast","number",1,t),Na("Query.limitToLast",1,t),new kl(this.c_._n(t),this.firestore,this.to)},kl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ca("Query.startAt",arguments,1);var r=this.A_("Query.startAt",t,e,!0);return new kl(this.c_.fn(r),this.firestore,this.to)},kl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ca("Query.startAfter",arguments,1);var r=this.A_("Query.startAfter",t,e,!1);return new kl(this.c_.fn(r),this.firestore,this.to)},kl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ca("Query.endBefore",arguments,1);var r=this.A_("Query.endBefore",t,e,!0);return new kl(this.c_.dn(r),this.firestore,this.to)},kl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ca("Query.endAt",arguments,1);var r=this.A_("Query.endAt",t,e,!1);return new kl(this.c_.dn(r),this.firestore,this.to)},kl.prototype.isEqual=function(t){if(!(t instanceof kl))throw Aa("isEqual","Query",1,t);return this.firestore===t.firestore&&Zs(this.c_,t.c_)&&this.to===t.to},kl.prototype.withConverter=function(t){return new kl(this.c_,this.firestore,t)},kl.prototype.A_=function(t,e,n,r){if(Ea(t,1,e),e instanceof Tl)return ha(t,y([e],n),1),this.E_(t,e.h_,r);var i=[e].concat(n);return this.m_(t,i,r)},kl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];la("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||sl(i[a])||(Ia("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),ya("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),sl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(fa("Query.onSnapshot","function",a,i[a]),pa("Query.onSnapshot","function",a+1,i[a+1]),pa("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new Ml(r.firestore,r.c_,t,r.to))},error:i[a+1],complete:i[a+2]};return Dl(this.c_),Vl(this.firestore.Ml(),this.c_,u,h)},kl.prototype.get=function(t){var e=this;la("Query.get",arguments,0,1),Bl("Query.get",t),Dl(this.c_);var n,r,i,o,s,u=this.firestore.Ml();return(t&&"cache"===t.source?u.pl(this.c_):(n=u,r=this.c_,i=t,o=new Mu,s=Vl(n,r,{includeMetadataChanges:!0,Gu:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Br(Gr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Ml(e.firestore,e.c_,t,e.to)})},kl);function kl(t,e,n){var r=this;return(r=Pl.call(this,e.Jr,e.Gl,t)||this).c_=t,r.firestore=e,r.to=n,r}function Ul(t,e,n){this.Jr=t,this.Gl=e,this.c_=n}function Vl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Qc({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.vl(),t.Jh(s)}}var Cl,Ml=(Object.defineProperty(ql.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"empty",{get:function(){return this.P_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"size",{get:function(){return this.P_.docs.size},enumerable:!1,configurable:!0}),ql.prototype.forEach=function(e,n){var r=this;la("QuerySnapshot.forEach",arguments,1,2),fa("QuerySnapshot.forEach","function",1,e),this.P_.docs.forEach(function(t){e.call(n,r.p_(t,r.metadata.fromCache,r.P_.Mt.has(t.key)))})},Object.defineProperty(ql.prototype,"query",{get:function(){return new Ol(this.R_,this.e_,this.to)},enumerable:!1,configurable:!0}),ql.prototype.docChanges=function(t){t&&(Ia("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ya("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.P_.Bt)throw new Br(Gr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.V_&&this.y_===e||(this.V_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.P_,e,this.p_.bind(this)),this.y_=e),this.V_},ql.prototype.isEqual=function(t){if(!(t instanceof ql))throw Aa("isEqual","QuerySnapshot",1,t);return this.e_===t.e_&&Zs(this.R_,t.R_)&&this.P_.isEqual(t.P_)&&this.to===t.to},ql.prototype.p_=function(t,e,n){return new _l(this.e_,t.key,t,e,n,this.to)},ql),xl=(n(jl,Cl=Ol),Object.defineProperty(jl.prototype,"id",{get:function(){return this.c_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"parent",{get:function(){var t=this.c_.path.g();return t._()?null:new ml(new Zr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"path",{get:function(){return this.c_.path.$()},enumerable:!1,configurable:!0}),jl.prototype.doc=function(t){la("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Rr.t()),fa("CollectionReference.doc","non-empty string",1,t);var e=Qr.N(t);return ml.Zl(this.c_.path.child(e),this.firestore,this.to)},jl.prototype.add=function(t){ha("CollectionReference.add",arguments,1),fa("CollectionReference.add","object",1,this.to?this.to.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},jl.prototype.withConverter=function(t){return new jl(this.g_,this.firestore,t)},jl);function jl(t,e,n){var r=this;if(((r=Cl.call(this,Hs.on(t),e,n)||this).g_=t).length%2!=1)throw new Br(Gr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function ql(t,e,n,r){this.e_=t,this.R_=e,this.P_=n,this.to=r,this.V_=null,this.y_=null,this.metadata=new Nl(n.hasPendingWrites,n.fromCache)}function Fl(t,e){if(void 0===e)return{merge:!1};if(Ia(t,e,["merge","mergeFields"]),ya(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ba(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof ka))throw new Br(Gr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ba(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(Gr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Gl(t,e){return void 0===e?{}:(Ia(t,e,["serverTimestamps"]),va(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Bl(t,e){pa(t,"object",1,e),e&&(Ia(t,e,["source"]),va(t,0,"source",e.source,["default","server","cache"]))}function zl(t,e,n){if(e instanceof hh){if(e.firestore!==n)throw new Br(Gr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Aa(t,"DocumentReference",1,e)}function Hl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Wl,Ql={Firestore:cl,GeoPoint:$a,Timestamp:zr,Blob:Pa,Transaction:vl,WriteBatch:gl,DocumentReference:ml,DocumentSnapshot:Tl,Query:Ol,QueryDocumentSnapshot:_l,QuerySnapshot:Ml,CollectionReference:xl,FieldPath:ka,FieldValue:Ja,setLogLevel:cl.setLogLevel,CACHE_SIZE_UNLIMITED:al};(Wl=Xl).INTERNAL.registerComponent(new gr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new cl(e,n,new Hc);var e,n},"PUBLIC").setServiceProps(Object.assign({},Ql))),Wl.registerVersion("@firebase/firestore","1.16.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});