!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(gf){"use strict";try{(function(){gf=gf&&Object.prototype.hasOwnProperty.call(gf,"default")?gf.default:gf;var t,a,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function y(n,i){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},h=a.INFO,c=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(n(w,v=Error),w);function w(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=_||self;function R(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),L=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:M).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++L))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var Y=O.navigator;if(Y){var $=Y.userAgent;if($){H=$;break t}}H=""}function J(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var it,rt,ot=X(H,"Opera"),st=X(H,"Trident")||X(H,"MSIE"),at=X(H,"Edge"),ut=at||st,ht=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),ct=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function lt(){var t=O.document;return t?t.documentMode:void 0}t:{var ft="",pt=(rt=H,ht?/rv:([^\);]+)(\)|;)/.exec(rt):at?/Edge\/([\d\.]+)/.exec(rt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):ot?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(pt&&(ft=pt?pt[1]:""),st){var dt=lt();if(null!=dt&&dt>parseFloat(ft)){it=String(dt);break t}}it=ft}var yt={};function vt(a){return t=a,e=function(){for(var t=0,e=K(String(it)).split("."),n=K(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=O.document&&st&&(lt()||parseInt(it,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",R,e),O.removeEventListener("test",R,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},q(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),At=0;function _t(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++At,this.Y=this.Z=!1}function Ot(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=G(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(Ot(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}Rt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Dt={};function Lt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Gt(i),e&&e[Nt]?e.wa(n,i,P(r)?!!r.capture:!!r,o):Ct(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,i,r);return null}return n=Gt(n),t&&t[Nt]?t.va(e,n,P(i)?!!i.capture:!!i,r):Ct(t,e,n,!1,i,r)}function Ct(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=P(r)?!!r.capture:!!r;if(s&&!mt)return null;var a,u,h=qt(t);if(h||(t[Pt]=h=new Rt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(a=xt,i=u=mt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)bt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Mt(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?St(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Vt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=qt(e))?(St(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Ot(t)))}function Vt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ut(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Mt(t),n.call(i,e)}function xt(t,e){if(t.Y)return!0;if(mt)return Ut(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=O,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Ut(t,e=new It(e,this))}function qt(t){return(t=t[Pt])instanceof Rt?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==S(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Ft(){j.call(this),this.c=new Rt(this),(this.J=this).C=null}function Bt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&St(t.c,u),r=!1!==s.call(a,i)&&r)}return r&&!i.defaultPrevented}q(Ft,j),Ft.prototype[Nt]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,i){Lt(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=P(r)?!!r.capture:!!r,i=Gt(i),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=kt(s=e.a[n],i,r,o))&&(Ot(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,i,r,o)),(i=-1<e?n[e]:null)&&Mt(i))}(this,t,e,n,i)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=Bt(o,i,!0,t)&&s;if(s=Bt(o=t.a=n,i,!0,t)&&s,s=Bt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=Bt(o=t.a=e[r],i,!1,t)&&s;return s},A.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Ot(n[i]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},A.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var zt=O.JSON.stringify;function Wt(){this.b=this.a=null}var Ht,Kt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Qt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Ht||(n=O.Promise.resolve(void 0),Ht=function(){n.then(Zt)}),$t||(Ht(),$t=!0),Jt.add(t,e)}Wt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Wt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var i=Kt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}$t=!1}function te(t,e){Ft.call(this),this.b=t||1,this.a=e||O,this.f=V(this.Ya,this),this.g=x()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==S(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}q(te,Ft),(A=te.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},A.G=function(){te.S.G.call(this),ee(this),delete this.a};var ie,re,oe,se=(T(re=ue,oe=ie=j),re.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ie.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=re}function ue(t,e,n){var i=ie.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function he(t){j.call(this),this.b=t,this.a={}}q(he,j);var ce=[];function le(t,e,n,i){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var r=0;r<n.length;r++){var o=Lt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}he.prototype.G=function(){he.S.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Ft}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}q(ge,Et),q(we,Et),q(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ae(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ae.prototype.a=null;var Re,Se={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ke(){Et.call(this,"d")}function Pe(){Et.call(this,"c")}function De(){}function Le(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new he(this),this.P=Ce,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(ke,Et),q(Pe,Et),q(De,Ae),Re=new De;var Ce=45e3,Me={},Ve={};function Ue(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=x(),je(t),t.l=Je(t.i);var s,a,u,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),mn(n.b,"t",i),t.D=0,t.a=li(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function qe(t,e,n){for(var i,r,o,s,a=!0;!t.A&&t.D<n.length;){var u=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?Ve:(o=Number(r.substring(o,s)),isNaN(o)?Me:(s+=1)+o>r.length?Ve:(r=r.substr(s,o),i.D=s+o,r)));if(u==Ve){4==e&&(t.h=4,be(),a=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(u==Me){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}de(t.c,t.f,u,null),We(t,u)}4==e&&0==n.length&&(t.h=1,be(),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ii(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Be(t))}function je(t){t.U=x()+t.P,Ge(t,t.P)}function Ge(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(V(t.Ua,t),e)}function Fe(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||si(t.g,t)}function ze(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n,i,r,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||An(p.b,t)))if(p.I=t.N,!t.C&&An(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;oi(p),Xn(p)}ni(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(V(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ui(p,11)}else if(!t.C&&p.a!=t||oi(p),!W(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(X(a,"spdy")||X(a,"quic")||X(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(_n(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=x()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=ci(o,o.C?o.ga:null,o.fa),c.C?(On(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Fe(l),je(l)),o.a=c):ei(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||ui(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ui(p,7):Kn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ke)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Qe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Qe(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||me(),Fe(this);var i=this.a.X();this.N=i;var r=this.a.$();if(this.b=200==i,u=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=i,u.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.h=3,be(),ze(this),Be(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,a)}this.I?(qe(this,e,r),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,r,null),We(this,r)),4==e&&ze(this),this.b&&!this.A&&(4==e?si(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Be(this)}}}catch(t){}var u,h,c,l,f,p,d},A.Va=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),qe(this,t,e),this.b&&4!=t&&je(this)))},A.cancel=function(){this.A=!0,ze(this)},A.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Be(this)):Ge(this,this.U-n)},(A=Ke.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Xe(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new $e(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var i,r;e instanceof dn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(yn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},i)),i.f=r):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(a){a.a||(a.a=new Ke,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function vn(t,e){yn(t),e=wn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Qe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,i){yn(this),this.a.forEach(function(t,e){F(t,function(t){n.call(i,t,e,this)},this)},this)},A.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},A.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function On(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var i=t.c;try{for(var r=N(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Sn(){}function kn(){this.a=new Sn}function Pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Dn=O.JSON.parse;function Ln(t){Ft.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}q(Ln,Ft);var Cn="",Mn=/^https?$/i,Vn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),Gn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&(!t.s[1]||4!=Bn(t)||2!=t.X()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Ye)[1]||null)&&O.self&&O.self.location&&(r=(i=O.self.location.protocol).substr(0,i.length-1)),n=!Mn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Bn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",qn(t)}}finally{Gn(t)}}}function Gn(t,e){if(t.a){Fn(t);var n=t.a,i=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",J(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Wn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Wn("baseRetryDelayMs",5e3,t),this.Ma=Wn("retryDelaySeedMs",1e4,t),this.Ja=Wn("forwardChannelMaxRetries",2,t),this.ma=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Kn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=li(e.g,null),e.a.ba(e.i)),e.u=x(),je(e)),hi(t)}function Xn(t){t.a&&(ii(t),t.a.cancel(),t.a=null)}function Qn(t){Xn(t),t.j&&(O.clearTimeout(t.j),t.j=null),oi(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&$n(t)}function $n(t){Tn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,i=Je(t.B);rn(i,"SID",t.J),rn(i,"RID",n),rn(i,"AID",t.P),Zn(t,i),t.i&&t.l&&zn(i,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ti(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ue(n,i,e)}function Zn(t,n){t.f&&He({},function(t,e){rn(n,e,t)})}function ti(t,e,n){n=Math.min(t.g.length,n);var i=t.f?V(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{!function(t,i){var r="req"+h+"_"||"";try{He(t,function(t,e){var n=t;P(t)&&(n=zt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ei(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function ni(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(V(t.Aa,t),ai(t,t.o)),t.o++,1)}function ii(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function ri(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,xe(n,t)}function oi(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function si(t,e){var n,i=null;if(t.a==e){oi(t),ii(t),t.a=null;var r=2}else{if(!An(t.b,e))return;i=e.s,On(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)1==r?(i=e.j?e.j.length:0,e=x()-e.u,n=t.u,(r=ve()).dispatchEvent(new Ee(r)),$n(t)):ei(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(V(t.Ba,t,e),ai(t,t.u)),t.u++,1}}(t,e)||2==r&&ni(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ui(t,5);break;case 4:ui(t,10);break;case 3:ui(t,6);break;default:ui(t,2)}}function ai(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ui(t,e){var n,i,r,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=V(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Ze(n,"https"),on(n)),r=n.toString(),o=i,a=new pe,O.Image?((s=new Image).onload=U(Pn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=U(Pn,a,s,"TestLoadImage: error",!1,o),s.onabort=U(Pn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(Pn,a,s,"TestLoadImage: timeout",!1,o),O.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hi(t),Qn(t)}function hi(t){t.v=0,t.I=-1,t.f&&(0==Rn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ci(t,e,n){var i,r,o,s,a,u,h,c=(i=n)instanceof $e?Je(i):new $e(i,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(r=O.location).protocol,s=e?e+"."+r.hostname:r.hostname,a=+r.port,u=n,h=new $e(null,void 0),o&&Ze(h,o),s&&tn(h,s),a&&en(h,a),u&&(h.g=u),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function li(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function fi(){}function pi(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function di(t,e){Ft.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gi(this)}function yi(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vi(){Pe.call(this),this.status=1}function gi(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Re),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var r,o=new Ke(this.headers);i&&He(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Un,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=G(Vn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(r=this.a,st&&vt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},A.Ta=function(){jn(this)},A.X=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Hn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),i=this.l;if(this.O&&(i?et(i=Z(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ti(this,n,e),rn(r=Je(this.B),"RID",t),rn(r,"CVER",22),this.A&&rn(r,"X-HTTP-Session-Id",this.A),Zn(this,r),this.i&&i&&zn(r,this.i,i),_n(this.b,n),this.Ga&&rn(r,"TYPE","init"),this.da?(rn(r,"$req",e),rn(r,"SID","null"),n.V=!0,Ue(n,r,null)):Ue(n,r,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},A.Aa=function(){var t;this.j=null,ri(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(V(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),ri(this))},A.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ni(this),be())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(A=fi.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},pi.prototype.a=function(t,e){return new di(t,e)},q(di,Ft),(A=di.prototype).addEventListener=function(t,e,n,i){di.S.addEventListener.call(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){di.S.removeEventListener.call(this,t,e,n,i)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=ci(t,null,t.fa),$n(t)},A.close=function(){Kn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,di.S.G.call(this)},q(yi,ke),q(vi,Pe),q(gi,fi),gi.prototype.ta=function(){this.a.dispatchEvent("a")},gi.prototype.sa=function(t){this.a.dispatchEvent(new yi(t))},gi.prototype.ra=function(t){this.a.dispatchEvent(new vi)},gi.prototype.qa=function(){this.a.dispatchEvent("b")},pi.prototype.createWebChannel=pi.prototype.a,di.prototype.send=di.prototype.Pa,di.prototype.open=di.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(Oe.EventType=Se).OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mi={createWebChannelTransport:function(){return new pi},ErrorCode:Te,EventType:Ne,WebChannel:Oe,XhrIo:Ln},wi=mi.createWebChannelTransport,bi=mi.ErrorCode,Ei=mi.EventType,Ii=mi.WebChannel,Ti=mi.XhrIo,Ni=(Ai.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ai.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ai.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ai);function Ai(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _i="7.18.0-202071122108",Oi=new l("@firebase/firestore");function Ri(){return Oi.logLevel}function Si(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.DEBUG&&(e=n.map(Di),Oi.debug.apply(Oi,r(["Firestore ("+_i+"): "+t],e)))}function ki(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.ERROR&&(e=n.map(Di),Oi.error.apply(Oi,r(["Firestore ("+_i+"): "+t],e)))}function Pi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.WARN&&(e=n.map(Di),Oi.warn.apply(Oi,r(["Firestore ("+_i+"): "+t],e)))}function Di(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Li(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+_i+") INTERNAL ASSERTION FAILED: "+t;throw ki(e),new Error(e)}function Ci(t){t||Li()}var Mi=(Vi.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Vi);function Vi(){}function Ui(t,e){return t<e?-1:e<t?1:0}function xi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function qi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var ji=(Object.defineProperty(Gi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gi.prototype.isEqual=function(t){return t instanceof Gi&&t.projectId===this.projectId&&t.database===this.database},Gi.prototype.o=function(t){return Ui(this.projectId,t.projectId)||Ui(this.database,t.database)},Gi);function Gi(t,e){this.projectId=t,this.database=e||"(default)"}function Fi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wi,Hi,Ki,Xi=(lr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(this.u(s,t))return a}},lr.prototype.has=function(t){return void 0!==this.get(t)},lr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},lr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},lr.prototype.forEach=function(a){Bi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},lr.prototype._=function(){return zi(this.l)},lr),Qi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yi=(n(cr,Ki=Error),cr),$i=(hr.now=function(){return hr.fromMillis(Date.now())},hr.fromDate=function(t){return hr.fromMillis(t.getTime())},hr.fromMillis=function(t){var e=Math.floor(t/1e3);return new hr(e,1e6*(t-1e3*e))},hr.prototype.toDate=function(){return new Date(this.toMillis())},hr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hr.prototype.T=function(t){return this.seconds===t.seconds?Ui(this.nanoseconds,t.nanoseconds):Ui(this.seconds,t.seconds)},hr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hr),Ji=(ur.m=function(t){return new ur(t)},ur.min=function(){return new ur(new $i(0,0))},ur.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ur.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ur.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ur.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ur.prototype.R=function(){return this.timestamp},ur),Zi=(Object.defineProperty(ar.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),ar.prototype.isEqual=function(t){return 0===ar.P(this,t)},ar.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ar?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ar.prototype.limit=function(){return this.offset+this.length},ar.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ar.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ar.prototype.v=function(){return this.segments[this.offset]},ar.prototype.S=function(){return this.get(this.length-1)},ar.prototype.get=function(t){return this.segments[this.offset+t]},ar.prototype._=function(){return 0===this.length},ar.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ar.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ar.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ar.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ar.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ar),tr=(n(sr,Hi=Zi),sr.prototype.V=function(t,e,n){return new sr(t,e,n)},sr.prototype.N=function(){return this.F().join("/")},sr.prototype.toString=function(){return this.N()},sr.$=function(t){if(0<=t.indexOf("//"))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new sr(t.split("/").filter(function(t){return 0<t.length}))},sr.k=function(){return new sr([])},sr),er=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nr=(n(or,Wi=Zi),or.prototype.V=function(t,e,n){return new or(t,e,n)},or.L=function(t){return er.test(t)},or.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),or.L(t)||(t="`"+t+"`"),t}).join(".")},or.prototype.toString=function(){return this.N()},or.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},or.q=function(){return new or(["__name__"])},or.M=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Yi(Qi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Yi(Qi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Yi(Qi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new or(e)},or.k=function(){return new or([])},or),ir=(rr.U=function(t){return new rr(tr.$(t).p(5))},rr.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},rr.prototype.isEqual=function(t){return null!==t&&0===tr.P(this.path,t.path)},rr.prototype.toString=function(){return this.path.toString()},rr.P=function(t,e){return tr.P(t.path,e.path)},rr.W=function(t){return t.length%2==0},rr.j=function(t){return new rr(new tr(t.slice()))},rr);function rr(t){this.path=t}function or(){return null!==Wi&&Wi.apply(this,arguments)||this}function sr(){return null!==Hi&&Hi.apply(this,arguments)||this}function ar(t,e,n){void 0===e?e=0:e>t.length&&Li(),void 0===n?n=t.length-e:n>t.length-e&&Li(),this.segments=t,this.offset=e,this.A=n}function ur(t){this.timestamp=t}function hr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yi(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yi(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yi(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yi(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function cr(t,e){var n=this;return(n=Ki.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function lr(t,e){this.h=t,this.u=e,this.l={}}function fr(t){return null==t}function pr(t){return-0===t&&1/t==-1/0}var dr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.G=null};function yr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new dr(t,e,n,i,r,o,s)}function vr(t){var e,n=t;return null===n.G&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+wo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),fr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ga(n.startAt)),n.endAt&&(e+="|ub:",e+=Ga(n.endAt)),n.G=e),n.G}function gr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!yo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ba(t.startAt,e.startAt)&&Ba(t.endAt,e.endAt)}function mr(t){return ir.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wr=(br.fromBase64String=function(t){return new br(atob(t))},br.fromUint8Array=function(t){return new br(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},br.prototype.toBase64=function(){return t=this.K,btoa(t);var t},br.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},br.prototype.H=function(){return 2*this.K.length},br.prototype.o=function(t){return Ui(this.K,t.K)},br.prototype.isEqual=function(t){return this.K===t.K},br);function br(t){this.K=t}function Er(t){this.count=t}wr.Y=new wr("");var Ir,Tr,Nr=(Ar.prototype.Z=function(t){return new Ar(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ar.prototype.tt=function(t,e){return new Ar(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ar.prototype.et=function(t){return new Ar(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ar);function Ar(t,e,n,i,r,o,s){void 0===r&&(r=Ji.min()),void 0===o&&(o=Ji.min()),void 0===s&&(s=wr.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.J=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function _r(t){switch(t){case Qi.OK:return Li(),0;case Qi.CANCELLED:case Qi.UNKNOWN:case Qi.DEADLINE_EXCEEDED:case Qi.RESOURCE_EXHAUSTED:case Qi.INTERNAL:case Qi.UNAVAILABLE:case Qi.UNAUTHENTICATED:return;case Qi.INVALID_ARGUMENT:case Qi.NOT_FOUND:case Qi.ALREADY_EXISTS:case Qi.PERMISSION_DENIED:case Qi.FAILED_PRECONDITION:case Qi.ABORTED:case Qi.OUT_OF_RANGE:case Qi.UNIMPLEMENTED:case Qi.DATA_LOSS:return 1;default:return Li(),0}}function Or(t){if(void 0===t)return ki("GRPC error has no .code"),Qi.UNKNOWN;switch(t){case Ir.OK:return Qi.OK;case Ir.CANCELLED:return Qi.CANCELLED;case Ir.UNKNOWN:return Qi.UNKNOWN;case Ir.DEADLINE_EXCEEDED:return Qi.DEADLINE_EXCEEDED;case Ir.RESOURCE_EXHAUSTED:return Qi.RESOURCE_EXHAUSTED;case Ir.INTERNAL:return Qi.INTERNAL;case Ir.UNAVAILABLE:return Qi.UNAVAILABLE;case Ir.UNAUTHENTICATED:return Qi.UNAUTHENTICATED;case Ir.INVALID_ARGUMENT:return Qi.INVALID_ARGUMENT;case Ir.NOT_FOUND:return Qi.NOT_FOUND;case Ir.ALREADY_EXISTS:return Qi.ALREADY_EXISTS;case Ir.PERMISSION_DENIED:return Qi.PERMISSION_DENIED;case Ir.FAILED_PRECONDITION:return Qi.FAILED_PRECONDITION;case Ir.ABORTED:return Qi.ABORTED;case Ir.OUT_OF_RANGE:return Qi.OUT_OF_RANGE;case Ir.UNIMPLEMENTED:return Qi.UNIMPLEMENTED;case Ir.DATA_LOSS:return Qi.DATA_LOSS;default:return Li()}}(Tr=Ir=Ir||{})[Tr.OK=0]="OK",Tr[Tr.CANCELLED=1]="CANCELLED",Tr[Tr.UNKNOWN=2]="UNKNOWN",Tr[Tr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tr[Tr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tr[Tr.NOT_FOUND=5]="NOT_FOUND",Tr[Tr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tr[Tr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tr[Tr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tr[Tr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tr[Tr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tr[Tr.ABORTED=10]="ABORTED",Tr[Tr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tr[Tr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tr[Tr.INTERNAL=13]="INTERNAL",Tr[Tr.UNAVAILABLE=14]="UNAVAILABLE",Tr[Tr.DATA_LOSS=15]="DATA_LOSS";var Rr=(Lr.prototype.nt=function(t,e){return new Lr(this.P,this.root.nt(t,e,this.P).copy(null,null,kr.st,null,null))},Lr.prototype.remove=function(t){return new Lr(this.P,this.root.remove(t,this.P).copy(null,null,kr.st,null,null))},Lr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Lr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Lr.prototype._=function(){return this.root._()},Object.defineProperty(Lr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Lr.prototype.it=function(){return this.root.it()},Lr.prototype.rt=function(){return this.root.rt()},Lr.prototype.ot=function(t){return this.root.ot(t)},Lr.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Lr.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Lr.prototype.ht=function(t){return this.root.ht(t)},Lr.prototype.at=function(){return new Sr(this.root,null,this.P,!1)},Lr.prototype.ut=function(t){return new Sr(this.root,t,this.P,!1)},Lr.prototype.ct=function(){return new Sr(this.root,null,this.P,!0)},Lr.prototype.lt=function(t){return new Sr(this.root,t,this.P,!0)},Lr),Sr=(Dr.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Dr.prototype.wt=function(){return 0<this.ft.length},Dr.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Dr),kr=(Pr.prototype.copy=function(t,e,n,i,r){return new Pr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Pr.prototype._=function(){return!1},Pr.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Pr.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Pr.prototype.min=function(){return this.left._()?this:this.left.min()},Pr.prototype.it=function(){return this.min().key},Pr.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Pr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.nt(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.nt(t,e,n))).Et()},Pr.prototype.It=function(){if(this.left._())return Pr.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Pr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.At()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.Rt()&&(i=i.Pt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===e(t,i.key)){if(i.right._())return Pr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.It())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.Et()},Pr.prototype.Rt=function(){return this.color},Pr.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},Pr.prototype.At=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).yt()).pt()),t},Pr.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.Pt()).pt()),t},Pr.prototype.yt=function(){var t=this.copy(null,null,Pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pr.prototype.Pt=function(){var t=this.copy(null,null,Pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pr.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pr.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Pr.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Li();if(this.right.Rt())throw Li();var t=this.left.vt();if(t!==this.right.vt())throw Li();return t+(this.Rt()?0:1)},Pr);function Pr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Pr.RED,this.left=null!=i?i:Pr.EMPTY,this.right=null!=r?r:Pr.EMPTY,this.size=this.left.size+1+this.right.size}function Dr(t,e,n,i){this._t=i,this.ft=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this._t?t.left:t.right;else{if(0===r){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Lr(t,e){this.P=t,this.root=e||kr.EMPTY}function Cr(){this.size=0}kr.EMPTY=null,kr.RED=!0,kr.st=!1,kr.EMPTY=(Object.defineProperty(Cr.prototype,"key",{get:function(){throw Li()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"value",{get:function(){throw Li()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"color",{get:function(){throw Li()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"left",{get:function(){throw Li()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"right",{get:function(){throw Li()},enumerable:!1,configurable:!0}),Cr.prototype.copy=function(t,e,n,i,r){return this},Cr.prototype.nt=function(t,e,n){return new kr(t,e)},Cr.prototype.remove=function(t,e){return this},Cr.prototype._=function(){return!0},Cr.prototype.ot=function(t){return!1},Cr.prototype.ht=function(t){return!1},Cr.prototype.it=function(){return null},Cr.prototype.rt=function(){return null},Cr.prototype.Rt=function(){return!1},Cr.prototype.gt=function(){return!0},Cr.prototype.vt=function(){return 0},new Cr);var Mr=(qr.prototype.has=function(t){return null!==this.data.get(t)},qr.prototype.first=function(){return this.data.it()},qr.prototype.last=function(){return this.data.rt()},Object.defineProperty(qr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qr.prototype.indexOf=function(t){return this.data.indexOf(t)},qr.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},qr.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var i=n.dt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},qr.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},qr.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},qr.prototype.at=function(){return new Vr(this.data.at())},qr.prototype.ut=function(t){return new Vr(this.data.ut(t))},qr.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},qr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qr.prototype._=function(){return this.data._()},qr.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qr.prototype.isEqual=function(t){if(!(t instanceof qr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(0!==this.P(i,r))return!1}return!0},qr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qr.prototype.copy=function(t){var e=new qr(this.P);return e.data=t,e},qr),Vr=(xr.prototype.dt=function(){return this.Ft.dt().key},xr.prototype.wt=function(){return this.Ft.wt()},xr),Ur=new Rr(ir.P);function xr(t){this.Ft=t}function qr(t){this.P=t,this.data=new Rr(this.P)}var jr=new Rr(ir.P),Gr=new Rr(ir.P),Fr=new Mr(ir.P);function Br(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fr,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var zr=new Mr(Ui);function Wr(t,e,n,i){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=i}function Hr(t,e){this.targetId=t,this.ee=e}function Kr(t,e,n,i){void 0===n&&(n=wr.Y),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Xr=(ao.kt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.Nt.get(t)},ao.prototype.get=function(t){return this.Nt.get(t)},ao.prototype.first=function(){return this.$t.it()},ao.prototype.last=function(){return this.$t.rt()},ao.prototype._=function(){return this.$t._()},ao.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.$t.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.$t.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.$t.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.at(),n=t.$t.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(!i.isEqual(r))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.Nt=t,n.$t=e,n},ao),Qr=(so.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Li()},so.prototype.Lt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},so),Yr=(oo.Bt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new oo(t,e,Xr.kt(e),r,n,i,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Mt===t.Mt&&this.qt.isEqual(t.qt)&&ca(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},oo),$r=(ro.Kt=function(t,e){var n=new Map;return n.set(t,Jr.zt(t,e)),new ro(Ji.min(),n,zr,Ur,Br())},ro),Jr=(io.zt=function(t,e){return new io(wr.Y,e,Br(),Br(),Br())},io),Zr=(Object.defineProperty(no.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),no.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},no.prototype.ce=function(){var n=Br(),i=Br(),r=Br();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Li()}}),new Jr(this.ie,this.re,n,i,r)},no.prototype.le=function(){this.oe=!1,this.se=ho()},no.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},no.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},no.prototype.de=function(){this.ne+=1},no.prototype.we=function(){--this.ne},no.prototype.Te=function(){this.oe=!0,this.re=!0},no),to=(eo.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var i=n[e];t.te instanceof Xs?this.Ve(i,t.te):t.te instanceof Qs&&this.ye(i,t.key,t.te)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.ye(s,t.key,t.te)}},eo.prototype.pe=function(n){var i=this;this.ge(n,function(t){var e=i.ve(t);switch(n.state){case 0:i.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||i.removeTarget(t);break;case 3:i.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:i.be(t)&&(i.Se(t),e.ue(n.resumeToken));break;default:Li()}})},eo.prototype.ge=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ee.forEach(function(t,e){i.be(e)&&n(e)})},eo.prototype.Ce=function(t){var e,n,i=t.targetId,r=t.ee.count,o=this.De(i);o&&(mr(e=o.target)?0===r?(n=new ir(e.path),this.ye(i,n,new Qs(n,Ji.min()))):Ci(1===r):this.Fe(i)!==r&&(this.Se(i),this.Ae=this.Ae.add(i)))},eo.prototype.Ne=function(r){var o=this,s=new Map;this.Ee.forEach(function(t,e){var n,i=o.De(e);i&&(t.Ht&&mr(i.target)&&(n=new ir(i.target.path),null!==o.Ie.get(n)||o.$e(e,n)||o.ye(e,n,new Qs(n,r))),t.ae&&(s.set(e,t.ce()),t.le()))});var i=Br();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new $r(r,s,this.Ae,this.Ie,i);return this.Ie=Ur,this.Re=uo(),this.Ae=new Mr(Ui),t},eo.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},eo.prototype.ye=function(t,e,n){var i;this.be(t)&&(i=this.ve(t),this.$e(t,e)?i._e(e,1):i.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},eo.prototype.removeTarget=function(t){this.Ee.delete(t)},eo.prototype.Fe=function(t){var e=this.ve(t).ce();return this.me.xe(t).size+e.Yt.size-e.Jt.size},eo.prototype.de=function(t){this.ve(t).de()},eo.prototype.ve=function(t){var e=this.Ee.get(t);return e||(e=new Zr,this.Ee.set(t,e)),e},eo.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Mr(Ui),this.Re=this.Re.nt(t,e)),e},eo.prototype.be=function(t){var e=null!==this.De(t);return e||Si("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.De=function(t){var e=this.Ee.get(t);return e&&e.he?null:this.me.Le(t)},eo.prototype.Se=function(e){var n=this;this.Ee.set(e,new Zr),this.me.xe(e).forEach(function(t){n.ye(e,t,null)})},eo.prototype.$e=function(t,e){return this.me.xe(t).has(e)},eo);function eo(t){this.me=t,this.Ee=new Map,this.Ie=Ur,this.Re=uo(),this.Ae=new Mr(Ui)}function no(){this.ne=0,this.se=ho(),this.ie=wr.Y,this.re=!1,this.oe=!0}function io(t,e,n,i,r){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=i,this.Jt=r}function ro(t,e,n,i,r){this.J=t,this.Wt=e,this.Qt=n,this.jt=i,this.Gt=r}function oo(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.Ot=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Mt=s,this.Ut=a}function so(){this.xt=new Rr(ir.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ir.P(t.key,e.key)}:function(t,e){return ir.P(t.key,e.key)},this.Nt=jr,this.$t=new Rr(this.P)}function uo(){return new Rr(ir.P)}function ho(){return new Rr(ir.P)}function co(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=bo(t.mapValue.fields.__local_write_time__.timestampValue);return new $i(e.seconds,e.nanos)}var fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?co(t)?4:10:Li()}function yo(i,r){var t,e,n,o=po(i);if(o!==po(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return lo(i).isEqual(lo(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=bo(i.timestampValue),n=bo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,Io(i.bytesValue).isEqual(Io(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Eo((t=i).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Eo(t.doubleValue),i=Eo(e.doubleValue);return n===i?pr(n)===pr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return xi(i.arrayValue.values||[],r.arrayValue.values||[],yo);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Fi(t)!==Fi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!yo(t[n],e[n])))return!1;return!0}();default:return Li()}}function vo(t,e){return void 0!==(t.values||[]).find(function(t){return yo(t,e)})}function go(t,e){var n,i,r,o,s,a,u,h,c,l,f=po(t),p=po(e);if(f!==p)return Ui(f,p);switch(f){case 0:return 0;case 1:return Ui(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Eo(t.integerValue||t.doubleValue))<(l=Eo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return mo(t.timestampValue,e.timestampValue);case 4:return mo(lo(t),lo(e));case 5:return Ui(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Io(o),u=Io(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Ui(n[r],i[r]);if(0!==o)return o}return Ui(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Ui(Eo(n.latitude),Eo(i.latitude)))?r:Ui(Eo(n.longitude),Eo(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=go(n[r],i[r]);if(o)return o}return Ui(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var a=Ui(i[s],o[s]);if(0!==a)return a;var u=go(n[i[s]],r[o[s]]);if(0!==u)return u}return Ui(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Li()}}function mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ui(t,e);var n=bo(t),i=bo(e),r=Ui(n.seconds,i.seconds);return 0!==r?r:Ui(n.nanos,i.nanos)}function wo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=bo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Io(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ir.U(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Li();var t,e,n}(t)}function bo(t){if(Ci(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e,n=0,i=fo.exec(t);Ci(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Io(t){return"string"==typeof t?wr.fromBase64String(t):wr.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function No(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function _o(t){return t&&"nullValue"in t}function Oo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var So={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Oe=e};function Do(t){return{integerValue:""+t}}function Lo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pr(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!pr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Do(e):Lo(t,e);var n}function Mo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Uo(t){return Ci(!!t),Ji.m((e=bo(t),new $i(e.seconds,e.nanos)));var e}function xo(t,e){return new tr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function qo(t,e){return xo(t.s,e.path)}function jo(t,e){var n,i,r=(Ci(Ko(i=tr.$(e))),i);return Ci(r.get(1)===t.s.projectId),Ci(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new ir((Ci(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Go(t,e){return xo(t.s,e)}function Fo(t){return new tr(["projects",t.s.projectId,"databases",t.s.database]).N()}function Bo(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,i,r,o;if(e instanceof As)n={update:Bo(t,e.key,e.value)};else if(e instanceof Vs)n={delete:qo(t,e.key)};else if(e instanceof _s)n={update:Bo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Ps)n={transform:{document:qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof Zo)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof rs)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.N(),increment:e.Me};throw Li()})}};else{if(!(e instanceof Us))return Li();n={verify:qo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:Mo(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Li()),n}function Wo(t){return{before:t.before,values:t.position}}function Ho(t){return{fieldPath:t.N()}}function Ko(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Xo(){this.We=void 0}function Qo(t,e){return t instanceof us?No(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Yo,$o,Jo=(n(es,$o=Xo),es),Zo=(n(ts,Yo=Xo),ts);function ts(t){var e=this;return(e=Yo.call(this)||this).elements=t,e}function es(){return null!==$o&&$o.apply(this,arguments)||this}function ns(t,e){for(var n=ls(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return yo(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var is,rs=(n(os,is=Xo),os);function os(t){var e=this;return(e=is.call(this)||this).elements=t,e}function ss(t,e){for(var n=ls(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!yo(t,e)})}(r[i]);return{arrayValue:{values:n}}}var as,us=(n(hs,as=Xo),hs);function hs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.Me=e,n}function cs(t){return Eo(t.integerValue||t.doubleValue)}function ls(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fs(t,e){this.field=t,this.transform=e}var ps=(ds.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ds.prototype.isEqual=function(t){return xi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ds);function ds(t){(this.fields=t).sort(nr.P)}function ys(t,e){this.version=t,this.transformResults=e}var vs=(gs.je=function(){return new gs},gs.exists=function(t){return new gs(void 0,t)},gs.updateTime=function(t){return new gs(t)},Object.defineProperty(gs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},gs);function gs(t,e){this.updateTime=t,this.exists=e}function ms(t,e){return void 0!==t.updateTime?e instanceof Xs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xs}function ws(){}function bs(t,e,n,i){return t instanceof As?function(t,e){if(!ms(t.Be,e))return e;var n=Is(e);return new Xs(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof _s?function(t,e){if(!ms(t.Be,e))return e;var n=Is(e),i=Ss(t,e);return new Xs(t.key,n,i,{Ge:!0})}(t,e):t instanceof Ps?function(t,e,n,i){if(!ms(t.Be,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Xs&&(y=n.field(p.field)),null===y&&i instanceof Xs&&(y=i.field(p.field)),c.push((o=y,h=u=a=s=void 0,(r=d)instanceof Jo?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):r instanceof Zo?ns(r,o):r instanceof rs?ss(r,o):(u=cs(a=Qo(s=r,o))+cs(s.Me),No(a)&&No(s.Me)?Do(u):Lo(s.serializer,u))))}return c}(t.fieldTransforms,n,e,i),s=Ls(t,r.data(),o);return new Xs(t.key,r.version,s,{Ge:!0})}(t,e,i,n):(o=e,ms((r=t).Be,o)?new Qs(r.key,Ji.min()):o);var r,o}function Es(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||xi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof Zo&&o instanceof Zo||r instanceof rs&&o instanceof rs?xi(r.elements,o.elements,yo):r instanceof us&&o instanceof us?yo(r.Me,o.Me):r instanceof Jo&&o instanceof Jo);var n,i,r,o}))}function Is(t){return t instanceof Xs?t.version:Ji.min()}var Ts,Ns,As=(n(Rs,Ns=ws),Rs),_s=(n(Os,Ts=ws),Os);function Os(t,e,n,i){var r=this;return(r=Ts.call(this)||this).key=t,r.data=e,r.qe=n,r.Be=i,r.type=1,r}function Rs(t,e,n){var i=this;return(i=Ns.call(this)||this).key=t,i.value=e,i.Be=n,i.type=0,i}function Ss(t,e){return n=t,i=e instanceof Xs?e.data():xs.empty(),r=new qs(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ke();var n,i,r}var ks,Ps=(n(Ds,ks=ws),Ds);function Ds(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=vs.exists(!0),n}function Ls(t,e,n){for(var i=new qs(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.Ke()}var Cs,Ms,Vs=(n(Bs,Ms=ws),Bs),Us=(n(Fs,Cs=ws),Fs),xs=(Gs.empty=function(){return new Gs({mapValue:{}})},Gs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Gs.prototype.isEqual=function(t){return yo(this.proto,t.proto)},Gs),qs=(js.prototype.set=function(t,e){return this.Ye(t,e),this},js.prototype.delete=function(t){return this.Ye(t,null),this},js.prototype.Ye=function(t,e){for(var n=this.He,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},js.prototype.Ke=function(){var t=this.Xe(nr.k(),this.He);return null!=t?new xs(t):this.ze},js.prototype.Xe=function(i,t){var r=this,o=!1,e=this.ze.field(i),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},js);function js(t){void 0===t&&(t=xs.empty()),this.ze=t,this.He=new Map}function Gs(t){this.proto=t}function Fs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.Be=e,n.type=4,n}function Bs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Be=e,n.type=3,n}function zs(t,e){this.key=t,this.version=e}var Ws,Hs,Ks,Xs=(n(Zs,Ks=zs),Zs.prototype.field=function(t){return this.Je.field(t)},Zs.prototype.data=function(){return this.Je},Zs.prototype.Ze=function(){return this.Je.proto},Zs.prototype.isEqual=function(t){return t instanceof Zs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},Zs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs),Qs=(n(Js,Hs=zs),Js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js),Ys=(n($s,Ws=zs),$s.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s);function $s(){return null!==Ws&&Ws.apply(this,arguments)||this}function Js(t,e,n){var i=this;return(i=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Zs(t,e,n,i){var r=this;return(r=Ks.call(this,t,e)||this).Je=n,r.Ge=!!i.Ge,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function ta(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yi(Qi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yi(Qi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ea=(na.prototype.rn=function(t){return new na(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},na.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},na.prototype.hn=function(){return!fr(this.limit)&&"F"===this.en},na.prototype.an=function(){return!fr(this.limit)&&"L"===this.en},na.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},na.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},na.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},na);function na(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=i,this.limit=r,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function ia(t){return new ea(t)}function ra(t){return null!==t.collectionGroup}function oa(t){var e=ta(t,ea);if(null===e.nn){e.nn=[];var n=e.cn(),i=e.un();if(null!==n&&null===i)n.O()||e.nn.push(new za(n)),e.nn.push(new za(nr.q(),"asc"));else{for(var r,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.O()&&(o=!0)}o||(r=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new za(nr.q(),r)))}}return e.nn}function sa(t){var e=ta(t,ea);if(!e.sn)if("F"===e.en)e.sn=yr(e.path,e.collectionGroup,oa(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=oa(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new za(o.field,s))}var a=e.endAt?new Va(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Va(e.startAt.position,!e.startAt.before):null;e.sn=yr(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function aa(t,e,n){return new ea(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ua(t,e){return new ea(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function ha(t,e){return new ea(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function ca(t,e){return gr(sa(t),sa(e))&&t.en===e.en}function la(t){return vr(sa(t))+"|lt:"+t.en}function fa(t){return"Query(target="+(n=(e=sa(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+wo(e.value);var e}).join(", ")+"]"),fr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ga(e.startAt)),e.endAt&&(n+=", endAt: "+Ga(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function pa(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.B(i.collectionGroup)&&i.path.C(o):ir.W(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.tn;e<n.length;e++){var i=n[e];if(!i.field.O()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Fa(e.startAt,oa(e),n))&&(!e.endAt||!Fa(e.endAt,oa(e),n)));var e,n,i,o}function da(a){return function(t,e){for(var n=!1,i=0,r=oa(a);i<r.length;i++){var o=r[i],s=function(t,e,n){var i,r,o,s,a=t.field.O()?ir.P(e.key,n.key):(i=t.field,r=n,o=e.field(i),s=r.field(i),null!==o&&null!==s?go(o,s):Li());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return Li()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var ya,va=(n(ga,ya=function(){}),ga.create=function(t,e,n){if(t.O())return"in"===e||"not-in"===e?this.fn(t,e,n):new Ea(t,e,n);if(_o(n)){if("=="!==e&&"!="!==e)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ga(t,e,n)}if(Oo(n)){if("=="!==e&&"!="!==e)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ga(t,e,n)}return"array-contains"===e?new Da(t,n):"in"===e?new La(t,n):"not-in"===e?new Ca(t,n):"array-contains-any"===e?new Ma(t,n):new ga(t,e,n)},ga.fn=function(t,e,n){return new("in"===e?Ia:Ta)(t,n)},ga.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.dn(go(e,this.value)):null!==e&&po(this.value)===po(e)&&this.dn(go(e,this.value))},ga.prototype.dn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Li()}},ga.prototype.ln=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},ga);function ga(t,e,n){var i=this;return(i=ya.call(this)||this).field=t,i.op=e,i.value=n,i}var ma,wa,ba,Ea=(n(_a,ba=va),_a.prototype.matches=function(t){var e=ir.P(t.key,this.key);return this.dn(e)},_a),Ia=(n(Aa,wa=va),Aa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Aa),Ta=(n(Na,ma=va),Na.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Na);function Na(t,e){var n=this;return(n=ma.call(this,t,"not-in",e)||this).keys=Oa(0,e),n}function Aa(t,e){var n=this;return(n=wa.call(this,t,"in",e)||this).keys=Oa(0,e),n}function _a(t,e,n){var i=this;return(i=ba.call(this,t,e,n)||this).key=ir.U(n.referenceValue),i}function Oa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ir.U(t.referenceValue)})}var Ra,Sa,ka,Pa,Da=(n(ja,Pa=va),ja.prototype.matches=function(t){var e=t.field(this.field);return Ao(e)&&vo(e.arrayValue,this.value)},ja),La=(n(qa,ka=va),qa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&vo(this.value.arrayValue,e)},qa),Ca=(n(xa,Sa=va),xa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!vo(this.value.arrayValue,e)},xa),Ma=(n(Ua,Ra=va),Ua.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ao(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return vo(e.value.arrayValue,t)})},Ua),Va=function(t,e){this.position=t,this.before=e};function Ua(t,e){return Ra.call(this,t,"array-contains-any",e)||this}function xa(t,e){return Sa.call(this,t,"not-in",e)||this}function qa(t,e){return ka.call(this,t,"in",e)||this}function ja(t,e){return Pa.call(this,t,"array-contains",e)||this}function Ga(t){return(t.before?"b":"a")+":"+t.position.map(wo).join(",")}function Fa(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.O()?ir.P(ir.U(s.referenceValue),n.key):go(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Ba(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yo(t.position[n],e.position[n]))return!1;return!0}var za=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Wa=(nu.prototype.Tn=function(t,e,n){for(var i,r,o,s=n.mn,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(i=u,r=e,o=s[a],e=i instanceof As?new Xs(i.key,o.version,i.value,{hasCommittedMutations:!0}):i instanceof _s?function(t,e,n){if(!ms(t.Be,e))return new Ys(t.key,n.version);var i=Ss(t,e);return new Xs(t.key,n.version,i,{hasCommittedMutations:!0})}(i,r,o):i instanceof Ps?function(t,e,n){if(Ci(null!=n.transformResults),!ms(t.Be,e))return new Ys(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Ci(t.length===n.length);for(var r,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Xs&&(c=e.field(u.field)),i.push((r=h,o=c,s=n[a],r instanceof Zo?ns(r,o):r instanceof rs?ss(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ls(t,i.data(),r);return new Xs(t.key,o,s,{hasCommittedMutations:!0})}(i,r,o):new Qs(i.key,o.version,{hasCommittedMutations:!0}))}return e},nu.prototype.En=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=bs(r,e,e,this.wn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=bs(u,e,o,this.wn))}return e},nu.prototype.In=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.En(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},nu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Br())},nu.prototype.isEqual=function(t){return this.batchId===t.batchId&&xi(this.mutations,t.mutations,Es)&&xi(this.baseMutations,t.baseMutations,Es)},nu),Ha=(eu.from=function(t,e,n){Ci(t.mutations.length===n.length);for(var i=Gr,r=t.mutations,o=0;o<r.length;o++)i=i.nt(r[o].key,n[o].version);return new eu(t,e,n,i)},eu),Ka=(tu.prototype.catch=function(t){return this.next(void 0,t)},tu.prototype.next=function(i,r){var o=this;return this.pn&&Li(),this.pn=!0,this.yn?this.error?this.gn(r,this.error):this.vn(i,this.result):new tu(function(e,n){o.Pn=function(t){o.vn(i,t).next(e,n)},o.Vn=function(t){o.gn(r,t).next(e,n)}})},tu.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},tu.prototype.Sn=function(t){try{var e=t();return e instanceof tu?e:tu.resolve(e)}catch(t){return tu.reject(t)}},tu.prototype.vn=function(t,e){return t?this.Sn(function(){return t(e)}):tu.resolve(e)},tu.prototype.gn=function(t,e){return t?this.Sn(function(){return t(e)}):tu.reject(e)},tu.resolve=function(n){return new tu(function(t,e){t(n)})},tu.reject=function(n){return new tu(function(t,e){e(n)})},tu.Cn=function(t){return new tu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},tu.Dn=function(t){for(var n=tu.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?tu.resolve(t):e()})}(i[e]);return n},tu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Cn(r)},tu),Xa=(Za.prototype.kn=function(e,n){var i=this;return this.Nn.xn(e,n).next(function(t){return i.Ln(e,n,t)})},Za.prototype.Ln=function(t,i,r){return this.Fn.On(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].En(i,t);return t})},Za.prototype.qn=function(t,e,r){var o=Ur;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].En(t,e);o=o.nt(t,e)}),o},Za.prototype.Mn=function(e,t){var n=this;return this.Fn.getEntries(e,t).next(function(t){return n.Un(e,t)})},Za.prototype.Un=function(i,r){var o=this;return this.Nn.Bn(i,r).next(function(t){var e=o.qn(i,r,t),n=Ur;return e.forEach(function(t,e){e=e||new Qs(t,Ji.min()),n=n.nt(t,e)}),n})},Za.prototype.Wn=function(t,e,n){return i=e,ir.W(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.Qn(t,e.path):ra(e)?this.jn(t,e,n):this.Gn(t,e,n);var i},Za.prototype.Qn=function(t,e){return this.kn(t,new ir(e)).next(function(t){var e=jr;return t instanceof Xs&&(e=e.nt(t.key,t)),e})},Za.prototype.jn=function(n,i,r){var o=this,s=i.collectionGroup,a=jr;return this.$n.Kn(n,s).next(function(t){return Ka.forEach(t,function(t){var e=i.rn(t.child(s));return o.Gn(n,e,r).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Za.prototype.Gn=function(e,n,t){var c,l,i=this;return this.Fn.Wn(e,n,t).next(function(t){return c=t,i.Nn.zn(e,n)}).next(function(t){return l=t,i.Hn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=bs(s,u,u,i.wn);c=h instanceof Xs?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){pa(n,e)||(c=c.remove(t))}),c})},Za.prototype.Hn=function(t,e,n){for(var i=Br(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof _s&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.Fn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xs&&(h=h.nt(t,e))}),h})},Za),Qa=(Ja.Jn=function(t,e){for(var n=Br(),i=Br(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Ja(t,e.fromCache,n,i)},Ja),Ya=($a.prototype.ts=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},$a.prototype.next=function(){var t=++this.previousValue;return this.es&&this.es(t),t},$a);function $a(t,e){var n=this;this.previousValue=t,e&&(e.Zn=function(t){return n.ts(t)},this.es=function(t){return e.ns(t)})}function Ja(t,e,n,i){this.targetId=t,this.fromCache=e,this.Yn=n,this.Xn=i}function Za(t,e,n){this.Fn=t,this.Nn=e,this.$n=n}function tu(t){var e=this;this.Pn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.Pn&&e.Pn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function eu(t,e,n,i){this.batch=t,this.Rn=e,this.mn=n,this.An=i}function nu(t,e,n,i){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=i}function iu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Ya.ss=-1;var ru=(ou.prototype.reset=function(){this.cs=0},ou.prototype.fs=function(){this.cs=this.us},ou.prototype.ds=function(t){var e=this;this.cancel();var n=Math.floor(this.cs+this.ws()),i=Math.max(0,Date.now()-this._s),r=Math.max(0,n-i);0<r&&Si("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.cs+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.ls=this.rs.Ts(this.os,r,function(){return e._s=Date.now(),t()}),this.cs*=this.as,this.cs<this.hs&&(this.cs=this.hs),this.cs>this.us&&(this.cs=this.us)},ou.prototype.ms=function(){null!==this.ls&&(this.ls.Es(),this.ls=null)},ou.prototype.cancel=function(){null!==this.ls&&(this.ls.cancel(),this.ls=null)},ou.prototype.ws=function(){return(Math.random()-.5)*this.cs},ou);function ou(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.rs=t,this.os=e,this.hs=n,this.as=i,this.us=r,this.cs=0,this.ls=null,this._s=Date.now(),this.reset()}function su(t){return"IndexedDbTransactionError"===t.name}function au(){return"undefined"!=typeof document?document:null}var uu=(lu.Vs=function(t,e,n,i,r){var o=new lu(t,e,Date.now()+n,i,r);return o.start(n),o},lu.prototype.start=function(t){var e=this;this.ys=setTimeout(function(){return e.ps()},t)},lu.prototype.Es=function(){return this.ps()},lu.prototype.cancel=function(t){null!==this.ys&&(this.clearTimeout(),this.Ps.reject(new Yi(Qi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},lu.prototype.ps=function(){var e=this;this.Is.gs(function(){return null!==e.ys?(e.clearTimeout(),e.op().then(function(t){return e.Ps.resolve(t)})):Promise.resolve()})},lu.prototype.clearTimeout=function(){null!==this.ys&&(this.As(this),clearTimeout(this.ys),this.ys=null)},lu),hu=(Object.defineProperty(cu.prototype,"xs",{get:function(){return this.Ss},enumerable:!1,configurable:!0}),cu.prototype.gs=function(t){this.enqueue(t)},cu.prototype.Ls=function(t){this.Os(),this.qs(t)},cu.prototype.Ms=function(t){return this.Os(),this.qs(t)},cu.prototype.Us=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Os(),this.Ss?[3,2]:(this.Ss=!0,(e=au())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.ks),[4,this.Ms(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},cu.prototype.enqueue=function(t){return this.Os(),this.Ss?new Promise(function(t){}):this.qs(t)},cu.prototype.Bs=function(t){var e=this;this.bs.push(t),this.gs(function(){return e.Ws()})},cu.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.bs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.bs[0]()];case 2:return t.sent(),this.bs.shift(),this.$s.reset(),[3,4];case 3:if(!su(e=t.sent()))throw e;return Si("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.bs.length&&this.$s.ds(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},cu.prototype.qs=function(t){var i=this,e=this.vs.then(function(){return i.Fs=!0,t().catch(function(t){throw i.Ds=t,i.Fs=!1,ki("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Fs=!1,t})});return this.vs=e},cu.prototype.Ts=function(t,e,n){var i=this;this.Os(),-1<this.Ns.indexOf(t)&&(e=0);var r=uu.Vs(this,t,e,n,function(t){return i.Qs(t)});return this.Cs.push(r),r},cu.prototype.Os=function(){this.Ds&&Li()},cu.prototype.js=function(){},cu.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.vs];case 1:t.sent(),t.label=2;case 2:if(e!==this.vs)return[3,0];t.label=3;case 3:return[2]}})})},cu.prototype.Ks=function(t){for(var e=0,n=this.Cs;e<n.length;e++)if(n[e].os===t)return!0;return!1},cu.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Cs.sort(function(t,e){return t.Rs-e.Rs});for(var t=0,e=r.Cs;t<e.length;t++){var n=e[t];if(n.Es(),"all"!==i&&n.os===i)break}return r.Gs()})},cu.prototype.Hs=function(t){this.Ns.push(t)},cu.prototype.Qs=function(t){var e=this.Cs.indexOf(t);this.Cs.splice(e,1)},cu);function cu(){var e=this;this.vs=Promise.resolve(),this.bs=[],this.Ss=!1,this.Cs=[],this.Ds=null,this.Fs=!1,this.Ns=[],this.$s=new ru(this,"async_queue_retry"),this.ks=function(){var t=au();t&&Si("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.$s.ms()};var t=au();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ks)}function lu(t,e,n,i,r){this.Is=t,this.os=e,this.Rs=n,this.op=i,this.As=r,this.Ps=new iu,this.then=this.Ps.promise.then.bind(this.Ps.promise),this.Ps.promise.catch(function(t){})}function fu(t,e){if(ki("AsyncQueue",e+": "+t),su(t))return new Yi(Qi.UNAVAILABLE,e+": "+t);throw t}var pu=(du.Zs=function(t){return new du(t,du.ti,du.ei)},du);function du(t,e,n){this.Ys=t,this.Xs=e,this.Js=n}pu.ni=-1,pu.si=1048576,pu.ii=41943040,pu.ti=10,pu.ei=1e3,pu.ri=new pu(pu.ii,pu.ti,pu.ei),pu.oi=new pu(pu.ni,0,0);var yu=(Iu.prototype.ai=function(t,e){return this.hi.add(e),Ka.resolve()},Iu.prototype.Kn=function(t,e){return Ka.resolve(this.hi.getEntries(e))},Iu),vu=(Eu.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Mr(tr.P),r=!i.has(n);return this.index[e]=i.add(n),r},Eu.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Eu.prototype.getEntries=function(t){return(this.index[t]||new Mr(tr.P)).F()},Eu),gu=(bu.prototype.next=function(){return this.ui+=2,this.ui},bu.ci=function(){return new bu(0)},bu.li=function(){return new bu(-1)},bu),mu=(wu.prototype.yi=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Nn,m=this.Ai,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Nn.pi(v).next(function(t){return g=t,e=i.persistence.Ti(r),m=new Xa(i.mi,e,i.persistence.Pi()),e.pi(v)}).next(function(t){for(var e=[],n=[],i=Br(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Mn(v,i).next(function(t){return{gi:t,vi:e,bi:n}})})})];case 1:return n=t.sent(),[2,(this.Nn=e,this.Ai=m,this._i.Vi(this.Ai),n)]}})})},wu.prototype.Si=function(h){var c,l=this,f=$i.now(),t=h.reduce(function(t,e){return t.add(e.key)},Br());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ai.Mn(u,t).next(function(t){c=t;for(var a,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(a=o,e=c.get(o.key),a instanceof Ps?function(t){for(var e=null,n=0,i=a.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Xs?t.field(r.field):void 0,s=Qo(r.transform,o||null);null!=s&&(e=null==e?(new qs).set(r.field,s):e.set(r.field,s))}return e?e.Ke():null}(e):null);null!=s&&n.push(new _s(o.key,s,function a(t){var u=[];return Bi(t.fields||{},function(t,e){var n=new nr([t]);if(Ro(e)){var i=a(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new ps(u)}(s.proto.mapValue),vs.exists(!0)))}return l.Nn.Ci(u,f,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Di:e}})},wu.prototype.Fi=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.mi.Ni({$i:!0});return r.ki(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Nn.xi(t)}).next(function(){return r.Ai.Mn(t,e)})})},wu.prototype.Li=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Nn.Oi(e,t).next(function(t){return Ci(null!==t),n=t.keys(),i.Nn.qi(e,t)}).next(function(){return i.Nn.xi(e)}).next(function(){return i.Ai.Mn(e,n)})})},wu.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Nn.Mi(t)})},wu.prototype.Ui=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Ui(t)})},wu.prototype.Bi=function(u){var h=this,c=u.J,l=this.fi;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.mi.Ni({$i:!0});l=h.fi;var s=[];u.Wt.forEach(function(t,e){var n,i,r=l.get(e);r&&(s.push(h.Ii.Wi(o,t.Jt,e).next(function(){return h.Ii.Qi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(i=r.tt(n,c).Z(o.ji),l=l.nt(e,i),wu.Gi(r,i,t)&&s.push(h.Ii.Ki(o,i))))});var t,a=Ur,n=Br();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.jt.forEach(function(t,e){var n=i.get(t);e instanceof Qs&&e.version.isEqual(Ji.min())?(r.zi(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.Hi(e,c),a=a.nt(t,e)):Si("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Xi.Yi(o,t))})})),c.isEqual(Ji.min())||(t=h.Ii.Ui(o).next(function(t){return h.Ii.Ji(o,o.ji,c)}),s.push(t)),Ka.Cn(s).next(function(){return r.apply(o)}).next(function(){return h.Ai.Un(o,a)})}).then(function(t){return h.fi=l,t})},wu.Gi=function(t,e,n){return Ci(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Zi||0<n.Yt.size+n.Xt.size+n.Jt.size},wu.prototype.tr=function(c){return d(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ka.forEach(c,function(e){return Ka.forEach(e.Yn,function(t){return h.persistence.Xi.er(n,e.targetId,t)}).next(function(){return Ka.forEach(e.Xn,function(t){return h.persistence.Xi.nr(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!su(e=t.sent()))throw e;return Si("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this.fi.get(o),a=s.J,u=s.et(a),this.fi=this.fi.nt(o,u));return[2]}})})},wu.prototype.sr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Nn.ir(t,e)})},wu.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ai.kn(t,e)})},wu.prototype.or=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.hr(e,i).next(function(t){return t?(n=t,Ka.resolve(n)):r.Ii.ar(e).next(function(t){return n=new Nr(i,t,0,e.ji),r.Ii.ur(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(r.fi=r.fi.nt(t.targetId,t),r.di.set(i,t.targetId)),t})},wu.prototype.hr=function(t,e){var n=this.di.get(e);return void 0!==n?Ka.resolve(this.fi.get(n)):this.Ii.hr(t,e)},wu.prototype.cr=function(o,s){return d(this,void 0,void 0,function(){var e,n,i,r=this;return y(this,function(t){switch(t.label){case 0:e=this.fi.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return r.persistence.Xi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!su(i=t.sent()))throw i;return Si("LocalStore","Failed to update sequence numbers for target "+o+": "+i),[3,5];case 5:return this.fi=this.fi.remove(o),this.di.delete(e.target),[2]}})})},wu.prototype.lr=function(t,n){var i=this,r=Ji.min(),o=Br();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.hr(e,sa(t)).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ii._r(e,t.targetId).next(function(t){o=t})}).next(function(){return i._i.Wn(e,t,n?r:Ji.min(),n?o:Br())}).next(function(t){return{documents:t,dr:o}})})},wu.prototype.ki=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=Ka.resolve();return n.forEach(function(i){a=a.next(function(){return o.On(t,i)}).next(function(t){var e=t,n=r.An.get(i);Ci(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(i,e,r))&&o.Hi(e,r.Rn)})}),a.next(function(){return e.Nn.qi(t,s)})},wu.prototype.wr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Tr(t,n.fi)})},wu);function wu(t,e,n){this.persistence=t,this._i=e,this.fi=new Rr(Ui),this.di=new Xi(vr,gr),this.wi=Ji.min(),this.Nn=t.Ti(n),this.mi=t.Ei(),this.Ii=t.Ri(),this.Ai=new Xa(this.mi,this.Nn,this.persistence.Pi()),this._i.Vi(this.Ai)}function bu(t){this.ui=t}function Eu(){this.index={}}function Iu(){this.hi=new vu}function Tu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Qi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Si("LocalStore","Unexpectedly lost primary lease"),[2]})})}mu.Zi=3e8;var Nu=(Su.prototype._=function(){return this.mr._()},Su.prototype.er=function(t,e){var n=new Au(t,e);this.mr=this.mr.add(n),this.Ir=this.Ir.add(n)},Su.prototype.Ar=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},Su.prototype.nr=function(t,e){this.Pr(new Au(t,e))},Su.prototype.Vr=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},Su.prototype.yr=function(t){var e=this,n=new ir(new tr([])),i=new Au(n,t),r=new Au(n,t+1),o=[];return this.Ir.bt([i,r],function(t){e.Pr(t),o.push(t.key)}),o},Su.prototype.pr=function(){var e=this;this.mr.forEach(function(t){return e.Pr(t)})},Su.prototype.Pr=function(t){this.mr=this.mr.delete(t),this.Ir=this.Ir.delete(t)},Su.prototype.gr=function(t){var e=new ir(new tr([])),n=new Au(e,t),i=new Au(e,t+1),r=Br();return this.Ir.bt([n,i],function(t){r=r.add(t.key)}),r},Su.prototype.vr=function(t){var e=new Au(t,0),n=this.mr.Ct(e);return null!==n&&t.isEqual(n.key)},Su),Au=(Ru.Er=function(t,e){return ir.P(t.key,e.key)||Ui(t.br,e.br)},Ru.Rr=function(t,e){return Ui(t.br,e.br)||ir.P(t.key,e.key)},Ru),_u=(Ou.prototype.Sr=function(){return null!=this.uid},Ou.prototype.Cr=function(){return this.Sr()?"uid:"+this.uid:"anonymous-user"},Ou.prototype.isEqual=function(t){return t.uid===this.uid},Ou);function Ou(t){this.uid=t}function Ru(t,e){this.key=t,this.br=e}function Su(){this.mr=new Mr(Au.Er),this.Ir=new Mr(Au.Rr)}function ku(t,e){this.user=e,this.type="OAuth",this.Nr={},this.Nr.Authorization="Bearer "+t}function Pu(t){this.key=t}function Du(t){this.key=t}function Lu(t,e,n){this.query=t,this.targetId=e,this.view=n}function Cu(t){this.key=t,this.oa=!1}function Mu(){this.qa=void 0,this.listeners=[]}_u.UNAUTHENTICATED=new _u(null),_u.Dr=new _u("google-credentials-uid"),_u.Fr=new _u("first-party-uid");var Vu,Uu,xu,qu,ju=(Th.prototype.getToken=function(){return Promise.resolve(null)},Th.prototype.kr=function(){},Th.prototype.xr=function(t){(this.$r=t)(_u.UNAUTHENTICATED)},Th.prototype.Lr=function(){this.$r=null},Th),Gu=(Ih.prototype.getToken=function(){var e=this,n=this.Mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Mr!==n?(Si("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ci("string"==typeof t.accessToken),new ku(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ih.prototype.kr=function(){this.forceRefresh=!0},Ih.prototype.xr=function(t){this.$r=t,this.qr&&t(this.currentUser)},Ih.prototype.Lr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Or),this.Or=null,this.$r=null},Ih.prototype.Ur=function(){var t=this.auth&&this.auth.getUid();return Ci(null===t||"string"==typeof t),new _u(t)},Ih),Fu=(Object.defineProperty(Eh.prototype,"Nr",{get:function(){var t={"X-Goog-AuthUser":this.Wr},e=this.Br.auth.Qr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Eh),Bu=(bh.prototype.getToken=function(){return Promise.resolve(new Fu(this.Br,this.Wr))},bh.prototype.xr=function(t){t(_u.Fr)},bh.prototype.Lr=function(){},bh.prototype.kr=function(){},bh),zu=(wh.prototype.Yr=function(){return 1===this.state||2===this.state||4===this.state},wh.prototype.Xr=function(){return 2===this.state},wh.prototype.start=function(){3!==this.state?this.auth():this.Jr()},wh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Yr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},wh.prototype.Zr=function(){this.state=0,this.$s.reset()},wh.prototype.to=function(){var t=this;this.Xr()&&null===this.Hr&&(this.Hr=this.rs.Ts(this.jr,6e4,function(){return t.eo()}))},wh.prototype.no=function(t){this.so(),this.stream.send(t)},wh.prototype.eo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Xr()?[2,this.close(0)]:[2]})})},wh.prototype.so=function(){this.Hr&&(this.Hr.cancel(),this.Hr=null)},wh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.so(),this.$s.cancel(),this.zr++,3!==e?this.$s.reset():n&&n.code===Qi.RESOURCE_EXHAUSTED?(ki(n.toString()),ki("Using maximum backoff delay to prevent overloading the backend."),this.$s.fs()):n&&n.code===Qi.UNAUTHENTICATED&&this.Kr.kr(),null!==this.stream&&(this.io(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ro(n)];case 1:return t.sent(),[2]}})})},wh.prototype.io=function(){},wh.prototype.auth=function(){var n=this;this.state=1;var t=this.oo(this.zr),e=this.zr;this.Kr.getToken().then(function(t){n.zr===e&&n.ho(t)},function(e){t(function(){var t=new Yi(Qi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ao(t)})})},wh.prototype.ho=function(t){var e=this,n=this.oo(this.zr);this.stream=this.uo(t),this.stream.co(function(){n(function(){return e.state=2,e.listener.co()})}),this.stream.ro(function(t){n(function(){return e.ao(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},wh.prototype.Jr=function(){var t=this;this.state=4,this.$s.ds(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},wh.prototype.ao=function(t){return Si("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},wh.prototype.oo=function(e){var n=this;return function(t){n.rs.gs(function(){return n.zr===e?t():(Si("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},wh),Wu=(n(mh,xu=zu),mh.prototype.uo=function(t){return this.Gr.lo("Listen",t)},mh.prototype.onMessage=function(t){this.$s.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Li(),a=e.targetChange.targetIds||[],u=(r=e.targetChange.resumeToken,t.Oe?(Ci(void 0===r||"string"==typeof r),wr.fromBase64String(r||"")):(Ci(void 0===r||r instanceof Uint8Array),wr.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=new Kr(s,a,u,h&&(i=void 0===(n=h).code?Qi.UNKNOWN:Or(n.code),new Yi(i,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=jo(t,l.document.name),p=Uo(l.document.updateTime),d=new xs({mapValue:{fields:l.document.fields}}),y=new Xs(f,p,d,{}),c=new Wr(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=jo(t,v.document),m=v.readTime?Uo(v.readTime):Ji.min(),w=new Qs(g,m);c=new Wr([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=jo(t,b.document);c=new Wr([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Li();e.filter;var I=e.filter;I.targetId;var T=new Er(I.count||0);c=new Hr(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ji.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ji.min():Uo(e.readTime)}(t);return this.listener._o(e,n)},mh.prototype.fo=function(t){var e,n,i,r,o={};o.database=Fo(this.serializer),o.addTarget=(e=this.serializer,(i=mr(r=(n=t).target)?{documents:{documents:[Go(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Go(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Oo(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(_o(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Oo(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NAN"}};if(_o(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:(e=t.op,ko[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Ho((e=t).field),direction:(n=e.dir,So[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Oe||fr(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Wo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wo(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.H()&&(i.resumeToken=Vo(e,n.resumeToken)),i);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Li()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.no(o)},mh.prototype.do=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.no(e)},mh),Hu=(n(gh,Uu=zu),Object.defineProperty(gh.prototype,"To",{get:function(){return this.wo},enumerable:!1,configurable:!0}),gh.prototype.start=function(){this.wo=!1,this.lastStreamToken=void 0,Uu.prototype.start.call(this)},gh.prototype.io=function(){this.wo&&this.mo([])},gh.prototype.uo=function(t){return this.Gr.lo("Write",t)},gh.prototype.onMessage=function(t){if(Ci(!!t.streamToken),this.lastStreamToken=t.streamToken,this.wo){this.$s.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Ci(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual(Ji.min())&&(n=Uo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new ys(n,i)}(t,r)})):[]),n=Uo(t.commitTime);return this.listener.Eo(n,e)}var i,r;return Ci(!t.writeResults||0===t.writeResults.length),this.wo=!0,this.listener.Io()},gh.prototype.Ro=function(){var t={};t.database=Fo(this.serializer),this.no(t)},gh.prototype.mo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.no(n)},gh),Ku=(n(vh,Vu=function(){}),vh.prototype.Po=function(){if(this.Ao)throw new Yi(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},vh.prototype.Vo=function(e,n,i){var r=this;return this.Po(),this.credentials.getToken().then(function(t){return r.Gr.Vo(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.kr(),t})},vh.prototype.yo=function(e,n,i){var r=this;return this.Po(),this.credentials.getToken().then(function(t){return r.Gr.yo(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.kr(),t})},vh.prototype.terminate=function(){this.Ao=!1},vh),Xu=(yh.prototype.Co=function(){var t=this;0===this.vo&&(this.Do("Unknown"),this.bo=this.Is.Ts("online_state_timeout",1e4,function(){return t.bo=null,t.Fo("Backend didn't respond within 10 seconds."),t.Do("Offline"),Promise.resolve()}))},yh.prototype.No=function(t){"Online"===this.state?this.Do("Unknown"):(this.vo++,1<=this.vo&&(this.$o(),this.Fo("Connection failed 1 times. Most recent error: "+t.toString()),this.Do("Offline")))},yh.prototype.set=function(t){this.$o(),this.vo=0,"Online"===t&&(this.So=!1),this.Do(t)},yh.prototype.Do=function(t){t!==this.state&&(this.state=t,this.po(t))},yh.prototype.Fo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.So?(ki(e),this.So=!1):Si("OnlineStateTracker",e)},yh.prototype.$o=function(){null!==this.bo&&(this.bo.cancel(),this.bo=null)},yh),Qu=(dh.prototype.start=function(){return this.enableNetwork()},dh.prototype.enableNetwork=function(){return this.Mo.delete(0),this.th()},dh.prototype.th=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(this.eh()?this.nh():this.jo.set("Unknown"),[4,this.sh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},dh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(0),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),[2]}})})},dh.prototype.ih=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Yo.stop()];case 1:return t.sent(),[4,this.Go.stop()];case 2:return t.sent(),0<this.Lo.length&&(Si("RemoteStore","Stopping write stream with "+this.Lo.length+" pending writes"),this.Lo=[]),this.rh(),[2]}})})},dh.prototype.oh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Si("RemoteStore","RemoteStore shutting down."),this.Mo.add(5),[4,this.ih()];case 1:return t.sent(),this.Uo.oh(),this.jo.set("Unknown"),[2]}})})},dh.prototype.listen=function(t){this.Oo.has(t.targetId)||(this.Oo.set(t.targetId,t),this.eh()?this.nh():this.Go.Xr()&&this.hh(t))},dh.prototype.ah=function(t){this.Oo.delete(t),this.Go.Xr()&&this.uh(t),0===this.Oo.size&&(this.Go.Xr()?this.Go.to():this.Wo()&&this.jo.set("Unknown"))},dh.prototype.Le=function(t){return this.Oo.get(t)||null},dh.prototype.xe=function(t){return this.lh.xe(t)},dh.prototype.hh=function(t){this.qo.de(t.targetId),this.Go.fo(t)},dh.prototype.uh=function(t){this.qo.de(t),this.Go.do(t)},dh.prototype.nh=function(){this.qo=new to(this),this.Go.start(),this.jo.Co()},dh.prototype.eh=function(){return this.Wo()&&!this.Go.Yr()&&0<this.Oo.size},dh.prototype.Wo=function(){return 0===this.Mo.size},dh.prototype.rh=function(){this.qo=null},dh.prototype.Ko=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Oo.forEach(function(t,e){n.hh(t)}),[2]})})},dh.prototype.zo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.rh(),this.eh()?(this.jo.No(e),this.nh()):this.jo.set("Unknown"),[2]})})},dh.prototype.Ho=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.jo.set("Online"),!(r instanceof Kr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this._h(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Si("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.fh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof Wr?this.qo.Pe(r):r instanceof Hr?this.qo.Ce(r):this.qo.pe(r),o.isEqual(Ji.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.ko.Ui()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.dh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Si("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.fh(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},dh.prototype.fh=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!su(n))throw n;return this.Mo.add(1),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),i=i||function(){return e.ko.Ui()},this.Is.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Si("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.Mo.delete(1),[4,this.th()];case 2:return t.sent(),[2]}})})}),[2]}})})},dh.prototype.wh=function(e){var n=this;return e().catch(function(t){return n.fh(t,e)})},dh.prototype.dh=function(i){var r=this,t=this.qo.Ne(i);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=r.Oo.get(e))&&r.Oo.set(e,n.tt(t.resumeToken,i))}),t.Qt.forEach(function(t){var e,n=r.Oo.get(t);n&&(r.Oo.set(t,n.tt(wr.Y,n.J)),r.uh(t),e=new Nr(n.target,t,1,n.sequenceNumber),r.hh(e))}),this.lh.Bi(t)},dh.prototype._h=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.Oo.has(r)?[4,this.lh.Th(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.Oo.delete(r),this.qo.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},dh.prototype.sh=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:e=0<this.Lo.length?this.Lo[this.Lo.length-1].batchId:-1,t.label=1;case 1:if(!this.mh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.ko.sr(e)];case 3:return null===(n=t.sent())?(0===this.Lo.length&&this.Yo.to(),[3,7]):(e=n.batchId,this.Eh(n),[3,6]);case 4:return i=t.sent(),[4,this.fh(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ih()&&this.Rh(),[2]}})})},dh.prototype.mh=function(){return this.Wo()&&this.Lo.length<10},dh.prototype.Ah=function(){return this.Lo.length},dh.prototype.Eh=function(t){this.Lo.push(t),this.Yo.Xr()&&this.Yo.To&&this.Yo.mo(t.mutations)},dh.prototype.Ih=function(){return this.Wo()&&!this.Yo.Yr()&&0<this.Lo.length},dh.prototype.Rh=function(){this.Yo.start()},dh.prototype.Xo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Yo.Ro(),[2]})})},dh.prototype.Zo=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this.Lo;e<n.length;e++)i=n[e],this.Yo.mo(i.mutations);return[2]})})},dh.prototype.Eo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Lo.shift(),n=Ha.from(e,r,o),[4,this.wh(function(){return i.lh.Ph(n)})];case 1:return t.sent(),[4,this.sh()];case 2:return t.sent(),[2]}})})},dh.prototype.Jo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Yo.To?[4,this.Vh(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ih()&&this.Rh(),[2]}})})},dh.prototype.Vh=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return _r(n=r.code)&&n!==Qi.ABORTED?(e=this.Lo.shift(),this.Yo.Zr(),[4,this.wh(function(){return i.lh.yh(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.sh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},dh.prototype.Qo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(4),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),this.Yo.Zr(),this.Go.Zr(),this.Mo.delete(4),[4,this.th()];case 2:return t.sent(),[2]}})})},dh.prototype.ph=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Is.js(),Si("RemoteStore","RemoteStore received new credentials"),this.Mo.add(3),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),[4,this.lh.ph(e)];case 2:return t.sent(),this.Mo.delete(3),[4,this.th()];case 3:return t.sent(),[2]}})})},dh.prototype.gh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Mo.delete(2),[4,this.th()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Mo.add(2),[4,this.ih()]);case 3:t.sent(),this.jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},dh),Yu=(ph.prototype.vh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},ph.prototype.bh=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},ph.prototype.Sh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},ph),$u=(fh.prototype.Fh=function(t){},fh.prototype.Nh=function(t,e,n){},fh.prototype.$h=function(t){return this.Ch.vh(t),this.Dh[t]||"not-current"},fh.prototype.kh=function(t,e,n){this.Dh[t]=e},fh.prototype.xh=function(t){this.Ch.bh(t)},fh.prototype.Lh=function(t){return this.Ch.activeTargetIds.has(t)},fh.prototype.Oh=function(t){delete this.Dh[t]},fh.prototype.qh=function(){return this.Ch.activeTargetIds},fh.prototype.Mh=function(t){return this.Ch.activeTargetIds.has(t)},fh.prototype.start=function(){return this.Ch=new Yu,Promise.resolve()},fh.prototype.yi=function(t,e,n){},fh.prototype.Uh=function(t){},fh.prototype.oh=function(){},fh.prototype.ns=function(t){},fh),Ju=(Object.defineProperty(lh.prototype,"Kh",{get:function(){return this.Bh},enumerable:!1,configurable:!0}),lh.prototype.zh=function(t,e){var a=this,u=e?e.Hh:new Qr,h=e?e.Gh:this.Gh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),i=(i=e instanceof Xs?e:null)&&(pa(a.query,i)?i:null),r=!!n&&a.qt.has(n.key),o=!!i&&(i.Ge||a.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.Yh(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.jh(i,p)||d&&a.jh(i,d)<0)&&(f=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Gh:l,Hh:u,Xh:f,qt:c}},lh.prototype.Yh=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},lh.prototype.Jh=function(t,e,n){var o=this,i=this.Gh;this.Gh=t.Gh,this.qt=t.qt;var r=t.Hh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.jh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Li()}}var i,r}),this.Zh(n);var s=e?this.ta():[],a=0===this.Qh.size&&this.Ht?1:0,u=a!==this.Wh;return this.Wh=a,0!==r.length||u?{snapshot:new Yr(this.query,t.Gh,i,r,t.qt,0==a,u,!1),ea:s}:{ea:s}},lh.prototype.na=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Jh({Gh:this.Gh,Hh:new Qr,qt:this.qt,Xh:!1},!1)):{ea:[]}},lh.prototype.sa=function(t){return!this.Bh.has(t)&&!!this.Gh.has(t)&&!this.Gh.get(t).Ge},lh.prototype.Zh=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Bh=e.Bh.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Bh=e.Bh.delete(t)}),this.Ht=t.Ht)},lh.prototype.ta=function(){var e=this;if(!this.Ht)return[];var n=this.Qh;this.Qh=Br(),this.Gh.forEach(function(t){e.sa(t.key)&&(e.Qh=e.Qh.add(t.key))});var i=[];return n.forEach(function(t){e.Qh.has(t)||i.push(new Du(t))}),this.Qh.forEach(function(t){n.has(t)||i.push(new Pu(t))}),i},lh.prototype.ia=function(t){this.Bh=t.dr,this.Qh=Br();var e=this.zh(t.documents);return this.Jh(e,!0)},lh.prototype.ra=function(){return Yr.Bt(this.query,this.Gh,this.qt,0===this.Wh)},lh),Zu=(Object.defineProperty(ch.prototype,"Aa",{get:function(){return!0===this.Ra},enumerable:!1,configurable:!0}),ch.prototype.subscribe=function(t){this.ca=t},ch.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.Pa("listen()"),(i=this.la.get(s))?(e=i.targetId,this.aa.$h(e),n=i.view.ra(),[3,4]):[3,1];case 1:return[4,this.ko.or(sa(s))];case 2:return r=t.sent(),o=this.aa.$h(r.targetId),e=r.targetId,[4,this.Va(s,e,"current"===o)];case 3:n=t.sent(),this.Aa&&this.ha.listen(r),t.label=4;case 4:return[2,n]}})})},ch.prototype.Va=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.ko.lr(a,!0)];case 1:return e=t.sent(),n=new Ju(a,e.dr),i=n.zh(e.documents),r=Jr.zt(u,h&&"Offline"!==this.onlineState),o=n.Jh(i,this.Aa,r),this.ya(u,o.ea),s=new Lu(a,u,n),[2,(this.la.set(a,s),this._a.has(u)?this._a.get(u).push(a):this._a.set(u,[a]),o.snapshot)]}})})},ch.prototype.ah=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("unlisten()"),e=this.la.get(r),1<(n=this._a.get(e.targetId)).length?[2,(this._a.set(e.targetId,n.filter(function(t){return!ca(t,r)})),void this.la.delete(r))]:this.Aa?(this.aa.xh(e.targetId),this.aa.Mh(e.targetId)?[3,2]:[4,this.ko.cr(e.targetId,!1).then(function(){i.aa.Oh(e.targetId),i.ha.ah(e.targetId),i.pa(e.targetId)}).catch(Tu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.pa(e.targetId),[4,this.ko.cr(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},ch.prototype.write=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:this.Pa("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.ko.Si(r)];case 2:return e=t.sent(),this.aa.Fh(e.batchId),this.ga(e.batchId,o),[4,this.va(e.Di)];case 3:return t.sent(),[4,this.ha.sh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=fu(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},ch.prototype.Bi=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.Pa("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Bi(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=i.wa.get(e);n&&(Ci(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.oa=!0:0<t.Xt.size?Ci(n.oa):0<t.Jt.size&&(Ci(n.oa),n.oa=!1))}),[4,this.va(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Tu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ch.prototype.na=function(i,t){var r;(this.Aa&&0===t||!this.Aa&&1===t)&&(this.Pa("applyOnlineStateChange()"),r=[],this.la.forEach(function(t,e){var n=e.view.na(i);n.snapshot&&r.push(n.snapshot)}),this.ca.ba(i),this.ca._o(r),this.onlineState=i,this.Aa&&this.aa.Uh(i))},ch.prototype.Th=function(a,u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("rejectListens()"),this.aa.kh(a,"rejected",u),e=this.wa.get(a),(n=e&&e.key)?(i=(i=new Rr(ir.P)).nt(n,new Qs(n,Ji.min())),r=Br().add(n),o=new $r(Ji.min(),new Map,new Mr(Ui),i,r),[4,this.Bi(o)]):[3,2];case 1:return t.sent(),this.da=this.da.remove(n),this.wa.delete(a),this.Sa(),[3,4];case 2:return[4,this.ko.cr(a,!1).then(function(){return s.pa(a,u)}).catch(Tu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},ch.prototype.Ph=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.Pa("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Fi(i)];case 2:return n=t.sent(),this.Ca(e,null),this.Da(e),this.aa.Nh(e,"acknowledged"),[4,this.va(n)];case 3:return t.sent(),[3,6];case 4:return[4,Tu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ch.prototype.yh=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.Pa("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Li(n)];case 2:return e=t.sent(),this.Ca(n,i),this.Da(n),this.aa.Nh(n,"rejected",i),[4,this.va(e)];case 3:return t.sent(),[3,6];case 4:return[4,Tu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ch.prototype.Fa=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:this.ha.Wo()||Si("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ko.Mi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Ea.get(e)||[]).push(o),this.Ea.set(e,n),[3,4]);case 3:return i=t.sent(),r=fu(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},ch.prototype.Da=function(t){(this.Ea.get(t)||[]).forEach(function(t){t.resolve()}),this.Ea.delete(t)},ch.prototype.Na=function(e){this.Ea.forEach(function(t){t.forEach(function(t){t.reject(new Yi(Qi.CANCELLED,e))})}),this.Ea.clear()},ch.prototype.ga=function(t,e){var n=(n=(n=this.ma[this.currentUser.Cr()])||new Rr(Ui)).nt(t,e);this.ma[this.currentUser.Cr()]=n},ch.prototype.Ca=function(t,e){var n,i=this.ma[this.currentUser.Cr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.ma[this.currentUser.Cr()]=i)},ch.prototype.pa=function(t,e){var n=this;void 0===e&&(e=null),this.aa.xh(t);for(var i=0,r=this._a.get(t);i<r.length;i++){var o=r[i];this.la.delete(o),e&&this.ca.$a(o,e)}this._a.delete(t),this.Aa&&this.Ta.yr(t).forEach(function(t){n.Ta.vr(t)||n.ka(t)})},ch.prototype.ka=function(t){var e=this.da.get(t);null!==e&&(this.ha.ah(e),this.da=this.da.remove(t),this.wa.delete(e),this.Sa())},ch.prototype.ya=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Pu?(this.Ta.er(r.key,t),this.xa(r)):r instanceof Du?(Si("SyncEngine","Document no longer in limbo: "+r.key),this.Ta.nr(r.key,t),this.Ta.vr(r.key)||this.ka(r.key)):Li()}},ch.prototype.xa=function(t){var e=t.key;this.da.get(e)||(Si("SyncEngine","New document in limbo: "+e),this.fa.push(e),this.Sa())},ch.prototype.Sa=function(){for(;0<this.fa.length&&this.da.size<this.ua;){var t=this.fa.shift(),e=this.Ia.next();this.wa.set(e,new Cu(t)),this.da=this.da.nt(t,e),this.ha.listen(new Nr(sa(ia(t.path)),e,2,Ya.ss))}},ch.prototype.La=function(){return this.da},ch.prototype.Oa=function(){return this.fa},ch.prototype.va=function(i,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.la.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.zh(i);return n.Xh?a.ko.lr(r.query,!1).then(function(t){var e=t.documents;return r.view.zh(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(r.targetId),i=r.view.Jh(t,a.Aa,n);a.ya(r.targetId,i.ea),i.snapshot&&(a.Aa&&a.aa.kh(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Qa.Jn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.ca._o(o),[4,this.ko.tr(s)];case 2:return t.sent(),[2]}})})},ch.prototype.Pa=function(t){},ch.prototype.ph=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Si("SyncEngine","User change. New user:",n.Cr()),[4,this.ko.yi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.Na("'waitForPendingWrites' promise is rejected due to a user change."),this.aa.yi(n,e.vi,e.bi),[4,this.va(e.gi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ch.prototype.xe=function(t){var e=this.wa.get(t);if(e&&e.oa)return Br().add(e.key);var n=Br(),i=this._a.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],a=this.la.get(s),n=n.Dt(a.view.Kh);return n},ch),th=(hh.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(i=this.Ma.get(e))||(n=!0,i=new Mu),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.lh.listen(e)];case 2:return r.qa=t.sent(),[3,4];case 3:return o=t.sent(),s=fu(o,"Initialization of query '"+fa(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.Ma.set(e,i),i.listeners.push(a),a.na(this.onlineState),i.qa&&a.Ba(i.qa)&&this.Wa(),[2]}})})},hh.prototype.ah=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.Ma.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.Ma.delete(e),this.lh.ah(e))]:[2]})})},hh.prototype._o=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.Ma.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Ba(r)&&(e=!0);s.qa=r}}e&&this.Wa()},hh.prototype.$a=function(t,e){var n=this.Ma.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.Ma.delete(t)},hh.prototype.ba=function(r){this.onlineState=r;var o=!1;this.Ma.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].na(r)&&(o=!0)}),o&&this.Wa()},hh.prototype.Qa=function(t){this.Ua.add(t),t.next()},hh.prototype.ja=function(t){this.Ua.delete(t)},hh.prototype.Wa=function(){this.Ua.forEach(function(t){t.next()})},hh),eh=(uh.prototype.Ba=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Yr(t.query,t.docs,t.Ot,e,t.qt,t.fromCache,t.Mt,!0)}var o=!1;return this.Ka?this.Ha(t)&&(this.Ga.next(t),o=!0):this.Ya(t,this.onlineState)&&(this.Xa(t),o=!0),this.za=t,o},uh.prototype.onError=function(t){this.Ga.error(t)},uh.prototype.na=function(t){this.onlineState=t;var e=!1;return this.za&&!this.Ka&&this.Ya(this.za,t)&&(this.Xa(this.za),e=!0),e},uh.prototype.Ya=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ja&&n||t.docs._()&&"Offline"!==e)},uh.prototype.Ha=function(t){if(0<t.docChanges.length)return!0;var e=this.za&&this.za.hasPendingWrites!==t.hasPendingWrites;return!(!t.Mt&&!e)&&!0===this.options.includeMetadataChanges},uh.prototype.Xa=function(t){t=Yr.Bt(t.query,t.docs,t.qt,t.fromCache),this.Ka=!0,this.Ga.next(t)},uh),nh=(ah.prototype.Vi=function(t){this.Za=t},ah.prototype.Wn=function(e,i,r,o){var s=this;return i.on()||r.isEqual(Ji.min())?this.tu(e,i):this.Za.Mn(e,o).next(function(t){var n=s.eu(i,t);return(i.hn()||i.an())&&s.Xh(i.en,n,o,r)?s.tu(e,i):(Ri()<=a.DEBUG&&Si("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),fa(i)),s.Za.Wn(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},ah.prototype.eu=function(n,t){var i=new Mr(da(n));return t.forEach(function(t,e){e instanceof Xs&&pa(n,e)&&(i=i.add(e))}),i},ah.prototype.Xh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},ah.prototype.tu=function(t,e){return Ri()<=a.DEBUG&&Si("IndexFreeQueryEngine","Using full collection scan to execute query:",fa(e)),this.Za.Wn(t,e,Ji.min())},ah),ih=(sh.prototype.iu=function(t){return Ka.resolve(0===this.Nn.length)},sh.prototype.Ci=function(t,e,n,i){var r=this.nu;this.nu++,0<this.Nn.length&&this.Nn[this.Nn.length-1];var o=new Wa(r,e,n,i);this.Nn.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.su=this.su.add(new Au(u.key,r)),this.$n.ai(t,u.key.path.g())}return Ka.resolve(o)},sh.prototype.Oi=function(t,e){return Ka.resolve(this.ru(e))},sh.prototype.ir=function(t,e){var n=e+1,i=this.ou(n),r=i<0?0:i;return Ka.resolve(this.Nn.length>r?this.Nn[r]:null)},sh.prototype.Mi=function(){return Ka.resolve(0===this.Nn.length?-1:this.nu-1)},sh.prototype.pi=function(t){return Ka.resolve(this.Nn.slice())},sh.prototype.xn=function(t,e){var n=this,i=new Au(e,0),r=new Au(e,Number.POSITIVE_INFINITY),o=[];return this.su.bt([i,r],function(t){var e=n.ru(t.br);o.push(e)}),Ka.resolve(o)},sh.prototype.Bn=function(t,e){var i=this,r=new Mr(Ui);return e.forEach(function(t){var e=new Au(t,0),n=new Au(t,Number.POSITIVE_INFINITY);i.su.bt([e,n],function(t){r=r.add(t.br)})}),Ka.resolve(this.hu(r))},sh.prototype.zn=function(t,e){var n=e.path,i=n.length+1,r=n;ir.W(r)||(r=r.child(""));var o=new Au(new ir(r),0),s=new Mr(Ui);return this.su.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.br)),!0)},o),Ka.resolve(this.hu(s))},sh.prototype.hu=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.ru(t);null!==e&&i.push(e)}),i},sh.prototype.qi=function(n,i){var r=this;Ci(0===this.au(i.batchId,"removed")),this.Nn.shift();var o=this.su;return Ka.forEach(i.mutations,function(t){var e=new Au(t.key,i.batchId);return o=o.delete(e),r.Xi.uu(n,t.key)}).next(function(){r.su=o})},sh.prototype.cu=function(t){},sh.prototype.vr=function(t,e){var n=new Au(e,0),i=this.su.Ct(n);return Ka.resolve(e.isEqual(i&&i.key))},sh.prototype.xi=function(t){return this.Nn.length,Ka.resolve()},sh.prototype.au=function(t,e){return this.ou(t)},sh.prototype.ou=function(t){return 0===this.Nn.length?0:t-this.Nn[0].batchId},sh.prototype.ru=function(t){var e=this.ou(t);return e<0||e>=this.Nn.length?null:this.Nn[e]},sh),rh=(oh.prototype.Hi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.lu(e);return this.docs=this.docs.nt(i,{_u:e,size:s,readTime:n}),this.size+=s-o,this.$n.ai(t,i.path.g())},oh.prototype.zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},oh.prototype.On=function(t,e){var n=this.docs.get(e);return Ka.resolve(n?n._u:null)},oh.prototype.getEntries=function(t,e){var n=this,i=Ur;return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e._u:null)}),Ka.resolve(i)},oh.prototype.Wn=function(t,e,n){for(var i=jr,r=new ir(e.path.child("")),o=this.docs.ut(r);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u._u,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Xs&&pa(e,h)&&(i=i.nt(h.key,h))}return Ka.resolve(i)},oh.prototype.fu=function(t,e){return Ka.forEach(this.docs,function(t){return e(t)})},oh.prototype.Ni=function(t){return new oh.du(this)},oh.prototype.wu=function(t){return Ka.resolve(this.size)},oh);function oh(t,e){this.$n=t,this.lu=e,this.docs=new Rr(ir.P),this.size=0}function sh(t,e){this.$n=t,this.Xi=e,this.Nn=[],this.nu=1,this.su=new Mr(Au.Er)}function ah(){}function uh(t,e,n){this.query=t,this.Ga=e,this.Ka=!1,this.za=null,this.onlineState="Unknown",this.options=n||{}}function hh(t){this.lh=t,this.Ma=new Xi(la,ca),this.onlineState="Unknown",this.Ua=new Set,this.lh.subscribe(this)}function ch(t,e,n,i,r,o){this.ko=t,this.ha=e,this.xo=n,this.aa=i,this.currentUser=r,this.ua=o,this.ca=null,this.la=new Xi(la,ca),this._a=new Map,this.fa=[],this.da=new Rr(ir.P),this.wa=new Map,this.Ta=new Nu,this.ma={},this.Ea=new Map,this.Ia=gu.li(),this.onlineState="Unknown",this.Ra=void 0}function lh(t,e){this.query=t,this.Bh=e,this.Wh=null,this.Ht=!1,this.Qh=Br(),this.qt=Br(),this.jh=da(t),this.Gh=new Xr(this.jh)}function fh(){this.Ch=new Yu,this.Dh={},this.po=null,this.Zn=null}function ph(){this.activeTargetIds=zr}function dh(t,e,n,i,r){var o,s,a,u,h,c,l,f,p=this;this.ko=t,this.xo=e,this.Is=n,this.Lo=[],this.Oo=new Map,this.qo=null,this.Mo=new Set,this.Uo=r,this.Uo.Bo(function(t){n.gs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(Si("RemoteStore","Restarting streams for network reachability change."),[4,this.Qo()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.jo=new Xu(n,i),this.Go=(h=this.xo,c=n,l={co:this.Ko.bind(this),ro:this.zo.bind(this),_o:this.Ho.bind(this)},(f=h).Po(),new Wu(c,f.Gr,f.credentials,f.serializer,l)),this.Yo=(o=this.xo,s=n,a={co:this.Xo.bind(this),ro:this.Jo.bind(this),Io:this.Zo.bind(this),Eo:this.Eo.bind(this)},(u=o).Po(),new Hu(s,u.Gr,u.credentials,u.serializer,a))}function yh(t,e){this.Is=t,this.po=e,this.state="Unknown",this.vo=0,this.bo=null,this.So=!0}function vh(t,e,n){var i=this;return(i=Vu.call(this)||this).credentials=t,i.Gr=e,i.serializer=n,i.Ao=!1,i}function gh(t,e,n,i,r){var o=this;return(o=Uu.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.wo=!1,o}function mh(t,e,n,i,r){var o=this;return(o=xu.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function wh(t,e,n,i,r,o){this.rs=t,this.jr=n,this.Gr=i,this.Kr=r,this.listener=o,this.state=0,this.zr=0,this.Hr=null,this.stream=null,this.$s=new ru(t,e)}function bh(t,e){this.Br=t,this.Wr=e}function Eh(t,e){this.Br=t,this.Wr=e,this.type="FirstParty",this.user=_u.Fr}function Ih(t){var e=this;this.Or=null,this.currentUser=_u.UNAUTHENTICATED,this.qr=!1,this.Mr=0,this.$r=null,this.forceRefresh=!1,this.Or=function(){e.Mr++,e.currentUser=e.Ur(),e.qr=!0,e.$r&&e.$r(e.currentUser)},this.Mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Or):(this.Or(null),t.get().then(function(t){e.auth=t,e.Or&&e.auth.addAuthTokenListener(e.Or)},function(){}))}function Th(){this.$r=null}function Nh(t){var e=this;return(e=qu.call(this)||this).Au=t,e}function Ah(){this.Di=new Xi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Tu=!1}rh.du=(Object.defineProperty(Ah.prototype,"readTime",{get:function(){return this.mu},set:function(t){this.mu=t},enumerable:!1,configurable:!0}),Ah.prototype.Hi=function(t,e){this.Eu(),this.readTime=e,this.Di.set(t.key,t)},Ah.prototype.zi=function(t,e){this.Eu(),e&&(this.readTime=e),this.Di.set(t,null)},Ah.prototype.On=function(t,e){this.Eu();var n=this.Di.get(e);return void 0!==n?Ka.resolve(n):this.Iu(t,e)},Ah.prototype.getEntries=function(t,e){return this.Ru(t,e)},Ah.prototype.apply=function(t){return this.Eu(),this.Tu=!0,this.Jh(t)},Ah.prototype.Eu=function(){},n(Nh,qu=Ah),Nh.prototype.Jh=function(n){var i=this,r=[];return this.Di.forEach(function(t,e){e?r.push(i.Au.Hi(n,e,i.readTime)):i.Au.zi(t)}),Ka.Cn(r)},Nh.prototype.Iu=function(t,e){return this.Au.On(t,e)},Nh.prototype.Ru=function(t,e){return this.Au.getEntries(t,e)},Nh);var _h,Oh,Rh=(Hh.prototype.ge=function(t,n){return this.Pu.forEach(function(t,e){return n(e)}),Ka.resolve()},Hh.prototype.Ui=function(t){return Ka.resolve(this.lastRemoteSnapshotVersion)},Hh.prototype.gu=function(t){return Ka.resolve(this.Vu)},Hh.prototype.ar=function(t){return this.highestTargetId=this.pu.next(),Ka.resolve(this.highestTargetId)},Hh.prototype.Ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Vu&&(this.Vu=e),Ka.resolve()},Hh.prototype.vu=function(t){this.Pu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.pu=new gu(e),this.highestTargetId=e),t.sequenceNumber>this.Vu&&(this.Vu=t.sequenceNumber)},Hh.prototype.ur=function(t,e){return this.vu(e),this.targetCount+=1,Ka.resolve()},Hh.prototype.Ki=function(t,e){return this.vu(e),Ka.resolve()},Hh.prototype.bu=function(t,e){return this.Pu.delete(e.target),this.yu.yr(e.targetId),--this.targetCount,Ka.resolve()},Hh.prototype.Su=function(n,i,r){var o=this,s=0,a=[];return this.Pu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Pu.delete(t),a.push(o.Cu(n,e.targetId)),s++)}),Ka.Cn(a).next(function(){return s})},Hh.prototype.Du=function(t){return Ka.resolve(this.targetCount)},Hh.prototype.hr=function(t,e){var n=this.Pu.get(e)||null;return Ka.resolve(n)},Hh.prototype.Qi=function(t,e,n){return this.yu.Ar(e,n),Ka.resolve()},Hh.prototype.Wi=function(e,t,n){this.yu.Vr(t,n);var i=this.persistence.Xi,r=[];return i&&t.forEach(function(t){r.push(i.uu(e,t))}),Ka.Cn(r)},Hh.prototype.Cu=function(t,e){return this.yu.yr(e),Ka.resolve()},Hh.prototype._r=function(t,e){var n=this.yu.gr(e);return Ka.resolve(n)},Hh.prototype.vr=function(t,e){return Ka.resolve(this.yu.vr(e))},Hh),Sh=(Wh.prototype.start=function(){return Promise.resolve()},Wh.prototype.oh=function(){return this.$u=!1,Promise.resolve()},Object.defineProperty(Wh.prototype,"xu",{get:function(){return this.$u},enumerable:!1,configurable:!0}),Wh.prototype.Lu=function(){},Wh.prototype.Ou=function(){},Wh.prototype.Pi=function(){return this.$n},Wh.prototype.Ti=function(t){var e=this.Fu[t.Cr()];return e||(e=new ih(this.$n,this.Xi),this.Fu[t.Cr()]=e),e},Wh.prototype.Ri=function(){return this.Ii},Wh.prototype.Ei=function(){return this.Fn},Wh.prototype.runTransaction=function(t,e,n){var i=this;Si("MemoryPersistence","Starting transaction:",t);var r=new kh(this.Nu.next());return this.Xi.qu(),n(r).next(function(t){return i.Xi.Mu(r).next(function(){return t})}).bn().then(function(t){return r.Uu(),t})},Wh.prototype.Bu=function(e,n){return Ka.Dn(Object.values(this.Fu).map(function(t){return function(){return t.vr(e,n)}}))},Wh),kh=(zh.prototype.Qu=function(t){this.Wu.push(t)},zh.prototype.Uu=function(){this.Wu.forEach(function(t){return t()})},n(Bh,Oh=zh),Bh),Ph=(Fh.Ku=function(t){return new Fh(t)},Object.defineProperty(Fh.prototype,"zu",{get:function(){if(this.Gu)return this.Gu;throw Li()},enumerable:!1,configurable:!0}),Fh.prototype.er=function(t,e,n){return this.ju.er(n,e),this.zu.delete(n),Ka.resolve()},Fh.prototype.nr=function(t,e,n){return this.ju.nr(n,e),this.zu.add(n),Ka.resolve()},Fh.prototype.uu=function(t,e){return this.zu.add(e),Ka.resolve()},Fh.prototype.removeTarget=function(t,e){var n=this;this.ju.yr(e.targetId).forEach(function(t){return n.zu.add(t)});var i=this.persistence.Ri();return i._r(t,e.targetId).next(function(t){t.forEach(function(t){return n.zu.add(t)})}).next(function(){return i.bu(t,e)})},Fh.prototype.qu=function(){this.Gu=new Set},Fh.prototype.Mu=function(t){var n=this,i=this.persistence.Ei().Ni();return Ka.forEach(this.zu,function(e){return n.Hu(t,e).next(function(t){t||i.zi(e)})}).next(function(){return n.Gu=null,i.apply(t)})},Fh.prototype.Yi=function(t,e){var n=this;return this.Hu(t,e).next(function(t){t?n.zu.delete(e):n.zu.add(e)})},Fh.prototype.ku=function(t){return 0},Fh.prototype.Hu=function(t,e){var n=this;return Ka.Dn([function(){return Ka.resolve(n.ju.vr(e))},function(){return n.persistence.Ri().vr(t,e)},function(){return n.persistence.Bu(t,e)}])},Fh),Dh=(Gh.prototype.co=function(t){this.Ju=t},Gh.prototype.ro=function(t){this.Zu=t},Gh.prototype.onMessage=function(t){this.tc=t},Gh.prototype.close=function(){this.Xu()},Gh.prototype.send=function(t){this.Yu(t)},Gh.prototype.ec=function(){this.Ju()},Gh.prototype.nc=function(t){this.Zu(t)},Gh.prototype.sc=function(t){this.tc(t)},Gh),Lh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ch=(jh.prototype.Vo=function(e,t,n,i){var r=this.hc(e,t);Si("RestConnection","Sending: ",r,n);var o={};return this.ac(o,i),this.uc(e,r,o,n).then(function(t){return Si("RestConnection","Received: ",t),t},function(t){throw Pi("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},jh.prototype.yo=function(t,e,n,i){return this.Vo(t,e,n,i)},jh.prototype.ac=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.18.0-202071122108",t["Content-Type"]="text/plain",e)for(var n in e.Nr)e.Nr.hasOwnProperty(n)&&(t[n]=e.Nr[n])},jh.prototype.hc=function(t,e){var n=Lh[t];return this.rc+"/v1/"+e+":"+n},n(qh,_h=jh),qh.prototype.uc=function(u,e,n,i){return new Promise(function(o,s){var a=new Ti;a.listenOnce(Ei.COMPLETE,function(){try{switch(a.getLastErrorCode()){case bi.NO_ERROR:var t=a.getResponseJson();Si("Connection","XHR received:",JSON.stringify(t)),o(t);break;case bi.TIMEOUT:Si("Connection",'RPC "'+u+'" timed out'),s(new Yi(Qi.DEADLINE_EXCEEDED,"Request time out"));break;case bi.HTTP_ERROR:var e,n,i=a.getStatus();Si("Connection",'RPC "'+u+'" failed with status:',i,"response text:",a.getResponseText()),0<i?(e=a.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Qi).indexOf(r)?r:Qi.UNKNOWN,s(new Yi(n,e.message))):s(new Yi(Qi.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Yi(Qi.UNAVAILABLE,"Connection failed."));break;default:Li()}}finally{Si("Connection",'RPC "'+u+'" completed.')}var r});var t=JSON.stringify(i);a.send(e,"POST",t,n,15)})},qh.prototype.lo=function(t,e){var n,i,r=[this.rc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ac(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Si("Connection","Creating WebChannel: "+a,s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Dh({Yu:function(t){l?Si("Connection","Not sending because WebChannel is closed:",t):(c||(Si("Connection","Opening WebChannel transport."),h.open(),c=!0),Si("Connection","WebChannel sending:",t),h.send(t))},Xu:function(){return h.close()}});return u(Ii.EventType.OPEN,function(){l||Si("Connection","WebChannel transport opened.")}),u(Ii.EventType.CLOSE,function(){l||(l=!0,Si("Connection","WebChannel transport closed"),f.nc())}),u(Ii.EventType.ERROR,function(t){l||(l=!0,Pi("Connection","WebChannel transport errored:",t),f.nc(new Yi(Qi.UNAVAILABLE,"The operation could not be completed")))}),u(Ii.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Ci(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Si("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Ir[r];if(void 0!==t)return Or(t)}(),s=i.message,void 0===o&&(o=Qi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.nc(new Yi(o,s)),h.close()):(Si("Connection","WebChannel received:",n),f.sc(n)))}),setTimeout(function(){f.ec()},0),f},qh),Mh=(xh.prototype.Bo=function(t){this.dc.push(t)},xh.prototype.oh=function(){window.removeEventListener("online",this.cc),window.removeEventListener("offline",this._c)},xh.prototype.wc=function(){window.addEventListener("online",this.cc),window.addEventListener("offline",this._c)},xh.prototype.lc=function(){Si("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(0)},xh.prototype.fc=function(){Si("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(1)},xh.Tc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},xh),Vh=(Uh.prototype.Bo=function(t){},Uh.prototype.oh=function(){},Uh);function Uh(){}function xh(){var t=this;this.cc=function(){return t.lc()},this._c=function(){return t.fc()},this.dc=[],this.wc()}function qh(t){var e=this;return(e=_h.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function jh(t){this.ic=t,this.s=t.s;var e=t.ssl?"https":"http";this.rc=e+"://"+t.host,this.oc="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Gh(t){this.Yu=t.Yu,this.Xu=t.Xu}function Fh(t){this.persistence=t,this.ju=new Nu,this.Gu=null}function Bh(t){var e=this;return(e=Oh.call(this)||this).ji=t,e}function zh(){this.Wu=[]}function Wh(t){var e=this;this.Fu={},this.Nu=new Ya(0),this.$u=!1,this.$u=!0,this.Xi=t(this),this.Ii=new Rh(this),this.$n=new yu,this.Fn=new rh(this.$n,function(t){return e.Xi.ku(t)})}function Hh(t){this.persistence=t,this.Pu=new Xi(vr,gr),this.lastRemoteSnapshotVersion=Ji.min(),this.highestTargetId=0,this.Vu=0,this.yu=new Nu,this.targetCount=0,this.pu=gu.ci()}function Kh(t){return new Po(t,!0)}var Xh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Qh=(Jh.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.aa=this.mc(e),this.persistence=this.Ec(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ic=this.Rc(e),this.ko=this.Ac(e),[2]}})})},Jh.prototype.Rc=function(t){return null},Jh.prototype.Ac=function(t){return e=this.persistence,n=new nh,i=t.Pc,new mu(e,n,i);var e,n,i},Jh.prototype.Ec=function(t){if(t.yc.Vc)throw new Yi(Qi.FAILED_PRECONDITION,Xh);return new Sh(Ph.Ku)},Jh.prototype.mc=function(t){return new $u},Jh.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.aa.oh()];case 1:return t.sent(),[4,this.persistence.oh()];case 2:return t.sent(),[2]}})})},Jh.prototype.clearPersistence=function(t,e){throw new Yi(Qi.FAILED_PRECONDITION,Xh)},Jh),Yh=($h.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.ko?[3,3]:(this.ko=n.ko,this.aa=n.aa,this.xo=this.pc(i),this.ha=this.gc(i),this.lh=this.vc(i),this.bc=this.Sc(i),this.aa.po=function(t){return e.lh.na(t,1)},this.ha.lh=this.lh,[4,this.ha.start()]);case 1:return t.sent(),[4,this.ha.gh(this.lh.Aa)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},$h.prototype.Sc=function(t){return new th(this.lh)},$h.prototype.pc=function(t){var e,n=Kh(t.ic.s),i=(e=t.ic,new Ch(e)),r=t.credentials;return new Ku(r,i,n)},$h.prototype.gc=function(t){var e=this;return new Qu(this.ko,this.xo,t.Is,function(t){return e.lh.na(t,0)},new(Mh.Tc()?Mh:Vh))},$h.prototype.vc=function(t){return e=this.ko,n=this.ha,i=this.xo,r=this.aa,o=t.Pc,s=t.ua,a=!t.yc.Vc||!t.yc.synchronizeTabs,u=new Zu(e,n,i,r,o,s),a&&(u.Ra=!0),u;var e,n,i,r,o,s,a,u},$h.prototype.terminate=function(){return this.ha.oh()},$h);function $h(){}function Jh(){}function Zh(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var tc=(ec.prototype.next=function(t){this.observer.next&&this.Cc(this.observer.next,t)},ec.prototype.error=function(t){this.observer.error?this.Cc(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ec.prototype.Dc=function(){this.muted=!0},ec.prototype.Cc=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ec);function ec(t){this.observer=t,this.muted=!1}function nc(t,e){if(0!==e.length)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+bc(e.length,"argument")+".")}function ic(t,e,n){if(e.length!==n)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires "+bc(n,"argument")+", but was called with "+bc(e.length,"argument")+".")}function rc(t,e,n){if(e.length<n)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+bc(n,"argument")+", but was called with "+bc(e.length,"argument")+".")}function oc(t,e,n,i){if(e.length<n||e.length>i)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+bc(e.length,"argument")+".")}function sc(t,e,n,i){fc(t,e,wc(n)+" argument",i)}function ac(t,e,n,i){void 0!==i&&sc(t,e,n,i)}function uc(t,e,n,i){fc(t,e,n+" option",i)}function hc(t,e,n,i){void 0!==i&&uc(t,e,n,i)}function cc(t,e,n,i,u){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=u;r<o.length;r++){var s=o[r];if(s===n)return;i.push(dc(s))}var a=dc(n);throw new Yi(Qi.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function lc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid value "+dc(i)+" provided to function "+t+"() for its "+wc(n)+" argument. Acceptable values: "+e.join(", "));return i}function fc(t,e,n,i){if(!("object"===e?pc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=dc(i);throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function pc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function dc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Li();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function yc(t,e,n){if(void 0===n)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+wc(e)+" argument, but it was undefined.")}function vc(n,t,i){Bi(t,function(t,e){if(i.indexOf(t)<0)throw new Yi(Qi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function gc(t,e,n,i){var r=dc(i);return new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+wc(n)+" argument to be a "+e+", but it was: "+r)}function mc(t,e,n){if(n<=0)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+wc(e)+" argument to be a positive number, but it was: "+n+".")}function wc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function bc(t,e){return t+" "+e+(1===t?"":"s")}function Ec(){if("undefined"==typeof Uint8Array)throw new Yi(Qi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ic(){if("undefined"==typeof atob)throw new Yi(Qi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Tc,Nc,Ac=(Lc.fromBase64String=function(t){ic("Blob.fromBase64String",arguments,1),sc("Blob.fromBase64String","string",1,t),Ic();try{return new Lc(wr.fromBase64String(t))}catch(t){throw new Yi(Qi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Lc.fromUint8Array=function(t){if(ic("Blob.fromUint8Array",arguments,1),Ec(),!(t instanceof Uint8Array))throw gc("Blob.fromUint8Array","Uint8Array",1,t);return new Lc(wr.fromUint8Array(t))},Lc.prototype.toBase64=function(){return ic("Blob.toBase64",arguments,0),Ic(),this.Fc.toBase64()},Lc.prototype.toUint8Array=function(){return ic("Blob.toUint8Array",arguments,0),Ec(),this.Fc.toUint8Array()},Lc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Lc.prototype.isEqual=function(t){return this.Fc.isEqual(t.Fc)},Lc),_c=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yi(Qi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(sc("FieldPath","string",e,t[e]),0===t[e].length)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Nc=new nr(t)},Oc=(n(Dc,Nc=_c),Dc.documentId=function(){return new Dc(nr.q().N())},Dc.prototype.isEqual=function(t){if(!(t instanceof Dc))throw gc("isEqual","FieldPath",1,t);return this.Nc.isEqual(t.Nc)},Dc),Rc=new RegExp("[~\\*/\\[\\]]"),Sc=function(){this.$c=this},kc=(n(Pc,Tc=Sc),Pc.prototype.xc=function(t){if(2!==t.Lc)throw 1===t.Lc?t.Oc(this.kc+"() can only appear at the top level of your update data"):t.Oc(this.kc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Pc.prototype.isEqual=function(t){return t instanceof Pc},Pc);function Pc(t){var e=this;return(e=Tc.call(this)||this).kc=t,e}function Dc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Nc.call(this,t)||this}function Lc(t){Ic(),this.Fc=t}function Cc(t,e,n){return new ul({Lc:3,qc:e.settings.qc,methodName:t.kc,Mc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Mc,Vc,Uc,xc,qc,jc,Gc=(n(sl,jc=Sc),sl.prototype.xc=function(t){return new fs(t.path,new Jo)},sl.prototype.isEqual=function(t){return t instanceof sl},sl),Fc=(n(ol,qc=Sc),ol.prototype.xc=function(t){var e=Cc(this,t,!0),n=this.Uc.map(function(t){return vl(t,e)}),i=new Zo(n);return new fs(t.path,i)},ol.prototype.isEqual=function(t){return this===t},ol),Bc=(n(rl,xc=Sc),rl.prototype.xc=function(t){var e=Cc(this,t,!0),n=this.Uc.map(function(t){return vl(t,e)}),i=new rs(n);return new fs(t.path,i)},rl.prototype.isEqual=function(t){return this===t},rl),zc=(n(il,Uc=Sc),il.prototype.xc=function(t){var e=new us(t.serializer,Co(t.serializer,this.Bc));return new fs(t.path,e)},il.prototype.isEqual=function(t){return this===t},il),Wc=(n(nl,Vc=Sc),nl.delete=function(){return nc("FieldValue.delete",arguments),new Hc(new kc("FieldValue.delete"))},nl.serverTimestamp=function(){return nc("FieldValue.serverTimestamp",arguments),new Hc(new Gc("FieldValue.serverTimestamp"))},nl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rc("FieldValue.arrayUnion",arguments,1),new Hc(new Fc("FieldValue.arrayUnion",t))},nl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rc("FieldValue.arrayRemove",arguments,1),new Hc(new Bc("FieldValue.arrayRemove",t))},nl.increment=function(t){return sc("FieldValue.increment","number",1,t),ic("FieldValue.increment",arguments,1),new Hc(new zc("FieldValue.increment",t))},nl),Hc=(n(el,Mc=Wc),el.prototype.xc=function(t){return this.$c.xc(t)},el.prototype.isEqual=function(t){return t instanceof el&&this.$c.isEqual(t.$c)},el),Kc=(Object.defineProperty(tl.prototype,"latitude",{get:function(){return this.Wc},enumerable:!1,configurable:!0}),Object.defineProperty(tl.prototype,"longitude",{get:function(){return this.Qc},enumerable:!1,configurable:!0}),tl.prototype.isEqual=function(t){return this.Wc===t.Wc&&this.Qc===t.Qc},tl.prototype.T=function(t){return Ui(this.Wc,t.Wc)||Ui(this.Qc,t.Qc)},tl),Xc=/^__.*__$/,Qc=function(t,e,n){this.jc=t,this.Gc=e,this.Kc=n},Yc=(Zc.prototype.zc=function(t,e){var n=[];return null!==this.qe?n.push(new _s(t,this.data,this.qe,e)):n.push(new As(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},Zc),$c=(Jc.prototype.zc=function(t,e){var n=[new _s(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},Jc);function Jc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Zc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function tl(t,e){if(ic("GeoPoint",arguments,2),sc("GeoPoint","number",1,t),sc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yi(Qi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yi(Qi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Wc=t,this.Qc=e}function el(t){var e=this;return(e=Mc.call(this)||this).$c=t,e.kc=t.kc,e}function nl(){return Vc.call(this)||this}function il(t,e){var n=this;return(n=Uc.call(this)||this).kc=t,n.Bc=e,n}function rl(t,e){var n=this;return(n=xc.call(this)||this).kc=t,n.Uc=e,n}function ol(t,e){var n=this;return(n=qc.call(this)||this).kc=t,n.Uc=e,n}function sl(t){var e=this;return(e=jc.call(this)||this).kc=t,e}function al(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Li()}}var ul=(Object.defineProperty(ll.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ll.prototype,"Lc",{get:function(){return this.settings.Lc},enumerable:!1,configurable:!0}),ll.prototype.Yc=function(t){return new ll(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},ll.prototype.Xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Yc({path:n,Mc:!1});return i.Jc(t),i},ll.prototype.Zc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Yc({path:n,Mc:!1});return i.Hc(),i},ll.prototype.tl=function(t){return this.Yc({path:void 0,Mc:!0})},ll.prototype.Oc=function(t){return Il(t,this.settings.methodName,this.settings.el||!1,this.path,this.settings.qc)},ll.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},ll.prototype.Hc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Jc(this.path.get(t))},ll.prototype.Jc=function(t){if(0===t.length)throw this.Oc("Document fields must not be empty");if(al(this.Lc)&&Xc.test(t))throw this.Oc('Document fields cannot begin and end with "__"')},ll),hl=(cl.prototype.nl=function(t,e,n,i){return void 0===i&&(i=!1),new ul({Lc:t,methodName:e,qc:n,path:nr.k(),Mc:!1,el:i},this.s,this.serializer,this.ignoreUndefinedProperties)},cl);function cl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Kh(t)}function ll(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Hc(),this.fieldTransforms=r||[],this.qe=o||[]}function fl(t,e,n,i,r,o){void 0===o&&(o={});var s=t.nl(o.merge||o.mergeFields?2:0,e,n,r);wl("Data must be an object, but it was:",s,i);var a,u,h=gl(i,s);if(o.merge)a=new ps(s.qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof _c)d=p.Nc;else{if("string"!=typeof p)throw Li();d=El(e,p,n)}if(!s.contains(d))throw new Yi(Qi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Tl(c,d)||c.push(d)}a=new ps(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Yc(new xs(h),a,u)}function pl(t,o,s,e){var a=t.nl(1,o,s);wl("Data must be an object, but it was:",a,e);var u=[],h=new qs;Bi(e,function(t,e){var n,i=El(o,t,s),r=a.Zc(i);e instanceof Sc&&e.$c instanceof kc?u.push(i):null!=(n=vl(e,r))&&(u.push(i),h.set(i,n))});var n=new ps(u);return new $c(h.Ke(),n,a.fieldTransforms)}function dl(t,e,n,i,r,o){var s=t.nl(1,e,n),a=[bl(e,i,n)],u=[r];if(o.length%2!=0)throw new Yi(Qi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(bl(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new qs,v=a.length-1;0<=v;--v)Tl(d,a[v])||(c=a[v],l=u[v],f=s.Zc(c),l instanceof Sc&&l.$c instanceof kc?d.push(c):null!=(p=vl(l,f))&&(d.push(c),y.set(c,p)));var g=new ps(d);return new $c(y.Ke(),g,s.fieldTransforms)}function yl(t,e,n,i){return void 0===i&&(i=!1),vl(n,t.nl(i?4:3,e))}function vl(s,t){if(ml(s))return wl("Unsupported field value:",t,s),gl(s,t);if(s instanceof Sc)return function(t,e){if(!al(e.Lc))throw e.Oc(t.kc+"() can only be used with update() and set()");if(!e.path)throw e.Oc(t.kc+"() is not currently supported inside arrays");var n=t.xc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.Mc&&4!==t.Lc)throw t.Oc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=vl(r[i],t.tl(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$i.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof $i){var i=new $i(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,i)}}if(t instanceof Kc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ac)return{bytesValue:Vo(e.serializer,t)};if(t instanceof Qc){var r=e.s,o=t.jc;if(!o.isEqual(r))throw e.Oc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:xo(t.jc||e.s,t.Gc.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Oc("Unsupported field value: "+dc(t))}(s,t)}function gl(t,i){var r={};return zi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):Bi(t,function(t,e){var n=vl(e,i.Xc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function ml(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $i||t instanceof Kc||t instanceof Ac||t instanceof Qc||t instanceof Sc)}function wl(t,e,n){if(!ml(n)||!pc(n)){var i=dc(n);throw"an object"===i?e.Oc(t+" a custom object"):e.Oc(t+" "+i)}}function bl(t,e,n){if(e instanceof _c)return e.Nc;if("string"==typeof e)return El(t,e);throw Il("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function El(t,e,n){try{return function(e){if(0<=e.search(Rc))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Oc.bind.apply(Oc,r([void 0],e.split("."))))}catch(t){throw new Yi(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Nc}catch(e){throw Il(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Il(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+i),s&&(u+=" in document "+r),u+=")"),new Yi(Qi.INVALID_ARGUMENT,(a+=". ")+t+u)}function Tl(t,e){return t.some(function(t){return t.isEqual(e)})}var Nl=(Sl.prototype.hl=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.al(),0<this.mutations.length)throw new Yi(Qi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Fo((r=a).serializer)+"/documents",n={documents:u.map(function(t){return qo(r.serializer,t)})},[4,r.yo("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Ci(!!e.found),e.found.name,e.found.updateTime;var n=jo(t,e.found.name),i=Uo(e.found.updateTime),r=new xs({mapValue:{fields:e.found.fields}});return new Xs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Ci(!!e.missing),Ci(!!e.readTime);var n=jo(t,e.missing),i=Uo(e.readTime);return new Qs(n,i)}(e,n):Li());o.set(i.key.toString(),i)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Ci(!!e),s.push(e)}),s)]}})})}(this.xo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Qs||t instanceof Xs?n.ul(t):Li()}),e)]}})})},Sl.prototype.set=function(t,e){this.write(e.zc(t,this.Be(t))),this.ol.add(t)},Sl.prototype.update=function(t,e){try{this.write(e.zc(t,this.cl(t)))}catch(t){this.rl=t}this.ol.add(t)},Sl.prototype.delete=function(t){this.write([new Vs(t,this.Be(t))]),this.ol.add(t)},Sl.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.al(),this.rl)throw this.rl;return e=this.sl,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ir(tr.$(e));i.mutations.push(new Us(n,i.Be(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Fo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return zo(e.serializer,t)})},[4,e.Vo("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.xo,this.mutations)];case 1:return t.sent(),this.il=!0,[2]}})})},Sl.prototype.ul=function(t){var e;if(t instanceof Xs)e=t.version;else{if(!(t instanceof Qs))throw Li();e=Ji.min()}var n=this.sl.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yi(Qi.ABORTED,"Document version changed between two reads.")}else this.sl.set(t.key.toString(),e)},Sl.prototype.Be=function(t){var e=this.sl.get(t.toString());return!this.ol.has(t)&&e?vs.updateTime(e):vs.je()},Sl.prototype.cl=function(t){var e=this.sl.get(t.toString());if(this.ol.has(t)||!e)return vs.exists(!0);if(e.isEqual(Ji.min()))throw new Yi(Qi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},Sl.prototype.write=function(t){this.al(),this.mutations=this.mutations.concat(t)},Sl.prototype.al=function(){},Sl),Al=(Rl.prototype.run=function(){this._l()},Rl.prototype._l=function(){var t=this;this.$s.ds(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new Nl(this.xo),(n=this.fl(e))&&n.then(function(t){i.Is.gs(function(){return e.commit().then(function(){i.Ps.resolve(t)}).catch(function(t){i.dl(t)})})}).catch(function(t){i.dl(t)}),[2]})})})},Rl.prototype.fl=function(t){try{var e=this.updateFunction(t);return!fr(e)&&e.catch&&e.then?e:(this.Ps.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ps.reject(t),null}},Rl.prototype.dl=function(t){var e=this;0<this.ll&&this.wl(t)?(--this.ll,this.Is.gs(function(){return e._l(),Promise.resolve()})):this.Ps.reject(t)},Rl.prototype.wl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!_r(e)},Rl),_l=(Ol.prototype.start=function(t,e,n,i){var r=this;this.ml(),this.ic=t;var o=new iu,s=!1;return this.credentials.xr(function(t){return s?void r.Is.Bs(function(){return r.ha.ph(t)}):(s=!0,Si("FirestoreClient","Initializing. user=",t.uid),r.El(e,n,i,t,o).then(r.Tl.resolve,r.Tl.reject))}),this.Is.gs(function(){return r.Tl.promise}),o.promise},Ol.prototype.enableNetwork=function(){var t=this;return this.ml(),this.Is.enqueue(function(){return t.persistence.Ou(!0),t.ha.enableNetwork()})},Ol.prototype.El=function(r,o,s,a,u){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Is:this.Is,ic:this.ic,clientId:this.clientId,credentials:this.credentials,Pc:a,ua:100,yc:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.aa=r.aa,this.ko=r.ko,this.Ic=r.Ic,this.xo=o.xo,this.ha=o.ha,this.lh=o.lh,this.Il=o.bc,this.persistence.Lu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.Rl(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.El(new Qh,new Yh,{Vc:!1},a,u))];case 4:return[2]}})})},Ol.prototype.Rl=function(t){return"FirebaseError"===t.name?t.code===Qi.FAILED_PRECONDITION||t.code===Qi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ol.prototype.ml=function(){if(this.Is.xs)throw new Yi(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},Ol.prototype.disableNetwork=function(){var t=this;return this.ml(),this.Is.enqueue(function(){return t.persistence.Ou(!1),t.ha.disableNetwork()})},Ol.prototype.terminate=function(){var t=this;return this.Is.Us(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.ha.oh()];case 1:return t.sent(),[4,this.aa.oh()];case 2:return t.sent(),[4,this.persistence.oh()];case 3:return t.sent(),this.credentials.Lr(),[2]}})})})},Ol.prototype.waitForPendingWrites=function(){var t=this;this.ml();var e=new iu;return this.Is.gs(function(){return t.lh.Fa(e)}),e.promise},Ol.prototype.listen=function(t,e,n){var i=this;this.ml();var r=new tc(n),o=new eh(t,r,e);return this.Is.gs(function(){return i.Il.listen(o)}),function(){r.Dc(),i.Is.gs(function(){return i.Il.ah(o)})}},Ol.prototype.Al=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ml(),[4,this.Tl.promise];case 1:return[2,(t.sent(),function(n,o,s){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){switch(t.label){case 0:return r=new iu,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.rr(s)];case 1:return(e=t.sent())instanceof Xs?r.resolve(e):e instanceof Qs?r.resolve(null):r.reject(new Yi(Qi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=fu(n,"Failed to get document '"+s+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})}(this.Is,this.ko,e))]}})})},Ol.prototype.Pl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ml(),[4,this.Tl.promise];case 1:return[2,(t.sent(),e=this.Is,n=this.Il,i=a,r=u,o=new iu,s=kl(e,n,ia(i.path),{includeMetadataChanges:!0,Ja:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Yi(Qi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Yi(Qi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ol.prototype.Vl=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ml(),[4,this.Tl.promise];case 1:return[2,(t.sent(),function(n,u,h){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return a=new iu,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u.lr(h,!0)];case 1:return e=t.sent(),n=new Ju(h,e.dr),i=n.zh(e.documents),r=n.Jh(i,!1),a.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=fu(o,"Failed to execute query '"+h+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})}(this.Is,this.ko,e))]}})})},Ol.prototype.yl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ml(),[4,this.Tl.promise];case 1:return[2,(t.sent(),e=this.Is,n=this.Il,i=a,r=u,o=new iu,s=kl(e,n,i,{includeMetadataChanges:!0,Ja:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Yi(Qi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ol.prototype.write=function(t){var e=this;this.ml();var n=new iu;return this.Is.gs(function(){return e.lh.write(t,n)}),n.promise},Ol.prototype.s=function(){return this.ic.s},Ol.prototype.Qa=function(t){var e=this;this.ml();var n=new tc(t);return this.Is.gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Il.Qa(n)]})})}),function(){n.Dc(),e.Is.gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Il.ja(n)]})})})}},Object.defineProperty(Ol.prototype,"pl",{get:function(){return this.Is.xs},enumerable:!1,configurable:!0}),Ol.prototype.transaction=function(t){var e=this;this.ml();var n=new iu;return this.Is.gs(function(){return new Al(e.Is,e.xo,t,n).run(),Promise.resolve()}),n.promise},Ol);function Ol(t,e){this.credentials=t,this.Is=e,this.clientId=Mi.t(),this.Tl=new iu}function Rl(t,e,n,i){this.Is=t,this.xo=e,this.updateFunction=n,this.Ps=i,this.ll=5,this.$s=new ru(this.Is,"transaction_retry")}function Sl(t){this.xo=t,this.sl=new Map,this.mutations=[],this.il=!1,this.rl=null,this.ol=new Set}function kl(t,e,n,i,r){var o=new tc(r),s=new eh(n,o,i);return t.gs(function(){return e.listen(s)}),function(){o.Dc(),t.gs(function(){return e.ah(s)})}}var Pl,Dl,Ll=($l.prototype.bl=function(t){switch(po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Sl(t.timestampValue);case 4:return this.Cl(t);case 5:return t.stringValue;case 6:return new Ac(Io(t.bytesValue));case 7:return this.Dl(t.referenceValue);case 8:return this.Fl(t.geoPointValue);case 9:return this.Nl(t.arrayValue);case 10:return this.$l(t.mapValue);default:throw Li()}},$l.prototype.$l=function(t){var n=this,i={};return Bi(t.fields||{},function(t,e){i[t]=n.bl(e)}),i},$l.prototype.Fl=function(t){return new Kc(Eo(t.latitude),Eo(t.longitude))},$l.prototype.Nl=function(t){var e=this;return(t.values||[]).map(function(t){return e.bl(t)})},$l.prototype.Cl=function(t){switch(this.gl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return co(n)?t(n):n}(t);return null==e?null:this.bl(e);case"estimate":return this.Sl(lo(t));default:return null}},$l.prototype.Sl=function(t){var e=bo(t),n=new $i(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},$l.prototype.Dl=function(t){var e=tr.$(t);Ci(Ko(e));var n=new ji(e.get(1),e.get(3)),i=new ir(e.p(5));return n.isEqual(this.s)||ki("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.vl(i)},$l),Cl=pu.ni,Ml=(Yl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Yl),Vl=(Object.defineProperty(Ql.prototype,"jl",{get:function(){return this.Gl||(this.Gl=new hl(this.jc,this.Ql.ignoreUndefinedProperties)),this.Gl},enumerable:!1,configurable:!0}),Ql.prototype.settings=function(t){ic("Firestore.settings",arguments,1),sc("Firestore.settings","object",1,t);var e=new Ml(t);if(this.Ml&&!this.Ql.isEqual(e))throw new Yi(Qi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ql=e).credentials&&(this.Wl=function(t){if(!t)return new ju;switch(t.type){case"gapi":var e=t.Kl;return Ci(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Bu(e,t.Wr||"0");case"provider":return t.Kl;default:throw new Yi(Qi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Ql.prototype.enableNetwork=function(){return this.ql(),this.Ml.enableNetwork()},Ql.prototype.disableNetwork=function(){return this.ql(),this.Ml.disableNetwork()},Ql.prototype.enablePersistence=function(t){var e,n;if(this.Ml)throw new Yi(Qi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&ki("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Yi(Qi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.zl(this.kl,this.xl,{Vc:!0,cacheSizeBytes:this.Ql.cacheSizeBytes,synchronizeTabs:i,Hl:r})},Ql.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Ml&&!this.Ml.pl)throw new Yi(Qi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new iu,[2,(this.Ol.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.kl.clearPersistence(this.jc,this.Bl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Ql.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ql.prototype,"Yl",{get:function(){return this.ql(),this.Ml.pl},enumerable:!1,configurable:!0}),Ql.prototype.waitForPendingWrites=function(){return this.ql(),this.Ml.waitForPendingWrites()},Ql.prototype.onSnapshotsInSync=function(t){if(this.ql(),Zh(t))return this.Ml.Qa(t);sc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Ml.Qa(e)},Ql.prototype.ql=function(){return this.Ml||this.zl(new Qh,new Yh,{Vc:!1}),this.Ml},Ql.prototype.Xl=function(){return new qi(this.jc,this.Bl,this.Ql.host,this.Ql.ssl,this.Ql.forceLongPolling)},Ql.prototype.zl=function(t,e,n){var i=this.Xl();return this.Ml=new _l(this.Wl,this.Ol),this.Ml.start(i,t,e,n)},Ql.Ul=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yi(Qi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yi(Qi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ji(n)},Object.defineProperty(Ql.prototype,"app",{get:function(){if(!this.Ll)throw new Yi(Qi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ll},enumerable:!1,configurable:!0}),Ql.prototype.collection=function(t){return ic("Firestore.collection",arguments,1),sc("Firestore.collection","non-empty string",1,t),this.ql(),new sf(tr.$(t),this,null)},Ql.prototype.doc=function(t){return ic("Firestore.doc",arguments,1),sc("Firestore.doc","non-empty string",1,t),this.ql(),ql.Jl(tr.$(t),this,null)},Ql.prototype.collectionGroup=function(t){if(ic("Firestore.collectionGroup",arguments,1),sc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ql(),new rf((e=t,new ea(tr.k(),e)),this,null);var e},Ql.prototype.runTransaction=function(e){var n=this;return ic("Firestore.runTransaction",arguments,1),sc("Firestore.runTransaction","function",1,e),this.ql().transaction(function(t){return e(new Ul(n,t))})},Ql.prototype.batch=function(){return this.ql(),new xl(this)},Object.defineProperty(Ql,"logLevel",{get:function(){switch(Ri()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Ql.setLogLevel=function(t){ic("Firestore.setLogLevel",arguments,1),lc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Oi.setLogLevel(t)},Ql.prototype.Zl=function(){return this.Ql.timestampsInSnapshots},Ql),Ul=(Xl.prototype.get=function(t){var n=this;ic("Transaction.get",arguments,1);var i=pf("Transaction.get",t,this.t_);return this.e_.hl([i.Gc]).then(function(t){if(!t||1!==t.length)return Li();var e=t[0];if(e instanceof Qs)return new Gl(n.t_,i.Gc,null,!1,!1,i.Kc);if(e instanceof Xs)return new Gl(n.t_,i.Gc,e,!1,!1,i.Kc);throw Li()})},Xl.prototype.set=function(t,e,n){oc("Transaction.set",arguments,2,3);var i=pf("Transaction.set",t,this.t_);n=cf("Transaction.set",n);var r=df(i.Kc,e,n),o=fl(this.t_.jl,"Transaction.set",i.Gc,r,null!==i.Kc,n);return this.e_.set(i.Gc,o),this},Xl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Oc?(rc("Transaction.update",arguments,3),i=pf("Transaction.update",t,this.t_),dl(this.t_.jl,"Transaction.update",i.Gc,e,n,o)):(ic("Transaction.update",arguments,2),i=pf("Transaction.update",t,this.t_),pl(this.t_.jl,"Transaction.update",i.Gc,e)),this.e_.update(i.Gc,r),this},Xl.prototype.delete=function(t){ic("Transaction.delete",arguments,1);var e=pf("Transaction.delete",t,this.t_);return this.e_.delete(e.Gc),this},Xl),xl=(Kl.prototype.set=function(t,e,n){oc("WriteBatch.set",arguments,2,3),this.i_();var i=pf("WriteBatch.set",t,this.t_);n=cf("WriteBatch.set",n);var r=df(i.Kc,e,n),o=fl(this.t_.jl,"WriteBatch.set",i.Gc,r,null!==i.Kc,n);return this.n_=this.n_.concat(o.zc(i.Gc,vs.je())),this},Kl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.i_(),r="string"==typeof e||e instanceof Oc?(rc("WriteBatch.update",arguments,3),i=pf("WriteBatch.update",t,this.t_),dl(this.t_.jl,"WriteBatch.update",i.Gc,e,n,o)):(ic("WriteBatch.update",arguments,2),i=pf("WriteBatch.update",t,this.t_),pl(this.t_.jl,"WriteBatch.update",i.Gc,e)),this.n_=this.n_.concat(r.zc(i.Gc,vs.exists(!0))),this},Kl.prototype.delete=function(t){ic("WriteBatch.delete",arguments,1),this.i_();var e=pf("WriteBatch.delete",t,this.t_);return this.n_=this.n_.concat(new Vs(e.Gc,vs.je())),this},Kl.prototype.commit=function(){return this.i_(),this.s_=!0,0<this.n_.length?this.t_.ql().write(this.n_):Promise.resolve()},Kl.prototype.i_=function(){if(this.s_)throw new Yi(Qi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Kl),ql=(n(Hl,Dl=Qc),Hl.Jl=function(t,e,n){if(t.length%2!=0)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Hl(new ir(t),e,n)},Object.defineProperty(Hl.prototype,"id",{get:function(){return this.Gc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"parent",{get:function(){return new sf(this.Gc.path.g(),this.firestore,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"path",{get:function(){return this.Gc.path.N()},enumerable:!1,configurable:!0}),Hl.prototype.collection=function(t){if(ic("DocumentReference.collection",arguments,1),sc("DocumentReference.collection","non-empty string",1,t),!t)throw new Yi(Qi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=tr.$(t);return new sf(this.Gc.path.child(e),this.firestore,null)},Hl.prototype.isEqual=function(t){if(!(t instanceof Hl))throw gc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Gc.isEqual(t.Gc)&&this.Kc===t.Kc},Hl.prototype.set=function(t,e){oc("DocumentReference.set",arguments,1,2),e=cf("DocumentReference.set",e);var n=df(this.Kc,t,e),i=fl(this.firestore.jl,"DocumentReference.set",this.Gc,n,null!==this.Kc,e);return this.Ml.write(i.zc(this.Gc,vs.je()))},Hl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Oc?(rc("DocumentReference.update",arguments,2),dl(this.firestore.jl,"DocumentReference.update",this.Gc,t,e,i)):(ic("DocumentReference.update",arguments,1),pl(this.firestore.jl,"DocumentReference.update",this.Gc,t)),this.Ml.write(n.zc(this.Gc,vs.exists(!0)))},Hl.prototype.delete=function(){return ic("DocumentReference.delete",arguments,0),this.Ml.write([new Vs(this.Gc,vs.je())])},Hl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];oc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof r[a]||Zh(r[a])||(vc("DocumentReference.onSnapshot",s=r[a],["includeMetadataChanges"]),hc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};Zh(r[a])?(u=r[a],r[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),r[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),r[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(sc("DocumentReference.onSnapshot","function",a,r[a]),ac("DocumentReference.onSnapshot","function",a+1,r[a+1]),ac("DocumentReference.onSnapshot","function",a+2,r[a+2]));var c={next:function(t){r[a]&&r[a](i.r_(t))},error:r[a+1],complete:r[a+2]};return this.Ml.listen(ia(this.Gc.path),h,c)},Hl.prototype.get=function(t){var e=this;oc("DocumentReference.get",arguments,0,1),ff("DocumentReference.get",t);var n=this.firestore.ql();return t&&"cache"===t.source?n.Al(this.Gc).then(function(t){return new Gl(e.firestore,e.Gc,t,!0,t instanceof Xs&&t.Ge,e.Kc)}):n.Pl(this.Gc,t).then(function(t){return e.r_(t)})},Hl.prototype.withConverter=function(t){return new Hl(this.Gc,this.firestore,t)},Hl.prototype.r_=function(t){var e=t.docs.get(this.Gc);return new Gl(this.firestore,this.Gc,e,t.fromCache,t.hasPendingWrites,this.Kc)},Hl),jl=(Wl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Wl),Gl=(zl.prototype.data=function(t){var e=this;if(oc("DocumentSnapshot.data",arguments,0,1),t=lf("DocumentSnapshot.data",t),this.o_){if(this.Kc){var n=new Fl(this.t_,this.Gc,this.o_,this.h_,this.a_,null);return this.Kc.fromFirestore(n,t)}return new Ll(this.t_.jc,this.t_.Zl(),t.serverTimestamps||"none",function(t){return new ql(t,e.t_,null)}).bl(this.o_.Ze())}},zl.prototype.get=function(t,e){var n=this;if(oc("DocumentSnapshot.get",arguments,1,2),e=lf("DocumentSnapshot.get",e),this.o_){var i=this.o_.data().field(bl("DocumentSnapshot.get",t,this.Gc));if(null!==i)return new Ll(this.t_.jc,this.t_.Zl(),e.serverTimestamps||"none",function(t){return new ql(t,n.t_,n.Kc)}).bl(i)}},Object.defineProperty(zl.prototype,"id",{get:function(){return this.Gc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"ref",{get:function(){return new ql(this.Gc,this.t_,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"exists",{get:function(){return null!==this.o_},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"metadata",{get:function(){return new jl(this.a_,this.h_)},enumerable:!1,configurable:!0}),zl.prototype.isEqual=function(t){if(!(t instanceof zl))throw gc("isEqual","DocumentSnapshot",1,t);return this.t_===t.t_&&this.h_===t.h_&&this.Gc.isEqual(t.Gc)&&(null===this.o_?null===t.o_:this.o_.isEqual(t.o_))&&this.Kc===t.Kc},zl),Fl=(n(Bl,Pl=Gl),Bl.prototype.data=function(t){return Pl.prototype.data.call(this,t)},Bl);function Bl(){return null!==Pl&&Pl.apply(this,arguments)||this}function zl(t,e,n,i,r,o){this.t_=t,this.Gc=e,this.o_=n,this.h_=i,this.a_=r,this.Kc=o}function Wl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Hl(t,e,n){var i=this;return(i=Dl.call(this,e.jc,t,n)||this).Gc=t,i.firestore=e,i.Kc=n,i.Ml=i.firestore.ql(),i}function Kl(t){this.t_=t,this.n_=[],this.s_=!1}function Xl(t,e){this.t_=t,this.e_=e}function Ql(t,e,n,i){var r=this;if(void 0===n&&(n=new Qh),void 0===i&&(i=new Yh),this.kl=n,this.xl=i,this.Ll=null,this.Ol=new hu,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ql(),[4,this.Ml.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Ll=o,this.jc=Ql.Ul(o),this.Bl=o.name,this.Wl=new Gu(e)}else{var s=t;if(!s.projectId)throw new Yi(Qi.INVALID_ARGUMENT,"Must provide projectId");this.jc=new ji(s.projectId,s.database),this.Bl="[DEFAULT]",this.Wl=new ju}this.Ql=new Ml({})}function Yl(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Yi(Qi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else uc("settings","non-empty string","host",t.host),this.host=t.host,hc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(vc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),hc("settings","object","credentials",t.credentials),this.credentials=t.credentials,hc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),hc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?ki("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&ki("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,hc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=pu.ii;else{if(t.cacheSizeBytes!==Cl&&t.cacheSizeBytes<pu.si)throw new Yi(Qi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+pu.si);this.cacheSizeBytes=t.cacheSizeBytes}hc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function $l(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.gl=n,this.vl=i}function Jl(t,e,n){if("string"==typeof n){if(""===n)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ra(e)&&-1!==n.indexOf("/"))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(tr.$(n));if(!ir.W(i))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return To(t,new ir(i))}if(n instanceof Qc)return To(t,n.Gc);throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+dc(n)+".")}function Zl(t,e){if(!Array.isArray(t)||0===t.length)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function tf(t,e,n){if(!n.isEqual(e))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ef(t){if(t.an()&&0===t.tn.length)throw new Yi(Qi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var nf,rf=(hf.prototype.where=function(t,e,n){var i;ic("Query.where",arguments,3),yc("Query.where",3,n),i="not-in"===e||"!="===e?e:lc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=bl("Query.where",t),a=function(t,e,n,i,r,o){var s;if(i.O()){if("array-contains"===r||"array-contains-any"===r)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r||"not-in"===r){Zl(o,r);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(Jl(n,t,c))}s={arrayValue:{values:a}}}else s=Jl(n,t,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||Zl(o,r),s=yl(e,"Query.where",o,"in"===r||"not-in"===r);var l=va.create(i,r,s);return function(t,e){if(e.ln()){var n=t.cn();if(null!==n&&!n.isEqual(e.field))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.un();null!==i&&tf(0,e.field,i)}var r=t._n(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,l),l}(this.u_,this.firestore.jl,this.firestore.jc,s,i,n);return new hf((o=(r=this.u_).filters.concat([a]),new ea(r.path,r.collectionGroup,r.tn.slice(),o,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Kc)},hf.prototype.orderBy=function(t,e){var n;if(oc("Query.orderBy",arguments,1,2),ac("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yi(Qi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=bl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o=new za(e,n),s=o;return null!==(i=t).un()||null!==(r=i.cn())&&tf(0,r,s.field),o}(this.u_,o,n);return new hf((r=(i=this.u_).tn.concat([s]),new ea(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.Kc)},hf.prototype.limit=function(t){return ic("Query.limit",arguments,1),sc("Query.limit","number",1,t),mc("Query.limit",1,t),new hf(aa(this.u_,t,"F"),this.firestore,this.Kc)},hf.prototype.limitToLast=function(t){return ic("Query.limitToLast",arguments,1),sc("Query.limitToLast","number",1,t),mc("Query.limitToLast",1,t),new hf(aa(this.u_,t,"L"),this.firestore,this.Kc)},hf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];rc("Query.startAt",arguments,1);var i=this.c_("Query.startAt",t,e,!0);return new hf(ua(this.u_,i),this.firestore,this.Kc)},hf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];rc("Query.startAfter",arguments,1);var i=this.c_("Query.startAfter",t,e,!1);return new hf(ua(this.u_,i),this.firestore,this.Kc)},hf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];rc("Query.endBefore",arguments,1);var i=this.c_("Query.endBefore",t,e,!0);return new hf(ha(this.u_,i),this.firestore,this.Kc)},hf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];rc("Query.endAt",arguments,1);var i=this.c_("Query.endAt",t,e,!1);return new hf(ha(this.u_,i),this.firestore,this.Kc)},hf.prototype.isEqual=function(t){if(!(t instanceof hf))throw gc("isEqual","Query",1,t);return this.firestore===t.firestore&&ca(this.u_,t.u_)&&this.Kc===t.Kc},hf.prototype.withConverter=function(t){return new hf(this.u_,this.firestore,t)},hf.prototype.c_=function(c,t,e,n){if(yc(c,1,t),t instanceof Gl)return ic(c,r([t],e),1),function(t,e,n,i){if(!n)throw new Yi(Qi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=oa(t);o<s.length;o++){var a=s[o];if(a.field.O())r.push(To(e,n.key));else{var u=n.field(a.field);if(co(u))throw new Yi(Qi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.N();throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Va(r,i)}(this.u_,this.firestore.jc,t.o_,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.tn;if(r.length>s.length)throw new Yi(Qi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<r.length;u++){var h=r[u];if(s[u].field.O()){if("string"!=typeof h)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!ra(t)&&-1!==h.indexOf("/"))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(tr.$(h));if(!ir.W(c))throw new Yi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ir(c);a.push(To(e,l))}else{var f=yl(n,i,h);a.push(f)}}return new Va(a,o)}(this.u_,this.firestore.jc,this.firestore.jl,c,i,n)},hf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];oc("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof r[u]||Zh(r[u])||(vc("Query.onSnapshot",a=r[u],["includeMetadataChanges"]),hc("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),Zh(r[u])?(s=r[u],r[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(sc("Query.onSnapshot","function",u,r[u]),ac("Query.onSnapshot","function",u+1,r[u+1]),ac("Query.onSnapshot","function",u+2,r[u+2]));var h={next:function(t){r[u]&&r[u](new of(i.firestore,i.u_,t,i.Kc))},error:r[u+1],complete:r[u+2]};return ef(this.u_),this.firestore.ql().listen(this.u_,a,h)},hf.prototype.get=function(t){var e=this;oc("Query.get",arguments,0,1),ff("Query.get",t),ef(this.u_);var n=this.firestore.ql();return(t&&"cache"===t.source?n.Vl(this.u_):n.yl(this.u_,t)).then(function(t){return new of(e.firestore,e.u_,t,e.Kc)})},hf),of=(Object.defineProperty(uf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(uf.prototype,"empty",{get:function(){return this.__.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(uf.prototype,"size",{get:function(){return this.__.docs.size},enumerable:!1,configurable:!0}),uf.prototype.forEach=function(e,n){var i=this;oc("QuerySnapshot.forEach",arguments,1,2),sc("QuerySnapshot.forEach","function",1,e),this.__.docs.forEach(function(t){e.call(n,i.w_(t,i.metadata.fromCache,i.__.qt.has(t.key)))})},Object.defineProperty(uf.prototype,"query",{get:function(){return new rf(this.l_,this.t_,this.Kc)},enumerable:!1,configurable:!0}),uf.prototype.docChanges=function(t){t&&(vc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),hc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.__.Ut)throw new Yi(Qi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.f_&&this.d_===e||(this.f_=function(r,e,o){if(r.Ot._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Ot;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Li()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.__,e,this.w_.bind(this)),this.d_=e),this.f_},uf.prototype.isEqual=function(t){if(!(t instanceof uf))throw gc("isEqual","QuerySnapshot",1,t);return this.t_===t.t_&&ca(this.l_,t.l_)&&this.__.isEqual(t.__)&&this.Kc===t.Kc},uf.prototype.w_=function(t,e,n){return new Fl(this.t_,t.key,t,e,n,this.Kc)},uf),sf=(n(af,nf=rf),Object.defineProperty(af.prototype,"id",{get:function(){return this.u_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(af.prototype,"parent",{get:function(){var t=this.u_.path.g();return t._()?null:new ql(new ir(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(af.prototype,"path",{get:function(){return this.u_.path.N()},enumerable:!1,configurable:!0}),af.prototype.doc=function(t){oc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Mi.t()),sc("CollectionReference.doc","non-empty string",1,t);var e=tr.$(t);return ql.Jl(this.u_.path.child(e),this.firestore,this.Kc)},af.prototype.add=function(t){ic("CollectionReference.add",arguments,1),sc("CollectionReference.add","object",1,this.Kc?this.Kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},af.prototype.withConverter=function(t){return new af(this.T_,this.firestore,t)},af);function af(t,e,n){var i=this;if(((i=nf.call(this,ia(t),e,n)||this).T_=t).length%2!=1)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function uf(t,e,n,i){this.t_=t,this.l_=e,this.__=n,this.Kc=i,this.f_=null,this.d_=null,this.metadata=new jl(n.hasPendingWrites,n.fromCache)}function hf(t,e,n){this.u_=t,this.firestore=e,this.Kc=n}function cf(t,e){if(void 0===e)return{merge:!1};if(vc(t,e,["merge","mergeFields"]),hc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+dc(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof Oc))throw new Yi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+dc(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yi(Qi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function lf(t,e){return void 0===e?{}:(vc(t,e,["serverTimestamps"]),cc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ff(t,e){ac(t,"object",1,e),e&&(vc(t,e,["source"]),cc(t,0,"source",e.source,["default","server","cache"]))}function pf(t,e,n){if(e instanceof Qc){if(e.firestore!==n)throw new Yi(Qi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw gc(t,"DocumentReference",1,e)}function df(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var yf,vf={Firestore:Vl,GeoPoint:Kc,Timestamp:$i,Blob:Ac,Transaction:Ul,WriteBatch:xl,DocumentReference:ql,DocumentSnapshot:Gl,Query:rf,QueryDocumentSnapshot:Fl,QuerySnapshot:of,CollectionReference:sf,FieldPath:Oc,FieldValue:Wc,setLogLevel:Vl.setLogLevel,CACHE_SIZE_UNLIMITED:Cl};(yf=gf).INTERNAL.registerComponent(new Ni("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Vl(e,n,new Qh,new Yh);var e,n},"PUBLIC").setServiceProps(Object.assign({},vf))),yf.registerVersion("@firebase/firestore","1.16.4-202071122108")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});