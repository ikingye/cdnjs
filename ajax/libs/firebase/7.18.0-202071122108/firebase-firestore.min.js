!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Rd){"use strict";try{(function(){Rd=Rd&&Object.prototype.hasOwnProperty.call(Rd,"default")?Rd.default:Rd;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D=_||self;function S(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:C).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++L))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var X,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var Y=D.navigator;if(Y){var $=Y.userAgent;if($){X=$;break t}}X=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=S;var rt,it,ot=W(X,"Opera"),st=W(X,"Trident")||W(X,"MSIE"),ut=W(X,"Edge"),at=ut||st,ht=W(X,"Gecko")&&!(W(X.toLowerCase(),"webkit")&&!W(X,"Edge"))&&!(W(X,"Trident")||W(X,"MSIE"))&&!W(X,"Edge"),ct=W(X.toLowerCase(),"webkit")&&!W(X,"Edge");function ft(){var t=D.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=X,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=H(String(rt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=D.document&&st&&(ft()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},F(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),At=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++At,this.Y=this.Z=!1}function Dt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Dt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Pt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=qt(r),e&&e[Nt]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Nt]?t.va(e,n,O(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=Ft(t);if(h||(t[Ot]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?kt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(kt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Dt(t)))}function Ut(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Mt(t,e){if(t.Y)return!0;if(mt)return Vt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new It(e,this))}function Ft(t){return(t=t[Ot])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==k(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Gt(){j.call(this),this.c=new St(this),(this.J=this).C=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&kt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Gt,j),Gt.prototype[Nt]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=qt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=D.JSON.stringify;function Kt(){this.b=this.a=null}var Xt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Qt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Xt||(n=D.Promise.resolve(void 0),Xt=function(){n.then(Zt)}),$t||(Xt(),$t=!0),Jt.add(t,e)}Kt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Kt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function te(t,e){Gt.call(this),this.b=t||1,this.a=e||D,this.f=U(this.Ya,this),this.g=M()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==k(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}F(te,Gt),(A=te.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=j),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){j.call(this),this.b=t,this.a={}}F(he,j);var ce=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),le(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Gt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}F(ge,Et),F(we,Et),F(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ae(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function De(){}Ae.prototype.a=null;var Se,ke={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function xe(){Et.call(this,"d")}function Oe(){Et.call(this,"c")}function Pe(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Re,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(xe,Et),F(Oe,Et),F(Pe,Ae),Se=new Pe;var Re=45e3,Ce={},Ue={};function Ve(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,Me(t,null)}function Me(t,e){t.u=M(),je(t),t.l=Je(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ue:(o=Number(i.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>i.length?Ue:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ue){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Be(t))}function je(t){t.U=M()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function Ge(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||An(p.b,t)))if(p.I=t.N,!t.C&&An(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Wn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ar(p,11)}else if(!t.C&&p.a!=t||or(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(W(u,"spdy")||W(u,"quic")||W(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(_n(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=M()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Dn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Ge(f),je(f)),o.a=c):er(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||ar(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ar(p,7):Hn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Ge(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,h=this.m,c=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Be(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(Fe(this,e,i),at&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),Ke(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,je(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Be(this)}}}catch(t){}var a,h,c,f,l,p,d},A.Va=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),Fe(this,t,e),this.b&&4!=t&&je(this)))},A.cancel=function(){this.A=!0,ze(this)},A.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Be(this)):qe(this,this.U-n)},(A=He.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new $e(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=un(e,ln)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,fn=/[#\?]/g,ln=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new He,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function gn(t,e){return yn(t),e=wn(t,e),Qe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function kn(){}function xn(){this.a=new kn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},kn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},kn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Pn=D.JSON.parse;function Ln(t){Gt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}F(Ln,Gt);var Rn="",Cn=/^https?$/i,Un=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),qn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&(!t.s[1]||4!=Bn(t)||2!=t.X()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Fn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Hn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=M(),je(e)),hr(t)}function Wn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Qn(t){Wn(t),t.j&&(D.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&$n(t)}function $n(t){Tn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,r=Je(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ve(n,r,e)}function Zn(t,n){t.f&&Xe({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Xe(t,function(t,e){var n=t;O(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ur(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,Me(n,t)}function or(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!An(t.b,e))return;r=e.s,Dn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ee(i)),$n(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ar(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=U(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ze(n,"https"),on(n)),i=n.toString(),o=r,u=new pe,D.Image?((s=new Image).onload=V(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=V(On,u,s,"TestLoadImage: error",!1,o),s.onabort=V(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=V(On,u,s,"TestLoadImage: timeout",!1,o),D.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Qn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof $e?Je(r):new $e(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=D.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new $e(null,void 0),o&&Ze(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function lr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Gt.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){Oe.call(this),this.status=1}function gr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Se),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new He(this.headers);r&&Xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=q(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},A.Ta=function(){jn(this)},A.X=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Xn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=Je(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&zn(i,this.i,r),_n(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},A.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Wn(this),ir(this))},A.Ra=function(){null!=this.m&&(this.m=null,Wn(this),nr(this),be())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(A=lr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},F(dr,Gt),(A=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),$n(t)},A.close=function(){Hn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,dr.S.G.call(this)},F(yr,xe),F(vr,Oe),F(gr,lr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(De.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ne,WebChannel:De,XhrIo:Ln},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Er=mr.EventType,Ir=mr.WebChannel,Tr=mr.XhrIo,Nr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _r="7.18.0-202071122108",Dr=new c("@firebase/firestore");function Sr(){return Dr.logLevel}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.DEBUG&&(e=n.map(Pr),Dr.debug.apply(Dr,i(["Firestore ("+_r+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.ERROR&&(e=n.map(Pr),Dr.error.apply(Dr,i(["Firestore ("+_r+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.WARN&&(e=n.map(Pr),Dr.warn.apply(Dr,i(["Firestore ("+_r+"): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Rr(t){t||Lr()}var Cr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Fr(t){return t+"\0"}function jr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var qr=(Object.defineProperty(Gr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gr.prototype.isEqual=function(t){return t instanceof Gr&&t.projectId===this.projectId&&t.database===this.database},Gr.prototype.o=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Gr);function Gr(t,e){this.projectId=t,this.database=e||"(default)"}function Br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Xr,Hr,Wr,Qr=(li.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},li.prototype.has=function(t){return void 0!==this.get(t)},li.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},li.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},li.prototype.forEach=function(u){zr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},li.prototype._=function(){return Kr(this.l)},li),Yr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$r=(n(fi,Wr=Error),fi),Jr=(ci.now=function(){return ci.fromMillis(Date.now())},ci.fromDate=function(t){return ci.fromMillis(t.getTime())},ci.fromMillis=function(t){var e=Math.floor(t/1e3);return new ci(e,1e6*(t-1e3*e))},ci.prototype.toDate=function(){return new Date(this.toMillis())},ci.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ci.prototype.T=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},ci.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ci.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ci.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ci),Zr=(hi.I=function(t){return new hi(t)},hi.min=function(){return new hi(new Jr(0,0))},hi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},hi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},hi.prototype.A=function(){return this.timestamp},hi),ti=(Object.defineProperty(ai.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ai.prototype.isEqual=function(t){return 0===ai.P(this,t)},ai.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ai?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ai.prototype.limit=function(){return this.offset+this.length},ai.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ai.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},ai.prototype.v=function(){return this.segments[this.offset]},ai.prototype.S=function(){return this.get(this.length-1)},ai.prototype.get=function(t){return this.segments[this.offset+t]},ai.prototype._=function(){return 0===this.length},ai.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ai.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},ai.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ai),ei=(n(ui,Hr=ti),ui.prototype.V=function(t,e,n){return new ui(t,e,n)},ui.prototype.F=function(){return this.N().join("/")},ui.prototype.toString=function(){return this.F()},ui.k=function(t){if(0<=t.indexOf("//"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ui(t.split("/").filter(function(t){return 0<t.length}))},ui.$=function(){return new ui([])},ui),ni=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ri=(n(si,Xr=ti),si.prototype.V=function(t,e,n){return new si(t,e,n)},si.M=function(t){return ni.test(t)},si.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),si.M(t)||(t="`"+t+"`"),t}).join(".")},si.prototype.toString=function(){return this.F()},si.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},si.L=function(){return new si(["__name__"])},si.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $r(Yr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new $r(Yr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new si(e)},si.$=function(){return new si([])},si),ii=(oi.B=function(t){return new oi(ei.k(t).g(5))},oi.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},oi.prototype.isEqual=function(t){return null!==t&&0===ei.P(this.path,t.path)},oi.prototype.toString=function(){return this.path.toString()},oi.P=function(t,e){return ei.P(t.path,e.path)},oi.W=function(t){return t.length%2==0},oi.j=function(t){return new oi(new ei(t.slice()))},oi);function oi(t){this.path=t}function si(){return null!==Xr&&Xr.apply(this,arguments)||this}function ui(){return null!==Hr&&Hr.apply(this,arguments)||this}function ai(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.R=n}function hi(t){this.timestamp=t}function ci(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function fi(t,e){var n=this;return(n=Wr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function li(t,e){this.h=t,this.u=e,this.l={}}function pi(t){return null==t}function di(t){return-0===t&&1/t==-1/0}function yi(t){return"number"==typeof t&&Number.isInteger(t)&&!di(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function mi(t){var e,n=t;return null===n.K&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+Eo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),pi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ju(n.startAt)),n.endAt&&(e+="|ub:",e+=Ju(n.endAt)),n.K=e),n.K}function wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ta(t.startAt,e.startAt)&&ta(t.endAt,e.endAt)}function bi(t){return ii.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ei=(Ii.fromBase64String=function(t){return new Ii(atob(t))},Ii.fromUint8Array=function(t){return new Ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ii.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ii.prototype.H=function(){return 2*this.G.length},Ii.prototype.o=function(t){return Vr(this.G,t.G)},Ii.prototype.isEqual=function(t){return this.G===t.G},Ii);function Ii(t){this.G=t}function Ti(t){this.count=t}Ei.Y=new Ei("");var Ni,Ai,_i=(Di.prototype.Z=function(t){return new Di(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Di.prototype.tt=function(t,e){return new Di(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Di.prototype.et=function(t){return new Di(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},Di);function Di(t,e,n,r,i,o,s){void 0===i&&(i=Zr.min()),void 0===o&&(o=Zr.min()),void 0===s&&(s=Ei.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Yr.OK:return Lr(),0;case Yr.CANCELLED:case Yr.UNKNOWN:case Yr.DEADLINE_EXCEEDED:case Yr.RESOURCE_EXHAUSTED:case Yr.INTERNAL:case Yr.UNAVAILABLE:case Yr.UNAUTHENTICATED:return;case Yr.INVALID_ARGUMENT:case Yr.NOT_FOUND:case Yr.ALREADY_EXISTS:case Yr.PERMISSION_DENIED:case Yr.FAILED_PRECONDITION:case Yr.ABORTED:case Yr.OUT_OF_RANGE:case Yr.UNIMPLEMENTED:case Yr.DATA_LOSS:return 1;default:return Lr(),0}}function ki(t){if(void 0===t)return xr("GRPC error has no .code"),Yr.UNKNOWN;switch(t){case Ni.OK:return Yr.OK;case Ni.CANCELLED:return Yr.CANCELLED;case Ni.UNKNOWN:return Yr.UNKNOWN;case Ni.DEADLINE_EXCEEDED:return Yr.DEADLINE_EXCEEDED;case Ni.RESOURCE_EXHAUSTED:return Yr.RESOURCE_EXHAUSTED;case Ni.INTERNAL:return Yr.INTERNAL;case Ni.UNAVAILABLE:return Yr.UNAVAILABLE;case Ni.UNAUTHENTICATED:return Yr.UNAUTHENTICATED;case Ni.INVALID_ARGUMENT:return Yr.INVALID_ARGUMENT;case Ni.NOT_FOUND:return Yr.NOT_FOUND;case Ni.ALREADY_EXISTS:return Yr.ALREADY_EXISTS;case Ni.PERMISSION_DENIED:return Yr.PERMISSION_DENIED;case Ni.FAILED_PRECONDITION:return Yr.FAILED_PRECONDITION;case Ni.ABORTED:return Yr.ABORTED;case Ni.OUT_OF_RANGE:return Yr.OUT_OF_RANGE;case Ni.UNIMPLEMENTED:return Yr.UNIMPLEMENTED;case Ni.DATA_LOSS:return Yr.DATA_LOSS;default:return Lr()}}(Ai=Ni=Ni||{})[Ai.OK=0]="OK",Ai[Ai.CANCELLED=1]="CANCELLED",Ai[Ai.UNKNOWN=2]="UNKNOWN",Ai[Ai.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ai[Ai.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ai[Ai.NOT_FOUND=5]="NOT_FOUND",Ai[Ai.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ai[Ai.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ai[Ai.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ai[Ai.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ai[Ai.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ai[Ai.ABORTED=10]="ABORTED",Ai[Ai.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ai[Ai.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ai[Ai.INTERNAL=13]="INTERNAL",Ai[Ai.UNAVAILABLE=14]="UNAVAILABLE",Ai[Ai.DATA_LOSS=15]="DATA_LOSS";var xi=(Ci.prototype.nt=function(t,e){return new Ci(this.P,this.root.nt(t,e,this.P).copy(null,null,Pi.st,null,null))},Ci.prototype.remove=function(t){return new Ci(this.P,this.root.remove(t,this.P).copy(null,null,Pi.st,null,null))},Ci.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ci.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ci.prototype._=function(){return this.root._()},Object.defineProperty(Ci.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ci.prototype.it=function(){return this.root.it()},Ci.prototype.rt=function(){return this.root.rt()},Ci.prototype.ot=function(t){return this.root.ot(t)},Ci.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ci.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ci.prototype.ht=function(t){return this.root.ht(t)},Ci.prototype.at=function(){return new Oi(this.root,null,this.P,!1)},Ci.prototype.ut=function(t){return new Oi(this.root,t,this.P,!1)},Ci.prototype.ct=function(){return new Oi(this.root,null,this.P,!0)},Ci.prototype.lt=function(t){return new Oi(this.root,t,this.P,!0)},Ci),Oi=(Ri.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ri.prototype.wt=function(){return 0<this.ft.length},Ri.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ri),Pi=(Li.prototype.copy=function(t,e,n,r,i){return new Li(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Li.prototype._=function(){return!1},Li.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Li.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Li.prototype.min=function(){return this.left._()?this:this.left.min()},Li.prototype.it=function(){return this.min().key},Li.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Li.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Li.prototype.It=function(){if(this.left._())return Li.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Li.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Li.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Li.prototype.At=function(){return this.color},Li.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Li.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).gt()).yt()),t},Li.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Li.prototype.gt=function(){var t=this.copy(null,null,Li.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Li.prototype.Pt=function(){var t=this.copy(null,null,Li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Li.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Li.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Li.prototype.bt=function(){if(this.At()&&this.left.At())throw Lr();if(this.right.At())throw Lr();var t=this.left.bt();if(t!==this.right.bt())throw Lr();return t+(this.At()?0:1)},Li);function Li(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Li.RED,this.left=null!=r?r:Li.EMPTY,this.right=null!=i?i:Li.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ci(t,e){this.P=t,this.root=e||Pi.EMPTY}function Ui(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.st=!1,Pi.EMPTY=(Object.defineProperty(Ui.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Ui.prototype.copy=function(t,e,n,r,i){return this},Ui.prototype.nt=function(t,e,n){return new Pi(t,e)},Ui.prototype.remove=function(t,e){return this},Ui.prototype._=function(){return!0},Ui.prototype.ot=function(t){return!1},Ui.prototype.ht=function(t){return!1},Ui.prototype.it=function(){return null},Ui.prototype.rt=function(){return null},Ui.prototype.At=function(){return!1},Ui.prototype.pt=function(){return!0},Ui.prototype.bt=function(){return 0},new Ui);var Vi=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.it()},qi.prototype.last=function(){return this.data.rt()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},qi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},qi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},qi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},qi.prototype.at=function(){return new Mi(this.data.at())},qi.prototype.ut=function(t){return new Mi(this.data.ut(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype._=function(){return this.data._()},qi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},qi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.P);return e.data=t,e},qi),Mi=(ji.prototype.dt=function(){return this.Nt.dt().key},ji.prototype.wt=function(){return this.Nt.wt()},ji),Fi=new xi(ii.P);function ji(t){this.Nt=t}function qi(t){this.P=t,this.data=new xi(this.P)}var Gi=new xi(ii.P),Bi=new xi(ii.P),zi=new Vi(ii.P);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Xi=new Vi(Vr);function Hi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Wi(t,e){this.targetId=t,this.ee=e}function Qi(t,e,n,r){void 0===n&&(n=Ei.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Yi=(ho.$t=function(t){return new ho(t.P)},ho.prototype.has=function(t){return null!=this.Ft.get(t)},ho.prototype.get=function(t){return this.Ft.get(t)},ho.prototype.first=function(){return this.kt.it()},ho.prototype.last=function(){return this.kt.rt()},ho.prototype._=function(){return this.kt._()},ho.prototype.indexOf=function(t){var e=this.Ft.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ft.nt(t.key,t),e.kt.nt(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ft.remove(t),this.kt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.P=this.P,n.Ft=t,n.kt=e,n},ho),$i=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Lr()},ao.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ao),Ji=(uo.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new uo(t,e,Yi.$t(e),i,n,r,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&Eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},uo),Zi=(so.Gt=function(t,e){var n=new Map;return n.set(t,to.zt(t,e)),new so(Zr.min(),n,Xi,Fi,Ki())},so),to=(oo.zt=function(t,e){return new oo(Ei.Y,e,Ki(),Ki(),Ki())},oo),eo=(Object.defineProperty(io.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),io.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},io.prototype.ce=function(){var n=Ki(),r=Ki(),i=Ki();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new to(this.ie,this.re,n,r,i)},io.prototype.le=function(){this.oe=!1,this.se=fo()},io.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},io.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},io.prototype.de=function(){this.ne+=1},io.prototype.we=function(){--this.ne},io.prototype.Te=function(){this.oe=!0,this.re=!0},io),no=(ro.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof iu?this.Ve(r,t.te):t.te instanceof ou&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},ro.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Lr()}})},ro.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},ro.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(bi(e=o.target)?0===i?(n=new ii(e.path),this.ge(r,n,new ou(n,Zr.min()))):Rr(1===i):this.Ne(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},ro.prototype.Fe=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&bi(r.target)&&(n=new ii(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.ge(e,n,new ou(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Ki();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Zi(i,s,this.Re,this.me,r);return this.me=Fi,this.Ae=co(),this.Re=new Vi(Vr),t},ro.prototype.Ve=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.$e(e.key).add(t)))},ro.prototype.ge=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.$e(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},ro.prototype.removeTarget=function(t){this.Ie.delete(t)},ro.prototype.Ne=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},ro.prototype.de=function(t){this.be(t).de()},ro.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new eo,this.Ie.set(t,e)),e},ro.prototype.$e=function(t){var e=this.Ae.get(t);return e||(e=new Vi(Vr),this.Ae=this.Ae.nt(t,e)),e},ro.prototype.ve=function(t){var e=null!==this.Ce(t);return e||kr("WatchChangeAggregator","Detected inactive target",t),e},ro.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},ro.prototype.Se=function(e){var n=this;this.Ie.set(e,new eo),this.Ee.xe(e).forEach(function(t){n.ge(e,t,null)})},ro.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},ro);function ro(t){this.Ee=t,this.Ie=new Map,this.me=Fi,this.Ae=co(),this.Re=new Vi(Vr)}function io(){this.ne=0,this.se=fo(),this.ie=Ei.Y,this.re=!1,this.oe=!0}function oo(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function so(t,e,n,r,i){this.X=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function uo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function ao(){this.xt=new xi(ii.P)}function ho(n){this.P=n?function(t,e){return n(t,e)||ii.P(t.key,e.key)}:function(t,e){return ii.P(t.key,e.key)},this.Ft=Gi,this.kt=new xi(this.P)}function co(){return new xi(ii.P)}function fo(){return new xi(ii.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function po(t){var e=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new Jr(e.seconds,e.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Lr()}function go(r,i){var t,e,n,o=vo(r);if(o!==vo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return po(r).isEqual(po(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),n=Io(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,No(r.bytesValue).isEqual(No(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,To((t=r).geoPointValue.latitude)===To(e.geoPointValue.latitude)&&To(t.geoPointValue.longitude)===To(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return To(t.integerValue)===To(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=To(t.doubleValue),r=To(e.doubleValue);return n===r?di(n)===di(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],go);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Br(t)!==Br(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!go(t[n],e[n])))return!1;return!0}();default:return Lr()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,r,i,o,s,u,a,h,c,f,l=vo(t),p=vo(e);if(l!==p)return Vr(l,p);switch(l){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=To(t.integerValue||t.doubleValue))<(f=To(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=No(o),a=No(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Vr(To(n.latitude),To(r.latitude)))?i:Vr(To(n.longitude),To(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;var a=wo(n[r[s]],i[o[s]]);if(0!==a)return a}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Io(t),r=Io(e),i=Vr(n.seconds,r.seconds);return 0!==i?i:Vr(n.nanos,r.nanos)}function Eo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Io(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?No(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ii.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Lr();var t,e,n}(t)}function Io(t){if(Rr(!!t),"string"!=typeof t)return{seconds:To(t.seconds),nanos:To(t.nanos)};var e,n=0,r=yo.exec(t);Rr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function To(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function No(t){return"string"==typeof t?Ei.fromBase64String(t):Ei.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function _o(t){return t&&"integerValue"in t}function Do(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Oe=e};function Ro(t){return{integerValue:""+t}}function Co(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:di(e)?"-0":e}}function Uo(t,e){return yi(e)?Ro(e):Co(t,e)}function Vo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Fo(t){return Rr(!!t),Zr.I((e=Io(t),new Jr(e.seconds,e.nanos)));var e}function jo(t,e){return new ei(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function qo(t){var e=ei.k(t);return Rr(rs(e)),e}function Go(t,e){return jo(t.s,e.path)}function Bo(t,e){var n=qo(e);return Rr(n.get(1)===t.s.projectId),Rr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ii(Ho(n))}function zo(t,e){return jo(t.s,e)}function Ko(t){var e=qo(t);return 4===e.length?ei.$():Ho(e)}function Xo(t){return new ei(["projects",t.s.projectId,"databases",t.s.database]).F()}function Ho(t){return Rr(4<t.length&&"documents"===t.get(4)),t.g(5)}function Wo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Qo(t,e){var n,r,i,o;if(e instanceof Cs)n={update:Wo(t,e.key,e.value)};else if(e instanceof Xs)n={delete:Go(t,e.key)};else if(e instanceof Us)n={update:Wo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof qs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof hs)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.F(),increment:e.qe};throw Lr()})}};else{if(!(e instanceof Hs))return Lr();n={verify:Go(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Vo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Lr()),n}function Yo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?_s.updateTime(Fo(n.updateTime)):void 0!==n.exists?_s.exists(n.exists):_s.Qe():_s.Qe();if(t.update){t.update.name;var o=Bo(e,t.update.name),s=new Ws({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Is(r.map(function(t){return ri.q(t)})));return new Us(o,s,u,i)}return new Cs(o,s,i)}if(t.delete){var a=Bo(e,t.delete);return new Xs(a,i)}if(t.transform){var h=Bo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Rr("REQUEST_TIME"===e.setToServerValue),i=new as):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new hs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ds(r)):"increment"in e?i=new ms(t,e.increment):Lr();var o=ri.q(e.fieldPath);return new Ts(o,i)}(e,t)});return Rr(!0===i.exists),new qs(h,c)}if(t.verify){var f=Bo(e,t.verify);return new Hs(f,i)}return Lr()}function $o(t,e){return{documents:[zo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ko(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,Po[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:es((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||pi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,n=t.values||[];return new Hu(n,e)}function es(t){return{fieldPath:t.F()}}function ns(t){return ri.q(t.fieldPath)}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function is(){this.We=void 0}function os(t,e){return t instanceof ms?_o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var ss,us,as=(n(fs,us=is),fs),hs=(n(cs,ss=is),cs);function cs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ps,ds=(n(ys,ps=is),ys);function ys(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function vs(t,e){for(var n=Es(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!go(t,e)})}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=is),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).serializer=t,n.qe=e,n}function bs(t){return To(t.integerValue||t.doubleValue)}function Es(t){return Do(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Is=(Ns.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),Ts=function(t,e){this.field=t,this.transform=e};function Ns(t){(this.fields=t).sort(ri.P)}function As(t,e){this.version=t,this.transformResults=e}var _s=(Ds.Qe=function(){return new Ds},Ds.exists=function(t){return new Ds(void 0,t)},Ds.updateTime=function(t){return new Ds(t)},Object.defineProperty(Ds.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ds.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ds);function Ds(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof iu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof iu}function ks(){}function xs(t,e,n,r){return t instanceof Cs?function(t,e){if(!Ss(t.Ue,e))return e;var n=Ps(e);return new iu(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Us?function(t,e){if(!Ss(t.Ue,e))return e;var n=Ps(e),r=Fs(t,e);return new iu(t.key,n,r,{Ke:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Ss(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof iu&&(y=n.field(p.field)),null===y&&r instanceof iu&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof as?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof hs?ls(i,o):i instanceof ds?vs(i,o):(a=bs(u=os(s=i,o))+bs(s.qe),_o(u)&&_o(s.qe)?Ro(a):Co(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Bs(t,i.data(),o);return new iu(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ss((i=t).Ue,o)?new ou(i.key,Zr.min()):o);var i,o}function Os(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof hs&&o instanceof hs||i instanceof ds&&o instanceof ds?Mr(i.elements,o.elements,go):i instanceof ms&&o instanceof ms?go(i.qe,o.qe):i instanceof as&&o instanceof as);var n,r,i,o}))}function Ps(t){return t instanceof iu?t.version:Zr.min()}var Ls,Rs,Cs=(n(Ms,Rs=ks),Ms),Us=(n(Vs,Ls=ks),Vs);function Vs(t,e,n,r){var i=this;return(i=Ls.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Ms(t,e,n){var r=this;return(r=Rs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Fs(t,e){return n=t,r=e instanceof iu?e.data():Ws.empty(),i=new Qs(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var js,qs=(n(Gs,js=ks),Gs);function Gs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=_s.exists(!0),n}function Bs(t,e,n){for(var r=new Qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var zs,Ks,Xs=(n(Zs,Ks=ks),Zs),Hs=(n(Js,zs=ks),Js),Ws=($s.empty=function(){return new $s({mapValue:{}})},$s.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},$s.prototype.isEqual=function(t){return go(this.proto,t.proto)},$s),Qs=(Ys.prototype.set=function(t,e){return this.Ye(t,e),this},Ys.prototype.delete=function(t){return this.Ye(t,null),this},Ys.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Ys.prototype.Ge=function(){var t=this.Je(ri.$(),this.He);return null!=t?new Ws(t):this.ze},Ys.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ys);function Ys(t){void 0===t&&(t=Ws.empty()),this.ze=t,this.He=new Map}function $s(t){this.proto=t}function Js(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Zs(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ue=e,n.type=3,n}function tu(t,e){this.key=t,this.version=e}var eu,nu,ru,iu=(n(hu,ru=tu),hu.prototype.field=function(t){return this.Xe.field(t)},hu.prototype.data=function(){return this.Xe},hu.prototype.Ze=function(){return this.Xe.proto},hu.prototype.isEqual=function(t){return t instanceof hu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},hu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu),ou=(n(au,nu=tu),au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),au.prototype.isEqual=function(t){return t instanceof au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},au),su=(n(uu,eu=tu),uu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu);function uu(){return null!==eu&&eu.apply(this,arguments)||this}function au(t,e,n){var r=this;return(r=nu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function hu(t,e,n,r){var i=this;return(i=ru.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function cu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $r(Yr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $r(Yr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var fu=(lu.prototype.rn=function(t){return new lu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},lu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},lu.prototype.hn=function(){return!pi(this.limit)&&"F"===this.en},lu.prototype.an=function(){return!pi(this.limit)&&"L"===this.en},lu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},lu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},lu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},lu);function lu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function pu(t,e,n,r,i,o,s,u){return new fu(t,e,n,r,i,o,s,u)}function du(t){return new fu(t)}function yu(t){return null!==t.collectionGroup}function vu(t){var e=cu(t,fu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new ea(n)),e.nn.push(new ea(ri.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new ea(ri.L(),i)))}}return e.nn}function gu(t){var e=cu(t,fu);if(!e.sn)if("F"===e.en)e.sn=gi(e.path,e.collectionGroup,vu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=vu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ea(o.field,s))}var u=e.endAt?new Hu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Hu(e.startAt.position,!e.startAt.before):null;e.sn=gi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function mu(t,e,n){return new fu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wu(t,e){return new fu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function bu(t,e){return new fu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function Eu(t,e){return wi(gu(t),gu(e))&&t.en===e.en}function Iu(t){return mi(gu(t))+"|lt:"+t.en}function Tu(t){return"Query(target="+(n=(e=gu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+Eo(e.value);var e}).join(", ")+"]"),pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ju(e.startAt)),e.endAt&&(n+=", endAt: "+Ju(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Nu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ii.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Zu(e.startAt,vu(e),n))&&(!e.endAt||!Zu(e.endAt,vu(e),n)));var e,n,r,o}function Au(u){return function(t,e){for(var n=!1,r=0,i=vu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.O()?ii.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?wo(o,s):Lr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var _u,Du=(n(Su,_u=function(){}),Su.create=function(t,e,n){if(t.O())return"in"===e||"not-in"===e?this.fn(t,e,n):new Pu(t,e,n);if(So(n)){if("=="!==e&&"!="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Su(t,e,n)}if(ko(n)){if("=="!==e&&"!="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Su(t,e,n)}return"array-contains"===e?new Bu(t,n):"in"===e?new zu(t,n):"not-in"===e?new Ku(t,n):"array-contains-any"===e?new Xu(t,n):new Su(t,e,n)},Su.fn=function(t,e,n){return new("in"===e?Lu:Ru)(t,n)},Su.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.dn(wo(e,this.value)):null!==e&&vo(this.value)===vo(e)&&this.dn(wo(e,this.value))},Su.prototype.dn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},Su.prototype.ln=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Su);function Su(t,e,n){var r=this;return(r=_u.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,xu,Ou,Pu=(n(Vu,Ou=Du),Vu.prototype.matches=function(t){var e=ii.P(t.key,this.key);return this.dn(e)},Vu),Lu=(n(Uu,xu=Du),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Ru=(n(Cu,ku=Du),Cu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Cu);function Cu(t,e){var n=this;return(n=ku.call(this,t,"not-in",e)||this).keys=Mu(0,e),n}function Uu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=Mu(0,e),n}function Vu(t,e,n){var r=this;return(r=Ou.call(this,t,e,n)||this).key=ii.B(n.referenceValue),r}function Mu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ii.B(t.referenceValue)})}var Fu,ju,qu,Gu,Bu=(n($u,Gu=Du),$u.prototype.matches=function(t){var e=t.field(this.field);return Do(e)&&mo(e.arrayValue,this.value)},$u),zu=(n(Yu,qu=Du),Yu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&mo(this.value.arrayValue,e)},Yu),Ku=(n(Qu,ju=Du),Qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!mo(this.value.arrayValue,e)},Qu),Xu=(n(Wu,Fu=Du),Wu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Do(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Wu),Hu=function(t,e){this.position=t,this.before=e};function Wu(t,e){return Fu.call(this,t,"array-contains-any",e)||this}function Qu(t,e){return ju.call(this,t,"not-in",e)||this}function Yu(t,e){return qu.call(this,t,"in",e)||this}function $u(t,e){return Gu.call(this,t,"array-contains",e)||this}function Ju(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function Zu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?ii.P(ii.B(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var ea=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},na=(ma.prototype.Tn=function(t,e,n){for(var r,i,o,s=n.En,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Cs?new iu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Us?function(t,e,n){if(!Ss(t.Ue,e))return new su(t.key,n.version);var r=Fs(t,e);return new iu(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof qs?function(t,e,n){if(Rr(null!=n.transformResults),!Ss(t.Ue,e))return new su(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Rr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof iu&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof hs?ls(i,o):i instanceof ds?vs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Bs(t,r.data(),i);return new iu(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new ou(r.key,o.version,{hasCommittedMutations:!0}))}return e},ma.prototype.In=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=xs(i,e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=xs(a,e,o,this.wn))}return e},ma.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.In(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ma.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},ma.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,Os)&&Mr(this.baseMutations,t.baseMutations,Os)},ma),ra=(ga.from=function(t,e,n){Rr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new ga(t,e,n,r)},ga),ia=(va.prototype.catch=function(t){return this.next(void 0,t)},va.prototype.next=function(r,i){var o=this;return this.yn&&Lr(),this.yn=!0,this.gn?this.error?this.pn(i,this.error):this.bn(r,this.result):new va(function(e,n){o.Pn=function(t){o.bn(r,t).next(e,n)},o.Vn=function(t){o.pn(i,t).next(e,n)}})},va.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},va.prototype.Sn=function(t){try{var e=t();return e instanceof va?e:va.resolve(e)}catch(t){return va.reject(t)}},va.prototype.bn=function(t,e){return t?this.Sn(function(){return t(e)}):va.resolve(e)},va.prototype.pn=function(t,e){return t?this.Sn(function(){return t(e)}):va.reject(e)},va.resolve=function(n){return new va(function(t,e){t(n)})},va.reject=function(n){return new va(function(t,e){e(n)})},va.Dn=function(t){return new va(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},va.Cn=function(t){for(var n=va.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?va.resolve(t):e()})}(r[e]);return n},va.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Dn(i)},va),oa=(Object.defineProperty(ya.prototype,"readTime",{get:function(){return this.kn},set:function(t){this.kn=t},enumerable:!1,configurable:!0}),ya.prototype.$n=function(t,e){this.xn(),this.readTime=e,this.Nn.set(t.key,t)},ya.prototype.Mn=function(t,e){this.xn(),e&&(this.readTime=e),this.Nn.set(t,null)},ya.prototype.On=function(t,e){this.xn();var n=this.Nn.get(e);return void 0!==n?ia.resolve(n):this.Ln(t,e)},ya.prototype.getEntries=function(t,e){return this.qn(t,e)},ya.prototype.apply=function(t){return this.xn(),this.Fn=!0,this.Bn(t)},ya.prototype.xn=function(){},ya),sa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ua=(da.prototype.Qn=function(t){this.Un.push(t)},da.prototype.Wn=function(){this.Un.forEach(function(t){return t()})},da),aa=(pa.prototype.zn=function(e,n){var r=this;return this.Kn.Hn(e,n).next(function(t){return r.Yn(e,n,t)})},pa.prototype.Yn=function(t,r,i){return this.jn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].In(r,t);return t})},pa.prototype.Jn=function(t,e,i){var o=Fi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].In(t,e);o=o.nt(t,e)}),o},pa.prototype.Xn=function(e,t){var n=this;return this.jn.getEntries(e,t).next(function(t){return n.Zn(e,t)})},pa.prototype.Zn=function(r,i){var o=this;return this.Kn.ts(r,i).next(function(t){var e=o.Jn(r,i,t),n=Fi;return e.forEach(function(t,e){e=e||new ou(t,Zr.min()),n=n.nt(t,e)}),n})},pa.prototype.es=function(t,e,n){return r=e,ii.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):yu(e)?this.ss(t,e,n):this.rs(t,e,n);var r},pa.prototype.ns=function(t,e){return this.zn(t,new ii(e)).next(function(t){var e=Gi;return t instanceof iu&&(e=e.nt(t.key,t)),e})},pa.prototype.ss=function(n,r,i){var o=this,s=r.collectionGroup,u=Gi;return this.Gn.os(n,s).next(function(t){return ia.forEach(t,function(t){var e=r.rn(t.child(s));return o.rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},pa.prototype.rs=function(e,n,t){var c,f,r=this;return this.jn.es(e,n,t).next(function(t){return c=t,r.Kn.hs(e,n)}).next(function(t){return f=t,r.as(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=xs(s,a,a,r.wn);c=h instanceof iu?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Nu(n,e)||(c=c.remove(t))}),c})},pa.prototype.as=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Us&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.jn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof iu&&(h=h.nt(t,e))}),h})},pa),ha=(la.ls=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new la(t,e.fromCache,n,r)},la),ca=(fa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},fa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},fa);function fa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function la(t,e,n,r){this.targetId=t,this.fromCache=e,this.us=n,this.cs=r}function pa(t,e,n){this.jn=t,this.Kn=e,this.Gn=n}function da(){this.Un=[]}function ya(){this.Nn=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function va(t){var e=this;this.Pn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.yn=!1,t(function(t){e.gn=!0,e.result=t,e.Pn&&e.Pn(t)},function(t){e.gn=!0,e.error=t,e.Vn&&e.Vn(t)})}function ga(t,e,n,r){this.batch=t,this.An=e,this.En=n,this.Rn=r}function ma(t,e,n,r){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=r}function wa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}ca.Ts=-1;var ba,Ea=(Sa.prototype.reset=function(){this.Ps=0},Sa.prototype.ys=function(){this.Ps=this.Rs},Sa.prototype.ps=function(t){var e=this;this.cancel();var n=Math.floor(this.Ps+this.bs()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ps+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Es.vs(this.Is,i,function(){return e.gs=Date.now(),t()}),this.Ps*=this.As,this.Ps<this.ms&&(this.Ps=this.ms),this.Ps>this.Rs&&(this.Ps=this.Rs)},Sa.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},Sa.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},Sa.prototype.bs=function(){return(Math.random()-.5)*this.Ps},Sa),Ia=(Da.delete=function(t){return kr("SimpleDb","Removing database:",t),Ra(window.indexedDB.deleteDatabase(t)).vn()},Da.Fs=function(){if("undefined"==typeof indexedDB)return!1;if(Da.ks())return!0;var t=p(),e=Da.Ns(t),n=0<e&&e<10,r=Da.$s(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Da.ks=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.xs)},Da.Ms=function(t,e){return t.store(e)},Da.Ns=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Da.$s=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Da.prototype.Os=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Na("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new $r(Yr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Na(e))},i.onupgradeneeded=function(t){kr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Cs.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){kr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Ls&&(this.db.onversionchange=function(t){return o.Ls(t)}),this.db)]}})})},Da.prototype.qs=function(e){this.Ls=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Da.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Os()];case 2:return a.db=t.sent(),e=xa.open(a.db,s?"readonly":"readwrite",h),n=c(e).catch(function(t){return e.abort(t),ia.reject(t)}).vn(),r={},n.catch(function(){}),[4,e.Bs];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,kr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Da.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Da),Ta=(Object.defineProperty(_a.prototype,"gn",{get:function(){return this.Qs},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"js",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"cursor",{set:function(t){this.Us=t},enumerable:!1,configurable:!0}),_a.prototype.done=function(){this.Qs=!0},_a.prototype.Ks=function(t){this.Ws=t},_a.prototype.delete=function(){return Ra(this.Us.delete())},_a),Na=(n(Aa,ba=$r),Aa);function Aa(t){var e=this;return(e=ba.call(this,Yr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function _a(t){this.Us=t,this.Qs=!1,this.Ws=null}function Da(t,e,n){this.name=t,this.version=e,this.Cs=n,12.2===Da.Ns(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Sa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Es=t,this.Is=e,this.ms=n,this.As=r,this.Rs=i,this.Ps=0,this.Vs=null,this.gs=Date.now(),this.reset()}function ka(t){return"IndexedDbTransactionError"===t.name}var xa=(La.open=function(t,e,n){try{return new La(t.transaction(n,e))}catch(t){throw new Na(t)}},Object.defineProperty(La.prototype,"Bs",{get:function(){return this.Gs.promise},enumerable:!1,configurable:!0}),La.prototype.abort=function(t){t&&this.Gs.reject(t),this.aborted||(kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},La.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Oa(e)},La),Oa=(Pa.prototype.put=function(t,e){return Ra(void 0!==e?(kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Pa.prototype.add=function(t){return kr("SimpleDb","ADD",this.store.name,t,t),Ra(this.store.add(t))},Pa.prototype.get=function(e){var n=this;return Ra(this.store.get(e)).next(function(t){return void 0===t&&(t=null),kr("SimpleDb","GET",n.store.name,e,t),t})},Pa.prototype.delete=function(t){return kr("SimpleDb","DELETE",this.store.name,t),Ra(this.store.delete(t))},Pa.prototype.count=function(){return kr("SimpleDb","COUNT",this.store.name),Ra(this.store.count())},Pa.prototype.zs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Hs(n,function(t,e){r.push(e)}).next(function(){return r})},Pa.prototype.Ys=function(t,e){kr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Js=!1;var r=this.cursor(n);return this.Hs(r,function(t,e,n){return n.delete()})},Pa.prototype.Xs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Hs(r,e)},Pa.prototype.Zs=function(i){var t=this.cursor({});return new ia(function(n,r){t.onerror=function(t){var e=Ua(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Pa.prototype.Hs=function(t,s){var u=[];return new ia(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ta(i),(n=s(i.primaryKey,i.value,e))instanceof ia&&(r=n.catch(function(t){return e.done(),ia.reject(t)}),u.push(r)),e.gn?o():null===e.js?i.continue():i.continue(e.js)):o()}}).next(function(){return ia.Dn(u)})},Pa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Pa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Js?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Pa);function Pa(t){this.store=t}function La(t){var n=this;this.transaction=t,this.aborted=!1,this.Gs=new wa,this.transaction.oncomplete=function(){n.Gs.resolve()},this.transaction.onabort=function(){t.error?n.Gs.reject(new Na(t.error)):n.Gs.resolve()},this.transaction.onerror=function(t){var e=Ua(t.target.error);n.Gs.reject(new Na(e))}}function Ra(t){return new ia(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ua(t.target.error);r(e)}})}var Ca=!1;function Ua(t){var e=Ia.Ns(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new $r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ca||(Ca=!0,setTimeout(function(){throw r},0)),r}}return t}function Va(){return"undefined"!=typeof window?window:null}function Ma(){return"undefined"!=typeof document?document:null}var Fa=(Ga.ii=function(t,e,n,r,i){var o=new Ga(t,e,Date.now()+n,r,i);return o.start(n),o},Ga.prototype.start=function(t){var e=this;this.ri=setTimeout(function(){return e.oi()},t)},Ga.prototype.Ds=function(){return this.oi()},Ga.prototype.cancel=function(t){null!==this.ri&&(this.clearTimeout(),this.si.reject(new $r(Yr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ga.prototype.oi=function(){var e=this;this.ti.hi(function(){return null!==e.ri?(e.clearTimeout(),e.op().then(function(t){return e.si.resolve(t)})):Promise.resolve()})},Ga.prototype.clearTimeout=function(){null!==this.ri&&(this.ni(this),clearTimeout(this.ri),this.ri=null)},Ga),ja=(Object.defineProperty(qa.prototype,"Ei",{get:function(){return this.ci},enumerable:!1,configurable:!0}),qa.prototype.hi=function(t){this.enqueue(t)},qa.prototype.Ii=function(t){this.mi(),this.Ai(t)},qa.prototype.Ri=function(t){return this.mi(),this.Ai(t)},qa.prototype.Pi=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.mi(),this.ci?[3,2]:(this.ci=!0,(e=Ma())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ti),[4,this.Ri(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},qa.prototype.enqueue=function(t){return this.mi(),this.ci?new Promise(function(t){}):this.Ai(t)},qa.prototype.Vi=function(t){var e=this;this.ui.push(t),this.hi(function(){return e.gi()})},qa.prototype.gi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ui.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ui[0]()];case 2:return t.sent(),this.ui.shift(),this.wi.reset(),[3,4];case 3:if(!ka(e=t.sent()))throw e;return kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ui.length&&this.wi.ps(function(){return n.gi()}),t.label=5;case 5:return[2]}})})},qa.prototype.Ai=function(t){var r=this,e=this.ai.then(function(){return r.fi=!0,t().catch(function(t){throw r._i=t,r.fi=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.fi=!1,t})});return this.ai=e},qa.prototype.vs=function(t,e,n){var r=this;this.mi(),-1<this.di.indexOf(t)&&(e=0);var i=Fa.ii(this,t,e,n,function(t){return r.yi(t)});return this.li.push(i),i},qa.prototype.mi=function(){this._i&&Lr()},qa.prototype.pi=function(){},qa.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ai];case 1:t.sent(),t.label=2;case 2:if(e!==this.ai)return[3,0];t.label=3;case 3:return[2]}})})},qa.prototype.vi=function(t){for(var e=0,n=this.li;e<n.length;e++)if(n[e].Is===t)return!0;return!1},qa.prototype.Si=function(r){var i=this;return this.bi().then(function(){i.li.sort(function(t,e){return t.ei-e.ei});for(var t=0,e=i.li;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.Is===r)break}return i.bi()})},qa.prototype.Di=function(t){this.di.push(t)},qa.prototype.yi=function(t){var e=this.li.indexOf(t);this.li.splice(e,1)},qa);function qa(){var e=this;this.ai=Promise.resolve(),this.ui=[],this.ci=!1,this.li=[],this._i=null,this.fi=!1,this.di=[],this.wi=new Ea(this,"async_queue_retry"),this.Ti=function(){var t=Ma();t&&kr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.wi.Ss()};var t=Ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ti)}function Ga(t,e,n,r,i){this.ti=t,this.Is=e,this.ei=n,this.op=r,this.ni=i,this.si=new wa,this.then=this.si.promise.then.bind(this.si.promise),this.si.promise.catch(function(t){})}function Ba(t,e){if(xr("AsyncQueue",e+": "+t),ka(t))return new $r(Yr.UNAVAILABLE,e+": "+t);throw t}function za(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Vr(n,i);return 0===s?Vr(r,o):s}var Ka=(Qa.prototype.Fi=function(){return++this.Ni},Qa.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):za(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Qa.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Qa),Xa={$i:!1,xi:0,Mi:0,Oi:0},Ha=(Wa.Ui=function(t){return new Wa(t,Wa.Qi,Wa.Wi)},Wa);function Wa(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Qa(t){this.Ci=t,this.buffer=new Vi(za),this.Ni=0}Ha.ji=-1,Ha.Ki=1048576,Ha.Gi=41943040,Ha.Qi=10,Ha.Wi=1e3,Ha.zi=new Ha(Ha.Gi,Ha.Qi,Ha.Wi),Ha.Hi=new Ha(Ha.ji,0,0);var Ya=(Za.prototype.start=function(t){this.Yi.params.Li!==Ha.ji&&this.Zi(t)},Za.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(Za.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),Za.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;kr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ti.vs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return ka(e=t.sent())?(kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ic(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},Za),$a=(Ja.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},Ja.prototype.rr=function(t,e){var n=this;if(0===e)return ia.resolve(ca.Ts);var r=new Ka(e);return this.nr.pe(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},Ja.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},Ja.prototype.ar=function(t,e){return this.nr.ar(t,e)},Ja.prototype.ur=function(e,n){var r=this;return this.params.Li===Ha.ji?(kr("LruGarbageCollector","Garbage collection skipped; disabled"),ia.resolve(Xa)):this.cr(e).next(function(t){return t<r.params.Li?(kr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Xa):r.lr(e,n)})},Ja.prototype.cr=function(t){return this.nr.cr(t)},Ja.prototype.lr=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>c.params.Bi?(kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Bi+" from "+t),c.params.Bi):t,s=Date.now(),c.rr(e,i)}).next(function(t){return r=t,u=Date.now(),c.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.ar(e,r)}).next(function(t){return h=Date.now(),Sr()<=l.DEBUG&&kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),ia.resolve({$i:!0,xi:i,Mi:o,Oi:t})})},Ja);function Ja(t,e){this.nr=t,this.params=e}function Za(t,e){this.Yi=t,this.ti=e,this.Ji=!1,this.Xi=null}function th(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=eh(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return eh(o)}function eh(t){return t+""}function nh(t){var e=t.length;if(Rr(2<=e),2===e)return Rr(""===t.charAt(0)&&""===t.charAt(1)),ei.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new ei(r)}var rh=function(t){this._r=t};function ih(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Bo(n,r.name),s=Fo(r.updateTime),u=new Ws({mapValue:{fields:r.fields}}),new iu(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ii.j(e.noDocument.path),h=hh(e.noDocument.readTime);return new ou(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ii.j(e.unknownDocument.path),f=hh(e.unknownDocument.version);return new su(c,f)}return Lr()}function oh(t,e,n){var r,i,o=sh(n),s=e.key.path.p().N();if(e instanceof iu){var u={name:Go(r=t._r,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Vo(r,i.version.A())},a=e.hasCommittedMutations;return new Gh(null,null,u,a,o,s)}if(e instanceof ou){var h=e.key.path.N(),c=ah(e.version),f=e.hasCommittedMutations;return new Gh(null,new jh(h,c),null,f,o,s)}if(e instanceof su){var l=e.key.path.N(),p=ah(e.version);return new Gh(new qh(l,p),null,null,!0,o,s)}return Lr()}function sh(t){var e=t.A();return[e.seconds,e.nanoseconds]}function uh(t){var e=new Jr(t[0],t[1]);return Zr.I(e)}function ah(t){var e=t.A();return new Oh(e.seconds,e.nanoseconds)}function hh(t){var e=new Jr(t.seconds,t.nanoseconds);return Zr.I(e)}function ch(e,t){var n=(t.baseMutations||[]).map(function(t){return Yo(e._r,t)}),r=t.mutations.map(function(t){return Yo(e._r,t)}),i=Jr.fromMillis(t.localWriteTimeMs);return new na(t.batchId,i,n,r)}function fh(t){var e,n=hh(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?hh(t.lastLimboFreeSnapshotVersion):Zr.min(),i=void 0!==t.query.documents?(Rr(1===(e=t.query).documents.length),gu(du(Ko(e.documents[0])))):function(t){var e,n=Ko(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Rr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return Du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return Du.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ns(t.unaryFilter.field);return Du.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ns(t.unaryFilter.field);return Du.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Du.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Lr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ea(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=pi(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=ts(r.startAt));var l=null;return r.endAt&&(l=ts(r.endAt)),gu(pu(n,o,u,s,c,"F",f,l))}(t.query);return new _i(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ei.fromBase64String(t.resumeToken))}function lh(t,e){var n=ah(e.X),r=ah(e.lastLimboFreeSnapshotVersion),i=(bi(e.target)?$o:Jo)(t._r,e.target),o=e.resumeToken.toBase64();return new zh(e.targetId,mi(e.target),n,o,e.sequenceNumber,r,i)}var ph=(dh.Tr=function(t,e,n,r){return Rr(""!==t.uid),new dh(t.Er()?t.uid:"",e,n,r)},dh.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gh(t).Xs({index:Vh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},dh.prototype.mr=function(d,y,v,g){var m=this,w=mh(d),b=gh(d);return b.add({}).next(function(t){Rr("number"==typeof t);for(var e,n,r,i,o,s=new na(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Qo(e._r,t)}),o=r.mutations.map(function(t){return Qo(e._r,t)}),new Vh(n,r.batchId,r.wn.toMillis(),i,o)),a=[],h=new Vi(function(t,e){return Vr(t.F(),e.F())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Mh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Mh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Gn.Ar(d,t))}),d.Qn(function(){m.wr[t]=s.keys()}),ia.Dn(a).next(function(){return s})})},dh.prototype.Rr=function(t,e){var n=this;return gh(t).get(e).next(function(t){return t?(Rr(t.userId===n.userId),ch(n.serializer,t)):null})},dh.prototype.Pr=function(t,n){var r=this;return this.wr[n]?ia.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},dh.prototype.Vr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return gh(t).Xs({index:Vh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Rr(e.batchId>=i),o=ch(r.serializer,e)),n.done()}).next(function(){return o})},dh.prototype.gr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return gh(t).Xs({index:Vh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},dh.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gh(t).zs(Vh.userMutationsIndex,n).next(function(t){return t.map(function(t){return ch(e.serializer,t)})})},dh.prototype.Hn=function(u,a){var h=this,t=Mh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return mh(u).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=nh(i);if(r===h.userId&&a.path.isEqual(s))return gh(u).get(o).next(function(t){if(!t)throw Lr();Rr(t.userId===h.userId),c.push(ch(h.serializer,t))});n.done()}).next(function(){return c})},dh.prototype.ts=function(r,t){var a=this,h=new Vi(Vr),i=[];return t.forEach(function(u){var t=Mh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=mh(r).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=nh(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),ia.Dn(i).next(function(){return a.pr(r,h)})},dh.prototype.hs=function(t,e){var u=this,a=e.path,h=a.length+1,n=Mh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Vi(Vr);return mh(t).Xs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=nh(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.pr(t,c)})},dh.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(gh(e).get(t).next(function(t){if(null===t)throw Lr();Rr(t.userId===n.userId),r.push(ch(n.serializer,t))}))}),ia.Dn(i).next(function(){return r})},dh.prototype.br=function(e,n){var r=this;return vh(e.vr,this.userId,n).next(function(t){return e.Qn(function(){r.Sr(n.batchId)}),ia.forEach(t,function(t){return r.dr.Dr(e,t)})})},dh.prototype.Sr=function(t){delete this.wr[t]},dh.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return ia.resolve();var e=IDBKeyRange.lowerBound(Mh.prefixForUser(o.userId)),i=[];return mh(n).Xs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=nh(t[1]),i.push(r)):n.done()}).next(function(){Rr(0===i.length)})})},dh.prototype.Nr=function(t,e){return yh(t,this.userId,e)},dh.prototype.Fr=function(t){var e=this;return wh(t).get(this.userId).next(function(t){return t||new Uh(e.userId,-1,"")})},dh);function dh(t,e,n,r){this.userId=t,this.serializer=e,this.Gn=n,this.dr=r,this.wr={}}function yh(t,o,e){var n=Mh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return mh(t).Xs({range:r,Js:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function vh(t,e,n){var r=t.store(Vh.store),i=t.store(Mh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Xs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Rr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Mh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return ia.Dn(o).next(function(){return h})}function gh(t){return cc.Ms(t,Vh.store)}function mh(t){return cc.Ms(t,Mh.store)}function wh(t){return cc.Ms(t,Uh.store)}var bh,Eh=(Ih.prototype.$n=function(t,e,n){return Nh(t).put(Ah(e),n)},Ih.prototype.Mn=function(t,e){var n=Nh(t),r=Ah(e);return n.delete(r)},Ih.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Ih.prototype.On=function(t,e){var n=this;return Nh(t).get(Ah(e)).next(function(t){return n.$r(t)})},Ih.prototype.xr=function(t,e){var n=this;return Nh(t).get(Ah(e)).next(function(t){var e=n.$r(t);return e?{Mr:e,size:_h(t)}:null})},Ih.prototype.getEntries=function(t,e){var r=this,i=Fi;return this.Or(t,e,function(t,e){var n=r.$r(e);i=i.nt(t,n)}).next(function(){return i})},Ih.prototype.Lr=function(t,e){var r=this,i=Fi,o=new xi(ii.P);return this.Or(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.nt(t,n),o.nt(t,_h(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{qr:i,Br:o}})},Ih.prototype.Or=function(t,e,i){if(e._())return ia.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.at(),s=o.dt();return Nh(t).Xs({range:n},function(t,e,n){for(var r=ii.j(t);s&&ii.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.Ks(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Ih.prototype.es=function(t,i,e){var n,r,o,s=this,u=Gi,a=i.path.length+1,h={};return e.isEqual(Zr.min())?(n=i.path.N(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=sh(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Gh.collectionReadTimeIndex),Nh(t).Xs(h,function(t,e,n){var r;t.length===a&&(r=ih(s.serializer,e),i.path.D(r.key.path)?r instanceof iu&&Nu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Ih.prototype.Ur=function(t,e){var r=this,i=Fi,o=sh(e),n=Nh(t),s=IDBKeyRange.lowerBound(o,!0);return n.Xs({index:Gh.readTimeIndex,range:s},function(t,e){var n=ih(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:uh(o)}})},Ih.prototype.Wr=function(t){var e=Nh(t),r=Zr.min();return e.Xs({index:Gh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=uh(e.readTime)),n.done()}).next(function(){return r})},Ih.prototype.jr=function(t){return new Ih.Kr(this,!!t&&t.Gr)},Ih.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ih.prototype.getMetadata=function(t){return Th(t).get(Bh.key).next(function(t){return Rr(!!t),t})},Ih.prototype.kr=function(t,e){return Th(t).put(Bh.key,e)},Ih.prototype.$r=function(t){if(t){var e=ih(this.serializer,t);return e instanceof ou&&e.version.isEqual(Zr.min())?null:e}return null},Ih);function Ih(t,e){this.serializer=t,this.Gn=e}function Th(t){return cc.Ms(t,Bh.store)}function Nh(t){return cc.Ms(t,Gh.store)}function Ah(t){return t.path.N()}function _h(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}function Dh(t,e){var n=this;return(n=bh.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Eh.Kr=(n(Dh,bh=oa),Dh.prototype.Bn=function(s){var u=this,a=[],h=0,c=new Vi(function(t,e){return Vr(t.F(),e.F())});return this.Nn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=oh(u.Hr.serializer,e,u.readTime),c=c.add(t.path.p()),r=_h(n),h+=r-o,a.push(u.Hr.$n(s,t,n))):(h-=o,u.Gr?(i=oh(u.Hr.serializer,new ou(t,Zr.min()),u.readTime),a.push(u.Hr.$n(s,t,i))):a.push(u.Hr.Mn(s,t)))}),c.forEach(function(t){a.push(u.Hr.Gn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,h)),ia.Dn(a)},Dh.prototype.Ln=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Mr)})},Dh.prototype.qn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},Dh);var Sh=(Ch.prototype.Ar=function(t,e){return this.Jr.add(e),ia.resolve()},Ch.prototype.os=function(t,e){return ia.resolve(this.Jr.getEntries(e))},Ch),kh=(Rh.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Vi(ei.P),i=!r.has(n);return this.index[e]=r.add(n),i},Rh.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Rh.prototype.getEntries=function(t){return(this.index[t]||new Vi(ei.P)).N()},Rh),xh=(Lh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Rr(t<e&&0<=t&&e<=10);var o,s=new xa(r);t<1&&1<=e&&(n.createObjectStore(Ph.store),(o=n).createObjectStore(Uh.store,{keyPath:Uh.keyPath}),o.createObjectStore(Vh.store,{keyPath:Vh.keyPath,autoIncrement:!0}).createIndex(Vh.userMutationsIndex,Vh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Mh.store),Wh(n),n.createObjectStore(Gh.store));var u,a=ia.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Kh.store),u.deleteObjectStore(zh.store),u.deleteObjectStore(Xh.store),Wh(n)),a=a.next(function(){return t=s.store(Xh.store),e=new Xh(0,0,Zr.min().A(),0),t.put(Xh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Vh.store).zs().next(function(t){r.deleteObjectStore(Vh.store),r.createObjectStore(Vh.store,{keyPath:Vh.keyPath,autoIncrement:!0}).createIndex(Vh.userMutationsIndex,Vh.userMutationsKeyPath,{unique:!0});var e=i.store(Vh.store),n=t.map(function(t){return e.put(t)});return ia.Dn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Qh.store,{keyPath:Qh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Bh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Gh.store)).createIndex(Gh.readTimeIndex,Gh.readTimeIndexPath,{unique:!1}),t.createIndex(Gh.collectionReadTimeIndex,Gh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Lh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Gh.store).Xs(function(t,e){n+=_h(e)}).next(function(){var t=new Bh(n);return e.store(Bh.store).put(Bh.key,t)})},Lh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Uh.store),e=r.store(Vh.store);return t.zs().next(function(t){return ia.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.zs(Vh.userMutationsIndex,t).next(function(t){return ia.forEach(t,function(t){Rr(t.userId===n.userId);var e=ch(i.serializer,t);return vh(r,n.userId,e).next(function(){})})})})})},Lh.prototype.ensureSequenceNumbers=function(t){var s=t.store(Kh.store),e=t.store(Gh.store);return t.store(Xh.store).get(Xh.key).next(function(i){var o=[];return e.Xs(function(t,e){var n=new ei(t),r=[0,th(n)];o.push(s.get(r).next(function(t){return t?ia.resolve():s.put(new Kh(0,th(n),i.highestListenSequenceNumber))}))}).next(function(){return ia.Dn(o)})})},Lh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:th(n)})}}t.createObjectStore(Hh.store,{keyPath:Hh.keyPath});var i=e.store(Hh.store),o=new kh;return e.store(Gh.store).Xs({Js:!0},function(t,e){return r(new ei(t).p())}).next(function(){return e.store(Mh.store).Xs({Js:!0},function(t,e){t[0];var n=t[1];return r((t[2],nh(n)).p())})})},Lh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(zh.store);return o.Xs(function(t,e){var n=fh(e),r=lh(i.serializer,n);return o.put(r)})},Lh),Oh=function(t,e){this.seconds=t,this.nanoseconds=e},Ph=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Lh(t){this.serializer=t}function Rh(){this.index={}}function Ch(){this.Jr=new kh}Ph.store="owner",Ph.key="owner";var Uh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Uh.store="mutationQueues",Uh.keyPath="userId";var Vh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Vh.store="mutations",Vh.keyPath="batchId",Vh.userMutationsIndex="userMutationsIndex",Vh.userMutationsKeyPath=["userId","batchId"];var Mh=(Fh.prefixForUser=function(t){return[t]},Fh.prefixForPath=function(t,e){return[t,th(e)]},Fh.key=function(t,e,n){return[t,th(e),n]},Fh);function Fh(){}Mh.store="documentMutations",Mh.PLACEHOLDER=new Mh;var jh=function(t,e){this.path=t,this.readTime=e},qh=function(t,e){this.path=t,this.version=e},Gh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Gh.store="remoteDocuments",Gh.readTimeIndex="readTimeIndex",Gh.readTimeIndexPath="readTime",Gh.collectionReadTimeIndex="collectionReadTimeIndex",Gh.collectionReadTimeIndexPath=["parentPath","readTime"];var Bh=function(t){this.byteSize=t};Bh.store="remoteDocumentGlobal",Bh.key="remoteDocumentGlobalKey";var zh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};zh.store="targets",zh.keyPath="targetId",zh.queryTargetsIndexName="queryTargetsIndex",zh.queryTargetsKeyPath=["canonicalId","targetId"];var Kh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Kh.store="targetDocuments",Kh.keyPath=["targetId","path"],Kh.documentTargetsIndex="documentTargetsIndex",Kh.documentTargetsKeyPath=["path","targetId"];var Xh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Xh.key="targetGlobalKey",Xh.store="targetGlobal";var Hh=function(t,e){this.collectionId=t,this.parent=e};function Wh(t){t.createObjectStore(Kh.store,{keyPath:Kh.keyPath}).createIndex(Kh.documentTargetsIndex,Kh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(zh.store,{keyPath:zh.keyPath}).createIndex(zh.queryTargetsIndexName,zh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Xh.store)}Hh.store="collectionParents",Hh.keyPath=["collectionId","parent"];var Qh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Qh.store="clientMetadata",Qh.keyPath="clientId";var Yh=i(i(i([Uh.store,Vh.store,Mh.store,Gh.store,zh.store,Ph.store,Xh.store,Kh.store],[Qh.store]),[Bh.store]),[Hh.store]),$h=(Jh.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return ia.resolve();var r=e.S(),i=e.p();t.Qn(function(){n.Xr.add(e)});var o={collectionId:r,parent:th(i)};return Zh(t).put(o)},Jh.prototype.os=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Fr(i),""],!1,!0);return Zh(t).zs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(nh(r.parent))}return o})},Jh);function Jh(){this.Xr=new kh}function Zh(t){return cc.Ms(t,Hh.store)}var tc=(rc.prototype.next=function(){return this.Zr+=2,this.Zr},rc.to=function(){return new rc(0)},rc.eo=function(){return new rc(-1)},rc),ec=(nc.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new tc(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},nc.prototype.ro=function(t){return this.so(t).next(function(t){return Zr.I(new Jr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},nc.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},nc.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},nc.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},nc.prototype.lo=function(t,e){return this.uo(t,e)},nc.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return ic(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Rr(0<t.targetCount),--t.targetCount,n.io(e,t)})},nc.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return ic(r).Xs(function(t,e){var n=fh(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return ia.Dn(a)}).next(function(){return u})},nc.prototype.pe=function(t,r){return ic(t).Xs(function(t,e){var n=fh(e);r(n)})},nc.prototype.so=function(t){return oc(t).get(Xh.key).next(function(t){return Rr(null!==t),t})},nc.prototype.io=function(t,e){return oc(t).put(Xh.key,e)},nc.prototype.uo=function(t,e){return ic(t).put(lh(this.serializer,e))},nc.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},nc.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},nc.prototype.wo=function(t,i){var e=mi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return ic(t).Xs({range:n,index:zh.queryTargetsIndexName},function(t,e,n){var r=fh(e);wi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},nc.prototype.To=function(n,t,r){var i=this,o=[],s=sc(n);return t.forEach(function(t){var e=th(t.path);o.push(s.put(new Kh(r,e))),o.push(i.dr.Eo(n,r,t))}),ia.Dn(o)},nc.prototype.Io=function(n,t,r){var i=this,o=sc(n);return ia.forEach(t,function(t){var e=th(t.path);return ia.Dn([o.delete([r,e]),i.dr.mo(n,r,t)])})},nc.prototype.fo=function(t,e){var n=sc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},nc.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=sc(t),o=Ki();return r.Xs({range:n,Js:!0},function(t,e,n){var r=nh(t[1]),i=new ii(r);o=o.add(i)}).next(function(){return o})},nc.prototype.Nr=function(t,e){var n=th(e.path),r=IDBKeyRange.bound([n],[Fr(n)],!1,!0),i=0;return sc(t).Xs({index:Kh.documentTargetsIndex,Js:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},nc.prototype.Me=function(t,e){return ic(t).get(e).next(function(t){return t?fh(t):null})},nc);function nc(t,e){this.dr=t,this.serializer=e}function rc(t){this.Zr=t}function ic(t){return cc.Ms(t,zh.store)}function oc(t){return cc.Ms(t,Xh.store)}function sc(t){return cc.Ms(t,Kh.store)}var uc,ac="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hc=(n(lc,uc=ua),lc),cc=(fc.Ms=function(t,e){if(t instanceof hc)return Ia.Ms(t.vr,e);throw Lr()},fc.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new $r(Yr.FAILED_PRECONDITION,ac);return e.Mo(),e.Oo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new ca(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},fc.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},fc.prototype.Bo=function(n){var t=this;this.Fo.qs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},fc.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Es.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},fc.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return dc(e).put(new Qh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Es.Vi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(ka(t))return kr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Es.Vi(function(){return n.Co(t)}),n.isPrimary=t})},fc.prototype.Qo=function(t){var e=this;return pc(t).get(Ph.key).next(function(t){return ia.resolve(e.Go(t))})},fc.prototype.zo=function(t){return dc(t).delete(this.clientId)},fc.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=fc.Ms(t,Qh.store);return r.zs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ia.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},fc.prototype.Lo=function(){var t=this;this.So=this.Es.vs("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},fc.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},fc.prototype.Wo=function(e){var i=this;return this.Vo?ia.resolve(!0):pc(e).get(Ph.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new $r(Yr.FAILED_PRECONDITION,ac);return!1}}return!(!i.networkEnabled||!i.inForeground)||dc(e).zs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},fc.prototype.th=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.jo(t).next(function(){return e.zo(t)})}).catch(function(t){kr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},fc.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},fc.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return dc(t).zs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(fc.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),fc.prototype.oh=function(t){return ph.Tr(t,this.serializer,this.Gn,this.dr)},fc.prototype.hh=function(){return this.ko},fc.prototype.ah=function(){return this.jn},fc.prototype.uh=function(){return this.Gn},fc.prototype.runTransaction=function(e,n,r){var i=this;kr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Yh,function(t){return o=new hc(t,i.yo?i.yo.next():ca.Ts),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Es.Vi(function(){return i.Co(!1)}),new $r(Yr.FAILED_PRECONDITION,sa);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},fc.prototype.lh=function(t){var e=this;return pc(t).get(Ph.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new $r(Yr.FAILED_PRECONDITION,ac)})},fc.prototype.Ko=function(t){var e=new Ph(this.clientId,this.allowTabSynchronization,Date.now());return pc(t).put(Ph.key,e)},fc.Fs=function(){return Ia.Fs()},fc.prototype.jo=function(t){var e=this,n=pc(t);return n.get(Ph.key).next(function(t){return e.Go(t)?(kr("IndexedDbPersistence","Releasing primary lease."),n.delete(Ph.key)):ia.resolve()})},fc.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},fc.prototype.Mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Es.hi(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},fc.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},fc.prototype.Oo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Es.hi(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},fc.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},fc.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return kr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},fc.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},fc.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},fc.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},fc);function fc(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Es=i,this.window=o,this.document=s,this.Po=a,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!fc.Fs())throw new $r(Yr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new yc(this,r),this.No=e+"main",this.serializer=new rh(u),this.Fo=new Ia(this.No,10,new xh(this.serializer)),this.ko=new ec(this.dr,this.serializer),this.Gn=new $h,this.jn=new Eh(this.serializer,this.Gn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===h&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function lc(t,e){var n=this;return(n=uc.call(this)||this).vr=t,n.Ro=e,n}function pc(t){return cc.Ms(t,Ph.store)}function dc(t){return cc.Ms(t,Qh.store)}var yc=(vc.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},vc.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},vc.prototype.pe=function(t,e){return this.db.hh().pe(t,e)},vc.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},vc.prototype.Eo=function(t,e,n){return gc(t,n)},vc.prototype.mo=function(t,e,n){return gc(t,n)},vc.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},vc.prototype.Dr=gc,vc.prototype.dh=function(t,e){return r=e,i=!1,wh(n=t).Zs(function(t){return yh(n,t,r).next(function(t){return t&&(i=!0),ia.resolve(!t)})}).next(function(){return i});var n,r,i},vc.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.On(r,e).next(function(){return s.Mn(e),sc(r).delete([0,th(e.path)])})}),u.push(n))}).next(function(){return ia.Dn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},vc.prototype.removeTarget=function(t,e){var n=e.Z(t.Ro);return this.db.hh().lo(t,n)},vc.prototype.wh=gc,vc.prototype.fh=function(t,o){var s,e=sc(t),u=ca.Ts;return e.Xs({index:Kh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==ca.Ts&&o(new ii(nh(s)),u),u=i,s=r):u=ca.Ts}).next(function(){u!==ca.Ts&&o(new ii(nh(s)),u)})},vc.prototype.cr=function(t){return this.db.ah().zr(t)},vc);function vc(t,e){this.db=t,this.Yi=new $a(this,e)}function gc(t,e){return sc(t).put((n=t.Ro,new Kh(0,th(e.path),n)));var n}function mc(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var wc=(bc.prototype.Vh=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Kn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Kn.yr(v).next(function(t){return g=t,e=r.persistence.oh(i),m=new aa(r.Ah,e,r.persistence.uh()),e.yr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xn(v,r).next(function(t){return{gh:t,yh:e,ph:n}})})})];case 1:return n=t.sent(),[2,(this.Kn=e,this.Rh=m,this.Th.Ph(this.Rh),n)]}})})},bc.prototype.bh=function(h){var c,f=this,l=Jr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Ki());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Xn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof qs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof iu?t.field(i.field):void 0,s=os(i.transform,o||null);null!=s&&(e=null==e?(new Qs).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Us(o.key,s,function u(t){var a=[];return zr(t.fields||{},function(t,e){var n=new ri([t]);if(xo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Is(a)}(s.proto.mapValue),_s.exists(!0)))}return f.Kn.mr(a,l,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Nn:e}})},bc.prototype.vh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ah.jr({Gr:!0});return i.Sh(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Kn.Cr(t)}).next(function(){return i.Rh.Xn(t,e)})})},bc.prototype.Dh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Kn.Rr(e,t).next(function(t){return Rr(null!==t),n=t.keys(),r.Kn.br(e,t)}).next(function(){return r.Kn.Cr(e)}).next(function(){return r.Rh.Xn(e,n)})})},bc.prototype.gr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Kn.gr(t)})},bc.prototype.ro=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})},bc.prototype.Ch=function(a){var h=this,c=a.X,f=this.Eh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ah.jr({Gr:!0});f=h.Eh;var s=[];a.Qt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.ko.Io(o,t.Xt,e).next(function(){return h.ko.To(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Ro),f=f.nt(e,r),bc.Nh(i,r,t)&&s.push(h.ko.lo(o,r))))});var t,u=Fi,n=Ki();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof ou&&e.version.isEqual(Zr.min())?(i.Mn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.$n(e,c),u=u.nt(t,e)):kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.dr.wh(o,t))})})),c.isEqual(Zr.min())||(t=h.ko.ro(o).next(function(t){return h.ko.ho(o,o.Ro,c)}),s.push(t)),ia.Dn(s).next(function(){return i.apply(o)}).next(function(){return h.Rh.Zn(o,u)})}).then(function(t){return h.Eh=f,t})},bc.Nh=function(t,e,n){return Rr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Fh||0<n.Yt.size+n.Jt.size+n.Xt.size},bc.prototype.kh=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ia.forEach(c,function(e){return ia.forEach(e.us,function(t){return h.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return ia.forEach(e.cs,function(t){return h.persistence.dr.mo(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!ka(e=t.sent()))throw e;return kr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Eh.get(o),u=s.X,a=s.et(u),this.Eh=this.Eh.nt(o,a));return[2]}})})},bc.prototype.$h=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Kn.Vr(t,e)})},bc.prototype.xh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.zn(t,e)})},bc.prototype.Mh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,ia.resolve(n)):i.ko.no(e).next(function(t){return n=new _i(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.Eh=i.Eh.nt(t.targetId,t),i.Ih.set(r,t.targetId)),t})},bc.prototype.wo=function(t,e){var n=this.Ih.get(e);return void 0!==n?ia.resolve(this.Eh.get(n)):this.ko.wo(t,e)},bc.prototype.Oh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.Eh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.dr.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ka(r=t.sent()))throw r;return kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.Eh=this.Eh.remove(o),this.Ih.delete(e.target),[2]}})})},bc.prototype.Lh=function(t,n){var r=this,i=Zr.min(),o=Ki();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.wo(e,gu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.ko.Ao(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Th.es(e,t,n?i:Zr.min(),n?o:Ki())}).next(function(t){return{documents:t,qh:o}})})},bc.prototype.Sh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=ia.resolve();return n.forEach(function(r){u=u.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Rr(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(r,e,i))&&o.$n(e,i.An)})}),u.next(function(){return e.Kn.br(t,s)})},bc.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},bc);function bc(t,e,n){this.persistence=t,this.Th=e,this.Eh=new xi(Vr),this.Ih=new Qr(mi,wi),this.mh=Zr.min(),this.Kn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new aa(this.Ah,this.Kn,this.persistence.uh()),this.Th.Ph(this.Rh)}function Ec(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Ic(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Yr.FAILED_PRECONDITION||e.message!==sa)throw e;return kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}wc.Fh=3e8;var Tc=(Sc.prototype._=function(){return this.Bh._()},Sc.prototype.Eo=function(t,e){var n=new Nc(t,e);this.Bh=this.Bh.add(n),this.Qh=this.Qh.add(n)},Sc.prototype.jh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Sc.prototype.mo=function(t,e){this.Kh(new Nc(t,e))},Sc.prototype.Gh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Sc.prototype.zh=function(t){var e=this,n=new ii(new ei([])),r=new Nc(n,t),i=new Nc(n,t+1),o=[];return this.Qh.vt([r,i],function(t){e.Kh(t),o.push(t.key)}),o},Sc.prototype.Hh=function(){var e=this;this.Bh.forEach(function(t){return e.Kh(t)})},Sc.prototype.Kh=function(t){this.Bh=this.Bh.delete(t),this.Qh=this.Qh.delete(t)},Sc.prototype.Yh=function(t){var e=new ii(new ei([])),n=new Nc(e,t),r=new Nc(e,t+1),i=Ki();return this.Qh.vt([n,r],function(t){i=i.add(t.key)}),i},Sc.prototype.Nr=function(t){var e=new Nc(t,0),n=this.Bh.Dt(e);return null!==n&&t.isEqual(n.key)},Sc),Nc=(Dc.Uh=function(t,e){return ii.P(t.key,e.key)||Vr(t.Jh,e.Jh)},Dc.Wh=function(t,e){return Vr(t.Jh,e.Jh)||ii.P(t.key,e.key)},Dc),Ac=(_c.prototype.Er=function(){return null!=this.uid},_c.prototype.Xh=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},_c.prototype.isEqual=function(t){return t.uid===this.uid},_c);function _c(t){this.uid=t}function Dc(t,e){this.key=t,this.Jh=e}function Sc(){this.Bh=new Vi(Nc.Uh),this.Qh=new Vi(Nc.Wh)}function kc(t,e){this.user=e,this.type="OAuth",this.ea={},this.ea.Authorization="Bearer "+t}Ac.UNAUTHENTICATED=new Ac(null),Ac.Zh=new Ac("google-credentials-uid"),Ac.ta=new Ac("first-party-uid");var xc,Oc,Pc,Lc=(Jc.prototype.getToken=function(){return Promise.resolve(null)},Jc.prototype.sa=function(){},Jc.prototype.ia=function(t){(this.na=t)(Ac.UNAUTHENTICATED)},Jc.prototype.ra=function(){this.na=null},Jc),Rc=($c.prototype.getToken=function(){var e=this,n=this.aa,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.aa!==n?(kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Rr("string"==typeof t.accessToken),new kc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},$c.prototype.sa=function(){this.forceRefresh=!0},$c.prototype.ia=function(t){this.na=t,this.ha&&t(this.currentUser)},$c.prototype.ra=function(){this.auth&&this.auth.removeAuthTokenListener(this.oa),this.oa=null,this.na=null},$c.prototype.ua=function(){var t=this.auth&&this.auth.getUid();return Rr(null===t||"string"==typeof t),new Ac(t)},$c),Cc=(Object.defineProperty(Yc.prototype,"ea",{get:function(){var t={"X-Goog-AuthUser":this.la},e=this.ca.auth._a([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Yc),Uc=(Qc.prototype.getToken=function(){return Promise.resolve(new Cc(this.ca,this.la))},Qc.prototype.ia=function(t){t(Ac.ta)},Qc.prototype.ra=function(){},Qc.prototype.sa=function(){},Qc),Vc=(Wc.prototype.Ia=function(){return 1===this.state||2===this.state||4===this.state},Wc.prototype.ma=function(){return 2===this.state},Wc.prototype.start=function(){3!==this.state?this.auth():this.Aa()},Wc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ia()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wc.prototype.Ra=function(){this.state=0,this.wi.reset()},Wc.prototype.Pa=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Es.vs(this.fa,6e4,function(){return t.Va()}))},Wc.prototype.ga=function(t){this.ya(),this.stream.send(t)},Wc.prototype.Va=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Wc.prototype.ya=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Wc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ya(),this.wi.cancel(),this.Ta++,3!==e?this.wi.reset():n&&n.code===Yr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.wi.ys()):n&&n.code===Yr.UNAUTHENTICATED&&this.wa.sa(),null!==this.stream&&(this.pa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ba(n)];case 1:return t.sent(),[2]}})})},Wc.prototype.pa=function(){},Wc.prototype.auth=function(){var n=this;this.state=1;var t=this.va(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Sa(t)},function(e){t(function(){var t=new $r(Yr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},Wc.prototype.Sa=function(t){var e=this,n=this.va(this.Ta);this.stream=this.Ca(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.ba(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Wc.prototype.Aa=function(){var t=this;this.state=4,this.wi.ps(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Wc.prototype.Da=function(t){return kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Wc.prototype.va=function(e){var n=this;return function(t){n.Es.hi(function(){return n.Ta===e?t():(kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Wc),Mc=(n(Hc,Pc=Vc),Hc.prototype.Ca=function(t){return this.da.Fa("Listen",t)},Hc.prototype.onMessage=function(t){this.wi.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Lr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Rr(void 0===i||"string"==typeof i),Ei.fromBase64String(i||"")):(Rr(void 0===i||i instanceof Uint8Array),Ei.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Qi(s,u,a,h&&(r=void 0===(n=h).code?Yr.UNKNOWN:ki(n.code),new $r(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Bo(t,f.document.name),p=Fo(f.document.updateTime),d=new Ws({mapValue:{fields:f.document.fields}}),y=new iu(l,p,d,{}),c=new Hi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Bo(t,v.document),m=v.readTime?Fo(v.readTime):Zr.min(),w=new ou(g,m);c=new Hi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Bo(t,b.document);c=new Hi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Lr();e.filter;var I=e.filter;I.targetId;var T=new Ti(I.count||0);c=new Wi(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Zr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Zr.min():Fo(e.readTime)}(t);return this.listener.ka(e,n)},Hc.prototype.$a=function(t){var e,n,r,i,o={};o.database=Xo(this.serializer),o.addTarget=(e=this.serializer,(r=bi(i=(n=t).target)?{documents:$o(e,i)}:{query:Jo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ga(o)},Hc.prototype.xa=function(t){var e={};e.database=Xo(this.serializer),e.removeTarget=t,this.ga(e)},Hc),Fc=(n(Xc,Oc=Vc),Object.defineProperty(Xc.prototype,"Oa",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),Xc.prototype.start=function(){this.Ma=!1,this.lastStreamToken=void 0,Oc.prototype.start.call(this)},Xc.prototype.pa=function(){this.Ma&&this.La([])},Xc.prototype.Ca=function(t){return this.da.Fa("Write",t)},Xc.prototype.onMessage=function(t){if(Rr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ma){this.wi.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Rr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Fo(t.updateTime):Fo(e);n.isEqual(Zr.min())&&(n=Fo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=Fo(t.commitTime);return this.listener.qa(n,e)}var r,i;return Rr(!t.writeResults||0===t.writeResults.length),this.Ma=!0,this.listener.Ba()},Xc.prototype.Ua=function(){var t={};t.database=Xo(this.serializer),this.ga(t)},Xc.prototype.La=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qo(e.serializer,t)})};this.ga(n)},Xc),jc=(n(Kc,xc=function(){}),Kc.prototype.Wa=function(){if(this.Qa)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},Kc.prototype.ja=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.ja(e,n,r,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&i.credentials.sa(),t})},Kc.prototype.Ka=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.Ka(e,n,r,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&i.credentials.sa(),t})},Kc.prototype.terminate=function(){this.Qa=!1},Kc),qc=(zc.prototype.Ja=function(){var t=this;0===this.za&&(this.Xa("Unknown"),this.Ha=this.ti.vs("online_state_timeout",1e4,function(){return t.Ha=null,t.Za("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},zc.prototype.tu=function(t){"Online"===this.state?this.Xa("Unknown"):(this.za++,1<=this.za&&(this.eu(),this.Za("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},zc.prototype.set=function(t){this.eu(),this.za=0,"Online"===t&&(this.Ya=!1),this.Xa(t)},zc.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},zc.prototype.Za=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ya?(xr(e),this.Ya=!1):kr("OnlineStateTracker",e)},zc.prototype.eu=function(){null!==this.Ha&&(this.Ha.cancel(),this.Ha=null)},zc),Gc=(Bc.prototype.start=function(){return this.enableNetwork()},Bc.prototype.enableNetwork=function(){return this.hu.delete(0),this.Ru()},Bc.prototype.Ru=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(this.Pu()?this.Vu():this._u.set("Unknown"),[4,this.gu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(0),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),[2]}})})},Bc.prototype.yu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.Eu.stop()];case 1:return t.sent(),[4,this.fu.stop()];case 2:return t.sent(),0<this.iu.length&&(kr("RemoteStore","Stopping write stream with "+this.iu.length+" pending writes"),this.iu=[]),this.pu(),[2]}})})},Bc.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return kr("RemoteStore","RemoteStore shutting down."),this.hu.add(5),[4,this.yu()];case 1:return t.sent(),this.au.th(),this._u.set("Unknown"),[2]}})})},Bc.prototype.listen=function(t){this.ru.has(t.targetId)||(this.ru.set(t.targetId,t),this.Pu()?this.Vu():this.fu.ma()&&this.bu(t))},Bc.prototype.vu=function(t){this.ru.delete(t),this.fu.ma()&&this.Su(t),0===this.ru.size&&(this.fu.ma()?this.fu.Pa():this.cu()&&this._u.set("Unknown"))},Bc.prototype.Me=function(t){return this.ru.get(t)||null},Bc.prototype.xe=function(t){return this.Du.xe(t)},Bc.prototype.bu=function(t){this.ou.de(t.targetId),this.fu.$a(t)},Bc.prototype.Su=function(t){this.ou.de(t),this.fu.xa(t)},Bc.prototype.Vu=function(){this.ou=new no(this),this.fu.start(),this._u.Ja()},Bc.prototype.Pu=function(){return this.cu()&&!this.fu.Ia()&&0<this.ru.size},Bc.prototype.cu=function(){return 0===this.hu.size},Bc.prototype.pu=function(){this.ou=null},Bc.prototype.du=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.ru.forEach(function(t,e){n.bu(t)}),[2]})})},Bc.prototype.wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.pu(),this.Pu()?(this._u.tu(e),this.Vu()):this._u.set("Unknown"),[2]})})},Bc.prototype.Tu=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this._u.set("Online"),!(i instanceof Qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),kr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Nu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Hi?this.ou.Pe(i):i instanceof Wi?this.ou.De(i):this.ou.ye(i),o.isEqual(Zr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.nu.ro()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return kr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Nu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Bc.prototype.Nu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!ka(n))throw n;return this.hu.add(1),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),r=r||function(){return e.nu.ro()},this.ti.Vi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return kr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.hu.delete(1),[4,this.Ru()];case 2:return t.sent(),[2]}})})}),[2]}})})},Bc.prototype.ku=function(e){var n=this;return e().catch(function(t){return n.Nu(t,e)})},Bc.prototype.Fu=function(r){var i=this,t=this.ou.Fe(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.ru.get(e))&&i.ru.set(e,n.tt(t.resumeToken,r))}),t.Wt.forEach(function(t){var e,n=i.ru.get(t);n&&(i.ru.set(t,n.tt(Ei.Y,n.X)),i.Su(t),e=new _i(n.target,t,1,n.sequenceNumber),i.bu(e))}),this.Du.Ch(t)},Bc.prototype.Cu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.ru.has(i)?[4,this.Du.$u(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.ru.delete(i),this.ou.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Bc.prototype.gu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.iu.length?this.iu[this.iu.length-1].batchId:-1,t.label=1;case 1:if(!this.xu())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.nu.$h(e)];case 3:return null===(n=t.sent())?(0===this.iu.length&&this.Eu.Pa(),[3,7]):(e=n.batchId,this.Mu(n),[3,6]);case 4:return r=t.sent(),[4,this.Nu(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ou()&&this.Lu(),[2]}})})},Bc.prototype.xu=function(){return this.cu()&&this.iu.length<10},Bc.prototype.qu=function(){return this.iu.length},Bc.prototype.Mu=function(t){this.iu.push(t),this.Eu.ma()&&this.Eu.Oa&&this.Eu.La(t.mutations)},Bc.prototype.Ou=function(){return this.cu()&&!this.Eu.Ia()&&0<this.iu.length},Bc.prototype.Lu=function(){this.Eu.start()},Bc.prototype.Iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Eu.Ua(),[2]})})},Bc.prototype.Au=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.iu;e<n.length;e++)r=n[e],this.Eu.La(r.mutations);return[2]})})},Bc.prototype.qa=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.iu.shift(),n=ra.from(e,i,o),[4,this.ku(function(){return r.Du.Bu(n)})];case 1:return t.sent(),[4,this.gu()];case 2:return t.sent(),[2]}})})},Bc.prototype.mu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.Eu.Oa?[4,this.Uu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ou()&&this.Lu(),[2]}})})},Bc.prototype.Uu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Yr.ABORTED?(e=this.iu.shift(),this.Eu.Ra(),[4,this.ku(function(){return r.Du.Qu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.gu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Bc.prototype.lu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(4),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),this.Eu.Ra(),this.fu.Ra(),this.hu.delete(4),[4,this.Ru()];case 2:return t.sent(),[2]}})})},Bc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ti.pi(),kr("RemoteStore","RemoteStore received new credentials"),this.hu.add(3),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),[4,this.Du.Wu(e)];case 2:return t.sent(),this.hu.delete(3),[4,this.Ru()];case 3:return t.sent(),[2]}})})},Bc.prototype.ju=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.hu.delete(2),[4,this.Ru()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.hu.add(2),[4,this.yu()]);case 3:t.sent(),this._u.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Bc);function Bc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.nu=t,this.su=e,this.ti=n,this.iu=[],this.ru=new Map,this.ou=null,this.hu=new Set,this.au=i,this.au.uu(function(t){n.hi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(kr("RemoteStore","Restarting streams for network reachability change."),[4,this.lu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this._u=new qc(n,r),this.fu=(h=this.su,c=n,f={Na:this.du.bind(this),ba:this.wu.bind(this),ka:this.Tu.bind(this)},(l=h).Wa(),new Mc(c,l.da,l.credentials,l.serializer,f)),this.Eu=(o=this.su,s=n,u={Na:this.Iu.bind(this),ba:this.mu.bind(this),Ba:this.Au.bind(this),qa:this.qa.bind(this)},(a=o).Wa(),new Fc(s,a.da,a.credentials,a.serializer,u))}function zc(t,e){this.ti=t,this.Ga=e,this.state="Unknown",this.za=0,this.Ha=null,this.Ya=!0}function Kc(t,e,n){var r=this;return(r=xc.call(this)||this).credentials=t,r.da=e,r.serializer=n,r.Qa=!1,r}function Xc(t,e,n,r,i){var o=this;return(o=Oc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ma=!1,o}function Hc(t,e,n,r,i){var o=this;return(o=Pc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Wc(t,e,n,r,i,o){this.Es=t,this.fa=n,this.da=r,this.wa=i,this.listener=o,this.state=0,this.Ta=0,this.Ea=null,this.stream=null,this.wi=new Ea(t,e)}function Qc(t,e){this.ca=t,this.la=e}function Yc(t,e){this.ca=t,this.la=e,this.type="FirstParty",this.user=Ac.ta}function $c(t){var e=this;this.oa=null,this.currentUser=Ac.UNAUTHENTICATED,this.ha=!1,this.aa=0,this.na=null,this.forceRefresh=!1,this.oa=function(){e.aa++,e.currentUser=e.ua(),e.ha=!0,e.na&&e.na(e.currentUser)},this.aa=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oa):(this.oa(null),t.get().then(function(t){e.auth=t,e.oa&&e.auth.addAuthTokenListener(e.oa)},function(){}))}function Jc(){this.na=null}function Zc(t,e){return"firestore_clients_"+t+"_"+e}function tf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function ef(t,e){return"firestore_targets_"+t+"_"+e}function nf(t){this.key=t}function rf(t){this.key=t}function of(t,e,n){this.query=t,this.targetId=e,this.view=n}function sf(t){this.key=t,this.el=!1}var uf=(Nf.Ku=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new $r(r.error.code,r.error.message)),i?new Nf(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Nf.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Nf),af=(Tf.Ku=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new $r(n.error.code,n.error.message)),r?new Tf(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Tf.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Tf),hf=(If.Ku=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Xi,o=0;r&&o<n.activeTargetIds.length;++o)r=yi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new If(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},If),cf=(Ef.Ku=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Ef(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},Ef),ff=(bf.prototype.zu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},bf.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},bf.prototype.Gu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},bf),lf=(wf.Fs=function(t){return!(!t||!t.localStorage)},wf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.Du.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Yu&&(o=this.getItem(Zc(this.persistenceKey,i)))&&(s=hf.Ku(i,o))&&(this.Zu=this.Zu.nt(s.clientId,s));for(this.hc(),(u=this.storage.getItem(this.oc))&&(a=this.ac(u))&&this.uc(a),h=0,c=this.tc;h<c.length;h++)f=c[h],this.Xu(f);return this.tc=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},wf.prototype.ws=function(t){this.setItem(this.nc,JSON.stringify(t))},wf.prototype.cc=function(){return this.lc(this.Zu)},wf.prototype._c=function(n){var r=!1;return this.Zu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},wf.prototype.fc=function(t){this.dc(t,"pending")},wf.prototype.wc=function(t,e,n){this.dc(t,e,n),this.Tc(t)},wf.prototype.Ec=function(t){var e,n,r="not-current";return this._c(t)&&(!(e=this.storage.getItem(ef(this.persistenceKey,t)))||(n=af.Ku(t,e))&&(r=n.state)),this.Ic.zu(t),this.hc(),r},wf.prototype.mc=function(t){this.Ic.Hu(t),this.hc()},wf.prototype.Ac=function(t){return this.Ic.activeTargetIds.has(t)},wf.prototype.Rc=function(t){this.removeItem(ef(this.persistenceKey,t))},wf.prototype.Pc=function(t,e,n){this.Vc(t,e,n)},wf.prototype.Vh=function(t,e,n){var r=this;e.forEach(function(t){r.Tc(t)}),this.currentUser=t,n.forEach(function(t){r.fc(t)})},wf.prototype.gc=function(t){this.yc(t)},wf.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.Ju),this.removeItem(this.ec),this.tr=!1)},wf.prototype.getItem=function(t){var e=this.storage.getItem(t);return kr("SharedClientState","READ",t,e),e},wf.prototype.setItem=function(t,e){kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},wf.prototype.removeItem=function(t){kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},wf.prototype.Xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(kr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.ec)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Es.Vi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.sc.test(u.key)){if(null==u.newValue)return e=this.pc(u.key),[2,this.bc(e,null)];if(n=this.vc(u.key,u.newValue))return[2,this.bc(n.clientId,n)]}else if(this.ic.test(u.key)){if(null!==u.newValue&&(r=this.Sc(u.key,u.newValue)))return[2,this.Dc(r)]}else if(this.rc.test(u.key)){if(null!==u.newValue&&(i=this.Cc(u.key,u.newValue)))return[2,this.Nc(i)]}else if(u.key===this.oc){if(null!==u.newValue&&(o=this.ac(u.newValue)))return[2,this.uc(o)]}else u.key===this.nc&&(s=function(t){var e=ca.Ts;if(null!=t)try{var n=JSON.parse(t);Rr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==ca.Ts&&this._s(s)}else this.tc.push(u);return[2]})})})}},Object.defineProperty(wf.prototype,"Ic",{get:function(){return this.Zu.get(this.Yu)},enumerable:!1,configurable:!0}),wf.prototype.hc=function(){this.setItem(this.ec,this.Ic.Gu())},wf.prototype.dc=function(t,e,n){var r=new uf(this.currentUser,t,e,n),i=tf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Gu())},wf.prototype.Tc=function(t){var e=tf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},wf.prototype.yc=function(t){var e={clientId:this.Yu,onlineState:t};this.storage.setItem(this.oc,JSON.stringify(e))},wf.prototype.Vc=function(t,e,n){var r=ef(this.persistenceKey,t),i=new af(t,e,n);this.setItem(r,i.Gu())},wf.prototype.pc=function(t){var e=this.sc.exec(t);return e?e[1]:null},wf.prototype.vc=function(t,e){var n=this.pc(t);return hf.Ku(n,e)},wf.prototype.Sc=function(t,e){var n=this.ic.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return uf.Ku(new Ac(i),r,e)},wf.prototype.Cc=function(t,e){var n=this.rc.exec(t),r=Number(n[1]);return af.Ku(r,e)},wf.prototype.ac=function(t){return cf.Ku(t)},wf.prototype.Dc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Du.Fc(e.batchId,e.state,e.error)]:(kr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},wf.prototype.Nc=function(t){return this.Du.kc(t.targetId,t.state,t.error)},wf.prototype.bc=function(t,e){var n=this,r=e?this.Zu.nt(t,e):this.Zu.remove(t),i=this.lc(this.Zu),o=this.lc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Du.$c(s,u).then(function(){n.Zu=r})},wf.prototype.uc=function(t){this.Zu.get(t.clientId)&&this.Ga(t.onlineState)},wf.prototype.lc=function(t){var n=Xi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},wf),pf=(mf.prototype.fc=function(t){},mf.prototype.wc=function(t,e,n){},mf.prototype.Ec=function(t){return this.xc.zu(t),this.Mc[t]||"not-current"},mf.prototype.Pc=function(t,e,n){this.Mc[t]=e},mf.prototype.mc=function(t){this.xc.Hu(t)},mf.prototype.Ac=function(t){return this.xc.activeTargetIds.has(t)},mf.prototype.Rc=function(t){delete this.Mc[t]},mf.prototype.cc=function(){return this.xc.activeTargetIds},mf.prototype._c=function(t){return this.xc.activeTargetIds.has(t)},mf.prototype.start=function(){return this.xc=new ff,Promise.resolve()},mf.prototype.Vh=function(t,e,n){},mf.prototype.gc=function(t){},mf.prototype.th=function(){},mf.prototype.ws=function(t){},mf),df=(Object.defineProperty(gf.prototype,"Qc",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),gf.prototype.Wc=function(t,e){var u=this,a=e?e.jc:new $i,h=e?e.Uc:this.Uc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof iu?e:null)&&(Nu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Kc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Bc(r,p)||d&&u.Bc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{Uc:f,jc:a,Gc:l,Lt:c}},gf.prototype.Kc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},gf.prototype.Bn=function(t,e,n){var o=this,r=this.Uc;this.Uc=t.Uc,this.Lt=t.Lt;var i=t.jc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Bc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.zc(n);var s=e?this.Hc():[],u=0===this.qc.size&&this.Ht?1:0,a=u!==this.Lc;return this.Lc=u,0!==i.length||a?{snapshot:new Ji(this.query,t.Uc,r,i,t.Lt,0==u,a,!1),Yc:s}:{Yc:s}},gf.prototype.Jc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Bn({Uc:this.Uc,jc:new $i,Lt:this.Lt,Gc:!1},!1)):{Yc:[]}},gf.prototype.Xc=function(t){return!this.Oc.has(t)&&!!this.Uc.has(t)&&!this.Uc.get(t).Ke},gf.prototype.zc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Oc=e.Oc.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Oc=e.Oc.delete(t)}),this.Ht=t.Ht)},gf.prototype.Hc=function(){var e=this;if(!this.Ht)return[];var n=this.qc;this.qc=Ki(),this.Uc.forEach(function(t){e.Xc(t.key)&&(e.qc=e.qc.add(t.key))});var r=[];return n.forEach(function(t){e.qc.has(t)||r.push(new rf(t))}),this.qc.forEach(function(t){n.has(t)||r.push(new nf(t))}),r},gf.prototype.Zc=function(t){this.Oc=t.qh,this.qc=Ki();var e=this.Wc(t.documents);return this.Bn(e,!0)},gf.prototype.tl=function(){return Ji.Ut(this.query,this.Uc,this.Lt,0===this.Lc)},gf),yf=(Object.defineProperty(vf.prototype,"Tl",{get:function(){return!0===this.wl},enumerable:!1,configurable:!0}),vf.prototype.subscribe=function(t){this.rl=t},vf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.El("listen()"),(r=this.ol.get(s))?(e=r.targetId,this.sl.Ec(e),n=r.view.tl(),[3,4]):[3,1];case 1:return[4,this.nu.Mh(gu(s))];case 2:return i=t.sent(),o=this.sl.Ec(i.targetId),e=i.targetId,[4,this.Il(s,e,"current"===o)];case 3:n=t.sent(),this.Tl&&this.nl.listen(i),t.label=4;case 4:return[2,n]}})})},vf.prototype.Il=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.nu.Lh(u,!0)];case 1:return e=t.sent(),n=new df(u,e.qh),r=n.Wc(e.documents),i=to.zt(a,h&&"Offline"!==this.onlineState),o=n.Bn(r,this.Tl,i),this.ml(a,o.Yc),s=new of(u,a,n),[2,(this.ol.set(u,s),this.hl.has(a)?this.hl.get(a).push(u):this.hl.set(a,[u]),o.snapshot)]}})})},vf.prototype.vu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.El("unlisten()"),e=this.ol.get(i),1<(n=this.hl.get(e.targetId)).length?[2,(this.hl.set(e.targetId,n.filter(function(t){return!Eu(t,i)})),void this.ol.delete(i))]:this.Tl?(this.sl.mc(e.targetId),this.sl._c(e.targetId)?[3,2]:[4,this.nu.Oh(e.targetId,!1).then(function(){r.sl.Rc(e.targetId),r.nl.vu(e.targetId),r.Al(e.targetId)}).catch(Ic)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Al(e.targetId),[4,this.nu.Oh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},vf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.El("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.nu.bh(i)];case 2:return e=t.sent(),this.sl.fc(e.batchId),this.Rl(e.batchId,o),[4,this.Pl(e.Nn)];case 3:return t.sent(),[4,this.nl.gu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Ba(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},vf.prototype.Ch=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.El("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Ch(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.cl.get(e);n&&(Rr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.el=!0:0<t.Jt.size?Rr(n.el):0<t.Xt.size&&(Rr(n.el),n.el=!1))}),[4,this.Pl(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ic(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vf.prototype.Jc=function(r,t){var i;(this.Tl&&0===t||!this.Tl&&1===t)&&(this.El("applyOnlineStateChange()"),i=[],this.ol.forEach(function(t,e){var n=e.view.Jc(r);n.snapshot&&i.push(n.snapshot)}),this.rl.Vl(r),this.rl.ka(i),this.onlineState=r,this.Tl&&this.sl.gc(r))},vf.prototype.$u=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.El("rejectListens()"),this.sl.Pc(u,"rejected",a),e=this.cl.get(u),(n=e&&e.key)?(r=(r=new xi(ii.P)).nt(n,new ou(n,Zr.min())),i=Ki().add(n),o=new Zi(Zr.min(),new Map,new Vi(Vr),r,i),[4,this.Ch(o)]):[3,2];case 1:return t.sent(),this.ul=this.ul.remove(n),this.cl.delete(u),this.gl(),[3,4];case 2:return[4,this.nu.Oh(u,!1).then(function(){return s.Al(u,a)}).catch(Ic)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},vf.prototype.Bu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.El("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.vh(r)];case 2:return n=t.sent(),this.yl(e,null),this.pl(e),this.sl.wc(e,"acknowledged"),[4,this.Pl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ic(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vf.prototype.Qu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.El("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Dh(n)];case 2:return e=t.sent(),this.yl(n,r),this.pl(n),this.sl.wc(n,"rejected",r),[4,this.Pl(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ic(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vf.prototype.bl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.nl.cu()||kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.nu.gr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.fl.get(e)||[]).push(o),this.fl.set(e,n),[3,4]);case 3:return r=t.sent(),i=Ba(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},vf.prototype.pl=function(t){(this.fl.get(t)||[]).forEach(function(t){t.resolve()}),this.fl.delete(t)},vf.prototype.vl=function(e){this.fl.forEach(function(t){t.forEach(function(t){t.reject(new $r(Yr.CANCELLED,e))})}),this.fl.clear()},vf.prototype.Rl=function(t,e){var n=(n=(n=this._l[this.currentUser.Xh()])||new xi(Vr)).nt(t,e);this._l[this.currentUser.Xh()]=n},vf.prototype.yl=function(t,e){var n,r=this._l[this.currentUser.Xh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this._l[this.currentUser.Xh()]=r)},vf.prototype.Al=function(t,e){var n=this;void 0===e&&(e=null),this.sl.mc(t);for(var r=0,i=this.hl.get(t);r<i.length;r++){var o=i[r];this.ol.delete(o),e&&this.rl.Sl(o,e)}this.hl.delete(t),this.Tl&&this.ll.zh(t).forEach(function(t){n.ll.Nr(t)||n.Dl(t)})},vf.prototype.Dl=function(t){var e=this.ul.get(t);null!==e&&(this.nl.vu(e),this.ul=this.ul.remove(t),this.cl.delete(e),this.gl())},vf.prototype.ml=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof nf?(this.ll.Eo(i.key,t),this.Cl(i)):i instanceof rf?(kr("SyncEngine","Document no longer in limbo: "+i.key),this.ll.mo(i.key,t),this.ll.Nr(i.key)||this.Dl(i.key)):Lr()}},vf.prototype.Cl=function(t){var e=t.key;this.ul.get(e)||(kr("SyncEngine","New document in limbo: "+e),this.al.push(e),this.gl())},vf.prototype.gl=function(){for(;0<this.al.length&&this.ul.size<this.il;){var t=this.al.shift(),e=this.dl.next();this.cl.set(e,new sf(t)),this.ul=this.ul.nt(t,e),this.nl.listen(new _i(gu(du(t.path)),e,2,ca.Ts))}},vf.prototype.Nl=function(){return this.ul},vf.prototype.Fl=function(){return this.al},vf.prototype.Pl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ol.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Wc(r);return n.Gc?u.nu.Lh(i.query,!1).then(function(t){var e=t.documents;return i.view.Wc(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.Bn(t,u.Tl,n);u.ml(i.targetId,r.Yc),r.snapshot&&(u.Tl&&u.sl.Pc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ha.ls(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.rl.ka(o),[4,this.nu.kh(s)];case 2:return t.sent(),[2]}})})},vf.prototype.El=function(t){},vf.prototype.Wu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(kr("SyncEngine","User change. New user:",n.Xh()),[4,this.nu.Vh(n)]);case 1:return e=t.sent(),this.currentUser=n,this.vl("'waitForPendingWrites' promise is rejected due to a user change."),this.sl.Vh(n,e.yh,e.ph),[4,this.Pl(e.gh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},vf.prototype.xe=function(t){var e=this.cl.get(t);if(e&&e.el)return Ki().add(e.key);var n=Ki(),r=this.hl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.ol.get(s),n=n.Ct(u.view.Qc);return n},vf);function vf(t,e,n,r,i,o){this.nu=t,this.nl=e,this.su=n,this.sl=r,this.currentUser=i,this.il=o,this.rl=null,this.ol=new Qr(Iu,Eu),this.hl=new Map,this.al=[],this.ul=new xi(ii.P),this.cl=new Map,this.ll=new Tc,this._l={},this.fl=new Map,this.dl=tc.eo(),this.onlineState="Unknown",this.wl=void 0}function gf(t,e){this.query=t,this.Oc=e,this.Lc=null,this.Ht=!1,this.qc=Ki(),this.Lt=Ki(),this.Bc=Au(t),this.Uc=new Yi(this.Bc)}function mf(){this.xc=new ff,this.Mc={},this.Ga=null,this._s=null}function wf(t,e,n,r,i){this.window=t,this.Es=e,this.persistenceKey=n,this.Yu=r,this.Du=null,this.Ga=null,this._s=null,this.Ju=this.Xu.bind(this),this.Zu=new xi(Vr),this.tr=!1,this.tc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ec=Zc(this.persistenceKey,this.Yu),this.nc="firestore_sequence_number_"+this.persistenceKey,this.Zu=this.Zu.nt(this.Yu,new ff),this.sc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.ic=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.rc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.oc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Ju)}function bf(){this.activeTargetIds=Xi}function Ef(t,e){this.clientId=t,this.onlineState=e}function If(t,e){this.clientId=t,this.activeTargetIds=e}function Tf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Nf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Af(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.hl.get(s))&&0!==a.length?[4,e.nu.Mh(gu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.ol.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).nu.Lh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Zc(n),[2,(e.Tl&&e.ml(o.targetId,r.Yc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Ec(e.nu,s)];case 8:return d=t.sent(),[4,e.nu.Mh(d)];case 9:return u=t.sent(),[4,e.Il(_f(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.rl.ka(r),n)]}})})}function _f(t){return pu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Df(){this.kl=void 0,this.listeners=[]}var Sf,kf=(Mf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.$l.get(e))||(n=!0,r=new Df),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Du.listen(e)];case 2:return i.kl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ba(o,"Initialization of query '"+Tu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.$l.set(e,r),r.listeners.push(u),u.Jc(this.onlineState),r.kl&&u.Ml(r.kl)&&this.Ol(),[2]}})})},Mf.prototype.vu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.$l.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.$l.delete(e),this.Du.vu(e))]:[2]})})},Mf.prototype.ka=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.$l.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ml(i)&&(e=!0);s.kl=i}}e&&this.Ol()},Mf.prototype.Sl=function(t,e){var n=this.$l.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.$l.delete(t)},Mf.prototype.Vl=function(i){this.onlineState=i;var o=!1;this.$l.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Jc(i)&&(o=!0)}),o&&this.Ol()},Mf.prototype.Ll=function(t){this.xl.add(t),t.next()},Mf.prototype.ql=function(t){this.xl.delete(t)},Mf.prototype.Ol=function(){this.xl.forEach(function(t){t.next()})},Mf),xf=(Vf.prototype.Ml=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ji(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.Ul?this.Wl(t)&&(this.Bl.next(t),o=!0):this.jl(t,this.onlineState)&&(this.Kl(t),o=!0),this.Ql=t,o},Vf.prototype.onError=function(t){this.Bl.error(t)},Vf.prototype.Jc=function(t){this.onlineState=t;var e=!1;return this.Ql&&!this.Ul&&this.jl(this.Ql,t)&&(this.Kl(this.Ql),e=!0),e},Vf.prototype.jl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Gl&&n||t.docs._()&&"Offline"!==e)},Vf.prototype.Wl=function(t){if(0<t.docChanges.length)return!0;var e=this.Ql&&this.Ql.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Vf.prototype.Kl=function(t){t=Ji.Ut(t.query,t.docs,t.Lt,t.fromCache),this.Ul=!0,this.Bl.next(t)},Vf),Of=(Uf.prototype.Ph=function(t){this.zl=t},Uf.prototype.es=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Zr.min())?this.Hl(e,r):this.zl.Xn(e,o).next(function(t){var n=s.Yl(r,t);return(r.hn()||r.an())&&s.Gc(r.en,n,o,i)?s.Hl(e,r):(Sr()<=l.DEBUG&&kr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tu(r)),s.zl.es(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Uf.prototype.Yl=function(n,t){var r=new Vi(Au(n));return t.forEach(function(t,e){e instanceof iu&&Nu(n,e)&&(r=r.add(e))}),r},Uf.prototype.Gc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Uf.prototype.Hl=function(t,e){return Sr()<=l.DEBUG&&kr("IndexFreeQueryEngine","Using full collection scan to execute query:",Tu(e)),this.zl.es(t,e,Zr.min())},Uf),Pf=(Cf.prototype.Ir=function(t){return ia.resolve(0===this.Kn.length)},Cf.prototype.mr=function(t,e,n,r){var i=this.Jl;this.Jl++,0<this.Kn.length&&this.Kn[this.Kn.length-1];var o=new na(i,e,n,r);this.Kn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xl=this.Xl.add(new Nc(a.key,i)),this.Gn.Ar(t,a.key.path.p())}return ia.resolve(o)},Cf.prototype.Rr=function(t,e){return ia.resolve(this.Zl(e))},Cf.prototype.Vr=function(t,e){var n=e+1,r=this.t_(n),i=r<0?0:r;return ia.resolve(this.Kn.length>i?this.Kn[i]:null)},Cf.prototype.gr=function(){return ia.resolve(0===this.Kn.length?-1:this.Jl-1)},Cf.prototype.yr=function(t){return ia.resolve(this.Kn.slice())},Cf.prototype.Hn=function(t,e){var n=this,r=new Nc(e,0),i=new Nc(e,Number.POSITIVE_INFINITY),o=[];return this.Xl.vt([r,i],function(t){var e=n.Zl(t.Jh);o.push(e)}),ia.resolve(o)},Cf.prototype.ts=function(t,e){var r=this,i=new Vi(Vr);return e.forEach(function(t){var e=new Nc(t,0),n=new Nc(t,Number.POSITIVE_INFINITY);r.Xl.vt([e,n],function(t){i=i.add(t.Jh)})}),ia.resolve(this.e_(i))},Cf.prototype.hs=function(t,e){var n=e.path,r=n.length+1,i=n;ii.W(i)||(i=i.child(""));var o=new Nc(new ii(i),0),s=new Vi(Vr);return this.Xl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.Jh)),!0)},o),ia.resolve(this.e_(s))},Cf.prototype.e_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Zl(t);null!==e&&r.push(e)}),r},Cf.prototype.br=function(n,r){var i=this;Rr(0===this.n_(r.batchId,"removed")),this.Kn.shift();var o=this.Xl;return ia.forEach(r.mutations,function(t){var e=new Nc(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.Xl=o})},Cf.prototype.Sr=function(t){},Cf.prototype.Nr=function(t,e){var n=new Nc(e,0),r=this.Xl.Dt(n);return ia.resolve(e.isEqual(r&&r.key))},Cf.prototype.Cr=function(t){return this.Kn.length,ia.resolve()},Cf.prototype.n_=function(t,e){return this.t_(t)},Cf.prototype.t_=function(t){return 0===this.Kn.length?0:t-this.Kn[0].batchId},Cf.prototype.Zl=function(t){var e=this.t_(t);return e<0||e>=this.Kn.length?null:this.Kn[e]},Cf),Lf=(Rf.prototype.$n=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.s_(e);return this.docs=this.docs.nt(r,{Mr:e,size:s,readTime:n}),this.size+=s-o,this.Gn.Ar(t,r.path.p())},Rf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Rf.prototype.On=function(t,e){var n=this.docs.get(e);return ia.resolve(n?n.Mr:null)},Rf.prototype.getEntries=function(t,e){var n=this,r=Fi;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Mr:null)}),ia.resolve(r)},Rf.prototype.es=function(t,e,n){for(var r=Gi,i=new ii(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Mr,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof iu&&Nu(e,h)&&(r=r.nt(h.key,h))}return ia.resolve(r)},Rf.prototype.i_=function(t,e){return ia.forEach(this.docs,function(t){return e(t)})},Rf.prototype.jr=function(t){return new Rf.Kr(this)},Rf.prototype.zr=function(t){return ia.resolve(this.size)},Rf);function Rf(t,e){this.Gn=t,this.s_=e,this.docs=new xi(ii.P),this.size=0}function Cf(t,e){this.Gn=t,this.dr=e,this.Kn=[],this.Jl=1,this.Xl=new Vi(Nc.Uh)}function Uf(){}function Vf(t,e,n){this.query=t,this.Bl=e,this.Ul=!1,this.Ql=null,this.onlineState="Unknown",this.options=n||{}}function Mf(t){this.Du=t,this.$l=new Qr(Iu,Eu),this.onlineState="Unknown",this.xl=new Set,this.Du.subscribe(this)}function Ff(t){var e=this;return(e=Sf.call(this)||this).Hr=t,e}Lf.Kr=(n(Ff,Sf=oa),Ff.prototype.Bn=function(n){var r=this,i=[];return this.Nn.forEach(function(t,e){e?i.push(r.Hr.$n(n,e,r.readTime)):r.Hr.Mn(t)}),ia.Dn(i)},Ff.prototype.Ln=function(t,e){return this.Hr.On(t,e)},Ff.prototype.qn=function(t,e){return this.Hr.getEntries(t,e)},Ff);var jf,qf,Gf=(ol.prototype.pe=function(t,n){return this.r_.forEach(function(t,e){return n(e)}),ia.resolve()},ol.prototype.ro=function(t){return ia.resolve(this.lastRemoteSnapshotVersion)},ol.prototype.oo=function(t){return ia.resolve(this.o_)},ol.prototype.no=function(t){return this.highestTargetId=this.a_.next(),ia.resolve(this.highestTargetId)},ol.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.o_&&(this.o_=e),ia.resolve()},ol.prototype.uo=function(t){this.r_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.a_=new tc(e),this.highestTargetId=e),t.sequenceNumber>this.o_&&(this.o_=t.sequenceNumber)},ol.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,ia.resolve()},ol.prototype.lo=function(t,e){return this.uo(e),ia.resolve()},ol.prototype._o=function(t,e){return this.r_.delete(e.target),this.h_.zh(e.targetId),--this.targetCount,ia.resolve()},ol.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.r_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.r_.delete(t),u.push(o.fo(n,e.targetId)),s++)}),ia.Dn(u).next(function(){return s})},ol.prototype.do=function(t){return ia.resolve(this.targetCount)},ol.prototype.wo=function(t,e){var n=this.r_.get(e)||null;return ia.resolve(n)},ol.prototype.To=function(t,e,n){return this.h_.jh(e,n),ia.resolve()},ol.prototype.Io=function(e,t,n){this.h_.Gh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),ia.Dn(i)},ol.prototype.fo=function(t,e){return this.h_.zh(e),ia.resolve()},ol.prototype.Ao=function(t,e){var n=this.h_.Yh(e);return ia.resolve(n)},ol.prototype.Nr=function(t,e){return ia.resolve(this.h_.Nr(e))},ol),Bf=(il.prototype.start=function(){return Promise.resolve()},il.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(il.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),il.prototype.Bo=function(){},il.prototype.Uo=function(){},il.prototype.uh=function(){return this.Gn},il.prototype.oh=function(t){var e=this.u_[t.Xh()];return e||(e=new Pf(this.Gn,this.dr),this.u_[t.Xh()]=e),e},il.prototype.hh=function(){return this.ko},il.prototype.ah=function(){return this.jn},il.prototype.runTransaction=function(t,e,n){var r=this;kr("MemoryPersistence","Starting transaction:",t);var i=new zf(this.yo.next());return this.dr.l_(),n(i).next(function(t){return r.dr.__(i).next(function(){return t})}).vn().then(function(t){return i.Wn(),t})},il.prototype.f_=function(e,n){return ia.Cn(Object.values(this.u_).map(function(t){return function(){return t.Nr(e,n)}}))},il),zf=(n(rl,qf=ua),rl),Kf=(nl.T_=function(t){return new nl(t)},Object.defineProperty(nl.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Lr()},enumerable:!1,configurable:!0}),nl.prototype.Eo=function(t,e,n){return this.d_.Eo(n,e),this.E_.delete(n),ia.resolve()},nl.prototype.mo=function(t,e,n){return this.d_.mo(n,e),this.E_.add(n),ia.resolve()},nl.prototype.Dr=function(t,e){return this.E_.add(e),ia.resolve()},nl.prototype.removeTarget=function(t,e){var n=this;this.d_.zh(e.targetId).forEach(function(t){return n.E_.add(t)});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return r._o(t,e)})},nl.prototype.l_=function(){this.w_=new Set},nl.prototype.__=function(t){var n=this,r=this.persistence.ah().jr();return ia.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||r.Mn(e)})}).next(function(){return n.w_=null,r.apply(t)})},nl.prototype.wh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},nl.prototype.c_=function(t){return 0},nl.prototype.I_=function(t,e){var n=this;return ia.Cn([function(){return ia.resolve(n.d_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.f_(t,e)}])},nl),Xf=(el.prototype.Na=function(t){this.R_=t},el.prototype.ba=function(t){this.P_=t},el.prototype.onMessage=function(t){this.V_=t},el.prototype.close=function(){this.A_()},el.prototype.send=function(t){this.m_(t)},el.prototype.g_=function(){this.R_()},el.prototype.y_=function(t){this.P_(t)},el.prototype.p_=function(t){this.V_(t)},el),Hf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Wf=(tl.prototype.ja=function(e,t,n,r){var i=this.D_(e,t);kr("RestConnection","Sending: ",i,n);var o={};return this.C_(o,r),this.N_(e,i,o,n).then(function(t){return kr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},tl.prototype.Ka=function(t,e,n,r){return this.ja(t,e,n,r)},tl.prototype.C_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.18.0-202071122108",t["Content-Type"]="text/plain",e)for(var n in e.ea)e.ea.hasOwnProperty(n)&&(t[n]=e.ea[n])},tl.prototype.D_=function(t,e){var n=Hf[t];return this.v_+"/v1/"+e+":"+n},n(Zf,jf=tl),Zf.prototype.N_=function(a,e,n,r){return new Promise(function(o,s){var u=new Tr;u.listenOnce(Er.COMPLETE,function(){try{switch(u.getLastErrorCode()){case br.NO_ERROR:var t=u.getResponseJson();kr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:kr("Connection",'RPC "'+a+'" timed out'),s(new $r(Yr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=u.getStatus();kr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Yr).indexOf(i)?i:Yr.UNKNOWN,s(new $r(n,e.message))):s(new $r(Yr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new $r(Yr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{kr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},Zf.prototype.Fa=function(t,e){var n,r,i=[this.v_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.C_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}kr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Xf({m_:function(t){f?kr("Connection","Not sending because WebChannel is closed:",t):(c||(kr("Connection","Opening WebChannel transport."),h.open(),c=!0),kr("Connection","WebChannel sending:",t),h.send(t))},A_:function(){return h.close()}});return a(Ir.EventType.OPEN,function(){f||kr("Connection","WebChannel transport opened.")}),a(Ir.EventType.CLOSE,function(){f||(f=!0,kr("Connection","WebChannel transport closed"),l.y_())}),a(Ir.EventType.ERROR,function(t){f||(f=!0,Or("Connection","WebChannel transport errored:",t),l.y_(new $r(Yr.UNAVAILABLE,"The operation could not be completed")))}),a(Ir.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Rr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(kr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ni[i];if(void 0!==t)return ki(t)}(),s=r.message,void 0===o&&(o=Yr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.y_(new $r(o,s)),h.close()):(kr("Connection","WebChannel received:",n),l.p_(n)))}),setTimeout(function(){l.g_()},0),l},Zf),Qf=(Jf.prototype.uu=function(t){this.O_.push(t)},Jf.prototype.th=function(){window.removeEventListener("online",this.F_),window.removeEventListener("offline",this.x_)},Jf.prototype.L_=function(){window.addEventListener("online",this.F_),window.addEventListener("offline",this.x_)},Jf.prototype.k_=function(){kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(0)},Jf.prototype.M_=function(){kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(1)},Jf.Fs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Jf),Yf=($f.prototype.uu=function(t){},$f.prototype.th=function(){},$f);function $f(){}function Jf(){var t=this;this.F_=function(){return t.k_()},this.x_=function(){return t.M_()},this.O_=[],this.L_()}function Zf(t){var e=this;return(e=jf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function tl(t){this.b_=t,this.s=t.s;var e=t.ssl?"https":"http";this.v_=e+"://"+t.host,this.S_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function el(t){this.m_=t.m_,this.A_=t.A_}function nl(t){this.persistence=t,this.d_=new Tc,this.w_=null}function rl(t){var e=this;return(e=qf.call(this)||this).Ro=t,e}function il(t){var e=this;this.u_={},this.yo=new ca(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new Gf(this),this.Gn=new Sh,this.jn=new Lf(this.Gn,function(t){return e.dr.c_(t)})}function ol(t){this.persistence=t,this.r_=new Qr(mi,wi),this.lastRemoteSnapshotVersion=Zr.min(),this.highestTargetId=0,this.o_=0,this.h_=new Tc,this.targetCount=0,this.a_=tc.to()}function sl(t){return new Lo(t,!0)}var ul,al,hl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",cl=(vl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.sl=this.q_(e),this.persistence=this.B_(e),[4,this.persistence.start()];case 1:return t.sent(),this.U_=this.Q_(e),this.nu=this.W_(e),[2]}})})},vl.prototype.Q_=function(t){return null},vl.prototype.W_=function(t){return e=this.persistence,n=new Of,r=t.j_,new wc(e,n,r);var e,n,r},vl.prototype.B_=function(t){if(t.G_.K_)throw new $r(Yr.FAILED_PRECONDITION,hl);return new Bf(Kf.T_)},vl.prototype.q_=function(t){return new pf},vl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.sl.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},vl.prototype.clearPersistence=function(t,e){throw new $r(Yr.FAILED_PRECONDITION,hl)},vl),fl=(n(yl,al=cl),yl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,al.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.nu)];case 2:return t.sent(),[2]}})})},yl.prototype.Q_=function(t){var e=this.persistence.dr.Yi;return new Ya(e,t.ti)},yl.prototype.B_=function(t){var e=mc(t.b_.s,t.b_.persistenceKey),n=sl(t.b_.s);return new cc(t.G_.synchronizeTabs,e,t.clientId,Ha.Ui(t.G_.cacheSizeBytes),t.ti,Va(),Ma(),n,this.sl,t.G_.Vo)},yl.prototype.q_=function(t){return new pf},yl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ia.Fs()?(e=n+"main",[4,Ia.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(mc(t,e))},n(dl,ul=yl),dl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,ul.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.z_.initialize(this,r)];case 2:return t.sent(),e=this.z_.Du,this.sl instanceof lf?(this.sl.Du={Fc:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).El("applyBatchState()"),[4,(e=o.nu,n=a,i=(r=e).Kn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Xn(e,t):ia.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.nl.gu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.yl(a,c||null),o.nu.Kn.Sr(a)):Lr(),t.label=4;case 4:return[4,o.Pl(s)];case 5:return t.sent(),[3,7];case 6:kr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),kc:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).wl?(kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.hl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.nu,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=Zi.Gt(u,"current"===a),[4,n.Pl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.nu.Oh(u,!0)];case 6:return t.sent(),n.Al(u,h),[3,8];case 7:Lr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),$c:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).wl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.hl.has(i)?(kr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Ec(n.nu,i)]):[3,6];case 2:return o=t.sent(),[4,n.nu.Mh(o)];case 3:return s=t.sent(),[4,n.Il(_f(o),s.targetId,!1)];case 4:t.sent(),n.nl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.hl.has(e)?[4,n.nu.Oh(e,!1).then(function(){n.nl.vu(e),n.Al(e)}).catch(Ic)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.nu.persistence.rh()}.bind(null,e)},[4,this.sl.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.wl?[3,3]:(e=r.sl.cc(),[4,Af(r,e.N())]);case 1:return i=t.sent(),r.wl=!0,[4,r.nl.ju(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.nl.listen(u);return[3,7];case 3:return!1!==f||!1===r.wl?[3,7]:(a=[],h=Promise.resolve(),r.hl.forEach(function(t,e){r.sl.Ac(e)?a.push(e):h=h.then(function(){return r.Al(e),r.nu.Oh(e,!0)}),r.nl.vu(e)}),[4,h]);case 4:return t.sent(),[4,Af(r,a)];case 5:return t.sent(),(n=r).cl.forEach(function(t,e){n.nl.vu(e)}),n.ll.Hh(),n.cl=new Map,n.ul=new xi(ii.P),r.wl=!1,[4,r.nl.ju(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.z_.Du,e)];case 1:return t.sent(),this.U_&&(e&&!this.U_.tr?this.U_.start(this.nu):e||this.U_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},dl.prototype.q_=function(t){if(t.G_.K_&&t.G_.synchronizeTabs){var e=Va();if(!lf.Fs(e))throw new $r(Yr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=mc(t.b_.s,t.b_.persistenceKey);return new lf(e,t.ti,n,t.clientId,t.j_)}return new pf},dl),ll=(pl.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.nu?[3,3]:(this.nu=n.nu,this.sl=n.sl,this.su=this.H_(r),this.nl=this.Y_(r),this.Du=this.J_(r),this.X_=this.Z_(r),this.sl.Ga=function(t){return e.Du.Jc(t,1)},this.nl.Du=this.Du,[4,this.nl.start()]);case 1:return t.sent(),[4,this.nl.ju(this.Du.Tl)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},pl.prototype.Z_=function(t){return new kf(this.Du)},pl.prototype.H_=function(t){var e,n=sl(t.b_.s),r=(e=t.b_,new Wf(e)),i=t.credentials;return new jc(i,r,n)},pl.prototype.Y_=function(t){var e=this;return new Gc(this.nu,this.su,t.ti,function(t){return e.Du.Jc(t,0)},new(Qf.Fs()?Qf:Yf))},pl.prototype.J_=function(t){return e=this.nu,n=this.nl,r=this.su,i=this.sl,o=t.j_,s=t.il,u=!t.G_.K_||!t.G_.synchronizeTabs,a=new yf(e,n,r,i,o,s),u&&(a.wl=!0),a;var e,n,r,i,o,s,u,a},pl.prototype.terminate=function(){return this.nl.th()},pl);function pl(){}function dl(t){var e=this;return(e=ul.call(this)||this).z_=t,e}function yl(){return null!==al&&al.apply(this,arguments)||this}function vl(){}function gl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ml=(wl.prototype.next=function(t){this.observer.next&&this.tf(this.observer.next,t)},wl.prototype.error=function(t){this.observer.error?this.tf(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},wl.prototype.ef=function(){this.muted=!0},wl.prototype.tf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},wl);function wl(t){this.observer=t,this.muted=!1}function bl(t,e){if(0!==e.length)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ml(e.length,"argument")+".")}function El(t,e,n){if(e.length!==n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires "+Ml(n,"argument")+", but was called with "+Ml(e.length,"argument")+".")}function Il(t,e,n){if(e.length<n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ml(n,"argument")+", but was called with "+Ml(e.length,"argument")+".")}function Tl(t,e,n,r){if(e.length<n||e.length>r)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Ml(e.length,"argument")+".")}function Nl(t,e,n,r){xl(t,e,Vl(n)+" argument",r)}function Al(t,e,n,r){void 0!==r&&Nl(t,e,n,r)}function _l(t,e,n,r){xl(t,e,n+" option",r)}function Dl(t,e,n,r){void 0!==r&&_l(t,e,n,r)}function Sl(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Pl(s))}var u=Pl(n);throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function kl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+Pl(r)+" provided to function "+t+"() for its "+Vl(n)+" argument. Acceptable values: "+e.join(", "));return r}function xl(t,e,n,r){if(!("object"===e?Ol(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Pl(r);throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Ol(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Pl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ll(t,e,n){if(void 0===n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Vl(e)+" argument, but it was undefined.")}function Rl(n,t,r){zr(t,function(t,e){if(r.indexOf(t)<0)throw new $r(Yr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Cl(t,e,n,r){var i=Pl(r);return new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Vl(n)+" argument to be a "+e+", but it was: "+i)}function Ul(t,e,n){if(n<=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Vl(e)+" argument to be a positive number, but it was: "+n+".")}function Vl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ml(t,e){return t+" "+e+(1===t?"":"s")}function Fl(){if("undefined"==typeof Uint8Array)throw new $r(Yr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function jl(){if("undefined"==typeof atob)throw new $r(Yr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ql,Gl,Bl=($l.fromBase64String=function(t){El("Blob.fromBase64String",arguments,1),Nl("Blob.fromBase64String","string",1,t),jl();try{return new $l(Ei.fromBase64String(t))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},$l.fromUint8Array=function(t){if(El("Blob.fromUint8Array",arguments,1),Fl(),!(t instanceof Uint8Array))throw Cl("Blob.fromUint8Array","Uint8Array",1,t);return new $l(Ei.fromUint8Array(t))},$l.prototype.toBase64=function(){return El("Blob.toBase64",arguments,0),jl(),this.nf.toBase64()},$l.prototype.toUint8Array=function(){return El("Blob.toUint8Array",arguments,0),Fl(),this.nf.toUint8Array()},$l.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},$l.prototype.isEqual=function(t){return this.nf.isEqual(t.nf)},$l),zl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $r(Yr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Nl("FieldPath","string",e,t[e]),0===t[e].length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.sf=new ri(t)},Kl=(n(Yl,Gl=zl),Yl.documentId=function(){return new Yl(ri.L().F())},Yl.prototype.isEqual=function(t){if(!(t instanceof Yl))throw Cl("isEqual","FieldPath",1,t);return this.sf.isEqual(t.sf)},Yl),Xl=new RegExp("[~\\*/\\[\\]]"),Hl=function(){this.if=this},Wl=(n(Ql,ql=Hl),Ql.prototype.hf=function(t){if(2!==t.af)throw 1===t.af?t.uf(this.rf+"() can only appear at the top level of your update data"):t.uf(this.rf+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Ql.prototype.isEqual=function(t){return t instanceof Ql},Ql);function Ql(t){var e=this;return(e=ql.call(this)||this).rf=t,e}function Yl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Gl.call(this,t)||this}function $l(t){jl(),this.nf=t}function Jl(t,e,n){return new _p({af:3,cf:e.settings.cf,methodName:t.rf,lf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Zl,tp,ep,np,rp,ip,op=(n(Np,ip=Hl),Np.prototype.hf=function(t){return new Ts(t.path,new as)},Np.prototype.isEqual=function(t){return t instanceof Np},Np),sp=(n(Tp,rp=Hl),Tp.prototype.hf=function(t){var e=Jl(this,t,!0),n=this._f.map(function(t){return Rp(t,e)}),r=new hs(n);return new Ts(t.path,r)},Tp.prototype.isEqual=function(t){return this===t},Tp),up=(n(Ip,np=Hl),Ip.prototype.hf=function(t){var e=Jl(this,t,!0),n=this._f.map(function(t){return Rp(t,e)}),r=new ds(n);return new Ts(t.path,r)},Ip.prototype.isEqual=function(t){return this===t},Ip),ap=(n(Ep,ep=Hl),Ep.prototype.hf=function(t){var e=new ms(t.serializer,Uo(t.serializer,this.ff));return new Ts(t.path,e)},Ep.prototype.isEqual=function(t){return this===t},Ep),hp=(n(bp,tp=Hl),bp.delete=function(){return bl("FieldValue.delete",arguments),new cp(new Wl("FieldValue.delete"))},bp.serverTimestamp=function(){return bl("FieldValue.serverTimestamp",arguments),new cp(new op("FieldValue.serverTimestamp"))},bp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Il("FieldValue.arrayUnion",arguments,1),new cp(new sp("FieldValue.arrayUnion",t))},bp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Il("FieldValue.arrayRemove",arguments,1),new cp(new up("FieldValue.arrayRemove",t))},bp.increment=function(t){return Nl("FieldValue.increment","number",1,t),El("FieldValue.increment",arguments,1),new cp(new ap("FieldValue.increment",t))},bp),cp=(n(wp,Zl=hp),wp.prototype.hf=function(t){return this.if.hf(t)},wp.prototype.isEqual=function(t){return t instanceof wp&&this.if.isEqual(t.if)},wp),fp=(Object.defineProperty(mp.prototype,"latitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),Object.defineProperty(mp.prototype,"longitude",{get:function(){return this.wf},enumerable:!1,configurable:!0}),mp.prototype.isEqual=function(t){return this.df===t.df&&this.wf===t.wf},mp.prototype.T=function(t){return Vr(this.df,t.df)||Vr(this.wf,t.wf)},mp),lp=/^__.*__$/,pp=function(t,e,n){this.Tf=t,this.Ef=e,this.If=n},dp=(gp.prototype.mf=function(t,e){var n=[];return null!==this.Le?n.push(new Us(t,this.data,this.Le,e)):n.push(new Cs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},gp),yp=(vp.prototype.mf=function(t,e){var n=[new Us(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},vp);function vp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function gp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function mp(t,e){if(El("GeoPoint",arguments,2),Nl("GeoPoint","number",1,t),Nl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $r(Yr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $r(Yr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.df=t,this.wf=e}function wp(t){var e=this;return(e=Zl.call(this)||this).if=t,e.rf=t.rf,e}function bp(){return tp.call(this)||this}function Ep(t,e){var n=this;return(n=ep.call(this)||this).rf=t,n.ff=e,n}function Ip(t,e){var n=this;return(n=np.call(this)||this).rf=t,n._f=e,n}function Tp(t,e){var n=this;return(n=rp.call(this)||this).rf=t,n._f=e,n}function Np(t){var e=this;return(e=ip.call(this)||this).rf=t,e}function Ap(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var _p=(Object.defineProperty(kp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(kp.prototype,"af",{get:function(){return this.settings.af},enumerable:!1,configurable:!0}),kp.prototype.Rf=function(t){return new kp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},kp.prototype.Pf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Vf(t),r},kp.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Af(),r},kp.prototype.yf=function(t){return this.Rf({path:void 0,lf:!0})},kp.prototype.uf=function(t){return jp(t,this.settings.methodName,this.settings.pf||!1,this.path,this.settings.cf)},kp.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},kp.prototype.Af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Vf(this.path.get(t))},kp.prototype.Vf=function(t){if(0===t.length)throw this.uf("Document fields must not be empty");if(Ap(this.af)&&lp.test(t))throw this.uf('Document fields cannot begin and end with "__"')},kp),Dp=(Sp.prototype.bf=function(t,e,n,r){return void 0===r&&(r=!1),new _p({af:t,methodName:e,cf:n,path:ri.$(),lf:!1,pf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Sp);function Sp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||sl(t)}function kp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Af(),this.fieldTransforms=i||[],this.Le=o||[]}function xp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.bf(o.merge||o.mergeFields?2:0,e,n,i);Vp("Data must be an object, but it was:",s,r);var u,a,h=Cp(r,s);if(o.merge)u=new Is(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof zl)d=p.sf;else{if("string"!=typeof p)throw Lr();d=Fp(e,p,n)}if(!s.contains(d))throw new $r(Yr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");qp(c,d)||c.push(d)}u=new Is(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new dp(new Ws(h),u,a)}function Op(t,o,s,e){var u=t.bf(1,o,s);Vp("Data must be an object, but it was:",u,e);var a=[],h=new Qs;zr(e,function(t,e){var n,r=Fp(o,t,s),i=u.gf(r);e instanceof Hl&&e.if instanceof Wl?a.push(r):null!=(n=Rp(e,i))&&(a.push(r),h.set(r,n))});var n=new Is(a);return new yp(h.Ge(),n,u.fieldTransforms)}function Pp(t,e,n,r,i,o){var s=t.bf(1,e,n),u=[Mp(e,r,n)],a=[i];if(o.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Mp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Qs,v=u.length-1;0<=v;--v)qp(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof Hl&&f.if instanceof Wl?d.push(c):null!=(p=Rp(f,l))&&(d.push(c),y.set(c,p)));var g=new Is(d);return new yp(y.Ge(),g,s.fieldTransforms)}function Lp(t,e,n,r){return void 0===r&&(r=!1),Rp(n,t.bf(r?4:3,e))}function Rp(s,t){if(Up(s))return Vp("Unsupported field value:",t,s),Cp(s,t);if(s instanceof Hl)return function(t,e){if(!Ap(e.af))throw e.uf(t.rf+"() can only be used with update() and set()");if(!e.path)throw e.uf(t.rf+"() is not currently supported inside arrays");var n=t.hf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.lf&&4!==t.af)throw t.uf("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Rp(i[r],t.yf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Jr.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Jr){var r=new Jr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof fp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bl)return{bytesValue:Mo(e.serializer,t)};if(t instanceof pp){var i=e.s,o=t.Tf;if(!o.isEqual(i))throw e.uf("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:jo(t.Tf||e.s,t.Ef.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.uf("Unsupported field value: "+Pl(t))}(s,t)}function Cp(t,r){var i={};return Kr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):zr(t,function(t,e){var n=Rp(e,r.Pf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Up(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Jr||t instanceof fp||t instanceof Bl||t instanceof pp||t instanceof Hl)}function Vp(t,e,n){if(!Up(n)||!Ol(n)){var r=Pl(n);throw"an object"===r?e.uf(t+" a custom object"):e.uf(t+" "+r)}}function Mp(t,e,n){if(e instanceof zl)return e.sf;if("string"==typeof e)return Fp(t,e);throw jp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Fp(t,e,n){try{return function(e){if(0<=e.search(Xl))throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Kl.bind.apply(Kl,i([void 0],e.split("."))))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).sf}catch(e){throw jp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function jp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new $r(Yr.INVALID_ARGUMENT,(u+=". ")+t+a)}function qp(t,e){return t.some(function(t){return t.isEqual(e)})}var Gp=(Hp.prototype.Nf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new $r(Yr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Xo((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Go(i.serializer,t)})},[4,i.Ka("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Rr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),r=Fo(e.found.updateTime),i=new Ws({mapValue:{fields:e.found.fields}});return new iu(n,r,i,{})}(e,n):"missing"in n?function(t,e){Rr(!!e.missing),Rr(!!e.readTime);var n=Bo(t,e.missing),r=Fo(e.readTime);return new ou(n,r)}(e,n):Lr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Rr(!!e),s.push(e)}),s)]}})})}(this.su,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ou||t instanceof iu?n.kf(t):Lr()}),e)]}})})},Hp.prototype.set=function(t,e){this.write(e.mf(t,this.Ue(t))),this.Cf.add(t)},Hp.prototype.update=function(t,e){try{this.write(e.mf(t,this.$f(t)))}catch(t){this.Df=t}this.Cf.add(t)},Hp.prototype.delete=function(t){this.write([new Xs(t,this.Ue(t))]),this.Cf.add(t)},Hp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Df)throw this.Df;return e=this.vf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ii(ei.k(e));r.mutations.push(new Hs(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Xo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Qo(e.serializer,t)})},[4,e.ja("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.su,this.mutations)];case 1:return t.sent(),this.Sf=!0,[2]}})})},Hp.prototype.kf=function(t){var e;if(t instanceof iu)e=t.version;else{if(!(t instanceof ou))throw Lr();e=Zr.min()}var n=this.vf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $r(Yr.ABORTED,"Document version changed between two reads.")}else this.vf.set(t.key.toString(),e)},Hp.prototype.Ue=function(t){var e=this.vf.get(t.toString());return!this.Cf.has(t)&&e?_s.updateTime(e):_s.Qe()},Hp.prototype.$f=function(t){var e=this.vf.get(t.toString());if(this.Cf.has(t)||!e)return _s.exists(!0);if(e.isEqual(Zr.min()))throw new $r(Yr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Hp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},Hp.prototype.Ff=function(){},Hp),Bp=(Xp.prototype.run=function(){this.Mf()},Xp.prototype.Mf=function(){var t=this;this.wi.ps(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Gp(this.su),(n=this.Of(e))&&n.then(function(t){r.ti.hi(function(){return e.commit().then(function(){r.si.resolve(t)}).catch(function(t){r.Lf(t)})})}).catch(function(t){r.Lf(t)}),[2]})})})},Xp.prototype.Of=function(t){try{var e=this.updateFunction(t);return!pi(e)&&e.catch&&e.then?e:(this.si.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.si.reject(t),null}},Xp.prototype.Lf=function(t){var e=this;0<this.xf&&this.qf(t)?(--this.xf,this.ti.hi(function(){return e.Mf(),Promise.resolve()})):this.si.reject(t)},Xp.prototype.qf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Si(e)},Xp),zp=(Kp.prototype.start=function(t,e,n,r){var i=this;this.Uf(),this.b_=t;var o=new wa,s=!1;return this.credentials.ia(function(t){return s?void i.ti.Vi(function(){return i.nl.Wu(t)}):(s=!0,kr("FirestoreClient","Initializing. user=",t.uid),i.Qf(e,n,r,t,o).then(i.Bf.resolve,i.Bf.reject))}),this.ti.hi(function(){return i.Bf.promise}),o.promise},Kp.prototype.enableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!0),t.nl.enableNetwork()})},Kp.prototype.Qf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ti:this.ti,b_:this.b_,clientId:this.clientId,credentials:this.credentials,j_:u,il:100,G_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.sl=i.sl,this.nu=i.nu,this.U_=i.U_,this.su=o.su,this.nl=o.nl,this.Du=o.Du,this.Wf=o.X_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.jf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Qf(new cl,new ll,{K_:!1},u,a))];case 4:return[2]}})})},Kp.prototype.jf=function(t){return"FirebaseError"===t.name?t.code===Yr.FAILED_PRECONDITION||t.code===Yr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Kp.prototype.Uf=function(){if(this.ti.Ei)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},Kp.prototype.disableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!1),t.nl.disableNetwork()})},Kp.prototype.terminate=function(){var t=this;return this.ti.Pi(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.nl.th()];case 1:return t.sent(),[4,this.sl.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.ra(),[2]}})})})},Kp.prototype.waitForPendingWrites=function(){var t=this;this.Uf();var e=new wa;return this.ti.hi(function(){return t.Du.bl(e)}),e.promise},Kp.prototype.listen=function(t,e,n){var r=this;this.Uf();var i=new ml(n),o=new xf(t,i,e);return this.ti.hi(function(){return r.Wf.listen(o)}),function(){i.ef(),r.ti.hi(function(){return r.Wf.vu(o)})}},Kp.prototype.Kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new wa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.xh(s)];case 1:return(e=t.sent())instanceof iu?i.resolve(e):e instanceof ou?i.resolve(null):i.reject(new $r(Yr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Ba(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ti,this.nu,e))]}})})},Kp.prototype.Gf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new wa,s=Wp(e,n,du(r.path),{includeMetadataChanges:!0,Gl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new $r(Yr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new $r(Yr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Kp.prototype.zf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new wa,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.Lh(h,!0)];case 1:return e=t.sent(),n=new df(h,e.qh),r=n.Wc(e.documents),i=n.Bn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ba(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ti,this.nu,e))]}})})},Kp.prototype.Hf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new wa,s=Wp(e,n,r,{includeMetadataChanges:!0,Gl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new $r(Yr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Kp.prototype.write=function(t){var e=this;this.Uf();var n=new wa;return this.ti.hi(function(){return e.Du.write(t,n)}),n.promise},Kp.prototype.s=function(){return this.b_.s},Kp.prototype.Ll=function(t){var e=this;this.Uf();var n=new ml(t);return this.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ll(n)]})})}),function(){n.ef(),e.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.ql(n)]})})})}},Object.defineProperty(Kp.prototype,"Yf",{get:function(){return this.ti.Ei},enumerable:!1,configurable:!0}),Kp.prototype.transaction=function(t){var e=this;this.Uf();var n=new wa;return this.ti.hi(function(){return new Bp(e.ti,e.su,t,n).run(),Promise.resolve()}),n.promise},Kp);function Kp(t,e){this.credentials=t,this.ti=e,this.clientId=Cr.t(),this.Bf=new wa}function Xp(t,e,n,r){this.ti=t,this.su=e,this.updateFunction=n,this.si=r,this.xf=5,this.wi=new Ea(this.ti,"transaction_retry")}function Hp(t){this.su=t,this.vf=new Map,this.mutations=[],this.Sf=!1,this.Df=null,this.Cf=new Set}function Wp(t,e,n,r,i){var o=new ml(i),s=new xf(n,o,r);return t.hi(function(){return e.listen(s)}),function(){o.ef(),t.hi(function(){return e.vu(s)})}}var Qp,Yp,$p=(yd.prototype.Zf=function(t){switch(vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return To(t.integerValue||t.doubleValue);case 3:return this.td(t.timestampValue);case 4:return this.ed(t);case 5:return t.stringValue;case 6:return new Bl(No(t.bytesValue));case 7:return this.nd(t.referenceValue);case 8:return this.sd(t.geoPointValue);case 9:return this.rd(t.arrayValue);case 10:return this.od(t.mapValue);default:throw Lr()}},yd.prototype.od=function(t){var n=this,r={};return zr(t.fields||{},function(t,e){r[t]=n.Zf(e)}),r},yd.prototype.sd=function(t){return new fp(To(t.latitude),To(t.longitude))},yd.prototype.rd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Zf(t)})},yd.prototype.ed=function(t){switch(this.Jf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.Zf(e);case"estimate":return this.td(po(t));default:return null}},yd.prototype.td=function(t){var e=Io(t),n=new Jr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},yd.prototype.nd=function(t){var e=ei.k(t);Rr(rs(e));var n=new qr(e.get(1),e.get(3)),r=new ii(e.g(5));return n.isEqual(this.s)||xr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Xf(r)},yd),Jp=Ha.ji,Zp=(dd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},dd),td=(Object.defineProperty(pd.prototype,"Id",{get:function(){return this.md||(this.md=new Dp(this.Tf,this.Ed.ignoreUndefinedProperties)),this.md},enumerable:!1,configurable:!0}),pd.prototype.settings=function(t){El("Firestore.settings",arguments,1),Nl("Firestore.settings","object",1,t);var e=new Zp(t);if(this.fd&&!this.Ed.isEqual(e))throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ed=e).credentials&&(this.Td=function(t){if(!t)return new Lc;switch(t.type){case"gapi":var e=t.Ad;return Rr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Uc(e,t.la||"0");case"provider":return t.Ad;default:throw new $r(Yr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},pd.prototype.enableNetwork=function(){return this._d(),this.fd.enableNetwork()},pd.prototype.disableNetwork=function(){return this._d(),this.fd.disableNetwork()},pd.prototype.enablePersistence=function(t){var e,n;if(this.fd)throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new $r(Yr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Rd(this.hd,this.ad,{K_:!0,cacheSizeBytes:this.Ed.cacheSizeBytes,synchronizeTabs:r,Vo:i})},pd.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.fd&&!this.fd.Yf)throw new $r(Yr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new wa,[2,(this.ld.Ii(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.Tf,this.wd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},pd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(pd.prototype,"Pd",{get:function(){return this._d(),this.fd.Yf},enumerable:!1,configurable:!0}),pd.prototype.waitForPendingWrites=function(){return this._d(),this.fd.waitForPendingWrites()},pd.prototype.onSnapshotsInSync=function(t){if(this._d(),gl(t))return this.fd.Ll(t);Nl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.fd.Ll(e)},pd.prototype._d=function(){return this.fd||this.Rd(new cl,new ll,{K_:!1}),this.fd},pd.prototype.Vd=function(){return new jr(this.Tf,this.wd,this.Ed.host,this.Ed.ssl,this.Ed.forceLongPolling)},pd.prototype.Rd=function(t,e,n){var r=this.Vd();return this.fd=new zp(this.Td,this.ld),this.fd.start(r,t,e,n)},pd.dd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $r(Yr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $r(Yr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qr(n)},Object.defineProperty(pd.prototype,"app",{get:function(){if(!this.ud)throw new $r(Yr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ud},enumerable:!1,configurable:!0}),pd.prototype.collection=function(t){return El("Firestore.collection",arguments,1),Nl("Firestore.collection","non-empty string",1,t),this._d(),new Td(ei.k(t),this,null)},pd.prototype.doc=function(t){return El("Firestore.doc",arguments,1),Nl("Firestore.doc","non-empty string",1,t),this._d(),rd.gd(ei.k(t),this,null)},pd.prototype.collectionGroup=function(t){if(El("Firestore.collectionGroup",arguments,1),Nl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._d(),new Ed((e=t,new fu(ei.$(),e)),this,null);var e},pd.prototype.runTransaction=function(e){var n=this;return El("Firestore.runTransaction",arguments,1),Nl("Firestore.runTransaction","function",1,e),this._d().transaction(function(t){return e(new ed(n,t))})},pd.prototype.batch=function(){return this._d(),new nd(this)},Object.defineProperty(pd,"logLevel",{get:function(){switch(Sr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),pd.setLogLevel=function(t){El("Firestore.setLogLevel",arguments,1),kl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Dr.setLogLevel(t)},pd.prototype.yd=function(){return this.Ed.timestampsInSnapshots},pd),ed=(ld.prototype.get=function(t){var n=this;El("Transaction.get",arguments,1);var r=xd("Transaction.get",t,this.pd);return this.bd.Nf([r.Ef]).then(function(t){if(!t||1!==t.length)return Lr();var e=t[0];if(e instanceof ou)return new od(n.pd,r.Ef,null,!1,!1,r.If);if(e instanceof iu)return new od(n.pd,r.Ef,e,!1,!1,r.If);throw Lr()})},ld.prototype.set=function(t,e,n){Tl("Transaction.set",arguments,2,3);var r=xd("Transaction.set",t,this.pd);n=Dd("Transaction.set",n);var i=Od(r.If,e,n),o=xp(this.pd.Id,"Transaction.set",r.Ef,i,null!==r.If,n);return this.bd.set(r.Ef,o),this},ld.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Kl?(Il("Transaction.update",arguments,3),r=xd("Transaction.update",t,this.pd),Pp(this.pd.Id,"Transaction.update",r.Ef,e,n,o)):(El("Transaction.update",arguments,2),r=xd("Transaction.update",t,this.pd),Op(this.pd.Id,"Transaction.update",r.Ef,e)),this.bd.update(r.Ef,i),this},ld.prototype.delete=function(t){El("Transaction.delete",arguments,1);var e=xd("Transaction.delete",t,this.pd);return this.bd.delete(e.Ef),this},ld),nd=(fd.prototype.set=function(t,e,n){Tl("WriteBatch.set",arguments,2,3),this.Dd();var r=xd("WriteBatch.set",t,this.pd);n=Dd("WriteBatch.set",n);var i=Od(r.If,e,n),o=xp(this.pd.Id,"WriteBatch.set",r.Ef,i,null!==r.If,n);return this.vd=this.vd.concat(o.mf(r.Ef,_s.Qe())),this},fd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Dd(),i="string"==typeof e||e instanceof Kl?(Il("WriteBatch.update",arguments,3),r=xd("WriteBatch.update",t,this.pd),Pp(this.pd.Id,"WriteBatch.update",r.Ef,e,n,o)):(El("WriteBatch.update",arguments,2),r=xd("WriteBatch.update",t,this.pd),Op(this.pd.Id,"WriteBatch.update",r.Ef,e)),this.vd=this.vd.concat(i.mf(r.Ef,_s.exists(!0))),this},fd.prototype.delete=function(t){El("WriteBatch.delete",arguments,1),this.Dd();var e=xd("WriteBatch.delete",t,this.pd);return this.vd=this.vd.concat(new Xs(e.Ef,_s.Qe())),this},fd.prototype.commit=function(){return this.Dd(),this.Sd=!0,0<this.vd.length?this.pd._d().write(this.vd):Promise.resolve()},fd.prototype.Dd=function(){if(this.Sd)throw new $r(Yr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},fd),rd=(n(cd,Yp=pp),cd.gd=function(t,e,n){if(t.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new cd(new ii(t),e,n)},Object.defineProperty(cd.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"parent",{get:function(){return new Td(this.Ef.path.p(),this.firestore,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"path",{get:function(){return this.Ef.path.F()},enumerable:!1,configurable:!0}),cd.prototype.collection=function(t){if(El("DocumentReference.collection",arguments,1),Nl("DocumentReference.collection","non-empty string",1,t),!t)throw new $r(Yr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ei.k(t);return new Td(this.Ef.path.child(e),this.firestore,null)},cd.prototype.isEqual=function(t){if(!(t instanceof cd))throw Cl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ef.isEqual(t.Ef)&&this.If===t.If},cd.prototype.set=function(t,e){Tl("DocumentReference.set",arguments,1,2),e=Dd("DocumentReference.set",e);var n=Od(this.If,t,e),r=xp(this.firestore.Id,"DocumentReference.set",this.Ef,n,null!==this.If,e);return this.fd.write(r.mf(this.Ef,_s.Qe()))},cd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Kl?(Il("DocumentReference.update",arguments,2),Pp(this.firestore.Id,"DocumentReference.update",this.Ef,t,e,r)):(El("DocumentReference.update",arguments,1),Op(this.firestore.Id,"DocumentReference.update",this.Ef,t)),this.fd.write(n.mf(this.Ef,_s.exists(!0)))},cd.prototype.delete=function(){return El("DocumentReference.delete",arguments,0),this.fd.write([new Xs(this.Ef,_s.Qe())])},cd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Tl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||gl(i[u])||(Rl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Dl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};gl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Nl("DocumentReference.onSnapshot","function",u,i[u]),Al("DocumentReference.onSnapshot","function",u+1,i[u+1]),Al("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Cd(t))},error:i[u+1],complete:i[u+2]};return this.fd.listen(du(this.Ef.path),h,c)},cd.prototype.get=function(t){var e=this;Tl("DocumentReference.get",arguments,0,1),kd("DocumentReference.get",t);var n=this.firestore._d();return t&&"cache"===t.source?n.Kf(this.Ef).then(function(t){return new od(e.firestore,e.Ef,t,!0,t instanceof iu&&t.Ke,e.If)}):n.Gf(this.Ef,t).then(function(t){return e.Cd(t)})},cd.prototype.withConverter=function(t){return new cd(this.Ef,this.firestore,t)},cd.prototype.Cd=function(t){var e=t.docs.get(this.Ef);return new od(this.firestore,this.Ef,e,t.fromCache,t.hasPendingWrites,this.If)},cd),id=(hd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},hd),od=(ad.prototype.data=function(t){var e=this;if(Tl("DocumentSnapshot.data",arguments,0,1),t=Sd("DocumentSnapshot.data",t),this.Nd){if(this.If){var n=new sd(this.pd,this.Ef,this.Nd,this.Fd,this.kd,null);return this.If.fromFirestore(n,t)}return new $p(this.pd.Tf,this.pd.yd(),t.serverTimestamps||"none",function(t){return new rd(t,e.pd,null)}).Zf(this.Nd.Ze())}},ad.prototype.get=function(t,e){var n=this;if(Tl("DocumentSnapshot.get",arguments,1,2),e=Sd("DocumentSnapshot.get",e),this.Nd){var r=this.Nd.data().field(Mp("DocumentSnapshot.get",t,this.Ef));if(null!==r)return new $p(this.pd.Tf,this.pd.yd(),e.serverTimestamps||"none",function(t){return new rd(t,n.pd,n.If)}).Zf(r)}},Object.defineProperty(ad.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"ref",{get:function(){return new rd(this.Ef,this.pd,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"exists",{get:function(){return null!==this.Nd},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"metadata",{get:function(){return new id(this.kd,this.Fd)},enumerable:!1,configurable:!0}),ad.prototype.isEqual=function(t){if(!(t instanceof ad))throw Cl("isEqual","DocumentSnapshot",1,t);return this.pd===t.pd&&this.Fd===t.Fd&&this.Ef.isEqual(t.Ef)&&(null===this.Nd?null===t.Nd:this.Nd.isEqual(t.Nd))&&this.If===t.If},ad),sd=(n(ud,Qp=od),ud.prototype.data=function(t){return Qp.prototype.data.call(this,t)},ud);function ud(){return null!==Qp&&Qp.apply(this,arguments)||this}function ad(t,e,n,r,i,o){this.pd=t,this.Ef=e,this.Nd=n,this.Fd=r,this.kd=i,this.If=o}function hd(t,e){this.hasPendingWrites=t,this.fromCache=e}function cd(t,e,n){var r=this;return(r=Yp.call(this,e.Tf,t,n)||this).Ef=t,r.firestore=e,r.If=n,r.fd=r.firestore._d(),r}function fd(t){this.pd=t,this.vd=[],this.Sd=!1}function ld(t,e){this.pd=t,this.bd=e}function pd(t,e,n,r){var i=this;if(void 0===n&&(n=new cl),void 0===r&&(r=new ll),this.hd=n,this.ad=r,this.ud=null,this.ld=new ja,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this._d(),[4,this.fd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ud=o,this.Tf=pd.dd(o),this.wd=o.name,this.Td=new Rc(e)}else{var s=t;if(!s.projectId)throw new $r(Yr.INVALID_ARGUMENT,"Must provide projectId");this.Tf=new qr(s.projectId,s.database),this.wd="[DEFAULT]",this.Td=new Lc}this.Ed=new Zp({})}function dd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new $r(Yr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else _l("settings","non-empty string","host",t.host),this.host=t.host,Dl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Rl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Dl("settings","object","credentials",t.credentials),this.credentials=t.credentials,Dl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Dl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Dl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ha.Gi;else{if(t.cacheSizeBytes!==Jp&&t.cacheSizeBytes<Ha.Ki)throw new $r(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ha.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Dl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function yd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Jf=n,this.Xf=r}function vd(t,e,n){if("string"==typeof n){if(""===n)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!yu(e)&&-1!==n.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ei.k(n));if(!ii.W(r))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new ii(r))}if(n instanceof pp)return Ao(t,n.Ef);throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pl(n)+".")}function gd(t,e){if(!Array.isArray(t)||0===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function md(t,e,n){if(!n.isEqual(e))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function wd(t){if(t.an()&&0===t.tn.length)throw new $r(Yr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bd,Ed=(_d.prototype.where=function(t,e,n){var r;El("Query.where",arguments,3),Ll("Query.where",3,n),r="not-in"===e||"!="===e?e:kl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Mp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.O()){if("array-contains"===i||"array-contains-any"===i)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){gd(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(vd(n,t,c))}s={arrayValue:{values:u}}}else s=vd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||gd(o,i),s=Lp(e,"Query.where",o,"in"===i||"not-in"===i);var f=Du.create(r,i,s);return function(t,e){if(e.ln()){var n=t.cn();if(null!==n&&!n.isEqual(e.field))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.un();null!==r&&md(0,e.field,r)}var i=t._n(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.$d,this.firestore.Id,this.firestore.Tf,s,r,n);return new _d((o=(i=this.$d).filters.concat([u]),new fu(i.path,i.collectionGroup,i.tn.slice(),o,i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.If)},_d.prototype.orderBy=function(t,e){var n;if(Tl("Query.orderBy",arguments,1,2),Al("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $r(Yr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Mp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new ea(e,n),s=o;return null!==(r=t).un()||null!==(i=r.cn())&&md(0,i,s.field),o}(this.$d,o,n);return new _d((i=(r=this.$d).tn.concat([s]),new fu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.If)},_d.prototype.limit=function(t){return El("Query.limit",arguments,1),Nl("Query.limit","number",1,t),Ul("Query.limit",1,t),new _d(mu(this.$d,t,"F"),this.firestore,this.If)},_d.prototype.limitToLast=function(t){return El("Query.limitToLast",arguments,1),Nl("Query.limitToLast","number",1,t),Ul("Query.limitToLast",1,t),new _d(mu(this.$d,t,"L"),this.firestore,this.If)},_d.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Il("Query.startAt",arguments,1);var r=this.xd("Query.startAt",t,e,!0);return new _d(wu(this.$d,r),this.firestore,this.If)},_d.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Il("Query.startAfter",arguments,1);var r=this.xd("Query.startAfter",t,e,!1);return new _d(wu(this.$d,r),this.firestore,this.If)},_d.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Il("Query.endBefore",arguments,1);var r=this.xd("Query.endBefore",t,e,!0);return new _d(bu(this.$d,r),this.firestore,this.If)},_d.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Il("Query.endAt",arguments,1);var r=this.xd("Query.endAt",t,e,!1);return new _d(bu(this.$d,r),this.firestore,this.If)},_d.prototype.isEqual=function(t){if(!(t instanceof _d))throw Cl("isEqual","Query",1,t);return this.firestore===t.firestore&&Eu(this.$d,t.$d)&&this.If===t.If},_d.prototype.withConverter=function(t){return new _d(this.$d,this.firestore,t)},_d.prototype.xd=function(c,t,e,n){if(Ll(c,1,t),t instanceof od)return El(c,i([t],e),1),function(t,e,n,r){if(!n)throw new $r(Yr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=vu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new $r(Yr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.F();throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Hu(i,r)}(this.$d,this.firestore.Tf,t.Nd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new $r(Yr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!yu(t)&&-1!==h.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ei.k(h));if(!ii.W(c))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new ii(c);u.push(Ao(e,f))}else{var l=Lp(n,r,h);u.push(l)}}return new Hu(u,o)}(this.$d,this.firestore.Tf,this.firestore.Id,c,r,n)},_d.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Tl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||gl(i[a])||(Rl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Dl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),gl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Nl("Query.onSnapshot","function",a,i[a]),Al("Query.onSnapshot","function",a+1,i[a+1]),Al("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new Id(r.firestore,r.$d,t,r.If))},error:i[a+1],complete:i[a+2]};return wd(this.$d),this.firestore._d().listen(this.$d,u,h)},_d.prototype.get=function(t){var e=this;Tl("Query.get",arguments,0,1),kd("Query.get",t),wd(this.$d);var n=this.firestore._d();return(t&&"cache"===t.source?n.zf(this.$d):n.Hf(this.$d,t)).then(function(t){return new Id(e.firestore,e.$d,t,e.If)})},_d),Id=(Object.defineProperty(Ad.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"empty",{get:function(){return this.Od.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"size",{get:function(){return this.Od.docs.size},enumerable:!1,configurable:!0}),Ad.prototype.forEach=function(e,n){var r=this;Tl("QuerySnapshot.forEach",arguments,1,2),Nl("QuerySnapshot.forEach","function",1,e),this.Od.docs.forEach(function(t){e.call(n,r.Bd(t,r.metadata.fromCache,r.Od.Lt.has(t.key)))})},Object.defineProperty(Ad.prototype,"query",{get:function(){return new Ed(this.Md,this.pd,this.If)},enumerable:!1,configurable:!0}),Ad.prototype.docChanges=function(t){t&&(Rl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Dl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Od.Bt)throw new $r(Yr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ld&&this.qd===e||(this.Ld=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Od,e,this.Bd.bind(this)),this.qd=e),this.Ld},Ad.prototype.isEqual=function(t){if(!(t instanceof Ad))throw Cl("isEqual","QuerySnapshot",1,t);return this.pd===t.pd&&Eu(this.Md,t.Md)&&this.Od.isEqual(t.Od)&&this.If===t.If},Ad.prototype.Bd=function(t,e,n){return new sd(this.pd,t.key,t,e,n,this.If)},Ad),Td=(n(Nd,bd=Ed),Object.defineProperty(Nd.prototype,"id",{get:function(){return this.$d.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"parent",{get:function(){var t=this.$d.path.p();return t._()?null:new rd(new ii(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"path",{get:function(){return this.$d.path.F()},enumerable:!1,configurable:!0}),Nd.prototype.doc=function(t){Tl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Cr.t()),Nl("CollectionReference.doc","non-empty string",1,t);var e=ei.k(t);return rd.gd(this.$d.path.child(e),this.firestore,this.If)},Nd.prototype.add=function(t){El("CollectionReference.add",arguments,1),Nl("CollectionReference.add","object",1,this.If?this.If.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Nd.prototype.withConverter=function(t){return new Nd(this.Ud,this.firestore,t)},Nd);function Nd(t,e,n){var r=this;if(((r=bd.call(this,du(t),e,n)||this).Ud=t).length%2!=1)throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Ad(t,e,n,r){this.pd=t,this.Md=e,this.Od=n,this.If=r,this.Ld=null,this.qd=null,this.metadata=new id(n.hasPendingWrites,n.fromCache)}function _d(t,e,n){this.$d=t,this.firestore=e,this.If=n}function Dd(t,e){if(void 0===e)return{merge:!1};if(Rl(t,e,["merge","mergeFields"]),Dl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Pl(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Kl))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Pl(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new $r(Yr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Sd(t,e){return void 0===e?{}:(Rl(t,e,["serverTimestamps"]),Sl(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function kd(t,e){Al(t,"object",1,e),e&&(Rl(t,e,["source"]),Sl(t,0,"source",e.source,["default","server","cache"]))}function xd(t,e,n){if(e instanceof pp){if(e.firestore!==n)throw new $r(Yr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Cl(t,"DocumentReference",1,e)}function Od(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Pd,Ld={Firestore:td,GeoPoint:fp,Timestamp:Jr,Blob:Bl,Transaction:ed,WriteBatch:nd,DocumentReference:rd,DocumentSnapshot:od,Query:Ed,QueryDocumentSnapshot:sd,QuerySnapshot:Id,CollectionReference:Td,FieldPath:Kl,FieldValue:hp,setLogLevel:td.setLogLevel,CACHE_SIZE_UNLIMITED:Jp};(Pd=Rd).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new ll,i=new fl(r),new td(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Ld))),Pd.registerVersion("@firebase/firestore","1.16.4-202071122108")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});