!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Fd){"use strict";try{(function(){Fd=Fd&&Object.prototype.hasOwnProperty.call(Fd,"default")?Fd.default:Fd;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D={},S=_||self;function k(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),R=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++R))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var $=S.navigator;if($){var J=$.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=k;var it,ot,st=Q(H,"Opera"),ut=Q(H,"Trident")||Q(H,"MSIE"),at=Q(H,"Edge"),ht=at||ut,ct=Q(H,"Gecko")&&!(Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge"))&&!(Q(H,"Trident")||Q(H,"MSIE"))&&!Q(H,"Edge"),ft=Q(H.toLowerCase(),"webkit")&&!Q(H,"Edge");function lt(){var t=S.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=H,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=W(String(it)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=S.document&&ut?lt()||(parseInt(it,10)||void 0):void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",k,e),S.removeEventListener("test",k,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},j(Tt,It);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function kt(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Gt(r);return e&&e[At]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Gt(n),t&&t[At]?t.va(e,n,P(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=jt(t);if(h||(t[Pt]=h=new kt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ft,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?xt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(xt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):St(t)))}function Vt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(wt)return Mt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new Tt(e,this))}function jt(t){return(t=t[Pt])instanceof kt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==x(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Bt(){q.call(this),this.c=new kt(this),(this.J=this).C=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&xt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Bt,q),Bt.prototype[At]=!0,(A=Bt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Gt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=S.JSON.stringify;function Xt(){this.b=this.a=null}var Ht,Wt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Yt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function $t(t,e){var n;Ht||(n=S.Promise.resolve(void 0),Ht=function(){n.then(te)}),Jt||(Ht(),Jt=!0),Zt.add(t,e)}Xt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Xt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var r=Wt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function ee(t,e){Bt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Ya,this),this.g=F()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==x(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(ee,Bt),(A=ee.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},A.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie,oe,se,ue=(T(oe=he,se=ie=q),oe.prototype=null===se?Object.create(se):(ae.prototype=se.prototype,new ae),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){ie.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ae(){this.constructor=oe}function he(t,e,n){var r=ie.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ce(t){q.call(this),this.b=t,this.a={}}j(ce,q);var fe=[];function le(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Bt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Te(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(me,It),j(be,It),j(Ie,It);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}_e.prototype.a=null;var ke,xe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){It.call(this,"d")}function Pe(){It.call(this,"c")}function Le(){}function Re(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ce(this),this.P=Ce,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Oe,It),j(Pe,It),j(Le,_e),ke=new Le;var Ce=45e3,Ue={},Ve={};function Me(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),qe(t),t.l=Ze(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),wn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ve:(o=Number(i.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>i.length?Ve:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ve){4==e&&(t.h=4,Ee(14),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ue){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),Xe(t,a)}4==e&&0==n.length&&(t.h=1,Ee(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ir(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),ze(t))}function qe(t){t.U=F()+t.P,Ge(t,t.P)}function Ge(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(V(t.Ua,t),e)}function Be(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ur(t.g,t)}function Ke(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Xe(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;sr(p),Qn(p)}rr(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(V(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||sr(p),!X(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Dn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fr(o,o.C?o.ga:null,o.fa),c.C?(Sn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Be(f),qe(f)),o.a=c):nr(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Wn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Re.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||r<=0?3:2),Be(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,f=this.l,l=this.f,p=this.T,d=e,y=i,h.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+p+"]: "+c+"\n"+f+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ee(12),Ke(this),ze(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Xe(this,a)}this.I?(je(this,e,o),ht&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),Xe(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?ur(this.g,this):(this.b=!1,qe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),Ke(this),ze(this)}}}catch(t){}var h,c,f,l,p,d,y},A.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),je(this,t,e),this.b&&4!=t&&qe(this)))},A.cancel=function(){this.A=!0,Ke(this)},A.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),Ke(this),this.h=2,ze(this)):Ge(this,this.U-n)},(A=We.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Qe(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function Ze(t){return new Je(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(vn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},r)),r.f=i):(n||(e=an(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,dn)),t.join("")};var cn=/[#\/\?@]/g,fn=/[#\?:]/g,ln=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function mn(t,e){return vn(t),e=bn(t,e),Ye(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),K(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||Tn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){vn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function kn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function On(){this.a=new xn}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=kn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Ln=S.JSON.parse;function Rn(t){Bt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}j(Rn,Bt);var Cn="",Un=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Gn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&void 0!==D&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Un.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Gn(t)}}}function Gn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Xn("baseRetryDelayMs",5e3,t),this.Ma=Xn("retryDelaySeedMs",1e4,t),this.Ja=Xn("forwardChannelMaxRetries",2,t),this.ma=Xn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Wn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,on(n=Ze(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),tr(t,n),(e=new Re(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=F(),qe(e)),cr(t)}function Qn(t){t.a&&(ir(t),t.a.cancel(),t.a=null)}function Yn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),sr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Nn(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.P),tr(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Re(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=er(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Me(n,r,e)}function tr(t,n){t.f&&He({},function(t,e){on(n,e,t)})}function er(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{He(t,function(t,e){var n=t;P(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function nr(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function rr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(V(t.Aa,t),ar(t,t.o)),t.o++,1)}function ir(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function or(t){t.a=new Re(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),tr(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,Fe(n,t)}function sr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ur(t,e){var n,r=null;if(t.a==e){sr(t),ir(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=ge()).dispatchEvent(new Ie(i)),Jn(t)):nr(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(V(t.Ba,t,e),ar(t,t.u)),t.u++,1}}(t,e)||2==i&&rr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function ar(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=V(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||tn(n,"https"),sn(n)),i=n.toString(),o=r,u=new de,S.Image?((s=new Image).onload=M(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=M(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=M(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(Pn,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==kn(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function fr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Je?Ze(r):new Je(r,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(i=S.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Je(null,void 0),o&&tn(h,o),s&&en(h,s),u&&nn(h,u),a&&(h.g=a),c=h),t.W&&Z(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),tr(t,c),c}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Ka)).F=t.C,e}function pr(){}function dr(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Bt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mr(this)}function vr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Pe.call(this),this.status=1}function mr(t){this.a=t}(A=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(ke),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var i,o=new We(this.headers);r&&He(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=G(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(i=this.a,ut&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},A.xa=function(){void 0!==D&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),Rn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ta())},A.Ta=function(){qn(this)},A.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Hn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Re(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=er(this,n,e),on(i=Ze(this.B),"RID",t),on(i,"CVER",22),this.A&&on(i,"X-HTTP-Session-Id",this.A),tr(this,i),this.i&&r&&Kn(i,this.i,r),Dn(this.b,n),this.Ga&&on(i,"TYPE","init"),this.da?(on(i,"$req",e),on(i,"SID","null"),n.V=!0,Me(n,i,null)):Me(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||Nn(this.b)||Zn(this))},A.Aa=function(){var t;this.j=null,or(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(V(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),or(this))},A.Ra=function(){null!=this.m&&(this.m=null,Qn(this),rr(this),Ee(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(A=pr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},dr.prototype.a=function(t,e){return new yr(t,e)},j(yr,Bt),(A=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=fr(t,null,t.fa),Jn(t)},A.close=function(){Wn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Kt(t),$n(this.a,e)):$n(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Wn(this.a),delete this.a,yr.S.G.call(this)},j(vr,Oe),j(gr,Pe),j(mr,pr),mr.prototype.ta=function(){this.a.dispatchEvent("a")},mr.prototype.sa=function(t){this.a.dispatchEvent(new vr(t))},mr.prototype.ra=function(t){this.a.dispatchEvent(new gr)},mr.prototype.qa=function(){this.a.dispatchEvent("b")},dr.prototype.createWebChannel=dr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Ae.COMPLETE="complete",(Se.EventType=xe).OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.X,Rn.prototype.getResponseJson=Rn.prototype.Na,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var wr={createWebChannelTransport:function(){return new dr},ErrorCode:Ne,EventType:Ae,WebChannel:Se,XhrIo:Rn},br=wr.createWebChannelTransport,Er=wr.ErrorCode,Ir=wr.EventType,Tr=wr.WebChannel,Nr=wr.XhrIo,Ar=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr="7.18.0-202071122108",Sr=new c("@firebase/firestore");function kr(){return Sr.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.DEBUG&&(e=n.map(Lr),Sr.debug.apply(Sr,i(["Firestore ("+Dr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.ERROR&&(e=n.map(Lr),Sr.error.apply(Sr,i(["Firestore ("+Dr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=l.WARN&&(e=n.map(Lr),Sr.warn.apply(Sr,i(["Firestore ("+Dr+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Dr+") INTERNAL ASSERTION FAILED: "+t;throw Or(e),new Error(e)}function Cr(t){t||Rr()}var Ur=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Mr(t,e){return t<e?-1:e<t?1:0}function Fr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function jr(t){return t+"\0"}function qr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Gr=(Object.defineProperty(Br.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Br.prototype.isEqual=function(t){return t instanceof Br&&t.projectId===this.projectId&&t.database===this.database},Br.prototype.o=function(t){return Mr(this.projectId,t.projectId)||Mr(this.database,t.database)},Br);function Br(t,e){this.projectId=t,this.database=e||"(default)"}function zr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Kr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Xr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hr,Wr,Qr,Yr=(pi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},pi.prototype.has=function(t){return void 0!==this.get(t)},pi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},pi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},pi.prototype.forEach=function(u){Kr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},pi.prototype._=function(){return Xr(this.l)},pi),$r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Jr=(n(li,Qr=Error),li),Zr=(fi.now=function(){return fi.fromMillis(Date.now())},fi.fromDate=function(t){return fi.fromMillis(t.getTime())},fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new fi(e,1e6*(t-1e3*e))},fi.prototype.toDate=function(){return new Date(this.toMillis())},fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},fi.prototype.T=function(t){return this.seconds===t.seconds?Mr(this.nanoseconds,t.nanoseconds):Mr(this.seconds,t.seconds)},fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},fi),ti=(ci.I=function(t){return new ci(t)},ci.min=function(){return new ci(new Zr(0,0))},ci.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ci.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ci.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ci.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ci.prototype.A=function(){return this.timestamp},ci),ei=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.P(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},hi.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},hi.prototype.v=function(){return this.segments[this.offset]},hi.prototype.S=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype._=function(){return 0===this.length},hi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},hi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ni=(n(ai,Wr=ei),ai.prototype.V=function(t,e,n){return new ai(t,e,n)},ai.prototype.F=function(){return this.N().join("/")},ai.prototype.toString=function(){return this.F()},ai.k=function(t){if(0<=t.indexOf("//"))throw new Jr($r.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ai(t.split("/").filter(function(t){return 0<t.length}))},ai.$=function(){return new ai([])},ai),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=(n(ui,Hr=ei),ui.prototype.V=function(t,e,n){return new ui(t,e,n)},ui.M=function(t){return ri.test(t)},ui.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ui.M(t)||(t="`"+t+"`"),t}).join(".")},ui.prototype.toString=function(){return this.F()},ui.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},ui.L=function(){return new ui(["__name__"])},ui.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Jr($r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Jr($r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Jr($r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Jr($r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ui(e)},ui.$=function(){return new ui([])},ui),oi=(si.B=function(t){return new si(ni.k(t).g(5))},si.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},si.prototype.isEqual=function(t){return null!==t&&0===ni.P(this.path,t.path)},si.prototype.toString=function(){return this.path.toString()},si.P=function(t,e){return ni.P(t.path,e.path)},si.W=function(t){return t.length%2==0},si.j=function(t){return new si(new ni(t.slice()))},si);function si(t){this.path=t}function ui(){return null!==Hr&&Hr.apply(this,arguments)||this}function ai(){return null!==Wr&&Wr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.R=n}function ci(t){this.timestamp=t}function fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Jr($r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Jr($r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Jr($r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Jr($r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function li(t,e){var n=this;return(n=Qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function pi(t,e){this.h=t,this.u=e,this.l={}}function di(t){return null==t}function yi(t){return-0===t&&1/t==-1/0}function vi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e,n=t;return null===n.K&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+Io(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),di(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=ta(n.startAt)),n.endAt&&(e+="|ub:",e+=ta(n.endAt)),n.K=e),n.K}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!na(t.startAt,e.startAt)&&na(t.endAt,e.endAt)}function Ei(t){return oi.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ti.fromBase64String=function(t){return new Ti(atob(t))},Ti.fromUint8Array=function(t){return new Ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ti.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ti.prototype.H=function(){return 2*this.G.length},Ti.prototype.o=function(t){return Mr(this.G,t.G)},Ti.prototype.isEqual=function(t){return this.G===t.G},Ti);function Ti(t){this.G=t}Ii.Y=new Ii("");function Ni(t){this.count=t}var Ai,_i,Di=(Si.prototype.Z=function(t){return new Si(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Si.prototype.tt=function(t,e){return new Si(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Si.prototype.et=function(t){return new Si(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},Si);function Si(t,e,n,r,i,o,s){void 0===i&&(i=ti.min()),void 0===o&&(o=ti.min()),void 0===s&&(s=Ii.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case $r.OK:return Rr(),0;case $r.CANCELLED:case $r.UNKNOWN:case $r.DEADLINE_EXCEEDED:case $r.RESOURCE_EXHAUSTED:case $r.INTERNAL:case $r.UNAVAILABLE:case $r.UNAUTHENTICATED:return;case $r.INVALID_ARGUMENT:case $r.NOT_FOUND:case $r.ALREADY_EXISTS:case $r.PERMISSION_DENIED:case $r.FAILED_PRECONDITION:case $r.ABORTED:case $r.OUT_OF_RANGE:case $r.UNIMPLEMENTED:case $r.DATA_LOSS:return 1;default:return Rr(),0}}function xi(t){if(void 0===t)return Or("GRPC error has no .code"),$r.UNKNOWN;switch(t){case Ai.OK:return $r.OK;case Ai.CANCELLED:return $r.CANCELLED;case Ai.UNKNOWN:return $r.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return $r.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return $r.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return $r.INTERNAL;case Ai.UNAVAILABLE:return $r.UNAVAILABLE;case Ai.UNAUTHENTICATED:return $r.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return $r.INVALID_ARGUMENT;case Ai.NOT_FOUND:return $r.NOT_FOUND;case Ai.ALREADY_EXISTS:return $r.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return $r.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return $r.FAILED_PRECONDITION;case Ai.ABORTED:return $r.ABORTED;case Ai.OUT_OF_RANGE:return $r.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return $r.UNIMPLEMENTED;case Ai.DATA_LOSS:return $r.DATA_LOSS;default:return Rr()}}(_i=Ai=Ai||{})[_i.OK=0]="OK",_i[_i.CANCELLED=1]="CANCELLED",_i[_i.UNKNOWN=2]="UNKNOWN",_i[_i.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_i[_i.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_i[_i.NOT_FOUND=5]="NOT_FOUND",_i[_i.ALREADY_EXISTS=6]="ALREADY_EXISTS",_i[_i.PERMISSION_DENIED=7]="PERMISSION_DENIED",_i[_i.UNAUTHENTICATED=16]="UNAUTHENTICATED",_i[_i.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_i[_i.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_i[_i.ABORTED=10]="ABORTED",_i[_i.OUT_OF_RANGE=11]="OUT_OF_RANGE",_i[_i.UNIMPLEMENTED=12]="UNIMPLEMENTED",_i[_i.INTERNAL=13]="INTERNAL",_i[_i.UNAVAILABLE=14]="UNAVAILABLE",_i[_i.DATA_LOSS=15]="DATA_LOSS";var Oi=(Ui.prototype.nt=function(t,e){return new Ui(this.P,this.root.nt(t,e,this.P).copy(null,null,Li.st,null,null))},Ui.prototype.remove=function(t){return new Ui(this.P,this.root.remove(t,this.P).copy(null,null,Li.st,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype._=function(){return this.root._()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.it=function(){return this.root.it()},Ui.prototype.rt=function(){return this.root.rt()},Ui.prototype.ot=function(t){return this.root.ot(t)},Ui.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.ht=function(t){return this.root.ht(t)},Ui.prototype.at=function(){return new Pi(this.root,null,this.P,!1)},Ui.prototype.ut=function(t){return new Pi(this.root,t,this.P,!1)},Ui.prototype.ct=function(){return new Pi(this.root,null,this.P,!0)},Ui.prototype.lt=function(t){return new Pi(this.root,t,this.P,!0)},Ui),Pi=(Ci.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ci.prototype.wt=function(){return 0<this.ft.length},Ci.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ci),Li=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype._=function(){return!1},Ri.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ri.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ri.prototype.min=function(){return this.left._()?this:this.left.min()},Ri.prototype.it=function(){return this.min().key},Ri.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ri.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ri.prototype.It=function(){if(this.left._())return Ri.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ri.prototype.At=function(){return this.color},Ri.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Ri.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).gt()).yt()),t},Ri.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Ri.prototype.gt=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.Pt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ri.prototype.bt=function(){if(this.At()&&this.left.At())throw Rr();if(this.right.At())throw Rr();var t=this.left.bt();if(t!==this.right.bt())throw Rr();return t+(this.At()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ui(t,e){this.P=t,this.root=e||Li.EMPTY}function Vi(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.st=!1,Li.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.nt=function(t,e,n){return new Li(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype._=function(){return!0},Vi.prototype.ot=function(t){return!1},Vi.prototype.ht=function(t){return!1},Vi.prototype.it=function(){return null},Vi.prototype.rt=function(){return null},Vi.prototype.At=function(){return!1},Vi.prototype.pt=function(){return!0},Vi.prototype.bt=function(){return 0},new Vi);var Mi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.it()},Gi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Gi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Gi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Gi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Gi.prototype.at=function(){return new Fi(this.data.at())},Gi.prototype.ut=function(t){return new Fi(this.data.ut(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype._=function(){return this.data._()},Gi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Gi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.P);return e.data=t,e},Gi),Fi=(qi.prototype.dt=function(){return this.Nt.dt().key},qi.prototype.wt=function(){return this.Nt.wt()},qi),ji=new Oi(oi.P);function qi(t){this.Nt=t}function Gi(t){this.P=t,this.data=new Oi(this.P)}var Bi=new Oi(oi.P);var zi=new Oi(oi.P),Ki=new Mi(oi.P);function Xi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ki,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new Mi(Mr);function Wi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Qi(t,e){this.targetId=t,this.ee=e}function Yi(t,e,n,r){void 0===n&&(n=Ii.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var $i=(co.$t=function(t){return new co(t.P)},co.prototype.has=function(t){return null!=this.Ft.get(t)},co.prototype.get=function(t){return this.Ft.get(t)},co.prototype.first=function(){return this.kt.it()},co.prototype.last=function(){return this.kt.rt()},co.prototype._=function(){return this.kt._()},co.prototype.indexOf=function(t){var e=this.Ft.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ft.nt(t.key,t),e.kt.nt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ft.remove(t),this.kt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.P=this.P,n.Ft=t,n.kt=e,n},co),Ji=(ho.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Rr()},ho.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ho),Zi=(ao.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,$i.$t(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&Tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),to=(uo.Gt=function(t,e){var n=new Map;return n.set(t,eo.zt(t,e)),new uo(ti.min(),n,Hi,ji,Xi())},uo),eo=(so.zt=function(t,e){return new so(Ii.Y,e,Xi(),Xi(),Xi())},so),no=(Object.defineProperty(oo.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),oo.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},oo.prototype.ce=function(){var n=Xi(),r=Xi(),i=Xi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new eo(this.ie,this.re,n,r,i)},oo.prototype.le=function(){this.oe=!1,this.se=lo()},oo.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},oo.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},oo.prototype.de=function(){this.ne+=1},oo.prototype.we=function(){--this.ne},oo.prototype.Te=function(){this.oe=!0,this.re=!0},oo),ro=(io.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof su?this.Ve(r,t.te):t.te instanceof uu&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},io.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Rr()}})},io.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},io.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(Ei(e=o.target)?0===i?(n=new oi(e.path),this.ge(r,n,new uu(n,ti.min()))):Cr(1===i):this.Ne(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},io.prototype.Fe=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&Ei(r.target)&&(n=new oi(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.ge(e,n,new uu(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Xi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new to(i,s,this.Re,this.me,r);return this.me=ji,this.Ae=fo(),this.Re=new Mi(Mr),t},io.prototype.Ve=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.$e(e.key).add(t)))},io.prototype.ge=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.$e(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},io.prototype.removeTarget=function(t){this.Ie.delete(t)},io.prototype.Ne=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},io.prototype.de=function(t){this.be(t).de()},io.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new no,this.Ie.set(t,e)),e},io.prototype.$e=function(t){var e=this.Ae.get(t);return e||(e=new Mi(Mr),this.Ae=this.Ae.nt(t,e)),e},io.prototype.ve=function(t){var e=null!==this.Ce(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},io.prototype.Se=function(e){var n=this;this.Ie.set(e,new no),this.Ee.xe(e).forEach(function(t){n.ge(e,t,null)})},io.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},io);function io(t){this.Ee=t,this.Ie=new Map,this.me=ji,this.Ae=fo(),this.Re=new Mi(Mr)}function oo(){this.ne=0,this.se=lo(),this.ie=Ii.Y,this.re=!1,this.oe=!0}function so(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function uo(t,e,n,r,i){this.X=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function ho(){this.xt=new Oi(oi.P)}function co(n){this.P=n?function(t,e){return n(t,e)||oi.P(t.key,e.key)}:function(t,e){return oi.P(t.key,e.key)},this.Ft=Bi,this.kt=new Oi(this.P)}function fo(){return new Oi(oi.P)}function lo(){return new Oi(oi.P)}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yo(t){var e=To(t.mapValue.fields.__local_write_time__.timestampValue);return new Zr(e.seconds,e.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Rr()}function mo(r,i){var t,e,n,o=go(r);if(o!==go(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yo(r).isEqual(yo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),n=To(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Ao(r.bytesValue).isEqual(Ao(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,No((t=r).geoPointValue.latitude)===No(e.geoPointValue.latitude)&&No(t.geoPointValue.longitude)===No(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return No(t.integerValue)===No(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=No(t.doubleValue),r=No(e.doubleValue);return n===r?yi(n)===yi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Fr(r.arrayValue.values||[],i.arrayValue.values||[],mo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(zr(t)!==zr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!mo(t[n],e[n])))return!1;return!0}();default:return Rr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i,o,s,u,a,h,c,f,l=go(t),p=go(e);if(l!==p)return Mr(l,p);switch(l){case 0:return 0;case 1:return Mr(t.booleanValue,e.booleanValue);case 2:return h=e,c=No(t.integerValue||t.doubleValue),f=No(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Eo(t.timestampValue,e.timestampValue);case 4:return Eo(yo(t),yo(e));case 5:return Mr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Mr(n[i],r[i]);if(0!==o)return o}return Mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Mr(No(n.latitude),No(r.latitude)))?i:Mr(No(n.longitude),No(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Mr(r[s],o[s]);if(0!==u)return u;var a=bo(n[r[s]],i[o[s]]);if(0!==a)return a}return Mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function Eo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mr(t,e);var n=To(t),r=To(e),i=Mr(n.seconds,r.seconds);return 0!==i?i:Mr(n.nanos,r.nanos)}function Io(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=To(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ao(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,oi.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e,n}(t)}function To(t){if(Cr(!!t),"string"!=typeof t)return{seconds:No(t.seconds),nanos:No(t.nanos)};var e,n=0,r=vo.exec(t);Cr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function No(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function _o(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function Do(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var Po={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this.s=t,this.Oe=e};function Co(t){return{integerValue:""+t}}function Uo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function Vo(t,e){return vi(e)?Co(e):Uo(t,e)}function Mo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function jo(t){return Cr(!!t),ti.I((e=To(t),new Zr(e.seconds,e.nanos)));var e}function qo(t,e){return new ni(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function Go(t){var e=ni.k(t);return Cr(is(e)),e}function Bo(t,e){return qo(t.s,e.path)}function zo(t,e){var n=Go(e);return Cr(n.get(1)===t.s.projectId),Cr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new oi(Wo(n))}function Ko(t,e){return qo(t.s,e)}function Xo(t){var e=Go(t);return 4===e.length?ni.$():Wo(e)}function Ho(t){return new ni(["projects",t.s.projectId,"databases",t.s.database]).F()}function Wo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.g(5)}function Qo(t,e,n){return{name:Bo(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i,o,s,u;if(e instanceof Vs)n={update:Qo(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Bo(t,e.key)};else if(e instanceof Ms)n={update:Qo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof Bs)n={transform:{document:Bo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.F(),increment:e.qe};throw Rr()})}};else{if(!(e instanceof Qs))return Rr();n={verify:Bo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:(s=t,u=o.updateTime,Mo(s,u.A()))}:void 0!==o.exists?{exists:o.exists}:Rr()),n}function $o(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ds.updateTime(jo(n.updateTime)):void 0!==n.exists?Ds.exists(n.exists):Ds.Qe():Ds.Qe();if(t.update){t.update.name;var o=zo(e,t.update.name),s=new Ys({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ts(r.map(function(t){return ii.q(t)})));return new Ms(o,s,u,i)}return new Vs(o,s,i)}if(t.delete){var a=zo(e,t.delete);return new Ws(a,i)}if(t.transform){var h=zo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),i=new hs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new cs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ys(r)):"increment"in e?i=new ws(t,e.increment):Rr();var o=ii.q(e.fieldPath);return new Ns(o,i)}(e,t)});return Cr(!0===i.exists),new Bs(h,c)}if(t.verify){var f=zo(e,t.verify);return new Qs(f,i)}return Rr()}function Jo(t,e){return{documents:[Ko(t,e.path)]}}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ko(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ko(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(xo(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ns((e=t).field),direction:(n=e.dir,Po[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||di(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=ts(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ts(e.endAt)),n}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,n=t.values||[];return new Qu(n,e)}function ns(t){return{fieldPath:t.F()}}function rs(t){return ii.q(t.fieldPath)}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function os(){this.We=void 0}function ss(t,e){return t instanceof ws?Do(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var us,as,hs=(n(ls,as=os),ls),cs=(n(fs,us=os),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(n(vs,ds=os),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(n(bs,ms=os),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).serializer=t,n.qe=e,n}function Es(t){return No(t.integerValue||t.doubleValue)}function Is(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ts=(As.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},As.prototype.isEqual=function(t){return Fr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As),Ns=function(t,e){this.field=t,this.transform=e};function As(t){(this.fields=t).sort(ii.P)}function _s(t,e){this.version=t,this.transformResults=e}var Ds=(Ss.Qe=function(){return new Ss},Ss.exists=function(t){return new Ss(void 0,t)},Ss.updateTime=function(t){return new Ss(t)},Object.defineProperty(Ss.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ss.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ss);function Ss(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof su&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof su}function xs(){}function Os(t,e,n){return t instanceof Vs?new su(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ms?function(t,e,n){if(!ks(t.Ue,e))return new au(t.key,n.version);var r=qs(t,e);return new su(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Bs?function(t,e,n){if(Cr(null!=n.transformResults),!ks(t.Ue,e))return new au(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof su&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof cs?ps(i,o):i instanceof ys?gs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ks(t,r.data(),i);return new su(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new uu(t.key,n.version,{hasCommittedMutations:!0})}function Ps(t,e,n,r){return t instanceof Vs?function(t,e){if(!ks(t.Ue,e))return e;var n=Rs(e);return new su(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Ms?function(t,e){if(!ks(t.Ue,e))return e;var n=Rs(e),r=qs(t,e);return new su(t.key,n,r,{Ke:!0})}(t,e):t instanceof Bs?function(t,e,n,r){if(!ks(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c,f=[],l=0,p=t;l<p.length;l++){var d=p[l],y=d.transform,v=null;n instanceof su&&(v=n.field(d.field)),null===v&&r instanceof su&&(v=r.field(d.field)),f.push((o=v,s=e,c=h=a=u=void 0,(i=y)instanceof hs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof cs?ps(i,o):i instanceof ys?gs(i,o):(a=ss(u=i,o),h=Es(a)+Es(u.qe),Do(a)&&Do(u.qe)?Co(h):Uo(u.serializer,h))))}return f}(t.fieldTransforms,n,e,r),s=Ks(t,i.data(),o);return new su(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,ks((i=t).Ue,o)?new uu(i.key,ti.min()):o);var i,o}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Fr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof cs&&o instanceof cs||i instanceof ys&&o instanceof ys?Fr(i.elements,o.elements,mo):i instanceof ws&&o instanceof ws?mo(i.qe,o.qe):i instanceof hs&&o instanceof hs);var n,r,i,o}))}function Rs(t){return t instanceof su?t.version:ti.min()}var Cs,Us,Vs=(n(js,Us=xs),js),Ms=(n(Fs,Cs=xs),Fs);function Fs(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Us.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function qs(t,e){return n=t,r=e instanceof su?e.data():Ys.empty(),i=new $s(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var Gs,Bs=(n(zs,Gs=xs),zs);function zs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=Ds.exists(!0),n}function Ks(t,e,n){for(var r=new $s(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Xs,Hs,Ws=(n(eu,Hs=xs),eu),Qs=(n(tu,Xs=xs),tu),Ys=(Zs.empty=function(){return new Zs({mapValue:{}})},Zs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Zs.prototype.isEqual=function(t){return mo(this.proto,t.proto)},Zs),$s=(Js.prototype.set=function(t,e){return this.Ye(t,e),this},Js.prototype.delete=function(t){return this.Ye(t,null),this},Js.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Js.prototype.Ge=function(){var t=this.Je(ii.$(),this.He);return null!=t?new Ys(t):this.ze},Js.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Js);function Js(t){void 0===t&&(t=Ys.empty()),this.ze=t,this.He=new Map}function Zs(t){this.proto=t}function tu(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function eu(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function nu(t,e){this.key=t,this.version=e}var ru,iu,ou,su=(n(fu,ou=nu),fu.prototype.field=function(t){return this.Xe.field(t)},fu.prototype.data=function(){return this.Xe},fu.prototype.Ze=function(){return this.Xe.proto},fu.prototype.isEqual=function(t){return t instanceof fu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},fu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu),uu=(n(cu,iu=nu),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),au=(n(hu,ru=nu),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu);function hu(){return null!==ru&&ru.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=iu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fu(t,e,n,r){var i=this;return(i=ou.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Jr($r.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Jr($r.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var pu=(du.prototype.rn=function(t){return new du(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},du.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},du.prototype.hn=function(){return!di(this.limit)&&"F"===this.en},du.prototype.an=function(){return!di(this.limit)&&"L"===this.en},du.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},du.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},du.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},du);function du(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function yu(t,e,n,r,i,o,s,u){return new pu(t,e,n,r,i,o,s,u)}function vu(t){return new pu(t)}function gu(t){return null!==t.collectionGroup}function mu(t){var e=lu(t,pu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new ra(n)),e.nn.push(new ra(ii.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new ra(ii.L(),i)))}}return e.nn}function wu(t){var e=lu(t,pu);if(!e.sn)if("F"===e.en)e.sn=mi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ra(o.field,s))}var u=e.endAt?new Qu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Qu(e.startAt.position,!e.startAt.before):null;e.sn=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function bu(t,e,n){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function Iu(t,e){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function Tu(t,e){return bi(wu(t),wu(e))&&t.en===e.en}function Nu(t){return wi(wu(t))+"|lt:"+t.en}function Au(t){return"Query(target="+(e=wu(t),n=e.path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+Io(e.value);var e}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ta(e.startAt)),e.endAt&&(n+=", endAt: "+ta(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function _u(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):oi.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||ea(e.startAt,mu(e),n))&&(!e.endAt||!ea(e.endAt,mu(e),n)));var e,n,r,o}function Du(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.O()?oi.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?bo(n,r):Rr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Su,ku=(n(xu,Su=function(){}),xu.create=function(t,e,n){if(t.O())return"in"===e||"not-in"===e?this.fn(t,e,n):new Ru(t,e,n);if(ko(n)){if("=="!==e&&"!="!==e)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new xu(t,e,n)}if(xo(n)){if("=="!==e&&"!="!==e)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new xu(t,e,n)}return"array-contains"===e?new Ku(t,n):"in"===e?new Xu(t,n):"not-in"===e?new Hu(t,n):"array-contains-any"===e?new Wu(t,n):new xu(t,e,n)},xu.fn=function(t,e,n){return new("in"===e?Cu:Uu)(t,n)},xu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.dn(bo(e,this.value)):null!==e&&go(this.value)===go(e)&&this.dn(bo(e,this.value))},xu.prototype.dn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},xu.prototype.ln=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},xu);function xu(t,e,n){var r=this;return(r=Su.call(this)||this).field=t,r.op=e,r.value=n,r}var Ou,Pu,Lu,Ru=(n(Fu,Lu=ku),Fu.prototype.matches=function(t){var e=oi.P(t.key,this.key);return this.dn(e)},Fu),Cu=(n(Mu,Pu=ku),Mu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Mu),Uu=(n(Vu,Ou=ku),Vu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Vu);function Vu(t,e){var n=this;return(n=Ou.call(this,t,"not-in",e)||this).keys=ju(0,e),n}function Mu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=ju(0,e),n}function Fu(t,e,n){var r=this;return(r=Lu.call(this,t,e,n)||this).key=oi.B(n.referenceValue),r}function ju(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return oi.B(t.referenceValue)})}var qu,Gu,Bu,zu,Ku=(n(Zu,zu=ku),Zu.prototype.matches=function(t){var e=t.field(this.field);return So(e)&&wo(e.arrayValue,this.value)},Zu),Xu=(n(Ju,Bu=ku),Ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&wo(this.value.arrayValue,e)},Ju),Hu=(n($u,Gu=ku),$u.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!wo(this.value.arrayValue,e)},$u),Wu=(n(Yu,qu=ku),Yu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!So(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},Yu),Qu=function(t,e){this.position=t,this.before=e};function Yu(t,e){return qu.call(this,t,"array-contains-any",e)||this}function $u(t,e){return Gu.call(this,t,"not-in",e)||this}function Ju(t,e){return Bu.call(this,t,"in",e)||this}function Zu(t,e){return zu.call(this,t,"array-contains",e)||this}function ta(t){return(t.before?"b":"a")+":"+t.position.map(Io).join(",")}function ea(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?oi.P(oi.B(s.referenceValue),n.key):bo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function na(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var ia=(ba.prototype.Tn=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Os(o,e,r[i]))}return e},ba.prototype.In=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.wn))}return e},ba.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.In(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Xi())},ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&Fr(this.mutations,t.mutations,Ls)&&Fr(this.baseMutations,t.baseMutations,Ls)},ba),oa=(wa.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new wa(t,e,n,r)},wa),sa=(ma.prototype.catch=function(t){return this.next(void 0,t)},ma.prototype.next=function(r,i){var o=this;return this.yn&&Rr(),this.yn=!0,this.gn?this.error?this.pn(i,this.error):this.bn(r,this.result):new ma(function(e,n){o.Pn=function(t){o.bn(r,t).next(e,n)},o.Vn=function(t){o.pn(i,t).next(e,n)}})},ma.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ma.prototype.Sn=function(t){try{var e=t();return e instanceof ma?e:ma.resolve(e)}catch(t){return ma.reject(t)}},ma.prototype.bn=function(t,e){return t?this.Sn(function(){return t(e)}):ma.resolve(e)},ma.prototype.pn=function(t,e){return t?this.Sn(function(){return t(e)}):ma.reject(e)},ma.resolve=function(n){return new ma(function(t,e){t(n)})},ma.reject=function(n){return new ma(function(t,e){e(n)})},ma.Dn=function(t){return new ma(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ma.Cn=function(t){for(var n=ma.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ma.resolve(t):e()})}(r[e]);return n},ma.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Dn(i)},ma),ua=(Object.defineProperty(ga.prototype,"readTime",{get:function(){return this.kn},set:function(t){this.kn=t},enumerable:!1,configurable:!0}),ga.prototype.$n=function(t,e){this.xn(),this.readTime=e,this.Nn.set(t.key,t)},ga.prototype.Mn=function(t,e){this.xn(),e&&(this.readTime=e),this.Nn.set(t,null)},ga.prototype.On=function(t,e){this.xn();var n=this.Nn.get(e);return void 0!==n?sa.resolve(n):this.Ln(t,e)},ga.prototype.getEntries=function(t,e){return this.qn(t,e)},ga.prototype.apply=function(t){return this.xn(),this.Fn=!0,this.Bn(t)},ga.prototype.xn=function(){},ga),aa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ha=(va.prototype.Qn=function(t){this.Un.push(t)},va.prototype.Wn=function(){this.Un.forEach(function(t){return t()})},va),ca=(ya.prototype.zn=function(e,n){var r=this;return this.Kn.Hn(e,n).next(function(t){return r.Yn(e,n,t)})},ya.prototype.Yn=function(t,r,i){return this.jn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].In(r,t);return t})},ya.prototype.Jn=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].In(t,e);o=o.nt(t,e)}),o},ya.prototype.Xn=function(e,t){var n=this;return this.jn.getEntries(e,t).next(function(t){return n.Zn(e,t)})},ya.prototype.Zn=function(r,i){var o=this;return this.Kn.ts(r,i).next(function(t){var e=o.Jn(r,i,t),n=ji;return e.forEach(function(t,e){e=e||new uu(t,ti.min()),n=n.nt(t,e)}),n})},ya.prototype.es=function(t,e,n){return r=e,oi.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):gu(e)?this.ss(t,e,n):this.rs(t,e,n);var r},ya.prototype.ns=function(t,e){return this.zn(t,new oi(e)).next(function(t){var e=Bi;return t instanceof su&&(e=e.nt(t.key,t)),e})},ya.prototype.ss=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi;return this.Gn.os(n,s).next(function(t){return sa.forEach(t,function(t){var e=r.rn(t.child(s));return o.rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},ya.prototype.rs=function(e,n,t){var c,f,r=this;return this.jn.es(e,n,t).next(function(t){return c=t,r.Kn.hs(e,n)}).next(function(t){return f=t,r.as(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Ps(s,a,a,r.wn);c=h instanceof su?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){_u(n,e)||(c=c.remove(t))}),c})},ya.prototype.as=function(t,e,n){for(var r=Xi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.jn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof su&&(h=h.nt(t,e))}),h})},ya),fa=(da.ls=function(t,e){for(var n=Xi(),r=Xi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new da(t,e.fromCache,n,r)},da),la=(pa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},pa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},pa);function pa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function da(t,e,n,r){this.targetId=t,this.fromCache=e,this.us=n,this.cs=r}function ya(t,e,n){this.jn=t,this.Kn=e,this.Gn=n}function va(){this.Un=[]}function ga(){this.Nn=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function ma(t){var e=this;this.Pn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.yn=!1,t(function(t){e.gn=!0,e.result=t,e.Pn&&e.Pn(t)},function(t){e.gn=!0,e.error=t,e.Vn&&e.Vn(t)})}function wa(t,e,n,r){this.batch=t,this.An=e,this.En=n,this.Rn=r}function ba(t,e,n,r){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=r}la.Ts=-1;function Ea(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ia,Ta=(xa.prototype.reset=function(){this.Ps=0},xa.prototype.ys=function(){this.Ps=this.Rs},xa.prototype.ps=function(t){var e=this;this.cancel();var n=Math.floor(this.Ps+this.bs()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ps+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Es.vs(this.Is,i,function(){return e.gs=Date.now(),t()}),this.Ps*=this.As,this.Ps<this.ms&&(this.Ps=this.ms),this.Ps>this.Rs&&(this.Ps=this.Rs)},xa.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},xa.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},xa.prototype.bs=function(){return(Math.random()-.5)*this.Ps},xa),Na=(ka.delete=function(t){return xr("SimpleDb","Removing database:",t),Ua(window.indexedDB.deleteDatabase(t)).vn()},ka.Fs=function(){if("undefined"==typeof indexedDB)return!1;if(ka.ks())return!0;var t=p(),e=ka.Ns(t),n=0<e&&e<10,r=ka.$s(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},ka.ks=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.xs)},ka.Ms=function(t,e){return t.store(e)},ka.Ns=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},ka.$s=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},ka.prototype.Os=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new _a("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Jr($r.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new _a(e))},i.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Cs.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){xr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Ls&&(this.db.onversionchange=function(t){return o.Ls(t)}),this.db)]}})})},ka.prototype.qs=function(e){this.Ls=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ka.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Os()];case 2:return a.db=t.sent(),e=Pa.open(a.db,s?"readonly":"readwrite",h),n=c(e).catch(function(t){return e.abort(t),sa.reject(t)}).vn(),r={},n.catch(function(){}),[4,e.Bs];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,xr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ka.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ka),Aa=(Object.defineProperty(Sa.prototype,"gn",{get:function(){return this.Qs},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"js",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"cursor",{set:function(t){this.Us=t},enumerable:!1,configurable:!0}),Sa.prototype.done=function(){this.Qs=!0},Sa.prototype.Ks=function(t){this.Ws=t},Sa.prototype.delete=function(){return Ua(this.Us.delete())},Sa),_a=(n(Da,Ia=Jr),Da);function Da(t){var e=this;return(e=Ia.call(this,$r.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Sa(t){this.Us=t,this.Qs=!1,this.Ws=null}function ka(t,e,n){this.name=t,this.version=e,this.Cs=n,12.2===ka.Ns(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function xa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Es=t,this.Is=e,this.ms=n,this.As=r,this.Rs=i,this.Ps=0,this.Vs=null,this.gs=Date.now(),this.reset()}function Oa(t){return"IndexedDbTransactionError"===t.name}var Pa=(Ca.open=function(t,e,n){try{return new Ca(t.transaction(n,e))}catch(t){throw new _a(t)}},Object.defineProperty(Ca.prototype,"Bs",{get:function(){return this.Gs.promise},enumerable:!1,configurable:!0}),Ca.prototype.abort=function(t){t&&this.Gs.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ca.prototype.store=function(t){var e=this.transaction.objectStore(t);return new La(e)},Ca),La=(Ra.prototype.put=function(t,e){var n=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ua(n)},Ra.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),Ua(this.store.add(t))},Ra.prototype.get=function(e){var n=this;return Ua(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Ra.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),Ua(this.store.delete(t))},Ra.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),Ua(this.store.count())},Ra.prototype.zs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Hs(n,function(t,e){r.push(e)}).next(function(){return r})},Ra.prototype.Ys=function(t,e){xr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Js=!1;var r=this.cursor(n);return this.Hs(r,function(t,e,n){return n.delete()})},Ra.prototype.Xs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Hs(r,e)},Ra.prototype.Zs=function(i){var t=this.cursor({});return new sa(function(n,r){t.onerror=function(t){var e=Ma(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ra.prototype.Hs=function(t,s){var u=[];return new sa(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Aa(i),(n=s(i.primaryKey,i.value,e))instanceof sa&&(r=n.catch(function(t){return e.done(),sa.reject(t)}),u.push(r)),e.gn?o():null===e.js?i.continue():i.continue(e.js)):o()}}).next(function(){return sa.Dn(u)})},Ra.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ra.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Js?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ra);function Ra(t){this.store=t}function Ca(t){var n=this;this.transaction=t,this.aborted=!1,this.Gs=new Ea,this.transaction.oncomplete=function(){n.Gs.resolve()},this.transaction.onabort=function(){t.error?n.Gs.reject(new _a(t.error)):n.Gs.resolve()},this.transaction.onerror=function(t){var e=Ma(t.target.error);n.Gs.reject(new _a(e))}}function Ua(t){return new sa(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ma(t.target.error);r(e)}})}var Va=!1;function Ma(t){var e=Na.Ns(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Va||(Va=!0,setTimeout(function(){throw r},0)),r}}return t}function Fa(){return"undefined"!=typeof window?window:null}function ja(){return"undefined"!=typeof document?document:null}var qa=(za.ii=function(t,e,n,r,i){var o=new za(t,e,Date.now()+n,r,i);return o.start(n),o},za.prototype.start=function(t){var e=this;this.ri=setTimeout(function(){return e.oi()},t)},za.prototype.Ds=function(){return this.oi()},za.prototype.cancel=function(t){null!==this.ri&&(this.clearTimeout(),this.si.reject(new Jr($r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},za.prototype.oi=function(){var e=this;this.ti.hi(function(){return null!==e.ri?(e.clearTimeout(),e.op().then(function(t){return e.si.resolve(t)})):Promise.resolve()})},za.prototype.clearTimeout=function(){null!==this.ri&&(this.ni(this),clearTimeout(this.ri),this.ri=null)},za),Ga=(Object.defineProperty(Ba.prototype,"Ei",{get:function(){return this.ci},enumerable:!1,configurable:!0}),Ba.prototype.hi=function(t){this.enqueue(t)},Ba.prototype.Ii=function(t){this.mi(),this.Ai(t)},Ba.prototype.Ri=function(t){return this.mi(),this.Ai(t)},Ba.prototype.Pi=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.mi(),this.ci?[3,2]:(this.ci=!0,(e=ja())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ti),[4,this.Ri(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ba.prototype.enqueue=function(t){return this.mi(),this.ci?new Promise(function(t){}):this.Ai(t)},Ba.prototype.Vi=function(t){var e=this;this.ui.push(t),this.hi(function(){return e.gi()})},Ba.prototype.gi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ui.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ui[0]()];case 2:return t.sent(),this.ui.shift(),this.wi.reset(),[3,4];case 3:if(!Oa(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ui.length&&this.wi.ps(function(){return n.gi()}),t.label=5;case 5:return[2]}})})},Ba.prototype.Ai=function(t){var r=this,e=this.ai.then(function(){return r.fi=!0,t().catch(function(t){throw r._i=t,r.fi=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.fi=!1,t})});return this.ai=e},Ba.prototype.vs=function(t,e,n){var r=this;this.mi(),-1<this.di.indexOf(t)&&(e=0);var i=qa.ii(this,t,e,n,function(t){return r.yi(t)});return this.li.push(i),i},Ba.prototype.mi=function(){this._i&&Rr()},Ba.prototype.pi=function(){},Ba.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ai];case 1:t.sent(),t.label=2;case 2:if(e!==this.ai)return[3,0];t.label=3;case 3:return[2]}})})},Ba.prototype.vi=function(t){for(var e=0,n=this.li;e<n.length;e++)if(n[e].Is===t)return!0;return!1},Ba.prototype.Si=function(r){var i=this;return this.bi().then(function(){i.li.sort(function(t,e){return t.ei-e.ei});for(var t=0,e=i.li;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.Is===r)break}return i.bi()})},Ba.prototype.Di=function(t){this.di.push(t)},Ba.prototype.yi=function(t){var e=this.li.indexOf(t);this.li.splice(e,1)},Ba);function Ba(){var e=this;this.ai=Promise.resolve(),this.ui=[],this.ci=!1,this.li=[],this._i=null,this.fi=!1,this.di=[],this.wi=new Ta(this,"async_queue_retry"),this.Ti=function(){var t=ja();t&&xr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.wi.Ss()};var t=ja();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ti)}function za(t,e,n,r,i){this.ti=t,this.Is=e,this.ei=n,this.op=r,this.ni=i,this.si=new Ea,this.then=this.si.promise.then.bind(this.si.promise),this.si.promise.catch(function(t){})}function Ka(t,e){if(Or("AsyncQueue",e+": "+t),Oa(t))return new Jr($r.UNAVAILABLE,e+": "+t);throw t}function Xa(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Mr(n,i);return 0===s?Mr(r,o):s}var Ha=($a.prototype.Fi=function(){return++this.Ni},$a.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Xa(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty($a.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),$a),Wa={$i:!1,xi:0,Mi:0,Oi:0},Qa=(Ya.Ui=function(t){return new Ya(t,Ya.Qi,Ya.Wi)},Ya);function Ya(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function $a(t){this.Ci=t,this.buffer=new Mi(Xa),this.Ni=0}Qa.ji=-1,Qa.Ki=1048576,Qa.Gi=41943040,Qa.Qi=10,Qa.Wi=1e3,Qa.zi=new Qa(Qa.Gi,Qa.Qi,Qa.Wi),Qa.Hi=new Qa(Qa.ji,0,0);var Ja=(eh.prototype.start=function(t){this.Yi.params.Li!==Qa.ji&&this.Zi(t)},eh.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(eh.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),eh.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ti.vs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return Oa(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Nc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},eh),Za=(th.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},th.prototype.rr=function(t,e){var n=this;if(0===e)return sa.resolve(la.Ts);var r=new Ha(e);return this.nr.pe(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},th.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},th.prototype.ar=function(t,e){return this.nr.ar(t,e)},th.prototype.ur=function(e,n){var r=this;return this.params.Li===Qa.ji?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),sa.resolve(Wa)):this.cr(e).next(function(t){return t<r.params.Li?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Wa):r.lr(e,n)})},th.prototype.cr=function(t){return this.nr.cr(t)},th.prototype.lr=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>c.params.Bi?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Bi+" from "+t),c.params.Bi):t,s=Date.now(),c.rr(e,i)}).next(function(t){return r=t,u=Date.now(),c.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.ar(e,r)}).next(function(t){return h=Date.now(),kr()<=l.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),sa.resolve({$i:!0,xi:i,Mi:o,Oi:t})})},th);function th(t,e){this.nr=t,this.params=e}function eh(t,e){this.Yi=t,this.ti=e,this.Ji=!1,this.Xi=null}function nh(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=rh(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return rh(e)}function rh(t){return t+""}function ih(t){var e=t.length;if(Cr(2<=e),2===e)return Cr(""===t.charAt(0)&&""===t.charAt(1)),ni.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Rr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Rr()}o=s+2}return new ni(r)}var oh=function(t){this._r=t};function sh(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=zo(n,r.name),s=jo(r.updateTime),u=new Ys({mapValue:{fields:r.fields}}),new su(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=oi.j(e.noDocument.path),h=fh(e.noDocument.readTime);return new uu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=oi.j(e.unknownDocument.path),f=fh(e.unknownDocument.version);return new au(c,f)}return Rr()}function uh(t,e,n){var r,i,o=ah(n),s=e.key.path.p().N();if(e instanceof su){var u={name:Bo(r=t._r,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Mo(r,i.version.A())},a=e.hasCommittedMutations;return new zh(null,null,u,a,o,s)}if(e instanceof uu){var h=e.key.path.N(),c=ch(e.version),f=e.hasCommittedMutations;return new zh(null,new Gh(h,c),null,f,o,s)}if(e instanceof au){var l=e.key.path.N(),p=ch(e.version);return new zh(new Bh(l,p),null,null,!0,o,s)}return Rr()}function ah(t){var e=t.A();return[e.seconds,e.nanoseconds]}function hh(t){var e=new Zr(t[0],t[1]);return ti.I(e)}function ch(t){var e=t.A();return new Lh(e.seconds,e.nanoseconds)}function fh(t){var e=new Zr(t.seconds,t.nanoseconds);return ti.I(e)}function lh(e,t){var n=(t.baseMutations||[]).map(function(t){return $o(e._r,t)}),r=t.mutations.map(function(t){return $o(e._r,t)}),i=Zr.fromMillis(t.localWriteTimeMs);return new ia(t.batchId,i,n,r)}function ph(t){var e,n=fh(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?fh(t.lastLimboFreeSnapshotVersion):ti.min(),i=void 0!==t.query.documents?(Cr(1===(e=t.query).documents.length),wu(vu(Xo(e.documents[0])))):function(t){var e,n=Xo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Cr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return ku.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=rs(t.unaryFilter.field);return ku.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=rs(t.unaryFilter.field);return ku.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,ku.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ra(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(a=r.limit,c=di(h="object"==typeof a?a.value:a)?null:h);var f=null;r.startAt&&(f=es(r.startAt));var l=null;return r.endAt&&(l=es(r.endAt)),wu(yu(n,o,u,s,c,"F",f,l))}(t.query);return new Di(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ii.fromBase64String(t.resumeToken))}function dh(t,e){var n=ch(e.X),r=ch(e.lastLimboFreeSnapshotVersion),i=(Ei(e.target)?Jo:Zo)(t._r,e.target),o=e.resumeToken.toBase64();return new Xh(e.targetId,wi(e.target),n,o,e.sequenceNumber,r,i)}var yh=(vh.Tr=function(t,e,n,r){return Cr(""!==t.uid),new vh(t.Er()?t.uid:"",e,n,r)},vh.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).Xs({index:Fh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},vh.prototype.mr=function(d,y,v,g){var m=this,w=bh(d),b=wh(d);return b.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new ia(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Yo(e._r,t)}),o=r.mutations.map(function(t){return Yo(e._r,t)}),new Fh(n,r.batchId,r.wn.toMillis(),i,o)),a=[],h=new Mi(function(t,e){return Mr(t.F(),e.F())}),c=0,f=g;c<f.length;c++){var l=f[c],p=jh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,jh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Gn.Ar(d,t))}),d.Qn(function(){m.wr[t]=s.keys()}),sa.Dn(a).next(function(){return s})})},vh.prototype.Rr=function(t,e){var n=this;return wh(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),lh(n.serializer,t)):null})},vh.prototype.Pr=function(t,n){var r=this;return this.wr[n]?sa.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},vh.prototype.Vr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return wh(t).Xs({index:Fh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=lh(r.serializer,e)),n.done()}).next(function(){return o})},vh.prototype.gr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return wh(t).Xs({index:Fh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},vh.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).zs(Fh.userMutationsIndex,n).next(function(t){return t.map(function(t){return lh(e.serializer,t)})})},vh.prototype.Hn=function(u,a){var h=this,t=jh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return bh(u).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);if(r===h.userId&&a.path.isEqual(s))return wh(u).get(o).next(function(t){if(!t)throw Rr();Cr(t.userId===h.userId),c.push(lh(h.serializer,t))});n.done()}).next(function(){return c})},vh.prototype.ts=function(r,t){var a=this,h=new Mi(Mr),i=[];return t.forEach(function(u){var t=jh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=bh(r).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),sa.Dn(i).next(function(){return a.pr(r,h)})},vh.prototype.hs=function(t,e){var u=this,a=e.path,h=a.length+1,n=jh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Mi(Mr);return bh(t).Xs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.pr(t,c)})},vh.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(wh(e).get(t).next(function(t){if(null===t)throw Rr();Cr(t.userId===n.userId),r.push(lh(n.serializer,t))}))}),sa.Dn(i).next(function(){return r})},vh.prototype.br=function(e,n){var r=this;return mh(e.vr,this.userId,n).next(function(t){return e.Qn(function(){r.Sr(n.batchId)}),sa.forEach(t,function(t){return r.dr.Dr(e,t)})})},vh.prototype.Sr=function(t){delete this.wr[t]},vh.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return sa.resolve();var e=IDBKeyRange.lowerBound(jh.prefixForUser(o.userId)),i=[];return bh(n).Xs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=ih(t[1]),i.push(r)):n.done()}).next(function(){Cr(0===i.length)})})},vh.prototype.Nr=function(t,e){return gh(t,this.userId,e)},vh.prototype.Fr=function(t){var e=this;return Eh(t).get(this.userId).next(function(t){return t||new Mh(e.userId,-1,"")})},vh);function vh(t,e,n,r){this.userId=t,this.serializer=e,this.Gn=n,this.dr=r,this.wr={}}function gh(t,o,e){var n=jh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return bh(t).Xs({range:r,Js:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function mh(t,e,n){var r=t.store(Fh.store),i=t.store(jh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Xs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Cr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=jh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return sa.Dn(o).next(function(){return h})}function wh(t){return lc.Ms(t,Fh.store)}function bh(t){return lc.Ms(t,jh.store)}function Eh(t){return lc.Ms(t,Mh.store)}var Ih,Th=(Nh.prototype.$n=function(t,e,n){return _h(t).put(Dh(e),n)},Nh.prototype.Mn=function(t,e){var n=_h(t),r=Dh(e);return n.delete(r)},Nh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Nh.prototype.On=function(t,e){var n=this;return _h(t).get(Dh(e)).next(function(t){return n.$r(t)})},Nh.prototype.xr=function(t,e){var n=this;return _h(t).get(Dh(e)).next(function(t){var e=n.$r(t);return e?{Mr:e,size:Sh(t)}:null})},Nh.prototype.getEntries=function(t,e){var r=this,i=ji;return this.Or(t,e,function(t,e){var n=r.$r(e);i=i.nt(t,n)}).next(function(){return i})},Nh.prototype.Lr=function(t,e){var r=this,i=ji,o=new Oi(oi.P);return this.Or(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.nt(t,n),o.nt(t,Sh(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{qr:i,Br:o}})},Nh.prototype.Or=function(t,e,i){if(e._())return sa.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.at(),s=o.dt();return _h(t).Xs({range:n},function(t,e,n){for(var r=oi.j(t);s&&oi.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.Ks(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Nh.prototype.es=function(t,i,e){var n,r,o,s=this,u=Bi,a=i.path.length+1,h={};return e.isEqual(ti.min())?(n=i.path.N(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=ah(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=zh.collectionReadTimeIndex),_h(t).Xs(h,function(t,e,n){var r;t.length===a&&(r=sh(s.serializer,e),i.path.D(r.key.path)?r instanceof su&&_u(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Nh.prototype.Ur=function(t,e){var r=this,i=ji,o=ah(e),n=_h(t),s=IDBKeyRange.lowerBound(o,!0);return n.Xs({index:zh.readTimeIndex,range:s},function(t,e){var n=sh(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:hh(o)}})},Nh.prototype.Wr=function(t){var e=_h(t),r=ti.min();return e.Xs({index:zh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=hh(e.readTime)),n.done()}).next(function(){return r})},Nh.prototype.jr=function(t){return new Nh.Kr(this,!!t&&t.Gr)},Nh.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Nh.prototype.getMetadata=function(t){return Ah(t).get(Kh.key).next(function(t){return Cr(!!t),t})},Nh.prototype.kr=function(t,e){return Ah(t).put(Kh.key,e)},Nh.prototype.$r=function(t){if(t){var e=sh(this.serializer,t);return e instanceof uu&&e.version.isEqual(ti.min())?null:e}return null},Nh);function Nh(t,e){this.serializer=t,this.Gn=e}function Ah(t){return lc.Ms(t,Kh.store)}function _h(t){return lc.Ms(t,zh.store)}function Dh(t){return t.path.N()}function Sh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}function kh(t,e){var n=this;return(n=Ih.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Th.Kr=(n(kh,Ih=ua),kh.prototype.Bn=function(s){var u=this,a=[],h=0,c=new Mi(function(t,e){return Mr(t.F(),e.F())});return this.Nn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=uh(u.Hr.serializer,e,u.readTime),c=c.add(t.path.p()),r=Sh(n),h+=r-o,a.push(u.Hr.$n(s,t,n))):(h-=o,u.Gr?(i=uh(u.Hr.serializer,new uu(t,ti.min()),u.readTime),a.push(u.Hr.$n(s,t,i))):a.push(u.Hr.Mn(s,t)))}),c.forEach(function(t){a.push(u.Hr.Gn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,h)),sa.Dn(a)},kh.prototype.Ln=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Mr)})},kh.prototype.qn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},kh);var xh=(Vh.prototype.Ar=function(t,e){return this.Jr.add(e),sa.resolve()},Vh.prototype.os=function(t,e){return sa.resolve(this.Jr.getEntries(e))},Vh),Oh=(Uh.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Mi(ni.P),i=!r.has(n);return this.index[e]=r.add(n),i},Uh.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Uh.prototype.getEntries=function(t){return(this.index[t]||new Mi(ni.P)).N()},Uh),Ph=(Ch.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Cr(t<e&&0<=t&&e<=10);var o,s=new Pa(r);t<1&&1<=e&&(n.createObjectStore(Rh.store),(o=n).createObjectStore(Mh.store,{keyPath:Mh.keyPath}),o.createObjectStore(Fh.store,{keyPath:Fh.keyPath,autoIncrement:!0}).createIndex(Fh.userMutationsIndex,Fh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(jh.store),Yh(n),n.createObjectStore(zh.store));var u,a=sa.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Hh.store),u.deleteObjectStore(Xh.store),u.deleteObjectStore(Wh.store),Yh(n)),a=a.next(function(){return t=s.store(Wh.store),e=new Wh(0,0,ti.min().A(),0),t.put(Wh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Fh.store).zs().next(function(t){r.deleteObjectStore(Fh.store),r.createObjectStore(Fh.store,{keyPath:Fh.keyPath,autoIncrement:!0}).createIndex(Fh.userMutationsIndex,Fh.userMutationsKeyPath,{unique:!0});var e=i.store(Fh.store),n=t.map(function(t){return e.put(t)});return sa.Dn(n)});var r,i})),a=a.next(function(){n.createObjectStore($h.store,{keyPath:$h.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Kh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(zh.store)).createIndex(zh.readTimeIndex,zh.readTimeIndexPath,{unique:!1}),t.createIndex(zh.collectionReadTimeIndex,zh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Ch.prototype.addDocumentGlobal=function(e){var n=0;return e.store(zh.store).Xs(function(t,e){n+=Sh(e)}).next(function(){var t=new Kh(n);return e.store(Kh.store).put(Kh.key,t)})},Ch.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Mh.store),e=r.store(Fh.store);return t.zs().next(function(t){return sa.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.zs(Fh.userMutationsIndex,t).next(function(t){return sa.forEach(t,function(t){Cr(t.userId===n.userId);var e=lh(i.serializer,t);return mh(r,n.userId,e).next(function(){})})})})})},Ch.prototype.ensureSequenceNumbers=function(t){var s=t.store(Hh.store),e=t.store(zh.store);return t.store(Wh.store).get(Wh.key).next(function(i){var o=[];return e.Xs(function(t,e){var n=new ni(t),r=[0,nh(n)];o.push(s.get(r).next(function(t){return t?sa.resolve():s.put(new Hh(0,nh(n),i.highestListenSequenceNumber))}))}).next(function(){return sa.Dn(o)})})},Ch.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:nh(n)})}}t.createObjectStore(Qh.store,{keyPath:Qh.keyPath});var r=e.store(Qh.store),o=new Oh;return e.store(zh.store).Xs({Js:!0},function(t,e){var n=new ni(t);return i(n.p())}).next(function(){return e.store(jh.store).Xs({Js:!0},function(t,e){t[0];var n=t[1],r=(t[2],ih(n));return i(r.p())})})},Ch.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Xh.store);return o.Xs(function(t,e){var n=ph(e),r=dh(i.serializer,n);return o.put(r)})},Ch),Lh=function(t,e){this.seconds=t,this.nanoseconds=e},Rh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ch(t){this.serializer=t}function Uh(){this.index={}}function Vh(){this.Jr=new Oh}Rh.store="owner",Rh.key="owner";var Mh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Mh.store="mutationQueues",Mh.keyPath="userId";var Fh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Fh.store="mutations",Fh.keyPath="batchId",Fh.userMutationsIndex="userMutationsIndex",Fh.userMutationsKeyPath=["userId","batchId"];var jh=(qh.prefixForUser=function(t){return[t]},qh.prefixForPath=function(t,e){return[t,nh(e)]},qh.key=function(t,e,n){return[t,nh(e),n]},qh);function qh(){}jh.store="documentMutations",jh.PLACEHOLDER=new jh;var Gh=function(t,e){this.path=t,this.readTime=e},Bh=function(t,e){this.path=t,this.version=e},zh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zh.store="remoteDocuments",zh.readTimeIndex="readTimeIndex",zh.readTimeIndexPath="readTime",zh.collectionReadTimeIndex="collectionReadTimeIndex",zh.collectionReadTimeIndexPath=["parentPath","readTime"];var Kh=function(t){this.byteSize=t};Kh.store="remoteDocumentGlobal",Kh.key="remoteDocumentGlobalKey";var Xh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xh.store="targets",Xh.keyPath="targetId",Xh.queryTargetsIndexName="queryTargetsIndex",Xh.queryTargetsKeyPath=["canonicalId","targetId"];var Hh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Hh.store="targetDocuments",Hh.keyPath=["targetId","path"],Hh.documentTargetsIndex="documentTargetsIndex",Hh.documentTargetsKeyPath=["path","targetId"];var Wh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Wh.key="targetGlobalKey",Wh.store="targetGlobal";var Qh=function(t,e){this.collectionId=t,this.parent=e};function Yh(t){t.createObjectStore(Hh.store,{keyPath:Hh.keyPath}).createIndex(Hh.documentTargetsIndex,Hh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xh.store,{keyPath:Xh.keyPath}).createIndex(Xh.queryTargetsIndexName,Xh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Wh.store)}Qh.store="collectionParents",Qh.keyPath=["collectionId","parent"];var $h=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};$h.store="clientMetadata",$h.keyPath="clientId";var Jh=i(i(i([Mh.store,Fh.store,jh.store,zh.store,Xh.store,Rh.store,Wh.store,Hh.store],[$h.store]),[Kh.store]),[Qh.store]),Zh=(tc.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return sa.resolve();var r=e.S(),i=e.p();t.Qn(function(){n.Xr.add(e)});var o={collectionId:r,parent:nh(i)};return ec(t).put(o)},tc.prototype.os=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[jr(i),""],!1,!0);return ec(t).zs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ih(r.parent))}return o})},tc);function tc(){this.Xr=new Oh}function ec(t){return lc.Ms(t,Qh.store)}var nc=(oc.prototype.next=function(){return this.Zr+=2,this.Zr},oc.to=function(){return new oc(0)},oc.eo=function(){return new oc(-1)},oc),rc=(ic.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new nc(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},ic.prototype.ro=function(t){return this.so(t).next(function(t){return ti.I(new Zr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ic.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},ic.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},ic.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},ic.prototype.lo=function(t,e){return this.uo(t,e)},ic.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return sc(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.io(e,t)})},ic.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return sc(r).Xs(function(t,e){var n=ph(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return sa.Dn(a)}).next(function(){return u})},ic.prototype.pe=function(t,r){return sc(t).Xs(function(t,e){var n=ph(e);r(n)})},ic.prototype.so=function(t){return uc(t).get(Wh.key).next(function(t){return Cr(null!==t),t})},ic.prototype.io=function(t,e){return uc(t).put(Wh.key,e)},ic.prototype.uo=function(t,e){return sc(t).put(dh(this.serializer,e))},ic.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ic.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},ic.prototype.wo=function(t,i){var e=wi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return sc(t).Xs({range:n,index:Xh.queryTargetsIndexName},function(t,e,n){var r=ph(e);bi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},ic.prototype.To=function(n,t,r){var i=this,o=[],s=ac(n);return t.forEach(function(t){var e=nh(t.path);o.push(s.put(new Hh(r,e))),o.push(i.dr.Eo(n,r,t))}),sa.Dn(o)},ic.prototype.Io=function(n,t,r){var i=this,o=ac(n);return sa.forEach(t,function(t){var e=nh(t.path);return sa.Dn([o.delete([r,e]),i.dr.mo(n,r,t)])})},ic.prototype.fo=function(t,e){var n=ac(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ic.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ac(t),o=Xi();return r.Xs({range:n,Js:!0},function(t,e,n){var r=ih(t[1]),i=new oi(r);o=o.add(i)}).next(function(){return o})},ic.prototype.Nr=function(t,e){var n=nh(e.path),r=IDBKeyRange.bound([n],[jr(n)],!1,!0),i=0;return ac(t).Xs({index:Hh.documentTargetsIndex,Js:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ic.prototype.Me=function(t,e){return sc(t).get(e).next(function(t){return t?ph(t):null})},ic);function ic(t,e){this.dr=t,this.serializer=e}function oc(t){this.Zr=t}function sc(t){return lc.Ms(t,Xh.store)}function uc(t){return lc.Ms(t,Wh.store)}function ac(t){return lc.Ms(t,Hh.store)}var hc,cc="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fc=(n(dc,hc=ha),dc),lc=(pc.Ms=function(t,e){if(t instanceof fc)return Na.Ms(t.vr,e);throw Rr()},pc.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Jr($r.FAILED_PRECONDITION,cc);return e.Mo(),e.Oo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new la(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},pc.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},pc.prototype.Bo=function(n){var t=this;this.Fo.qs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},pc.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Es.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},pc.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return vc(e).put(new $h(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Es.Vi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(Oa(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Es.Vi(function(){return n.Co(t)}),n.isPrimary=t})},pc.prototype.Qo=function(t){var e=this;return yc(t).get(Rh.key).next(function(t){return sa.resolve(e.Go(t))})},pc.prototype.zo=function(t){return vc(t).delete(this.clientId)},pc.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=pc.Ms(t,$h.store);return r.zs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return sa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},pc.prototype.Lo=function(){var t=this;this.So=this.Es.vs("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},pc.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},pc.prototype.Wo=function(e){var i=this;return this.Vo?sa.resolve(!0):yc(e).get(Rh.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new Jr($r.FAILED_PRECONDITION,cc);return!1}}return!(!i.networkEnabled||!i.inForeground)||vc(e).zs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},pc.prototype.th=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.jo(t).next(function(){return e.zo(t)})}).catch(function(t){xr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},pc.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},pc.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return vc(t).zs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(pc.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),pc.prototype.oh=function(t){return yh.Tr(t,this.serializer,this.Gn,this.dr)},pc.prototype.hh=function(){return this.ko},pc.prototype.ah=function(){return this.jn},pc.prototype.uh=function(){return this.Gn},pc.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Jh,function(t){return o=new fc(t,i.yo?i.yo.next():la.Ts),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Es.Vi(function(){return i.Co(!1)}),new Jr($r.FAILED_PRECONDITION,aa);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},pc.prototype.lh=function(t){var e=this;return yc(t).get(Rh.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Jr($r.FAILED_PRECONDITION,cc)})},pc.prototype.Ko=function(t){var e=new Rh(this.clientId,this.allowTabSynchronization,Date.now());return yc(t).put(Rh.key,e)},pc.Fs=function(){return Na.Fs()},pc.prototype.jo=function(t){var e=this,n=yc(t);return n.get(Rh.key).next(function(t){return e.Go(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(Rh.key)):sa.resolve()})},pc.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},pc.prototype.Mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Es.hi(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},pc.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},pc.prototype.Oo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Es.hi(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},pc.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},pc.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},pc.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},pc.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},pc.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},pc);function pc(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Es=i,this.window=o,this.document=s,this.Po=a,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!pc.Fs())throw new Jr($r.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new gc(this,r),this.No=e+"main",this.serializer=new oh(u),this.Fo=new Na(this.No,10,new Ph(this.serializer)),this.ko=new rc(this.dr,this.serializer),this.Gn=new Zh,this.jn=new Th(this.serializer,this.Gn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===h&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function dc(t,e){var n=this;return(n=hc.call(this)||this).vr=t,n.Ro=e,n}function yc(t){return lc.Ms(t,Rh.store)}function vc(t){return lc.Ms(t,$h.store)}var gc=(mc.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},mc.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},mc.prototype.pe=function(t,e){return this.db.hh().pe(t,e)},mc.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},mc.prototype.Eo=function(t,e,n){return wc(t,n)},mc.prototype.mo=function(t,e,n){return wc(t,n)},mc.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},mc.prototype.Dr=wc,mc.prototype.dh=function(t,e){return r=e,i=!1,Eh(n=t).Zs(function(t){return gh(n,t,r).next(function(t){return t&&(i=!0),sa.resolve(!t)})}).next(function(){return i});var n,r,i},mc.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.On(r,e).next(function(){return s.Mn(e),ac(r).delete([0,nh(e.path)])})}),u.push(n))}).next(function(){return sa.Dn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},mc.prototype.removeTarget=function(t,e){var n=e.Z(t.Ro);return this.db.hh().lo(t,n)},mc.prototype.wh=wc,mc.prototype.fh=function(t,o){var s,e=ac(t),u=la.Ts;return e.Xs({index:Hh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==la.Ts&&o(new oi(ih(s)),u),u=i,s=r):u=la.Ts}).next(function(){u!==la.Ts&&o(new oi(ih(s)),u)})},mc.prototype.cr=function(t){return this.db.ah().zr(t)},mc);function mc(t,e){this.db=t,this.Yi=new Za(this,e)}function wc(t,e){return ac(t).put((n=t.Ro,new Hh(0,nh(e.path),n)));var n}function bc(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ec=(Ic.prototype.Vh=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Kn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Kn.yr(v).next(function(t){return g=t,e=r.persistence.oh(i),m=new ca(r.Ah,e,r.persistence.uh()),e.yr(v)}).next(function(t){for(var e=[],n=[],r=Xi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xn(v,r).next(function(t){return{gh:t,yh:e,ph:n}})})})];case 1:return n=t.sent(),[2,(this.Kn=e,this.Rh=m,this.Th.Ph(this.Rh),n)]}})})},Ic.prototype.bh=function(h){var c,f=this,l=Zr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Xi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Xn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Bs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof su?t.field(i.field):void 0,s=ss(i.transform,o||null);null!=s&&(e=null==e?(new $s).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Ms(o.key,s,function u(t){var a=[];return Kr(t.fields||{},function(t,e){var n=new ii([t]);if(Oo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ts(a)}(s.proto.mapValue),Ds.exists(!0)))}return f.Kn.mr(a,l,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Nn:e}})},Ic.prototype.vh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ah.jr({Gr:!0});return i.Sh(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Kn.Cr(t)}).next(function(){return i.Rh.Xn(t,e)})})},Ic.prototype.Dh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Kn.Rr(e,t).next(function(t){return Cr(null!==t),n=t.keys(),r.Kn.br(e,t)}).next(function(){return r.Kn.Cr(e)}).next(function(){return r.Rh.Xn(e,n)})})},Ic.prototype.gr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Kn.gr(t)})},Ic.prototype.ro=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})},Ic.prototype.Ch=function(a){var h=this,c=a.X,f=this.Eh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ah.jr({Gr:!0});f=h.Eh;var s=[];a.Qt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.ko.Io(o,t.Xt,e).next(function(){return h.ko.To(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Ro),f=f.nt(e,r),Ic.Nh(i,r,t)&&s.push(h.ko.lo(o,r))))});var t,u=ji,n=Xi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof uu&&e.version.isEqual(ti.min())?(i.Mn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.$n(e,c),u=u.nt(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.dr.wh(o,t))})})),c.isEqual(ti.min())||(t=h.ko.ro(o).next(function(t){return h.ko.ho(o,o.Ro,c)}),s.push(t)),sa.Dn(s).next(function(){return i.apply(o)}).next(function(){return h.Rh.Zn(o,u)})}).then(function(t){return h.Eh=f,t})},Ic.Nh=function(t,e,n){return Cr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Fh||0<n.Yt.size+n.Jt.size+n.Xt.size},Ic.prototype.kh=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return sa.forEach(c,function(e){return sa.forEach(e.us,function(t){return h.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return sa.forEach(e.cs,function(t){return h.persistence.dr.mo(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Oa(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Eh.get(o),u=s.X,a=s.et(u),this.Eh=this.Eh.nt(o,a));return[2]}})})},Ic.prototype.$h=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Kn.Vr(t,e)})},Ic.prototype.xh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.zn(t,e)})},Ic.prototype.Mh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,sa.resolve(n)):i.ko.no(e).next(function(t){return n=new Di(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.Eh=i.Eh.nt(t.targetId,t),i.Ih.set(r,t.targetId)),t})},Ic.prototype.wo=function(t,e){var n=this.Ih.get(e);return void 0!==n?sa.resolve(this.Eh.get(n)):this.ko.wo(t,e)},Ic.prototype.Oh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.Eh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.dr.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Oa(r=t.sent()))throw r;return xr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.Eh=this.Eh.remove(o),this.Ih.delete(e.target),[2]}})})},Ic.prototype.Lh=function(t,n){var r=this,i=ti.min(),o=Xi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.wo(e,wu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.ko.Ao(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Th.es(e,t,n?i:ti.min(),n?o:Xi())}).next(function(t){return{documents:t,qh:o}})})},Ic.prototype.Sh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=sa.resolve();return n.forEach(function(r){u=u.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Cr(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(r,e,i))&&o.$n(e,i.An)})}),u.next(function(){return e.Kn.br(t,s)})},Ic.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},Ic);function Ic(t,e,n){this.persistence=t,this.Th=e,this.Eh=new Oi(Mr),this.Ih=new Yr(wi,bi),this.mh=ti.min(),this.Kn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new ca(this.Ah,this.Kn,this.persistence.uh()),this.Th.Ph(this.Rh)}function Tc(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Nc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==$r.FAILED_PRECONDITION||e.message!==aa)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}Ec.Fh=3e8;var Ac=(xc.prototype._=function(){return this.Bh._()},xc.prototype.Eo=function(t,e){var n=new _c(t,e);this.Bh=this.Bh.add(n),this.Qh=this.Qh.add(n)},xc.prototype.jh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},xc.prototype.mo=function(t,e){this.Kh(new _c(t,e))},xc.prototype.Gh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},xc.prototype.zh=function(t){var e=this,n=new oi(new ni([])),r=new _c(n,t),i=new _c(n,t+1),o=[];return this.Qh.vt([r,i],function(t){e.Kh(t),o.push(t.key)}),o},xc.prototype.Hh=function(){var e=this;this.Bh.forEach(function(t){return e.Kh(t)})},xc.prototype.Kh=function(t){this.Bh=this.Bh.delete(t),this.Qh=this.Qh.delete(t)},xc.prototype.Yh=function(t){var e=new oi(new ni([])),n=new _c(e,t),r=new _c(e,t+1),i=Xi();return this.Qh.vt([n,r],function(t){i=i.add(t.key)}),i},xc.prototype.Nr=function(t){var e=new _c(t,0),n=this.Bh.Dt(e);return null!==n&&t.isEqual(n.key)},xc),_c=(kc.Uh=function(t,e){return oi.P(t.key,e.key)||Mr(t.Jh,e.Jh)},kc.Wh=function(t,e){return Mr(t.Jh,e.Jh)||oi.P(t.key,e.key)},kc),Dc=(Sc.prototype.Er=function(){return null!=this.uid},Sc.prototype.Xh=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},Sc.prototype.isEqual=function(t){return t.uid===this.uid},Sc);function Sc(t){this.uid=t}function kc(t,e){this.key=t,this.Jh=e}function xc(){this.Bh=new Mi(_c.Uh),this.Qh=new Mi(_c.Wh)}Dc.UNAUTHENTICATED=new Dc(null),Dc.Zh=new Dc("google-credentials-uid"),Dc.ta=new Dc("first-party-uid");function Oc(t,e){this.user=e,this.type="OAuth",this.ea={},this.ea.Authorization="Bearer "+t}var Pc,Lc,Rc,Cc=(tf.prototype.getToken=function(){return Promise.resolve(null)},tf.prototype.sa=function(){},tf.prototype.ia=function(t){(this.na=t)(Dc.UNAUTHENTICATED)},tf.prototype.ra=function(){this.na=null},tf),Uc=(Zc.prototype.getToken=function(){var e=this,n=this.aa,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.aa!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Oc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Zc.prototype.sa=function(){this.forceRefresh=!0},Zc.prototype.ia=function(t){this.na=t,this.ha&&t(this.currentUser)},Zc.prototype.ra=function(){this.auth&&this.auth.removeAuthTokenListener(this.oa),this.oa=null,this.na=null},Zc.prototype.ua=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Dc(t)},Zc),Vc=(Object.defineProperty(Jc.prototype,"ea",{get:function(){var t={"X-Goog-AuthUser":this.la},e=this.ca.auth._a([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Jc),Mc=($c.prototype.getToken=function(){return Promise.resolve(new Vc(this.ca,this.la))},$c.prototype.ia=function(t){t(Dc.ta)},$c.prototype.ra=function(){},$c.prototype.sa=function(){},$c),Fc=(Yc.prototype.Ia=function(){return 1===this.state||2===this.state||4===this.state},Yc.prototype.ma=function(){return 2===this.state},Yc.prototype.start=function(){3!==this.state?this.auth():this.Aa()},Yc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ia()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yc.prototype.Ra=function(){this.state=0,this.wi.reset()},Yc.prototype.Pa=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Es.vs(this.fa,6e4,function(){return t.Va()}))},Yc.prototype.ga=function(t){this.ya(),this.stream.send(t)},Yc.prototype.Va=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Yc.prototype.ya=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Yc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ya(),this.wi.cancel(),this.Ta++,3!==e?this.wi.reset():n&&n.code===$r.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.wi.ys()):n&&n.code===$r.UNAUTHENTICATED&&this.wa.sa(),null!==this.stream&&(this.pa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ba(n)];case 1:return t.sent(),[2]}})})},Yc.prototype.pa=function(){},Yc.prototype.auth=function(){var n=this;this.state=1;var t=this.va(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Sa(t)},function(e){t(function(){var t=new Jr($r.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},Yc.prototype.Sa=function(t){var e=this,n=this.va(this.Ta);this.stream=this.Ca(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.ba(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Yc.prototype.Aa=function(){var t=this;this.state=4,this.wi.ps(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Yc.prototype.Da=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Yc.prototype.va=function(e){var n=this;return function(t){n.Es.hi(function(){return n.Ta===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Yc),jc=(n(Qc,Rc=Fc),Qc.prototype.Ca=function(t){return this.da.Fa("Listen",t)},Qc.prototype.onMessage=function(t){this.wi.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Rr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Cr(void 0===i||"string"==typeof i),Ii.fromBase64String(i||"")):(Cr(void 0===i||i instanceof Uint8Array),Ii.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?$r.UNKNOWN:xi(n.code),new Jr(r,n.message||"")),f=new Yi(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=zo(t,l.document.name),d=jo(l.document.updateTime),y=new Ys({mapValue:{fields:l.document.fields}}),v=new su(p,d,y,{}),g=l.targetIds||[],m=l.removedTargetIds||[];f=new Wi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=zo(t,w.document),E=w.readTime?jo(w.readTime):ti.min(),I=new uu(b,E),T=w.removedTargetIds||[];f=new Wi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var A=zo(t,N.document),_=N.removedTargetIds||[];f=new Wi([],_,A,null)}else{if(!("filter"in e))return Rr();e.filter;var D=e.filter;D.targetId;var S=D.count||0,k=new Ni(S),x=D.targetId;f=new Qi(x,k)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ti.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ti.min():jo(e.readTime)}(t);return this.listener.ka(e,n)},Qc.prototype.$a=function(t){var e,n,r,i,o={};o.database=Ho(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Ei(i)?{documents:Jo(e,i)}:{query:Zo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Fo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ga(o)},Qc.prototype.xa=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.ga(e)},Qc),qc=(n(Wc,Lc=Fc),Object.defineProperty(Wc.prototype,"Oa",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),Wc.prototype.start=function(){this.Ma=!1,this.lastStreamToken=void 0,Lc.prototype.start.call(this)},Wc.prototype.pa=function(){this.Ma&&this.La([])},Wc.prototype.Ca=function(t){return this.da.Fa("Write",t)},Wc.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ma){this.wi.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Cr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(ti.min())&&(n=jo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new _s(n,r)}(t,i)})):[]),n=jo(t.commitTime);return this.listener.qa(n,e)}var r,i;return Cr(!t.writeResults||0===t.writeResults.length),this.Ma=!0,this.listener.Ba()},Wc.prototype.Ua=function(){var t={};t.database=Ho(this.serializer),this.ga(t)},Wc.prototype.La=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.ga(n)},Wc),Gc=(n(Hc,Pc=function(){}),Hc.prototype.Wa=function(){if(this.Qa)throw new Jr($r.FAILED_PRECONDITION,"The client has already been terminated.")},Hc.prototype.ja=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.ja(e,n,r,t)}).catch(function(t){throw t.code===$r.UNAUTHENTICATED&&i.credentials.sa(),t})},Hc.prototype.Ka=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.Ka(e,n,r,t)}).catch(function(t){throw t.code===$r.UNAUTHENTICATED&&i.credentials.sa(),t})},Hc.prototype.terminate=function(){this.Qa=!1},Hc),Bc=(Xc.prototype.Ja=function(){var t=this;0===this.za&&(this.Xa("Unknown"),this.Ha=this.ti.vs("online_state_timeout",1e4,function(){return t.Ha=null,t.Za("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Xc.prototype.tu=function(t){"Online"===this.state?this.Xa("Unknown"):(this.za++,1<=this.za&&(this.eu(),this.Za("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Xc.prototype.set=function(t){this.eu(),this.za=0,"Online"===t&&(this.Ya=!1),this.Xa(t)},Xc.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Xc.prototype.Za=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ya?(Or(e),this.Ya=!1):xr("OnlineStateTracker",e)},Xc.prototype.eu=function(){null!==this.Ha&&(this.Ha.cancel(),this.Ha=null)},Xc),zc=(Kc.prototype.start=function(){return this.enableNetwork()},Kc.prototype.enableNetwork=function(){return this.hu.delete(0),this.Ru()},Kc.prototype.Ru=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(this.Pu()?this.Vu():this._u.set("Unknown"),[4,this.gu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(0),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),[2]}})})},Kc.prototype.yu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.Eu.stop()];case 1:return t.sent(),[4,this.fu.stop()];case 2:return t.sent(),0<this.iu.length&&(xr("RemoteStore","Stopping write stream with "+this.iu.length+" pending writes"),this.iu=[]),this.pu(),[2]}})})},Kc.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","RemoteStore shutting down."),this.hu.add(5),[4,this.yu()];case 1:return t.sent(),this.au.th(),this._u.set("Unknown"),[2]}})})},Kc.prototype.listen=function(t){this.ru.has(t.targetId)||(this.ru.set(t.targetId,t),this.Pu()?this.Vu():this.fu.ma()&&this.bu(t))},Kc.prototype.vu=function(t){this.ru.delete(t),this.fu.ma()&&this.Su(t),0===this.ru.size&&(this.fu.ma()?this.fu.Pa():this.cu()&&this._u.set("Unknown"))},Kc.prototype.Me=function(t){return this.ru.get(t)||null},Kc.prototype.xe=function(t){return this.Du.xe(t)},Kc.prototype.bu=function(t){this.ou.de(t.targetId),this.fu.$a(t)},Kc.prototype.Su=function(t){this.ou.de(t),this.fu.xa(t)},Kc.prototype.Vu=function(){this.ou=new ro(this),this.fu.start(),this._u.Ja()},Kc.prototype.Pu=function(){return this.cu()&&!this.fu.Ia()&&0<this.ru.size},Kc.prototype.cu=function(){return 0===this.hu.size},Kc.prototype.pu=function(){this.ou=null},Kc.prototype.du=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.ru.forEach(function(t,e){n.bu(t)}),[2]})})},Kc.prototype.wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.pu(),this.Pu()?(this._u.tu(e),this.Vu()):this._u.set("Unknown"),[2]})})},Kc.prototype.Tu=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this._u.set("Online"),!(i instanceof Yi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Nu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Wi?this.ou.Pe(i):i instanceof Qi?this.ou.De(i):this.ou.ye(i),o.isEqual(ti.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.nu.ro()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Nu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Kc.prototype.Nu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Oa(n))throw n;return this.hu.add(1),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),r=r||function(){return e.nu.ro()},this.ti.Vi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.hu.delete(1),[4,this.Ru()];case 2:return t.sent(),[2]}})})}),[2]}})})},Kc.prototype.ku=function(e){var n=this;return e().catch(function(t){return n.Nu(t,e)})},Kc.prototype.Fu=function(r){var i=this,t=this.ou.Fe(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.ru.get(e))&&i.ru.set(e,n.tt(t.resumeToken,r))}),t.Wt.forEach(function(t){var e,n=i.ru.get(t);n&&(i.ru.set(t,n.tt(Ii.Y,n.X)),i.Su(t),e=new Di(n.target,t,1,n.sequenceNumber),i.bu(e))}),this.Du.Ch(t)},Kc.prototype.Cu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.ru.has(i)?[4,this.Du.$u(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.ru.delete(i),this.ou.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Kc.prototype.gu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.iu.length?this.iu[this.iu.length-1].batchId:-1,t.label=1;case 1:if(!this.xu())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.nu.$h(e)];case 3:return null===(n=t.sent())?(0===this.iu.length&&this.Eu.Pa(),[3,7]):(e=n.batchId,this.Mu(n),[3,6]);case 4:return r=t.sent(),[4,this.Nu(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ou()&&this.Lu(),[2]}})})},Kc.prototype.xu=function(){return this.cu()&&this.iu.length<10},Kc.prototype.qu=function(){return this.iu.length},Kc.prototype.Mu=function(t){this.iu.push(t),this.Eu.ma()&&this.Eu.Oa&&this.Eu.La(t.mutations)},Kc.prototype.Ou=function(){return this.cu()&&!this.Eu.Ia()&&0<this.iu.length},Kc.prototype.Lu=function(){this.Eu.start()},Kc.prototype.Iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Eu.Ua(),[2]})})},Kc.prototype.Au=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.iu;e<n.length;e++)r=n[e],this.Eu.La(r.mutations);return[2]})})},Kc.prototype.qa=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.iu.shift(),n=oa.from(e,i,o),[4,this.ku(function(){return r.Du.Bu(n)})];case 1:return t.sent(),[4,this.gu()];case 2:return t.sent(),[2]}})})},Kc.prototype.mu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.Eu.Oa?[4,this.Uu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ou()&&this.Lu(),[2]}})})},Kc.prototype.Uu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==$r.ABORTED?(e=this.iu.shift(),this.Eu.Ra(),[4,this.ku(function(){return r.Du.Qu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.gu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Kc.prototype.lu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(4),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),this.Eu.Ra(),this.fu.Ra(),this.hu.delete(4),[4,this.Ru()];case 2:return t.sent(),[2]}})})},Kc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ti.pi(),xr("RemoteStore","RemoteStore received new credentials"),this.hu.add(3),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),[4,this.Du.Wu(e)];case 2:return t.sent(),this.hu.delete(3),[4,this.Ru()];case 3:return t.sent(),[2]}})})},Kc.prototype.ju=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.hu.delete(2),[4,this.Ru()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.hu.add(2),[4,this.yu()]);case 3:t.sent(),this._u.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Kc);function Kc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.nu=t,this.su=e,this.ti=n,this.iu=[],this.ru=new Map,this.ou=null,this.hu=new Set,this.au=i,this.au.uu(function(t){n.hi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(xr("RemoteStore","Restarting streams for network reachability change."),[4,this.lu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this._u=new Bc(n,r),this.fu=(h=this.su,c=n,f={Na:this.du.bind(this),ba:this.wu.bind(this),ka:this.Tu.bind(this)},(l=h).Wa(),new jc(c,l.da,l.credentials,l.serializer,f)),this.Eu=(o=this.su,s=n,u={Na:this.Iu.bind(this),ba:this.mu.bind(this),Ba:this.Au.bind(this),qa:this.qa.bind(this)},(a=o).Wa(),new qc(s,a.da,a.credentials,a.serializer,u))}function Xc(t,e){this.ti=t,this.Ga=e,this.state="Unknown",this.za=0,this.Ha=null,this.Ya=!0}function Hc(t,e,n){var r=this;return(r=Pc.call(this)||this).credentials=t,r.da=e,r.serializer=n,r.Qa=!1,r}function Wc(t,e,n,r,i){var o=this;return(o=Lc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ma=!1,o}function Qc(t,e,n,r,i){var o=this;return(o=Rc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Yc(t,e,n,r,i,o){this.Es=t,this.fa=n,this.da=r,this.wa=i,this.listener=o,this.state=0,this.Ta=0,this.Ea=null,this.stream=null,this.wi=new Ta(t,e)}function $c(t,e){this.ca=t,this.la=e}function Jc(t,e){this.ca=t,this.la=e,this.type="FirstParty",this.user=Dc.ta}function Zc(t){var e=this;this.oa=null,this.currentUser=Dc.UNAUTHENTICATED,this.ha=!1,this.aa=0,this.na=null,this.forceRefresh=!1,this.oa=function(){e.aa++,e.currentUser=e.ua(),e.ha=!0,e.na&&e.na(e.currentUser)},this.aa=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oa):(this.oa(null),t.get().then(function(t){e.auth=t,e.oa&&e.auth.addAuthTokenListener(e.oa)},function(){}))}function tf(){this.na=null}function ef(t,e){return"firestore_clients_"+t+"_"+e}function nf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function rf(t,e){return"firestore_targets_"+t+"_"+e}function of(t){this.key=t}function sf(t){this.key=t}function uf(t,e,n){this.query=t,this.targetId=e,this.view=n}function af(t){this.key=t,this.el=!1}var hf=(_f.Ku=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Jr(r.error.code,r.error.message)),i?new _f(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},_f.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},_f),cf=(Af.Ku=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Jr(n.error.code,n.error.message)),r?new Af(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Af.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Af),ff=(Nf.Ku=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Hi,o=0;r&&o<n.activeTargetIds.length;++o)r=vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Nf(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Nf),lf=(Tf.Ku=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Tf(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},Tf),pf=(If.prototype.zu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},If.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},If.prototype.Gu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},If),df=(Ef.Fs=function(t){return!(!t||!t.localStorage)},Ef.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.Du.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Yu&&(o=this.getItem(ef(this.persistenceKey,i)))&&(s=ff.Ku(i,o))&&(this.Zu=this.Zu.nt(s.clientId,s));for(this.hc(),(u=this.storage.getItem(this.oc))&&(a=this.ac(u))&&this.uc(a),h=0,c=this.tc;h<c.length;h++)f=c[h],this.Xu(f);return this.tc=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},Ef.prototype.ws=function(t){this.setItem(this.nc,JSON.stringify(t))},Ef.prototype.cc=function(){return this.lc(this.Zu)},Ef.prototype._c=function(n){var r=!1;return this.Zu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ef.prototype.fc=function(t){this.dc(t,"pending")},Ef.prototype.wc=function(t,e,n){this.dc(t,e,n),this.Tc(t)},Ef.prototype.Ec=function(t){var e,n,r="not-current";return this._c(t)&&(!(e=this.storage.getItem(rf(this.persistenceKey,t)))||(n=cf.Ku(t,e))&&(r=n.state)),this.Ic.zu(t),this.hc(),r},Ef.prototype.mc=function(t){this.Ic.Hu(t),this.hc()},Ef.prototype.Ac=function(t){return this.Ic.activeTargetIds.has(t)},Ef.prototype.Rc=function(t){this.removeItem(rf(this.persistenceKey,t))},Ef.prototype.Pc=function(t,e,n){this.Vc(t,e,n)},Ef.prototype.Vh=function(t,e,n){var r=this;e.forEach(function(t){r.Tc(t)}),this.currentUser=t,n.forEach(function(t){r.fc(t)})},Ef.prototype.gc=function(t){this.yc(t)},Ef.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.Ju),this.removeItem(this.ec),this.tr=!1)},Ef.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},Ef.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ef.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ef.prototype.Xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(xr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.ec)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Es.Vi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.sc.test(u.key)){if(null==u.newValue)return e=this.pc(u.key),[2,this.bc(e,null)];if(n=this.vc(u.key,u.newValue))return[2,this.bc(n.clientId,n)]}else if(this.ic.test(u.key)){if(null!==u.newValue&&(r=this.Sc(u.key,u.newValue)))return[2,this.Dc(r)]}else if(this.rc.test(u.key)){if(null!==u.newValue&&(i=this.Cc(u.key,u.newValue)))return[2,this.Nc(i)]}else if(u.key===this.oc){if(null!==u.newValue&&(o=this.ac(u.newValue)))return[2,this.uc(o)]}else u.key===this.nc&&(s=function(t){var e=la.Ts;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==la.Ts&&this._s(s)}else this.tc.push(u);return[2]})})})}},Object.defineProperty(Ef.prototype,"Ic",{get:function(){return this.Zu.get(this.Yu)},enumerable:!1,configurable:!0}),Ef.prototype.hc=function(){this.setItem(this.ec,this.Ic.Gu())},Ef.prototype.dc=function(t,e,n){var r=new hf(this.currentUser,t,e,n),i=nf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Gu())},Ef.prototype.Tc=function(t){var e=nf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Ef.prototype.yc=function(t){var e={clientId:this.Yu,onlineState:t};this.storage.setItem(this.oc,JSON.stringify(e))},Ef.prototype.Vc=function(t,e,n){var r=rf(this.persistenceKey,t),i=new cf(t,e,n);this.setItem(r,i.Gu())},Ef.prototype.pc=function(t){var e=this.sc.exec(t);return e?e[1]:null},Ef.prototype.vc=function(t,e){var n=this.pc(t);return ff.Ku(n,e)},Ef.prototype.Sc=function(t,e){var n=this.ic.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return hf.Ku(new Dc(i),r,e)},Ef.prototype.Cc=function(t,e){var n=this.rc.exec(t),r=Number(n[1]);return cf.Ku(r,e)},Ef.prototype.ac=function(t){return lf.Ku(t)},Ef.prototype.Dc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Du.Fc(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ef.prototype.Nc=function(t){return this.Du.kc(t.targetId,t.state,t.error)},Ef.prototype.bc=function(t,e){var n=this,r=e?this.Zu.nt(t,e):this.Zu.remove(t),i=this.lc(this.Zu),o=this.lc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Du.$c(s,u).then(function(){n.Zu=r})},Ef.prototype.uc=function(t){this.Zu.get(t.clientId)&&this.Ga(t.onlineState)},Ef.prototype.lc=function(t){var n=Hi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},Ef),yf=(bf.prototype.fc=function(t){},bf.prototype.wc=function(t,e,n){},bf.prototype.Ec=function(t){return this.xc.zu(t),this.Mc[t]||"not-current"},bf.prototype.Pc=function(t,e,n){this.Mc[t]=e},bf.prototype.mc=function(t){this.xc.Hu(t)},bf.prototype.Ac=function(t){return this.xc.activeTargetIds.has(t)},bf.prototype.Rc=function(t){delete this.Mc[t]},bf.prototype.cc=function(){return this.xc.activeTargetIds},bf.prototype._c=function(t){return this.xc.activeTargetIds.has(t)},bf.prototype.start=function(){return this.xc=new pf,Promise.resolve()},bf.prototype.Vh=function(t,e,n){},bf.prototype.gc=function(t){},bf.prototype.th=function(){},bf.prototype.ws=function(t){},bf),vf=(Object.defineProperty(wf.prototype,"Qc",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),wf.prototype.Wc=function(t,e){var u=this,a=e?e.jc:new Ji,h=e?e.Uc:this.Uc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof su?e:null)&&(_u(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Kc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Bc(r,p)||d&&u.Bc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{Uc:f,jc:a,Gc:l,Lt:c}},wf.prototype.Kc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},wf.prototype.Bn=function(t,e,n){var o=this,r=this.Uc;this.Uc=t.Uc,this.Lt=t.Lt;var i=t.jc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Bc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.zc(n);var s=e?this.Hc():[],u=0===this.qc.size&&this.Ht?1:0,a=u!==this.Lc;return this.Lc=u,0!==i.length||a?{snapshot:new Zi(this.query,t.Uc,r,i,t.Lt,0==u,a,!1),Yc:s}:{Yc:s}},wf.prototype.Jc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Bn({Uc:this.Uc,jc:new Ji,Lt:this.Lt,Gc:!1},!1)):{Yc:[]}},wf.prototype.Xc=function(t){return!this.Oc.has(t)&&!!this.Uc.has(t)&&!this.Uc.get(t).Ke},wf.prototype.zc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Oc=e.Oc.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Oc=e.Oc.delete(t)}),this.Ht=t.Ht)},wf.prototype.Hc=function(){var e=this;if(!this.Ht)return[];var n=this.qc;this.qc=Xi(),this.Uc.forEach(function(t){e.Xc(t.key)&&(e.qc=e.qc.add(t.key))});var r=[];return n.forEach(function(t){e.qc.has(t)||r.push(new sf(t))}),this.qc.forEach(function(t){n.has(t)||r.push(new of(t))}),r},wf.prototype.Zc=function(t){this.Oc=t.qh,this.qc=Xi();var e=this.Wc(t.documents);return this.Bn(e,!0)},wf.prototype.tl=function(){return Zi.Ut(this.query,this.Uc,this.Lt,0===this.Lc)},wf),gf=(Object.defineProperty(mf.prototype,"Tl",{get:function(){return!0===this.wl},enumerable:!1,configurable:!0}),mf.prototype.subscribe=function(t){this.rl=t},mf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.El("listen()"),(r=this.ol.get(s))?(e=r.targetId,this.sl.Ec(e),n=r.view.tl(),[3,4]):[3,1];case 1:return[4,this.nu.Mh(wu(s))];case 2:return i=t.sent(),o=this.sl.Ec(i.targetId),e=i.targetId,[4,this.Il(s,e,"current"===o)];case 3:n=t.sent(),this.Tl&&this.nl.listen(i),t.label=4;case 4:return[2,n]}})})},mf.prototype.Il=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.nu.Lh(u,!0)];case 1:return e=t.sent(),n=new vf(u,e.qh),r=n.Wc(e.documents),i=eo.zt(a,h&&"Offline"!==this.onlineState),o=n.Bn(r,this.Tl,i),this.ml(a,o.Yc),s=new uf(u,a,n),[2,(this.ol.set(u,s),this.hl.has(a)?this.hl.get(a).push(u):this.hl.set(a,[u]),o.snapshot)]}})})},mf.prototype.vu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.El("unlisten()"),e=this.ol.get(i),1<(n=this.hl.get(e.targetId)).length?[2,(this.hl.set(e.targetId,n.filter(function(t){return!Tu(t,i)})),void this.ol.delete(i))]:this.Tl?(this.sl.mc(e.targetId),this.sl._c(e.targetId)?[3,2]:[4,this.nu.Oh(e.targetId,!1).then(function(){r.sl.Rc(e.targetId),r.nl.vu(e.targetId),r.Al(e.targetId)}).catch(Nc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Al(e.targetId),[4,this.nu.Oh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},mf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.El("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.nu.bh(i)];case 2:return e=t.sent(),this.sl.fc(e.batchId),this.Rl(e.batchId,o),[4,this.Pl(e.Nn)];case 3:return t.sent(),[4,this.nl.gu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Ka(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},mf.prototype.Ch=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.El("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Ch(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.cl.get(e);n&&(Cr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.el=!0:0<t.Jt.size?Cr(n.el):0<t.Xt.size&&(Cr(n.el),n.el=!1))}),[4,this.Pl(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},mf.prototype.Jc=function(r,t){var i;(this.Tl&&0===t||!this.Tl&&1===t)&&(this.El("applyOnlineStateChange()"),i=[],this.ol.forEach(function(t,e){var n=e.view.Jc(r);n.snapshot&&i.push(n.snapshot)}),this.rl.Vl(r),this.rl.ka(i),this.onlineState=r,this.Tl&&this.sl.gc(r))},mf.prototype.$u=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.El("rejectListens()"),this.sl.Pc(u,"rejected",a),e=this.cl.get(u),(n=e&&e.key)?(r=(r=new Oi(oi.P)).nt(n,new uu(n,ti.min())),i=Xi().add(n),o=new to(ti.min(),new Map,new Mi(Mr),r,i),[4,this.Ch(o)]):[3,2];case 1:return t.sent(),this.ul=this.ul.remove(n),this.cl.delete(u),this.gl(),[3,4];case 2:return[4,this.nu.Oh(u,!1).then(function(){return s.Al(u,a)}).catch(Nc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},mf.prototype.Bu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.El("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.vh(r)];case 2:return n=t.sent(),this.yl(e,null),this.pl(e),this.sl.wc(e,"acknowledged"),[4,this.Pl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},mf.prototype.Qu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.El("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Dh(n)];case 2:return e=t.sent(),this.yl(n,r),this.pl(n),this.sl.wc(n,"rejected",r),[4,this.Pl(e)];case 3:return t.sent(),[3,6];case 4:return[4,Nc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},mf.prototype.bl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.nl.cu()||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.nu.gr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.fl.get(e)||[]).push(o),this.fl.set(e,n),[3,4]);case 3:return r=t.sent(),i=Ka(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},mf.prototype.pl=function(t){(this.fl.get(t)||[]).forEach(function(t){t.resolve()}),this.fl.delete(t)},mf.prototype.vl=function(e){this.fl.forEach(function(t){t.forEach(function(t){t.reject(new Jr($r.CANCELLED,e))})}),this.fl.clear()},mf.prototype.Rl=function(t,e){var n=this._l[this.currentUser.Xh()];n=(n=n||new Oi(Mr)).nt(t,e),this._l[this.currentUser.Xh()]=n},mf.prototype.yl=function(t,e){var n,r=this._l[this.currentUser.Xh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this._l[this.currentUser.Xh()]=r)},mf.prototype.Al=function(t,e){var n=this;void 0===e&&(e=null),this.sl.mc(t);for(var r=0,i=this.hl.get(t);r<i.length;r++){var o=i[r];this.ol.delete(o),e&&this.rl.Sl(o,e)}this.hl.delete(t),this.Tl&&this.ll.zh(t).forEach(function(t){n.ll.Nr(t)||n.Dl(t)})},mf.prototype.Dl=function(t){var e=this.ul.get(t);null!==e&&(this.nl.vu(e),this.ul=this.ul.remove(t),this.cl.delete(e),this.gl())},mf.prototype.ml=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof of?(this.ll.Eo(i.key,t),this.Cl(i)):i instanceof sf?(xr("SyncEngine","Document no longer in limbo: "+i.key),this.ll.mo(i.key,t),this.ll.Nr(i.key)||this.Dl(i.key)):Rr()}},mf.prototype.Cl=function(t){var e=t.key;this.ul.get(e)||(xr("SyncEngine","New document in limbo: "+e),this.al.push(e),this.gl())},mf.prototype.gl=function(){for(;0<this.al.length&&this.ul.size<this.il;){var t=this.al.shift(),e=this.dl.next();this.cl.set(e,new af(t)),this.ul=this.ul.nt(t,e),this.nl.listen(new Di(wu(vu(t.path)),e,2,la.Ts))}},mf.prototype.Nl=function(){return this.ul},mf.prototype.Fl=function(){return this.al},mf.prototype.Pl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ol.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Wc(r);return n.Gc?u.nu.Lh(i.query,!1).then(function(t){var e=t.documents;return i.view.Wc(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.Bn(t,u.Tl,n);u.ml(i.targetId,r.Yc),r.snapshot&&(u.Tl&&u.sl.Pc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=fa.ls(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.rl.ka(o),[4,this.nu.kh(s)];case 2:return t.sent(),[2]}})})},mf.prototype.El=function(t){},mf.prototype.Wu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(xr("SyncEngine","User change. New user:",n.Xh()),[4,this.nu.Vh(n)]);case 1:return e=t.sent(),this.currentUser=n,this.vl("'waitForPendingWrites' promise is rejected due to a user change."),this.sl.Vh(n,e.yh,e.ph),[4,this.Pl(e.gh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},mf.prototype.xe=function(t){var e=this.cl.get(t);if(e&&e.el)return Xi().add(e.key);var n=Xi(),r=this.hl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.ol.get(s),n=n.Ct(u.view.Qc);return n},mf);function mf(t,e,n,r,i,o){this.nu=t,this.nl=e,this.su=n,this.sl=r,this.currentUser=i,this.il=o,this.rl=null,this.ol=new Yr(Nu,Tu),this.hl=new Map,this.al=[],this.ul=new Oi(oi.P),this.cl=new Map,this.ll=new Ac,this._l={},this.fl=new Map,this.dl=nc.eo(),this.onlineState="Unknown",this.wl=void 0}function wf(t,e){this.query=t,this.Oc=e,this.Lc=null,this.Ht=!1,this.qc=Xi(),this.Lt=Xi(),this.Bc=Du(t),this.Uc=new $i(this.Bc)}function bf(){this.xc=new pf,this.Mc={},this.Ga=null,this._s=null}function Ef(t,e,n,r,i){this.window=t,this.Es=e,this.persistenceKey=n,this.Yu=r,this.Du=null,this.Ga=null,this._s=null,this.Ju=this.Xu.bind(this),this.Zu=new Oi(Mr),this.tr=!1,this.tc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ec=ef(this.persistenceKey,this.Yu),this.nc="firestore_sequence_number_"+this.persistenceKey,this.Zu=this.Zu.nt(this.Yu,new pf),this.sc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.ic=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.rc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.oc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Ju)}function If(){this.activeTargetIds=Hi}function Tf(t,e){this.clientId=t,this.onlineState=e}function Nf(t,e){this.clientId=t,this.activeTargetIds=e}function Af(t,e,n){this.targetId=t,this.state=e,this.error=n}function _f(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Df(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).El("applyBatchState()"),[4,(e=o.nu,n=a,i=(r=e).Kn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Xn(e,t):sa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.nl.gu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.yl(a,c||null),o.nu.Kn.Sr(a)):Rr(),t.label=4;case 4:return[4,o.Pl(s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Sf(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.wl?[3,3]:(e=r.sl.cc(),[4,kf(r,e.N())]);case 1:return i=t.sent(),r.wl=!0,[4,r.nl.ju(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.nl.listen(u);return[3,7];case 3:return!1!==f||!1===r.wl?[3,7]:(a=[],h=Promise.resolve(),r.hl.forEach(function(t,e){r.sl.Ac(e)?a.push(e):h=h.then(function(){return r.Al(e),r.nu.Oh(e,!0)}),r.nl.vu(e)}),[4,h]);case 4:return t.sent(),[4,kf(r,a)];case 5:return t.sent(),(n=r).cl.forEach(function(t,e){n.nl.vu(e)}),n.ll.Hh(),n.cl=new Map,n.ul=new Oi(oi.P),r.wl=!1,[4,r.nl.ju(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function kf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.hl.get(s))&&0!==a.length?[4,e.nu.Mh(wu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.ol.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).nu.Lh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Zc(n),[2,(e.Tl&&e.ml(o.targetId,r.Yc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Tc(e.nu,s)];case 8:return d=t.sent(),[4,e.nu.Mh(d)];case 9:return u=t.sent(),[4,e.Il(xf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.rl.ka(r),n)]}})})}function xf(t){return yu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Of(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).wl?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.hl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.nu,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=to.Gt(u,"current"===a),[4,n.Pl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.nu.Oh(u,!0)];case 6:return t.sent(),n.Al(u,h),[3,8];case 7:Rr(),t.label=8;case 8:return[2]}var r,e})})}function Pf(){this.kl=void 0,this.listeners=[]}var Lf,Rf=(Bf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.$l.get(e))||(n=!0,r=new Pf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Du.listen(e)];case 2:return i.kl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ka(o,"Initialization of query '"+Au(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.$l.set(e,r),r.listeners.push(u),u.Jc(this.onlineState),r.kl&&u.Ml(r.kl)&&this.Ol(),[2]}})})},Bf.prototype.vu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.$l.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.$l.delete(e),this.Du.vu(e))]:[2]})})},Bf.prototype.ka=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.$l.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ml(i)&&(e=!0);s.kl=i}}e&&this.Ol()},Bf.prototype.Sl=function(t,e){var n=this.$l.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.$l.delete(t)},Bf.prototype.Vl=function(i){this.onlineState=i;var o=!1;this.$l.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Jc(i)&&(o=!0)}),o&&this.Ol()},Bf.prototype.Ll=function(t){this.xl.add(t),t.next()},Bf.prototype.ql=function(t){this.xl.delete(t)},Bf.prototype.Ol=function(){this.xl.forEach(function(t){t.next()})},Bf),Cf=(Gf.prototype.Ml=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.Ul?this.Wl(t)&&(this.Bl.next(t),o=!0):this.jl(t,this.onlineState)&&(this.Kl(t),o=!0),this.Ql=t,o},Gf.prototype.onError=function(t){this.Bl.error(t)},Gf.prototype.Jc=function(t){this.onlineState=t;var e=!1;return this.Ql&&!this.Ul&&this.jl(this.Ql,t)&&(this.Kl(this.Ql),e=!0),e},Gf.prototype.jl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Gl&&n||t.docs._()&&"Offline"!==e)},Gf.prototype.Wl=function(t){if(0<t.docChanges.length)return!0;var e=this.Ql&&this.Ql.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Gf.prototype.Kl=function(t){t=Zi.Ut(t.query,t.docs,t.Lt,t.fromCache),this.Ul=!0,this.Bl.next(t)},Gf),Uf=(qf.prototype.Ph=function(t){this.zl=t},qf.prototype.es=function(e,r,i,o){var s=this;return r.on()||i.isEqual(ti.min())?this.Hl(e,r):this.zl.Xn(e,o).next(function(t){var n=s.Yl(r,t);return(r.hn()||r.an())&&s.Gc(r.en,n,o,i)?s.Hl(e,r):(kr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(r)),s.zl.es(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},qf.prototype.Yl=function(n,t){var r=new Mi(Du(n));return t.forEach(function(t,e){e instanceof su&&_u(n,e)&&(r=r.add(e))}),r},qf.prototype.Gc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},qf.prototype.Hl=function(t,e){return kr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Using full collection scan to execute query:",Au(e)),this.zl.es(t,e,ti.min())},qf),Vf=(jf.prototype.Ir=function(t){return sa.resolve(0===this.Kn.length)},jf.prototype.mr=function(t,e,n,r){var i=this.Jl;this.Jl++,0<this.Kn.length&&this.Kn[this.Kn.length-1];var o=new ia(i,e,n,r);this.Kn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xl=this.Xl.add(new _c(a.key,i)),this.Gn.Ar(t,a.key.path.p())}return sa.resolve(o)},jf.prototype.Rr=function(t,e){return sa.resolve(this.Zl(e))},jf.prototype.Vr=function(t,e){var n=e+1,r=this.t_(n),i=r<0?0:r;return sa.resolve(this.Kn.length>i?this.Kn[i]:null)},jf.prototype.gr=function(){return sa.resolve(0===this.Kn.length?-1:this.Jl-1)},jf.prototype.yr=function(t){return sa.resolve(this.Kn.slice())},jf.prototype.Hn=function(t,e){var n=this,r=new _c(e,0),i=new _c(e,Number.POSITIVE_INFINITY),o=[];return this.Xl.vt([r,i],function(t){var e=n.Zl(t.Jh);o.push(e)}),sa.resolve(o)},jf.prototype.ts=function(t,e){var r=this,i=new Mi(Mr);return e.forEach(function(t){var e=new _c(t,0),n=new _c(t,Number.POSITIVE_INFINITY);r.Xl.vt([e,n],function(t){i=i.add(t.Jh)})}),sa.resolve(this.e_(i))},jf.prototype.hs=function(t,e){var n=e.path,r=n.length+1,i=n;oi.W(i)||(i=i.child(""));var o=new _c(new oi(i),0),s=new Mi(Mr);return this.Xl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.Jh)),!0)},o),sa.resolve(this.e_(s))},jf.prototype.e_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Zl(t);null!==e&&r.push(e)}),r},jf.prototype.br=function(n,r){var i=this;Cr(0===this.n_(r.batchId,"removed")),this.Kn.shift();var o=this.Xl;return sa.forEach(r.mutations,function(t){var e=new _c(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.Xl=o})},jf.prototype.Sr=function(t){},jf.prototype.Nr=function(t,e){var n=new _c(e,0),r=this.Xl.Dt(n);return sa.resolve(e.isEqual(r&&r.key))},jf.prototype.Cr=function(t){return this.Kn.length,sa.resolve()},jf.prototype.n_=function(t,e){return this.t_(t)},jf.prototype.t_=function(t){return 0===this.Kn.length?0:t-this.Kn[0].batchId},jf.prototype.Zl=function(t){var e=this.t_(t);return e<0||e>=this.Kn.length?null:this.Kn[e]},jf),Mf=(Ff.prototype.$n=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.s_(e);return this.docs=this.docs.nt(r,{Mr:e,size:s,readTime:n}),this.size+=s-o,this.Gn.Ar(t,r.path.p())},Ff.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ff.prototype.On=function(t,e){var n=this.docs.get(e);return sa.resolve(n?n.Mr:null)},Ff.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Mr:null)}),sa.resolve(r)},Ff.prototype.es=function(t,e,n){for(var r=Bi,i=new oi(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Mr,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof su&&_u(e,h)&&(r=r.nt(h.key,h))}return sa.resolve(r)},Ff.prototype.i_=function(t,e){return sa.forEach(this.docs,function(t){return e(t)})},Ff.prototype.jr=function(t){return new Ff.Kr(this)},Ff.prototype.zr=function(t){return sa.resolve(this.size)},Ff);function Ff(t,e){this.Gn=t,this.s_=e,this.docs=new Oi(oi.P),this.size=0}function jf(t,e){this.Gn=t,this.dr=e,this.Kn=[],this.Jl=1,this.Xl=new Mi(_c.Uh)}function qf(){}function Gf(t,e,n){this.query=t,this.Bl=e,this.Ul=!1,this.Ql=null,this.onlineState="Unknown",this.options=n||{}}function Bf(t){this.Du=t,this.$l=new Yr(Nu,Tu),this.onlineState="Unknown",this.xl=new Set,this.Du.subscribe(this)}function zf(t){var e=this;return(e=Lf.call(this)||this).Hr=t,e}Mf.Kr=(n(zf,Lf=ua),zf.prototype.Bn=function(n){var r=this,i=[];return this.Nn.forEach(function(t,e){e?i.push(r.Hr.$n(n,e,r.readTime)):r.Hr.Mn(t)}),sa.Dn(i)},zf.prototype.Ln=function(t,e){return this.Hr.On(t,e)},zf.prototype.qn=function(t,e){return this.Hr.getEntries(t,e)},zf);var Kf,Xf,Hf=(cl.prototype.pe=function(t,n){return this.r_.forEach(function(t,e){return n(e)}),sa.resolve()},cl.prototype.ro=function(t){return sa.resolve(this.lastRemoteSnapshotVersion)},cl.prototype.oo=function(t){return sa.resolve(this.o_)},cl.prototype.no=function(t){return this.highestTargetId=this.a_.next(),sa.resolve(this.highestTargetId)},cl.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.o_&&(this.o_=e),sa.resolve()},cl.prototype.uo=function(t){this.r_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.a_=new nc(e),this.highestTargetId=e),t.sequenceNumber>this.o_&&(this.o_=t.sequenceNumber)},cl.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,sa.resolve()},cl.prototype.lo=function(t,e){return this.uo(e),sa.resolve()},cl.prototype._o=function(t,e){return this.r_.delete(e.target),this.h_.zh(e.targetId),--this.targetCount,sa.resolve()},cl.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.r_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.r_.delete(t),u.push(o.fo(n,e.targetId)),s++)}),sa.Dn(u).next(function(){return s})},cl.prototype.do=function(t){return sa.resolve(this.targetCount)},cl.prototype.wo=function(t,e){var n=this.r_.get(e)||null;return sa.resolve(n)},cl.prototype.To=function(t,e,n){return this.h_.jh(e,n),sa.resolve()},cl.prototype.Io=function(e,t,n){this.h_.Gh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),sa.Dn(i)},cl.prototype.fo=function(t,e){return this.h_.zh(e),sa.resolve()},cl.prototype.Ao=function(t,e){var n=this.h_.Yh(e);return sa.resolve(n)},cl.prototype.Nr=function(t,e){return sa.resolve(this.h_.Nr(e))},cl),Wf=(hl.prototype.start=function(){return Promise.resolve()},hl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(hl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),hl.prototype.Bo=function(){},hl.prototype.Uo=function(){},hl.prototype.uh=function(){return this.Gn},hl.prototype.oh=function(t){var e=this.u_[t.Xh()];return e||(e=new Vf(this.Gn,this.dr),this.u_[t.Xh()]=e),e},hl.prototype.hh=function(){return this.ko},hl.prototype.ah=function(){return this.jn},hl.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new Qf(this.yo.next());return this.dr.l_(),n(i).next(function(t){return r.dr.__(i).next(function(){return t})}).vn().then(function(t){return i.Wn(),t})},hl.prototype.f_=function(e,n){return sa.Cn(Object.values(this.u_).map(function(t){return function(){return t.Nr(e,n)}}))},hl),Qf=(n(al,Xf=ha),al),Yf=(ul.T_=function(t){return new ul(t)},Object.defineProperty(ul.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Rr()},enumerable:!1,configurable:!0}),ul.prototype.Eo=function(t,e,n){return this.d_.Eo(n,e),this.E_.delete(n),sa.resolve()},ul.prototype.mo=function(t,e,n){return this.d_.mo(n,e),this.E_.add(n),sa.resolve()},ul.prototype.Dr=function(t,e){return this.E_.add(e),sa.resolve()},ul.prototype.removeTarget=function(t,e){var n=this;this.d_.zh(e.targetId).forEach(function(t){return n.E_.add(t)});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return r._o(t,e)})},ul.prototype.l_=function(){this.w_=new Set},ul.prototype.__=function(t){var n=this,r=this.persistence.ah().jr();return sa.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||r.Mn(e)})}).next(function(){return n.w_=null,r.apply(t)})},ul.prototype.wh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},ul.prototype.c_=function(t){return 0},ul.prototype.I_=function(t,e){var n=this;return sa.Cn([function(){return sa.resolve(n.d_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.f_(t,e)}])},ul),$f=(sl.prototype.Na=function(t){this.R_=t},sl.prototype.ba=function(t){this.P_=t},sl.prototype.onMessage=function(t){this.V_=t},sl.prototype.close=function(){this.A_()},sl.prototype.send=function(t){this.m_(t)},sl.prototype.g_=function(){this.R_()},sl.prototype.y_=function(t){this.P_(t)},sl.prototype.p_=function(t){this.V_(t)},sl),Jf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Zf=(ol.prototype.ja=function(e,t,n,r){var i=this.D_(e,t);xr("RestConnection","Sending: ",i,n);var o={};return this.C_(o,r),this.N_(e,i,o,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},ol.prototype.Ka=function(t,e,n,r){return this.ja(t,e,n,r)},ol.prototype.C_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.18.0-202071122108",t["Content-Type"]="text/plain",e)for(var n in e.ea)e.ea.hasOwnProperty(n)&&(t[n]=e.ea[n])},ol.prototype.D_=function(t,e){var n=Jf[t];return this.v_+"/v1/"+e+":"+n},n(il,Kf=ol),il.prototype.N_=function(a,e,n,r){return new Promise(function(o,s){var u=new Nr;u.listenOnce(Ir.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var t=u.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:xr("Connection",'RPC "'+a+'" timed out'),s(new Jr($r.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=u.getStatus();xr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values($r).indexOf(i)?i:$r.UNKNOWN,s(new Jr(n,e.message))):s(new Jr($r.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Jr($r.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{xr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},il.prototype.Fa=function(t,e){var n,r,i=[this.v_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=br(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.C_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}xr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new $f({m_:function(t){f?xr("Connection","Not sending because WebChannel is closed:",t):(c||(xr("Connection","Opening WebChannel transport."),h.open(),c=!0),xr("Connection","WebChannel sending:",t),h.send(t))},A_:function(){return h.close()}});return a(Tr.EventType.OPEN,function(){f||xr("Connection","WebChannel transport opened.")}),a(Tr.EventType.CLOSE,function(){f||(f=!0,xr("Connection","WebChannel transport closed"),l.y_())}),a(Tr.EventType.ERROR,function(t){f||(f=!0,Pr("Connection","WebChannel transport errored:",t),l.y_(new Jr($r.UNAVAILABLE,"The operation could not be completed")))}),a(Tr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Cr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(xr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ai[i];if(void 0!==t)return xi(t)}(),s=r.message,void 0===o&&(o=$r.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.y_(new Jr(o,s)),h.close()):(xr("Connection","WebChannel received:",n),l.p_(n)))}),setTimeout(function(){l.g_()},0),l},il),tl=(rl.prototype.uu=function(t){this.O_.push(t)},rl.prototype.th=function(){window.removeEventListener("online",this.F_),window.removeEventListener("offline",this.x_)},rl.prototype.L_=function(){window.addEventListener("online",this.F_),window.addEventListener("offline",this.x_)},rl.prototype.k_=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(0)},rl.prototype.M_=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(1)},rl.Fs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},rl),el=(nl.prototype.uu=function(t){},nl.prototype.th=function(){},nl);function nl(){}function rl(){var t=this;this.F_=function(){return t.k_()},this.x_=function(){return t.M_()},this.O_=[],this.L_()}function il(t){var e=this;return(e=Kf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function ol(t){this.b_=t,this.s=t.s;var e=t.ssl?"https":"http";this.v_=e+"://"+t.host,this.S_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function sl(t){this.m_=t.m_,this.A_=t.A_}function ul(t){this.persistence=t,this.d_=new Ac,this.w_=null}function al(t){var e=this;return(e=Xf.call(this)||this).Ro=t,e}function hl(t){var e=this;this.u_={},this.yo=new la(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new Hf(this),this.Gn=new xh,this.jn=new Mf(this.Gn,function(t){return e.dr.c_(t)})}function cl(t){this.persistence=t,this.r_=new Yr(wi,bi),this.lastRemoteSnapshotVersion=ti.min(),this.highestTargetId=0,this.o_=0,this.h_=new Ac,this.targetCount=0,this.a_=nc.to()}function fl(t){return new Ro(t,!0)}var ll,pl,dl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",yl=(El.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.sl=this.q_(e),this.persistence=this.B_(e),[4,this.persistence.start()];case 1:return t.sent(),this.U_=this.Q_(e),this.nu=this.W_(e),[2]}})})},El.prototype.Q_=function(t){return null},El.prototype.W_=function(t){return e=this.persistence,n=new Uf,r=t.j_,new Ec(e,n,r);var e,n,r},El.prototype.B_=function(t){if(t.G_.K_)throw new Jr($r.FAILED_PRECONDITION,dl);return new Wf(Yf.T_)},El.prototype.q_=function(t){return new yf},El.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.sl.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},El.prototype.clearPersistence=function(t,e){throw new Jr($r.FAILED_PRECONDITION,dl)},El),vl=(n(bl,pl=yl),bl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,pl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.nu)];case 2:return t.sent(),[2]}})})},bl.prototype.Q_=function(t){var e=this.persistence.dr.Yi;return new Ja(e,t.ti)},bl.prototype.B_=function(t){var e=bc(t.b_.s,t.b_.persistenceKey),n=fl(t.b_.s);return new lc(t.G_.synchronizeTabs,e,t.clientId,Qa.Ui(t.G_.cacheSizeBytes),t.ti,Fa(),ja(),n,this.sl,t.G_.Vo)},bl.prototype.q_=function(t){return new yf},bl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Na.Fs()?(e=n+"main",[4,Na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(bc(t,e))},n(wl,ll=bl),wl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,ll.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.z_.initialize(this,r)];case 2:return t.sent(),e=this.z_.Du,this.sl instanceof df?(this.sl.Du={Fc:Df.bind(null,e),kc:Of.bind(null,e),$c:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).wl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.hl.has(i)?(xr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Tc(n.nu,i)]):[3,6];case 2:return o=t.sent(),[4,n.nu.Mh(o)];case 3:return s=t.sent(),[4,n.Il(xf(o),s.targetId,!1)];case 4:t.sent(),n.nl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.hl.has(e)?[4,n.nu.Oh(e,!1).then(function(){n.nl.vu(e),n.Al(e)}).catch(Nc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.nu.persistence.rh()}.bind(null,e)},[4,this.sl.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Sf(this.z_.Du,e)];case 1:return t.sent(),this.U_&&(e&&!this.U_.tr?this.U_.start(this.nu):e||this.U_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},wl.prototype.q_=function(t){if(t.G_.K_&&t.G_.synchronizeTabs){var e=Fa();if(!df.Fs(e))throw new Jr($r.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=bc(t.b_.s,t.b_.persistenceKey);return new df(e,t.ti,n,t.clientId,t.j_)}return new yf},wl),gl=(ml.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.nu?[3,3]:(this.nu=n.nu,this.sl=n.sl,this.su=this.H_(r),this.nl=this.Y_(r),this.Du=this.J_(r),this.X_=this.Z_(r),this.sl.Ga=function(t){return e.Du.Jc(t,1)},this.nl.Du=this.Du,[4,this.nl.start()]);case 1:return t.sent(),[4,this.nl.ju(this.Du.Tl)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ml.prototype.Z_=function(t){return new Rf(this.Du)},ml.prototype.H_=function(t){var e,n,r=fl(t.b_.s),i=(e=t.b_,new Zf(e));return n=t.credentials,new Gc(n,i,r)},ml.prototype.Y_=function(t){var e=this;return new zc(this.nu,this.su,t.ti,function(t){return e.Du.Jc(t,0)},new(tl.Fs()?tl:el))},ml.prototype.J_=function(t){return e=this.nu,n=this.nl,r=this.su,i=this.sl,o=t.j_,s=t.il,u=!t.G_.K_||!t.G_.synchronizeTabs,a=new gf(e,n,r,i,o,s),u&&(a.wl=!0),a;var e,n,r,i,o,s,u,a},ml.prototype.terminate=function(){return this.nl.th()},ml);function ml(){}function wl(t){var e=this;return(e=ll.call(this)||this).z_=t,e}function bl(){return null!==pl&&pl.apply(this,arguments)||this}function El(){}function Il(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Tl=(Nl.prototype.next=function(t){this.observer.next&&this.tf(this.observer.next,t)},Nl.prototype.error=function(t){this.observer.error?this.tf(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Nl.prototype.ef=function(){this.muted=!0},Nl.prototype.tf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Nl);function Nl(t){this.observer=t,this.muted=!1}function Al(t,e){if(0!==e.length)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Bl(e.length,"argument")+".")}function _l(t,e,n){if(e.length!==n)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires "+Bl(n,"argument")+", but was called with "+Bl(e.length,"argument")+".")}function Dl(t,e,n){if(e.length<n)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Bl(n,"argument")+", but was called with "+Bl(e.length,"argument")+".")}function Sl(t,e,n,r){if(e.length<n||e.length>r)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Bl(e.length,"argument")+".")}function kl(t,e,n,r){Cl(t,e,Gl(n)+" argument",r)}function xl(t,e,n,r){void 0!==r&&kl(t,e,n,r)}function Ol(t,e,n,r){Cl(t,e,n+" option",r)}function Pl(t,e,n,r){void 0!==r&&Ol(t,e,n,r)}function Ll(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Vl(s))}var u=Vl(n);throw new Jr($r.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Rl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Jr($r.INVALID_ARGUMENT,"Invalid value "+Vl(r)+" provided to function "+t+"() for its "+Gl(n)+" argument. Acceptable values: "+e.join(", "));return r}function Cl(t,e,n,r){if(!("object"===e?Ul(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Vl(r);throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Ul(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Vl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ml(t,e,n){if(void 0===n)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Gl(e)+" argument, but it was undefined.")}function Fl(n,t,r){Kr(t,function(t,e){if(r.indexOf(t)<0)throw new Jr($r.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function jl(t,e,n,r){var i=Vl(r);return new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gl(n)+" argument to be a "+e+", but it was: "+i)}function ql(t,e,n){if(n<=0)throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gl(e)+" argument to be a positive number, but it was: "+n+".")}function Gl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Bl(t,e){return t+" "+e+(1===t?"":"s")}function zl(){if("undefined"==typeof Uint8Array)throw new Jr($r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kl(){if("undefined"==typeof atob)throw new Jr($r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xl,Hl,Wl=(np.fromBase64String=function(t){_l("Blob.fromBase64String",arguments,1),kl("Blob.fromBase64String","string",1,t),Kl();try{return new np(Ii.fromBase64String(t))}catch(t){throw new Jr($r.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},np.fromUint8Array=function(t){if(_l("Blob.fromUint8Array",arguments,1),zl(),!(t instanceof Uint8Array))throw jl("Blob.fromUint8Array","Uint8Array",1,t);return new np(Ii.fromUint8Array(t))},np.prototype.toBase64=function(){return _l("Blob.toBase64",arguments,0),Kl(),this.nf.toBase64()},np.prototype.toUint8Array=function(){return _l("Blob.toUint8Array",arguments,0),zl(),this.nf.toUint8Array()},np.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},np.prototype.isEqual=function(t){return this.nf.isEqual(t.nf)},np),Ql=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Jr($r.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(kl("FieldPath","string",e,t[e]),0===t[e].length)throw new Jr($r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.sf=new ii(t)},Yl=(n(ep,Hl=Ql),ep.documentId=function(){return new ep(ii.L().F())},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw jl("isEqual","FieldPath",1,t);return this.sf.isEqual(t.sf)},ep),$l=new RegExp("[~\\*/\\[\\]]"),Jl=function(){this.if=this},Zl=(n(tp,Xl=Jl),tp.prototype.hf=function(t){if(2!==t.af)throw 1===t.af?t.uf(this.rf+"() can only appear at the top level of your update data"):t.uf(this.rf+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},tp.prototype.isEqual=function(t){return t instanceof tp},tp);function tp(t){var e=this;return(e=Xl.call(this)||this).rf=t,e}function ep(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hl.call(this,t)||this}function np(t){Kl(),this.nf=t}function rp(t,e,n){return new Op({af:3,cf:e.settings.cf,methodName:t.rf,lf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var ip,op,sp,up,ap,hp,cp=(n(kp,hp=Jl),kp.prototype.hf=function(t){return new Ns(t.path,new hs)},kp.prototype.isEqual=function(t){return t instanceof kp},kp),fp=(n(Sp,ap=Jl),Sp.prototype.hf=function(t){var e=rp(this,t,!0),n=this._f.map(function(t){return Fp(t,e)}),r=new cs(n);return new Ns(t.path,r)},Sp.prototype.isEqual=function(t){return this===t},Sp),lp=(n(Dp,up=Jl),Dp.prototype.hf=function(t){var e=rp(this,t,!0),n=this._f.map(function(t){return Fp(t,e)}),r=new ys(n);return new Ns(t.path,r)},Dp.prototype.isEqual=function(t){return this===t},Dp),pp=(n(_p,sp=Jl),_p.prototype.hf=function(t){var e=new ws(t.serializer,Vo(t.serializer,this.ff));return new Ns(t.path,e)},_p.prototype.isEqual=function(t){return this===t},_p),dp=(n(Ap,op=Jl),Ap.delete=function(){return Al("FieldValue.delete",arguments),new yp(new Zl("FieldValue.delete"))},Ap.serverTimestamp=function(){return Al("FieldValue.serverTimestamp",arguments),new yp(new cp("FieldValue.serverTimestamp"))},Ap.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dl("FieldValue.arrayUnion",arguments,1),new yp(new fp("FieldValue.arrayUnion",t))},Ap.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dl("FieldValue.arrayRemove",arguments,1),new yp(new lp("FieldValue.arrayRemove",t))},Ap.increment=function(t){return kl("FieldValue.increment","number",1,t),_l("FieldValue.increment",arguments,1),new yp(new pp("FieldValue.increment",t))},Ap),yp=(n(Np,ip=dp),Np.prototype.hf=function(t){return this.if.hf(t)},Np.prototype.isEqual=function(t){return t instanceof Np&&this.if.isEqual(t.if)},Np),vp=(Object.defineProperty(Tp.prototype,"latitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"longitude",{get:function(){return this.wf},enumerable:!1,configurable:!0}),Tp.prototype.isEqual=function(t){return this.df===t.df&&this.wf===t.wf},Tp.prototype.T=function(t){return Mr(this.df,t.df)||Mr(this.wf,t.wf)},Tp),gp=/^__.*__$/,mp=function(t,e,n){this.Tf=t,this.Ef=e,this.If=n},wp=(Ip.prototype.mf=function(t,e){var n=[];return null!==this.Le?n.push(new Ms(t,this.data,this.Le,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},Ip),bp=(Ep.prototype.mf=function(t,e){var n=[new Ms(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},Ep);function Ep(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Ip(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Tp(t,e){if(_l("GeoPoint",arguments,2),kl("GeoPoint","number",1,t),kl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Jr($r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Jr($r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.df=t,this.wf=e}function Np(t){var e=this;return(e=ip.call(this)||this).if=t,e.rf=t.rf,e}function Ap(){return op.call(this)||this}function _p(t,e){var n=this;return(n=sp.call(this)||this).rf=t,n.ff=e,n}function Dp(t,e){var n=this;return(n=up.call(this)||this).rf=t,n._f=e,n}function Sp(t,e){var n=this;return(n=ap.call(this)||this).rf=t,n._f=e,n}function kp(t){var e=this;return(e=hp.call(this)||this).rf=t,e}function xp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Op=(Object.defineProperty(Rp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"af",{get:function(){return this.settings.af},enumerable:!1,configurable:!0}),Rp.prototype.Rf=function(t){return new Rp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Rp.prototype.Pf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Vf(t),r},Rp.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Af(),r},Rp.prototype.yf=function(t){return this.Rf({path:void 0,lf:!0})},Rp.prototype.uf=function(t){return Kp(t,this.settings.methodName,this.settings.pf||!1,this.path,this.settings.cf)},Rp.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Rp.prototype.Af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Vf(this.path.get(t))},Rp.prototype.Vf=function(t){if(0===t.length)throw this.uf("Document fields must not be empty");if(xp(this.af)&&gp.test(t))throw this.uf('Document fields cannot begin and end with "__"')},Rp),Pp=(Lp.prototype.bf=function(t,e,n,r){return void 0===r&&(r=!1),new Op({af:t,methodName:e,cf:n,path:ii.$(),lf:!1,pf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Lp);function Lp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||fl(t)}function Rp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Af(),this.fieldTransforms=i||[],this.Le=o||[]}function Cp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.bf(o.merge||o.mergeFields?2:0,e,n,i);Gp("Data must be an object, but it was:",s,r);var u,a,h=jp(r,s);if(o.merge)u=new Ts(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Ql)d=p.sf;else{if("string"!=typeof p)throw Rr();d=zp(e,p,n)}if(!s.contains(d))throw new Jr($r.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Xp(c,d)||c.push(d)}u=new Ts(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new wp(new Ys(h),u,a)}function Up(t,o,s,e){var u=t.bf(1,o,s);Gp("Data must be an object, but it was:",u,e);var a=[],h=new $s;Kr(e,function(t,e){var n,r=zp(o,t,s),i=u.gf(r);e instanceof Jl&&e.if instanceof Zl?a.push(r):null!=(n=Fp(e,i))&&(a.push(r),h.set(r,n))});var n=new Ts(a);return new bp(h.Ge(),n,u.fieldTransforms)}function Vp(t,e,n,r,i,o){var s=t.bf(1,e,n),u=[Bp(e,r,n)],a=[i];if(o.length%2!=0)throw new Jr($r.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Bp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new $s,v=u.length-1;0<=v;--v){Xp(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof Jl&&f.if instanceof Zl?d.push(c):null!=(p=Fp(f,l))&&(d.push(c),y.set(c,p)))}var g=new Ts(d);return new bp(y.Ge(),g,s.fieldTransforms)}function Mp(t,e,n,r){return void 0===r&&(r=!1),Fp(n,t.bf(r?4:3,e))}function Fp(s,t){if(qp(s))return Gp("Unsupported field value:",t,s),jp(s,t);if(s instanceof Jl)return function(t,e){if(!xp(e.af))throw e.uf(t.rf+"() can only be used with update() and set()");if(!e.path)throw e.uf(t.rf+"() is not currently supported inside arrays");var n=t.hf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.lf&&4!==t.af)throw t.uf("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Fp(i[r],t.yf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zr.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof Zr){var r=new Zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof vp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wl)return{bytesValue:Fo(e.serializer,t)};if(t instanceof mp){var i=e.s,o=t.Tf;if(!o.isEqual(i))throw e.uf("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:qo(t.Tf||e.s,t.Ef.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.uf("Unsupported field value: "+Vl(t))}(s,t)}function jp(t,r){var i={};return Xr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Kr(t,function(t,e){var n=Fp(e,r.Pf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function qp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zr||t instanceof vp||t instanceof Wl||t instanceof mp||t instanceof Jl)}function Gp(t,e,n){if(!qp(n)||!Ul(n)){var r=Vl(n);throw"an object"===r?e.uf(t+" a custom object"):e.uf(t+" "+r)}}function Bp(t,e,n){if(e instanceof Ql)return e.sf;if("string"==typeof e)return zp(t,e);throw Kp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function zp(t,e,n){try{return function(e){if(0<=e.search($l))throw new Jr($r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Yl.bind.apply(Yl,i([void 0],e.split("."))))}catch(t){throw new Jr($r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).sf}catch(e){throw Kp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Kp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Jr($r.INVALID_ARGUMENT,(u+=". ")+t+a)}function Xp(t,e){return t.some(function(t){return t.isEqual(e)})}var Hp=(Jp.prototype.Nf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new Jr($r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ho((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Bo(i.serializer,t)})},[4,i.Ka("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=zo(t,e.found.name),r=jo(e.found.updateTime),i=new Ys({mapValue:{fields:e.found.fields}});return new su(n,r,i,{})}(e,n):"missing"in n?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);var n=zo(t,e.missing),r=jo(e.readTime);return new uu(n,r)}(e,n):Rr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Cr(!!e),s.push(e)}),s)]}})})}(this.su,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof uu||t instanceof su?n.kf(t):Rr()}),e)]}})})},Jp.prototype.set=function(t,e){this.write(e.mf(t,this.Ue(t))),this.Cf.add(t)},Jp.prototype.update=function(t,e){try{this.write(e.mf(t,this.$f(t)))}catch(t){this.Df=t}this.Cf.add(t)},Jp.prototype.delete=function(t){this.write([new Ws(t,this.Ue(t))]),this.Cf.add(t)},Jp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Df)throw this.Df;return e=this.vf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new oi(ni.k(e));r.mutations.push(new Qs(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.ja("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.su,this.mutations)];case 1:return t.sent(),this.Sf=!0,[2]}})})},Jp.prototype.kf=function(t){var e;if(t instanceof su)e=t.version;else{if(!(t instanceof uu))throw Rr();e=ti.min()}var n=this.vf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Jr($r.ABORTED,"Document version changed between two reads.")}else this.vf.set(t.key.toString(),e)},Jp.prototype.Ue=function(t){var e=this.vf.get(t.toString());return!this.Cf.has(t)&&e?Ds.updateTime(e):Ds.Qe()},Jp.prototype.$f=function(t){var e=this.vf.get(t.toString());if(this.Cf.has(t)||!e)return Ds.exists(!0);if(e.isEqual(ti.min()))throw new Jr($r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ds.updateTime(e)},Jp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},Jp.prototype.Ff=function(){},Jp),Wp=($p.prototype.run=function(){this.Mf()},$p.prototype.Mf=function(){var t=this;this.wi.ps(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Hp(this.su),(n=this.Of(e))&&n.then(function(t){r.ti.hi(function(){return e.commit().then(function(){r.si.resolve(t)}).catch(function(t){r.Lf(t)})})}).catch(function(t){r.Lf(t)}),[2]})})})},$p.prototype.Of=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.si.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.si.reject(t),null}},$p.prototype.Lf=function(t){var e=this;0<this.xf&&this.qf(t)?(--this.xf,this.ti.hi(function(){return e.Mf(),Promise.resolve()})):this.si.reject(t)},$p.prototype.qf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!ki(e)},$p),Qp=(Yp.prototype.start=function(t,e,n,r){var i=this;this.Uf(),this.b_=t;var o=new Ea,s=!1;return this.credentials.ia(function(t){return s?void i.ti.Vi(function(){return i.nl.Wu(t)}):(s=!0,xr("FirestoreClient","Initializing. user=",t.uid),i.Qf(e,n,r,t,o).then(i.Bf.resolve,i.Bf.reject))}),this.ti.hi(function(){return i.Bf.promise}),o.promise},Yp.prototype.enableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!0),t.nl.enableNetwork()})},Yp.prototype.Qf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ti:this.ti,b_:this.b_,clientId:this.clientId,credentials:this.credentials,j_:u,il:100,G_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.sl=i.sl,this.nu=i.nu,this.U_=i.U_,this.su=o.su,this.nl=o.nl,this.Du=o.Du,this.Wf=o.X_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.jf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Qf(new yl,new gl,{K_:!1},u,a))];case 4:return[2]}})})},Yp.prototype.jf=function(t){return"FirebaseError"===t.name?t.code===$r.FAILED_PRECONDITION||t.code===$r.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Yp.prototype.Uf=function(){if(this.ti.Ei)throw new Jr($r.FAILED_PRECONDITION,"The client has already been terminated.")},Yp.prototype.disableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!1),t.nl.disableNetwork()})},Yp.prototype.terminate=function(){var t=this;return this.ti.Pi(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.nl.th()];case 1:return t.sent(),[4,this.sl.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.ra(),[2]}})})})},Yp.prototype.waitForPendingWrites=function(){var t=this;this.Uf();var e=new Ea;return this.ti.hi(function(){return t.Du.bl(e)}),e.promise},Yp.prototype.listen=function(t,e,n){var r=this;this.Uf();var i=new Tl(n),o=new Cf(t,i,e);return this.ti.hi(function(){return r.Wf.listen(o)}),function(){i.ef(),r.ti.hi(function(){return r.Wf.vu(o)})}},Yp.prototype.Kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new Ea,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.xh(s)];case 1:return(e=t.sent())instanceof su?i.resolve(e):e instanceof uu?i.resolve(null):i.reject(new Jr($r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Ka(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ti,this.nu,e))]}})})},Yp.prototype.Gf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new Ea,s=Zp(e,n,vu(r.path),{includeMetadataChanges:!0,Gl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Jr($r.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Jr($r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Yp.prototype.zf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new Ea,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.Lh(h,!0)];case 1:return e=t.sent(),n=new vf(h,e.qh),r=n.Wc(e.documents),i=n.Bn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ka(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ti,this.nu,e))]}})})},Yp.prototype.Hf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new Ea,s=Zp(e,n,r,{includeMetadataChanges:!0,Gl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Jr($r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Yp.prototype.write=function(t){var e=this;this.Uf();var n=new Ea;return this.ti.hi(function(){return e.Du.write(t,n)}),n.promise},Yp.prototype.s=function(){return this.b_.s},Yp.prototype.Ll=function(t){var e=this;this.Uf();var n=new Tl(t);return this.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ll(n)]})})}),function(){n.ef(),e.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.ql(n)]})})})}},Object.defineProperty(Yp.prototype,"Yf",{get:function(){return this.ti.Ei},enumerable:!1,configurable:!0}),Yp.prototype.transaction=function(t){var e=this;this.Uf();var n=new Ea;return this.ti.hi(function(){return new Wp(e.ti,e.su,t,n).run(),Promise.resolve()}),n.promise},Yp);function Yp(t,e){this.credentials=t,this.ti=e,this.clientId=Ur.t(),this.Bf=new Ea}function $p(t,e,n,r){this.ti=t,this.su=e,this.updateFunction=n,this.si=r,this.xf=5,this.wi=new Ta(this.ti,"transaction_retry")}function Jp(t){this.su=t,this.vf=new Map,this.mutations=[],this.Sf=!1,this.Df=null,this.Cf=new Set}function Zp(t,e,n,r,i){var o=new Tl(i),s=new Cf(n,o,r);return t.hi(function(){return e.listen(s)}),function(){o.ef(),t.hi(function(){return e.vu(s)})}}var td,ed,nd=(bd.prototype.Zf=function(t){switch(go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return No(t.integerValue||t.doubleValue);case 3:return this.td(t.timestampValue);case 4:return this.ed(t);case 5:return t.stringValue;case 6:return new Wl(Ao(t.bytesValue));case 7:return this.nd(t.referenceValue);case 8:return this.sd(t.geoPointValue);case 9:return this.rd(t.arrayValue);case 10:return this.od(t.mapValue);default:throw Rr()}},bd.prototype.od=function(t){var n=this,r={};return Kr(t.fields||{},function(t,e){r[t]=n.Zf(e)}),r},bd.prototype.sd=function(t){return new vp(No(t.latitude),No(t.longitude))},bd.prototype.rd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Zf(t)})},bd.prototype.ed=function(t){switch(this.Jf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return po(n)?t(n):n}(t);return null==e?null:this.Zf(e);case"estimate":return this.td(yo(t));default:return null}},bd.prototype.td=function(t){var e=To(t),n=new Zr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},bd.prototype.nd=function(t){var e=ni.k(t);Cr(is(e));var n=new Gr(e.get(1),e.get(3)),r=new oi(e.g(5));return n.isEqual(this.s)||Or("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Xf(r)},bd),rd=Qa.ji,id=(wd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},wd),od=(Object.defineProperty(md.prototype,"Id",{get:function(){return this.md||(this.md=new Pp(this.Tf,this.Ed.ignoreUndefinedProperties)),this.md},enumerable:!1,configurable:!0}),md.prototype.settings=function(t){_l("Firestore.settings",arguments,1),kl("Firestore.settings","object",1,t);var e=new id(t);if(this.fd&&!this.Ed.isEqual(e))throw new Jr($r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ed=e).credentials&&(this.Td=function(t){if(!t)return new Cc;switch(t.type){case"gapi":var e=t.Ad;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Mc(e,t.la||"0");case"provider":return t.Ad;default:throw new Jr($r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},md.prototype.enableNetwork=function(){return this._d(),this.fd.enableNetwork()},md.prototype.disableNetwork=function(){return this._d(),this.fd.disableNetwork()},md.prototype.enablePersistence=function(t){var e,n;if(this.fd)throw new Jr($r.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Jr($r.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Rd(this.hd,this.ad,{K_:!0,cacheSizeBytes:this.Ed.cacheSizeBytes,synchronizeTabs:r,Vo:i})},md.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.fd&&!this.fd.Yf)throw new Jr($r.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ea,[2,(this.ld.Ii(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.Tf,this.wd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},md.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(md.prototype,"Pd",{get:function(){return this._d(),this.fd.Yf},enumerable:!1,configurable:!0}),md.prototype.waitForPendingWrites=function(){return this._d(),this.fd.waitForPendingWrites()},md.prototype.onSnapshotsInSync=function(t){if(this._d(),Il(t))return this.fd.Ll(t);kl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.fd.Ll(e)},md.prototype._d=function(){return this.fd||this.Rd(new yl,new gl,{K_:!1}),this.fd},md.prototype.Vd=function(){return new qr(this.Tf,this.wd,this.Ed.host,this.Ed.ssl,this.Ed.forceLongPolling)},md.prototype.Rd=function(t,e,n){var r=this.Vd();return this.fd=new Qp(this.Td,this.ld),this.fd.start(r,t,e,n)},md.dd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Jr($r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Jr($r.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Gr(n)},Object.defineProperty(md.prototype,"app",{get:function(){if(!this.ud)throw new Jr($r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ud},enumerable:!1,configurable:!0}),md.prototype.collection=function(t){return _l("Firestore.collection",arguments,1),kl("Firestore.collection","non-empty string",1,t),this._d(),new Sd(ni.k(t),this,null)},md.prototype.doc=function(t){return _l("Firestore.doc",arguments,1),kl("Firestore.doc","non-empty string",1,t),this._d(),ad.gd(ni.k(t),this,null)},md.prototype.collectionGroup=function(t){if(_l("Firestore.collectionGroup",arguments,1),kl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Jr($r.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._d(),new _d((e=t,new pu(ni.$(),e)),this,null);var e},md.prototype.runTransaction=function(e){var n=this;return _l("Firestore.runTransaction",arguments,1),kl("Firestore.runTransaction","function",1,e),this._d().transaction(function(t){return e(new sd(n,t))})},md.prototype.batch=function(){return this._d(),new ud(this)},Object.defineProperty(md,"logLevel",{get:function(){switch(kr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),md.setLogLevel=function(t){_l("Firestore.setLogLevel",arguments,1),Rl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Sr.setLogLevel(t)},md.prototype.yd=function(){return this.Ed.timestampsInSnapshots},md),sd=(gd.prototype.get=function(t){var n=this;_l("Transaction.get",arguments,1);var r=Cd("Transaction.get",t,this.pd);return this.bd.Nf([r.Ef]).then(function(t){if(!t||1!==t.length)return Rr();var e=t[0];if(e instanceof uu)return new cd(n.pd,r.Ef,null,!1,!1,r.If);if(e instanceof su)return new cd(n.pd,r.Ef,e,!1,!1,r.If);throw Rr()})},gd.prototype.set=function(t,e,n){Sl("Transaction.set",arguments,2,3);var r=Cd("Transaction.set",t,this.pd);n=Pd("Transaction.set",n);var i=Ud(r.If,e,n),o=Cp(this.pd.Id,"Transaction.set",r.Ef,i,null!==r.If,n);return this.bd.set(r.Ef,o),this},gd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Yl?(Dl("Transaction.update",arguments,3),r=Cd("Transaction.update",t,this.pd),Vp(this.pd.Id,"Transaction.update",r.Ef,e,n,o)):(_l("Transaction.update",arguments,2),r=Cd("Transaction.update",t,this.pd),Up(this.pd.Id,"Transaction.update",r.Ef,e)),this.bd.update(r.Ef,i),this},gd.prototype.delete=function(t){_l("Transaction.delete",arguments,1);var e=Cd("Transaction.delete",t,this.pd);return this.bd.delete(e.Ef),this},gd),ud=(vd.prototype.set=function(t,e,n){Sl("WriteBatch.set",arguments,2,3),this.Dd();var r=Cd("WriteBatch.set",t,this.pd);n=Pd("WriteBatch.set",n);var i=Ud(r.If,e,n),o=Cp(this.pd.Id,"WriteBatch.set",r.Ef,i,null!==r.If,n);return this.vd=this.vd.concat(o.mf(r.Ef,Ds.Qe())),this},vd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Dd(),i="string"==typeof e||e instanceof Yl?(Dl("WriteBatch.update",arguments,3),r=Cd("WriteBatch.update",t,this.pd),Vp(this.pd.Id,"WriteBatch.update",r.Ef,e,n,o)):(_l("WriteBatch.update",arguments,2),r=Cd("WriteBatch.update",t,this.pd),Up(this.pd.Id,"WriteBatch.update",r.Ef,e)),this.vd=this.vd.concat(i.mf(r.Ef,Ds.exists(!0))),this},vd.prototype.delete=function(t){_l("WriteBatch.delete",arguments,1),this.Dd();var e=Cd("WriteBatch.delete",t,this.pd);return this.vd=this.vd.concat(new Ws(e.Ef,Ds.Qe())),this},vd.prototype.commit=function(){return this.Dd(),this.Sd=!0,0<this.vd.length?this.pd._d().write(this.vd):Promise.resolve()},vd.prototype.Dd=function(){if(this.Sd)throw new Jr($r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},vd),ad=(n(yd,ed=mp),yd.gd=function(t,e,n){if(t.length%2!=0)throw new Jr($r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new yd(new oi(t),e,n)},Object.defineProperty(yd.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"parent",{get:function(){return new Sd(this.Ef.path.p(),this.firestore,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"path",{get:function(){return this.Ef.path.F()},enumerable:!1,configurable:!0}),yd.prototype.collection=function(t){if(_l("DocumentReference.collection",arguments,1),kl("DocumentReference.collection","non-empty string",1,t),!t)throw new Jr($r.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ni.k(t);return new Sd(this.Ef.path.child(e),this.firestore,null)},yd.prototype.isEqual=function(t){if(!(t instanceof yd))throw jl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ef.isEqual(t.Ef)&&this.If===t.If},yd.prototype.set=function(t,e){Sl("DocumentReference.set",arguments,1,2),e=Pd("DocumentReference.set",e);var n=Ud(this.If,t,e),r=Cp(this.firestore.Id,"DocumentReference.set",this.Ef,n,null!==this.If,e);return this.fd.write(r.mf(this.Ef,Ds.Qe()))},yd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Yl?(Dl("DocumentReference.update",arguments,2),Vp(this.firestore.Id,"DocumentReference.update",this.Ef,t,e,r)):(_l("DocumentReference.update",arguments,1),Up(this.firestore.Id,"DocumentReference.update",this.Ef,t)),this.fd.write(n.mf(this.Ef,Ds.exists(!0)))},yd.prototype.delete=function(){return _l("DocumentReference.delete",arguments,0),this.fd.write([new Ws(this.Ef,Ds.Qe())])},yd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Sl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Il(i[u])||(Fl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Pl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};Il(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(kl("DocumentReference.onSnapshot","function",u,i[u]),xl("DocumentReference.onSnapshot","function",u+1,i[u+1]),xl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Cd(t))},error:i[u+1],complete:i[u+2]};return this.fd.listen(vu(this.Ef.path),h,c)},yd.prototype.get=function(t){var e=this;Sl("DocumentReference.get",arguments,0,1),Rd("DocumentReference.get",t);var n=this.firestore._d();return t&&"cache"===t.source?n.Kf(this.Ef).then(function(t){return new cd(e.firestore,e.Ef,t,!0,t instanceof su&&t.Ke,e.If)}):n.Gf(this.Ef,t).then(function(t){return e.Cd(t)})},yd.prototype.withConverter=function(t){return new yd(this.Ef,this.firestore,t)},yd.prototype.Cd=function(t){var e=t.docs.get(this.Ef);return new cd(this.firestore,this.Ef,e,t.fromCache,t.hasPendingWrites,this.If)},yd),hd=(dd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},dd),cd=(pd.prototype.data=function(t){var e=this;if(Sl("DocumentSnapshot.data",arguments,0,1),t=Ld("DocumentSnapshot.data",t),this.Nd){if(this.If){var n=new fd(this.pd,this.Ef,this.Nd,this.Fd,this.kd,null);return this.If.fromFirestore(n,t)}return new nd(this.pd.Tf,this.pd.yd(),t.serverTimestamps||"none",function(t){return new ad(t,e.pd,null)}).Zf(this.Nd.Ze())}},pd.prototype.get=function(t,e){var n=this;if(Sl("DocumentSnapshot.get",arguments,1,2),e=Ld("DocumentSnapshot.get",e),this.Nd){var r=this.Nd.data().field(Bp("DocumentSnapshot.get",t,this.Ef));if(null!==r)return new nd(this.pd.Tf,this.pd.yd(),e.serverTimestamps||"none",function(t){return new ad(t,n.pd,n.If)}).Zf(r)}},Object.defineProperty(pd.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"ref",{get:function(){return new ad(this.Ef,this.pd,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"exists",{get:function(){return null!==this.Nd},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return new hd(this.kd,this.Fd)},enumerable:!1,configurable:!0}),pd.prototype.isEqual=function(t){if(!(t instanceof pd))throw jl("isEqual","DocumentSnapshot",1,t);return this.pd===t.pd&&this.Fd===t.Fd&&this.Ef.isEqual(t.Ef)&&(null===this.Nd?null===t.Nd:this.Nd.isEqual(t.Nd))&&this.If===t.If},pd),fd=(n(ld,td=cd),ld.prototype.data=function(t){return td.prototype.data.call(this,t)},ld);function ld(){return null!==td&&td.apply(this,arguments)||this}function pd(t,e,n,r,i,o){this.pd=t,this.Ef=e,this.Nd=n,this.Fd=r,this.kd=i,this.If=o}function dd(t,e){this.hasPendingWrites=t,this.fromCache=e}function yd(t,e,n){var r=this;return(r=ed.call(this,e.Tf,t,n)||this).Ef=t,r.firestore=e,r.If=n,r.fd=r.firestore._d(),r}function vd(t){this.pd=t,this.vd=[],this.Sd=!1}function gd(t,e){this.pd=t,this.bd=e}function md(t,e,n,r){var i=this;if(void 0===n&&(n=new yl),void 0===r&&(r=new gl),this.hd=n,this.ad=r,this.ud=null,this.ld=new Ga,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this._d(),[4,this.fd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ud=o,this.Tf=md.dd(o),this.wd=o.name,this.Td=new Uc(e)}else{var s=t;if(!s.projectId)throw new Jr($r.INVALID_ARGUMENT,"Must provide projectId");this.Tf=new Gr(s.projectId,s.database),this.wd="[DEFAULT]",this.Td=new Cc}this.Ed=new id({})}function wd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Jr($r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ol("settings","non-empty string","host",t.host),this.host=t.host,Pl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Fl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Pl("settings","object","credentials",t.credentials),this.credentials=t.credentials,Pl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Pl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Pl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Qa.Gi;else{if(t.cacheSizeBytes!==rd&&t.cacheSizeBytes<Qa.Ki)throw new Jr($r.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Qa.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Pl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function bd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Jf=n,this.Xf=r}function Ed(t,e,n){if("string"==typeof n){if(""===n)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ni.k(n));if(!oi.W(r))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return _o(t,new oi(r))}if(n instanceof mp)return _o(t,n.Ef);throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Vl(n)+".")}function Id(t,e){if(!Array.isArray(t)||0===t.length)throw new Jr($r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Jr($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Jr($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Jr($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Td(t,e,n){if(!n.isEqual(e))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Nd(t){if(t.an()&&0===t.tn.length)throw new Jr($r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ad,_d=(Od.prototype.where=function(t,e,n){var r;_l("Query.where",arguments,3),Ml("Query.where",3,n),r="not-in"===e||"!="===e?e:Rl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Bp("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.O()){if("array-contains"===o||"array-contains-any"===o)throw new Jr($r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Id(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var f=c[h];a.push(Ed(r,t,f))}u={arrayValue:{values:a}}}else u=Ed(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Id(s,o),u=Mp(n,e,s,"in"===o||"not-in"===o);var l=ku.create(i,o,u);return function(t,e){if(e.ln()){var n=t.cn();if(null!==n&&!n.isEqual(e.field))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.un();null!==r&&Td(0,e.field,r)}var i=t._n(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Jr($r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Jr($r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.$d,"Query.where",this.firestore.Id,this.firestore.Tf,s,r,n);return new Od((i=this.$d,o=i.filters.concat([u]),new pu(i.path,i.collectionGroup,i.tn.slice(),o,i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.If)},Od.prototype.orderBy=function(t,e){var n;if(Sl("Query.orderBy",arguments,1,2),xl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Jr($r.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Bp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new ra(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&Td(0,o,i.field),s}(this.$d,o,n);return new Od((r=this.$d,i=r.tn.concat([s]),new pu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.If)},Od.prototype.limit=function(t){return _l("Query.limit",arguments,1),kl("Query.limit","number",1,t),ql("Query.limit",1,t),new Od(bu(this.$d,t,"F"),this.firestore,this.If)},Od.prototype.limitToLast=function(t){return _l("Query.limitToLast",arguments,1),kl("Query.limitToLast","number",1,t),ql("Query.limitToLast",1,t),new Od(bu(this.$d,t,"L"),this.firestore,this.If)},Od.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.startAt",arguments,1);var r=this.xd("Query.startAt",t,e,!0);return new Od(Eu(this.$d,r),this.firestore,this.If)},Od.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.startAfter",arguments,1);var r=this.xd("Query.startAfter",t,e,!1);return new Od(Eu(this.$d,r),this.firestore,this.If)},Od.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.endBefore",arguments,1);var r=this.xd("Query.endBefore",t,e,!0);return new Od(Iu(this.$d,r),this.firestore,this.If)},Od.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.endAt",arguments,1);var r=this.xd("Query.endAt",t,e,!1);return new Od(Iu(this.$d,r),this.firestore,this.If)},Od.prototype.isEqual=function(t){if(!(t instanceof Od))throw jl("isEqual","Query",1,t);return this.firestore===t.firestore&&Tu(this.$d,t.$d)&&this.If===t.If},Od.prototype.withConverter=function(t){return new Od(this.$d,this.firestore,t)},Od.prototype.xd=function(c,t,e,n){if(Ml(c,1,t),t instanceof cd)return _l(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Jr($r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(_o(e,n.key));else{var a=n.field(u.field);if(po(a))throw new Jr($r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.F();throw new Jr($r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Qu(i,r)}(this.$d,this.firestore.Tf,t.Nd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Jr($r.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new Jr($r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!gu(t)&&-1!==h.indexOf("/"))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ni.k(h));if(!oi.W(c))throw new Jr($r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new oi(c);u.push(_o(e,f))}else{var l=Mp(n,r,h);u.push(l)}}return new Qu(u,o)}(this.$d,this.firestore.Tf,this.firestore.Id,c,r,n)},Od.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Sl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Il(i[a])||(Fl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Pl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Il(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(kl("Query.onSnapshot","function",a,i[a]),xl("Query.onSnapshot","function",a+1,i[a+1]),xl("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new Dd(r.firestore,r.$d,t,r.If))},error:i[a+1],complete:i[a+2]};return Nd(this.$d),this.firestore._d().listen(this.$d,u,h)},Od.prototype.get=function(t){var e=this;Sl("Query.get",arguments,0,1),Rd("Query.get",t),Nd(this.$d);var n=this.firestore._d();return(t&&"cache"===t.source?n.zf(this.$d):n.Hf(this.$d,t)).then(function(t){return new Dd(e.firestore,e.$d,t,e.If)})},Od),Dd=(Object.defineProperty(xd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(xd.prototype,"empty",{get:function(){return this.Od.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(xd.prototype,"size",{get:function(){return this.Od.docs.size},enumerable:!1,configurable:!0}),xd.prototype.forEach=function(e,n){var r=this;Sl("QuerySnapshot.forEach",arguments,1,2),kl("QuerySnapshot.forEach","function",1,e),this.Od.docs.forEach(function(t){e.call(n,r.Bd(t,r.metadata.fromCache,r.Od.Lt.has(t.key)))})},Object.defineProperty(xd.prototype,"query",{get:function(){return new _d(this.Md,this.pd,this.If)},enumerable:!1,configurable:!0}),xd.prototype.docChanges=function(t){t&&(Fl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Pl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Od.Bt)throw new Jr($r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ld&&this.qd===e||(this.Ld=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Od,e,this.Bd.bind(this)),this.qd=e),this.Ld},xd.prototype.isEqual=function(t){if(!(t instanceof xd))throw jl("isEqual","QuerySnapshot",1,t);return this.pd===t.pd&&Tu(this.Md,t.Md)&&this.Od.isEqual(t.Od)&&this.If===t.If},xd.prototype.Bd=function(t,e,n){return new fd(this.pd,t.key,t,e,n,this.If)},xd),Sd=(n(kd,Ad=_d),Object.defineProperty(kd.prototype,"id",{get:function(){return this.$d.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"parent",{get:function(){var t=this.$d.path.p();return t._()?null:new ad(new oi(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"path",{get:function(){return this.$d.path.F()},enumerable:!1,configurable:!0}),kd.prototype.doc=function(t){Sl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ur.t()),kl("CollectionReference.doc","non-empty string",1,t);var e=ni.k(t);return ad.gd(this.$d.path.child(e),this.firestore,this.If)},kd.prototype.add=function(t){_l("CollectionReference.add",arguments,1),kl("CollectionReference.add","object",1,this.If?this.If.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},kd.prototype.withConverter=function(t){return new kd(this.Ud,this.firestore,t)},kd);function kd(t,e,n){var r=this;if(((r=Ad.call(this,vu(t),e,n)||this).Ud=t).length%2!=1)throw new Jr($r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function xd(t,e,n,r){this.pd=t,this.Md=e,this.Od=n,this.If=r,this.Ld=null,this.qd=null,this.metadata=new hd(n.hasPendingWrites,n.fromCache)}function Od(t,e,n){this.$d=t,this.firestore=e,this.If=n}function Pd(t,e){if(void 0===e)return{merge:!1};if(Fl(t,e,["merge","mergeFields"]),Pl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Vl(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Jr($r.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Vl(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Yl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Jr($r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ld(t,e){return void 0===e?{}:(Fl(t,e,["serverTimestamps"]),Ll(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Rd(t,e){xl(t,"object",1,e),e&&(Fl(t,e,["source"]),Ll(t,0,"source",e.source,["default","server","cache"]))}function Cd(t,e,n){if(e instanceof mp){if(e.firestore!==n)throw new Jr($r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw jl(t,"DocumentReference",1,e)}function Ud(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Vd,Md={Firestore:od,GeoPoint:vp,Timestamp:Zr,Blob:Wl,Transaction:sd,WriteBatch:ud,DocumentReference:ad,DocumentSnapshot:cd,Query:_d,QueryDocumentSnapshot:fd,QuerySnapshot:Dd,CollectionReference:Sd,FieldPath:Yl,FieldValue:dp,setLogLevel:od.setLogLevel,CACHE_SIZE_UNLIMITED:rd};(Vd=Fd).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new gl,i=new vl(r),new od(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Md))),Vd.registerVersion("@firebase/firestore","1.16.4-202071122108")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
