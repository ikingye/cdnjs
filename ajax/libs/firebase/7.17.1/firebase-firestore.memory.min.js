!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(ef){"use strict";try{(function(){ef=ef&&Object.prototype.hasOwnProperty.call(ef,"default")?ef.default:ef;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function y(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},a=p.INFO,u=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,m=(n(f,l=Error),f);function f(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},_=N||self;function S(){}function R(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),P=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:V).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++P))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var X=_.navigator;if(X){var Q=X.userAgent;if(Q){H=Q;break t}}H=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),at=st||ot,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ht=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=_.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,ut?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt={};function yt(a){return t=a,e=function(){for(var t=0,e=z(String(nt)).split("."),n=z(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var vt=_.document&&ot&&(ct()||parseInt(nt,10))||void 0,gt=!ot||9<=Number(vt),mt=ot&&!yt("9"),wt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},x(Et,bt);var It={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++Nt,this.V=this.X=!1}function _t(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=j(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new At(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[Tt]?e.sa(n,r,L(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Tt]?t.ra(e,n,L(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!gt)return null;var a,u,h=xt(t);if(h||(t[Lt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=Mt,r=u=gt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Tt]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):_t(t)))}function Ct(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Vt(t),n.call(r,e)}function Mt(t,e){if(t.V)return!0;if(gt)return Ut(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new Et(e,this))}function xt(t){return(t=t[Lt])instanceof St?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==R(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function qt(){F.call(this),this.c=new St(this),(this.J=this).A=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.V&&u.capture==n&&(s=u.listener,a=u.aa||u.src,u.X&&Rt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}x(qt,F),qt.prototype[Tt]=!0,(T=qt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=jt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new bt(t,n):t instanceof bt?t.target=t.target||n:(s=t,tt(t=new bt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},T.C=function(){if(qt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=_.JSON.stringify;function Wt(){this.b=this.a=null}var Ht,zt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new $t},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Xt(t){_.setTimeout(function(){throw t},0)}function Qt(t,e){var n;Ht||(n=_.Promise.resolve(void 0),Ht=function(){n.then(Zt)}),Kt||(Ht(),Kt=!0),Jt.add(t,e)}Wt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Wt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Xt(t)}var r=zt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Kt=!1}function te(t,e){qt.call(this),this.b=t||1,this.a=e||_,this.f=C(this.Ua,this),this.g=M()}function ee(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ne(t,e,n){if("function"==R(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function re(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ie(t){t.T=ne(t.b,t.c),t.f.apply(null,t.a)}function oe(t){F.call(this),this.b=t,this.a={}}x(te,qt),(T=te.prototype).Z=!1,T.L=null,T.Ua=function(){var t;this.Z&&(0<(t=M()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ee(this),this.start())))},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=M())},T.C=function(){te.M.C.call(this),ee(this),delete this.a},x(re,F),(T=re.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ie(this)},T.C=function(){re.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ie(this))},x(oe,F);var se=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ue(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function he(){}oe.prototype.C=function(){oe.M.C.call(this),ue(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=null;function le(){return ce=ce||new qt}function fe(t){bt.call(this,"serverreachability",t)}function pe(){var t=le();t.dispatchEvent(new fe(t))}function de(t){bt.call(this,"statevent",t)}function ye(){var t=le();t.dispatchEvent(new de(t))}function ve(t){bt.call(this,"timingevent",t)}function ge(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}x(fe,bt),x(de,bt),x(ve,bt);var me={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},we={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function be(){}function Ee(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}be.prototype.a=null;var Te,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Ae(){bt.call(this,"d")}function _e(){bt.call(this,"c")}function Se(){}function Re(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new oe(this),this.N=De,t=at?125:void 0,this.O=new te(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(Ae,bt),x(_e,bt),x(Se,be),Te=new Se;var De=45e3,Le={},Oe={};function Pe(t,e,n){t.B=1,t.f=Ze(Ye(e)),t.j=n,t.F=!0,ke(t,null)}function ke(t,e){t.s=M(),Ce(t),t.A=Ye(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),pn(n.b,"t",r),t.w=0,t.a=ir(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(C(t.ya,t,t.a),t.J)),ae(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),pe()}function Ve(t,e,n){for(var r,i,o,s,a=!0;!t.l&&t.w<n.length;){var u=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Oe:(o=Number(i.substring(o,s)),isNaN(o)?Le:(s+=1)+o>i.length?Oe:(i=i.substr(s,o),r.w=s+o,i)));if(u==Oe){4==e&&(t.c=4,ye(),a=!1);break}if(u==Le){t.c=4,ye(),a=!1;break}je(t,u)}4==e&&0==n.length&&(t.c=1,ye(),a=!1),t.b=t.b&&a,a||(Fe(t),xe(t))}function Ce(t){t.P=M()+t.N,Ue(t,t.N)}function Ue(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=ge(C(t.Qa,t),e)}function Me(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function xe(t){0==t.g.u||t.l||Zn(t.g,t)}function Fe(t){Me(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ee(t.O),ue(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function je(t,e){try{var n,r,i,o,s,a,u,h,c,l,f=t.g;if(0!=f.u&&(f.a==t||bn(f.b,t)))if(f.A=t.H,!t.o&&bn(f.b,t)&&3==f.u){try{var p=f.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!f.i){if(f.a){if(!(f.a.s+3e3<t.s))break t;Jn(f),f.a.cancel(),f.a=null}Kn(f),ye()}}else f.ia=d[1],0<f.ia-f.G&&d[2]<37500&&f.U&&0==f.m&&!f.l&&(f.l=ge(C(f.Na,f),6e3));if(wn(f.b)<=1&&f.O){try{f.O()}catch(t){}f.O=void 0}}else er(f,11)}else if(!t.o&&f.a!=t||Jn(f),!W(e))for(e=p=f.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],f.G=d[0],d=d[1],2==f.u?"c"==d[0]?(f.B=d[1],f.R=d[2],null!=(n=d[3])&&(f.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(f.D=1.5*r),i=f,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=i.b).a&&(Y(s,"spdy")||Y(s,"quic")||Y(s,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(En(a,a.b),a.b=null)),!i.s||(u=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=u,Je(i.v,i.s,u))),f.u=3,f.c&&f.c.na(),h=t,(i=f).ea=rr(i,i.w?i.R:null,i.P),h.o?(In(i.b,h),c=h,(l=i.D)&&c.setTimeout(l),c.h&&(Me(c),Ce(c)),i.a=h):Qn(i),0<f.f.length&&zn(f)):"stop"!=d[0]&&"close"!=d[0]||er(f,7):3==f.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?er(f,7):Gn(f):"noop"!=d[0]&&f.c&&f.c.ma(d),f.m=0)}pe()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ge(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Re.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!at&&!this.a.Y())){this.l||4!=e||7==n||pe(),Me(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.c=3,ye(),Fe(this),xe(this);break t}this.o=!0,je(this,a)}this.F?(Ve(this,e,i),at&&this.b&&3==e&&(ae(this.G,this.O,"tick",this.Ra),this.O.start())):je(this,i),4==e&&Fe(this),this.b&&!this.l&&(4==e?Zn(this.g,this):(this.b=!1,Ce(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ye(),Fe(this),xe(this)}}}catch(t){}},T.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(Me(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},T.cancel=function(){this.l=!0,Fe(this)},T.Qa=function(){this.h=null;var t=M();0<=t-this.P?(2!=this.B&&(pe(),ye()),Fe(this),this.c=2,xe(this)):Ue(this,this.P-t)},(T=Be.prototype).I=function(){Ge(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return Ge(this),this.a.concat()},T.get=function(t,e){return We(this.b,t)?this.b[t]:e},T.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Xe(this,t.c),Qe(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=tn(n[2]||""),Xe(this,n[3]||"",!0),Qe(this,n[4]),this.g=tn(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=tn(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Ye(t){return new ze(t)}function $e(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?tn(e,!0):e}function Qe(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,an)),t.b=new hn(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Ze(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",en(n,un)),t.join("")};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,an=/[#\?@]/g,un=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(a){a.a||(a.a=new Be,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function ln(t,e){cn(t),e=dn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ge(t)))}function fn(t,e){return cn(t),e=dn(t,e),We(t.a.b,e)}function pn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),G(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=hn.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){cn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){cn(this);var e=[];if("string"==typeof t)fn(this,t)&&(e=B(e,this.a.get(dn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return cn(this),this.c=null,fn(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=10;function mn(t){return t.b||t.a&&t.a.size>=t.f}function wn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function An(){this.a=new Nn}function _n(t,r,e){var i=e||"";try{qe(t,function(t,e){var n=t;L(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Rn=_.JSON.parse;function Dn(t){qt.call(this),this.headers=new Be,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Ln,this.B=this.F=!1}x(Dn,qt);var Ln="",On=/^https?$/i,Pn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Mn(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))ne(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(He)[1]||null)&&_.self&&_.self.location&&(i=(r=_.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Fn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.S()+"]",Cn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=qn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=qn("baseRetryDelayMs",5e3,t),this.Ga=qn("retryDelaySeedMs",1e4,t),this.Da=qn("forwardChannelMaxRetries",2,t),this.ga=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new vn(t&&t.concurrentRequestLimit),this.ja=new An,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Gn(t){var e,n;Wn(t),3==t.u&&(e=t.H++,Je(n=Ye(t.v),"SID",t.B),Je(n,"RID",e),Je(n,"TYPE","terminate"),$n(t,n),(e=new Re(t,e,void 0)).B=2,e.f=Ze(Ye(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ir(e.g,null),e.a.$(e.f)),e.s=M(),Ce(e)),nr(t)}function Wn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),Jn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function Hn(t,e){t.f.push(new yn(t.Fa++,e)),3==t.u&&zn(t)}function zn(t){mn(t.b)||t.g||(t.g=!0,Qt(t.xa,t),t.o=0)}function Yn(t,e){var n=e?e.W:t.H++,r=Ye(t.v);Je(r,"SID",t.B),Je(r,"RID",n),Je(r,"AID",t.G),$n(t,r),t.h&&t.j&&jn(r,t.h,t.j),n=new Re(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),En(t.b,n),Pe(n,r,e)}function $n(t,n){t.c&&qe({},function(t,e){Je(n,e,t)})}function Xn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{_n(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Qn(t){t.a||t.i||(t.J=1,Qt(t.wa,t),t.m=0)}function Kn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=ge(C(t.wa,t),tr(t,t.m)),t.m++,1)}function Jn(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function Zn(t,e){var n,r=null;if(t.a==e){Jn(t),t.a=null;var i=2}else{if(!bn(t.b,e))return;r=e.i,In(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.s,n=t.o,(i=le()).dispatchEvent(new ve(i)),zn(t)):Qn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(wn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=ge(C(t.xa,t,e),tr(t,t.o)),t.o++,1}}(t,e)||2==i&&Kn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function er(t,e){var n,r,i,o,s,a;2==e?(n=null,t.c&&(n=null),r=C(t.Ta,t),n||(n=new ze("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||$e(n,"https"),Ze(n)),i=n.toString(),o=r,a=new he,_.Image?((s=new Image).onload=U(Sn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=U(Sn,a,s,"TestLoadImage: error",!1,o),s.onabort=U(Sn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(Sn,a,s,"TestLoadImage: timeout",!1,o),_.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ye(),t.u=0,t.c&&t.c.la(e),nr(t),Wn(t)}function nr(t){t.u=0,t.A=-1,t.c&&(0==Tn(t.b).length&&0==t.f.length||(t.b.c.length=0,G(t.f),t.f.length=0),t.c.ka())}function rr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof ze?Ye(r):new ze(r,void 0);return""!=c.c?(e&&Xe(c,e+"."+c.c),Qe(c,c.h)):(o=(i=_.location).protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new ze(null,void 0),o&&$e(h,o),s&&Xe(h,s),a&&Qe(h,a),u&&(h.g=u),c=h),t.N&&K(t.N,function(t,e){Je(c,e,t)}),e=t.s,n=t.ha,e&&n&&Je(c,e,n),Je(c,"VER",t.oa),$n(t,c),c}function ir(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ea)).F=t.w,e}function or(){}function sr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function ar(t,e){qt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ur(t){Ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){_e.call(this),this.status=1}function cr(t){this.a=t}(T=Dn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ee(this.G):Ee(Te),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=j(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ne(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},T.ta=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Dn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Un(this):this.Oa())},T.Oa=function(){Un(this)},T.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Bn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Re(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=J(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Je(i=Ye(this.v),"RID",t),Je(i,"CVER",22),this.s&&Je(i,"X-HTTP-Session-Id",this.s),$n(this,i),this.h&&r&&jn(i,this.h,r),En(this.b,n),this.fa?(Je(i,"$req",e),Je(i,"SID","null"),n.R=!0,Pe(n,i,null)):Pe(n,i,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||mn(this.b)||Yn(this))},T.wa=function(){this.i=null,this.a=new Re(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ye(this.ea);Je(t,"RID","rpc"),Je(t,"SID",this.B),Je(t,"CI",this.U?"0":"1"),Je(t,"AID",this.G),$n(this,t),Je(t,"TYPE","xmlhttp"),this.h&&this.j&&jn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Ze(Ye(t)),e.j=null,e.F=!0,ke(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Kn(this),ye())},T.Ta=function(t){ye()},(T=or.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},sr.prototype.a=function(t,e){return new ar(t,e)},x(ar,qt),(T=ar.prototype).addEventListener=function(t,e,n,r){ar.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){ar.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(),t.P=e,t.N=n||{},t.U=t.W,t.v=rr(t,null,t.P),zn(t)},T.close=function(){Gn(this.a)},T.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Gt(t),Hn(this.a,e)):Hn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,Gn(this.a),delete this.a,ar.M.C.call(this)},x(ur,Ae),x(hr,_e),x(cr,or),cr.prototype.na=function(){this.a.dispatchEvent("a")},cr.prototype.ma=function(t){this.a.dispatchEvent(new ur(t))},cr.prototype.la=function(t){this.a.dispatchEvent(new hr)},cr.prototype.ka=function(){this.a.dispatchEvent("b")},sr.prototype.createWebChannel=sr.prototype.a,ar.prototype.send=ar.prototype.La,ar.prototype.open=ar.prototype.Ka,ar.prototype.close=ar.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ie.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",qt.prototype.listen=qt.prototype.ra,Dn.prototype.listenOnce=Dn.prototype.sa,Dn.prototype.getLastError=Dn.prototype.Ma,Dn.prototype.getLastErrorCode=Dn.prototype.qa,Dn.prototype.getStatus=Dn.prototype.S,Dn.prototype.getResponseJson=Dn.prototype.Ja,Dn.prototype.getResponseText=Dn.prototype.Y,Dn.prototype.send=Dn.prototype.$;var lr={createWebChannelTransport:function(){return new sr},ErrorCode:me,EventType:we,WebChannel:Ie,XhrIo:Dn},fr=lr.createWebChannelTransport,pr=lr.ErrorCode,dr=lr.EventType,yr=lr.WebChannel,vr=lr.XhrIo,gr=(mr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},mr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},mr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},mr);function mr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var wr=new h("@firebase/firestore");function br(){return wr.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=p.DEBUG&&(e=n.map(Tr),wr.debug.apply(wr,v(["Firestore (7.17.1): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=p.ERROR&&(e=n.map(Tr),wr.error.apply(wr,v(["Firestore (7.17.1): "+t],e)))}function Tr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Nr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.1) INTERNAL ASSERTION FAILED: "+t;throw Ir(e),new Error(e)}function Ar(t){t||Nr()}function _r(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Sr=(Rr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=_r(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Rr);function Rr(){}function Dr(t,e){return t<e?-1:e<t?1:0}function Lr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Or(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Pr=(Object.defineProperty(kr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),kr.prototype.isEqual=function(t){return t instanceof kr&&t.projectId===this.projectId&&t.database===this.database},kr.prototype.o=function(t){return Dr(this.projectId,t.projectId)||Dr(this.database,t.database)},kr);function kr(t,e){this.projectId=t,this.database=e||"(default)"}function Vr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ur(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,xr,Fr,jr=(ri.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.u(s,t))return a}},ri.prototype.has=function(t){return void 0!==this.get(t)},ri.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ri.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ri.prototype.forEach=function(a){Cr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},ri.prototype._=function(){return Ur(this.l)},ri),qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Br=(n(ni,Fr=Error),ni),Gr=(ei.now=function(){return ei.fromMillis(Date.now())},ei.fromDate=function(t){return ei.fromMillis(t.getTime())},ei.fromMillis=function(t){var e=Math.floor(t/1e3);return new ei(e,1e6*(t-1e3*e))},ei.prototype.toDate=function(){return new Date(this.toMillis())},ei.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ei.prototype.T=function(t){return this.seconds===t.seconds?Dr(this.nanoseconds,t.nanoseconds):Dr(this.seconds,t.seconds)},ei.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ei.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ei.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ei),Wr=(ti.m=function(t){return new ti(t)},ti.min=function(){return new ti(new Gr(0,0))},ti.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ti.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ti.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ti.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ti.prototype.R=function(){return this.timestamp},ti),Hr=(Object.defineProperty(Zr.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),Zr.prototype.isEqual=function(t){return 0===Zr.P(this,t)},Zr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Zr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},Zr.prototype.limit=function(){return this.offset+this.length},Zr.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},Zr.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},Zr.prototype.v=function(){return this.segments[this.offset]},Zr.prototype.S=function(){return this.get(this.length-1)},Zr.prototype.get=function(t){return this.segments[this.offset+t]},Zr.prototype._=function(){return 0===this.length},Zr.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Zr.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Zr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Zr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},Zr.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Zr),zr=(n(Jr,xr=Hr),Jr.prototype.V=function(t,e,n){return new Jr(t,e,n)},Jr.prototype.$=function(){return this.F().join("/")},Jr.prototype.toString=function(){return this.$()},Jr.N=function(t){if(0<=t.indexOf("//"))throw new Br(qr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Jr(t.split("/").filter(function(t){return 0<t.length}))},Jr.k=function(){return new Jr([])},Jr),Yr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$r=(n(Kr,Mr=Hr),Kr.prototype.V=function(t,e,n){return new Kr(t,e,n)},Kr.O=function(t){return Yr.test(t)},Kr.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Kr.O(t)||(t="`"+t+"`"),t}).join(".")},Kr.prototype.toString=function(){return this.$()},Kr.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},Kr.M=function(){return new Kr(["__name__"])},Kr.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Br(qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Br(qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Br(qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Kr(e)},Kr.k=function(){return new Kr([])},Kr),Xr=(Qr.U=function(t){return new Qr(zr.N(t).p(5))},Qr.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Qr.prototype.isEqual=function(t){return null!==t&&0===zr.P(this.path,t.path)},Qr.prototype.toString=function(){return this.path.toString()},Qr.P=function(t,e){return zr.P(t.path,e.path)},Qr.W=function(t){return t.length%2==0},Qr.j=function(t){return new Qr(new zr(t.slice()))},Qr);function Qr(t){this.path=t}function Kr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Jr(){return null!==xr&&xr.apply(this,arguments)||this}function Zr(t,e,n){void 0===e?e=0:e>t.length&&Nr(),void 0===n?n=t.length-e:n>t.length-e&&Nr(),this.segments=t,this.offset=e,this.A=n}function ti(t){this.timestamp=t}function ei(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Br(qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Br(qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ni(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ri(t,e){this.h=t,this.u=e,this.l={}}function ii(t){return null==t}function oi(t){return-0===t&&1/t==-1/0}var si=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function ai(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new si(t,e,n,r,i,o,s)}function ui(t){var e,n=t;return null===n.G&&(e=n.path.$(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.$()+e.op.toString()+co(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),ii(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Sa(n.startAt)),n.endAt&&(e+="|ub:",e+=Sa(n.endAt)),n.G=e),n.G}function hi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i,o,s=0;s<t.orderBy.length;s++)if(n=t.orderBy[s],r=e.orderBy[s],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var a=0;a<t.filters.length;a++)if(i=t.filters[a],o=e.filters[a],!(i instanceof ha&&o instanceof ha&&i.op===o.op&&i.field.isEqual(o.field)&&so(i.value,o.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Da(t.startAt,e.startAt)&&Da(t.endAt,e.endAt)}function ci(t){return Xr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var li=(fi.fromBase64String=function(t){return new fi(atob(t))},fi.fromUint8Array=function(t){return new fi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},fi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},fi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},fi.prototype.H=function(){return 2*this.K.length},fi.prototype.o=function(t){return Dr(this.K,t.K)},fi.prototype.isEqual=function(t){return this.K===t.K},fi);function fi(t){this.K=t}function pi(t){this.count=t}li.Y=new li("");var di,yi,vi=(gi.prototype.Z=function(t){return new gi(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},gi.prototype.tt=function(t,e){return new gi(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},gi.prototype.et=function(t){return new gi(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},gi);function gi(t,e,n,r,i,o,s){void 0===i&&(i=Wr.min()),void 0===o&&(o=Wr.min()),void 0===s&&(s=li.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function mi(t){switch(t){case qr.OK:return Nr();case qr.CANCELLED:case qr.UNKNOWN:case qr.DEADLINE_EXCEEDED:case qr.RESOURCE_EXHAUSTED:case qr.INTERNAL:case qr.UNAVAILABLE:case qr.UNAUTHENTICATED:return;case qr.INVALID_ARGUMENT:case qr.NOT_FOUND:case qr.ALREADY_EXISTS:case qr.PERMISSION_DENIED:case qr.FAILED_PRECONDITION:case qr.ABORTED:case qr.OUT_OF_RANGE:case qr.UNIMPLEMENTED:case qr.DATA_LOSS:return 1;default:return Nr()}}function wi(t){if(void 0===t)return Ir("GRPC error has no .code"),qr.UNKNOWN;switch(t){case di.OK:return qr.OK;case di.CANCELLED:return qr.CANCELLED;case di.UNKNOWN:return qr.UNKNOWN;case di.DEADLINE_EXCEEDED:return qr.DEADLINE_EXCEEDED;case di.RESOURCE_EXHAUSTED:return qr.RESOURCE_EXHAUSTED;case di.INTERNAL:return qr.INTERNAL;case di.UNAVAILABLE:return qr.UNAVAILABLE;case di.UNAUTHENTICATED:return qr.UNAUTHENTICATED;case di.INVALID_ARGUMENT:return qr.INVALID_ARGUMENT;case di.NOT_FOUND:return qr.NOT_FOUND;case di.ALREADY_EXISTS:return qr.ALREADY_EXISTS;case di.PERMISSION_DENIED:return qr.PERMISSION_DENIED;case di.FAILED_PRECONDITION:return qr.FAILED_PRECONDITION;case di.ABORTED:return qr.ABORTED;case di.OUT_OF_RANGE:return qr.OUT_OF_RANGE;case di.UNIMPLEMENTED:return qr.UNIMPLEMENTED;case di.DATA_LOSS:return qr.DATA_LOSS;default:return Nr()}}(yi=di=di||{})[yi.OK=0]="OK",yi[yi.CANCELLED=1]="CANCELLED",yi[yi.UNKNOWN=2]="UNKNOWN",yi[yi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yi[yi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yi[yi.NOT_FOUND=5]="NOT_FOUND",yi[yi.ALREADY_EXISTS=6]="ALREADY_EXISTS",yi[yi.PERMISSION_DENIED=7]="PERMISSION_DENIED",yi[yi.UNAUTHENTICATED=16]="UNAUTHENTICATED",yi[yi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yi[yi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yi[yi.ABORTED=10]="ABORTED",yi[yi.OUT_OF_RANGE=11]="OUT_OF_RANGE",yi[yi.UNIMPLEMENTED=12]="UNIMPLEMENTED",yi[yi.INTERNAL=13]="INTERNAL",yi[yi.UNAVAILABLE=14]="UNAVAILABLE",yi[yi.DATA_LOSS=15]="DATA_LOSS";var bi=(Ai.prototype.nt=function(t,e){return new Ai(this.P,this.root.nt(t,e,this.P).copy(null,null,Ii.st,null,null))},Ai.prototype.remove=function(t){return new Ai(this.P,this.root.remove(t,this.P).copy(null,null,Ii.st,null,null))},Ai.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ai.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ai.prototype._=function(){return this.root._()},Object.defineProperty(Ai.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ai.prototype.it=function(){return this.root.it()},Ai.prototype.rt=function(){return this.root.rt()},Ai.prototype.ot=function(t){return this.root.ot(t)},Ai.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ai.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ai.prototype.ht=function(t){return this.root.ht(t)},Ai.prototype.at=function(){return new Ei(this.root,null,this.P,!1)},Ai.prototype.ut=function(t){return new Ei(this.root,t,this.P,!1)},Ai.prototype.ct=function(){return new Ei(this.root,null,this.P,!0)},Ai.prototype.lt=function(t){return new Ei(this.root,t,this.P,!0)},Ai),Ei=(Ni.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ni.prototype.wt=function(){return 0<this.ft.length},Ni.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ni),Ii=(Ti.prototype.copy=function(t,e,n,r,i){return new Ti(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ti.prototype._=function(){return!1},Ti.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ti.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ti.prototype.min=function(){return this.left._()?this:this.left.min()},Ti.prototype.it=function(){return this.min().key},Ti.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ti.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ti.prototype.It=function(){if(this.left._())return Ti.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ti.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.At()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.Pt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ti.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ti.prototype.Rt=function(){return this.color},Ti.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Ti.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Ti.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Ti.prototype.pt=function(){var t=this.copy(null,null,Ti.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ti.prototype.Pt=function(){var t=this.copy(null,null,Ti.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ti.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ti.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Ti.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Nr();if(this.right.Rt())throw Nr();var t=this.left.vt();if(t!==this.right.vt())throw Nr();return t+(this.Rt()?0:1)},Ti);function Ti(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ti.RED,this.left=null!=r?r:Ti.EMPTY,this.right=null!=i?i:Ti.EMPTY,this.size=this.left.size+1+this.right.size}function Ni(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ai(t,e){this.P=t,this.root=e||Ii.EMPTY}function _i(){this.size=0}Ii.EMPTY=null,Ii.RED=!0,Ii.st=!1,Ii.EMPTY=(Object.defineProperty(_i.prototype,"key",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"value",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"color",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"left",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"right",{get:function(){throw Nr()},enumerable:!1,configurable:!0}),_i.prototype.copy=function(t,e,n,r,i){return this},_i.prototype.nt=function(t,e,n){return new Ii(t,e)},_i.prototype.remove=function(t,e){return this},_i.prototype._=function(){return!0},_i.prototype.ot=function(t){return!1},_i.prototype.ht=function(t){return!1},_i.prototype.it=function(){return null},_i.prototype.rt=function(){return null},_i.prototype.Rt=function(){return!1},_i.prototype.gt=function(){return!0},_i.prototype.vt=function(){return 0},new _i);var Si=(Oi.prototype.has=function(t){return null!==this.data.get(t)},Oi.prototype.first=function(){return this.data.it()},Oi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Oi.prototype.indexOf=function(t){return this.data.indexOf(t)},Oi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Oi.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Oi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Oi.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Oi.prototype.at=function(){return new Ri(this.data.at())},Oi.prototype.ut=function(t){return new Ri(this.data.ut(t))},Oi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Oi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Oi.prototype._=function(){return this.data._()},Oi.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Oi.prototype.isEqual=function(t){if(!(t instanceof Oi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Oi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Oi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Oi.prototype.copy=function(t){var e=new Oi(this.P);return e.data=t,e},Oi),Ri=(Li.prototype.dt=function(){return this.Ft.dt().key},Li.prototype.wt=function(){return this.Ft.wt()},Li),Di=new bi(Xr.P);function Li(t){this.Ft=t}function Oi(t){this.P=t,this.data=new bi(this.P)}var Pi=new bi(Xr.P);var ki=new bi(Xr.P),Vi=new Si(Xr.P);function Ci(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Vi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ui=new Si(Dr);function Mi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function xi(t,e){this.targetId=t,this.ee=e}function Fi(t,e,n,r){void 0===n&&(n=li.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var ji=(Zi.kt=function(t){return new Zi(t.P)},Zi.prototype.has=function(t){return null!=this.$t.get(t)},Zi.prototype.get=function(t){return this.$t.get(t)},Zi.prototype.first=function(){return this.Nt.it()},Zi.prototype.last=function(){return this.Nt.rt()},Zi.prototype._=function(){return this.Nt._()},Zi.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(Zi.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),Zi.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},Zi.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},Zi.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},Zi.prototype.isEqual=function(t){if(!(t instanceof Zi))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},Zi.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Zi.prototype.copy=function(t,e){var n=new Zi;return n.P=this.P,n.$t=t,n.Nt=e,n},Zi),qi=(Ji.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Nr()},Ji.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},Ji),Bi=(Ki.Bt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ki(t,e,ji.kt(e),i,n,r,!0,!1)},Object.defineProperty(Ki.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),Ki.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&ra(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ki),Gi=(Qi.Kt=function(t,e){var n=new Map;return n.set(t,Wi.zt(t,e)),new Qi(Wr.min(),n,Ui,Di,Ci())},Qi),Wi=(Xi.zt=function(t,e){return new Xi(li.Y,e,Ci(),Ci(),Ci())},Xi),Hi=(Object.defineProperty($i.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),$i.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},$i.prototype.ce=function(){var n=Ci(),r=Ci(),i=Ci();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Nr()}}),new Wi(this.ie,this.re,n,r,i)},$i.prototype.le=function(){this.oe=!1,this.se=eo()},$i.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},$i.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},$i.prototype.de=function(){this.ne+=1},$i.prototype.we=function(){--this.ne},$i.prototype.Te=function(){this.oe=!0,this.re=!0},$i),zi=(Yi.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof qs?this.Ve(r,t.te):t.te instanceof Bs&&this.pe(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.pe(s,t.key,t.te)}},Yi.prototype.ye=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Nr()}})},Yi.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},Yi.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.De(r);o&&(ci(e=o.target)?0===i?(n=new Xr(e.path),this.pe(r,n,new Bs(n,Wr.min()))):Ar(1===i):this.Fe(r)!==i&&(this.Se(r),this.Ae=this.Ae.add(r)))},Yi.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.De(e);r&&(t.Ht&&ci(r.target)&&(n=new Xr(r.target.path),null!==o.Ie.get(n)||o.Ne(e,n)||o.pe(e,n,new Bs(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Ci();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new Gi(i,s,this.Ae,this.Ie,r);return this.Ie=Di,this.Re=to(),this.Ae=new Si(Dr),t},Yi.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.Ne(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},Yi.prototype.pe=function(t,e,n){var r;this.be(t)&&(r=this.ve(t),this.Ne(t,e)?r._e(e,1):r.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},Yi.prototype.removeTarget=function(t){this.me.delete(t)},Yi.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},Yi.prototype.de=function(t){this.ve(t).de()},Yi.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Hi,this.me.set(t,e)),e},Yi.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Si(Dr),this.Re=this.Re.nt(t,e)),e},Yi.prototype.be=function(t){var e=null!==this.De(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},Yi.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},Yi.prototype.Se=function(e){var n=this;this.me.set(e,new Hi),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},Yi.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},Yi);function Yi(t){this.Ee=t,this.me=new Map,this.Ie=Di,this.Re=to(),this.Ae=new Si(Dr)}function $i(){this.ne=0,this.se=eo(),this.ie=li.Y,this.re=!1,this.oe=!0}function Xi(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function Qi(t,e,n,r,i){this.J=t,this.Wt=e,this.Qt=n,this.jt=r,this.Gt=i}function Ki(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Ut=a}function Ji(){this.xt=new bi(Xr.P)}function Zi(n){this.P=n?function(t,e){return n(t,e)||Xr.P(t.key,e.key)}:function(t,e){return Xr.P(t.key,e.key)},this.$t=Pi,this.Nt=new bi(this.P)}function to(){return new bi(Xr.P)}function eo(){return new bi(Xr.P)}function no(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ro(t){var e=lo(t.mapValue.fields.__local_write_time__.timestampValue);return new Gr(e.seconds,e.nanos)}var io=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?no(t)?4:10:Nr()}function so(r,i){var t,e,n,o=oo(r);if(o!==oo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ro(r).isEqual(ro(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=lo(r.timestampValue),n=lo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,po(r.bytesValue).isEqual(po(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,fo((t=r).geoPointValue.latitude)===fo(e.geoPointValue.latitude)&&fo(t.geoPointValue.longitude)===fo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fo(t.integerValue)===fo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=fo(t.doubleValue),r=fo(e.doubleValue);return n===r?oi(n)===oi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Lr(r.arrayValue.values||[],i.arrayValue.values||[],so);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Vr(t)!==Vr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!so(t[n],e[n])))return!1;return!0}();default:return Nr()}}function ao(t,e){return void 0!==(t.values||[]).find(function(t){return so(t,e)})}function uo(t,e){var n,r,i,o,s,a,u,h,c,l,f=oo(t),p=oo(e);if(f!==p)return Dr(f,p);switch(f){case 0:return 0;case 1:return Dr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=fo(t.integerValue||t.doubleValue))<(l=fo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return ho(t.timestampValue,e.timestampValue);case 4:return ho(ro(t),ro(e));case 5:return Dr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=po(o),u=po(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Dr(n[i],r[i]);if(0!==o)return o}return Dr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Dr(fo(n.latitude),fo(r.latitude)))?i:Dr(fo(n.longitude),fo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=uo(n[i],r[i]);if(o)return o}return Dr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Dr(r[s],o[s]);if(0!==a)return a;var u=uo(n[r[s]],i[o[s]]);if(0!==u)return u}return Dr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Nr()}}function ho(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Dr(t,e);var n=lo(t),r=lo(e),i=Dr(n.seconds,r.seconds);return 0!==i?i:Dr(n.nanos,r.nanos)}function co(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=lo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?po(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Xr.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Nr();var t,e,n}(t)}function lo(t){if(Ar(!!t),"string"!=typeof t)return{seconds:fo(t.seconds),nanos:fo(t.nanos)};var e,n=0,r=io.exec(t);Ar(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function fo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function po(t){return"string"==typeof t?li.fromBase64String(t):li.fromUint8Array(t)}function yo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function vo(t){return t&&"integerValue"in t}function go(t){return!!t&&"arrayValue"in t}function mo(t){return t&&"nullValue"in t}function wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bo(t){return t&&"mapValue"in t}var Eo={asc:"ASCENDING",desc:"DESCENDING"},Io={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},To=function(t,e){this.s=t,this.Le=e};function No(t){return{integerValue:""+t}}function Ao(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oi(e)?"-0":e}}function _o(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!oi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?No(e):Ao(t,e);var n}function So(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ro(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Do(t){return Ar(!!t),Wr.m((e=lo(t),new Gr(e.seconds,e.nanos)));var e}function Lo(t,e){return new zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function Oo(t,e){return Lo(t.s,e.path)}function Po(t,e){var n,r,i=(Ar(Fo(r=zr.N(e))),r);return Ar(i.get(1)===t.s.projectId),Ar(!i.get(3)&&!t.s.database||i.get(3)===t.s.database),new Xr((Ar(4<(n=i).length&&"documents"===n.get(4)),n.p(5)))}function ko(t,e){return Lo(t.s,e)}function Vo(t){return new zr(["projects",t.s.projectId,"databases",t.s.database]).$()}function Co(t,e,n){return{name:Oo(t,e),fields:n.proto.mapValue.fields}}function Uo(t,e){var n,r,i,o;if(e instanceof gs)n={update:Co(t,e.key,e.value)};else if(e instanceof Rs)n={delete:Oo(t,e.key)};else if(e instanceof ms)n={update:Co(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Ts)n={transform:{document:Oo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Wo)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ho)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof Qo)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof ts)return{fieldPath:t.field.$(),increment:e.qe};throw Nr()})}};else{if(!(e instanceof Ds))return Nr();n={verify:Oo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:So(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Nr()),n}function Mo(t){return{before:t.before,values:t.position}}function xo(t){return{fieldPath:t.$()}}function Fo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function jo(){this.We=void 0}function qo(t,e){return t instanceof ts?vo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Bo,Go,Wo=(n(Yo,Go=jo),Yo),Ho=(n(zo,Bo=jo),zo);function zo(t){var e=this;return(e=Bo.call(this)||this).elements=t,e}function Yo(){return null!==Go&&Go.apply(this,arguments)||this}function $o(t,e){for(var n=rs(e),r=function(e){n.some(function(t){return so(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Xo,Qo=(n(Ko,Xo=jo),Ko);function Ko(t){var e=this;return(e=Xo.call(this)||this).elements=t,e}function Jo(t,e){for(var n=rs(e),r=function(e){n=n.filter(function(t){return!so(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Zo,ts=(n(es,Zo=jo),es);function es(t,e){var n=this;return(n=Zo.call(this)||this).serializer=t,n.qe=e,n}function ns(t){return fo(t.integerValue||t.doubleValue)}function rs(t){return go(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function is(t,e){this.field=t,this.transform=e}var os=(ss.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ss.prototype.isEqual=function(t){return Lr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ss);function ss(t){(this.fields=t).sort($r.P)}function as(t,e){this.version=t,this.transformResults=e}var us=(hs.je=function(){return new hs},hs.exists=function(t){return new hs(void 0,t)},hs.updateTime=function(t){return new hs(t)},Object.defineProperty(hs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),hs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},hs);function hs(t,e){this.updateTime=t,this.exists=e}function cs(t,e){return void 0!==t.updateTime?e instanceof qs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof qs}function ls(){}function fs(t,e,n,r){return t instanceof gs?function(t,e){if(!cs(t.Be,e))return e;var n=ds(e);return new qs(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof ms?function(t,e){if(!cs(t.Be,e))return e;var n=ds(e),r=Es(t,e);return new qs(t.key,n,r,{Ge:!0})}(t,e):t instanceof Ts?function(t,e,n,r){if(!cs(t.Be,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof qs&&(y=n.field(p.field)),null===y&&r instanceof qs&&(y=r.field(p.field)),c.push((o=y,h=u=a=s=void 0,(i=d)instanceof Wo?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof Ho?$o(i,o):i instanceof Qo?Jo(i,o):(u=ns(a=qo(s=i,o))+ns(s.qe),vo(a)&&vo(s.qe)?No(u):Ao(s.serializer,u))))}return c}(t.fieldTransforms,n,e,r),s=As(t,i.data(),o);return new qs(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,cs((i=t).Be,o)?new Bs(i.key,Wr.min()):o);var i,o}function ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||Lr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Ho&&o instanceof Ho||i instanceof Qo&&o instanceof Qo?Lr(i.elements,o.elements,so):i instanceof ts&&o instanceof ts?so(i.qe,o.qe):i instanceof Wo&&o instanceof Wo);var n,r,i,o}))}function ds(t){return t instanceof qs?t.version:Wr.min()}var ys,vs,gs=(n(bs,vs=ls),bs),ms=(n(ws,ys=ls),ws);function ws(t,e,n,r){var i=this;return(i=ys.call(this)||this).key=t,i.data=e,i.Me=n,i.Be=r,i.type=1,i}function bs(t,e,n){var r=this;return(r=vs.call(this)||this).key=t,r.value=e,r.Be=n,r.type=0,r}function Es(t,e){return n=t,r=e instanceof qs?e.data():Ls.empty(),i=new Os(r),n.Me.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ke();var n,r,i}var Is,Ts=(n(Ns,Is=ls),Ns);function Ns(t,e){var n=this;return(n=Is.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=us.exists(!0),n}function As(t,e,n){for(var r=new Os(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ke()}var _s,Ss,Rs=(n(Cs,Ss=ls),Cs),Ds=(n(Vs,_s=ls),Vs),Ls=(ks.empty=function(){return new ks({mapValue:{}})},ks.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!bo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},ks.prototype.isEqual=function(t){return so(this.proto,t.proto)},ks),Os=(Ps.prototype.set=function(t,e){return this.Ye(t,e),this},Ps.prototype.delete=function(t){return this.Ye(t,null),this},Ps.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===oo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Ps.prototype.Ke=function(){var t=this.Xe($r.k(),this.He);return null!=t?new Ls(t):this.ze},Ps.prototype.Xe=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=bo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ps);function Ps(t){void 0===t&&(t=Ls.empty()),this.ze=t,this.He=new Map}function ks(t){this.proto=t}function Vs(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.Be=e,n.type=4,n}function Cs(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.Be=e,n.type=3,n}function Us(t){var a=[];return Cr(t.fields||{},function(t,e){var n=new $r([t]);if(bo(e)){var r=Us(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new os(a)}function Ms(t,e){this.key=t,this.version=e}var xs,Fs,js,qs=(n(zs,js=Ms),zs.prototype.field=function(t){return this.Je.field(t)},zs.prototype.data=function(){return this.Je},zs.prototype.Ze=function(){return this.Je.proto},zs.prototype.isEqual=function(t){return t instanceof zs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},zs.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(zs.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),zs),Bs=(n(Hs,Fs=Ms),Hs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Hs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Hs.prototype.isEqual=function(t){return t instanceof Hs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Hs),Gs=(n(Ws,xs=Ms),Ws.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ws.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ws.prototype.isEqual=function(t){return t instanceof Ws&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ws);function Ws(){return null!==xs&&xs.apply(this,arguments)||this}function Hs(t,e,n){var r=this;return(r=Fs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function zs(t,e,n,r){var i=this;return(i=js.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ys(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Br(qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Br(qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var $s=(Xs.prototype.rn=function(t){return new Xs(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},Xs.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},Xs.prototype.hn=function(){return!ii(this.limit)&&"F"===this.en},Xs.prototype.an=function(){return!ii(this.limit)&&"L"===this.en},Xs.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},Xs.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},Xs.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},Xs);function Xs(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function Qs(t){return new $s(t)}function Ks(t){return null!==t.collectionGroup}function Js(t){var e=Ys(t,$s);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.L()||e.nn.push(new La(n)),e.nn.push(new La($r.M(),"asc"));else{for(var i,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.L()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new La($r.M(),i)))}}return e.nn}function Zs(t){var e=Ys(t,$s);if(!e.sn)if("F"===e.en)e.sn=ai(e.path,e.collectionGroup,Js(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Js(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new La(o.field,s))}var a=e.endAt?new Ea(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ea(e.startAt.position,!e.startAt.before):null;e.sn=ai(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function ta(t,e,n){return new $s(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ea(t,e){return new $s(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function na(t,e){return new $s(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function ra(t,e){return hi(Zs(t),Zs(e))&&t.en===e.en}function ia(t){return ui(Zs(t))+"|lt:"+t.en}function oa(t){return"Query(target="+(n=(e=Zs(t)).path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+co(e.value);var e}).join(", ")+"]"),ii(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Sa(e.startAt)),e.endAt&&(n+=", endAt: "+Sa(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function sa(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.B(r.collectionGroup)&&r.path.C(o):Xr.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ra(e.startAt,Js(e),n))&&(!e.endAt||!Ra(e.endAt,Js(e),n)));var e,n,r,o}function aa(a){return function(t,e){for(var n=!1,r=0,i=Js(a);r<i.length;r++){var o=i[r],s=Oa(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var ua,ha=(n(ca,ua=function(){}),ca.create=function(t,e,n){if(t.L())return"in"===e?new ga(t,n):new va(t,e,n);if(mo(n)){if("=="!==e)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ca(t,e,n)}if(wo(n)){if("=="!==e)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ca(t,e,n)}return"array-contains"===e?new ma(t,n):"in"===e?new wa(t,n):"array-contains-any"===e?new ba(t,n):new ca(t,e,n)},ca.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&oo(this.value)===oo(e)&&this.fn(uo(e,this.value))},ca.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Nr()}},ca.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},ca);function ca(t,e,n){var r=this;return(r=ua.call(this)||this).field=t,r.op=e,r.value=n,r}var la,fa,pa,da,ya,va=(n(_a,ya=ha),_a.prototype.matches=function(t){var e=Xr.P(t.key,this.key);return this.fn(e)},_a),ga=(n(Aa,da=ha),Aa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Aa),ma=(n(Na,pa=ha),Na.prototype.matches=function(t){var e=t.field(this.field);return go(e)&&ao(e.arrayValue,this.value)},Na),wa=(n(Ta,fa=ha),Ta.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ao(this.value.arrayValue,e)},Ta),ba=(n(Ia,la=ha),Ia.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!go(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ao(e.value.arrayValue,t)})},Ia),Ea=function(t,e){this.position=t,this.before=e};function Ia(t,e){return la.call(this,t,"array-contains-any",e)||this}function Ta(t,e){return fa.call(this,t,"in",e)||this}function Na(t,e){return pa.call(this,t,"array-contains",e)||this}function Aa(t,e){var n=this;return(n=da.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Xr.U(t.referenceValue)}),n}function _a(t,e,n){var r=this;return(r=ya.call(this,t,e,n)||this).key=Xr.U(n.referenceValue),r}function Sa(t){return(t.before?"b":"a")+":"+t.position.map(co).join(",")}function Ra(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.L()?Xr.P(Xr.U(s.referenceValue),n.key):uo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Da(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!so(t.position[n],e.position[n]))return!1;return!0}var La=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Oa(t,e,n){var r,i,o,s,a=t.field.L()?Xr.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?uo(o,s):Nr());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return Nr()}}var Pa=(Ga.prototype.wn=function(t,e,n){for(var r,i,o,s=n.Tn,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(r=u,i=e,o=s[a],e=r instanceof gs?new qs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof ms?function(t,e,n){if(!cs(t.Be,e))return new Gs(t.key,n.version);var r=Es(t,e);return new qs(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Ts?function(t,e,n){if(Ar(null!=n.transformResults),!cs(t.Be,e))return new Gs(t.key,n.version);var r=e,i=function(t,e,n){var r,i,o,s=[];Ar(t.length===n.length);for(var a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof qs&&(c=e.field(u.field)),s.push((r=h,i=c,o=n[a],r instanceof Ho?$o(r,i):r instanceof Qo?Jo(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=As(t,r.data(),i);return new qs(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Bs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ga.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=fs(i,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=fs(u,e,o,this.dn))}return e},Ga.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ci())},Ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&Lr(this.mutations,t.mutations,ps)&&Lr(this.baseMutations,t.baseMutations,ps)},Ga),ka=(Ba.from=function(t,e,n){Ar(t.mutations.length===n.length);for(var r=ki,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Ba(t,e,n,r)},Ba),Va=(qa.prototype.catch=function(t){return this.next(void 0,t)},qa.prototype.next=function(r,i){var o=this;return this.pn&&Nr(),this.pn=!0,this.Vn?this.error?this.yn(i,this.error):this.gn(r,this.result):new qa(function(e,n){o.An=function(t){o.gn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},qa.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},qa.prototype.bn=function(t){try{var e=t();return e instanceof qa?e:qa.resolve(e)}catch(t){return qa.reject(t)}},qa.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):qa.resolve(e)},qa.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):qa.reject(e)},qa.resolve=function(n){return new qa(function(t,e){t(n)})},qa.reject=function(n){return new qa(function(t,e){e(n)})},qa.Sn=function(t){return new qa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},qa.Cn=function(t){for(var n=qa.resolve(!1),e=function(e){n=n.next(function(t){return t?qa.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},qa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},qa),Ca=(ja.prototype.Nn=function(e,n){var r=this;return this.Fn.kn(e,n).next(function(t){return r.xn(e,n,t)})},ja.prototype.xn=function(t,r,i){return this.Dn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},ja.prototype.Ln=function(t,e,i){var o=Di;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},ja.prototype.Mn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.qn(e,t)})},ja.prototype.qn=function(r,i){var o=this;return this.Fn.Un(r,i).next(function(t){var e=o.Ln(r,i,t),n=Di;return e.forEach(function(t,e){e=e||new Bs(t,Wr.min()),n=n.nt(t,e)}),n})},ja.prototype.Bn=function(t,e,n){return r=e,Xr.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wn(t,e.path):Ks(e)?this.Qn(t,e,n):this.jn(t,e,n);var r},ja.prototype.Wn=function(t,e){return this.Nn(t,new Xr(e)).next(function(t){var e=Pi;return t instanceof qs&&(e=e.nt(t.key,t)),e})},ja.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,a=Pi;return this.$n.Gn(n,s).next(function(t){return Va.forEach(t,function(t){var e=r.rn(t.child(s));return o.jn(n,e,i).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},ja.prototype.jn=function(e,n,t){var c,l,r=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,r.Fn.Kn(e,n)}).next(function(t){return l=t,r.zn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=fs(s,u,u,r.dn);c=h instanceof qs?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){sa(n,e)||(c=c.remove(t))}),c})},ja.prototype.zn=function(t,e,n){for(var r=Ci(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ms&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.Dn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof qs&&(h=h.nt(t,e))}),h})},ja),Ua=(Fa.Xn=function(t,e){for(var n=Ci(),r=Ci(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Fa(t,e.fromCache,n,r)},Fa),Ma=(xa.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},xa.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},xa);function xa(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function Fa(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=r}function ja(t,e,n){this.Dn=t,this.Fn=e,this.$n=n}function qa(t){var e=this;this.An=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Ba(t,e,n,r){this.batch=t,this.In=e,this.Tn=n,this.Rn=r}function Ga(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}function Wa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Ma.ns=-1;var Ha=(Ja.prototype.reset=function(){this.us=0},Ja.prototype._s=function(){this.us=this.as},Ja.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),r=Math.max(0,Date.now()-this.ls),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.cs=this.ss.ws(this.rs,i,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},Ja.prototype.Ts=function(){null!==this.cs&&(this.cs.Es(),this.cs=null)},Ja.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},Ja.prototype.ds=function(){return(Math.random()-.5)*this.us},Ja),za=(Ka.prototype.Is=function(t,e){return this.ms.add(e),Va.resolve()},Ka.prototype.Gn=function(t,e){return Va.resolve(this.ms.getEntries(e))},Ka),Ya=(Qa.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Si(zr.P),i=!r.has(n);return this.index[e]=r.add(n),i},Qa.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},Qa.prototype.getEntries=function(t){return(this.index[t]||new Si(zr.P)).F()},Qa),$a=(Xa.prototype.next=function(){return this.Rs+=2,this.Rs},Xa.As=function(){return new Xa(0)},Xa.Ps=function(){return new Xa(-1)},Xa);function Xa(t){this.Rs=t}function Qa(){this.index={}}function Ka(){this.ms=new Ya}function Ja(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=r,this.as=i,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function Za(t){return"IndexedDbTransactionError"===t.name}function tu(){return"undefined"!=typeof window?window:null}var eu=(iu.vs=function(t,e,n,r,i){var o=new iu(t,e,Date.now()+n,r,i);return o.start(n),o},iu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},iu.prototype.Es=function(){return this.Ss()},iu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new Br(qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},iu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},iu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},iu),nu=(Object.defineProperty(ru.prototype,"qs",{get:function(){return this.$s},enumerable:!1,configurable:!0}),ru.prototype.Cs=function(t){this.enqueue(t)},ru.prototype.Us=function(t){this.Bs(),this.Ws(t)},ru.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},ru.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.$s?[3,2]:(this.$s=!0,(e=tu())&&e.removeEventListener("visibilitychange",this.Ms),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ru.prototype.enqueue=function(t){return this.Bs(),this.$s?new Promise(function(t){}):this.Ws(t)},ru.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.Ks()})},ru.prototype.Ks=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Ls.reset(),[3,4];case 3:if(!Za(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Ls.fs(function(){return n.Ks()}),t.label=5;case 5:return[2]}})})},ru.prototype.Ws=function(t){var r=this,e=this.Ds.then(function(){return r.xs=!0,t().catch(function(t){throw r.ks=t,r.xs=!1,Ir("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xs=!1,t})});return this.Ds=e},ru.prototype.ws=function(t,e,n){var r=this;this.Bs(),-1<this.Os.indexOf(t)&&(e=0);var i=eu.vs(this,t,e,n,function(t){return r.zs(t)});return this.Ns.push(i),i},ru.prototype.Bs=function(){this.ks&&Nr()},ru.prototype.Hs=function(){},ru.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},ru.prototype.Xs=function(t){for(var e=0,n=this.Ns;e<n.length;e++)if(n[e].rs===t)return!0;return!1},ru.prototype.Js=function(r){var i=this;return this.Ys().then(function(){i.Ns.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=i.Ns;t<e.length;t++){var n=e[t];if(n.Es(),"all"!==r&&n.rs===r)break}return i.Ys()})},ru.prototype.Zs=function(t){this.Os.push(t)},ru.prototype.zs=function(t){var e=this.Ns.indexOf(t);this.Ns.splice(e,1)},ru);function ru(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.$s=!1,this.Ns=[],this.ks=null,this.xs=!1,this.Os=[],this.Ls=new Ha(this,"async_queue_retry"),this.Ms=function(){return t.Ls.Ts()};var e=tu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ms)}function iu(t,e,n,r,i){this.Vs=t,this.rs=e,this.ps=n,this.op=r,this.ys=i,this.gs=new Wa,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function ou(t,e){if(Ir("AsyncQueue",e+": "+t),Za(t))return new Br(qr.UNAVAILABLE,e+": "+t);throw t}var su=(au.si=function(t){return new au(t,au.ii,au.ri)},au);function au(t,e,n){this.ti=t,this.ei=e,this.ni=n}su.oi=-1,su.hi=1048576,su.ai=41943040,su.ii=10,su.ri=1e3,su.ui=new su(su.ai,su.ii,su.ri),su.ci=new su(su.oi,0,0);var uu=(hu.prototype.Vi=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ri,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Fn.pi(v).next(function(t){return g=t,e=r.persistence.wi(i),m=new Ca(r.Ti,e,r.persistence.Ai()),e.pi(v)}).next(function(t){for(var e=[],n=[],r=Ci(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Mn(v,r).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ri=m,this.li.Pi(this.Ri),n)]}})})},hu.prototype.bi=function(h){var c,l=this,f=Gr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Ci());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ri.Mn(u,t).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof Ts?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof qs?t.field(i.field):void 0,s=qo(i.transform,o||null);null!=s&&(e=null==e?(new Os).set(i.field,s):e.set(i.field,s))}return e?e.Ke():null}(e):null);null!=s&&n.push(new ms(o.key,s,Us(s.proto.mapValue),us.exists(!0)))}return l.Fn.Si(u,f,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Ci:e}})},hu.prototype.Di=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ti.Fi({$i:!0});return i.Ni(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Fn.ki(t)}).next(function(){return i.Ri.Mn(t,e)})})},hu.prototype.xi=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Fn.Oi(e,t).next(function(t){return Ar(null!==t),n=t.keys(),r.Fn.Li(e,t)}).next(function(){return r.Fn.ki(e)}).next(function(){return r.Ri.Mn(e,n)})})},hu.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.Mi(t)})},hu.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mi.qi(t)})},hu.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ti.Fi({$i:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.mi.Bi(o,t.Jt,e).next(function(){return h.mi.Wi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Qi),l=l.nt(e,r),hu.ji(i,r,t)&&s.push(h.mi.Gi(o,r))))});var t,a=Di,n=Ci();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.jt.forEach(function(t,e){var n=r.get(t);e instanceof Bs&&e.version.isEqual(Wr.min())?(i.Ki(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.zi(e,c),a=a.nt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),c.isEqual(Wr.min())||(t=h.mi.qi(o).next(function(t){return h.mi.Xi(o,o.Qi,c)}),s.push(t)),Va.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ri.qn(o,a)})}).then(function(t){return h._i=l,t})},hu.ji=function(t,e,n){return Ar(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},hu.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Va.forEach(c,function(e){return Va.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return Va.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Za(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},hu.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},hu.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ri.Nn(t,e)})},hu.prototype.rr=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.mi.or(e,r).next(function(t){return t?(n=t,Va.resolve(n)):i.mi.hr(e).next(function(t){return n=new vi(r,t,0,e.Qi),i.mi.ar(e,n).next(function(){return n})})})}).then(function(t){var e=i._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i._i=i._i.nt(t.targetId,t),i.fi.set(r,t.targetId)),t})},hu.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?Va.resolve(this._i.get(n)):this.mi.or(t,e)},hu.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,r,i=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Za(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},hu.prototype.cr=function(t,n){var r=this,i=Wr.min(),o=Ci();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.or(e,Zs(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.mi.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.li.Bn(e,t,n?i:Wr.min(),n?o:Ci())}).next(function(t){return{documents:t,_r:o}})})},hu.prototype.Ni=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=Va.resolve();return n.forEach(function(r){a=a.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Ar(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.zi(e,i.In)})}),a.next(function(){return e.Fn.Li(t,s)})},hu.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},hu);function hu(t,e,n){this.persistence=t,this.li=e,this._i=new bi(Dr),this.fi=new jr(ui,hi),this.di=Wr.min(),this.Fn=t.wi(n),this.Ti=t.Ei(),this.mi=t.Ii(),this.Ri=new Ca(this.Ti,this.Fn,this.persistence.Ai()),this.li.Pi(this.Ri)}function cu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==qr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}uu.Ji=3e8;var lu=(du.prototype._=function(){return this.Tr._()},du.prototype.tr=function(t,e){var n=new fu(t,e);this.Tr=this.Tr.add(n),this.mr=this.mr.add(n)},du.prototype.Rr=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},du.prototype.er=function(t,e){this.Ar(new fu(t,e))},du.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},du.prototype.Vr=function(t){var e=this,n=new Xr(new zr([])),r=new fu(n,t),i=new fu(n,t+1),o=[];return this.mr.bt([r,i],function(t){e.Ar(t),o.push(t.key)}),o},du.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Ar(t)})},du.prototype.Ar=function(t){this.Tr=this.Tr.delete(t),this.mr=this.mr.delete(t)},du.prototype.yr=function(t){var e=new Xr(new zr([])),n=new fu(e,t),r=new fu(e,t+1),i=Ci();return this.mr.bt([n,r],function(t){i=i.add(t.key)}),i},du.prototype.gr=function(t){var e=new fu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},du),fu=(pu.Er=function(t,e){return Xr.P(t.key,e.key)||Dr(t.vr,e.vr)},pu.Ir=function(t,e){return Dr(t.vr,e.vr)||Xr.P(t.key,e.key)},pu);function pu(t,e){this.key=t,this.vr=e}function du(){this.Tr=new Si(fu.Er),this.mr=new Si(fu.Ir)}function yu(t,e){if(0!==e.length)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ku(e.length,"argument")+".")}function vu(t,e,n){if(e.length!==n)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires "+ku(n,"argument")+", but was called with "+ku(e.length,"argument")+".")}function gu(t,e,n){if(e.length<n)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ku(n,"argument")+", but was called with "+ku(e.length,"argument")+".")}function mu(t,e,n,r){if(e.length<n||e.length>r)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ku(e.length,"argument")+".")}function wu(t,e,n,r){Au(t,e,Pu(n)+" argument",r)}function bu(t,e,n,r){void 0!==r&&wu(t,e,n,r)}function Eu(t,e,n,r){Au(t,e,n+" option",r)}function Iu(t,e,n,r){void 0!==r&&Eu(t,e,n,r)}function Tu(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Su(s))}var a=Su(n);throw new Br(qr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Nu(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Br(qr.INVALID_ARGUMENT,"Invalid value "+Su(r)+" provided to function "+t+"() for its "+Pu(n)+" argument. Acceptable values: "+e.join(", "));return r}function Au(t,e,n,r){if(!("object"===e?_u(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Su(r);throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function _u(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Su(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Nr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ru(t,e,n){if(void 0===n)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Pu(e)+" argument, but it was undefined.")}function Du(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Br(qr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Lu(t,e,n,r){var i=Su(r);return new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Pu(n)+" argument to be a "+e+", but it was: "+i)}function Ou(t,e,n){if(n<=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Pu(e)+" argument to be a positive number, but it was: "+n+".")}function Pu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ku(t,e){return t+" "+e+(1===t?"":"s")}function Vu(){if("undefined"==typeof Uint8Array)throw new Br(qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Cu(){if("undefined"==typeof atob)throw new Br(qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Uu,Mu,xu=(zu.fromBase64String=function(t){vu("Blob.fromBase64String",arguments,1),wu("Blob.fromBase64String","string",1,t),Cu();try{return new zu(li.fromBase64String(t))}catch(t){throw new Br(qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},zu.fromUint8Array=function(t){if(vu("Blob.fromUint8Array",arguments,1),Vu(),!(t instanceof Uint8Array))throw Lu("Blob.fromUint8Array","Uint8Array",1,t);return new zu(li.fromUint8Array(t))},zu.prototype.toBase64=function(){return vu("Blob.toBase64",arguments,0),Cu(),this.br.toBase64()},zu.prototype.toUint8Array=function(){return vu("Blob.toUint8Array",arguments,0),Vu(),this.br.toUint8Array()},zu.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},zu.prototype.isEqual=function(t){return this.br.isEqual(t.br)},zu),Fu=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Br(qr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(wu("FieldPath","string",e,t[e]),0===t[e].length)throw new Br(qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Sr=new $r(t)},ju=(n(Hu,Mu=Fu),Hu.documentId=function(){return new Hu($r.M().$())},Hu.prototype.isEqual=function(t){if(!(t instanceof Hu))throw Lu("isEqual","FieldPath",1,t);return this.Sr.isEqual(t.Sr)},Hu),qu=new RegExp("[~\\*/\\[\\]]"),Bu=function(){this.Cr=this},Gu=(n(Wu,Uu=Bu),Wu.prototype.Fr=function(t){if(2!==t.$r)throw 1===t.$r?t.Nr(this.Dr+"() can only appear at the top level of your update data"):t.Nr(this.Dr+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},Wu.prototype.isEqual=function(t){return t instanceof Wu},Wu);function Wu(t){var e=this;return(e=Uu.call(this)||this).Dr=t,e}function Hu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mu.call(this,t)||this}function zu(t){Cu(),this.br=t}function Yu(t,e,n){return new Ih({$r:3,kr:e.settings.kr,methodName:t.Dr,xr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var $u,Xu,Qu,Ku,Ju,Zu,th=(n(ph,Zu=Bu),ph.prototype.Fr=function(t){return new is(t.path,new Wo)},ph.prototype.isEqual=function(t){return t instanceof ph},ph),eh=(n(fh,Ju=Bu),fh.prototype.Fr=function(t){var e=Yu(this,t,!0),n=this.Or.map(function(t){return Lh(t,e)}),r=new Ho(n);return new is(t.path,r)},fh.prototype.isEqual=function(t){return this===t},fh),nh=(n(lh,Ku=Bu),lh.prototype.Fr=function(t){var e=Yu(this,t,!0),n=this.Or.map(function(t){return Lh(t,e)}),r=new Qo(n);return new is(t.path,r)},lh.prototype.isEqual=function(t){return this===t},lh),rh=(n(ch,Qu=Bu),ch.prototype.Fr=function(t){var e=new ts(t.serializer,_o(t.serializer,this.Lr));return new is(t.path,e)},ch.prototype.isEqual=function(t){return this===t},ch),ih=(n(hh,Xu=Bu),hh.delete=function(){return yu("FieldValue.delete",arguments),new oh(new Gu("FieldValue.delete"))},hh.serverTimestamp=function(){return yu("FieldValue.serverTimestamp",arguments),new oh(new th("FieldValue.serverTimestamp"))},hh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return gu("FieldValue.arrayUnion",arguments,1),new oh(new eh("FieldValue.arrayUnion",t))},hh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return gu("FieldValue.arrayRemove",arguments,1),new oh(new nh("FieldValue.arrayRemove",t))},hh.increment=function(t){return wu("FieldValue.increment","number",1,t),vu("FieldValue.increment",arguments,1),new oh(new rh("FieldValue.increment",t))},hh),oh=(n(uh,$u=ih),uh.prototype.Fr=function(t){return this.Cr.Fr(t)},uh.prototype.isEqual=function(t){return t instanceof uh&&this.Cr.isEqual(t.Cr)},uh),sh=(Object.defineProperty(ah.prototype,"latitude",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Object.defineProperty(ah.prototype,"longitude",{get:function(){return this.qr},enumerable:!1,configurable:!0}),ah.prototype.isEqual=function(t){return this.Mr===t.Mr&&this.qr===t.qr},ah.prototype.T=function(t){return Dr(this.Mr,t.Mr)||Dr(this.qr,t.qr)},ah);function ah(t,e){if(vu("GeoPoint",arguments,2),wu("GeoPoint","number",1,t),wu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Br(qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Br(qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Mr=t,this.qr=e}function uh(t){var e=this;return(e=$u.call(this)||this).Cr=t,e.Dr=t.Dr,e}function hh(){return Xu.call(this)||this}function ch(t,e){var n=this;return(n=Qu.call(this)||this).Dr=t,n.Lr=e,n}function lh(t,e){var n=this;return(n=Ku.call(this)||this).Dr=t,n.Or=e,n}function fh(t,e){var n=this;return(n=Ju.call(this)||this).Dr=t,n.Or=e,n}function ph(t){var e=this;return(e=Zu.call(this)||this).Dr=t,e}function dh(t){return new To(t,!0)}var yh=/^__.*__$/,vh=function(t,e,n){this.Ur=t,this.Br=e,this.Wr=n},gh=(bh.prototype.Qr=function(t,e){var n=[];return null!==this.Me?n.push(new ms(t,this.data,this.Me,e)):n.push(new gs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ts(t,this.fieldTransforms)),n},bh),mh=(wh.prototype.Qr=function(t,e){var n=[new ms(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new Ts(t,this.fieldTransforms)),n},wh);function wh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function bh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Eh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Nr()}}var Ih=(Object.defineProperty(Ah.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ah.prototype,"$r",{get:function(){return this.settings.$r},enumerable:!1,configurable:!0}),Ah.prototype.Gr=function(t){return new Ah(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},Ah.prototype.Kr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.zr(t),r},Ah.prototype.Hr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.jr(),r},Ah.prototype.Yr=function(t){return this.Gr({path:void 0,xr:!0})},Ah.prototype.Nr=function(t){return Uh(t,this.settings.methodName,this.settings.Xr||!1,this.path,this.settings.kr)},Ah.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},Ah.prototype.jr=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.zr(this.path.get(t))},Ah.prototype.zr=function(t){if(0===t.length)throw this.Nr("Document fields must not be empty");if(Eh(this.$r)&&yh.test(t))throw this.Nr('Document fields cannot begin and end with "__"')},Ah),Th=(Nh.prototype.Jr=function(t,e,n,r){return void 0===r&&(r=!1),new Ih({$r:t,methodName:e,kr:n,path:$r.k(),xr:!1,Xr:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Nh);function Nh(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||dh(t)}function Ah(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.jr(),this.fieldTransforms=i||[],this.Me=o||[]}function _h(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Jr(o.merge||o.mergeFields?2:0,e,n,i);kh("Data must be an object, but it was:",s,r);var a,u,h=Oh(r,s);if(o.merge)a=new os(s.Me),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Fu)d=p.Sr;else{if("string"!=typeof p)throw Nr();d=Ch(e,p,n)}if(!s.contains(d))throw new Br(qr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Mh(c,d)||c.push(d)}a=new os(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new gh(new Ls(h),a,u)}function Sh(t,o,s,e){var a=t.Jr(1,o,s);kh("Data must be an object, but it was:",a,e);var u=[],h=new Os;Cr(e,function(t,e){var n,r=Ch(o,t,s),i=a.Hr(r);e instanceof Bu&&e.Cr instanceof Gu?u.push(r):null!=(n=Lh(e,i))&&(u.push(r),h.set(r,n))});var n=new os(u);return new mh(h.Ke(),n,a.fieldTransforms)}function Rh(t,e,n,r,i,o){var s=t.Jr(1,e,n),a=[Vh(e,r,n)],u=[i];if(o.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(Vh(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new Os,v=a.length-1;0<=v;--v){Mh(d,a[v])||(c=a[v],l=u[v],f=s.Hr(c),l instanceof Bu&&l.Cr instanceof Gu?d.push(c):null!=(p=Lh(l,f))&&(d.push(c),y.set(c,p)))}var g=new os(d);return new mh(y.Ke(),g,s.fieldTransforms)}function Dh(t,e,n,r){return void 0===r&&(r=!1),Lh(n,t.Jr(r?4:3,e))}function Lh(s,t){if(Ph(s))return kh("Unsupported field value:",t,s),Oh(s,t);if(s instanceof Bu)return function(t,e){if(!Eh(e.$r))throw e.Nr(t.Dr+"() can only be used with update() and set()");if(!e.path)throw e.Nr(t.Dr+"() is not currently supported inside arrays");var n=t.Fr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.xr&&4!==t.$r)throw t.Nr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Lh(i[r],t.Yr(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return _o(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Gr.fromDate(t);return{timestampValue:So(e.serializer,n)}}if(t instanceof Gr){var r=new Gr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:So(e.serializer,r)}}if(t instanceof sh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xu)return{bytesValue:Ro(e.serializer,t)};if(t instanceof vh){var i=e.s,o=t.Ur;if(!o.isEqual(i))throw e.Nr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Lo(t.Ur||e.s,t.Br.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nr("Unsupported field value: "+Su(t))}(s,t)}function Oh(t,r){var i={};return Ur(t)?r.path&&0<r.path.length&&r.Me.push(r.path):Cr(t,function(t,e){var n=Lh(e,r.Kr(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Ph(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Gr||t instanceof sh||t instanceof xu||t instanceof vh||t instanceof Bu)}function kh(t,e,n){if(!Ph(n)||!_u(n)){var r=Su(n);throw"an object"===r?e.Nr(t+" a custom object"):e.Nr(t+" "+r)}}function Vh(t,e,n){if(e instanceof Fu)return e.Sr;if("string"==typeof e)return Ch(t,e);throw Uh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ch(t,e,n){try{return function(e){if(0<=e.search(qu))throw new Br(qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ju.bind.apply(ju,v([void 0],e.split("."))))}catch(t){throw new Br(qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Sr}catch(e){throw Uh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Uh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Br(qr.INVALID_ARGUMENT,(a+=". ")+t+u)}function Mh(t,e){return t.some(function(t){return t.isEqual(e)})}var xh=(Fh.prototype.Zr=function(){return null!=this.uid},Fh.prototype.to=function(){return this.Zr()?"uid:"+this.uid:"anonymous-user"},Fh.prototype.isEqual=function(t){return t.uid===this.uid},Fh);function Fh(t){this.uid=t}function jh(t,e){this.user=e,this.type="OAuth",this.so={},this.so.Authorization="Bearer "+t}function qh(t){this.key=t}function Bh(t){this.key=t}function Gh(t,e,n){this.query=t,this.targetId=e,this.view=n}function Wh(t){this.key=t,this.Qa=!1}function Hh(){this.Vu=void 0,this.listeners=[]}xh.UNAUTHENTICATED=new xh(null),xh.eo=new xh("google-credentials-uid"),xh.no=new xh("first-party-uid");var zh,Yh,$h,Xh,Qh=(Mc.prototype.getToken=function(){return Promise.resolve(null)},Mc.prototype.ro=function(){},Mc.prototype.oo=function(t){(this.io=t)(xh.UNAUTHENTICATED)},Mc.prototype.ho=function(){this.io=null},Mc),Kh=(Uc.prototype.getToken=function(){var e=this,n=this.co,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.co!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ar("string"==typeof t.accessToken),new jh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Uc.prototype.ro=function(){this.forceRefresh=!0},Uc.prototype.oo=function(t){this.io=t,this.uo&&t(this.currentUser)},Uc.prototype.ho=function(){this.auth&&this.auth.removeAuthTokenListener(this.ao),this.ao=null,this.io=null},Uc.prototype.lo=function(){var t=this.auth&&this.auth.getUid();return Ar(null===t||"string"==typeof t),new xh(t)},Uc),Jh=(Object.defineProperty(Cc.prototype,"so",{get:function(){var t={"X-Goog-AuthUser":this.fo},e=this._o.auth.do([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Cc),Zh=(Vc.prototype.getToken=function(){return Promise.resolve(new Jh(this._o,this.fo))},Vc.prototype.oo=function(t){t(xh.no)},Vc.prototype.ho=function(){},Vc.prototype.ro=function(){},Vc),tc=(kc.prototype.Ro=function(){return 1===this.state||2===this.state||4===this.state},kc.prototype.Ao=function(){return 2===this.state},kc.prototype.start=function(){3!==this.state?this.auth():this.Po()},kc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},kc.prototype.Vo=function(){this.state=0,this.Ls.reset()},kc.prototype.po=function(){var t=this;this.Ao()&&null===this.Io&&(this.Io=this.ss.ws(this.wo,6e4,function(){return t.yo()}))},kc.prototype.vo=function(t){this.bo(),this.stream.send(t)},kc.prototype.yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ao()?[2,this.close(0)]:[2]})})},kc.prototype.bo=function(){this.Io&&(this.Io.cancel(),this.Io=null)},kc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.bo(),this.Ls.cancel(),this.mo++,3!==e?this.Ls.reset():n&&n.code===qr.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.Ls._s()):n&&n.code===qr.UNAUTHENTICATED&&this.Eo.ro(),null!==this.stream&&(this.So(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Co(n)];case 1:return t.sent(),[2]}})})},kc.prototype.So=function(){},kc.prototype.auth=function(){var n=this;this.state=1;var t=this.Do(this.mo),e=this.mo;this.Eo.getToken().then(function(t){n.mo===e&&n.Fo(t)},function(e){t(function(){var t=new Br(qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.$o(t)})})},kc.prototype.Fo=function(t){var e=this,n=this.Do(this.mo);this.stream=this.No(t),this.stream.ko(function(){n(function(){return e.state=2,e.listener.ko()})}),this.stream.Co(function(t){n(function(){return e.$o(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},kc.prototype.Po=function(){var t=this;this.state=4,this.Ls.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},kc.prototype.$o=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},kc.prototype.Do=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.mo===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},kc),ec=(n(Pc,$h=tc),Pc.prototype.No=function(t){return this.To.xo("Listen",t)},Pc.prototype.onMessage=function(t){this.Ls.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Nr(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Le?(Ar(void 0===i||"string"==typeof i),li.fromBase64String(i||"")):(Ar(void 0===i||i instanceof Uint8Array),li.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Fi(s,a,u,h&&(r=void 0===(n=h).code?qr.UNKNOWN:wi(n.code),new Br(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Po(t,l.document.name),p=Do(l.document.updateTime),d=new Ls({mapValue:{fields:l.document.fields}}),y=new qs(f,p,d,{});c=new Mi(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Po(t,v.document),m=v.readTime?Do(v.readTime):Wr.min(),w=new Bs(g,m);c=new Mi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Po(t,b.document);c=new Mi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Nr();e.filter;var I=e.filter;I.targetId;var T=new pi(I.count||0);c=new xi(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Wr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Wr.min():Do(e.readTime)}(t);return this.listener.Oo(e,n)},Pc.prototype.Lo=function(t){var e,n,r,i,o={};o.database=Vo(this.serializer),o.addTarget=(e=this.serializer,(r=ci(i=(n=t).target)?{documents:{documents:[ko(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ko(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ko(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof ha?function(t){if("=="===t.op){if(wo(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NAN"}};if(mo(t.value))return{unaryFilter:{field:xo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:xo(t.field),op:(e=t.op,Io[e]),value:t.value}};var e}(t):Nr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:xo((e=t).field),direction:(n=e.dir,Eo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Le||ii(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Mo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Mo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Ro(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Nr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.vo(o)},Pc.prototype.Mo=function(t){var e={};e.database=Vo(this.serializer),e.removeTarget=t,this.vo(e)},Pc),nc=(n(Oc,Yh=tc),Object.defineProperty(Oc.prototype,"Uo",{get:function(){return this.qo},enumerable:!1,configurable:!0}),Oc.prototype.start=function(){this.qo=!1,this.lastStreamToken=void 0,Yh.prototype.start.call(this)},Oc.prototype.So=function(){this.qo&&this.Bo([])},Oc.prototype.No=function(t){return this.To.xo("Write",t)},Oc.prototype.onMessage=function(t){if(Ar(!!t.streamToken),this.lastStreamToken=t.streamToken,this.qo){this.Ls.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Ar(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Do(t.updateTime):Do(e);n.isEqual(Wr.min())&&(n=Do(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new as(n,r)}(t,i)})):[]),n=Do(t.commitTime);return this.listener.Wo(n,e)}var r,i;return Ar(!t.writeResults||0===t.writeResults.length),this.qo=!0,this.listener.Qo()},Oc.prototype.jo=function(){var t={};t.database=Vo(this.serializer),this.vo(t)},Oc.prototype.Bo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Uo(e.serializer,t)})};this.vo(n)},Oc),rc=(n(Lc,zh=function(){}),Lc.prototype.Ko=function(){if(this.Go)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},Lc.prototype.start=function(t){this.To=t},Lc.prototype.zo=function(e,n){var r=this;return this.Ko(),this.credentials.getToken().then(function(t){return r.To.zo(e,n,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&r.credentials.ro(),t})},Lc.prototype.Ho=function(e,n){var r=this;return this.Ko(),this.credentials.getToken().then(function(t){return r.To.Ho(e,n,t)}).catch(function(t){throw t.code===qr.UNAUTHENTICATED&&r.credentials.ro(),t})},Lc),ic=(Dc.prototype.eh=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.nh(),0<this.mutations.length)throw new Br(qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return d(this,void 0,void 0,function(){var i,e,n,o,r;return y(this,function(t){switch(t.label){case 0:return e={database:Vo((i=s).serializer),documents:a.map(function(t){return Oo(i.serializer,t)})},[4,i.Ho("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Ar(!!e.found),e.found.name,e.found.updateTime;var n=Po(t,e.found.name),r=Do(e.found.updateTime),i=new Ls({mapValue:{fields:e.found.fields}});return new qs(n,r,i,{})}(e,n):"missing"in n?function(t,e){Ar(!!e.missing),Ar(!!e.readTime);var n=Po(t,e.missing),r=Do(e.readTime);return new Bs(n,r)}(e,n):Nr());o.set(r.key.toString(),r)}),r=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Ar(!!e),r.push(e)}),r)]}})})}(this.Yo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Bs||t instanceof qs?n.sh(t):Nr()}),e)]}})})},Dc.prototype.set=function(t,e){this.write(e.Qr(t,this.Be(t))),this.th.add(t)},Dc.prototype.update=function(t,e){try{this.write(e.Qr(t,this.ih(t)))}catch(t){this.Zo=t}this.th.add(t)},Dc.prototype.delete=function(t){this.write([new Rs(t,this.Be(t))]),this.th.add(t)},Dc.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:if(this.nh(),this.Zo)throw this.Zo;return e=this.Xo,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Xr(zr.N(e));r.mutations.push(new Ds(n,r.Be(n)))}),[4,function(r,i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return n={database:Vo((e=r).serializer),writes:i.map(function(t){return Uo(e.serializer,t)})},[4,e.zo("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Yo,this.mutations)];case 1:return t.sent(),this.Jo=!0,[2]}})})},Dc.prototype.sh=function(t){var e;if(t instanceof qs)e=t.version;else{if(!(t instanceof Bs))throw Nr();e=Wr.min()}var n=this.Xo.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Br(qr.ABORTED,"Document version changed between two reads.")}else this.Xo.set(t.key.toString(),e)},Dc.prototype.Be=function(t){var e=this.Xo.get(t.toString());return!this.th.has(t)&&e?us.updateTime(e):us.je()},Dc.prototype.ih=function(t){var e=this.Xo.get(t.toString());if(this.th.has(t)||!e)return us.exists(!0);if(e.isEqual(Wr.min()))throw new Br(qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return us.updateTime(e)},Dc.prototype.write=function(t){this.nh(),this.mutations=this.mutations.concat(t)},Dc.prototype.nh=function(){},Dc),oc=(Rc.prototype.uh=function(){var t=this;0===this.oh&&(this.lh("Unknown"),this.hh=this.Vs.ws("online_state_timeout",1e4,function(){return t.hh=null,t._h("Backend didn't respond within 10 seconds."),t.lh("Offline"),Promise.resolve()}))},Rc.prototype.fh=function(t){"Online"===this.state?this.lh("Unknown"):(this.oh++,1<=this.oh&&(this.dh(),this._h("Connection failed 1 times. Most recent error: "+t.toString()),this.lh("Offline")))},Rc.prototype.set=function(t){this.dh(),this.oh=0,"Online"===t&&(this.ah=!1),this.lh(t)},Rc.prototype.lh=function(t){t!==this.state&&(this.state=t,this.rh(t))},Rc.prototype._h=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.ah?(Ir(e),this.ah=!1):Er("OnlineStateTracker",e)},Rc.prototype.dh=function(){null!==this.hh&&(this.hh.cancel(),this.hh=null)},Rc),sc=(Sc.prototype.start=function(){return this.enableNetwork()},Sc.prototype.enableNetwork=function(){return this.Ih.delete(0),this.$h()},Sc.prototype.$h=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ph()?(this.Nh()?this.kh():this.ph.set("Unknown"),[4,this.xh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Sc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ih.add(0),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Offline"),[2]}})})},Sc.prototype.Oh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Sh.stop()];case 1:return t.sent(),[4,this.yh.stop()];case 2:return t.sent(),0<this.Th.length&&(Er("RemoteStore","Stopping write stream with "+this.Th.length+" pending writes"),this.Th=[]),this.Lh(),[2]}})})},Sc.prototype.Mh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Er("RemoteStore","RemoteStore shutting down."),this.Ih.add(5),[4,this.Oh()];case 1:return t.sent(),this.Rh.Mh(),this.ph.set("Unknown"),[2]}})})},Sc.prototype.listen=function(t){this.Eh.has(t.targetId)||(this.Eh.set(t.targetId,t),this.Nh()?this.kh():this.yh.Ao()&&this.qh(t))},Sc.prototype.Uh=function(t){this.Eh.delete(t),this.yh.Ao()&&this.Bh(t),0===this.Eh.size&&(this.yh.Ao()?this.yh.po():this.Ph()&&this.ph.set("Unknown"))},Sc.prototype.Oe=function(t){return this.Eh.get(t)||null},Sc.prototype.xe=function(t){return this.Wh.xe(t)},Sc.prototype.qh=function(t){this.mh.de(t.targetId),this.yh.Lo(t)},Sc.prototype.Bh=function(t){this.mh.de(t),this.yh.Mo(t)},Sc.prototype.kh=function(){this.mh=new zi(this),this.yh.start(),this.ph.uh()},Sc.prototype.Nh=function(){return this.Ph()&&!this.yh.Ro()&&0<this.Eh.size},Sc.prototype.Ph=function(){return 0===this.Ih.size},Sc.prototype.Lh=function(){this.mh=null},Sc.prototype.gh=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Eh.forEach(function(t,e){n.qh(t)}),[2]})})},Sc.prototype.vh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Lh(),this.Nh()?(this.ph.fh(e),this.kh()):this.ph.set("Unknown"),[2]})})},Sc.prototype.bh=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.ph.set("Online"),!(i instanceof Fi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Qh(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.jh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Mi?this.mh.Pe(i):i instanceof xi?this.mh.Ce(i):this.mh.ye(i),o.isEqual(Wr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.wh.qi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Gh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.jh(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Sc.prototype.jh=function(n,r){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!Za(n))throw n;return this.Ih.add(1),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Offline"),r=r||function(){return e.wh.qi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Ih.delete(1),[4,this.$h()];case 2:return t.sent(),[2]}})})}),[2]}})})},Sc.prototype.Kh=function(e){var n=this;return e().catch(function(t){return n.jh(t,e)})},Sc.prototype.Gh=function(r){var i=this,t=this.mh.$e(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&((n=i.Eh.get(e))&&i.Eh.set(e,n.tt(t.resumeToken,r)))}),t.Qt.forEach(function(t){var e,n=i.Eh.get(t);n&&(i.Eh.set(t,n.tt(li.Y,n.J)),i.Bh(t),e=new vi(n.target,t,1,n.sequenceNumber),i.qh(e))}),this.Wh.Ui(t)},Sc.prototype.Qh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Eh.has(i)?[4,this.Wh.zh(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Eh.delete(i),this.mh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Sc.prototype.xh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=0<this.Th.length?this.Th[this.Th.length-1].batchId:-1,t.label=1;case 1:if(!this.Hh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.wh.nr(e)];case 3:return null===(n=t.sent())?(0===this.Th.length&&this.Sh.po(),[3,7]):(e=n.batchId,this.Yh(n),[3,6]);case 4:return r=t.sent(),[4,this.jh(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Xh()&&this.Jh(),[2]}})})},Sc.prototype.Hh=function(){return this.Ph()&&this.Th.length<10},Sc.prototype.Zh=function(){return this.Th.length},Sc.prototype.Yh=function(t){this.Th.push(t),this.Sh.Ao()&&this.Sh.Uo&&this.Sh.Bo(t.mutations)},Sc.prototype.Xh=function(){return this.Ph()&&!this.Sh.Ro()&&0<this.Th.length},Sc.prototype.Jh=function(){this.Sh.start()},Sc.prototype.Ch=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Sh.jo(),[2]})})},Sc.prototype.Fh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){for(e=0,n=this.Th;e<n.length;e++)r=n[e],this.Sh.Bo(r.mutations);return[2]})})},Sc.prototype.Wo=function(i,o){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Th.shift(),n=ka.from(e,i,o),[4,this.Kh(function(){return r.Wh.ta(n)})];case 1:return t.sent(),[4,this.xh()];case 2:return t.sent(),[2]}})})},Sc.prototype.Dh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Sh.Uo?[4,this.ea(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Xh()&&this.Jh(),[2]}})})},Sc.prototype.ea=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return mi(n=i.code)&&n!==qr.ABORTED?(e=this.Th.shift(),this.Sh.Vo(),[4,this.Kh(function(){return r.Wh.na(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.xh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Sc.prototype.sa=function(){return new ic(this.Yo)},Sc.prototype.Vh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ih.add(4),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Unknown"),this.Sh.Vo(),this.yh.Vo(),this.Ih.delete(4),[4,this.$h()];case 2:return t.sent(),[2]}})})},Sc.prototype.ia=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Er("RemoteStore","RemoteStore received new credentials"),this.Ih.add(3),[4,this.Oh()];case 1:return t.sent(),this.ph.set("Unknown"),[4,this.Wh.ia(e)];case 2:return t.sent(),this.Ih.delete(3),[4,this.$h()];case 3:return t.sent(),[2]}})})},Sc.prototype.ra=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Ih.delete(2),[4,this.$h()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Ih.add(2),[4,this.Oh()]);case 3:t.sent(),this.ph.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Sc),ac=(_c.prototype.oa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},_c.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},_c.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},_c),uc=(Ac.prototype.la=function(t){},Ac.prototype._a=function(t,e,n){},Ac.prototype.fa=function(t){return this.ua.oa(t),this.ca[t]||"not-current"},Ac.prototype.da=function(t,e,n){this.ca[t]=e},Ac.prototype.wa=function(t){this.ua.ha(t)},Ac.prototype.Ta=function(t){return this.ua.activeTargetIds.has(t)},Ac.prototype.Ea=function(t){delete this.ca[t]},Ac.prototype.ma=function(){return this.ua.activeTargetIds},Ac.prototype.Ia=function(t){return this.ua.activeTargetIds.has(t)},Ac.prototype.start=function(){return this.ua=new ac,Promise.resolve()},Ac.prototype.Vi=function(t,e,n){},Ac.prototype.Ra=function(t){},Ac.prototype.Mh=function(){},Ac.prototype.es=function(t){},Ac),hc=(Object.defineProperty(Nc.prototype,"ga",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),Nc.prototype.va=function(t,e){var a=this,u=e?e.ba:new qi,h=e?e.ya:this.ya,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof qs?e:null)&&(sa(a.query,r)?r:null),i=!!n&&a.Mt.has(n.key),o=!!r&&(r.Ge||a.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.Sa(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.pa(r,p)||d&&a.pa(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ya:l,ba:u,Ca:f,Mt:c}},Nc.prototype.Sa=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Nc.prototype.Da=function(t,e,n){var o=this,r=this.ya;this.ya=t.ya,this.Mt=t.Mt;var i=t.ba.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pa(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr()}}var r,i}),this.Fa(n);var s=e?this.$a():[],a=0===this.Va.size&&this.Ht?1:0,u=a!==this.Pa;return this.Pa=a,0!==i.length||u?{snapshot:new Bi(this.query,t.ya,r,i,t.Mt,0==a,u,!1),Na:s}:{Na:s}},Nc.prototype.ka=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Da({ya:this.ya,ba:new qi,Mt:this.Mt,Ca:!1},!1)):{Na:[]}},Nc.prototype.xa=function(t){return!this.Aa.has(t)&&!!this.ya.has(t)&&!this.ya.get(t).Ge},Nc.prototype.Fa=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Aa=e.Aa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Aa=e.Aa.delete(t)}),this.Ht=t.Ht)},Nc.prototype.$a=function(){var e=this;if(!this.Ht)return[];var n=this.Va;this.Va=Ci(),this.ya.forEach(function(t){e.xa(t.key)&&(e.Va=e.Va.add(t.key))});var r=[];return n.forEach(function(t){e.Va.has(t)||r.push(new Bh(t))}),this.Va.forEach(function(t){n.has(t)||r.push(new qh(t))}),r},Nc.prototype.Oa=function(t){this.Aa=t._r,this.Va=Ci();var e=this.va(t.documents);return this.Da(e,!0)},Nc.prototype.La=function(){return Bi.Bt(this.query,this.ya,this.Mt,0===this.Pa)},Nc),cc=(Tc.prototype.run=function(){this.qa()},Tc.prototype.qa=function(){var t=this;this.Ls.fs(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new ic(this.Yo),(n=this.Ua(e))&&n.then(function(t){r.Vs.Cs(function(){return e.commit().then(function(){r.gs.resolve(t)}).catch(function(t){r.Ba(t)})})}).catch(function(t){r.Ba(t)}),[2]})})})},Tc.prototype.Ua=function(t){try{var e=this.updateFunction(t);return!ii(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},Tc.prototype.Ba=function(t){var e=this;0<this.Ma&&this.Wa(t)?(--this.Ma,this.Vs.Cs(function(){return e.qa(),Promise.resolve()})):this.gs.reject(t)},Tc.prototype.Wa=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!mi(e)},Tc),lc=(Object.defineProperty(Ic.prototype,"ru",{get:function(){return!0===this.iu},enumerable:!1,configurable:!0}),Ic.prototype.subscribe=function(t){this.za=t},Ic.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.ou("listen()"),(r=this.Ha.get(s))?(e=r.targetId,this.Ga.fa(e),n=r.view.La(),[3,4]):[3,1];case 1:return[4,this.wh.rr(Zs(s))];case 2:return i=t.sent(),o=this.Ga.fa(i.targetId),e=i.targetId,[4,this.hu(s,e,"current"===o)];case 3:n=t.sent(),this.ru&&this.ja.listen(i),t.label=4;case 4:return[2,n]}})})},Ic.prototype.hu=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.wh.cr(a,!0)];case 1:return e=t.sent(),n=new hc(a,e._r),r=n.va(e.documents),i=Wi.zt(u,h&&"Offline"!==this.onlineState),o=n.Da(r,this.ru,i),this.au(u,o.Na),s=new Gh(a,u,n),[2,(this.Ha.set(a,s),this.Ya.has(u)?this.Ya.get(u).push(a):this.Ya.set(u,[a]),o.snapshot)]}})})},Ic.prototype.Uh=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.ou("unlisten()"),e=this.Ha.get(i),1<(n=this.Ya.get(e.targetId)).length?[2,(this.Ya.set(e.targetId,n.filter(function(t){return!ra(t,i)})),void this.Ha.delete(i))]:this.ru?(this.Ga.wa(e.targetId),this.Ga.Ia(e.targetId)?[3,2]:[4,this.wh.ur(e.targetId,!1).then(function(){r.Ga.Ea(e.targetId),r.ja.Uh(e.targetId),r.uu(e.targetId)}).catch(cu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.uu(e.targetId),[4,this.wh.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Ic.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.ou("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.wh.bi(i)];case 2:return e=t.sent(),this.Ga.la(e.batchId),this.cu(e.batchId,o),[4,this.lu(e.Ci)];case 3:return t.sent(),[4,this.ja.xh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=ou(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Ic.prototype.runTransaction=function(t,e,n){new cc(t,this.Yo,e,n).run()},Ic.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.ou("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Za.get(e);n&&(Ar(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.Qa=!0:0<t.Xt.size?Ar(n.Qa):0<t.Jt.size&&(Ar(n.Qa),n.Qa=!1))}),[4,this.lu(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,cu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ic.prototype.ka=function(r,t){var i;(this.ru&&0===t||!this.ru&&1===t)&&(this.ou("applyOnlineStateChange()"),i=[],this.Ha.forEach(function(t,e){var n=e.view.ka(r);n.snapshot&&i.push(n.snapshot)}),this.za._u(r),this.za.Oo(i),this.onlineState=r,this.ru&&this.Ga.Ra(r))},Ic.prototype.zh=function(a,u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ou("rejectListens()"),this.Ga.da(a,"rejected",u),e=this.Za.get(a),(n=e&&e.key)?(r=(r=new bi(Xr.P)).nt(n,new Bs(n,Wr.min())),i=Ci().add(n),o=new Gi(Wr.min(),new Map,new Si(Dr),r,i),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.Ja=this.Ja.remove(n),this.Za.delete(a),this.fu(),[3,4];case 2:return[4,this.wh.ur(a,!1).then(function(){return s.uu(a,u)}).catch(cu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Ic.prototype.ta=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.ou("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.Di(r)];case 2:return n=t.sent(),this.du(e,null),this.wu(e),this.Ga._a(e,"acknowledged"),[4,this.lu(n)];case 3:return t.sent(),[3,6];case 4:return[4,cu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ic.prototype.na=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.ou("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.wh.xi(n)];case 2:return e=t.sent(),this.du(n,r),this.wu(n),this.Ga._a(n,"rejected",r),[4,this.lu(e)];case 3:return t.sent(),[3,6];case 4:return[4,cu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Ic.prototype.Tu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.ja.Ph()||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.wh.Mi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.nu.get(e)||[]).push(o),this.nu.set(e,n),[3,4]);case 3:return r=t.sent(),i=ou(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Ic.prototype.wu=function(t){(this.nu.get(t)||[]).forEach(function(t){t.resolve()}),this.nu.delete(t)},Ic.prototype.Eu=function(e){this.nu.forEach(function(t){t.forEach(function(t){t.reject(new Br(qr.CANCELLED,e))})}),this.nu.clear()},Ic.prototype.cu=function(t,e){var n=(n=(n=this.eu[this.currentUser.to()])||new bi(Dr)).nt(t,e);this.eu[this.currentUser.to()]=n},Ic.prototype.du=function(t,e){var n,r=this.eu[this.currentUser.to()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.eu[this.currentUser.to()]=r)},Ic.prototype.uu=function(t,e){var n=this;void 0===e&&(e=null),this.Ga.wa(t);for(var r=0,i=this.Ya.get(t);r<i.length;r++){var o=i[r];this.Ha.delete(o),e&&this.za.mu(o,e)}this.Ya.delete(t),this.ru&&this.tu.Vr(t).forEach(function(t){n.tu.gr(t)||n.Iu(t)})},Ic.prototype.Iu=function(t){var e=this.Ja.get(t);null!==e&&(this.ja.Uh(e),this.Ja=this.Ja.remove(t),this.Za.delete(e),this.fu())},Ic.prototype.au=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof qh?(this.tu.tr(i.key,t),this.Ru(i)):i instanceof Bh?(Er("SyncEngine","Document no longer in limbo: "+i.key),this.tu.er(i.key,t),this.tu.gr(i.key)||this.Iu(i.key)):Nr()}},Ic.prototype.Ru=function(t){var e=t.key;this.Ja.get(e)||(Er("SyncEngine","New document in limbo: "+e),this.Xa.push(e),this.fu())},Ic.prototype.fu=function(){for(;0<this.Xa.length&&this.Ja.size<this.Ka;){var t=this.Xa.shift(),e=this.su.next();this.Za.set(e,new Wh(t)),this.Ja=this.Ja.nt(t,e),this.ja.listen(new vi(Zs(Qs(t.path)),e,2,Ma.ns))}},Ic.prototype.Au=function(){return this.Ja},Ic.prototype.Pu=function(){return this.Xa},Ic.prototype.lu=function(r,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ha.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.va(r);return n.Ca?a.wh.cr(i.query,!1).then(function(t){var e=t.documents;return i.view.va(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(i.targetId),r=i.view.Da(t,a.ru,n);a.au(i.targetId,r.Na),r.snapshot&&(a.ru&&a.Ga.da(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Ua.Xn(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.za.Oo(o),[4,this.wh.Zi(s)];case 2:return t.sent(),[2]}})})},Ic.prototype.ou=function(t){},Ic.prototype.ia=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Er("SyncEngine","User change. New user:",n.to()),[4,this.wh.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.Eu("'waitForPendingWrites' promise is rejected due to a user change."),this.Ga.Vi(n,e.gi,e.vi),[4,this.lu(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Ic.prototype.xe=function(t){var e=this.Za.get(t);if(e&&e.Qa)return Ci().add(e.key);var n=Ci(),r=this.Ya.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],a=this.Ha.get(s),n=n.Dt(a.view.ga);return n},Ic),fc=(Ec.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(r=this.pu.get(e))||(n=!0,r=new Hh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Wh.listen(e)];case 2:return i.Vu=t.sent(),[3,4];case 3:return o=t.sent(),s=ou(o,"Initialization of query '"+oa(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.pu.set(e,r),r.listeners.push(a),a.ka(this.onlineState),r.Vu&&a.gu(r.Vu)&&this.vu(),[2]}})})},Ec.prototype.Uh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.pu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.pu.delete(e),this.Wh.Uh(e))]:[2]})})},Ec.prototype.Oo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.pu.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].gu(i)&&(e=!0);s.Vu=i}}e&&this.vu()},Ec.prototype.mu=function(t,e){var n=this.pu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.pu.delete(t)},Ec.prototype._u=function(i){this.onlineState=i;var o=!1;this.pu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].ka(i)&&(o=!0)}),o&&this.vu()},Ec.prototype.bu=function(t){this.yu.add(t),t.next()},Ec.prototype.Su=function(t){this.yu.delete(t)},Ec.prototype.vu=function(){this.yu.forEach(function(t){t.next()})},Ec),pc=(bc.prototype.gu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Bi(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Du?this.$u(t)&&(this.Cu.next(t),o=!0):this.Nu(t,this.onlineState)&&(this.ku(t),o=!0),this.Fu=t,o},bc.prototype.onError=function(t){this.Cu.error(t)},bc.prototype.ka=function(t){this.onlineState=t;var e=!1;return this.Fu&&!this.Du&&this.Nu(this.Fu,t)&&(this.ku(this.Fu),e=!0),e},bc.prototype.Nu=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.xu&&n||t.docs._()&&"Offline"!==e)},bc.prototype.$u=function(t){if(0<t.docChanges.length)return!0;var e=this.Fu&&this.Fu.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},bc.prototype.ku=function(t){t=Bi.Bt(t.query,t.docs,t.Mt,t.fromCache),this.Du=!0,this.Cu.next(t)},bc),dc=(wc.prototype.Pi=function(t){this.Ou=t},wc.prototype.Bn=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Wr.min())?this.Lu(e,r):this.Ou.Mn(e,o).next(function(t){var n=s.Mu(r,t);return(r.hn()||r.an())&&s.Ca(r.en,n,o,i)?s.Lu(e,r):(br()<=p.DEBUG&&Er("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),oa(r)),s.Ou.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},wc.prototype.Mu=function(n,t){var r=new Si(aa(n));return t.forEach(function(t,e){e instanceof qs&&sa(n,e)&&(r=r.add(e))}),r},wc.prototype.Ca=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},wc.prototype.Lu=function(t,e){return br()<=p.DEBUG&&Er("IndexFreeQueryEngine","Using full collection scan to execute query:",oa(e)),this.Ou.Bn(t,e,Wr.min())},wc),yc=(mc.prototype.Bu=function(t){return Va.resolve(0===this.Fn.length)},mc.prototype.Si=function(t,e,n,r){var i=this.qu;this.qu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Pa(i,e,n,r);this.Fn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Uu=this.Uu.add(new fu(u.key,i)),this.$n.Is(t,u.key.path.g())}return Va.resolve(o)},mc.prototype.Oi=function(t,e){return Va.resolve(this.Wu(e))},mc.prototype.sr=function(t,e){var n=e+1,r=this.Qu(n),i=r<0?0:r;return Va.resolve(this.Fn.length>i?this.Fn[i]:null)},mc.prototype.Mi=function(){return Va.resolve(0===this.Fn.length?-1:this.qu-1)},mc.prototype.pi=function(t){return Va.resolve(this.Fn.slice())},mc.prototype.kn=function(t,e){var n=this,r=new fu(e,0),i=new fu(e,Number.POSITIVE_INFINITY),o=[];return this.Uu.bt([r,i],function(t){var e=n.Wu(t.vr);o.push(e)}),Va.resolve(o)},mc.prototype.Un=function(t,e){var r=this,i=new Si(Dr);return e.forEach(function(t){var e=new fu(t,0),n=new fu(t,Number.POSITIVE_INFINITY);r.Uu.bt([e,n],function(t){i=i.add(t.vr)})}),Va.resolve(this.ju(i))},mc.prototype.Kn=function(t,e){var n=e.path,r=n.length+1,i=n;Xr.W(i)||(i=i.child(""));var o=new fu(new Xr(i),0),s=new Si(Dr);return this.Uu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.vr)),!0)},o),Va.resolve(this.ju(s))},mc.prototype.ju=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Wu(t);null!==e&&r.push(e)}),r},mc.prototype.Li=function(n,r){var i=this;Ar(0===this.Gu(r.batchId,"removed")),this.Fn.shift();var o=this.Uu;return Va.forEach(r.mutations,function(t){var e=new fu(t.key,r.batchId);return o=o.delete(e),i.Yi.Ku(n,t.key)}).next(function(){i.Uu=o})},mc.prototype.zu=function(t){},mc.prototype.gr=function(t,e){var n=new fu(e,0),r=this.Uu.Ct(n);return Va.resolve(e.isEqual(r&&r.key))},mc.prototype.ki=function(t){return this.Fn.length,Va.resolve()},mc.prototype.Gu=function(t,e){return this.Qu(t)},mc.prototype.Qu=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},mc.prototype.Wu=function(t){var e=this.Qu(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},mc),vc=(gc.prototype.zi=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Hu(e);return this.docs=this.docs.nt(r,{Yu:e,size:s,readTime:n}),this.size+=s-o,this.$n.Is(t,r.path.g())},gc.prototype.Ki=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},gc.prototype.On=function(t,e){var n=this.docs.get(e);return Va.resolve(n?n.Yu:null)},gc.prototype.getEntries=function(t,e){var n=this,r=Di;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Yu:null)}),Va.resolve(r)},gc.prototype.Bn=function(t,e,n){for(var r=Pi,i=new Xr(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u.Yu,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof qs&&sa(e,h)&&(r=r.nt(h.key,h))}return Va.resolve(r)},gc.prototype.Xu=function(t,e){return Va.forEach(this.docs,function(t){return e(t)})},gc.prototype.Fi=function(t){return new gc.Ju(this)},gc.prototype.Zu=function(t){return Va.resolve(this.size)},gc);function gc(t,e){this.$n=t,this.Hu=e,this.docs=new bi(Xr.P),this.size=0}function mc(t,e){this.$n=t,this.Yi=e,this.Fn=[],this.qu=1,this.Uu=new Si(fu.Er)}function wc(){}function bc(t,e,n){this.query=t,this.Cu=e,this.Du=!1,this.Fu=null,this.onlineState="Unknown",this.options=n||{}}function Ec(t){this.Wh=t,this.pu=new jr(ia,ra),this.onlineState="Unknown",this.yu=new Set,this.Wh.subscribe(this)}function Ic(t,e,n,r,i,o){this.wh=t,this.ja=e,this.Yo=n,this.Ga=r,this.currentUser=i,this.Ka=o,this.za=null,this.Ha=new jr(ia,ra),this.Ya=new Map,this.Xa=[],this.Ja=new bi(Xr.P),this.Za=new Map,this.tu=new lu,this.eu={},this.nu=new Map,this.su=$a.Ps(),this.onlineState="Unknown",this.iu=void 0}function Tc(t,e,n,r){this.Vs=t,this.Yo=e,this.updateFunction=n,this.gs=r,this.Ma=5,this.Ls=new Ha(this.Vs,"transaction_retry")}function Nc(t,e){this.query=t,this.Aa=e,this.Pa=null,this.Ht=!1,this.Va=Ci(),this.Mt=Ci(),this.pa=aa(t),this.ya=new ji(this.pa)}function Ac(){this.ua=new ac,this.ca={},this.rh=null,this.Jn=null}function _c(){this.activeTargetIds=Ui}function Sc(t,e,n,r,i){var o,s,a,u,h,c,l,f,p=this;this.wh=t,this.Yo=e,this.Vs=n,this.Th=[],this.Eh=new Map,this.mh=null,this.Ih=new Set,this.Rh=i,this.Rh.Ah(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ph()?(Er("RemoteStore","Restarting streams for network reachability change."),[4,this.Vh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ph=new oc(n,r),this.yh=(h=this.Yo,c=n,l={ko:this.gh.bind(this),Co:this.vh.bind(this),Oo:this.bh.bind(this)},(f=h).Ko(),new ec(c,f.To,f.credentials,f.serializer,l)),this.Sh=(o=this.Yo,s=n,a={ko:this.Ch.bind(this),Co:this.Dh.bind(this),Qo:this.Fh.bind(this),Wo:this.Wo.bind(this)},(u=o).Ko(),new nc(s,u.To,u.credentials,u.serializer,a))}function Rc(t,e){this.Vs=t,this.rh=e,this.state="Unknown",this.oh=0,this.hh=null,this.ah=!0}function Dc(t){this.Yo=t,this.Xo=new Map,this.mutations=[],this.Jo=!1,this.Zo=null,this.th=new Set}function Lc(t,e){var n=this;return(n=zh.call(this)||this).credentials=t,n.serializer=e,n.Go=!1,n}function Oc(t,e,n,r,i){var o=this;return(o=Yh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.qo=!1,o}function Pc(t,e,n,r,i){var o=this;return(o=$h.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function kc(t,e,n,r,i,o){this.ss=t,this.wo=n,this.To=r,this.Eo=i,this.listener=o,this.state=0,this.mo=0,this.Io=null,this.stream=null,this.Ls=new Ha(t,e)}function Vc(t,e){this._o=t,this.fo=e}function Cc(t,e){this._o=t,this.fo=e,this.type="FirstParty",this.user=xh.no}function Uc(t){var e=this;this.ao=null,this.currentUser=xh.UNAUTHENTICATED,this.uo=!1,this.co=0,this.io=null,this.forceRefresh=!1,this.ao=function(){e.co++,e.currentUser=e.lo(),e.uo=!0,e.io&&e.io(e.currentUser)},this.co=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ao):(this.ao(null),t.get().then(function(t){e.auth=t,e.ao&&e.auth.addAuthTokenListener(e.ao)},function(){}))}function Mc(){this.io=null}function xc(t){var e=this;return(e=Xh.call(this)||this).rc=t,e}function Fc(){this.Ci=new jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.tc=!1}vc.Ju=(Object.defineProperty(Fc.prototype,"readTime",{get:function(){return this.ec},set:function(t){this.ec=t},enumerable:!1,configurable:!0}),Fc.prototype.zi=function(t,e){this.nc(),this.readTime=e,this.Ci.set(t.key,t)},Fc.prototype.Ki=function(t,e){this.nc(),e&&(this.readTime=e),this.Ci.set(t,null)},Fc.prototype.On=function(t,e){this.nc();var n=this.Ci.get(e);return void 0!==n?Va.resolve(n):this.sc(t,e)},Fc.prototype.getEntries=function(t,e){return this.ic(t,e)},Fc.prototype.apply=function(t){return this.nc(),this.tc=!0,this.Da(t)},Fc.prototype.nc=function(){},n(xc,Xh=Fc),xc.prototype.Da=function(n){var r=this,i=[];return this.Ci.forEach(function(t,e){e?i.push(r.rc.zi(n,e,r.readTime)):r.rc.Ki(t)}),Va.Sn(i)},xc.prototype.sc=function(t,e){return this.rc.On(t,e)},xc.prototype.ic=function(t,e){return this.rc.getEntries(t,e)},xc);var jc,qc=(ll.prototype.ge=function(t,n){return this.oc.forEach(function(t,e){return n(e)}),Va.resolve()},ll.prototype.qi=function(t){return Va.resolve(this.lastRemoteSnapshotVersion)},ll.prototype.cc=function(t){return Va.resolve(this.hc)},ll.prototype.hr=function(t){return this.highestTargetId=this.uc.next(),Va.resolve(this.highestTargetId)},ll.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.hc&&(this.hc=e),Va.resolve()},ll.prototype.lc=function(t){this.oc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.uc=new $a(e),this.highestTargetId=e),t.sequenceNumber>this.hc&&(this.hc=t.sequenceNumber)},ll.prototype.ar=function(t,e){return this.lc(e),this.targetCount+=1,Va.resolve()},ll.prototype.Gi=function(t,e){return this.lc(e),Va.resolve()},ll.prototype._c=function(t,e){return this.oc.delete(e.target),this.ac.Vr(e.targetId),--this.targetCount,Va.resolve()},ll.prototype.fc=function(n,r,i){var o=this,s=0,a=[];return this.oc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.oc.delete(t),a.push(o.dc(n,e.targetId)),s++)}),Va.Sn(a).next(function(){return s})},ll.prototype.wc=function(t){return Va.resolve(this.targetCount)},ll.prototype.or=function(t,e){var n=this.oc.get(e)||null;return Va.resolve(n)},ll.prototype.Wi=function(t,e,n){return this.ac.Rr(e,n),Va.resolve()},ll.prototype.Bi=function(e,t,n){this.ac.Pr(t,n);var r=this.persistence.Yi,i=[];return r&&t.forEach(function(t){i.push(r.Ku(e,t))}),Va.Sn(i)},ll.prototype.dc=function(t,e){return this.ac.Vr(e),Va.resolve()},ll.prototype.lr=function(t,e){var n=this.ac.yr(e);return Va.resolve(n)},ll.prototype.gr=function(t,e){return Va.resolve(this.ac.gr(e))},ll),Bc=(cl.prototype.start=function(){return Promise.resolve()},cl.prototype.Mh=function(){return this.mc=!1,Promise.resolve()},Object.defineProperty(cl.prototype,"Rc",{get:function(){return this.mc},enumerable:!1,configurable:!0}),cl.prototype.Ac=function(){},cl.prototype.Pc=function(){},cl.prototype.Ai=function(){return this.$n},cl.prototype.wi=function(t){var e=this.Tc[t.to()];return e||(e=new yc(this.$n,this.Yi),this.Tc[t.to()]=e),e},cl.prototype.Ii=function(){return this.mi},cl.prototype.Ei=function(){return this.Dn},cl.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new Gc(this.Ec.next());return this.Yi.Vc(),n(i).next(function(t){return r.Yi.pc(i).next(function(){return t})}).vn().then(function(t){return i.yc(),t})},cl.prototype.gc=function(e,n){return Va.Cn(Object.values(this.Tc).map(function(t){return function(){return t.gr(e,n)}}))},cl),Gc=(hl.prototype.bc=function(t){this.vc.push(t)},hl.prototype.yc=function(){this.vc.forEach(function(t){return t()})},n(ul,jc=hl),ul),Wc=(al.Dc=function(t){return new al(t)},Object.defineProperty(al.prototype,"Fc",{get:function(){if(this.Cc)return this.Cc;throw Nr()},enumerable:!1,configurable:!0}),al.prototype.tr=function(t,e,n){return this.Sc.tr(n,e),this.Fc.delete(n),Va.resolve()},al.prototype.er=function(t,e,n){return this.Sc.er(n,e),this.Fc.add(n),Va.resolve()},al.prototype.Ku=function(t,e){return this.Fc.add(e),Va.resolve()},al.prototype.removeTarget=function(t,e){var n=this;this.Sc.Vr(e.targetId).forEach(function(t){return n.Fc.add(t)});var r=this.persistence.Ii();return r.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Fc.add(t)})}).next(function(){return r._c(t,e)})},al.prototype.Vc=function(){this.Cc=new Set},al.prototype.pc=function(t){var n=this,r=this.persistence.Ei().Fi();return Va.forEach(this.Fc,function(e){return n.$c(t,e).next(function(t){t||r.Ki(e)})}).next(function(){return n.Cc=null,r.apply(t)})},al.prototype.Hi=function(t,e){var n=this;return this.$c(t,e).next(function(t){t?n.Fc.delete(e):n.Fc.add(e)})},al.prototype.Ic=function(t){return 0},al.prototype.$c=function(t,e){var n=this;return Va.Cn([function(){return Va.resolve(n.Sc.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.gc(t,e)}])},al),Hc=(sl.prototype.ko=function(t){this.xc=t},sl.prototype.Co=function(t){this.Oc=t},sl.prototype.onMessage=function(t){this.Lc=t},sl.prototype.close=function(){this.kc()},sl.prototype.send=function(t){this.Nc(t)},sl.prototype.Mc=function(){this.xc()},sl.prototype.qc=function(t){this.Oc(t)},sl.prototype.Uc=function(t){this.Lc(t)},sl),zc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Yc=(ol.prototype.Wc=function(t,e){if(e)for(var n in e.so)e.so.hasOwnProperty(n)&&(t[n]=e.so[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.1"},ol.prototype.zo=function(u,r,i){var h=this,c=this.Qc(u);return new Promise(function(o,s){var a=new vr;a.listenOnce(dr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case pr.NO_ERROR:var t=a.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),o(t);break;case pr.TIMEOUT:Er("Connection",'RPC "'+u+'" timed out'),s(new Br(qr.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e,n,r=a.getStatus();Er("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(qr).indexOf(i)?i:qr.UNKNOWN,s(new Br(n,e.message))):s(new Br(qr.UNKNOWN,"Server responded with status "+a.getStatus())):(Er("Connection",'RPC "'+u+'" failed'),s(new Br(qr.UNAVAILABLE,"Connection failed.")));break;default:Nr()}}finally{Er("Connection",'RPC "'+u+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Er("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Wc(n,i),a.send(c,"POST",e,n,15)})},ol.prototype.Ho=function(t,e,n){return this.zo(t,e,n)},ol.prototype.xo=function(t,e){var n,r,i=[this.Bc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=fr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Wc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Er("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Hc({Nc:function(t){l?Er("Connection","Not sending because WebChannel is closed:",t):(c||(Er("Connection","Opening WebChannel transport."),h.open(),c=!0),Er("Connection","WebChannel sending:",t),h.send(t))},kc:function(){return h.close()}});return u(yr.EventType.OPEN,function(){l||Er("Connection","WebChannel transport opened.")}),u(yr.EventType.CLOSE,function(){l||(l=!0,Er("Connection","WebChannel transport closed"),f.qc())}),u(yr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];wr.logLevel<=p.WARN&&(e=n.map(Tr),wr.warn.apply(wr,v(["Firestore (7.17.1): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.qc(new Br(qr.UNAVAILABLE,"The operation could not be completed")))}),u(yr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Ar(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Er("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=di[i];if(void 0!==t)return wi(t)}(),s=r.message,void 0===o&&(o=qr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.qc(new Br(o,s)),h.close()):(Er("Connection","WebChannel received:",n),f.Uc(n)))}),setTimeout(function(){f.Mc()},0),f},ol.prototype.Qc=function(t){var e=zc[t];return this.Bc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},ol),$c=(il.prototype.Ah=function(t){this.Hc.push(t)},il.prototype.Mh=function(){window.removeEventListener("online",this.jc),window.removeEventListener("offline",this.Kc)},il.prototype.Yc=function(){window.addEventListener("online",this.jc),window.addEventListener("offline",this.Kc)},il.prototype.Gc=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Hc;t<e.length;t++)(0,e[t])(0)},il.prototype.zc=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Hc;t<e.length;t++)(0,e[t])(1)},il.Xc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},il),Xc=(rl.prototype.Ah=function(t){},rl.prototype.Mh=function(){},rl),Qc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Kc=(nl.prototype.initialize=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.Ga=this.Jc(r),this.persistence=this.Zc(r),[4,this.persistence.start()];case 1:return t.sent(),this.tl=this.el(r),this.wh=this.nl(r),this.Yo=this.sl(r),[4,this.il(r)];case 2:return e=t.sent(),this.Yo.start(e),this.ja=this.rl(r),this.Wh=this.ol(r),this.hl=this.al(r),this.Ga.rh=function(t){return n.Wh.ka(t,1)},this.ja.Wh=this.Wh,[4,this.Ga.start()];case 3:return t.sent(),[4,this.ja.start()];case 4:return t.sent(),[4,this.ja.ra(this.Wh.ru)];case 5:return t.sent(),[2]}})})},nl.prototype.il=function(t){return e=t.ul,Promise.resolve(new Yc(e));var e},nl.prototype.al=function(t){return new fc(this.Wh)},nl.prototype.el=function(t){return null},nl.prototype.nl=function(t){return e=this.persistence,n=new dc,r=t.cl,new uu(e,n,r);var e,n,r},nl.prototype.Zc=function(t){if(t._l.ll)throw new Br(qr.FAILED_PRECONDITION,Qc);return new Bc(Wc.Dc)},nl.prototype.sl=function(t){var e=dh(t.ul.s),n=t.credentials;return new rc(n,e)},nl.prototype.rl=function(t){var e=this;return new sc(this.wh,this.Yo,t.Vs,function(t){return e.Wh.ka(t,0)},new($c.Xc()?$c:Xc))},nl.prototype.Jc=function(t){return new uc},nl.prototype.ol=function(t){return e=this.wh,n=this.ja,r=this.Yo,i=this.Ga,o=t.cl,s=t.Ka,(a=new lc(e,n,r,i,o,s)).iu=!0,a;var e,n,r,i,o,s,a},nl.prototype.clearPersistence=function(t,e){throw new Br(qr.FAILED_PRECONDITION,Qc)},nl),Jc=(el.prototype.start=function(t,e,n){var r=this;this.fl(),this.ul=t;var i=new Wa,o=new Wa,s=!1;return this.credentials.oo(function(t){if(!s)return s=!0,Er("FirestoreClient","Initializing. user=",t.uid),r.dl(e,n,t,o).then(i.resolve,i.reject);r.Vs.Gs(function(){return r.ja.ia(t)})}),this.Vs.Cs(function(){return i.promise}),o.promise},el.prototype.enableNetwork=function(){var t=this;return this.fl(),this.Vs.enqueue(function(){return t.persistence.Pc(!0),t.ja.enableNetwork()})},el.prototype.dl=function(r,i,o,s){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r.initialize({Vs:this.Vs,ul:this.ul,clientId:this.clientId,credentials:this.credentials,cl:o,Ka:100,_l:i})];case 1:return t.sent(),this.persistence=r.persistence,this.Ga=r.Ga,this.wh=r.wh,this.ja=r.ja,this.Wh=r.Wh,this.tl=r.tl,this.wl=r.hl,this.persistence.Ac(function(){return d(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,3];case 2:if(e=t.sent(),s.reject(e),!this.Tl(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.dl(new Kc,{ll:!1},o,s))];case 3:return[2]}})})},el.prototype.Tl=function(t){return"FirebaseError"===t.name?t.code===qr.FAILED_PRECONDITION||t.code===qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},el.prototype.fl=function(){if(this.Vs.qs)throw new Br(qr.FAILED_PRECONDITION,"The client has already been terminated.")},el.prototype.disableNetwork=function(){var t=this;return this.fl(),this.Vs.enqueue(function(){return t.persistence.Pc(!1),t.ja.disableNetwork()})},el.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.tl&&this.tl.stop(),[4,this.ja.Mh()];case 1:return t.sent(),[4,this.Ga.Mh()];case 2:return t.sent(),[4,this.persistence.Mh()];case 3:return t.sent(),this.credentials.ho(),[2]}})})})},el.prototype.waitForPendingWrites=function(){var t=this;this.fl();var e=new Wa;return this.Vs.Cs(function(){return t.Wh.Tu(e)}),e.promise},el.prototype.listen=function(t,e,n){var r=this;this.fl();var i=new pc(t,e,n);return this.Vs.Cs(function(){return r.wl.listen(i)}),i},el.prototype.Uh=function(t){var e=this;this.El||this.Vs.Cs(function(){return e.wl.Uh(t)})},el.prototype.ml=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.fl(),i=new Wa,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wh.ir(o)];case 1:return(e=t.sent())instanceof qs?i.resolve(e):e instanceof Bs?i.resolve(null):i.reject(new Br(qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=ou(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},el.prototype.Il=function(u){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return this.fl(),a=new Wa,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wh.cr(u,!0)];case 1:return e=t.sent(),n=new hc(u,e._r),r=n.va(e.documents),i=n.Da(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=ou(o,"Failed to execute query '"+u+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})},el.prototype.write=function(t){var e=this;this.fl();var n=new Wa;return this.Vs.Cs(function(){return e.Wh.write(t,n)}),n.promise},el.prototype.s=function(){return this.ul.s},el.prototype.bu=function(t){var e=this;this.fl(),this.Vs.Cs(function(){return e.wl.bu(t),Promise.resolve()})},el.prototype.Su=function(t){var e=this;this.El||this.Vs.Cs(function(){return e.wl.Su(t),Promise.resolve()})},Object.defineProperty(el.prototype,"El",{get:function(){return this.Vs.qs},enumerable:!1,configurable:!0}),el.prototype.transaction=function(t){var e=this;this.fl();var n=new Wa;return this.Vs.Cs(function(){return e.Wh.runTransaction(e.Vs,t,n),Promise.resolve()}),n.promise},el),Zc=(tl.prototype.next=function(t){this.Rl(this.observer.next,t)},tl.prototype.error=function(t){this.Rl(this.observer.error,t)},tl.prototype.Al=function(){this.muted=!0},tl.prototype.Rl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},tl);function tl(t){this.observer=t,this.muted=!1}function el(t,e){this.credentials=t,this.Vs=e,this.clientId=Sr.t()}function nl(){}function rl(){}function il(){var t=this;this.jc=function(){return t.Gc()},this.Kc=function(){return t.zc()},this.Hc=[],this.Yc()}function ol(t){this.s=t.s;var e=t.ssl?"https":"http";this.Bc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function sl(t){this.Nc=t.Nc,this.kc=t.kc}function al(t){this.persistence=t,this.Sc=new lu,this.Cc=null}function ul(t){var e=this;return(e=jc.call(this)||this).Qi=t,e}function hl(){this.vc=[]}function cl(t){var e=this;this.Tc={},this.Ec=new Ma(0),this.mc=!1,this.mc=!0,this.Yi=t(this),this.mi=new qc(this),this.$n=new za,this.Dn=new vc(this.$n,function(t){return e.Yi.Ic(t)})}function ll(t){this.persistence=t,this.oc=new jr(ui,hi),this.lastRemoteSnapshotVersion=Wr.min(),this.highestTargetId=0,this.hc=0,this.ac=new lu,this.targetCount=0,this.uc=$a.As()}function fl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var pl=(wl.prototype.pl=function(t){switch(oo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return fo(t.integerValue||t.doubleValue);case 3:return this.yl(t.timestampValue);case 4:return this.gl(t);case 5:return t.stringValue;case 6:return new xu(po(t.bytesValue));case 7:return this.vl(t.referenceValue);case 8:return this.bl(t.geoPointValue);case 9:return this.Sl(t.arrayValue);case 10:return this.Cl(t.mapValue);default:throw Nr()}},wl.prototype.Cl=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.pl(e)}),r},wl.prototype.bl=function(t){return new sh(fo(t.latitude),fo(t.longitude))},wl.prototype.Sl=function(t){var e=this;return(t.values||[]).map(function(t){return e.pl(t)})},wl.prototype.gl=function(t){switch(this.Pl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return no(n)?t(n):n}(t);return null==e?null:this.pl(e);case"estimate":return this.yl(ro(t));default:return null}},wl.prototype.yl=function(t){var e=lo(t),n=new Gr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},wl.prototype.vl=function(t){var e=zr.N(t);Ar(Fo(e));var n=new Pr(e.get(1),e.get(3)),r=new Xr(e.p(5));return n.isEqual(this.s)||Ir("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Vl(r)},wl),dl=su.oi,yl=(ml.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},ml),vl=(Object.defineProperty(gl.prototype,"ql",{get:function(){return this.Ul||(this.Ul=new Th(this.Ur,this.Ml.ignoreUndefinedProperties)),this.Ul},enumerable:!1,configurable:!0}),gl.prototype.settings=function(t){vu("Firestore.settings",arguments,1),wu("Firestore.settings","object",1,t);var e=new yl(t);if(this.Nl&&!this.Ml.isEqual(e))throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ml=e).credentials&&(this.Ol=function(t){if(!t)return new Qh;switch(t.type){case"gapi":var e=t.Bl;return Ar(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zh(e,t.fo||"0");case"provider":return t.Bl;default:throw new Br(qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},gl.prototype.enableNetwork=function(){return this.$l(),this.Nl.enableNetwork()},gl.prototype.disableNetwork=function(){return this.$l(),this.Nl.disableNetwork()},gl.prototype.enablePersistence=function(t){var e,n;if(this.Nl)throw new Br(qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Ir("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Br(qr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Wl(this.Ll,{ll:!0,cacheSizeBytes:this.Ml.cacheSizeBytes,synchronizeTabs:r,Ql:i})},gl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Nl&&!this.Nl.El)throw new Br(qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Wa,[2,(this.Fl.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ll.clearPersistence(this.Ur,this.xl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},gl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(gl.prototype,"jl",{get:function(){return this.$l(),this.Nl.El},enumerable:!1,configurable:!0}),gl.prototype.waitForPendingWrites=function(){return this.$l(),this.Nl.waitForPendingWrites()},gl.prototype.onSnapshotsInSync=function(t){if(this.$l(),fl(t))return bl(this.Nl,t);wu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return bl(this.Nl,e)},gl.prototype.$l=function(){return this.Nl||this.Wl(new Kc,{ll:!1}),this.Nl},gl.prototype.Gl=function(){return new Or(this.Ur,this.xl,this.Ml.host,this.Ml.ssl,this.Ml.forceLongPolling)},gl.prototype.Wl=function(t,e){var n=this.Gl();return this.Nl=new Jc(this.Ol,this.Fl),this.Nl.start(n,t,e)},gl.kl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Br(qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Br(qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Pr(n)},Object.defineProperty(gl.prototype,"app",{get:function(){if(!this.Dl)throw new Br(qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Dl},enumerable:!1,configurable:!0}),gl.prototype.collection=function(t){return vu("Firestore.collection",arguments,1),wu("Firestore.collection","non-empty string",1,t),this.$l(),new Hl(zr.N(t),this,null)},gl.prototype.doc=function(t){return vu("Firestore.doc",arguments,1),wu("Firestore.doc","non-empty string",1,t),this.$l(),Nl.Kl(zr.N(t),this,null)},gl.prototype.collectionGroup=function(t){if(vu("Firestore.collectionGroup",arguments,1),wu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.$l(),new jl((e=t,new $s(zr.k(),e)),this,null);var e},gl.prototype.runTransaction=function(e){var n=this;return vu("Firestore.runTransaction",arguments,1),wu("Firestore.runTransaction","function",1,e),this.$l().transaction(function(t){return e(new Il(n,t))})},gl.prototype.batch=function(){return this.$l(),new Tl(this)},Object.defineProperty(gl,"logLevel",{get:function(){switch(br()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),gl.setLogLevel=function(t){vu("Firestore.setLogLevel",arguments,1),Nu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),wr.setLogLevel(t)},gl.prototype.zl=function(){return this.Ml.timestampsInSnapshots},gl);function gl(t,e,n){var r=this;if(void 0===n&&(n=new Kc),this.Dl=null,this.Fl=new nu,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.$l(),[4,this.Nl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Dl=i,this.Ur=gl.kl(i),this.xl=i.name,this.Ol=new Kh(e)}else{var o=t;if(!o.projectId)throw new Br(qr.INVALID_ARGUMENT,"Must provide projectId");this.Ur=new Pr(o.projectId,o.database),this.xl="[DEFAULT]",this.Ol=new Qh}this.Ll=n,this.Ml=new yl({})}function ml(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Br(qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Eu("settings","non-empty string","host",t.host),this.host=t.host,Iu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Du("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Iu("settings","object","credentials",t.credentials),this.credentials=t.credentials,Iu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Iu("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Ir("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Ir("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Iu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=su.ai;else{if(t.cacheSizeBytes!==dl&&t.cacheSizeBytes<su.hi)throw new Br(qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+su.hi);this.cacheSizeBytes=t.cacheSizeBytes}Iu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function wl(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Pl=n,this.Vl=r}function bl(t,e){var n=new Zc({next:function(){e.next&&e.next()},error:function(t){throw Nr()}});return t.bu(n),function(){n.Al(),t.Su(n)}}var El,Il=(Sl.prototype.get=function(t){var n=this;vu("Transaction.get",arguments,1);var r=Kl("Transaction.get",t,this.Hl);return this.Yl.eh([r.Br]).then(function(t){if(!t||1!==t.length)return Nr();var e=t[0];if(e instanceof Bs)return new Ol(n.Hl,r.Br,null,!1,!1,r.Wr);if(e instanceof qs)return new Ol(n.Hl,r.Br,e,!1,!1,r.Wr);throw Nr()})},Sl.prototype.set=function(t,e,n){mu("Transaction.set",arguments,2,3);var r=Kl("Transaction.set",t,this.Hl);n=$l("Transaction.set",n);var i=Jl(r.Wr,e,n),o=_h(this.Hl.ql,"Transaction.set",r.Br,i,null!==r.Wr,n);return this.Yl.set(r.Br,o),this},Sl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ju?(gu("Transaction.update",arguments,3),r=Kl("Transaction.update",t,this.Hl),Rh(this.Hl.ql,"Transaction.update",r.Br,e,n,o)):(vu("Transaction.update",arguments,2),r=Kl("Transaction.update",t,this.Hl),Sh(this.Hl.ql,"Transaction.update",r.Br,e)),this.Yl.update(r.Br,i),this},Sl.prototype.delete=function(t){vu("Transaction.delete",arguments,1);var e=Kl("Transaction.delete",t,this.Hl);return this.Yl.delete(e.Br),this},Sl),Tl=(_l.prototype.set=function(t,e,n){mu("WriteBatch.set",arguments,2,3),this.Zl();var r=Kl("WriteBatch.set",t,this.Hl);n=$l("WriteBatch.set",n);var i=Jl(r.Wr,e,n),o=_h(this.Hl.ql,"WriteBatch.set",r.Br,i,null!==r.Wr,n);return this.Xl=this.Xl.concat(o.Qr(r.Br,us.je())),this},_l.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Zl(),i="string"==typeof e||e instanceof ju?(gu("WriteBatch.update",arguments,3),r=Kl("WriteBatch.update",t,this.Hl),Rh(this.Hl.ql,"WriteBatch.update",r.Br,e,n,o)):(vu("WriteBatch.update",arguments,2),r=Kl("WriteBatch.update",t,this.Hl),Sh(this.Hl.ql,"WriteBatch.update",r.Br,e)),this.Xl=this.Xl.concat(i.Qr(r.Br,us.exists(!0))),this},_l.prototype.delete=function(t){vu("WriteBatch.delete",arguments,1),this.Zl();var e=Kl("WriteBatch.delete",t,this.Hl);return this.Xl=this.Xl.concat(new Rs(e.Br,us.je())),this},_l.prototype.commit=function(){return this.Zl(),this.Jl=!0,0<this.Xl.length?this.Hl.$l().write(this.Xl):Promise.resolve()},_l.prototype.Zl=function(){if(this.Jl)throw new Br(qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},_l),Nl=(n(Al,El=vh),Al.Kl=function(t,e,n){if(t.length%2!=0)throw new Br(qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new Al(new Xr(t),e,n)},Object.defineProperty(Al.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"parent",{get:function(){return new Hl(this.Br.path.g(),this.firestore,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Al.prototype,"path",{get:function(){return this.Br.path.$()},enumerable:!1,configurable:!0}),Al.prototype.collection=function(t){if(vu("DocumentReference.collection",arguments,1),wu("DocumentReference.collection","non-empty string",1,t),!t)throw new Br(qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=zr.N(t);return new Hl(this.Br.path.child(e),this.firestore,null)},Al.prototype.isEqual=function(t){if(!(t instanceof Al))throw Lu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Br.isEqual(t.Br)&&this.Wr===t.Wr},Al.prototype.set=function(t,e){mu("DocumentReference.set",arguments,1,2),e=$l("DocumentReference.set",e);var n=Jl(this.Wr,t,e),r=_h(this.firestore.ql,"DocumentReference.set",this.Br,n,null!==this.Wr,e);return this.Nl.write(r.Qr(this.Br,us.je()))},Al.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ju?(gu("DocumentReference.update",arguments,2),Rh(this.firestore.ql,"DocumentReference.update",this.Br,t,e,r)):(vu("DocumentReference.update",arguments,1),Sh(this.firestore.ql,"DocumentReference.update",this.Br,t)),this.Nl.write(n.Qr(this.Br,us.exists(!0)))},Al.prototype.delete=function(){return vu("DocumentReference.delete",arguments,0),this.Nl.write([new Rs(this.Br,us.je())])},Al.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];mu("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||fl(i[a])||(Du("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),Iu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};fl(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(wu("DocumentReference.onSnapshot","function",a,i[a]),bu("DocumentReference.onSnapshot","function",a+1,i[a+1]),bu("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.t_(t))},error:i[a+1],complete:i[a+2]};return Rl(this.Nl,this.Br,h,c)},Al.prototype.get=function(t){var e,n,r,i,o,s=this;return mu("DocumentReference.get",arguments,0,1),Ql("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.$l().ml(this.Br).then(function(t){return new Ol(s.firestore,s.Br,t,!0,t instanceof qs&&t.Ge,s.Wr)}):(e=this.Nl,n=this.Br,r=t,i=new Wa,o=Rl(e,n,{includeMetadataChanges:!0,xu:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Br(qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Br(qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.t_(t)}))},Al.prototype.withConverter=function(t){return new Al(this.Br,this.firestore,t)},Al.prototype.t_=function(t){var e=t.docs.get(this.Br);return new Ol(this.firestore,this.Br,e,t.fromCache,t.hasPendingWrites,this.Wr)},Al);function Al(t,e,n){var r=this;return(r=El.call(this,e.Ur,t,n)||this).Br=t,r.firestore=e,r.Wr=n,r.Nl=r.firestore.$l(),r}function _l(t){this.Hl=t,this.Xl=[],this.Jl=!1}function Sl(t,e){this.Hl=t,this.Yl=e}function Rl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Zc({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(Qs(e.path),o,n);return function(){o.Al(),t.Uh(s)}}var Dl,Ll=(Cl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Cl),Ol=(Vl.prototype.data=function(t){var e=this;if(mu("DocumentSnapshot.data",arguments,0,1),t=Xl("DocumentSnapshot.data",t),this.e_){if(this.Wr){var n=new Pl(this.Hl,this.Br,this.e_,this.n_,this.s_,null);return this.Wr.fromFirestore(n,t)}return new pl(this.Hl.Ur,this.Hl.zl(),t.serverTimestamps||"none",function(t){return new Nl(t,e.Hl,null)}).pl(this.e_.Ze())}},Vl.prototype.get=function(t,e){var n=this;if(mu("DocumentSnapshot.get",arguments,1,2),e=Xl("DocumentSnapshot.get",e),this.e_){var r=this.e_.data().field(Vh("DocumentSnapshot.get",t,this.Br));if(null!==r)return new pl(this.Hl.Ur,this.Hl.zl(),e.serverTimestamps||"none",function(t){return new Nl(t,n.Hl,n.Wr)}).pl(r)}},Object.defineProperty(Vl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"ref",{get:function(){return new Nl(this.Br,this.Hl,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"exists",{get:function(){return null!==this.e_},enumerable:!1,configurable:!0}),Object.defineProperty(Vl.prototype,"metadata",{get:function(){return new Ll(this.s_,this.n_)},enumerable:!1,configurable:!0}),Vl.prototype.isEqual=function(t){if(!(t instanceof Vl))throw Lu("isEqual","DocumentSnapshot",1,t);return this.Hl===t.Hl&&this.n_===t.n_&&this.Br.isEqual(t.Br)&&(null===this.e_?null===t.e_:this.e_.isEqual(t.e_))&&this.Wr===t.Wr},Vl),Pl=(n(kl,Dl=Ol),kl.prototype.data=function(t){return Dl.prototype.data.call(this,t)},kl);function kl(){return null!==Dl&&Dl.apply(this,arguments)||this}function Vl(t,e,n,r,i,o){this.Hl=t,this.Br=e,this.e_=n,this.n_=r,this.s_=i,this.Wr=o}function Cl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Ul(t,e,n){if("string"==typeof n){if(""===n)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ks(e)&&-1!==n.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(zr.N(n));if(!Xr.W(r))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return yo(t,new Xr(r))}if(n instanceof vh)return yo(t,n.Br);throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Su(n)+".")}function Ml(t,e){if(!Array.isArray(t)||0===t.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function xl(t,e,n){if(!n.isEqual(e))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Fl(t){if(t.an()&&0===t.tn.length)throw new Br(qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var jl=(ql.prototype.where=function(t,e,n){vu("Query.where",arguments,3),Ru("Query.where",3,n);var r,i,o=Nu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Vh("Query.where",t),a=function(t,e,n,r,i,o){var s;if(r.L()){if("array-contains"===i||"array-contains-any"===i)throw new Br(qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){Ml(o,i);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(Ul(n,t,c))}s={arrayValue:{values:a}}}else s=Ul(n,t,o)}else"in"!==i&&"array-contains-any"!==i||Ml(o,i),s=Dh(e,"Query.where",o,"in"===i);var l=ha.create(r,i,s);return function(t,e){if(e instanceof ha){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&xl(0,e.field,a)}else if(o||i){var u=null;if(o&&(u=t._n(r)),null===u&&i&&(u=t._n(n)),null!==u)throw u===e.op?new Br(qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Br(qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}}(t,l),l}(this.i_,this.firestore.ql,this.firestore.Ur,s,o,n);return new ql((i=(r=this.i_).filters.concat([a]),new $s(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},ql.prototype.orderBy=function(t,e){var n;if(mu("Query.orderBy",arguments,1,2),bu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Br(qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Vh("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new La(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&xl(0,o,i.field),s}(this.i_,o,n);return new ql((i=(r=this.i_).tn.concat([s]),new $s(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},ql.prototype.limit=function(t){return vu("Query.limit",arguments,1),wu("Query.limit","number",1,t),Ou("Query.limit",1,t),new ql(ta(this.i_,t,"F"),this.firestore,this.Wr)},ql.prototype.limitToLast=function(t){return vu("Query.limitToLast",arguments,1),wu("Query.limitToLast","number",1,t),Ou("Query.limitToLast",1,t),new ql(ta(this.i_,t,"L"),this.firestore,this.Wr)},ql.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];gu("Query.startAt",arguments,1);var r=this.r_("Query.startAt",t,e,!0);return new ql(ea(this.i_,r),this.firestore,this.Wr)},ql.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];gu("Query.startAfter",arguments,1);var r=this.r_("Query.startAfter",t,e,!1);return new ql(ea(this.i_,r),this.firestore,this.Wr)},ql.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];gu("Query.endBefore",arguments,1);var r=this.r_("Query.endBefore",t,e,!0);return new ql(na(this.i_,r),this.firestore,this.Wr)},ql.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];gu("Query.endAt",arguments,1);var r=this.r_("Query.endAt",t,e,!1);return new ql(na(this.i_,r),this.firestore,this.Wr)},ql.prototype.isEqual=function(t){if(!(t instanceof ql))throw Lu("isEqual","Query",1,t);return this.firestore===t.firestore&&ra(this.i_,t.i_)&&this.Wr===t.Wr},ql.prototype.withConverter=function(t){return new ql(this.i_,this.firestore,t)},ql.prototype.r_=function(c,t,e,n){if(Ru(c,1,t),t instanceof Ol)return vu(c,v([t],e),1),function(t,e,n,r){if(!n)throw new Br(qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Js(t);o<s.length;o++){var a=s[o];if(a.field.L())i.push(yo(e,n.key));else{var u=n.field(a.field);if(no(u))throw new Br(qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.$();throw new Br(qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new Ea(i,r)}(this.i_,this.firestore.Ur,t.e_,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Br(qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.L()){if("string"!=typeof h)throw new Br(qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Ks(t)&&-1!==h.indexOf("/"))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(zr.N(h));if(!Xr.W(c))throw new Br(qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Xr(c);a.push(yo(e,l))}else{var f=Dh(n,r,h);a.push(f)}}return new Ea(a,o)}(this.i_,this.firestore.Ur,this.firestore.ql,c,r,n)},ql.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];mu("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||fl(i[u])||(Du("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),Iu("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),fl(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(wu("Query.onSnapshot","function",u,i[u]),bu("Query.onSnapshot","function",u+1,i[u+1]),bu("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new Wl(r.firestore,r.i_,t,r.Wr))},error:i[u+1],complete:i[u+2]};return Fl(this.i_),Bl(this.firestore.$l(),this.i_,a,h)},ql.prototype.get=function(t){var e=this;mu("Query.get",arguments,0,1),Ql("Query.get",t),Fl(this.i_);var n,r,i,o,s,a=this.firestore.$l();return(t&&"cache"===t.source?a.Il(this.i_):(n=a,r=this.i_,i=t,o=new Wa,s=Bl(n,r,{includeMetadataChanges:!0,xu:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Br(qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Wl(e.firestore,e.i_,t,e.Wr)})},ql);function ql(t,e,n){this.i_=t,this.firestore=e,this.Wr=n}function Bl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Zc({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Al(),t.Uh(s)}}var Gl,Wl=(Object.defineProperty(Yl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"empty",{get:function(){return this.h_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"size",{get:function(){return this.h_.docs.size},enumerable:!1,configurable:!0}),Yl.prototype.forEach=function(e,n){var r=this;mu("QuerySnapshot.forEach",arguments,1,2),wu("QuerySnapshot.forEach","function",1,e),this.h_.docs.forEach(function(t){e.call(n,r.c_(t,r.metadata.fromCache,r.h_.Mt.has(t.key)))})},Object.defineProperty(Yl.prototype,"query",{get:function(){return new jl(this.o_,this.Hl,this.Wr)},enumerable:!1,configurable:!0}),Yl.prototype.docChanges=function(t){t&&(Du("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Iu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.h_.Ut)throw new Br(qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.a_&&this.u_===e||(this.a_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.h_,e,this.c_.bind(this)),this.u_=e),this.a_},Yl.prototype.isEqual=function(t){if(!(t instanceof Yl))throw Lu("isEqual","QuerySnapshot",1,t);return this.Hl===t.Hl&&ra(this.o_,t.o_)&&this.h_.isEqual(t.h_)&&this.Wr===t.Wr},Yl.prototype.c_=function(t,e,n){return new Pl(this.Hl,t.key,t,e,n,this.Wr)},Yl),Hl=(n(zl,Gl=jl),Object.defineProperty(zl.prototype,"id",{get:function(){return this.i_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"parent",{get:function(){var t=this.i_.path.g();return t._()?null:new Nl(new Xr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(zl.prototype,"path",{get:function(){return this.i_.path.$()},enumerable:!1,configurable:!0}),zl.prototype.doc=function(t){mu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Sr.t()),wu("CollectionReference.doc","non-empty string",1,t);var e=zr.N(t);return Nl.Kl(this.i_.path.child(e),this.firestore,this.Wr)},zl.prototype.add=function(t){vu("CollectionReference.add",arguments,1),wu("CollectionReference.add","object",1,this.Wr?this.Wr.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},zl.prototype.withConverter=function(t){return new zl(this.l_,this.firestore,t)},zl);function zl(t,e,n){var r=this;if(((r=Gl.call(this,Qs(t),e,n)||this).l_=t).length%2!=1)throw new Br(qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function Yl(t,e,n,r){this.Hl=t,this.o_=e,this.h_=n,this.Wr=r,this.a_=null,this.u_=null,this.metadata=new Ll(n.hasPendingWrites,n.fromCache)}function $l(t,e){if(void 0===e)return{merge:!1};if(Du(t,e,["merge","mergeFields"]),Iu(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Su(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof ju))throw new Br(qr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Su(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Br(qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Xl(t,e){return void 0===e?{}:(Du(t,e,["serverTimestamps"]),Tu(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ql(t,e){bu(t,"object",1,e),e&&(Du(t,e,["source"]),Tu(t,0,"source",e.source,["default","server","cache"]))}function Kl(t,e,n){if(e instanceof vh){if(e.firestore!==n)throw new Br(qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Lu(t,"DocumentReference",1,e)}function Jl(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Zl,tf={Firestore:vl,GeoPoint:sh,Timestamp:Gr,Blob:xu,Transaction:Il,WriteBatch:Tl,DocumentReference:Nl,DocumentSnapshot:Ol,Query:jl,QueryDocumentSnapshot:Pl,QuerySnapshot:Wl,CollectionReference:Hl,FieldPath:ju,FieldValue:ih,setLogLevel:vl.setLogLevel,CACHE_SIZE_UNLIMITED:dl};(Zl=ef).INTERNAL.registerComponent(new gr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new vl(e,n,new Kc);var e,n},"PUBLIC").setServiceProps(Object.assign({},tf))),Zl.registerVersion("@firebase/firestore","1.16.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});