!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Td){"use strict";try{(function(){Td=Td&&Object.prototype.hasOwnProperty.call(Td,"default")?Td.default:Td;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,v=(n(f,l=Error),f);function f(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g;function E(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},_=N||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function x(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),P=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:R).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now||function(){return+new Date};function U(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function M(){this.j=this.j,this.i=this.i}M.prototype.j=!1,M.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++P))},M.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var W,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Q=_.navigator;if(Q){var Y=Q.userAgent;if(Y){W=Y;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<$.length;o++)n=$[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=H(W,"Opera"),ot=H(W,"Trident")||H(W,"MSIE"),st=H(W,"Edge"),ut=st||ot,at=H(W,"Gecko")&&!(H(W.toLowerCase(),"webkit")&&!H(W,"Edge"))&&!(H(W,"Trident")||H(W,"MSIE"))&&!H(W,"Edge"),ht=H(W.toLowerCase(),"webkit")&&!H(W,"Edge");function ct(){var t=_.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=W,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt={};function yt(u){return t=u,e=function(){for(var t=0,e=K(String(nt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var vt=_.document&&ot&&(ct()||parseInt(nt,10))||void 0,gt=!ot||9<=Number(vt),mt=ot&&!yt("9"),wt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},U(It,bt);var Et={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++Nt,this.V=this.X=!1}function _t(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=j(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new At(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var kt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[Tt]?e.sa(n,r,k(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Tt]?t.ra(e,n,k(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!gt)return null;var u,a,h=Ut(t);if(h||(t[kt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ft,r=a=gt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Dt(n,t),0==n.b&&(n.src=null,e[kt]=null)):_t(t)))}function Ct(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Rt(t),n.call(r,e)}function Ft(t,e){if(t.V)return!0;if(gt)return Vt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new It(e,this))}function Ut(t){return(t=t[kt])instanceof St?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==D(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function qt(){M.call(this),this.c=new St(this),(this.J=this).A=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(qt,M),qt.prototype[Tt]=!0,(T=qt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=jt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new bt(t,n):t instanceof bt?t.target=t.target||n:(s=t,tt(t=new bt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},T.C=function(){if(qt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=_.JSON.stringify;function zt(){this.b=this.a=null}var Wt,Kt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Xt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Qt(t){_.setTimeout(function(){throw t},0)}function Yt(t,e){var n;Wt||(n=_.Promise.resolve(void 0),Wt=function(){n.then($t)}),Jt||(Wt(),Jt=!0),Zt.add(t,e)}zt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new zt;function $t(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Qt(t)}var r=Kt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function te(t,e){qt.call(this),this.b=t||1,this.a=e||_,this.f=C(this.Ua,this),this.g=F()}function ee(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ne(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function re(t,e,n){M.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ie(t){t.T=ne(t.b,t.c),t.f.apply(null,t.a)}function oe(t){M.call(this),this.b=t,this.a={}}U(te,qt),(T=te.prototype).Z=!1,T.L=null,T.Ua=function(){var t;this.Z&&(0<(t=F()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ee(this),this.start())))},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=F())},T.C=function(){te.M.C.call(this),ee(this),delete this.a},U(re,M),(T=re.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ie(this)},T.C=function(){re.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ie(this))},U(oe,M);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function he(){}oe.prototype.C=function(){oe.M.C.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=null;function le(){return ce=ce||new qt}function fe(t){bt.call(this,"serverreachability",t)}function pe(){var t=le();t.dispatchEvent(new fe(t))}function de(t){bt.call(this,"statevent",t)}function ye(){var t=le();t.dispatchEvent(new de(t))}function ve(t){bt.call(this,"timingevent",t)}function ge(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}U(fe,bt),U(de,bt),U(ve,bt);var me={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},we={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function be(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ee(){}be.prototype.a=null;var Te,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Ae(){bt.call(this,"d")}function _e(){bt.call(this,"c")}function Se(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new oe(this),this.N=xe,t=ut?125:void 0,this.O=new te(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}U(Ae,bt),U(_e,bt),U(Se,be),Te=new Se;var xe=45e3,ke={},Oe={};function Pe(t,e,n){t.B=1,t.f=$e(He(e)),t.j=n,t.F=!0,Le(t,null)}function Le(t,e){t.s=F(),Ce(t),t.A=He(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),pn(n.b,"t",r),t.w=0,t.a=ir(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(C(t.ya,t,t.a),t.J)),ue(t.G,t.a,"readystatechange",t.Sa),e=t.m?Z(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),pe()}function Re(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Oe:(o=Number(i.substring(o,s)),isNaN(o)?ke:(s+=1)+o>i.length?Oe:(i=i.substr(s,o),r.w=s+o,i)));if(a==Oe){4==e&&(t.c=4,ye(),u=!1);break}if(a==ke){t.c=4,ye(),u=!1;break}je(t,a)}4==e&&0==n.length&&(t.c=1,ye(),u=!1),t.b=t.b&&u,u||(Me(t),Ue(t))}function Ce(t){t.P=F()+t.N,Ve(t,t.N)}function Ve(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=ge(C(t.Qa,t),e)}function Fe(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function Ue(t){0==t.g.u||t.l||$n(t.g,t)}function Me(t){Fe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ee(t.O),ae(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function je(t,e){try{var n,r,i,o,s,u,a,h,c,l,f=t.g;if(0!=f.u&&(f.a==t||bn(f.b,t)))if(f.A=t.H,!t.o&&bn(f.b,t)&&3==f.u){try{var p=f.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!f.i){if(f.a){if(!(f.a.s+3e3<t.s))break t;Zn(f),f.a.cancel(),f.a=null}Jn(f),ye()}}else f.ia=d[1],0<f.ia-f.G&&d[2]<37500&&f.U&&0==f.m&&!f.l&&(f.l=ge(C(f.Na,f),6e3));if(wn(f.b)<=1&&f.O){try{f.O()}catch(t){}f.O=void 0}}else er(f,11)}else if(!t.o&&f.a!=t||Zn(f),!z(e))for(e=p=f.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],f.G=d[0],d=d[1],2==f.u?"c"==d[0]?(f.B=d[1],f.R=d[2],null!=(n=d[3])&&(f.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(f.D=1.5*r),i=f,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(H(s,"spdy")||H(s,"quic")||H(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,Ze(i.v,i.s,a))),f.u=3,f.c&&f.c.na(),h=t,(i=f).ea=rr(i,i.w?i.R:null,i.P),h.o?(En(i.b,h),c=h,(l=i.D)&&c.setTimeout(l),c.h&&(Fe(c),Ce(c)),i.a=h):Yn(i),0<f.f.length&&Kn(f)):"stop"!=d[0]&&"close"!=d[0]||er(f,7):3==f.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?er(f,7):Bn(f):"noop"!=d[0]&&f.c&&f.c.ma(d),f.m=0)}pe()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Be(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=De.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Mn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Mn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||pe(),Fe(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ye(),Me(this),Ue(this);break t}this.o=!0,je(this,u)}this.F?(Re(this,e,i),ut&&this.b&&3==e&&(ue(this.G,this.O,"tick",this.Ra),this.O.start())):je(this,i),4==e&&Me(this),this.b&&!this.l&&(4==e?$n(this.g,this):(this.b=!1,Ce(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ye(),Me(this),Ue(this)}}}catch(t){}},T.Ra=function(){var t,e;this.a&&(t=Mn(this.a),e=this.a.Y(),this.w<e.length&&(Fe(this),Re(this,t,e),this.b&&4!=t&&Ce(this)))},T.cancel=function(){this.l=!0,Me(this)},T.Qa=function(){this.h=null;var t=F();0<=t-this.P?(2!=this.B&&(pe(),ye()),Me(this),this.c=2,Ue(this)):Ve(this,this.P-t)},(T=Ge.prototype).I=function(){Be(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return Be(this),this.a.concat()},T.get=function(t,e){return ze(this.b,t)?this.b[t]:e},T.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Qe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=tn(n[2]||""),Qe(this,n[3]||"",!0),Ye(this,n[4]),this.g=tn(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=tn(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function He(t){return new Ke(t)}function Xe(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Qe(t,e,n){t.c=n?tn(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,un)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function $e(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",en(n,an)),t.join("")};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,un=/[#\?@]/g,an=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){cn(t),e=dn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Be(t)))}function fn(t,e){return cn(t),e=dn(t,e),ze(t.a.b,e)}function pn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),B(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=hn.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){cn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){cn(this);var e=[];if("string"==typeof t)fn(this,t)&&(e=G(e,this.a.get(dn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},T.set=function(t,e){return cn(this),this.c=null,fn(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=10;function mn(t){return t.b||t.a&&t.a.size>=t.f}function wn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function En(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=E(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function An(){this.a=new Nn}function _n(t,r,e){var i=e||"";try{qe(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=E(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Dn=_.JSON.parse;function xn(t){qt.call(this),this.headers=new Ge,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=kn,this.B=this.F=!1}U(xn,qt);var kn="",On=/^https?$/i,Pn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Rn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Fn(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Vn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Mn(t)||2!=t.S()))if(t.l&&4==Mn(t))ne(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Mn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(We)[1]||null)&&_.self&&_.self.location&&(i=(r=_.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Mn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Cn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Mn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=qn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=qn("baseRetryDelayMs",5e3,t),this.Ga=qn("retryDelaySeedMs",1e4,t),this.Da=qn("forwardChannelMaxRetries",2,t),this.ga=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new vn(t&&t.concurrentRequestLimit),this.ja=new An,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Bn(t){var e,n;zn(t),3==t.u&&(e=t.H++,Ze(n=He(t.v),"SID",t.B),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Xn(t,n),(e=new De(t,e,void 0)).B=2,e.f=$e(He(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ir(e.g,null),e.a.$(e.f)),e.s=F(),Ce(e)),nr(t)}function zn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),Zn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function Wn(t,e){t.f.push(new yn(t.Fa++,e)),3==t.u&&Kn(t)}function Kn(t){mn(t.b)||t.g||(t.g=!0,Yt(t.xa,t),t.o=0)}function Hn(t,e){var n=e?e.W:t.H++,r=He(t.v);Ze(r,"SID",t.B),Ze(r,"RID",n),Ze(r,"AID",t.G),Xn(t,r),t.h&&t.j&&jn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),Pe(n,r,e)}function Xn(t,n){t.c&&qe({},function(t,e){Ze(n,e,t)})}function Qn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{_n(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Yn(t){t.a||t.i||(t.J=1,Yt(t.wa,t),t.m=0)}function Jn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=ge(C(t.wa,t),tr(t,t.m)),t.m++,1)}function Zn(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function $n(t,e){var n,r=null;if(t.a==e){Zn(t),t.a=null;var i=2}else{if(!bn(t.b,e))return;r=e.i,En(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.s,n=t.o,(i=le()).dispatchEvent(new ve(i)),Kn(t)):Yn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(wn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=ge(C(t.xa,t,e),tr(t,t.o)),t.o++,1}}(t,e)||2==i&&Jn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function er(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=C(t.Ta,t),n||(n=new Ke("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Xe(n,"https"),$e(n)),i=n.toString(),o=r,u=new he,_.Image?((s=new Image).onload=V(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=V(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=V(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=V(Sn,u,s,"TestLoadImage: timeout",!1,o),_.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ye(),t.u=0,t.c&&t.c.la(e),nr(t),zn(t)}function nr(t){t.u=0,t.A=-1,t.c&&(0==Tn(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.ka())}function rr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Ke?He(r):new Ke(r,void 0);return""!=c.c?(e&&Qe(c,e+"."+c.c),Ye(c,c.h)):(o=(i=_.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Ke(null,void 0),o&&Xe(h,o),s&&Qe(h,s),u&&Ye(h,u),a&&(h.g=a),c=h),t.N&&J(t.N,function(t,e){Ze(c,e,t)}),e=t.s,n=t.ha,e&&n&&Ze(c,e,n),Ze(c,"VER",t.oa),Xn(t,c),c}function ir(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ea)).F=t.w,e}function or(){}function sr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function ur(t,e){qt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){_e.call(this),this.status=1}function cr(t){this.a=t}(T=xn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Te),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Rn(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=j(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ne(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Rn(this,t)}},T.ta=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),xn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Vn(this):this.Oa())},T.Oa=function(){Vn(this)},T.S=function(){try{return 2<Mn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Gn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=Z(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Qn(this,n,e),Ze(i=He(this.v),"RID",t),Ze(i,"CVER",22),this.s&&Ze(i,"X-HTTP-Session-Id",this.s),Xn(this,i),this.h&&r&&jn(i,this.h,r),In(this.b,n),this.fa?(Ze(i,"$req",e),Ze(i,"SID","null"),n.R=!0,Pe(n,i,null)):Pe(n,i,e),this.u=2}}else 3==this.u&&(t?Hn(this,t):0==this.f.length||mn(this.b)||Hn(this))},T.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=He(this.ea);Ze(t,"RID","rpc"),Ze(t,"SID",this.B),Ze(t,"CI",this.U?"0":"1"),Ze(t,"AID",this.G),Xn(this,t),Ze(t,"TYPE","xmlhttp"),this.h&&this.j&&jn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=$e(He(t)),e.j=null,e.F=!0,Le(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Jn(this),ye())},T.Ta=function(t){ye()},(T=or.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},U(ur,qt),(T=ur.prototype).addEventListener=function(t,e,n,r){ur.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){ur.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(),t.P=e,t.N=n||{},t.U=t.W,t.v=rr(t,null,t.P),Kn(t)},T.close=function(){Bn(this.a)},T.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Bt(t),Wn(this.a,e)):Wn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,Bn(this.a),delete this.a,ur.M.C.call(this)},U(ar,Ae),U(hr,_e),U(cr,or),cr.prototype.na=function(){this.a.dispatchEvent("a")},cr.prototype.ma=function(t){this.a.dispatchEvent(new ar(t))},cr.prototype.la=function(t){this.a.dispatchEvent(new hr)},cr.prototype.ka=function(){this.a.dispatchEvent("b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.La,ur.prototype.open=ur.prototype.Ka,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ee.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",qt.prototype.listen=qt.prototype.ra,xn.prototype.listenOnce=xn.prototype.sa,xn.prototype.getLastError=xn.prototype.Ma,xn.prototype.getLastErrorCode=xn.prototype.qa,xn.prototype.getStatus=xn.prototype.S,xn.prototype.getResponseJson=xn.prototype.Ja,xn.prototype.getResponseText=xn.prototype.Y,xn.prototype.send=xn.prototype.$;var lr={createWebChannelTransport:function(){return new sr},ErrorCode:me,EventType:we,WebChannel:Ee,XhrIo:xn},fr=lr.createWebChannelTransport,pr=lr.ErrorCode,dr=lr.EventType,yr=lr.WebChannel,vr=lr.XhrIo,gr=(mr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},mr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},mr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},mr);function mr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var wr="7.17.1-20206244562",br=new h("@firebase/firestore");function Ir(){return br.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.DEBUG&&(e=n.map(Nr),br.debug.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.ERROR&&(e=n.map(Nr),br.error.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ar(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function _r(t){t||Ar()}function Sr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Dr=(xr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Sr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},xr);function xr(){}function kr(t,e){return t<e?-1:e<t?1:0}function Or(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Pr(t){return t+"\0"}function Lr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Rr=(Object.defineProperty(Cr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Cr.prototype.isEqual=function(t){return t instanceof Cr&&t.projectId===this.projectId&&t.database===this.database},Cr.prototype.o=function(t){return kr(this.projectId,t.projectId)||kr(this.database,t.database)},Cr);function Cr(t,e){this.projectId=t,this.database=e||"(default)"}function Vr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ur(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,jr,qr,Gr=(oi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},oi.prototype.has=function(t){return void 0!==this.get(t)},oi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},oi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},oi.prototype.forEach=function(u){Fr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},oi.prototype._=function(){return Ur(this.l)},oi),Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},zr=(n(ii,qr=Error),ii),Wr=(ri.now=function(){return ri.fromMillis(Date.now())},ri.fromDate=function(t){return ri.fromMillis(t.getTime())},ri.fromMillis=function(t){var e=Math.floor(t/1e3);return new ri(e,1e6*(t-1e3*e))},ri.prototype.toDate=function(){return new Date(this.toMillis())},ri.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ri.prototype.T=function(t){return this.seconds===t.seconds?kr(this.nanoseconds,t.nanoseconds):kr(this.seconds,t.seconds)},ri.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ri.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ri.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ri),Kr=(ni.I=function(t){return new ni(t)},ni.min=function(){return new ni(new Wr(0,0))},ni.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ni.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ni.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ni.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ni.prototype.A=function(){return this.timestamp},ni),Hr=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.P(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ei.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ei.prototype.v=function(){return this.segments[this.offset]},ei.prototype.S=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype._=function(){return 0===this.length},ei.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.$=function(){return this.segments.slice(this.offset,this.limit())},ei.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),Xr=(n(ti,jr=Hr),ti.prototype.g=function(t,e,n){return new ti(t,e,n)},ti.prototype.F=function(){return this.$().join("/")},ti.prototype.toString=function(){return this.F()},ti.N=function(t){if(0<=t.indexOf("//"))throw new zr(Br.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ti(t.split("/").filter(function(t){return 0<t.length}))},ti.k=function(){return new ti([])},ti),Qr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yr=(n($r,Mr=Hr),$r.prototype.g=function(t,e,n){return new $r(t,e,n)},$r.M=function(t){return Qr.test(t)},$r.prototype.F=function(){return this.$().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),$r.M(t)||(t="`"+t+"`"),t}).join(".")},$r.prototype.toString=function(){return this.F()},$r.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},$r.L=function(){return new $r(["__name__"])},$r.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new zr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new zr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new zr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $r(e)},$r.k=function(){return new $r([])},$r),Jr=(Zr.B=function(t){return new Zr(Xr.N(t).V(5))},Zr.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Zr.prototype.isEqual=function(t){return null!==t&&0===Xr.P(this.path,t.path)},Zr.prototype.toString=function(){return this.path.toString()},Zr.P=function(t,e){return Xr.P(t.path,e.path)},Zr.W=function(t){return t.length%2==0},Zr.j=function(t){return new Zr(new Xr(t.slice()))},Zr);function Zr(t){this.path=t}function $r(){return null!==Mr&&Mr.apply(this,arguments)||this}function ti(){return null!==jr&&jr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&Ar(),void 0===n?n=t.length-e:n>t.length-e&&Ar(),this.segments=t,this.offset=e,this.R=n}function ni(t){this.timestamp=t}function ri(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new zr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new zr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new zr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new zr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ii(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function oi(t,e){this.h=t,this.u=e,this.l={}}function si(t){return null==t}function ui(t){return-0===t&&1/t==-1/0}function ai(t){return"number"==typeof t&&Number.isInteger(t)&&!ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function ci(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new hi(t,e,n,r,i,o,s)}function li(t){var e,n=t;return null===n.K&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+po(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),si(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Mu(n.startAt)),n.endAt&&(e+="|ub:",e+=Mu(n.endAt)),n.K=e),n.K}function fi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i,o,s=0;s<t.orderBy.length;s++)if(n=t.orderBy[s],r=e.orderBy[s],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(i=t.filters[u],o=e.filters[u],!(i instanceof Iu&&o instanceof Iu&&i.op===o.op&&i.field.isEqual(o.field)&&ho(i.value,o.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qu(t.startAt,e.startAt)&&qu(t.endAt,e.endAt)}function pi(t){return Jr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var di=(yi.fromBase64String=function(t){return new yi(atob(t))},yi.fromUint8Array=function(t){return new yi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},yi.prototype.toBase64=function(){return t=this.G,btoa(t);var t},yi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},yi.prototype.H=function(){return 2*this.G.length},yi.prototype.o=function(t){return kr(this.G,t.G)},yi.prototype.isEqual=function(t){return this.G===t.G},yi);function yi(t){this.G=t}function vi(t){this.count=t}di.Y=new di("");var gi,mi,wi=(bi.prototype.Z=function(t){return new bi(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bi.prototype.tt=function(t,e){return new bi(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bi.prototype.et=function(t){return new bi(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},bi);function bi(t,e,n,r,i,o,s){void 0===i&&(i=Kr.min()),void 0===o&&(o=Kr.min()),void 0===s&&(s=di.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ii(t){switch(t){case Br.OK:return Ar();case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return 1;default:return Ar()}}function Ei(t){if(void 0===t)return Tr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case gi.OK:return Br.OK;case gi.CANCELLED:return Br.CANCELLED;case gi.UNKNOWN:return Br.UNKNOWN;case gi.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case gi.INTERNAL:return Br.INTERNAL;case gi.UNAVAILABLE:return Br.UNAVAILABLE;case gi.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case gi.NOT_FOUND:return Br.NOT_FOUND;case gi.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case gi.ABORTED:return Br.ABORTED;case gi.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case gi.DATA_LOSS:return Br.DATA_LOSS;default:return Ar()}}(mi=gi=gi||{})[mi.OK=0]="OK",mi[mi.CANCELLED=1]="CANCELLED",mi[mi.UNKNOWN=2]="UNKNOWN",mi[mi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mi[mi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mi[mi.NOT_FOUND=5]="NOT_FOUND",mi[mi.ALREADY_EXISTS=6]="ALREADY_EXISTS",mi[mi.PERMISSION_DENIED=7]="PERMISSION_DENIED",mi[mi.UNAUTHENTICATED=16]="UNAUTHENTICATED",mi[mi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mi[mi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mi[mi.ABORTED=10]="ABORTED",mi[mi.OUT_OF_RANGE=11]="OUT_OF_RANGE",mi[mi.UNIMPLEMENTED=12]="UNIMPLEMENTED",mi[mi.INTERNAL=13]="INTERNAL",mi[mi.UNAVAILABLE=14]="UNAVAILABLE",mi[mi.DATA_LOSS=15]="DATA_LOSS";var Ti=(Di.prototype.nt=function(t,e){return new Di(this.P,this.root.nt(t,e,this.P).copy(null,null,Ai.st,null,null))},Di.prototype.remove=function(t){return new Di(this.P,this.root.remove(t,this.P).copy(null,null,Ai.st,null,null))},Di.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Di.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Di.prototype._=function(){return this.root._()},Object.defineProperty(Di.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Di.prototype.it=function(){return this.root.it()},Di.prototype.rt=function(){return this.root.rt()},Di.prototype.ot=function(t){return this.root.ot(t)},Di.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Di.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Di.prototype.ht=function(t){return this.root.ht(t)},Di.prototype.at=function(){return new Ni(this.root,null,this.P,!1)},Di.prototype.ut=function(t){return new Ni(this.root,t,this.P,!1)},Di.prototype.ct=function(){return new Ni(this.root,null,this.P,!0)},Di.prototype.lt=function(t){return new Ni(this.root,t,this.P,!0)},Di),Ni=(Si.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Si.prototype.wt=function(){return 0<this.ft.length},Si.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Si),Ai=(_i.prototype.copy=function(t,e,n,r,i){return new _i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},_i.prototype._=function(){return!1},_i.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},_i.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},_i.prototype.min=function(){return this.left._()?this:this.left.min()},_i.prototype.it=function(){return this.min().key},_i.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},_i.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},_i.prototype.It=function(){if(this.left._())return _i.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},_i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return _i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},_i.prototype.At=function(){return this.color},_i.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},_i.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},_i.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},_i.prototype.Vt=function(){var t=this.copy(null,null,_i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},_i.prototype.Pt=function(){var t=this.copy(null,null,_i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},_i.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},_i.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},_i.prototype.bt=function(){if(this.At()&&this.left.At())throw Ar();if(this.right.At())throw Ar();var t=this.left.bt();if(t!==this.right.bt())throw Ar();return t+(this.At()?0:1)},_i);function _i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:_i.RED,this.left=null!=r?r:_i.EMPTY,this.right=null!=i?i:_i.EMPTY,this.size=this.left.size+1+this.right.size}function Si(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Di(t,e){this.P=t,this.root=e||Ai.EMPTY}function xi(){this.size=0}Ai.EMPTY=null,Ai.RED=!0,Ai.st=!1,Ai.EMPTY=(Object.defineProperty(xi.prototype,"key",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"value",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"color",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"left",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"right",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),xi.prototype.copy=function(t,e,n,r,i){return this},xi.prototype.nt=function(t,e,n){return new Ai(t,e)},xi.prototype.remove=function(t,e){return this},xi.prototype._=function(){return!0},xi.prototype.ot=function(t){return!1},xi.prototype.ht=function(t){return!1},xi.prototype.it=function(){return null},xi.prototype.rt=function(){return null},xi.prototype.At=function(){return!1},xi.prototype.pt=function(){return!0},xi.prototype.bt=function(){return 0},new xi);var ki=(Ri.prototype.has=function(t){return null!==this.data.get(t)},Ri.prototype.first=function(){return this.data.it()},Ri.prototype.last=function(){return this.data.rt()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ri.prototype.indexOf=function(t){return this.data.indexOf(t)},Ri.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Ri.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Ri.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Ri.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Ri.prototype.at=function(){return new Oi(this.data.at())},Ri.prototype.ut=function(t){return new Oi(this.data.ut(t))},Ri.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Ri.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ri.prototype._=function(){return this.data._()},Ri.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ri.prototype.isEqual=function(t){if(!(t instanceof Ri))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Ri.prototype.$=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ri.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ri.prototype.copy=function(t){var e=new Ri(this.P);return e.data=t,e},Ri),Oi=(Li.prototype.dt=function(){return this.$t.dt().key},Li.prototype.wt=function(){return this.$t.wt()},Li),Pi=new Ti(Jr.P);function Li(t){this.$t=t}function Ri(t){this.P=t,this.data=new Ti(this.P)}var Ci=new Ti(Jr.P);var Vi=new Ti(Jr.P),Fi=new ki(Jr.P);function Ui(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Mi=new ki(kr);function ji(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function qi(t,e){this.targetId=t,this.ee=e}function Gi(t,e,n,r){void 0===n&&(n=di.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Bi=(no.kt=function(t){return new no(t.P)},no.prototype.has=function(t){return null!=this.Ft.get(t)},no.prototype.get=function(t){return this.Ft.get(t)},no.prototype.first=function(){return this.Nt.it()},no.prototype.last=function(){return this.Nt.rt()},no.prototype._=function(){return this.Nt._()},no.prototype.indexOf=function(t){var e=this.Ft.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(no.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),no.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},no.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ft.nt(t.key,t),e.Nt.nt(t,null))},no.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ft.remove(t),this.Nt.remove(e)):this},no.prototype.isEqual=function(t){if(!(t instanceof no))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},no.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},no.prototype.copy=function(t,e){var n=new no;return n.P=this.P,n.Ft=t,n.Nt=e,n},no),zi=(eo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Ar()},eo.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},eo),Wi=(to.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new to(t,e,Bi.kt(e),i,n,r,!0,!1)},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&yu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},to),Ki=($i.Gt=function(t,e){var n=new Map;return n.set(t,Hi.zt(t,e)),new $i(Kr.min(),n,Mi,Pi,Ui())},$i),Hi=(Zi.zt=function(t,e){return new Zi(di.Y,e,Ui(),Ui(),Ui())},Zi),Xi=(Object.defineProperty(Ji.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(Ji.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Ji.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},Ji.prototype.ce=function(){var n=Ui(),r=Ui(),i=Ui();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ar()}}),new Hi(this.ie,this.re,n,r,i)},Ji.prototype.le=function(){this.oe=!1,this.se=io()},Ji.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},Ji.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},Ji.prototype.de=function(){this.ne+=1},Ji.prototype.we=function(){--this.ne},Ji.prototype.Te=function(){this.oe=!0,this.re=!0},Ji),Qi=(Yi.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Zs?this.ge(r,t.te):t.te instanceof $s&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},Yi.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Ar()}})},Yi.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},Yi.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(pi(e=o.target)?0===i?(n=new Jr(e.path),this.Ve(r,n,new $s(n,Kr.min()))):_r(1===i):this.$e(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},Yi.prototype.Fe=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&pi(r.target)&&(n=new Jr(r.target.path),null!==o.me.get(n)||o.Ne(e,n)||o.Ve(e,n,new $s(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Ui();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Ki(i,s,this.Re,this.me,r);return this.me=Pi,this.Ae=ro(),this.Re=new ki(kr),t},Yi.prototype.ge=function(t,e){var n;this.ve(t)&&(n=this.Ne(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t)))},Yi.prototype.Ve=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},Yi.prototype.removeTarget=function(t){this.Ie.delete(t)},Yi.prototype.$e=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},Yi.prototype.de=function(t){this.be(t).de()},Yi.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new Xi,this.Ie.set(t,e)),e},Yi.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new ki(kr),this.Ae=this.Ae.nt(t,e)),e},Yi.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},Yi.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},Yi.prototype.Se=function(e){var n=this;this.Ie.set(e,new Xi),this.Ee.xe(e).forEach(function(t){n.Ve(e,t,null)})},Yi.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},Yi);function Yi(t){this.Ee=t,this.Ie=new Map,this.me=Pi,this.Ae=ro(),this.Re=new ki(kr)}function Ji(){this.ne=0,this.se=io(),this.ie=di.Y,this.re=!1,this.oe=!0}function Zi(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function $i(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function to(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function eo(){this.xt=new Ti(Jr.P)}function no(n){this.P=n?function(t,e){return n(t,e)||Jr.P(t.key,e.key)}:function(t,e){return Jr.P(t.key,e.key)},this.Ft=Ci,this.Nt=new Ti(this.P)}function ro(){return new Ti(Jr.P)}function io(){return new Ti(Jr.P)}function oo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function so(t){var e=yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Wr(e.seconds,e.nanos)}var uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oo(t)?4:10:Ar()}function ho(r,i){var t,e,n,o=ao(r);if(o!==ao(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return so(r).isEqual(so(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=yo(r.timestampValue),n=yo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,go(r.bytesValue).isEqual(go(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,vo((t=r).geoPointValue.latitude)===vo(e.geoPointValue.latitude)&&vo(t.geoPointValue.longitude)===vo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return vo(t.integerValue)===vo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=vo(t.doubleValue),r=vo(e.doubleValue);return n===r?ui(n)===ui(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Or(r.arrayValue.values||[],i.arrayValue.values||[],ho);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Vr(t)!==Vr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!ho(t[n],e[n])))return!1;return!0}();default:return Ar()}}function co(t,e){return void 0!==(t.values||[]).find(function(t){return ho(t,e)})}function lo(t,e){var n,r,i,o,s,u,a,h,c,l,f=ao(t),p=ao(e);if(f!==p)return kr(f,p);switch(f){case 0:return 0;case 1:return kr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=vo(t.integerValue||t.doubleValue))<(l=vo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return fo(t.timestampValue,e.timestampValue);case 4:return fo(so(t),so(e));case 5:return kr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=go(o),a=go(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=kr(n[i],r[i]);if(0!==o)return o}return kr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=kr(vo(n.latitude),vo(r.latitude)))?i:kr(vo(n.longitude),vo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=lo(n[i],r[i]);if(o)return o}return kr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=kr(r[s],o[s]);if(0!==u)return u;var a=lo(n[r[s]],i[o[s]]);if(0!==a)return a}return kr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ar()}}function fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return kr(t,e);var n=yo(t),r=yo(e),i=kr(n.seconds,r.seconds);return 0!==i?i:kr(n.nanos,r.nanos)}function po(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=yo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?go(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Jr.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Ar();var t,e,n}(t)}function yo(t){if(_r(!!t),"string"!=typeof t)return{seconds:vo(t.seconds),nanos:vo(t.nanos)};var e,n=0,r=uo.exec(t);_r(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function vo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function go(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function mo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function wo(t){return t&&"integerValue"in t}function bo(t){return!!t&&"arrayValue"in t}function Io(t){return t&&"nullValue"in t}function Eo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function To(t){return t&&"mapValue"in t}var No={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_o=function(t,e){this.s=t,this.Oe=e};function So(t){return{integerValue:""+t}}function Do(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function xo(t,e){return ai(e)?So(e):Do(t,e)}function ko(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Oo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Po(t){return _r(!!t),Kr.I((e=yo(t),new Wr(e.seconds,e.nanos)));var e}function Lo(t,e){return new Xr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function Ro(t){var e=Xr.N(t);return _r(Yo(e)),e}function Co(t,e){return Lo(t.s,e.path)}function Vo(t,e){var n=Ro(e);return _r(n.get(1)===t.s.projectId),_r(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new Jr(jo(n))}function Fo(t,e){return Lo(t.s,e)}function Uo(t){var e=Ro(t);return 4===e.length?Xr.k():jo(e)}function Mo(t){return new Xr(["projects",t.s.projectId,"databases",t.s.database]).F()}function jo(t){return _r(4<t.length&&"documents"===t.get(4)),t.V(5)}function qo(t,e,n){return{name:Co(t,e),fields:n.proto.mapValue.fields}}function Go(t,e){var n,r,i,o;if(e instanceof Ds)n={update:qo(t,e.key,e.value)};else if(e instanceof Ms)n={delete:Co(t,e.key)};else if(e instanceof xs)n={update:qo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof Rs)n={transform:{document:Co(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof es)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof ns)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof ls)return{fieldPath:t.field.F(),increment:e.qe};throw Ar()})}};else{if(!(e instanceof js))return Ar();n={verify:Co(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:ko(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Ar()),n}function Bo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?ws.updateTime(Po(n.updateTime)):void 0!==n.exists?ws.exists(n.exists):ws.We():ws.We();if(t.update){t.update.name;var o=Vo(e,t.update.name),s=new qs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new ys(r.map(function(t){return Yr.q(t)})));return new xs(o,s,u,i)}return new Ds(o,s,i)}if(t.delete){var a=Vo(e,t.delete);return new Ms(a,i)}if(t.transform){var h=Vo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(_r("REQUEST_TIME"===e.setToServerValue),i=new es):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new ns(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new us(r)):"increment"in e?i=new ls(t,e.increment):Ar();var o=Yr.q(e.fieldPath);return new vs(o,i)}(e,t)});return _r(!0===i.exists),new Rs(h,c)}if(t.verify){var l=Vo(e,t.verify);return new js(l,i)}return Ar()}function zo(t,e){return{documents:[Fo(t,e.path)]}}function Wo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Fo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof Iu?function(t){if("=="===t.op){if(Eo(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(Io(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,Ao[e]),value:t.value}};var e}(t):Ar()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo((e=t).field),direction:(n=e.dir,No[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||si(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ko(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ko(e.endAt)),n}function Ko(t){return{before:t.before,values:t.position}}function Ho(t){var e=!!t.before,n=t.values||[];return new Lu(n,e)}function Xo(t){return{fieldPath:t.F()}}function Qo(t){return Yr.q(t.fieldPath)}function Yo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Jo(){this.Qe=void 0}function Zo(t,e){return t instanceof ls?wo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var $o,ts,es=(n(is,ts=Jo),is),ns=(n(rs,$o=Jo),rs);function rs(t){var e=this;return(e=$o.call(this)||this).elements=t,e}function is(){return null!==ts&&ts.apply(this,arguments)||this}function os(t,e){for(var n=ds(e),r=function(e){n.some(function(t){return ho(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ss,us=(n(as,ss=Jo),as);function as(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function hs(t,e){for(var n=ds(e),r=function(e){n=n.filter(function(t){return!ho(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var cs,ls=(n(fs,cs=Jo),fs);function fs(t,e){var n=this;return(n=cs.call(this)||this).serializer=t,n.qe=e,n}function ps(t){return vo(t.integerValue||t.doubleValue)}function ds(t){return bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ys=(gs.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},gs.prototype.isEqual=function(t){return Or(this.fields,t.fields,function(t,e){return t.isEqual(e)})},gs),vs=function(t,e){this.field=t,this.transform=e};function gs(t){(this.fields=t).sort(Yr.P)}function ms(t,e){this.version=t,this.transformResults=e}var ws=(bs.We=function(){return new bs},bs.exists=function(t){return new bs(void 0,t)},bs.updateTime=function(t){return new bs(t)},Object.defineProperty(bs.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},bs);function bs(t,e){this.updateTime=t,this.exists=e}function Is(t,e){return void 0!==t.updateTime?e instanceof Zs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Zs}function Es(){}function Ts(t,e,n,r){return t instanceof Ds?function(t,e){if(!Is(t.Ue,e))return e;var n=As(e);return new Zs(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof xs?function(t,e){if(!Is(t.Ue,e))return e;var n=As(e),r=Ps(t,e);return new Zs(t.key,n,r,{Ke:!0})}(t,e):t instanceof Rs?function(t,e,n,r){if(!Is(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Zs&&(y=n.field(p.field)),null===y&&r instanceof Zs&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof es?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof ns?os(i,o):i instanceof us?hs(i,o):(a=ps(u=Zo(s=i,o))+ps(s.qe),wo(u)&&wo(s.qe)?So(a):Do(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Vs(t,i.data(),o);return new Zs(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Is((i=t).Ue,o)?new $s(i.key,Kr.min()):o);var i,o}function Ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Or(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ns&&o instanceof ns||i instanceof us&&o instanceof us?Or(i.elements,o.elements,ho):i instanceof ls&&o instanceof ls?ho(i.qe,o.qe):i instanceof es&&o instanceof es);var n,r,i,o}))}function As(t){return t instanceof Zs?t.version:Kr.min()}var _s,Ss,Ds=(n(Os,Ss=Es),Os),xs=(n(ks,_s=Es),ks);function ks(t,e,n,r){var i=this;return(i=_s.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Os(t,e,n){var r=this;return(r=Ss.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Ps(t,e){return n=t,r=e instanceof Zs?e.data():qs.empty(),i=new Gs(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var Ls,Rs=(n(Cs,Ls=Es),Cs);function Cs(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=ws.exists(!0),n}function Vs(t,e,n){for(var r=new Gs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Fs,Us,Ms=(n(Ks,Us=Es),Ks),js=(n(Ws,Fs=Es),Ws),qs=(zs.empty=function(){return new zs({mapValue:{}})},zs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!To(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},zs.prototype.isEqual=function(t){return ho(this.proto,t.proto)},zs),Gs=(Bs.prototype.set=function(t,e){return this.Ye(t,e),this},Bs.prototype.delete=function(t){return this.Ye(t,null),this},Bs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ao(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Bs.prototype.Ge=function(){var t=this.Je(Yr.k(),this.He);return null!=t?new qs(t):this.ze},Bs.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=To(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Bs);function Bs(t){void 0===t&&(t=qs.empty()),this.ze=t,this.He=new Map}function zs(t){this.proto=t}function Ws(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Ks(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Hs(t){var u=[];return Fr(t.fields||{},function(t,e){var n=new Yr([t]);if(To(e)){var r=Hs(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new ys(u)}function Xs(t,e){this.key=t,this.version=e}var Qs,Ys,Js,Zs=(n(ru,Js=Xs),ru.prototype.field=function(t){return this.Xe.field(t)},ru.prototype.data=function(){return this.Xe},ru.prototype.Ze=function(){return this.Xe.proto},ru.prototype.isEqual=function(t){return t instanceof ru&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},ru.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ru.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ru),$s=(n(nu,Ys=Xs),nu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),tu=(n(eu,Qs=Xs),eu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),eu.prototype.isEqual=function(t){return t instanceof eu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},eu);function eu(){return null!==Qs&&Qs.apply(this,arguments)||this}function nu(t,e,n){var r=this;return(r=Ys.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ru(t,e,n,r){var i=this;return(i=Js.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function iu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new zr(Br.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new zr(Br.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ou=(su.prototype.rn=function(t){return new su(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},su.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},su.prototype.hn=function(){return!si(this.limit)&&"F"===this.en},su.prototype.an=function(){return!si(this.limit)&&"L"===this.en},su.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},su.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},su.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},su);function su(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function uu(t,e,n,r,i,o,s,u){return new ou(t,e,n,r,i,o,s,u)}function au(t){return new ou(t)}function hu(t){return null!==t.collectionGroup}function cu(t){var e=iu(t,ou);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Gu(n)),e.nn.push(new Gu(Yr.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Gu(Yr.L(),i)))}}return e.nn}function lu(t){var e=iu(t,ou);if(!e.sn)if("F"===e.en)e.sn=ci(e.path,e.collectionGroup,cu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=cu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Gu(o.field,s))}var u=e.endAt?new Lu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Lu(e.startAt.position,!e.startAt.before):null;e.sn=ci(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function fu(t,e,n){return new ou(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pu(t,e){return new ou(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function du(t,e){return new ou(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function yu(t,e){return fi(lu(t),lu(e))&&t.en===e.en}function vu(t){return li(lu(t))+"|lt:"+t.en}function gu(t){return"Query(target="+(n=(e=lu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+po(e.value);var e}).join(", ")+"]"),si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Mu(e.startAt)),e.endAt&&(n+=", endAt: "+Mu(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function mu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):Jr.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||ju(e.startAt,cu(e),n))&&(!e.endAt||!ju(e.endAt,cu(e),n)));var e,n,r,o}function wu(u){return function(t,e){for(var n=!1,r=0,i=cu(u);r<i.length;r++){var o=i[r],s=Bu(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var bu,Iu=(n(Eu,bu=function(){}),Eu.create=function(t,e,n){if(t.O())return"in"===e?new xu(t,n):new Du(t,e,n);if(Io(n)){if("=="!==e)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Eu(t,e,n)}if(Eo(n)){if("=="!==e)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Eu(t,e,n)}return"array-contains"===e?new ku(t,n):"in"===e?new Ou(t,n):"array-contains-any"===e?new Pu(t,n):new Eu(t,e,n)},Eu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ao(this.value)===ao(e)&&this.fn(lo(e,this.value))},Eu.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Ar()}},Eu.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Eu);function Eu(t,e,n){var r=this;return(r=bu.call(this)||this).field=t,r.op=e,r.value=n,r}var Tu,Nu,Au,_u,Su,Du=(n(Uu,Su=Iu),Uu.prototype.matches=function(t){var e=Jr.P(t.key,this.key);return this.fn(e)},Uu),xu=(n(Fu,_u=Iu),Fu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Fu),ku=(n(Vu,Au=Iu),Vu.prototype.matches=function(t){var e=t.field(this.field);return bo(e)&&co(e.arrayValue,this.value)},Vu),Ou=(n(Cu,Nu=Iu),Cu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&co(this.value.arrayValue,e)},Cu),Pu=(n(Ru,Tu=Iu),Ru.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!bo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return co(e.value.arrayValue,t)})},Ru),Lu=function(t,e){this.position=t,this.before=e};function Ru(t,e){return Tu.call(this,t,"array-contains-any",e)||this}function Cu(t,e){return Nu.call(this,t,"in",e)||this}function Vu(t,e){return Au.call(this,t,"array-contains",e)||this}function Fu(t,e){var n=this;return(n=_u.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Jr.B(t.referenceValue)}),n}function Uu(t,e,n){var r=this;return(r=Su.call(this,t,e,n)||this).key=Jr.B(n.referenceValue),r}function Mu(t){return(t.before?"b":"a")+":"+t.position.map(po).join(",")}function ju(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?Jr.P(Jr.B(s.referenceValue),n.key):lo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function qu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ho(t.position[n],e.position[n]))return!1;return!0}var Gu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Bu(t,e,n){var r,i,o,s,u=t.field.O()?Jr.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?lo(o,s):Ar());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Ar()}}var zu=(sa.prototype.wn=function(t,e,n){for(var r,i,o,s=n.Tn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Ds?new Zs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof xs?function(t,e,n){if(!Is(t.Ue,e))return new tu(t.key,n.version);var r=Ps(t,e);return new Zs(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Rs?function(t,e,n){if(_r(null!=n.transformResults),!Is(t.Ue,e))return new tu(t.key,n.version);var r=e,i=function(t,e,n){var r,i,o,s=[];_r(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Zs&&(c=e.field(a.field)),s.push((r=h,i=c,o=n[u],r instanceof ns?os(r,i):r instanceof us?hs(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Vs(t,r.data(),i);return new Zs(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new $s(r.key,o.version,{hasCommittedMutations:!0}))}return e},sa.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ts(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.dn))}return e},sa.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},sa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ui())},sa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Or(this.mutations,t.mutations,Ns)&&Or(this.baseMutations,t.baseMutations,Ns)},sa),Wu=(oa.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=Vi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new oa(t,e,n,r)},oa),Ku=(ia.prototype.catch=function(t){return this.next(void 0,t)},ia.prototype.next=function(r,i){var o=this;return this.Vn&&Ar(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new ia(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},ia.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ia.prototype.vn=function(t){try{var e=t();return e instanceof ia?e:ia.resolve(e)}catch(t){return ia.reject(t)}},ia.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):ia.resolve(e)},ia.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):ia.reject(e)},ia.resolve=function(n){return new ia(function(t,e){t(n)})},ia.reject=function(n){return new ia(function(t,e){e(n)})},ia.Sn=function(t){return new ia(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ia.Dn=function(t){for(var n=ia.resolve(!1),e=function(e){n=n.next(function(t){return t?ia.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},ia.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},ia),Hu=(Object.defineProperty(ra.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!1,configurable:!0}),ra.prototype.Nn=function(t,e){this.kn(),this.readTime=e,this.Cn.set(t.key,t)},ra.prototype.xn=function(t,e){this.kn(),e&&(this.readTime=e),this.Cn.set(t,null)},ra.prototype.Mn=function(t,e){this.kn();var n=this.Cn.get(e);return void 0!==n?Ku.resolve(n):this.On(t,e)},ra.prototype.getEntries=function(t,e){return this.Ln(t,e)},ra.prototype.apply=function(t){return this.kn(),this.$n=!0,this.qn(t)},ra.prototype.kn=function(){},ra),Xu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Qu=(na.prototype.Un=function(t){this.Bn.push(t)},na.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},na),Yu=(ea.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},ea.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},ea.prototype.Yn=function(t,e,i){var o=Pi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},ea.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},ea.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=Pi;return e.forEach(function(t,e){e=e||new $s(t,Kr.min()),n=n.nt(t,e)}),n})},ea.prototype.ts=function(t,e,n){return r=e,Jr.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):hu(e)?this.ns(t,e,n):this.ss(t,e,n);var r},ea.prototype.es=function(t,e){return this.Gn(t,new Jr(e)).next(function(t){var e=Ci;return t instanceof Zs&&(e=e.nt(t.key,t)),e})},ea.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=Ci;return this.Kn.rs(n,s).next(function(t){return Ku.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},ea.prototype.ss=function(e,n,t){var c,l,r=this;return this.Qn.ts(e,n,t).next(function(t){return c=t,r.jn.os(e,n)}).next(function(t){return l=t,r.hs(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Ts(s,a,a,r.dn);c=h instanceof Zs?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){mu(n,e)||(c=c.remove(t))}),c})},ea.prototype.hs=function(t,e,n){for(var r=Ui(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof xs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Zs&&(h=h.nt(t,e))}),h})},ea),Ju=(ta.cs=function(t,e){for(var n=Ui(),r=Ui(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ta(t,e.fromCache,n,r)},ta),Zu=($u.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},$u.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},$u);function $u(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function ta(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function ea(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function na(){this.Bn=[]}function ra(){this.Cn=new Gr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.$n=!1}function ia(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function oa(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function sa(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}function ua(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Zu.ws=-1;var aa=(ha.prototype.reset=function(){this.Rs=0},ha.prototype.Vs=function(){this.Rs=this.As},ha.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},ha.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},ha.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},ha.prototype.ps=function(){return(Math.random()-.5)*this.Rs},ha);function ha(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function ca(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=fa(e)),e=la(t.get(n),e);return fa(e)}function la(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function fa(t){return t+""}function pa(t){var e=t.length;if(_r(2<=e),2===e)return _r(""===t.charAt(0)&&""===t.charAt(1)),Xr.k();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Ar(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ar()}o=s+2}return new Xr(r)}var da=(wa.prototype.Cs=function(t,e){return this.Ds.add(e),Ku.resolve()},wa.prototype.rs=function(t,e){return Ku.resolve(this.Ds.getEntries(e))},wa),ya=(ma.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new ki(Xr.P),i=!r.has(n);return this.index[e]=r.add(n),i},ma.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},ma.prototype.getEntries=function(t){return(this.index[t]||new ki(Xr.P)).$()},ma),va=(ga.prototype.Cs=function(t,e){var n=this;if(this.$s.has(e))return Ku.resolve();var r=e.S(),i=e.p();t.Un(function(){n.$s.add(e)});var o={collectionId:r,parent:ca(i)};return ba(t).put(o)},ga.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Pr(i),""],!1,!0);return ba(t).Fs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(pa(r.parent))}return o})},ga);function ga(){this.$s=new ya}function ma(){this.index={}}function wa(){this.Ds=new ya}function ba(t){return Qa.Ns(t,Sh.store)}function Ia(t){this.ks=t}function Ea(t,e){if(e.document)return n=t.ks,r=e.document,i=!!e.hasCommittedMutations,o=Vo(n,r.name),s=Po(r.updateTime),u=new qs({mapValue:{fields:r.fields}}),new Zs(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=Jr.j(e.noDocument.path),h=Sa(e.noDocument.readTime);return new $s(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=Jr.j(e.unknownDocument.path),l=Sa(e.unknownDocument.version);return new tu(c,l)}return Ar()}function Ta(t,e,n){var r,i,o=Na(n),s=e.key.path.p().$();if(e instanceof Zs){var u={name:Co(r=t.ks,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:ko(r,i.version.A())},a=e.hasCommittedMutations;return new Eh(null,null,u,a,o,s)}if(e instanceof $s){var h=e.key.path.$(),c=_a(e.version),l=e.hasCommittedMutations;return new Eh(null,new bh(h,c),null,l,o,s)}if(e instanceof tu){var f=e.key.path.$(),p=_a(e.version);return new Eh(new Ih(f,p),null,null,!0,o,s)}return Ar()}function Na(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Aa(t){var e=new Wr(t[0],t[1]);return Kr.I(e)}function _a(t){var e=t.A();return new ph(e.seconds,e.nanoseconds)}function Sa(t){var e=new Wr(t.seconds,t.nanoseconds);return Kr.I(e)}function Da(e,t){var n=(t.baseMutations||[]).map(function(t){return Bo(e.ks,t)}),r=t.mutations.map(function(t){return Bo(e.ks,t)}),i=Wr.fromMillis(t.localWriteTimeMs);return new zu(t.batchId,i,n,r)}function xa(t){var e,n=Sa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Sa(t.lastLimboFreeSnapshotVersion):Kr.min(),i=void 0!==t.query.documents?(_r(1===(e=t.query).documents.length),lu(au(Uo(e.documents[0])))):function(t){var e,n=Uo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(_r(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qo(t.unaryFilter.field);return Iu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qo(t.unaryFilter.field);return Iu.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ar()}}(e)]:void 0!==e.fieldFilter?[(n=e,Iu.create(Qo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ar()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Ar():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Gu(Qo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=si(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var l=null;r.startAt&&(l=Ho(r.startAt));var f=null;return r.endAt&&(f=Ho(r.endAt)),lu(uu(n,o,u,s,c,"F",l,f))}(t.query);return new wi(i,t.targetId,0,t.lastListenSequenceNumber,n,r,di.fromBase64String(t.resumeToken))}function ka(t,e){var n=_a(e.X),r=_a(e.lastLimboFreeSnapshotVersion),i=(pi(e.target)?zo:Wo)(t.ks,e.target),o=e.resumeToken.toBase64();return new Nh(e.targetId,li(e.target),n,o,e.sequenceNumber,r,i)}var Oa,Pa=(La.prototype.Nn=function(t,e,n){return Ca(t).put(Va(e),n)},La.prototype.xn=function(t,e){var n=Ca(t),r=Va(e);return n.delete(r)},La.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.xs(e,t)})},La.prototype.Mn=function(t,e){var n=this;return Ca(t).get(Va(e)).next(function(t){return n.Ms(t)})},La.prototype.Os=function(t,e){var n=this;return Ca(t).get(Va(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:Fa(t)}:null})},La.prototype.getEntries=function(t,e){var r=this,i=Pi;return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},La.prototype.Bs=function(t,e){var r=this,i=Pi,o=new Ti(Jr.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,Fa(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},La.prototype.qs=function(t,e,i){if(e._())return Ku.resolve();var n=IDBKeyRange.bound(e.first().path.$(),e.last().path.$()),o=e.at(),s=o.dt();return Ca(t).Qs({range:n},function(t,e,n){for(var r=Jr.j(t);s&&Jr.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.$()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},La.prototype.ts=function(t,i,e){var n,r,o,s=this,u=Ci,a=i.path.length+1,h={};return e.isEqual(Kr.min())?(n=i.path.$(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.$(),o=Na(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Eh.collectionReadTimeIndex),Ca(t).Qs(h,function(t,e,n){var r;t.length===a&&(r=Ea(s.serializer,e),i.path.D(r.key.path)?r instanceof Zs&&mu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},La.prototype.Ks=function(t,e){var r=this,i=Pi,o=Na(e),n=Ca(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:Eh.readTimeIndex,range:s},function(t,e){var n=Ea(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:Aa(o)}})},La.prototype.zs=function(t){var e=Ca(t),r=Kr.min();return e.Qs({index:Eh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Aa(e.readTime)),n.done()}).next(function(){return r})},La.prototype.Hs=function(t){return new La.Ys(this,!!t&&t.Js)},La.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},La.prototype.getMetadata=function(t){return Ra(t).get(Th.key).next(function(t){return _r(!!t),t})},La.prototype.xs=function(t,e){return Ra(t).put(Th.key,e)},La.prototype.Ms=function(t){if(t){var e=Ea(this.serializer,t);return e instanceof $s&&e.version.isEqual(Kr.min())?null:e}return null},La);function La(t,e){this.serializer=t,this.Kn=e}function Ra(t){return Qa.Ns(t,Th.store)}function Ca(t){return Qa.Ns(t,Eh.store)}function Va(t){return t.path.$()}function Fa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ar();e=t.noDocument}return JSON.stringify(e).length}function Ua(t,e){var n=this;return(n=Oa.call(this)||this).Zs=t,n.Js=e,n.ti=new Gr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Pa.Ys=(n(Ua,Oa=Hu),Ua.prototype.qn=function(s){var u=this,a=[],h=0,c=new ki(function(t,e){return kr(t.F(),e.F())});return this.Cn.forEach(function(t,e){var n,r,i,o=u.ti.get(t);e?(n=Ta(u.Zs.serializer,e,u.readTime),c=c.add(t.path.p()),r=Fa(n),h+=r-o,a.push(u.Zs.Nn(s,t,n))):(h-=o,u.Js?(i=Ta(u.Zs.serializer,new $s(t,Kr.min()),u.readTime),a.push(u.Zs.Nn(s,t,i))):a.push(u.Zs.xn(s,t)))}),c.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,h)),Ku.Sn(a)},Ua.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},Ua.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},Ua);var Ma=(Ga.prototype.next=function(){return this.ei+=2,this.ei},Ga.ni=function(){return new Ga(0)},Ga.si=function(){return new Ga(-1)},Ga),ja=(qa.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new Ma(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},qa.prototype.ai=function(t){return this.oi(t).next(function(t){return Kr.I(new Wr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},qa.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},qa.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},qa.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},qa.prototype.di=function(t,e){return this._i(t,e)},qa.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Ba(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return _r(0<t.targetCount),--t.targetCount,n.hi(e,t)})},qa.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Ba(r).Qs(function(t,e){var n=xa(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return Ku.Sn(a)}).next(function(){return u})},qa.prototype.pe=function(t,r){return Ba(t).Qs(function(t,e){var n=xa(e);r(n)})},qa.prototype.oi=function(t){return za(t).get(_h.key).next(function(t){return _r(null!==t),t})},qa.prototype.hi=function(t,e){return za(t).put(_h.key,e)},qa.prototype._i=function(t,e){return Ba(t).put(ka(this.serializer,e))},qa.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},qa.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},qa.prototype.mi=function(t,i){var e=li(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Ba(t).Qs({range:n,index:Nh.queryTargetsIndexName},function(t,e,n){var r=xa(e);fi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},qa.prototype.Ai=function(n,t,r){var i=this,o=[],s=Wa(n);return t.forEach(function(t){var e=ca(t.path);o.push(s.put(new Ah(r,e))),o.push(i.ii.Ri(n,r,t))}),Ku.Sn(o)},qa.prototype.Pi=function(n,t,r){var i=this,o=Wa(n);return Ku.forEach(t,function(t){var e=ca(t.path);return Ku.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},qa.prototype.Ti=function(t,e){var n=Wa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},qa.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Wa(t),o=Ui();return r.Qs({range:n,yi:!0},function(t,e,n){var r=pa(t[1]),i=new Jr(r);o=o.add(i)}).next(function(){return o})},qa.prototype.pi=function(t,e){var n=ca(e.path),r=IDBKeyRange.bound([n],[Pr(n)],!1,!0),i=0;return Wa(t).Qs({index:Ah.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},qa.prototype.Me=function(t,e){return Ba(t).get(e).next(function(t){return t?xa(t):null})},qa);function qa(t,e){this.ii=t,this.serializer=e}function Ga(t){this.ei=t}function Ba(t){return Qa.Ns(t,Nh.store)}function za(t){return Qa.Ns(t,_h.store)}function Wa(t){return Qa.Ns(t,Ah.store)}var Ka,Ha="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Xa=(n(Ja,Ka=Qu),Ja),Qa=(Ya.Ns=function(t,e){if(t instanceof Xa)return Ph.Ns(t.bi,e);throw Ar()},Ya.prototype.start=function(){var e=this;return Ph.Ui(this.Li,lh,new fh(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new zr(Br.FAILED_PRECONDITION,Ha);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new Zu(t,e.Si)}).then(function(){e.$i=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},Ya.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},Ya.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ya.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ya.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return $a(e).put(new xh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(Uh(t))return Er("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Er("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},Ya.prototype.tr=function(t){var e=this;return Za(t).get(dh.key).next(function(t){return Ku.resolve(e.rr(t))})},Ya.prototype.or=function(t){return $a(t).delete(this.clientId)},Ya.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.xi,18e5)?[3,2]:(this.xi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ya.Ns(t,xh.store);return r.Fs().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ku.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},Ya.prototype.Gi=function(){var t=this;this.ki=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},Ya.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},Ya.prototype.nr=function(e){var i=this;return this.Di?Ku.resolve(!0):Za(e).get(dh.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new zr(Br.FAILED_PRECONDITION,Ha);return!1}}return!(!i.networkEnabled||!i.inForeground)||$a(e).Fs().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Er("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ya.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.$i=!1,this.dr(),this.ki&&(this.ki.cancel(),this.ki=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){Er("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},Ya.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},Ya.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return $a(t).Fs().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ya.prototype,"Hi",{get:function(){return this.$i},enumerable:!1,configurable:!0}),Ya.prototype.mr=function(t){return ih.Ar(t,this.serializer,this.Kn,this.ii)},Ya.prototype.Rr=function(){return this.qi},Ya.prototype.Pr=function(){return this.Qn},Ya.prototype.gr=function(){return this.Kn},Ya.prototype.runTransaction=function(e,n,r){var i=this;Er("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Oh,function(t){return o=new Xa(t,i.Ci?i.Ci.next():Zu.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw Tr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new zr(Br.FAILED_PRECONDITION,Xu);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},Ya.prototype.Vr=function(t){var e=this;return Za(t).get(dh.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new zr(Br.FAILED_PRECONDITION,Ha)})},Ya.prototype.ir=function(t){var e=new dh(this.clientId,this.allowTabSynchronization,Date.now());return Za(t).put(dh.key,e)},Ya.Oi=function(){return Ph.Oi()},Ya.prototype.sr=function(t){var e=this,n=Za(t);return n.get(dh.key).next(function(t){return e.rr(t)?(Er("IndexedDbPersistence","Releasing primary lease."),n.delete(dh.key)):Ku.resolve()})},Ya.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Tr("Detected an update time that is in the future: "+t+" > "+n),1))},Ya.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)},Ya.prototype.wr=function(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)},Ya.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fi=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.Fi))},Ya.prototype.Tr=function(){this.Fi&&(this.window.removeEventListener("unload",this.Fi),this.Fi=null)},Ya.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return Er("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ya.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}},Ya.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},Ya.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ya);function Ya(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=h,this.Ci=null,this.$i=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fi=null,this.inForeground=!1,this.Ni=null,this.ki=null,this.xi=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!Ya.Oi())throw new zr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new th(this,r),this.Li=e+"main",this.serializer=new Ia(u),this.qi=new ja(this.ii,this.serializer),this.Kn=new va,this.Qn=new Pa(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Ja(t,e){var n=this;return(n=Ka.call(this)||this).bi=t,n.vi=e,n}function Za(t){return Qa.Ns(t,dh.store)}function $a(t){return Qa.Ns(t,xh.store)}var th=(eh.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},eh.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},eh.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},eh.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},eh.prototype.Ri=function(t,e,n){return nh(t,n)},eh.prototype.gi=function(t,e,n){return nh(t,n)},eh.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},eh.prototype.Dr=nh,eh.prototype.Cr=function(t,e){return r=e,i=!1,ch(n=t).$r(function(t){return sh(n,t,r).next(function(t){return t&&(i=!0),Ku.resolve(!t)})}).next(function(){return i});var n,r,i},eh.prototype.Fr=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){var n;t<=i&&(n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.xn(e),Wa(r).delete([0,ca(e.path)])})}),u.push(n))}).next(function(){return Ku.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},eh.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},eh.prototype.Nr=nh,eh.prototype.Sr=function(t,o){var s,e=Wa(t),u=Zu.ws;return e.Qs({index:Ah.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==Zu.ws&&o(new Jr(pa(s)),u),u=i,s=r):u=Zu.ws}).next(function(){u!==Zu.ws&&o(new Jr(pa(s)),u)})},eh.prototype.kr=function(t){return this.db.Pr().Xs(t)},eh);function eh(t,e){this.db=t,this.yr=new oc(this,e)}function nh(t,e){return Wa(t).put((n=t.vi,new Ah(0,ca(e.path),n)));var n}function rh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ih=(oh.Ar=function(t,e,n,r){return _r(""!==t.uid),new oh(t.Mr()?t.uid:"",e,n,r)},oh.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).Qs({index:gh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},oh.prototype.Lr=function(d,y,v,g){var m=this,w=hh(d),b=ah(d);return b.add({}).next(function(t){_r("number"==typeof t);for(var e,n,r,i,o,s=new zu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Go(e.ks,t)}),o=r.mutations.map(function(t){return Go(e.ks,t)}),new gh(n,r.batchId,r.dn.toMillis(),i,o)),a=[],h=new ki(function(t,e){return kr(t.F(),e.F())}),c=0,l=g;c<l.length;c++){var f=l[c],p=mh.key(m.userId,f.key.path,t),h=h.add(f.key.path.p());a.push(b.put(u)),a.push(w.put(p,mh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Kn.Cs(d,t))}),d.Un(function(){m.xr[t]=s.keys()}),Ku.Sn(a).next(function(){return s})})},oh.prototype.qr=function(t,e){var n=this;return ah(t).get(e).next(function(t){return t?(_r(t.userId===n.userId),Da(n.serializer,t)):null})},oh.prototype.Br=function(t,n){var r=this;return this.xr[n]?Ku.resolve(this.xr[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.xr[n]=e}return null})},oh.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return ah(t).Qs({index:gh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(_r(e.batchId>=i),o=Da(r.serializer,e)),n.done()}).next(function(){return o})},oh.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ah(t).Qs({index:gh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},oh.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ah(t).Fs(gh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Da(e.serializer,t)})})},oh.prototype.zn=function(u,a){var h=this,t=mh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return hh(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=pa(i);if(r===h.userId&&a.path.isEqual(s))return ah(u).get(o).next(function(t){if(!t)throw Ar();_r(t.userId===h.userId),c.push(Da(h.serializer,t))});n.done()}).next(function(){return c})},oh.prototype.Zn=function(r,t){var a=this,h=new ki(kr),i=[];return t.forEach(function(u){var t=mh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=hh(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=pa(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Ku.Sn(i).next(function(){return a.jr(r,h)})},oh.prototype.os=function(t,e){var u=this,a=e.path,h=a.length+1,n=mh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new ki(kr);return hh(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=pa(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.jr(t,c)})},oh.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(ah(e).get(t).next(function(t){if(null===t)throw Ar();_r(t.userId===n.userId),r.push(Da(n.serializer,t))}))}),Ku.Sn(i).next(function(){return r})},oh.prototype.Kr=function(e,n){var r=this;return uh(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),Ku.forEach(t,function(t){return r.ii.Dr(e,t)})})},oh.prototype.Gr=function(t){delete this.xr[t]},oh.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return Ku.resolve();var e=IDBKeyRange.lowerBound(mh.prefixForUser(o.userId)),i=[];return hh(n).Qs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=pa(t[1]),i.push(r)):n.done()}).next(function(){_r(0===i.length)})})},oh.prototype.pi=function(t,e){return sh(t,this.userId,e)},oh.prototype.Hr=function(t){var e=this;return ch(t).get(this.userId).next(function(t){return t||new vh(e.userId,-1,"")})},oh);function oh(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.xr={}}function sh(t,o,e){var n=mh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return hh(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function uh(t,e,n){var r=t.store(gh.store),i=t.store(mh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){_r(1===u)}));for(var h=[],c=0,l=n.mutations;c<l.length;c++){var f=l[c],p=mh.key(e,f.key.path,n.batchId);o.push(i.delete(p)),h.push(f.key)}return Ku.Sn(o).next(function(){return h})}function ah(t){return Qa.Ns(t,gh.store)}function hh(t){return Qa.Ns(t,mh.store)}function ch(t){return Qa.Ns(t,vh.store)}var lh=10,fh=(yh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;_r(t<e&&0<=t&&e<=lh);var o,s=new Mh(r);t<1&&1<=e&&(n.createObjectStore(dh.store),(o=n).createObjectStore(vh.store,{keyPath:vh.keyPath}),o.createObjectStore(gh.store,{keyPath:gh.keyPath,autoIncrement:!0}).createIndex(gh.userMutationsIndex,gh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(mh.store),Dh(n),n.createObjectStore(Eh.store));var u,a=Ku.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Ah.store),u.deleteObjectStore(Nh.store),u.deleteObjectStore(_h.store),Dh(n)),a=a.next(function(){return t=s.store(_h.store),e=new _h(0,0,Kr.min().A(),0),t.put(_h.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(gh.store).Fs().next(function(t){r.deleteObjectStore(gh.store),r.createObjectStore(gh.store,{keyPath:gh.keyPath,autoIncrement:!0}).createIndex(gh.userMutationsIndex,gh.userMutationsKeyPath,{unique:!0});var e=i.store(gh.store),n=t.map(function(t){return e.put(t)});return Ku.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(xh.store,{keyPath:xh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Th.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Eh.store)).createIndex(Eh.readTimeIndex,Eh.readTimeIndexPath,{unique:!1}),t.createIndex(Eh.collectionReadTimeIndex,Eh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},yh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Eh.store).Qs(function(t,e){n+=Fa(e)}).next(function(){var t=new Th(n);return e.store(Th.store).put(Th.key,t)})},yh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(vh.store),e=r.store(gh.store);return t.Fs().next(function(t){return Ku.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Fs(gh.userMutationsIndex,t).next(function(t){return Ku.forEach(t,function(t){_r(t.userId===n.userId);var e=Da(i.serializer,t);return uh(r,n.userId,e).next(function(){})})})})})},yh.prototype.ensureSequenceNumbers=function(t){var s=t.store(Ah.store),e=t.store(Eh.store);return t.store(_h.store).get(_h.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new Xr(t),r=[0,ca(n)];o.push(s.get(r).next(function(t){return t?Ku.resolve():s.put(new Ah(0,ca(n),i.highestListenSequenceNumber))}))}).next(function(){return Ku.Sn(o)})})},yh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:ca(n)})}}t.createObjectStore(Sh.store,{keyPath:Sh.keyPath});var i=e.store(Sh.store),o=new ya;return e.store(Eh.store).Qs({yi:!0},function(t,e){return r(new Xr(t).p())}).next(function(){return e.store(mh.store).Qs({yi:!0},function(t,e){t[0];var n=t[1];return r((t[2],pa(n)).p())})})},yh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Nh.store);return o.Qs(function(t,e){var n=xa(e),r=ka(i.serializer,n);return o.put(r)})},yh),ph=function(t,e){this.seconds=t,this.nanoseconds=e},dh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function yh(t){this.serializer=t}dh.store="owner",dh.key="owner";var vh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};vh.store="mutationQueues",vh.keyPath="userId";var gh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};gh.store="mutations",gh.keyPath="batchId",gh.userMutationsIndex="userMutationsIndex",gh.userMutationsKeyPath=["userId","batchId"];var mh=(wh.prefixForUser=function(t){return[t]},wh.prefixForPath=function(t,e){return[t,ca(e)]},wh.key=function(t,e,n){return[t,ca(e),n]},wh);function wh(){}mh.store="documentMutations",mh.PLACEHOLDER=new mh;var bh=function(t,e){this.path=t,this.readTime=e},Ih=function(t,e){this.path=t,this.version=e},Eh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Eh.store="remoteDocuments",Eh.readTimeIndex="readTimeIndex",Eh.readTimeIndexPath="readTime",Eh.collectionReadTimeIndex="collectionReadTimeIndex",Eh.collectionReadTimeIndexPath=["parentPath","readTime"];var Th=function(t){this.byteSize=t};Th.store="remoteDocumentGlobal",Th.key="remoteDocumentGlobalKey";var Nh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Nh.store="targets",Nh.keyPath="targetId",Nh.queryTargetsIndexName="queryTargetsIndex",Nh.queryTargetsKeyPath=["canonicalId","targetId"];var Ah=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ah.store="targetDocuments",Ah.keyPath=["targetId","path"],Ah.documentTargetsIndex="documentTargetsIndex",Ah.documentTargetsKeyPath=["path","targetId"];var _h=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};_h.key="targetGlobalKey",_h.store="targetGlobal";var Sh=function(t,e){this.collectionId=t,this.parent=e};function Dh(t){t.createObjectStore(Ah.store,{keyPath:Ah.keyPath}).createIndex(Ah.documentTargetsIndex,Ah.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Nh.store,{keyPath:Nh.keyPath}).createIndex(Nh.queryTargetsIndexName,Nh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_h.store)}Sh.store="collectionParents",Sh.keyPath=["collectionId","parent"];var xh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};xh.store="clientMetadata",xh.keyPath="clientId";var kh,Oh=d(d(d([vh.store,gh.store,mh.store,Eh.store,Nh.store,dh.store,_h.store,Ah.store],[xh.store]),[Th.store]),[Sh.store]),Ph=(Fh.Ui=function(o,t,s){return Er("SimpleDb","Opening database:",o),new Ku(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Fh(e))},i.onblocked=function(){r(new zr(Br.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new zr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Er("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,lh).next(function(){Er("SimpleDb","Database upgrade to version "+lh+" complete")})}}).bn()},Fh.delete=function(t){return Er("SimpleDb","Removing database:",t),Bh(window.indexedDB.deleteDatabase(t)).bn()},Fh.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(Fh.Jr())return!0;var t=y(),e=Fh.Yr(t),n=0<e&&e<10,r=Fh.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Fh.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},Fh.Ns=function(t,e){return t.store(e)},Fh.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Fh.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Fh.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},Fh.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=Mh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Ku.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Er("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Fh.prototype.close=function(){this.db.close()},Fh),Lh=(Object.defineProperty(Vh.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(Vh.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(Vh.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Vh.prototype.done=function(){this.no=!0},Vh.prototype.js=function(t){this.so=t},Vh.prototype.delete=function(){return Bh(this.eo.delete())},Vh),Rh=(n(Ch,kh=zr),Ch);function Ch(t){var e=this;return(e=kh.call(this,Br.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Vh(t){this.eo=t,this.no=!1,this.so=null}function Fh(t){this.db=t,12.2===Fh.Yr(y())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Uh(t){return"IndexedDbTransactionError"===t.name}var Mh=(Gh.open=function(t,e,n){return new Gh(t.transaction(n,e))},Object.defineProperty(Gh.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Gh.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(Er("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Gh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new jh(e)},Gh),jh=(qh.prototype.put=function(t,e){return Bh(void 0!==e?(Er("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Er("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},qh.prototype.add=function(t){return Er("SimpleDb","ADD",this.store.name,t,t),Bh(this.store.add(t))},qh.prototype.get=function(e){var n=this;return Bh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Er("SimpleDb","GET",n.store.name,e,t),t})},qh.prototype.delete=function(t){return Er("SimpleDb","DELETE",this.store.name,t),Bh(this.store.delete(t))},qh.prototype.count=function(){return Er("SimpleDb","COUNT",this.store.name),Bh(this.store.count())},qh.prototype.Fs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},qh.prototype.ho=function(t,e){Er("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},qh.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},qh.prototype.$r=function(i){var t=this.cursor({});return new Ku(function(n,r){t.onerror=function(t){var e=Wh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},qh.prototype.oo=function(t,s){var u=[];return new Ku(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Lh(i),(n=s(i.primaryKey,i.value,e))instanceof Ku&&(r=n.catch(function(t){return e.done(),Ku.reject(t)}),u.push(r)),e.gn?o():null===e.io?i.continue():i.continue(e.io)):o()}}).next(function(){return Ku.Sn(u)})},qh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},qh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},qh);function qh(t){this.store=t}function Gh(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new ua,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new Rh(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=Wh(t.target.error);n.ro.reject(new Rh(e))}}function Bh(t){return new Ku(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Wh(t.target.error);r(e)}})}var zh=!1;function Wh(t){var e=Ph.Yr(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new zr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return zh||(zh=!0,setTimeout(function(){throw r},0)),r}}return t}function Kh(){return"undefined"!=typeof window?window:null}var Hh=(Yh._o=function(t,e,n,r,i){var o=new Yh(t,e,Date.now()+n,r,i);return o.start(n),o},Yh.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},Yh.prototype.Ss=function(){return this.do()},Yh.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new zr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Yh.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},Yh.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},Yh),Xh=(Object.defineProperty(Qh.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),Qh.prototype.Zi=function(t){this.enqueue(t)},Qh.prototype.po=function(t){this.bo(),this.vo(t)},Qh.prototype.So=function(t){return this.bo(),this.vo(t)},Qh.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=Kh())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qh.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},Qh.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},Qh.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!Uh(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},Qh.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,Tr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},Qh.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=Hh._o(this,t,e,n,function(t){return r.$o(t)});return this.Io.push(i),i},Qh.prototype.bo=function(){this.mo&&Ar()},Qh.prototype.Fo=function(){},Qh.prototype.No=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},Qh.prototype.ko=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},Qh.prototype.xo=function(r){var i=this;return this.No().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.No()})},Qh.prototype.Mo=function(t){this.Ro.push(t)},Qh.prototype.$o=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},Qh);function Qh(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new aa(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=Kh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function Yh(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new ua,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function Jh(t,e){if(Tr("AsyncQueue",e+": "+t),Uh(t))return new zr(Br.UNAVAILABLE,e+": "+t);throw t}function Zh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=kr(n,i);return 0===s?kr(r,o):s}var $h=(rc.prototype.qo=function(){return++this.Lo},rc.prototype.Bo=function(t){var e,n=[t,this.qo()];this.buffer.size<this.Oo?this.buffer=this.buffer.add(n):Zh(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(rc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),rc),tc={Uo:!1,Wo:0,Qo:0,jo:0},ec=(nc.Ho=function(t){return new nc(t,nc.Yo,nc.Jo)},nc);function nc(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function rc(t){this.Oo=t,this.buffer=new ki(Zh),this.Lo=0}ec.Xo=-1,ec.Zo=1048576,ec.th=41943040,ec.Yo=10,ec.Jo=1e3,ec.eh=new ec(ec.th,ec.Yo,ec.Jo),ec.nh=new ec(ec.Xo,0,0);var ic=(hc.prototype.start=function(t){this.yr.params.Ko!==ec.Xo&&this.rh(t)},hc.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(hc.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),hc.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;Er("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return Uh(e=t.sent())?(Er("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,fc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},hc),oc=(ac.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},ac.prototype.uh=function(t,e){var n=this;if(0===e)return Ku.resolve(Zu.ws);var r=new $h(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},ac.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},ac.prototype.Fr=function(t,e){return this.hh.Fr(t,e)},ac.prototype.lh=function(e,n){var r=this;return this.params.Ko===ec.Xo?(Er("LruGarbageCollector","Garbage collection skipped; disabled"),Ku.resolve(tc)):this.kr(e).next(function(t){return t<r.params.Ko?(Er("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),tc):r._h(e,n)})},ac.prototype.kr=function(t){return this.hh.kr(t)},ac.prototype._h=function(e,n){var r,i,o,s,u,a,h,c=this,l=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>c.params.zo?(Er("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.zo+" from "+t),c.params.zo):t,s=Date.now(),c.uh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Fr(e,r)}).next(function(t){return h=Date.now(),Ir()<=p.DEBUG&&Er("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-l)+"ms"),Ku.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},ac),sc=(uc.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.jn.Qr(v).next(function(t){return g=t,e=r.persistence.mr(i),m=new Yu(r.Eh,e,r.persistence.gr()),e.Qr(v)}).next(function(t){for(var e=[],n=[],r=Ui(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Jn(v,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},uc.prototype.Vh=function(h){var c,l=this,f=Wr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Ui());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ih.Jn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Rs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Zs?t.field(i.field):void 0,s=Zo(i.transform,o||null);null!=s&&(e=null==e?(new Gs).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new xs(o.key,s,Hs(s.proto.mapValue),ws.exists(!0)))}return l.jn.Lr(a,f,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Cn:e}})},uc.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},uc.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return _r(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},uc.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},uc.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},uc.prototype.vh=function(a){var h=this,c=a.X,l=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Eh.Hs({Js:!0});l=h.dh;var s=[];a.Wt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.qi.Pi(o,t.Xt,e).next(function(){return h.qi.Ai(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.vi),l=l.nt(e,r),uc.Sh(i,r,t)&&s.push(h.qi.di(o,r))))});var t,u=Pi,n=Ui();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof $s&&e.version.isEqual(Kr.min())?(i.xn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.Nn(e,c),u=u.nt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.ii.Nr(o,t))})})),c.isEqual(Kr.min())||(t=h.qi.ai(o).next(function(t){return h.qi.ci(o,o.vi,c)}),s.push(t)),Ku.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ih.Xn(o,u)})}).then(function(t){return h.dh=l,t})},uc.Sh=function(t,e,n){return _r(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},uc.prototype.Ch=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ku.forEach(c,function(e){return Ku.forEach(e.as,function(t){return h.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return Ku.forEach(e.us,function(t){return h.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Uh(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},uc.prototype.$h=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},uc.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},uc.prototype.Nh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,Ku.resolve(n)):i.qi.ri(e).next(function(t){return n=new wi(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},uc.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?Ku.resolve(this.dh.get(n)):this.qi.mi(t,e)},uc.prototype.kh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Uh(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},uc.prototype.xh=function(t,n){var r=this,i=Kr.min(),o=Ui();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,lu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:Kr.min(),n?o:Ui())}).next(function(t){return{documents:t,Mh:o}})})},uc.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Ku.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);_r(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.Nn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},uc.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},uc);function uc(t,e,n){this.persistence=t,this.fh=e,this.dh=new Ti(kr),this.wh=new Gr(li,fi),this.Th=Kr.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new Yu(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function ac(t,e){this.hh=t,this.params=e}function hc(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function cc(t,e,n){return new sc(t,e,n)}function lc(t,e){var n=t,r=n.qi,i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function fc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Br.FAILED_PRECONDITION||e.message!==Xu)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}sc.Dh=3e8;var pc=(vc.prototype._=function(){return this.Oh._()},vc.prototype.Ri=function(t,e){var n=new dc(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},vc.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},vc.prototype.gi=function(t,e){this.Wh(new dc(t,e))},vc.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},vc.prototype.jh=function(t){var e=this,n=new Jr(new Xr([])),r=new dc(n,t),i=new dc(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},vc.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},vc.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},vc.prototype.Gh=function(t){var e=new Jr(new Xr([])),n=new dc(e,t),r=new dc(e,t+1),i=Ui();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},vc.prototype.pi=function(t){var e=new dc(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},vc),dc=(yc.Lh=function(t,e){return Jr.P(t.key,e.key)||kr(t.zh,e.zh)},yc.Bh=function(t,e){return kr(t.zh,e.zh)||Jr.P(t.key,e.key)},yc);function yc(t,e){this.key=t,this.zh=e}function vc(){this.Oh=new ki(dc.Lh),this.qh=new ki(dc.Bh)}function gc(t,e){if(0!==e.length)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Cc(e.length,"argument")+".")}function mc(t,e,n){if(e.length!==n)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires "+Cc(n,"argument")+", but was called with "+Cc(e.length,"argument")+".")}function wc(t,e,n){if(e.length<n)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Cc(n,"argument")+", but was called with "+Cc(e.length,"argument")+".")}function bc(t,e,n,r){if(e.length<n||e.length>r)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Cc(e.length,"argument")+".")}function Ic(t,e,n,r){Sc(t,e,Rc(n)+" argument",r)}function Ec(t,e,n,r){void 0!==r&&Ic(t,e,n,r)}function Tc(t,e,n,r){Sc(t,e,n+" option",r)}function Nc(t,e,n,r){void 0!==r&&Tc(t,e,n,r)}function Ac(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(xc(s))}var u=xc(n);throw new zr(Br.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function _c(t,e,n,r){if(!e.some(function(t){return t===r}))throw new zr(Br.INVALID_ARGUMENT,"Invalid value "+xc(r)+" provided to function "+t+"() for its "+Rc(n)+" argument. Acceptable values: "+e.join(", "));return r}function Sc(t,e,n,r){if(!("object"===e?Dc(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=xc(r);throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Dc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function xc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ar();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function kc(t,e,n){if(void 0===n)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Rc(e)+" argument, but it was undefined.")}function Oc(n,t,r){Fr(t,function(t,e){if(r.indexOf(t)<0)throw new zr(Br.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Pc(t,e,n,r){var i=xc(r);return new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+Rc(n)+" argument to be a "+e+", but it was: "+i)}function Lc(t,e,n){if(n<=0)throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+Rc(e)+" argument to be a positive number, but it was: "+n+".")}function Rc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Cc(t,e){return t+" "+e+(1===t?"":"s")}function Vc(){if("undefined"==typeof Uint8Array)throw new zr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Fc(){if("undefined"==typeof atob)throw new zr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Uc,Mc,jc=(Xc.fromBase64String=function(t){mc("Blob.fromBase64String",arguments,1),Ic("Blob.fromBase64String","string",1,t),Fc();try{return new Xc(di.fromBase64String(t))}catch(t){throw new zr(Br.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Xc.fromUint8Array=function(t){if(mc("Blob.fromUint8Array",arguments,1),Vc(),!(t instanceof Uint8Array))throw Pc("Blob.fromUint8Array","Uint8Array",1,t);return new Xc(di.fromUint8Array(t))},Xc.prototype.toBase64=function(){return mc("Blob.toBase64",arguments,0),Fc(),this.Hh.toBase64()},Xc.prototype.toUint8Array=function(){return mc("Blob.toUint8Array",arguments,0),Vc(),this.Hh.toUint8Array()},Xc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xc.prototype.isEqual=function(t){return this.Hh.isEqual(t.Hh)},Xc),qc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new zr(Br.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Ic("FieldPath","string",e,t[e]),0===t[e].length)throw new zr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yh=new Yr(t)},Gc=(n(Hc,Mc=qc),Hc.documentId=function(){return new Hc(Yr.L().F())},Hc.prototype.isEqual=function(t){if(!(t instanceof Hc))throw Pc("isEqual","FieldPath",1,t);return this.Yh.isEqual(t.Yh)},Hc),Bc=new RegExp("[~\\*/\\[\\]]"),zc=function(){this.Jh=this},Wc=(n(Kc,Uc=zc),Kc.prototype.Zh=function(t){if(2!==t.ta)throw 1===t.ta?t.ea(this.Xh+"() can only appear at the top level of your update data"):t.ea(this.Xh+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Kc.prototype.isEqual=function(t){return t instanceof Kc},Kc);function Kc(t){var e=this;return(e=Uc.call(this)||this).Xh=t,e}function Hc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mc.call(this,t)||this}function Xc(t){Fc(),this.Hh=t}function Qc(t,e,n){return new Nl({ta:3,na:e.settings.na,methodName:t.Xh,sa:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Yc,Jc,Zc,$c,tl,el,nl=(n(yl,el=zc),yl.prototype.Zh=function(t){return new vs(t.path,new es)},yl.prototype.isEqual=function(t){return t instanceof yl},yl),rl=(n(dl,tl=zc),dl.prototype.Zh=function(t){var e=Qc(this,t,!0),n=this.ia.map(function(t){return Pl(t,e)}),r=new ns(n);return new vs(t.path,r)},dl.prototype.isEqual=function(t){return this===t},dl),il=(n(pl,$c=zc),pl.prototype.Zh=function(t){var e=Qc(this,t,!0),n=this.ia.map(function(t){return Pl(t,e)}),r=new us(n);return new vs(t.path,r)},pl.prototype.isEqual=function(t){return this===t},pl),ol=(n(fl,Zc=zc),fl.prototype.Zh=function(t){var e=new ls(t.serializer,xo(t.serializer,this.ra));return new vs(t.path,e)},fl.prototype.isEqual=function(t){return this===t},fl),sl=(n(ll,Jc=zc),ll.delete=function(){return gc("FieldValue.delete",arguments),new ul(new Wc("FieldValue.delete"))},ll.serverTimestamp=function(){return gc("FieldValue.serverTimestamp",arguments),new ul(new nl("FieldValue.serverTimestamp"))},ll.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wc("FieldValue.arrayUnion",arguments,1),new ul(new rl("FieldValue.arrayUnion",t))},ll.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wc("FieldValue.arrayRemove",arguments,1),new ul(new il("FieldValue.arrayRemove",t))},ll.increment=function(t){return Ic("FieldValue.increment","number",1,t),mc("FieldValue.increment",arguments,1),new ul(new ol("FieldValue.increment",t))},ll),ul=(n(cl,Yc=sl),cl.prototype.Zh=function(t){return this.Jh.Zh(t)},cl.prototype.isEqual=function(t){return t instanceof cl&&this.Jh.isEqual(t.Jh)},cl),al=(Object.defineProperty(hl.prototype,"latitude",{get:function(){return this.oa},enumerable:!1,configurable:!0}),Object.defineProperty(hl.prototype,"longitude",{get:function(){return this.ha},enumerable:!1,configurable:!0}),hl.prototype.isEqual=function(t){return this.oa===t.oa&&this.ha===t.ha},hl.prototype.T=function(t){return kr(this.oa,t.oa)||kr(this.ha,t.ha)},hl);function hl(t,e){if(mc("GeoPoint",arguments,2),Ic("GeoPoint","number",1,t),Ic("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new zr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new zr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.oa=t,this.ha=e}function cl(t){var e=this;return(e=Yc.call(this)||this).Jh=t,e.Xh=t.Xh,e}function ll(){return Jc.call(this)||this}function fl(t,e){var n=this;return(n=Zc.call(this)||this).Xh=t,n.ra=e,n}function pl(t,e){var n=this;return(n=$c.call(this)||this).Xh=t,n.ia=e,n}function dl(t,e){var n=this;return(n=tl.call(this)||this).Xh=t,n.ia=e,n}function yl(t){var e=this;return(e=el.call(this)||this).Xh=t,e}function vl(t){return new _o(t,!0)}var gl=/^__.*__$/,ml=function(t,e,n){this.aa=t,this.ua=e,this.ca=n},wl=(El.prototype.la=function(t,e){var n=[];return null!==this.Le?n.push(new xs(t,this.data,this.Le,e)):n.push(new Ds(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},El),bl=(Il.prototype.la=function(t,e){var n=[new xs(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Rs(t,this.fieldTransforms)),n},Il);function Il(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function El(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Tl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ar()}}var Nl=(Object.defineProperty(Sl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"ta",{get:function(){return this.settings.ta},enumerable:!1,configurable:!0}),Sl.prototype.fa=function(t){return new Sl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Sl.prototype.da=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r.wa(t),r},Sl.prototype.Ta=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r._a(),r},Sl.prototype.Ea=function(t){return this.fa({path:void 0,sa:!0})},Sl.prototype.ea=function(t){return Ul(t,this.settings.methodName,this.settings.Ia||!1,this.path,this.settings.na)},Sl.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Sl.prototype._a=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},Sl.prototype.wa=function(t){if(0===t.length)throw this.ea("Document fields must not be empty");if(Tl(this.ta)&&gl.test(t))throw this.ea('Document fields cannot begin and end with "__"')},Sl),Al=(_l.prototype.ma=function(t,e,n,r){return void 0===r&&(r=!1),new Nl({ta:t,methodName:e,na:n,path:Yr.k(),sa:!1,Ia:r},this.s,this.serializer,this.ignoreUndefinedProperties)},_l);function _l(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||vl(t)}function Sl(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this._a(),this.fieldTransforms=i||[],this.Le=o||[]}function Dl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ma(o.merge||o.mergeFields?2:0,e,n,i);Cl("Data must be an object, but it was:",s,r);var u,a,h=Ll(r,s);if(o.merge)u=new ys(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof qc)d=p.Yh;else{if("string"!=typeof p)throw Ar();d=Fl(e,p,n)}if(!s.contains(d))throw new zr(Br.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Ml(c,d)||c.push(d)}u=new ys(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new wl(new qs(h),u,a)}function xl(t,o,s,e){var u=t.ma(1,o,s);Cl("Data must be an object, but it was:",u,e);var a=[],h=new Gs;Fr(e,function(t,e){var n,r=Fl(o,t,s),i=u.Ta(r);e instanceof zc&&e.Jh instanceof Wc?a.push(r):null!=(n=Pl(e,i))&&(a.push(r),h.set(r,n))});var n=new ys(a);return new bl(h.Ge(),n,u.fieldTransforms)}function kl(t,e,n,r,i,o){var s=t.ma(1,e,n),u=[Vl(e,r,n)],a=[i];if(o.length%2!=0)throw new zr(Br.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Vl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new Gs,v=u.length-1;0<=v;--v){Ml(d,u[v])||(c=u[v],l=a[v],f=s.Ta(c),l instanceof zc&&l.Jh instanceof Wc?d.push(c):null!=(p=Pl(l,f))&&(d.push(c),y.set(c,p)))}var g=new ys(d);return new bl(y.Ge(),g,s.fieldTransforms)}function Ol(t,e,n,r){return void 0===r&&(r=!1),Pl(n,t.ma(r?4:3,e))}function Pl(s,t){if(Rl(s))return Cl("Unsupported field value:",t,s),Ll(s,t);if(s instanceof zc)return function(t,e){if(!Tl(e.ta))throw e.ea(t.Xh+"() can only be used with update() and set()");if(!e.path)throw e.ea(t.Xh+"() is not currently supported inside arrays");var n=t.Zh(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.sa&&4!==t.ta)throw t.ea("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Pl(i[r],t.Ea(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return xo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Wr.fromDate(t);return{timestampValue:ko(e.serializer,n)}}if(t instanceof Wr){var r=new Wr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ko(e.serializer,r)}}if(t instanceof al)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jc)return{bytesValue:Oo(e.serializer,t)};if(t instanceof ml){var i=e.s,o=t.aa;if(!o.isEqual(i))throw e.ea("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Lo(t.aa||e.s,t.ua.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ea("Unsupported field value: "+xc(t))}(s,t)}function Ll(t,r){var i={};return Ur(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Fr(t,function(t,e){var n=Pl(e,r.da(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Rl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Wr||t instanceof al||t instanceof jc||t instanceof ml||t instanceof zc)}function Cl(t,e,n){if(!Rl(n)||!Dc(n)){var r=xc(n);throw"an object"===r?e.ea(t+" a custom object"):e.ea(t+" "+r)}}function Vl(t,e,n){if(e instanceof qc)return e.Yh;if("string"==typeof e)return Fl(t,e);throw Ul("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Fl(t,e,n){try{return function(e){if(0<=e.search(Bc))throw new zr(Br.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Gc.bind.apply(Gc,d([void 0],e.split("."))))}catch(t){throw new zr(Br.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yh}catch(e){throw Ul(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Ul(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new zr(Br.INVALID_ARGUMENT,(u+=". ")+t+a)}function Ml(t,e){return t.some(function(t){return t.isEqual(e)})}var jl=(ql.prototype.Mr=function(){return null!=this.uid},ql.prototype.Aa=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},ql.prototype.isEqual=function(t){return t.uid===this.uid},ql);function ql(t){this.uid=t}function Gl(t,e){this.user=e,this.type="OAuth",this.ga={},this.ga.Authorization="Bearer "+t}jl.UNAUTHENTICATED=new jl(null),jl.Ra=new jl("google-credentials-uid"),jl.Pa=new jl("first-party-uid");var Bl,zl,Wl,Kl=(df.prototype.getToken=function(){return Promise.resolve(null)},df.prototype.ya=function(){},df.prototype.pa=function(t){(this.Va=t)(jl.UNAUTHENTICATED)},df.prototype.ba=function(){this.Va=null},df),Hl=(pf.prototype.getToken=function(){var e=this,n=this.Da,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Da!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new Gl(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},pf.prototype.ya=function(){this.forceRefresh=!0},pf.prototype.pa=function(t){this.Va=t,this.Sa&&t(this.currentUser)},pf.prototype.ba=function(){this.auth&&this.auth.removeAuthTokenListener(this.va),this.va=null,this.Va=null},pf.prototype.Ca=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new jl(t)},pf),Xl=(Object.defineProperty(ff.prototype,"ga",{get:function(){var t={"X-Goog-AuthUser":this.Fa},e=this.$a.auth.Na([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ff),Ql=(lf.prototype.getToken=function(){return Promise.resolve(new Xl(this.$a,this.Fa))},lf.prototype.pa=function(t){t(jl.Pa)},lf.prototype.ba=function(){},lf.prototype.ya=function(){},lf),Yl=(cf.prototype.qa=function(){return 1===this.state||2===this.state||4===this.state},cf.prototype.Ba=function(){return 2===this.state},cf.prototype.start=function(){3!==this.state?this.auth():this.Ua()},cf.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},cf.prototype.Wa=function(){this.state=0,this.Po.reset()},cf.prototype.Qa=function(){var t=this;this.Ba()&&null===this.La&&(this.La=this.Ts.bs(this.ka,6e4,function(){return t.ja()}))},cf.prototype.Ka=function(t){this.Ga(),this.stream.send(t)},cf.prototype.ja=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ba()?[2,this.close(0)]:[2]})})},cf.prototype.Ga=function(){this.La&&(this.La.cancel(),this.La=null)},cf.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga(),this.Po.cancel(),this.Oa++,3!==e?this.Po.reset():n&&n.code===Br.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Br.UNAUTHENTICATED&&this.Ma.ya(),null!==this.stream&&(this.za(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ha(n)];case 1:return t.sent(),[2]}})})},cf.prototype.za=function(){},cf.prototype.auth=function(){var n=this;this.state=1;var t=this.Ya(this.Oa),e=this.Oa;this.Ma.getToken().then(function(t){n.Oa===e&&n.Ja(t)},function(e){t(function(){var t=new zr(Br.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Xa(t)})})},cf.prototype.Ja=function(t){var e=this,n=this.Ya(this.Oa);this.stream=this.Za(t),this.stream.tu(function(){n(function(){return e.state=2,e.listener.tu()})}),this.stream.Ha(function(t){n(function(){return e.Xa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},cf.prototype.Ua=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},cf.prototype.Xa=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},cf.prototype.Ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.Oa===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},cf),Jl=(n(hf,Wl=Yl),hf.prototype.Za=function(t){return this.xa.eu("Listen",t)},hf.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ar(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(_r(void 0===i||"string"==typeof i),di.fromBase64String(i||"")):(_r(void 0===i||i instanceof Uint8Array),di.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Gi(s,u,a,h&&(r=void 0===(n=h).code?Br.UNKNOWN:Ei(n.code),new zr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Vo(t,l.document.name),p=Po(l.document.updateTime),d=new qs({mapValue:{fields:l.document.fields}}),y=new Zs(f,p,d,{});c=new ji(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Vo(t,v.document),m=v.readTime?Po(v.readTime):Kr.min(),w=new $s(g,m);c=new ji([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var I=Vo(t,b.document);c=new ji([],b.removedTargetIds||[],I,null)}else{if(!("filter"in e))return Ar();e.filter;var E=e.filter;E.targetId;var T=new vi(E.count||0);c=new qi(E.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Kr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Kr.min():Po(e.readTime)}(t);return this.listener.nu(e,n)},hf.prototype.su=function(t){var e,n,r,i,o={};o.database=Mo(this.serializer),o.addTarget=(e=this.serializer,(r=pi(i=(n=t).target)?{documents:zo(e,i)}:{query:Wo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Oo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ar()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ka(o)},hf.prototype.iu=function(t){var e={};e.database=Mo(this.serializer),e.removeTarget=t,this.Ka(e)},hf),Zl=(n(af,zl=Yl),Object.defineProperty(af.prototype,"ou",{get:function(){return this.ru},enumerable:!1,configurable:!0}),af.prototype.start=function(){this.ru=!1,this.lastStreamToken=void 0,zl.prototype.start.call(this)},af.prototype.za=function(){this.ru&&this.hu([])},af.prototype.Za=function(t){return this.xa.eu("Write",t)},af.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(_r(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Po(t.updateTime):Po(e);n.isEqual(Kr.min())&&(n=Po(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new ms(n,r)}(t,i)})):[]),n=Po(t.commitTime);return this.listener.au(n,e)}var r,i;return _r(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.uu()},af.prototype.cu=function(){var t={};t.database=Mo(this.serializer),this.Ka(t)},af.prototype.hu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Go(e.serializer,t)})};this.Ka(n)},af),$l=(n(uf,Bl=function(){}),uf.prototype._u=function(){if(this.lu)throw new zr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},uf.prototype.start=function(t){this.xa=t},uf.prototype.fu=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.fu(e,n,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.ya(),t})},uf.prototype.du=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.du(e,n,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.ya(),t})},uf),tf=(sf.prototype.Au=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ru(),0<this.mutations.length)throw new zr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return g(this,void 0,void 0,function(){var i,e,n,o,r;return w(this,function(t){switch(t.label){case 0:return e={database:Mo((i=s).serializer),documents:u.map(function(t){return Co(i.serializer,t)})},[4,i.du("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=Vo(t,e.found.name),r=Po(e.found.updateTime),i=new qs({mapValue:{fields:e.found.fields}});return new Zs(n,r,i,{})}(e,n):"missing"in n?function(t,e){_r(!!e.missing),_r(!!e.readTime);var n=Vo(t,e.missing),r=Po(e.readTime);return new $s(n,r)}(e,n):Ar());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());_r(!!e),r.push(e)}),r)]}})})}(this.wu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Zs?n.Pu(t):Ar()}),e)]}})})},sf.prototype.set=function(t,e){this.write(e.la(t,this.Ue(t))),this.mu.add(t)},sf.prototype.update=function(t,e){try{this.write(e.la(t,this.gu(t)))}catch(t){this.Iu=t}this.mu.add(t)},sf.prototype.delete=function(t){this.write([new Ms(t,this.Ue(t))]),this.mu.add(t)},sf.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ru(),this.Iu)throw this.Iu;return e=this.Tu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Jr(Xr.N(e));r.mutations.push(new js(n,r.Ue(n)))}),[4,function(r,i){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return n={database:Mo((e=r).serializer),writes:i.map(function(t){return Go(e.serializer,t)})},[4,e.fu("Commit",n)];case 1:return t.sent(),[2]}})})}(this.wu,this.mutations)];case 1:return t.sent(),this.Eu=!0,[2]}})})},sf.prototype.Pu=function(t){var e;if(t instanceof Zs)e=t.version;else{if(!(t instanceof $s))throw Ar();e=Kr.min()}var n=this.Tu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new zr(Br.ABORTED,"Document version changed between two reads.")}else this.Tu.set(t.key.toString(),e)},sf.prototype.Ue=function(t){var e=this.Tu.get(t.toString());return!this.mu.has(t)&&e?ws.updateTime(e):ws.We()},sf.prototype.gu=function(t){var e=this.Tu.get(t.toString());if(this.mu.has(t)||!e)return ws.exists(!0);if(e.isEqual(Kr.min()))throw new zr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(e)},sf.prototype.write=function(t){this.Ru(),this.mutations=this.mutations.concat(t)},sf.prototype.Ru=function(){},sf),ef=(of.prototype.vu=function(){var t=this;0===this.yu&&(this.Su("Unknown"),this.pu=this.ao.bs("online_state_timeout",1e4,function(){return t.pu=null,t.Du("Backend didn't respond within 10 seconds."),t.Su("Offline"),Promise.resolve()}))},of.prototype.Cu=function(t){"Online"===this.state?this.Su("Unknown"):(this.yu++,1<=this.yu&&(this.$u(),this.Du("Connection failed 1 times. Most recent error: "+t.toString()),this.Su("Offline")))},of.prototype.set=function(t){this.$u(),this.yu=0,"Online"===t&&(this.bu=!1),this.Su(t)},of.prototype.Su=function(t){t!==this.state&&(this.state=t,this.Vu(t))},of.prototype.Du=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.bu?(Tr(e),this.bu=!1):Er("OnlineStateTracker",e)},of.prototype.$u=function(){null!==this.pu&&(this.pu.cancel(),this.pu=null)},of),nf=(rf.prototype.start=function(){return this.enableNetwork()},rf.prototype.enableNetwork=function(){return this.Mu.delete(0),this.Ju()},rf.prototype.Ju=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qu()?(this.Xu()?this.Zu():this.Uu.set("Unknown"),[4,this.tc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rf.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Mu.add(0),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Offline"),[2]}})})},rf.prototype.ec=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.Gu.stop()];case 1:return t.sent(),[4,this.Wu.stop()];case 2:return t.sent(),0<this.Nu.length&&(Er("RemoteStore","Stopping write stream with "+this.Nu.length+" pending writes"),this.Nu=[]),this.nc(),[2]}})})},rf.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Er("RemoteStore","RemoteStore shutting down."),this.Mu.add(5),[4,this.ec()];case 1:return t.sent(),this.Ou._r(),this.Uu.set("Unknown"),[2]}})})},rf.prototype.listen=function(t){this.ku.has(t.targetId)||(this.ku.set(t.targetId,t),this.Xu()?this.Zu():this.Wu.Ba()&&this.sc(t))},rf.prototype.ic=function(t){this.ku.delete(t),this.Wu.Ba()&&this.rc(t),0===this.ku.size&&(this.Wu.Ba()?this.Wu.Qa():this.qu()&&this.Uu.set("Unknown"))},rf.prototype.Me=function(t){return this.ku.get(t)||null},rf.prototype.xe=function(t){return this.oc.xe(t)},rf.prototype.sc=function(t){this.xu.de(t.targetId),this.Wu.su(t)},rf.prototype.rc=function(t){this.xu.de(t),this.Wu.iu(t)},rf.prototype.Zu=function(){this.xu=new Qi(this),this.Wu.start(),this.Uu.vu()},rf.prototype.Xu=function(){return this.qu()&&!this.Wu.qa()&&0<this.ku.size},rf.prototype.qu=function(){return 0===this.Mu.size},rf.prototype.nc=function(){this.xu=null},rf.prototype.Qu=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.ku.forEach(function(t,e){n.sc(t)}),[2]})})},rf.prototype.ju=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.nc(),this.Xu()?(this.Uu.Cu(e),this.Zu()):this.Uu.set("Unknown"),[2]})})},rf.prototype.Ku=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Uu.set("Online"),!(i instanceof Gi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.hc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.ac(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof ji?this.xu.Pe(i):i instanceof qi?this.xu.De(i):this.xu.ye(i),o.isEqual(Kr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Fu.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.uc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.ac(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},rf.prototype.ac=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Uh(n))throw n;return this.Mu.add(1),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Offline"),r=r||function(){return e.Fu.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Mu.delete(1),[4,this.Ju()];case 2:return t.sent(),[2]}})})}),[2]}})})},rf.prototype.cc=function(e){var n=this;return e().catch(function(t){return n.ac(t,e)})},rf.prototype.uc=function(r){var i=this,t=this.xu.Fe(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&((n=i.ku.get(e))&&i.ku.set(e,n.tt(t.resumeToken,r)))}),t.Qt.forEach(function(t){var e,n=i.ku.get(t);n&&(i.ku.set(t,n.tt(di.Y,n.X)),i.rc(t),e=new wi(n.target,t,1,n.sequenceNumber),i.sc(e))}),this.oc.vh(t)},rf.prototype.hc=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.ku.has(i)?[4,this.oc.lc(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.ku.delete(i),this.xu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},rf.prototype.tc=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.Nu.length?this.Nu[this.Nu.length-1].batchId:-1,t.label=1;case 1:if(!this._c())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.Fu.$h(e)];case 3:return null===(n=t.sent())?(0===this.Nu.length&&this.Gu.Qa(),[3,7]):(e=n.batchId,this.fc(n),[3,6]);case 4:return r=t.sent(),[4,this.ac(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.dc()&&this.wc(),[2]}})})},rf.prototype._c=function(){return this.qu()&&this.Nu.length<10},rf.prototype.Tc=function(){return this.Nu.length},rf.prototype.fc=function(t){this.Nu.push(t),this.Gu.Ba()&&this.Gu.ou&&this.Gu.hu(t.mutations)},rf.prototype.dc=function(){return this.qu()&&!this.Gu.qa()&&0<this.Nu.length},rf.prototype.wc=function(){this.Gu.start()},rf.prototype.zu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Gu.cu(),[2]})})},rf.prototype.Yu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Nu;e<n.length;e++)r=n[e],this.Gu.hu(r.mutations);return[2]})})},rf.prototype.au=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Nu.shift(),n=Wu.from(e,i,o),[4,this.cc(function(){return r.oc.Ec(n)})];case 1:return t.sent(),[4,this.tc()];case 2:return t.sent(),[2]}})})},rf.prototype.Hu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.Gu.ou?[4,this.Ic(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.dc()&&this.wc(),[2]}})})},rf.prototype.Ic=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Ii(n=i.code)&&n!==Br.ABORTED?(e=this.Nu.shift(),this.Gu.Wa(),[4,this.cc(function(){return r.oc.mc(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.tc()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},rf.prototype.Ac=function(){return new tf(this.wu)},rf.prototype.Bu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Mu.add(4),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Unknown"),this.Gu.Wa(),this.Wu.Wa(),this.Mu.delete(4),[4,this.Ju()];case 2:return t.sent(),[2]}})})},rf.prototype.Rc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.Fo(),Er("RemoteStore","RemoteStore received new credentials"),this.Mu.add(3),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Unknown"),[4,this.oc.Rc(e)];case 2:return t.sent(),this.Mu.delete(3),[4,this.Ju()];case 3:return t.sent(),[2]}})})},rf.prototype.Pc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Mu.delete(2),[4,this.Ju()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Mu.add(2),[4,this.ec()]);case 3:t.sent(),this.Uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},rf);function rf(t,e,n,r,i){var o,s,u,a,h,c,l,f,p=this;this.Fu=t,this.wu=e,this.ao=n,this.Nu=[],this.ku=new Map,this.xu=null,this.Mu=new Set,this.Ou=i,this.Ou.Lu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qu()?(Er("RemoteStore","Restarting streams for network reachability change."),[4,this.Bu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Uu=new ef(n,r),this.Wu=(h=this.wu,c=n,l={tu:this.Qu.bind(this),Ha:this.ju.bind(this),nu:this.Ku.bind(this)},(f=h)._u(),new Jl(c,f.xa,f.credentials,f.serializer,l)),this.Gu=(o=this.wu,s=n,u={tu:this.zu.bind(this),Ha:this.Hu.bind(this),uu:this.Yu.bind(this),au:this.au.bind(this)},(a=o)._u(),new Zl(s,a.xa,a.credentials,a.serializer,u))}function of(t,e){this.ao=t,this.Vu=e,this.state="Unknown",this.yu=0,this.pu=null,this.bu=!0}function sf(t){this.wu=t,this.Tu=new Map,this.mutations=[],this.Eu=!1,this.Iu=null,this.mu=new Set}function uf(t,e){var n=this;return(n=Bl.call(this)||this).credentials=t,n.serializer=e,n.lu=!1,n}function af(t,e,n,r,i){var o=this;return(o=zl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ru=!1,o}function hf(t,e,n,r,i){var o=this;return(o=Wl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function cf(t,e,n,r,i,o){this.Ts=t,this.ka=n,this.xa=r,this.Ma=i,this.listener=o,this.state=0,this.Oa=0,this.La=null,this.stream=null,this.Po=new aa(t,e)}function lf(t,e){this.$a=t,this.Fa=e}function ff(t,e){this.$a=t,this.Fa=e,this.type="FirstParty",this.user=jl.Pa}function pf(t){var e=this;this.va=null,this.currentUser=jl.UNAUTHENTICATED,this.Sa=!1,this.Da=0,this.Va=null,this.forceRefresh=!1,this.va=function(){e.Da++,e.currentUser=e.Ca(),e.Sa=!0,e.Va&&e.Va(e.currentUser)},this.Da=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.va):(this.va(null),t.get().then(function(t){e.auth=t,e.va&&e.auth.addAuthTokenListener(e.va)},function(){}))}function df(){this.Va=null}function yf(t,e){return"firestore_clients_"+t+"_"+e}function vf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function gf(t,e){return"firestore_targets_"+t+"_"+e}function mf(t){this.key=t}function wf(t){this.key=t}function bf(t,e,n){this.query=t,this.targetId=e,this.view=n}function If(t){this.key=t,this.Ml=!1}var Ef=(qf.gc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new zr(r.error.code,r.error.message)),i?new qf(t,e,r.state,o):(Tr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},qf.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},qf),Tf=(jf.gc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new zr(n.error.code,n.error.message)),r?new jf(t,n.state,i):(Tr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},jf.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},jf),Nf=(Mf.gc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Mi,o=0;r&&o<n.activeTargetIds.length;++o)r=ai(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Mf(t,i):(Tr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Mf),Af=(Uf.gc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Uf(e.clientId,e.onlineState):(Tr("SharedClientState","Failed to parse online state: "+t),null)},Uf),_f=(Ff.prototype.yc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ff.prototype.pc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ff.prototype.Vc=function(){var t={activeTargetIds:this.activeTargetIds.$(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ff),Sf=(Vf.Oi=function(t){return!(!t||!t.localStorage)},Vf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,l,f=this;return w(this,function(t){switch(t.label){case 0:return[4,this.oc.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.bc&&(o=this.getItem(yf(this.persistenceKey,i)))&&(s=Nf.gc(i,o))&&(this.Dc=this.Dc.nt(s.clientId,s));for(this.Oc(),(u=this.storage.getItem(this.Mc))&&(a=this.Lc(u))&&this.qc(a),h=0,c=this.Cc;h<c.length;h++)l=c[h],this.Sc(l);return this.Cc=[],this.window.addEventListener("unload",function(){return f._r()}),this.Hi=!0,[2]}})})},Vf.prototype.ds=function(t){this.setItem(this.Fc,JSON.stringify(t))},Vf.prototype.Bc=function(){return this.Uc(this.Dc)},Vf.prototype.Wc=function(n){var r=!1;return this.Dc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Vf.prototype.Qc=function(t){this.jc(t,"pending")},Vf.prototype.Kc=function(t,e,n){this.jc(t,e,n),this.Gc(t)},Vf.prototype.zc=function(t){var e,n,r="not-current";return this.Wc(t)&&(!(e=this.storage.getItem(gf(this.persistenceKey,t)))||(n=Tf.gc(t,e))&&(r=n.state)),this.Hc.yc(t),this.Oc(),r},Vf.prototype.Yc=function(t){this.Hc.pc(t),this.Oc()},Vf.prototype.Jc=function(t){return this.Hc.activeTargetIds.has(t)},Vf.prototype.Xc=function(t){this.removeItem(gf(this.persistenceKey,t))},Vf.prototype.Zc=function(t,e,n){this.tl(t,e,n)},Vf.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.Gc(t)}),this.currentUser=t,n.forEach(function(t){r.Qc(t)})},Vf.prototype.el=function(t){this.nl(t)},Vf.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.vc),this.removeItem(this.$c),this.Hi=!1)},Vf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Er("SharedClientState","READ",t,e),e},Vf.prototype.setItem=function(t,e){Er("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Vf.prototype.removeItem=function(t){Er("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Vf.prototype.Sc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Er("SharedClientState","EVENT",u.key,u.newValue),u.key===this.$c)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.Nc.test(u.key)){if(null==u.newValue)return e=this.sl(u.key),[2,this.il(e,null)];if(n=this.rl(u.key,u.newValue))return[2,this.il(n.clientId,n)]}else if(this.kc.test(u.key)){if(null!==u.newValue&&(r=this.ol(u.key,u.newValue)))return[2,this.hl(r)]}else if(this.xc.test(u.key)){if(null!==u.newValue&&(i=this.al(u.key,u.newValue)))return[2,this.ul(i)]}else if(u.key===this.Mc){if(null!==u.newValue&&(o=this.Lc(u.newValue)))return[2,this.qc(o)]}else u.key===this.Fc&&(s=function(t){var e=Zu.ws;if(null!=t)try{var n=JSON.parse(t);_r("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==Zu.ws&&this.ls(s)}else this.Cc.push(u);return[2]})})})}},Object.defineProperty(Vf.prototype,"Hc",{get:function(){return this.Dc.get(this.bc)},enumerable:!1,configurable:!0}),Vf.prototype.Oc=function(){this.setItem(this.$c,this.Hc.Vc())},Vf.prototype.jc=function(t,e,n){var r=new Ef(this.currentUser,t,e,n),i=vf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Vc())},Vf.prototype.Gc=function(t){var e=vf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Vf.prototype.nl=function(t){var e={clientId:this.bc,onlineState:t};this.storage.setItem(this.Mc,JSON.stringify(e))},Vf.prototype.tl=function(t,e,n){var r=gf(this.persistenceKey,t),i=new Tf(t,e,n);this.setItem(r,i.Vc())},Vf.prototype.sl=function(t){var e=this.Nc.exec(t);return e?e[1]:null},Vf.prototype.rl=function(t,e){var n=this.sl(t);return Nf.gc(n,e)},Vf.prototype.ol=function(t,e){var n=this.kc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ef.gc(new jl(i),r,e)},Vf.prototype.al=function(t,e){var n=this.xc.exec(t),r=Number(n[1]);return Tf.gc(r,e)},Vf.prototype.Lc=function(t){return Af.gc(t)},Vf.prototype.hl=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.oc.cl(e.batchId,e.state,e.error)]:(Er("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Vf.prototype.ul=function(t){return this.oc.ll(t.targetId,t.state,t.error)},Vf.prototype.il=function(t,e){var n=this,r=e?this.Dc.nt(t,e):this.Dc.remove(t),i=this.Uc(this.Dc),o=this.Uc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.oc._l(s,u).then(function(){n.Dc=r})},Vf.prototype.qc=function(t){this.Dc.get(t.clientId)&&this.Vu(t.onlineState)},Vf.prototype.Uc=function(t){var n=Mi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},Vf),Df=(Cf.prototype.Qc=function(t){},Cf.prototype.Kc=function(t,e,n){},Cf.prototype.zc=function(t){return this.fl.yc(t),this.dl[t]||"not-current"},Cf.prototype.Zc=function(t,e,n){this.dl[t]=e},Cf.prototype.Yc=function(t){this.fl.pc(t)},Cf.prototype.Jc=function(t){return this.fl.activeTargetIds.has(t)},Cf.prototype.Xc=function(t){delete this.dl[t]},Cf.prototype.Bc=function(){return this.fl.activeTargetIds},Cf.prototype.Wc=function(t){return this.fl.activeTargetIds.has(t)},Cf.prototype.start=function(){return this.fl=new _f,Promise.resolve()},Cf.prototype.Ah=function(t,e,n){},Cf.prototype.el=function(t){},Cf.prototype._r=function(){},Cf.prototype.ds=function(t){},Cf),xf=(Object.defineProperty(Rf.prototype,"Al",{get:function(){return this.wl},enumerable:!1,configurable:!0}),Rf.prototype.Rl=function(t,e){var u=this,a=e?e.Pl:new zi,h=e?e.ml:this.ml,c=e?e.Lt:this.Lt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof Zs?e:null)&&(mu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.gl(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Il(r,p)||d&&u.Il(r,d)<0)&&(f=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{ml:l,Pl:a,Vl:f,Lt:c}},Rf.prototype.gl=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},Rf.prototype.qn=function(t,e,n){var o=this,r=this.ml;this.ml=t.ml,this.Lt=t.Lt;var i=t.Pl.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Il(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ar()}}var r,i}),this.yl(n);var s=e?this.pl():[],u=0===this.El.size&&this.Ht?1:0,a=u!==this.Tl;return this.Tl=u,0!==i.length||a?{snapshot:new Wi(this.query,t.ml,r,i,t.Lt,0==u,a,!1),bl:s}:{bl:s}},Rf.prototype.vl=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({ml:this.ml,Pl:new zi,Lt:this.Lt,Vl:!1},!1)):{bl:[]}},Rf.prototype.Sl=function(t){return!this.wl.has(t)&&!!this.ml.has(t)&&!this.ml.get(t).Ke},Rf.prototype.yl=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.wl=e.wl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.wl=e.wl.delete(t)}),this.Ht=t.Ht)},Rf.prototype.pl=function(){var e=this;if(!this.Ht)return[];var n=this.El;this.El=Ui(),this.ml.forEach(function(t){e.Sl(t.key)&&(e.El=e.El.add(t.key))});var r=[];return n.forEach(function(t){e.El.has(t)||r.push(new wf(t))}),this.El.forEach(function(t){n.has(t)||r.push(new mf(t))}),r},Rf.prototype.Dl=function(t){this.wl=t.Mh,this.El=Ui();var e=this.Rl(t.documents);return this.qn(e,!0)},Rf.prototype.Cl=function(){return Wi.Ut(this.query,this.ml,this.Lt,0===this.Tl)},Rf),kf=(Lf.prototype.run=function(){this.Fl()},Lf.prototype.Fl=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new tf(this.wu),(n=this.Nl(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.kl(t)})})}).catch(function(t){r.kl(t)}),[2]})})})},Lf.prototype.Nl=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},Lf.prototype.kl=function(t){var e=this;0<this.$l&&this.xl(t)?(--this.$l,this.ao.Zi(function(){return e.Fl(),Promise.resolve()})):this.lo.reject(t)},Lf.prototype.xl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ii(e)},Lf),Of=(Object.defineProperty(Pf.prototype,"Xl",{get:function(){return!0===this.Jl},enumerable:!1,configurable:!0}),Pf.prototype.subscribe=function(t){this.Bl=t},Pf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.Zl("listen()"),(r=this.Ul.get(s))?(e=r.targetId,this.Ll.zc(e),n=r.view.Cl(),[3,4]):[3,1];case 1:return[4,this.Fu.Nh(lu(s))];case 2:return i=t.sent(),o=this.Ll.zc(i.targetId),e=i.targetId,[4,this.t_(s,e,"current"===o)];case 3:n=t.sent(),this.Xl&&this.Ol.listen(i),t.label=4;case 4:return[2,n]}})})},Pf.prototype.t_=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.Fu.xh(u,!0)];case 1:return e=t.sent(),n=new xf(u,e.Mh),r=n.Rl(e.documents),i=Hi.zt(a,h&&"Offline"!==this.onlineState),o=n.qn(r,this.Xl,i),this.e_(a,o.bl),s=new bf(u,a,n),[2,(this.Ul.set(u,s),this.Wl.has(a)?this.Wl.get(a).push(u):this.Wl.set(a,[u]),o.snapshot)]}})})},Pf.prototype.ic=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.Zl("unlisten()"),e=this.Ul.get(i),1<(n=this.Wl.get(e.targetId)).length?[2,(this.Wl.set(e.targetId,n.filter(function(t){return!yu(t,i)})),void this.Ul.delete(i))]:this.Xl?(this.Ll.Yc(e.targetId),this.Ll.Wc(e.targetId)?[3,2]:[4,this.Fu.kh(e.targetId,!1).then(function(){r.Ll.Xc(e.targetId),r.Ol.ic(e.targetId),r.n_(e.targetId)}).catch(fc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.n_(e.targetId),[4,this.Fu.kh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Pf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.Zl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Fu.Vh(i)];case 2:return e=t.sent(),this.Ll.Qc(e.batchId),this.s_(e.batchId,o),[4,this.i_(e.Cn)];case 3:return t.sent(),[4,this.Ol.tc()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Jh(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Pf.prototype.runTransaction=function(t,e,n){new kf(t,this.wu,e,n).run()},Pf.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.Zl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Fu.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Kl.get(e);n&&(_r(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Ml=!0:0<t.Jt.size?_r(n.Ml):0<t.Xt.size&&(_r(n.Ml),n.Ml=!1))}),[4,this.i_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.vl=function(r,t){var i;(this.Xl&&0===t||!this.Xl&&1===t)&&(this.Zl("applyOnlineStateChange()"),i=[],this.Ul.forEach(function(t,e){var n=e.view.vl(r);n.snapshot&&i.push(n.snapshot)}),this.Bl.r_(r),this.Bl.nu(i),this.onlineState=r,this.Xl&&this.Ll.el(r))},Pf.prototype.lc=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.Zl("rejectListens()"),this.Ll.Zc(u,"rejected",a),e=this.Kl.get(u),(n=e&&e.key)?(r=(r=new Ti(Jr.P)).nt(n,new $s(n,Kr.min())),i=Ui().add(n),o=new Ki(Kr.min(),new Map,new ki(kr),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.jl=this.jl.remove(n),this.Kl.delete(u),this.o_(),[3,4];case 2:return[4,this.Fu.kh(u,!1).then(function(){return s.n_(u,a)}).catch(fc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Pf.prototype.Ec=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.Zl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Fu.yh(r)];case 2:return n=t.sent(),this.h_(e,null),this.a_(e),this.Ll.Kc(e,"acknowledged"),[4,this.i_(n)];case 3:return t.sent(),[3,6];case 4:return[4,fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.mc=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Zl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Fu.bh(n)];case 2:return e=t.sent(),this.h_(n,r),this.a_(n),this.Ll.Kc(n,"rejected",r),[4,this.i_(e)];case 3:return t.sent(),[3,6];case 4:return[4,fc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.u_=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.Ol.qu()||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fu.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Hl.get(e)||[]).push(o),this.Hl.set(e,n),[3,4]);case 3:return r=t.sent(),i=Jh(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Pf.prototype.a_=function(t){(this.Hl.get(t)||[]).forEach(function(t){t.resolve()}),this.Hl.delete(t)},Pf.prototype.c_=function(e){this.Hl.forEach(function(t){t.forEach(function(t){t.reject(new zr(Br.CANCELLED,e))})}),this.Hl.clear()},Pf.prototype.s_=function(t,e){var n=(n=(n=this.zl[this.currentUser.Aa()])||new Ti(kr)).nt(t,e);this.zl[this.currentUser.Aa()]=n},Pf.prototype.h_=function(t,e){var n,r=this.zl[this.currentUser.Aa()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.zl[this.currentUser.Aa()]=r)},Pf.prototype.n_=function(t,e){var n=this;void 0===e&&(e=null),this.Ll.Yc(t);for(var r=0,i=this.Wl.get(t);r<i.length;r++){var o=i[r];this.Ul.delete(o),e&&this.Bl.l_(o,e)}this.Wl.delete(t),this.Xl&&this.Gl.jh(t).forEach(function(t){n.Gl.pi(t)||n.__(t)})},Pf.prototype.__=function(t){var e=this.jl.get(t);null!==e&&(this.Ol.ic(e),this.jl=this.jl.remove(t),this.Kl.delete(e),this.o_())},Pf.prototype.e_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof mf?(this.Gl.Ri(i.key,t),this.f_(i)):i instanceof wf?(Er("SyncEngine","Document no longer in limbo: "+i.key),this.Gl.gi(i.key,t),this.Gl.pi(i.key)||this.__(i.key)):Ar()}},Pf.prototype.f_=function(t){var e=t.key;this.jl.get(e)||(Er("SyncEngine","New document in limbo: "+e),this.Ql.push(e),this.o_())},Pf.prototype.o_=function(){for(;0<this.Ql.length&&this.jl.size<this.ql;){var t=this.Ql.shift(),e=this.Yl.next();this.Kl.set(e,new If(t)),this.jl=this.jl.nt(t,e),this.Ol.listen(new wi(lu(au(t.path)),e,2,Zu.ws))}},Pf.prototype.d_=function(){return this.jl},Pf.prototype.w_=function(){return this.Ql},Pf.prototype.i_=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ul.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Rl(r);return n.Vl?u.Fu.xh(i.query,!1).then(function(t){var e=t.documents;return i.view.Rl(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.qn(t,u.Xl,n);u.e_(i.targetId,r.bl),r.snapshot&&(u.Xl&&u.Ll.Zc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Ju.cs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bl.nu(o),[4,this.Fu.Ch(s)];case 2:return t.sent(),[2]}})})},Pf.prototype.Zl=function(t){},Pf.prototype.Rc=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Er("SyncEngine","User change. New user:",n.Aa()),[4,this.Fu.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.c_("'waitForPendingWrites' promise is rejected due to a user change."),this.Ll.Ah(n,e.Ph,e.gh),[4,this.i_(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Pf.prototype.xe=function(t){var e=this.Kl.get(t);if(e&&e.Ml)return Ui().add(e.key);var n=Ui(),r=this.Wl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.Ul.get(s),n=n.Ct(u.view.Al);return n},Pf);function Pf(t,e,n,r,i,o){this.Fu=t,this.Ol=e,this.wu=n,this.Ll=r,this.currentUser=i,this.ql=o,this.Bl=null,this.Ul=new Gr(vu,yu),this.Wl=new Map,this.Ql=[],this.jl=new Ti(Jr.P),this.Kl=new Map,this.Gl=new pc,this.zl={},this.Hl=new Map,this.Yl=Ma.si(),this.onlineState="Unknown",this.Jl=void 0}function Lf(t,e,n,r){this.ao=t,this.wu=e,this.updateFunction=n,this.lo=r,this.$l=5,this.Po=new aa(this.ao,"transaction_retry")}function Rf(t,e){this.query=t,this.wl=e,this.Tl=null,this.Ht=!1,this.El=Ui(),this.Lt=Ui(),this.Il=wu(t),this.ml=new Bi(this.Il)}function Cf(){this.fl=new _f,this.dl={},this.Vu=null,this.ls=null}function Vf(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.bc=r,this.oc=null,this.Vu=null,this.ls=null,this.vc=this.Sc.bind(this),this.Dc=new Ti(kr),this.Hi=!1,this.Cc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.$c=yf(this.persistenceKey,this.bc),this.Fc="firestore_sequence_number_"+this.persistenceKey,this.Dc=this.Dc.nt(this.bc,new _f),this.Nc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.kc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.xc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Mc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.vc)}function Ff(){this.activeTargetIds=Mi}function Uf(t,e){this.clientId=t,this.onlineState=e}function Mf(t,e){this.clientId=t,this.activeTargetIds=e}function jf(t,e,n){this.targetId=t,this.state=e,this.error=n}function qf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Gf(t,e,n,r,i,o,s){var u=new Of(t,e,n,r,i,o);return s&&(u.Jl=!0),u}function Bf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,l,f,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Wl.get(s))&&0!==a.length?[4,e.Fu.Nh(lu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(l=c[h],f=e.Ul.get(l),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).Fu.xh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Dl(n),[2,(e.Xl&&e.e_(o.targetId,r.bl),r)]}})})}(e,f)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,lc(e.Fu,s)];case 8:return d=t.sent(),[4,e.Fu.Nh(d)];case 9:return u=t.sent(),[4,e.t_(zf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Bl.nu(r),n)]}})})}function zf(t){return uu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Wf(){this.T_=void 0,this.listeners=[]}var Kf,Hf=(np.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.E_.get(e))||(n=!0,r=new Wf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.oc.listen(e)];case 2:return i.T_=t.sent(),[3,4];case 3:return o=t.sent(),s=Jh(o,"Initialization of query '"+gu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.E_.set(e,r),r.listeners.push(u),u.vl(this.onlineState),r.T_&&u.m_(r.T_)&&this.A_(),[2]}})})},np.prototype.ic=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.E_.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.E_.delete(e),this.oc.ic(e))]:[2]})})},np.prototype.nu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.E_.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].m_(i)&&(e=!0);s.T_=i}}e&&this.A_()},np.prototype.l_=function(t,e){var n=this.E_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.E_.delete(t)},np.prototype.r_=function(i){this.onlineState=i;var o=!1;this.E_.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].vl(i)&&(o=!0)}),o&&this.A_()},np.prototype.R_=function(t){this.I_.add(t),t.next()},np.prototype.P_=function(t){this.I_.delete(t)},np.prototype.A_=function(){this.I_.forEach(function(t){t.next()})},np),Xf=(ep.prototype.m_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Wi(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.V_?this.p_(t)&&(this.g_.next(t),o=!0):this.b_(t,this.onlineState)&&(this.v_(t),o=!0),this.y_=t,o},ep.prototype.onError=function(t){this.g_.error(t)},ep.prototype.vl=function(t){this.onlineState=t;var e=!1;return this.y_&&!this.V_&&this.b_(this.y_,t)&&(this.v_(this.y_),e=!0),e},ep.prototype.b_=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.S_&&n||t.docs._()&&"Offline"!==e)},ep.prototype.p_=function(t){if(0<t.docChanges.length)return!0;var e=this.y_&&this.y_.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},ep.prototype.v_=function(t){t=Wi.Ut(t.query,t.docs,t.Lt,t.fromCache),this.V_=!0,this.g_.next(t)},ep),Qf=(tp.prototype.mh=function(t){this.D_=t},tp.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Kr.min())?this.C_(e,r):this.D_.Jn(e,o).next(function(t){var n=s.F_(r,t);return(r.hn()||r.an())&&s.Vl(r.en,n,o,i)?s.C_(e,r):(Ir()<=p.DEBUG&&Er("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gu(r)),s.D_.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},tp.prototype.F_=function(n,t){var r=new ki(wu(n));return t.forEach(function(t,e){e instanceof Zs&&mu(n,e)&&(r=r.add(e))}),r},tp.prototype.Vl=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},tp.prototype.C_=function(t,e){return Ir()<=p.DEBUG&&Er("IndexFreeQueryEngine","Using full collection scan to execute query:",gu(e)),this.D_.ts(t,e,Kr.min())},tp),Yf=($f.prototype.Or=function(t){return Ku.resolve(0===this.jn.length)},$f.prototype.Lr=function(t,e,n,r){var i=this.N_;this.N_++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new zu(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.k_=this.k_.add(new dc(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return Ku.resolve(o)},$f.prototype.qr=function(t,e){return Ku.resolve(this.x_(e))},$f.prototype.Ur=function(t,e){var n=e+1,r=this.M_(n),i=r<0?0:r;return Ku.resolve(this.jn.length>i?this.jn[i]:null)},$f.prototype.Wr=function(){return Ku.resolve(0===this.jn.length?-1:this.N_-1)},$f.prototype.Qr=function(t){return Ku.resolve(this.jn.slice())},$f.prototype.zn=function(t,e){var n=this,r=new dc(e,0),i=new dc(e,Number.POSITIVE_INFINITY),o=[];return this.k_.vt([r,i],function(t){var e=n.x_(t.zh);o.push(e)}),Ku.resolve(o)},$f.prototype.Zn=function(t,e){var r=this,i=new ki(kr);return e.forEach(function(t){var e=new dc(t,0),n=new dc(t,Number.POSITIVE_INFINITY);r.k_.vt([e,n],function(t){i=i.add(t.zh)})}),Ku.resolve(this.O_(i))},$f.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;Jr.W(i)||(i=i.child(""));var o=new dc(new Jr(i),0),s=new ki(kr);return this.k_.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),Ku.resolve(this.O_(s))},$f.prototype.O_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.x_(t);null!==e&&r.push(e)}),r},$f.prototype.Kr=function(n,r){var i=this;_r(0===this.L_(r.batchId,"removed")),this.jn.shift();var o=this.k_;return Ku.forEach(r.mutations,function(t){var e=new dc(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.k_=o})},$f.prototype.Gr=function(t){},$f.prototype.pi=function(t,e){var n=new dc(e,0),r=this.k_.Dt(n);return Ku.resolve(e.isEqual(r&&r.key))},$f.prototype.zr=function(t){return this.jn.length,Ku.resolve()},$f.prototype.L_=function(t,e){return this.M_(t)},$f.prototype.M_=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},$f.prototype.x_=function(t){var e=this.M_(t);return e<0||e>=this.jn.length?null:this.jn[e]},$f),Jf=(Zf.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.q_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},Zf.prototype.xn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Zf.prototype.Mn=function(t,e){var n=this.docs.get(e);return Ku.resolve(n?n.Ls:null)},Zf.prototype.getEntries=function(t,e){var n=this,r=Pi;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),Ku.resolve(r)},Zf.prototype.ts=function(t,e,n){for(var r=Ci,i=new Jr(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ls,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof Zs&&mu(e,h)&&(r=r.nt(h.key,h))}return Ku.resolve(r)},Zf.prototype.B_=function(t,e){return Ku.forEach(this.docs,function(t){return e(t)})},Zf.prototype.Hs=function(t){return new Zf.Ys(this)},Zf.prototype.Xs=function(t){return Ku.resolve(this.size)},Zf);function Zf(t,e){this.Kn=t,this.q_=e,this.docs=new Ti(Jr.P),this.size=0}function $f(t,e){this.Kn=t,this.ii=e,this.jn=[],this.N_=1,this.k_=new ki(dc.Lh)}function tp(){}function ep(t,e,n){this.query=t,this.g_=e,this.V_=!1,this.y_=null,this.onlineState="Unknown",this.options=n||{}}function np(t){this.oc=t,this.E_=new Gr(vu,yu),this.onlineState="Unknown",this.I_=new Set,this.oc.subscribe(this)}function rp(t){var e=this;return(e=Kf.call(this)||this).Zs=t,e}Jf.Ys=(n(rp,Kf=Hu),rp.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.Nn(n,e,r.readTime)):r.Zs.xn(t)}),Ku.Sn(i)},rp.prototype.On=function(t,e){return this.Zs.Mn(t,e)},rp.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},rp);var ip,op,sp,up=(Lp.prototype.pe=function(t,n){return this.U_.forEach(function(t,e){return n(e)}),Ku.resolve()},Lp.prototype.ai=function(t){return Ku.resolve(this.lastRemoteSnapshotVersion)},Lp.prototype.ui=function(t){return Ku.resolve(this.W_)},Lp.prototype.ri=function(t){return this.highestTargetId=this.j_.next(),Ku.resolve(this.highestTargetId)},Lp.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.W_&&(this.W_=e),Ku.resolve()},Lp.prototype._i=function(t){this.U_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.j_=new Ma(e),this.highestTargetId=e),t.sequenceNumber>this.W_&&(this.W_=t.sequenceNumber)},Lp.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,Ku.resolve()},Lp.prototype.di=function(t,e){return this._i(e),Ku.resolve()},Lp.prototype.wi=function(t,e){return this.U_.delete(e.target),this.Q_.jh(e.targetId),--this.targetCount,Ku.resolve()},Lp.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.U_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.U_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),Ku.Sn(u).next(function(){return s})},Lp.prototype.Ii=function(t){return Ku.resolve(this.targetCount)},Lp.prototype.mi=function(t,e){var n=this.U_.get(e)||null;return Ku.resolve(n)},Lp.prototype.Ai=function(t,e,n){return this.Q_.Uh(e,n),Ku.resolve()},Lp.prototype.Pi=function(e,t,n){this.Q_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),Ku.Sn(i)},Lp.prototype.Ti=function(t,e){return this.Q_.jh(e),Ku.resolve()},Lp.prototype.Vi=function(t,e){var n=this.Q_.Gh(e);return Ku.resolve(n)},Lp.prototype.pi=function(t,e){return Ku.resolve(this.Q_.pi(e))},Lp),ap=(Pp.prototype.start=function(){return Promise.resolve()},Pp.prototype._r=function(){return this.$i=!1,Promise.resolve()},Object.defineProperty(Pp.prototype,"Hi",{get:function(){return this.$i},enumerable:!1,configurable:!0}),Pp.prototype.Yi=function(){},Pp.prototype.Xi=function(){},Pp.prototype.gr=function(){return this.Kn},Pp.prototype.mr=function(t){var e=this.K_[t.Aa()];return e||(e=new Yf(this.Kn,this.ii),this.K_[t.Aa()]=e),e},Pp.prototype.Rr=function(){return this.qi},Pp.prototype.Pr=function(){return this.Qn},Pp.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new hp(this.Ci.next());return this.ii.z_(),n(i).next(function(t){return r.ii.H_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},Pp.prototype.Y_=function(e,n){return Ku.Dn(Object.values(this.K_).map(function(t){return function(){return t.pi(e,n)}}))},Pp),hp=(n(Op,sp=Qu),Op),cp=(kp.Z_=function(t){return new kp(t)},Object.defineProperty(kp.prototype,"tf",{get:function(){if(this.X_)return this.X_;throw Ar()},enumerable:!1,configurable:!0}),kp.prototype.Ri=function(t,e,n){return this.J_.Ri(n,e),this.tf.delete(n),Ku.resolve()},kp.prototype.gi=function(t,e,n){return this.J_.gi(n,e),this.tf.add(n),Ku.resolve()},kp.prototype.Dr=function(t,e){return this.tf.add(e),Ku.resolve()},kp.prototype.removeTarget=function(t,e){var n=this;this.J_.jh(e.targetId).forEach(function(t){return n.tf.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.tf.add(t)})}).next(function(){return r.wi(t,e)})},kp.prototype.z_=function(){this.X_=new Set},kp.prototype.H_=function(t){var n=this,r=this.persistence.Pr().Hs();return Ku.forEach(this.tf,function(e){return n.ef(t,e).next(function(t){t||r.xn(e)})}).next(function(){return n.X_=null,r.apply(t)})},kp.prototype.Nr=function(t,e){var n=this;return this.ef(t,e).next(function(t){t?n.tf.delete(e):n.tf.add(e)})},kp.prototype.G_=function(t){return 0},kp.prototype.ef=function(t,e){var n=this;return Ku.Dn([function(){return Ku.resolve(n.J_.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.Y_(t,e)}])},kp),lp=(xp.prototype.tu=function(t){this.if=t},xp.prototype.Ha=function(t){this.rf=t},xp.prototype.onMessage=function(t){this.hf=t},xp.prototype.close=function(){this.sf()},xp.prototype.send=function(t){this.nf(t)},xp.prototype.af=function(){this.if()},xp.prototype.uf=function(t){this.rf(t)},xp.prototype.cf=function(t){this.hf(t)},xp),fp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pp=(Dp.prototype._f=function(t,e){if(e)for(var n in e.ga)e.ga.hasOwnProperty(n)&&(t[n]=e.ga[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.1-20206244562"},Dp.prototype.fu=function(a,r,i){var h=this,c=this.ff(a);return new Promise(function(o,s){var u=new vr;u.listenOnce(dr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case pr.NO_ERROR:var t=u.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),o(t);break;case pr.TIMEOUT:Er("Connection",'RPC "'+a+'" timed out'),s(new zr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e,n,r=u.getStatus();Er("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Br).indexOf(i)?i:Br.UNKNOWN,s(new zr(n,e.message))):s(new zr(Br.UNKNOWN,"Server responded with status "+u.getStatus())):(Er("Connection",'RPC "'+a+'" failed'),s(new zr(Br.UNAVAILABLE,"Connection failed.")));break;default:Ar()}}finally{Er("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Er("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h._f(n,i),u.send(c,"POST",e,n,15)})},Dp.prototype.du=function(t,e,n){return this.fu(t,e,n)},Dp.prototype.eu=function(t,e){var n,r,i=[this.lf,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=fr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this._f(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Er("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new lp({nf:function(t){l?Er("Connection","Not sending because WebChannel is closed:",t):(c||(Er("Connection","Opening WebChannel transport."),h.open(),c=!0),Er("Connection","WebChannel sending:",t),h.send(t))},sf:function(){return h.close()}});return a(yr.EventType.OPEN,function(){l||Er("Connection","WebChannel transport opened.")}),a(yr.EventType.CLOSE,function(){l||(l=!0,Er("Connection","WebChannel transport closed"),f.uf())}),a(yr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.WARN&&(e=n.map(Nr),br.warn.apply(br,d(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.uf(new zr(Br.UNAVAILABLE,"The operation could not be completed")))}),a(yr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(_r(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Er("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=gi[i];if(void 0!==t)return Ei(t)}(),s=r.message,void 0===o&&(o=Br.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.uf(new zr(o,s)),h.close()):(Er("Connection","WebChannel received:",n),f.cf(n)))}),setTimeout(function(){f.af()},0),f},Dp.prototype.ff=function(t){var e=fp[t];return this.lf+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Dp),dp=(Sp.prototype.Lu=function(t){this.If.push(t)},Sp.prototype._r=function(){window.removeEventListener("online",this.df),window.removeEventListener("offline",this.Tf)},Sp.prototype.mf=function(){window.addEventListener("online",this.df),window.addEventListener("offline",this.Tf)},Sp.prototype.wf=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(0)},Sp.prototype.Ef=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(1)},Sp.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Sp),yp=(_p.prototype.Lu=function(t){},_p.prototype._r=function(){},_p),vp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",gp=(Ap.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.Ll=this.Af(r),this.persistence=this.Rf(r),[4,this.persistence.start()];case 1:return t.sent(),this.Pf=this.gf(r),this.Fu=this.Vf(r),this.wu=this.yf(r),[4,this.pf(r)];case 2:return e=t.sent(),this.wu.start(e),this.Ol=this.bf(r),this.oc=this.vf(r),this.Sf=this.Df(r),this.Ll.Vu=function(t){return n.oc.vl(t,1)},this.Ol.oc=this.oc,[4,this.Ll.start()];case 3:return t.sent(),[4,this.Ol.start()];case 4:return t.sent(),[4,this.Ol.Pc(this.oc.Xl)];case 5:return t.sent(),[2]}})})},Ap.prototype.pf=function(t){return e=t.Cf,Promise.resolve(new pp(e));var e},Ap.prototype.Df=function(t){return new Hf(this.oc)},Ap.prototype.gf=function(t){return null},Ap.prototype.Vf=function(t){return cc(this.persistence,new Qf,t.$f)},Ap.prototype.Rf=function(t){if(t.Nf.Ff)throw new zr(Br.FAILED_PRECONDITION,vp);return new ap(cp.Z_)},Ap.prototype.yf=function(t){var e=vl(t.Cf.s),n=t.credentials;return new $l(n,e)},Ap.prototype.bf=function(t){var e=this;return new nf(this.Fu,this.wu,t.ao,function(t){return e.oc.vl(t,0)},new(dp.Oi()?dp:yp))},Ap.prototype.Af=function(t){return new Df},Ap.prototype.vf=function(t){return Gf(this.Fu,this.Ol,this.wu,this.Ll,t.$f,t.ql,!0)},Ap.prototype.clearPersistence=function(t,e){throw new zr(Br.FAILED_PRECONDITION,vp)},Ap),mp=(n(Np,op=gp),Np.prototype.Vf=function(t){return cc(this.persistence,new Qf,t.$f)},Np.prototype.gf=function(t){var e=this.persistence.ii.yr;return new ic(e,t.ao)},Np.prototype.Rf=function(t){var e=rh(t.Cf.s,t.Cf.persistenceKey),n=vl(t.Cf.s);return new Qa(t.Nf.synchronizeTabs,e,t.clientId,ec.Ho(t.Nf.cacheSizeBytes),t.ao,Kh(),"undefined"!=typeof document?document:null,n,this.Ll,t.Nf.Di)},Np.prototype.Af=function(t){return new Df},Np.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ph.Oi()?(e=n+"main",[4,Ph.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(rh(t,e))},n(Tp,ip=Np),Tp.prototype.initialize=function(e){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return[4,ip.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,l){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==l||!0===r.Jl?[3,3]:(e=r.Ll.Bc(),[4,Bf(r,e.$())]);case 1:return i=t.sent(),r.Jl=!0,[4,r.Ol.Pc(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Ol.listen(u);return[3,7];case 3:return!1!==l||!1===r.Jl?[3,7]:(a=[],h=Promise.resolve(),r.Wl.forEach(function(t,e){r.Ll.Jc(e)?a.push(e):h=h.then(function(){return r.n_(e),r.Fu.kh(e,!0)}),r.Ol.ic(e)}),[4,h]);case 4:return t.sent(),[4,Bf(r,a)];case 5:return t.sent(),(n=r).Kl.forEach(function(t,e){n.Ol.ic(e)}),n.Gl.Kh(),n.Kl=new Map,n.jl=new Ti(Jr.P),r.Jl=!1,[4,r.Ol.Pc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.oc,e)];case 1:return t.sent(),this.Pf&&(e&&!this.Pf.Hi?this.Pf.start(this.Fu):e||this.Pf.stop()),[2]}})})})];case 2:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Eh,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.Fu)];case 3:return t.sent(),[2]}})})},Tp.prototype.vf=function(t){var e=!t.Nf.Ff||!t.Nf.synchronizeTabs,n=Gf(this.Fu,this.Ol,this.wu,this.Ll,t.$f,t.ql,e);return this.Ll instanceof Sf&&(this.Ll.oc={cl:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).Zl("applyBatchState()"),[4,(e=o.Fu,n=a,i=(r=e).jn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.Ih.Jn(e,t):Ku.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.Ol.tc()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.h_(a,c||null),o.Fu.jn.Gr(a)):Ar(),t.label=4;case 4:return[4,o.i_(s)];case 5:return t.sent(),[3,7];case 6:Er("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,n),ll:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).Jl?(Er("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Wl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.Fu,e=r.Eh,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=Ki.Gt(u,"current"===a),[4,n.i_(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.Fu.kh(u,!0)];case 6:return t.sent(),n.n_(u,h),[3,8];case 7:Ar(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,n),_l:function(l,f,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=l).Jl)return[3,10];e=0,r=f,t.label=1;case 1:return e<r.length?(i=r[e],n.Wl.has(i)?(Er("SyncEngine","Adding an already active target "+i),[3,5]):[4,lc(n.Fu,i)]):[3,6];case 2:return o=t.sent(),[4,n.Fu.Nh(o)];case 3:return s=t.sent(),[4,n.t_(zf(o),s.targetId,!1)];case 4:t.sent(),n.Ol.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Wl.has(e)?[4,n.Fu.kh(e,!1).then(function(){n.Ol.ic(e),n.n_(e)}).catch(fc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,n),Ir:function(t){return t.Fu.persistence.Ir()}.bind(null,n)}),n},Tp.prototype.Af=function(t){if(t.Nf.Ff&&t.Nf.synchronizeTabs){var e=Kh();if(!Sf.Oi(e))throw new zr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=rh(t.Cf.s,t.Cf.persistenceKey);return new Sf(e,t.ao,n,t.clientId,t.$f)}return new Df},Tp),wp=(Ep.prototype.start=function(t,e,n){var r=this;this.kf(),this.Cf=t;var i=new ua,o=new ua,s=!1;return this.credentials.pa(function(t){if(!s)return s=!0,Er("FirestoreClient","Initializing. user=",t.uid),r.xf(e,n,t,o).then(i.resolve,i.reject);r.ao.er(function(){return r.Ol.Rc(t)})}),this.ao.Zi(function(){return i.promise}),o.promise},Ep.prototype.enableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.Ol.enableNetwork()})},Ep.prototype.xf=function(r,i,o,s){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r.initialize({ao:this.ao,Cf:this.Cf,clientId:this.clientId,credentials:this.credentials,$f:o,ql:100,Nf:i})];case 1:return t.sent(),this.persistence=r.persistence,this.Ll=r.Ll,this.Fu=r.Fu,this.Ol=r.Ol,this.oc=r.oc,this.Pf=r.Pf,this.Mf=r.Sf,this.persistence.Yi(function(){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,3];case 2:if(e=t.sent(),s.reject(e),!this.Of(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.xf(new gp,{Ff:!1},o,s))];case 3:return[2]}})})},Ep.prototype.Of=function(t){return"FirebaseError"===t.name?t.code===Br.FAILED_PRECONDITION||t.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ep.prototype.kf=function(){if(this.ao.yo)throw new zr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},Ep.prototype.disableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.Ol.disableNetwork()})},Ep.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Pf&&this.Pf.stop(),[4,this.Ol._r()];case 1:return t.sent(),[4,this.Ll._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.ba(),[2]}})})})},Ep.prototype.waitForPendingWrites=function(){var t=this;this.kf();var e=new ua;return this.ao.Zi(function(){return t.oc.u_(e)}),e.promise},Ep.prototype.listen=function(t,e,n){var r=this;this.kf();var i=new Xf(t,e,n);return this.ao.Zi(function(){return r.Mf.listen(i)}),i},Ep.prototype.ic=function(t){var e=this;this.Lf||this.ao.Zi(function(){return e.Mf.ic(t)})},Ep.prototype.qf=function(o){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return this.kf(),i=new ua,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Fu.Fh(o)];case 1:return(e=t.sent())instanceof Zs?i.resolve(e):e instanceof $s?i.resolve(null):i.reject(new zr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Jh(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Ep.prototype.Bf=function(a){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return this.kf(),u=new ua,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Fu.xh(a,!0)];case 1:return e=t.sent(),n=new xf(a,e.Mh),r=n.Rl(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Jh(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Ep.prototype.write=function(t){var e=this;this.kf();var n=new ua;return this.ao.Zi(function(){return e.oc.write(t,n)}),n.promise},Ep.prototype.s=function(){return this.Cf.s},Ep.prototype.R_=function(t){var e=this;this.kf(),this.ao.Zi(function(){return e.Mf.R_(t),Promise.resolve()})},Ep.prototype.P_=function(t){var e=this;this.Lf||this.ao.Zi(function(){return e.Mf.P_(t),Promise.resolve()})},Object.defineProperty(Ep.prototype,"Lf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Ep.prototype.transaction=function(t){var e=this;this.kf();var n=new ua;return this.ao.Zi(function(){return e.oc.runTransaction(e.ao,t,n),Promise.resolve()}),n.promise},Ep),bp=(Ip.prototype.next=function(t){this.Uf(this.observer.next,t)},Ip.prototype.error=function(t){this.Uf(this.observer.error,t)},Ip.prototype.Wf=function(){this.muted=!0},Ip.prototype.Uf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ip);function Ip(t){this.observer=t,this.muted=!1}function Ep(t,e){this.credentials=t,this.ao=e,this.clientId=Dr.t()}function Tp(){return null!==ip&&ip.apply(this,arguments)||this}function Np(){return null!==op&&op.apply(this,arguments)||this}function Ap(){}function _p(){}function Sp(){var t=this;this.df=function(){return t.wf()},this.Tf=function(){return t.Ef()},this.If=[],this.mf()}function Dp(t){this.s=t.s;var e=t.ssl?"https":"http";this.lf=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function xp(t){this.nf=t.nf,this.sf=t.sf}function kp(t){this.persistence=t,this.J_=new pc,this.X_=null}function Op(t){var e=this;return(e=sp.call(this)||this).vi=t,e}function Pp(t){var e=this;this.K_={},this.Ci=new Zu(0),this.$i=!1,this.$i=!0,this.ii=t(this),this.qi=new up(this),this.Kn=new da,this.Qn=new Jf(this.Kn,function(t){return e.ii.G_(t)})}function Lp(t){this.persistence=t,this.U_=new Gr(li,fi),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.W_=0,this.Q_=new pc,this.targetCount=0,this.j_=Ma.ni()}function Rp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Cp=(qp.prototype.Kf=function(t){switch(ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return vo(t.integerValue||t.doubleValue);case 3:return this.Gf(t.timestampValue);case 4:return this.zf(t);case 5:return t.stringValue;case 6:return new jc(go(t.bytesValue));case 7:return this.Hf(t.referenceValue);case 8:return this.Yf(t.geoPointValue);case 9:return this.Jf(t.arrayValue);case 10:return this.Xf(t.mapValue);default:throw Ar()}},qp.prototype.Xf=function(t){var n=this,r={};return Fr(t.fields||{},function(t,e){r[t]=n.Kf(e)}),r},qp.prototype.Yf=function(t){return new al(vo(t.latitude),vo(t.longitude))},qp.prototype.Jf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Kf(t)})},qp.prototype.zf=function(t){switch(this.Qf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return oo(n)?t(n):n}(t);return null==e?null:this.Kf(e);case"estimate":return this.Gf(so(t));default:return null}},qp.prototype.Gf=function(t){var e=yo(t),n=new Wr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},qp.prototype.Hf=function(t){var e=Xr.N(t);_r(Yo(e));var n=new Rr(e.get(1),e.get(3)),r=new Jr(e.V(5));return n.isEqual(this.s)||Tr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.jf(r)},qp),Vp=ec.Xo,Fp=(jp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},jp),Up=(Object.defineProperty(Mp.prototype,"ud",{get:function(){return this.ld||(this.ld=new Al(this.aa,this.ad.ignoreUndefinedProperties)),this.ld},enumerable:!1,configurable:!0}),Mp.prototype.settings=function(t){mc("Firestore.settings",arguments,1),Ic("Firestore.settings","object",1,t);var e=new Fp(t);if(this.nd&&!this.ad.isEqual(e))throw new zr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ad=e).credentials&&(this.od=function(t){if(!t)return new Kl;switch(t.type){case"gapi":var e=t._d;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ql(e,t.Fa||"0");case"provider":return t._d;default:throw new zr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Mp.prototype.enableNetwork=function(){return this.ed(),this.nd.enableNetwork()},Mp.prototype.disableNetwork=function(){return this.ed(),this.nd.disableNetwork()},Mp.prototype.enablePersistence=function(t){var e,n;if(this.nd)throw new zr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Tr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new zr(Br.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.fd(this.hd,{Ff:!0,cacheSizeBytes:this.ad.cacheSizeBytes,synchronizeTabs:r,Di:i})},Mp.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.nd&&!this.nd.Lf)throw new zr(Br.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ua,[2,(this.td.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.aa,this.rd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Mp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Mp.prototype,"dd",{get:function(){return this.ed(),this.nd.Lf},enumerable:!1,configurable:!0}),Mp.prototype.waitForPendingWrites=function(){return this.ed(),this.nd.waitForPendingWrites()},Mp.prototype.onSnapshotsInSync=function(t){if(this.ed(),Rp(t))return Gp(this.nd,t);Ic("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Gp(this.nd,e)},Mp.prototype.ed=function(){return this.nd||this.fd(new gp,{Ff:!1}),this.nd},Mp.prototype.wd=function(){return new Lr(this.aa,this.rd,this.ad.host,this.ad.ssl,this.ad.forceLongPolling)},Mp.prototype.fd=function(t,e){var n=this.wd();return this.nd=new wp(this.od,this.td),this.nd.start(n,t,e)},Mp.sd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new zr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new zr(Br.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Rr(n)},Object.defineProperty(Mp.prototype,"app",{get:function(){if(!this.Zf)throw new zr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zf},enumerable:!1,configurable:!0}),Mp.prototype.collection=function(t){return mc("Firestore.collection",arguments,1),Ic("Firestore.collection","non-empty string",1,t),this.ed(),new pd(Xr.N(t),this,null)},Mp.prototype.doc=function(t){return mc("Firestore.doc",arguments,1),Ic("Firestore.doc","non-empty string",1,t),this.ed(),Kp.Td(Xr.N(t),this,null)},Mp.prototype.collectionGroup=function(t){if(mc("Firestore.collectionGroup",arguments,1),Ic("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ed(),new ad((e=t,new ou(Xr.k(),e)),this,null);var e},Mp.prototype.runTransaction=function(e){var n=this;return mc("Firestore.runTransaction",arguments,1),Ic("Firestore.runTransaction","function",1,e),this.ed().transaction(function(t){return e(new zp(n,t))})},Mp.prototype.batch=function(){return this.ed(),new Wp(this)},Object.defineProperty(Mp,"logLevel",{get:function(){switch(Ir()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Mp.setLogLevel=function(t){mc("Firestore.setLogLevel",arguments,1),_c("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),br.setLogLevel(t)},Mp.prototype.Ed=function(){return this.ad.timestampsInSnapshots},Mp);function Mp(t,e,n){var r=this;if(void 0===n&&(n=new gp),this.Zf=null,this.td=new Xh,this.INTERNAL={delete:function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ed(),[4,this.nd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Zf=i,this.aa=Mp.sd(i),this.rd=i.name,this.od=new Hl(e)}else{var o=t;if(!o.projectId)throw new zr(Br.INVALID_ARGUMENT,"Must provide projectId");this.aa=new Rr(o.projectId,o.database),this.rd="[DEFAULT]",this.od=new Kl}this.hd=n,this.ad=new Fp({})}function jp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new zr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Tc("settings","non-empty string","host",t.host),this.host=t.host,Nc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Oc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Nc("settings","object","credentials",t.credentials),this.credentials=t.credentials,Nc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Nc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Tr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Tr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Nc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ec.th;else{if(t.cacheSizeBytes!==Vp&&t.cacheSizeBytes<ec.Zo)throw new zr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ec.Zo);this.cacheSizeBytes=t.cacheSizeBytes}Nc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function qp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Qf=n,this.jf=r}function Gp(t,e){var n=new bp({next:function(){e.next&&e.next()},error:function(t){throw Ar()}});return t.R_(n),function(){n.Wf(),t.P_(n)}}var Bp,zp=(Qp.prototype.get=function(t){var n=this;mc("Transaction.get",arguments,1);var r=wd("Transaction.get",t,this.Id);return this.md.Au([r.ua]).then(function(t){if(!t||1!==t.length)return Ar();var e=t[0];if(e instanceof $s)return new $p(n.Id,r.ua,null,!1,!1,r.ca);if(e instanceof Zs)return new $p(n.Id,r.ua,e,!1,!1,r.ca);throw Ar()})},Qp.prototype.set=function(t,e,n){bc("Transaction.set",arguments,2,3);var r=wd("Transaction.set",t,this.Id);n=vd("Transaction.set",n);var i=bd(r.ca,e,n),o=Dl(this.Id.ud,"Transaction.set",r.ua,i,null!==r.ca,n);return this.md.set(r.ua,o),this},Qp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Gc?(wc("Transaction.update",arguments,3),r=wd("Transaction.update",t,this.Id),kl(this.Id.ud,"Transaction.update",r.ua,e,n,o)):(mc("Transaction.update",arguments,2),r=wd("Transaction.update",t,this.Id),xl(this.Id.ud,"Transaction.update",r.ua,e)),this.md.update(r.ua,i),this},Qp.prototype.delete=function(t){mc("Transaction.delete",arguments,1);var e=wd("Transaction.delete",t,this.Id);return this.md.delete(e.ua),this},Qp),Wp=(Xp.prototype.set=function(t,e,n){bc("WriteBatch.set",arguments,2,3),this.Pd();var r=wd("WriteBatch.set",t,this.Id);n=vd("WriteBatch.set",n);var i=bd(r.ca,e,n),o=Dl(this.Id.ud,"WriteBatch.set",r.ua,i,null!==r.ca,n);return this.Ad=this.Ad.concat(o.la(r.ua,ws.We())),this},Xp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pd(),i="string"==typeof e||e instanceof Gc?(wc("WriteBatch.update",arguments,3),r=wd("WriteBatch.update",t,this.Id),kl(this.Id.ud,"WriteBatch.update",r.ua,e,n,o)):(mc("WriteBatch.update",arguments,2),r=wd("WriteBatch.update",t,this.Id),xl(this.Id.ud,"WriteBatch.update",r.ua,e)),this.Ad=this.Ad.concat(i.la(r.ua,ws.exists(!0))),this},Xp.prototype.delete=function(t){mc("WriteBatch.delete",arguments,1),this.Pd();var e=wd("WriteBatch.delete",t,this.Id);return this.Ad=this.Ad.concat(new Ms(e.ua,ws.We())),this},Xp.prototype.commit=function(){return this.Pd(),this.Rd=!0,0<this.Ad.length?this.Id.ed().write(this.Ad):Promise.resolve()},Xp.prototype.Pd=function(){if(this.Rd)throw new zr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Xp),Kp=(n(Hp,Bp=ml),Hp.Td=function(t,e,n){if(t.length%2!=0)throw new zr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new Hp(new Jr(t),e,n)},Object.defineProperty(Hp.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Hp.prototype,"parent",{get:function(){return new pd(this.ua.path.p(),this.firestore,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(Hp.prototype,"path",{get:function(){return this.ua.path.F()},enumerable:!1,configurable:!0}),Hp.prototype.collection=function(t){if(mc("DocumentReference.collection",arguments,1),Ic("DocumentReference.collection","non-empty string",1,t),!t)throw new zr(Br.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Xr.N(t);return new pd(this.ua.path.child(e),this.firestore,null)},Hp.prototype.isEqual=function(t){if(!(t instanceof Hp))throw Pc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ua.isEqual(t.ua)&&this.ca===t.ca},Hp.prototype.set=function(t,e){bc("DocumentReference.set",arguments,1,2),e=vd("DocumentReference.set",e);var n=bd(this.ca,t,e),r=Dl(this.firestore.ud,"DocumentReference.set",this.ua,n,null!==this.ca,e);return this.nd.write(r.la(this.ua,ws.We()))},Hp.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Gc?(wc("DocumentReference.update",arguments,2),kl(this.firestore.ud,"DocumentReference.update",this.ua,t,e,r)):(mc("DocumentReference.update",arguments,1),xl(this.firestore.ud,"DocumentReference.update",this.ua,t)),this.nd.write(n.la(this.ua,ws.exists(!0)))},Hp.prototype.delete=function(){return mc("DocumentReference.delete",arguments,0),this.nd.write([new Ms(this.ua,ws.We())])},Hp.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];bc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Rp(i[u])||(Oc("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Nc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};Rp(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Ic("DocumentReference.onSnapshot","function",u,i[u]),Ec("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ec("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.gd(t))},error:i[u+1],complete:i[u+2]};return Yp(this.nd,this.ua,h,c)},Hp.prototype.get=function(t){var e,n,r,i,o,s=this;return bc("DocumentReference.get",arguments,0,1),md("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.ed().qf(this.ua).then(function(t){return new $p(s.firestore,s.ua,t,!0,t instanceof Zs&&t.Ke,s.ca)}):(e=this.nd,n=this.ua,r=t,i=new ua,o=Yp(e,n,{includeMetadataChanges:!0,S_:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new zr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new zr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.gd(t)}))},Hp.prototype.withConverter=function(t){return new Hp(this.ua,this.firestore,t)},Hp.prototype.gd=function(t){var e=t.docs.get(this.ua);return new $p(this.firestore,this.ua,e,t.fromCache,t.hasPendingWrites,this.ca)},Hp);function Hp(t,e,n){var r=this;return(r=Bp.call(this,e.aa,t,n)||this).ua=t,r.firestore=e,r.ca=n,r.nd=r.firestore.ed(),r}function Xp(t){this.Id=t,this.Ad=[],this.Rd=!1}function Qp(t,e){this.Id=t,this.md=e}function Yp(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new bp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(au(e.path),o,n);return function(){o.Wf(),t.ic(s)}}var Jp,Zp=(rd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},rd),$p=(nd.prototype.data=function(t){var e=this;if(bc("DocumentSnapshot.data",arguments,0,1),t=gd("DocumentSnapshot.data",t),this.Vd){if(this.ca){var n=new td(this.Id,this.ua,this.Vd,this.yd,this.pd,null);return this.ca.fromFirestore(n,t)}return new Cp(this.Id.aa,this.Id.Ed(),t.serverTimestamps||"none",function(t){return new Kp(t,e.Id,null)}).Kf(this.Vd.Ze())}},nd.prototype.get=function(t,e){var n=this;if(bc("DocumentSnapshot.get",arguments,1,2),e=gd("DocumentSnapshot.get",e),this.Vd){var r=this.Vd.data().field(Vl("DocumentSnapshot.get",t,this.ua));if(null!==r)return new Cp(this.Id.aa,this.Id.Ed(),e.serverTimestamps||"none",function(t){return new Kp(t,n.Id,n.ca)}).Kf(r)}},Object.defineProperty(nd.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"ref",{get:function(){return new Kp(this.ua,this.Id,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"exists",{get:function(){return null!==this.Vd},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"metadata",{get:function(){return new Zp(this.pd,this.yd)},enumerable:!1,configurable:!0}),nd.prototype.isEqual=function(t){if(!(t instanceof nd))throw Pc("isEqual","DocumentSnapshot",1,t);return this.Id===t.Id&&this.yd===t.yd&&this.ua.isEqual(t.ua)&&(null===this.Vd?null===t.Vd:this.Vd.isEqual(t.Vd))&&this.ca===t.ca},nd),td=(n(ed,Jp=$p),ed.prototype.data=function(t){return Jp.prototype.data.call(this,t)},ed);function ed(){return null!==Jp&&Jp.apply(this,arguments)||this}function nd(t,e,n,r,i,o){this.Id=t,this.ua=e,this.Vd=n,this.yd=r,this.pd=i,this.ca=o}function rd(t,e){this.hasPendingWrites=t,this.fromCache=e}function id(t,e,n){if("string"==typeof n){if(""===n)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!hu(e)&&-1!==n.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Xr.N(n));if(!Jr.W(r))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return mo(t,new Jr(r))}if(n instanceof ml)return mo(t,n.ua);throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+xc(n)+".")}function od(t,e){if(!Array.isArray(t)||0===t.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function sd(t,e,n){if(!n.isEqual(e))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ud(t){if(t.an()&&0===t.tn.length)throw new zr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ad=(hd.prototype.where=function(t,e,n){mc("Query.where",arguments,3),kc("Query.where",3,n);var r,i,o=_c("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Vl("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.O()){if("array-contains"===i||"array-contains-any"===i)throw new zr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){od(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(id(n,t,c))}s={arrayValue:{values:u}}}else s=id(n,t,o)}else"in"!==i&&"array-contains-any"!==i||od(o,i),s=Ol(e,"Query.where",o,"in"===i);var l=Iu.create(r,i,s);return function(t,e){if(e instanceof Iu){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&sd(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new zr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new zr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}}(t,l),l}(this.bd,this.firestore.ud,this.firestore.aa,s,o,n);return new hd((i=(r=this.bd).filters.concat([u]),new ou(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},hd.prototype.orderBy=function(t,e){var n;if(bc("Query.orderBy",arguments,1,2),Ec("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new zr(Br.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Vl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new Gu(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&sd(0,o,i.field),s}(this.bd,o,n);return new hd((i=(r=this.bd).tn.concat([s]),new ou(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},hd.prototype.limit=function(t){return mc("Query.limit",arguments,1),Ic("Query.limit","number",1,t),Lc("Query.limit",1,t),new hd(fu(this.bd,t,"F"),this.firestore,this.ca)},hd.prototype.limitToLast=function(t){return mc("Query.limitToLast",arguments,1),Ic("Query.limitToLast","number",1,t),Lc("Query.limitToLast",1,t),new hd(fu(this.bd,t,"L"),this.firestore,this.ca)},hd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wc("Query.startAt",arguments,1);var r=this.vd("Query.startAt",t,e,!0);return new hd(pu(this.bd,r),this.firestore,this.ca)},hd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wc("Query.startAfter",arguments,1);var r=this.vd("Query.startAfter",t,e,!1);return new hd(pu(this.bd,r),this.firestore,this.ca)},hd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wc("Query.endBefore",arguments,1);var r=this.vd("Query.endBefore",t,e,!0);return new hd(du(this.bd,r),this.firestore,this.ca)},hd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];wc("Query.endAt",arguments,1);var r=this.vd("Query.endAt",t,e,!1);return new hd(du(this.bd,r),this.firestore,this.ca)},hd.prototype.isEqual=function(t){if(!(t instanceof hd))throw Pc("isEqual","Query",1,t);return this.firestore===t.firestore&&yu(this.bd,t.bd)&&this.ca===t.ca},hd.prototype.withConverter=function(t){return new hd(this.bd,this.firestore,t)},hd.prototype.vd=function(c,t,e,n){if(kc(c,1,t),t instanceof $p)return mc(c,d([t],e),1),function(t,e,n,r){if(!n)throw new zr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=cu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(mo(e,n.key));else{var a=n.field(u.field);if(oo(a))throw new zr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.F();throw new zr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Lu(i,r)}(this.bd,this.firestore.aa,t.Vd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new zr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new zr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!hu(t)&&-1!==h.indexOf("/"))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Xr.N(h));if(!Jr.W(c))throw new zr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Jr(c);u.push(mo(e,l))}else{var f=Ol(n,r,h);u.push(f)}}return new Lu(u,o)}(this.bd,this.firestore.aa,this.firestore.ud,c,r,n)},hd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];bc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Rp(i[a])||(Oc("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Nc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Rp(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Ic("Query.onSnapshot","function",a,i[a]),Ec("Query.onSnapshot","function",a+1,i[a+1]),Ec("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new fd(r.firestore,r.bd,t,r.ca))},error:i[a+1],complete:i[a+2]};return ud(this.bd),cd(this.firestore.ed(),this.bd,u,h)},hd.prototype.get=function(t){var e=this;bc("Query.get",arguments,0,1),md("Query.get",t),ud(this.bd);var n,r,i,o,s,u=this.firestore.ed();return(t&&"cache"===t.source?u.Bf(this.bd):(n=u,r=this.bd,i=t,o=new ua,s=cd(n,r,{includeMetadataChanges:!0,S_:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new zr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new fd(e.firestore,e.bd,t,e.ca)})},hd);function hd(t,e,n){this.bd=t,this.firestore=e,this.ca=n}function cd(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new bp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Wf(),t.ic(s)}}var ld,fd=(Object.defineProperty(yd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"empty",{get:function(){return this.Dd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"size",{get:function(){return this.Dd.docs.size},enumerable:!1,configurable:!0}),yd.prototype.forEach=function(e,n){var r=this;bc("QuerySnapshot.forEach",arguments,1,2),Ic("QuerySnapshot.forEach","function",1,e),this.Dd.docs.forEach(function(t){e.call(n,r.Fd(t,r.metadata.fromCache,r.Dd.Lt.has(t.key)))})},Object.defineProperty(yd.prototype,"query",{get:function(){return new ad(this.Sd,this.Id,this.ca)},enumerable:!1,configurable:!0}),yd.prototype.docChanges=function(t){t&&(Oc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Nc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Dd.Bt)throw new zr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Cd&&this.$d===e||(this.Cd=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ar()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Dd,e,this.Fd.bind(this)),this.$d=e),this.Cd},yd.prototype.isEqual=function(t){if(!(t instanceof yd))throw Pc("isEqual","QuerySnapshot",1,t);return this.Id===t.Id&&yu(this.Sd,t.Sd)&&this.Dd.isEqual(t.Dd)&&this.ca===t.ca},yd.prototype.Fd=function(t,e,n){return new td(this.Id,t.key,t,e,n,this.ca)},yd),pd=(n(dd,ld=ad),Object.defineProperty(dd.prototype,"id",{get:function(){return this.bd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"parent",{get:function(){var t=this.bd.path.p();return t._()?null:new Kp(new Jr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"path",{get:function(){return this.bd.path.F()},enumerable:!1,configurable:!0}),dd.prototype.doc=function(t){bc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Dr.t()),Ic("CollectionReference.doc","non-empty string",1,t);var e=Xr.N(t);return Kp.Td(this.bd.path.child(e),this.firestore,this.ca)},dd.prototype.add=function(t){mc("CollectionReference.add",arguments,1),Ic("CollectionReference.add","object",1,this.ca?this.ca.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},dd.prototype.withConverter=function(t){return new dd(this.Nd,this.firestore,t)},dd);function dd(t,e,n){var r=this;if(((r=ld.call(this,au(t),e,n)||this).Nd=t).length%2!=1)throw new zr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function yd(t,e,n,r){this.Id=t,this.Sd=e,this.Dd=n,this.ca=r,this.Cd=null,this.$d=null,this.metadata=new Zp(n.hasPendingWrites,n.fromCache)}function vd(t,e){if(void 0===e)return{merge:!1};if(Oc(t,e,["merge","mergeFields"]),Nc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+xc(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Gc))throw new zr(Br.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+xc(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new zr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function gd(t,e){return void 0===e?{}:(Oc(t,e,["serverTimestamps"]),Ac(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function md(t,e){Ec(t,"object",1,e),e&&(Oc(t,e,["source"]),Ac(t,0,"source",e.source,["default","server","cache"]))}function wd(t,e,n){if(e instanceof ml){if(e.firestore!==n)throw new zr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Pc(t,"DocumentReference",1,e)}function bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Id,Ed={Firestore:Up,GeoPoint:al,Timestamp:Wr,Blob:jc,Transaction:zp,WriteBatch:Wp,DocumentReference:Kp,DocumentSnapshot:$p,Query:ad,QueryDocumentSnapshot:td,QuerySnapshot:fd,CollectionReference:pd,FieldPath:Gc,FieldValue:sl,setLogLevel:Up.setLogLevel,CACHE_SIZE_UNLIMITED:Vp};(Id=Td).INTERNAL.registerComponent(new gr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Up(e,n,new mp);var e,n},"PUBLIC").setServiceProps(Object.assign({},Ed))),Id.registerVersion("@firebase/firestore","1.16.2-20206244562")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});