!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Kd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,l,n,r=t(Kd),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(n=l=l||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((e={})[l.DEBUG]="log",e[l.VERBOSE]="log",e[l.INFO]="info",e[l.WARN]="warn",e[l.ERROR]="error",e),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,m="FirebaseError",b=(o(E,v=Error),E);function E(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=m,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(N,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var N=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={},R=D||self;function L(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function G(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++V))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(t){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Y(t){return/^[\s\xa0]*$/.test(t)}var X,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Z(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var $=R.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e={};for(var n in t)e[n]=t[n];return e}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=L;var st,ut,at=Z(X,"Opera"),ct=Z(X,"Trident")||Z(X,"MSIE"),ht=Z(X,"Edge"),ft=ht||ct,lt=Z(X,"Gecko")&&!(Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge"))&&!(Z(X,"Trident")||Z(X,"MSIE"))&&!Z(X,"Edge"),pt=Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge");function dt(){var t=R.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,lt?/rv:([^\);]+)(\)|;)/.exec(ut):ht?/Edge\/([\d\.]+)/.exec(ut):ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ct){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt={};function wt(u){return t=u,e=function(){for(var t=0,e=Q(String(st)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=mt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var bt=R.document&&ct?dt()||(parseInt(st,10)||void 0):void 0,Et=!ct||9<=Number(bt),It=ct&&!wt("9"),Tt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",L,e),R.removeEventListener("test",L,e)}catch(t){}return t}();function Nt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(Nt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Nt.prototype.b=function(){this.defaultPrevented=!0},G(_t,Nt);var At={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var St="closure_listenable_"+(1e6*Math.random()|0),Dt=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Dt,this.Y=this.Z=!1}function Rt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Lt(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=z(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Ct={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=zt(r);return e&&e[St]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Ut(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=zt(n),t&&t[St]?t.va(e,n,P(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!Et)return null;var u,a,c=Gt(t);if(c||(t[Pt]=c=new Lt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=Et?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ft(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[St]?xt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ft(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Gt(e))?(xt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Rt(t)))}function Ft(t){return t in Ct?Ct[t]:Ct[t]="on"+t}function qt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Mt(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(Et)return qt(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return qt(t,e=new _t(e,this))}function Gt(t){return(t=t[Pt])instanceof Lt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==x(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function Ht(){B.call(this),this.c=new Lt(this),(this.J=this).C=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&xt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}G(Ht,B),Ht.prototype[St]=!0,(S=Ht.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=zt(r),e&&e[St]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Gt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Nt(t,n):t instanceof Nt?t.target=t.target||n:(s=t,it(t=new Nt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Wt(o,r,!0,t)&&s;if(s=Wt(o=t.a=n,r,!0,t)&&s,s=Wt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Wt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Ht.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=R.JSON.stringify;function Yt(){this.b=this.a=null}var Xt,Qt=(Zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Zt(function(){return new Jt},function(t){t.reset()},100));function Zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function $t(t,e){var n;Xt||(n=R.Promise.resolve(void 0),Xt=function(){n.then(ne)}),te||(Xt(),te=!0),ee.add(t,e)}Yt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Yt;function ne(){for(var t,e,n;n=e=void 0,n=null,(e=ee).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}te=!1}function re(t,e){Ht.call(this),this.b=t||1,this.a=e||R,this.f=F(this.Ya,this),this.g=j()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function oe(t,e,n){if("function"==x(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}G(re,Ht),(S=re.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},S.G=function(){re.S.G.call(this),ie(this),delete this.a};var se,ue,ae,ce=(_(ue=fe,ae=se=B),ue.prototype=null===ae?Object.create(ae):(he.prototype=ae.prototype,new he),fe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=oe(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},fe.prototype.G=function(){se.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},fe);function he(){this.constructor=ue}function fe(t,e,n){var r=se.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function le(t){B.call(this),this.b=t,this.a={}}G(le,B);var pe=[];function de(t,e,n,r){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ye(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ve(){this.a=!0}function ge(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}le.prototype.G=function(){le.S.G.call(this),ye(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var me=null;function we(){return me=me||new Ht}function be(t){Nt.call(this,"serverreachability",t)}function Ee(t){var e=we();e.dispatchEvent(new be(e))}function Ie(t){Nt.call(this,"statevent",t)}function Te(t){var e=we();e.dispatchEvent(new Ie(e))}function Ne(t){Nt.call(this,"timingevent",t)}function _e(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}G(be,Nt),G(Ie,Nt),G(Ne,Nt);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Se={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function De(){}function ke(t){var e;return(e=t.a)||(e=t.a={}),e}function Re(){}De.prototype.a=null;var Le,xe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){Nt.call(this,"d")}function Pe(){Nt.call(this,"c")}function Ce(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new le(this),this.P=Ue,t=ft?125:void 0,this.R=new re(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}G(Oe,Nt),G(Pe,Nt),G(Ce,De),Le=new Ce;var Ue=45e3,Me={},Fe={};function qe(t,e,n){t.H=1,t.i=an(en(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Be(t),t.l=en(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ce(F(t.Ca,t,t.a),t.O)),de(t.J,t.a,"readystatechange",t.Wa),e=t.B?nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ge(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Fe:(o=Number(i.substring(o,s)),isNaN(o)?Me:(s+=1)+o>i.length?Fe:(i=i.substr(s,o),r.D=s+o,i)));if(a==Fe){4==e&&(t.h=4,Te(14),u=!1),ge(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,Te(15),ge(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ge(t.c,t.f,a,null),Ye(t,a)}4==e&&0==n.length&&(t.h=1,Te(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0)):(ge(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),We(t))}function Be(t){t.U=j()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(F(t.Ua,t),e)}function He(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||cr(t.g,t)}function Ke(t){He(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),ye(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ye(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Dn(p.b,t)))if(p.I=t.N,!t.C&&Dn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ar(p),Zn(p)}or(p),Te(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=_e(F(p.Ra,p),6e3));if(Sn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else fr(p,11)}else if(!t.C&&p.a!=t||ar(p),!Y(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Z(u,"spdy")||Z(u,"quic")||Z(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(kn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,un(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=pr(o,o.C?o.ga:null,o.fa),h.C?(Rn(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(He(f),Be(f)),o.a=h):ir(o),0<p.g.length&&tr(p)):"stop"!=y[0]&&"close"!=y[0]||fr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?fr(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}Ee(4)}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)H(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ve.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Wn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Wn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ft&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||r<=0?3:2),He(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,c=this.c,h=this.m,f=this.l,l=this.f,p=this.T,d=e,y=i,c.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+p+"]: "+h+"\n"+f+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Te(12),Ke(this),We(this);break t}ge(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ye(this,a)}this.I?(Ge(this,e,o),ft&&this.b&&3==e&&(de(this.J,this.R,"tick",this.Va),this.R.start())):(ge(this.c,this.f,o,null),Ye(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?cr(this.g,this):(this.b=!1,Be(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Te(12)):(this.h=0,Te(13)),Ke(this),We(this)}}}catch(t){}var c,h,f,l,p,d,y},S.Va=function(){var t,e;this.a&&(t=Wn(this.a),e=this.a.$(),this.D<e.length&&(He(this),Ge(this,t,e),this.b&&4!=t&&Be(this)))},S.cancel=function(){this.A=!0,Ke(this)},S.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(Ee(3),Te(17)),Ke(this),this.h=2,We(this)):ze(this,this.U-n)},(S=Qe.prototype).K=function(){Ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Ze(this),this.a.concat()},S.get=function(t,e){return Je(this.b,t)?this.b[t]:e},S.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn?(this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b,(n=new gn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),sn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=cn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=cn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=cn(n[7]||"")):(this.a=!!e,this.b=new gn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?cn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?cn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){var r,i;e instanceof gn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(mn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},r)),r.f=i):(n||(e=hn(e,yn)),t.b=new gn(e,t.a))}function un(t,e,n){t.b.set(e,n)}function an(t){return un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function cn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,fn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function fn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,vn)),t.join("")};var ln=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ze(t)))}function bn(t,e){return mn(t),e=In(t,e),Je(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),K(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Tn(t,e){this.b=t,this.a=e}function Nn(t){this.g=t||_n,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){mn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){mn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){mn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=W(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},S.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var _n=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Sn(t){return t.b?1:t.a?t.a.size:0}function Dn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function kn(t,e){t.a?t.a.add(e):t.b=e}function Rn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function On(){this.a=new xn}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Nn.prototype.cancel=function(){var e,t;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Cn=R.JSON.parse;function Vn(t){Ht.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}G(Vn,Ht);var Un="",Mn=/^https?$/i,Fn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Gn(t),zn(t)}function Gn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Bn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=Wn(t)||2!=t.X()))if(t.l&&4==Wn(t))oe(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Wn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Wn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Gn(t)}}finally{zn(t)}}}function zn(t,e){if(t.a){Hn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Hn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Wn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",et(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):un(t,e,n))}function Yn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Yn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Yn("baseRetryDelayMs",5e3,t),this.Ma=Yn("retryDelaySeedMs",1e4,t),this.Ja=Yn("forwardChannelMaxRetries",2,t),this.ma=Yn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Nn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,un(n=en(t.B),"SID",t.J),un(n,"RID",e),un(n,"TYPE","terminate"),nr(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=an(en(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.i.toString(),"")),!n&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=j(),Be(e)),lr(t)}function Zn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Jn(t){Zn(t),t.j&&(R.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new Tn(t.La++,e)),3==t.v&&tr(t)}function tr(t){An(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function er(t,e){var n=e?e.f:t.R++,r=en(t.B);un(r,"SID",t.J),un(r,"RID",n),un(r,"AID",t.P),nr(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),kn(t.b,n),qe(n,r,e)}function nr(t,n){t.f&&Xe({},function(t,e){un(n,e,t)})}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?F(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Xe(t,function(t,e){var n=t;P(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=_e(F(t.Aa,t),hr(t,t.o)),t.o++,1)}function sr(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);un(e,"RID","rpc"),un(e,"SID",t.J),un(e,"CI",t.H?"0":"1"),un(e,"AID",t.P),nr(t,e),un(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(en(e)),n.j=null,n.I=!0,je(n,t)}function ar(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function cr(t,e){var n,r=null;if(t.a==e){ar(t),sr(t),t.a=null;var i=2}else{if(!Dn(t.b,e))return;r=e.s,Rn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=we()).dispatchEvent(new Ne(i)),tr(t)):ir(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Sn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=_e(F(t.Ba,t,e),hr(t,t.u)),t.u++,1}}(t,e)||2==i&&or(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:fr(t,5);break;case 4:fr(t,10);break;case 3:fr(t,6);break;default:fr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function fr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=F(t.Xa,t),n||(n=new tn("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||nn(n,"https"),an(n)),i=n.toString(),o=r,u=new ve,R.Image?((s=new Image).onload=q(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=q(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=q(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=q(Pn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Te(2),t.v=0,t.f&&t.f.ra(e),lr(t),Jn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof tn?en(r):new tn(r,void 0);return""!=h.c?(e&&rn(h,e+"."+h.c),on(h,h.h)):(i=R.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new tn(null,void 0),o&&nn(c,o),s&&rn(c,s),u&&on(c,u),a&&(c.g=a),h=c),t.W&&et(t.W,function(t,e){un(h,e,t)}),e=t.A,n=t.na,e&&n&&un(h,e,n),un(h,"VER",t.ha),nr(t,h),h}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function yr(){}function vr(){if(ct&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gr(t,e){Ht.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Y(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Y(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new br(this)}function mr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){Pe.call(this),this.status=1}function br(t){this.a=t}(S=Vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ke(this.H):ke(Le),this.a.onreadystatechange=F(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&Xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=qn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=z(Fn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Hn(this),0<this.o&&((this.D=(i=this.a,ct&&wt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.xa,this)):this.m=oe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},S.xa=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),zn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),zn(this,!0)),Vn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Bn(this):this.Ta())},S.Ta=function(){Bn(this)},S.X=function(){try{return 2<Wn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Xn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?it(r=nt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),un(i=en(this.B),"RID",t),un(i,"CVER",22),this.A&&un(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Kn(i,this.i,r),kn(this.b,n),this.Ga&&un(i,"TYPE","init"),this.da?(un(i,"$req",e),un(i,"SID","null"),n.V=!0,qe(n,i,null)):qe(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||An(this.b)||er(this))},S.Aa=function(){var t;this.j=null,ur(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(F(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Zn(this),ur(this))},S.Ra=function(){null!=this.m&&(this.m=null,Zn(this),or(this),Te(19))},S.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Te(2)):(this.c.info("Failed to ping google.com"),Te(1))},(S=yr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new gr(t,e)},G(gr,Ht),(S=gr.prototype).addEventListener=function(t,e,n,r){gr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){gr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Te(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pr(t,null,t.fa),tr(t)},S.close=function(){Qn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Kt(t),$n(this.a,e)):$n(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,gr.S.G.call(this)},G(mr,Oe),G(wr,Pe),G(br,yr),br.prototype.ta=function(){this.a.dispatchEvent("a")},br.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},br.prototype.ra=function(t){this.a.dispatchEvent(new wr)},br.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,gr.prototype.send=gr.prototype.Pa,gr.prototype.open=gr.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Se.COMPLETE="complete",(Re.EventType=xe).OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Ht.prototype.listen=Ht.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var Er={createWebChannelTransport:function(){return new vr},ErrorCode:Ae,EventType:Se,WebChannel:Re,XhrIo:Vn},Ir=Er.createWebChannelTransport,Tr=Er.ErrorCode,Nr=Er.EventType,_r=Er.WebChannel,Ar=Er.XhrIo,Sr=(Dr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Dr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Dr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Dr);function Dr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var kr="7.19.1-202072605451",Rr=new p("@firebase/firestore");function Lr(){return Rr.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.DEBUG&&(e=n.map(Cr),Rr.debug.apply(Rr,s(["Firestore ("+kr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.ERROR&&(e=n.map(Cr),Rr.error.apply(Rr,s(["Firestore ("+kr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.WARN&&(e=n.map(Cr),Rr.warn.apply(Rr,s(["Firestore ("+kr+"): "+t],e)))}function Cr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+kr+") INTERNAL ASSERTION FAILED: "+t;throw Or(e),new Error(e)}function Ur(t){t||Vr()}var Mr=(Fr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Fr);function Fr(){}function qr(t,e){return t<e?-1:e<t?1:0}function jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Gr(t){return t+"\0"}function Br(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var zr=(Object.defineProperty(Hr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return t instanceof Hr&&t.projectId===this.projectId&&t.database===this.database},Hr.prototype.o=function(t){return qr(this.projectId,t.projectId)||qr(this.database,t.database)},Hr);function Hr(t,e){this.projectId=t,this.database=e||"(default)"}function Wr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Kr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Yr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Xr,Qr,Zr,Jr=(yi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},yi.prototype.has=function(t){return void 0!==this.get(t)},yi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},yi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},yi.prototype.forEach=function(u){Kr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},yi.prototype._=function(){return Yr(this.l)},yi),$r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ti=(o(di,Zr=Error),di),ei=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.T=function(t){return this.seconds===t.seconds?qr(this.nanoseconds,t.nanoseconds):qr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ni=(li.I=function(t){return new li(t)},li.min=function(){return new li(new ei(0,0))},li.prototype.o=function(t){return this.timestamp.T(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.A=function(){return this.timestamp},li),ri=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.P(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},fi.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},fi.prototype.v=function(){return this.segments[this.offset]},fi.prototype.S=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype._=function(){return 0===this.length},fi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},fi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(o(hi,Qr=ri),hi.prototype.g=function(t,e,n){return new hi(t,e,n)},hi.prototype.F=function(){return this.N().join("/")},hi.prototype.toString=function(){return this.F()},hi.k=function(t){if(0<=t.indexOf("//"))throw new ti($r.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new hi(t.split("/").filter(function(t){return 0<t.length}))},hi.$=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(o(ci,Xr=ri),ci.prototype.g=function(t,e,n){return new ci(t,e,n)},ci.O=function(t){return oi.test(t)},ci.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ci.O(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.F()},ci.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},ci.L=function(){return new ci(["__name__"])},ci.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new ti($r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new ti($r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ti($r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new ti($r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.$=function(){return new ci([])},ci),ui=(ai.B=function(t){return new ai(ii.k(t))},ai.U=function(t){return new ai(ii.k(t).V(5))},ai.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.P(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.P=function(t,e){return ii.P(t.path,e.path)},ai.j=function(t){return t.length%2==0},ai.K=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==Xr&&Xr.apply(this,arguments)||this}function hi(){return null!==Qr&&Qr.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.R=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new ti($r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new ti($r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ti($r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new ti($r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t,e){var n=this;return(n=Zr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function yi(t,e){this.h=t,this.u=e,this.l={}}function vi(t){return null==t}function gi(t){return-0===t&&1/t==-1/0}function mi(t){return"number"==typeof t&&Number.isInteger(t)&&!gi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var wi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function bi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new wi(t,e,n,r,i,o,s)}function Ei(t){var e,n=t;return null===n.G&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+No(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),vi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=na(n.startAt)),n.endAt&&(e+="|ub:",e+=na(n.endAt)),n.G=e),n.G}function Ii(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!bo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ia(t.startAt,e.startAt)&&ia(t.endAt,e.endAt)}function Ti(t){return ui.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ni=(_i.fromBase64String=function(t){return new _i(atob(t))},_i.fromUint8Array=function(t){return new _i(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},_i.prototype.toBase64=function(){return t=this.H,btoa(t);var t},_i.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},_i.prototype.Y=function(){return 2*this.H.length},_i.prototype.o=function(t){return qr(this.H,t.H)},_i.prototype.isEqual=function(t){return this.H===t.H},_i);function _i(t){this.H=t}Ni.J=new Ni("");function Ai(t){this.count=t}var Si,Di,ki=(Ri.prototype.tt=function(t){return new Ri(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ri.prototype.et=function(t,e){return new Ri(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ri.prototype.nt=function(t){return new Ri(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Ri);function Ri(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=Ni.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Li(t){switch(t){case $r.OK:return Vr(),0;case $r.CANCELLED:case $r.UNKNOWN:case $r.DEADLINE_EXCEEDED:case $r.RESOURCE_EXHAUSTED:case $r.INTERNAL:case $r.UNAVAILABLE:case $r.UNAUTHENTICATED:return;case $r.INVALID_ARGUMENT:case $r.NOT_FOUND:case $r.ALREADY_EXISTS:case $r.PERMISSION_DENIED:case $r.FAILED_PRECONDITION:case $r.ABORTED:case $r.OUT_OF_RANGE:case $r.UNIMPLEMENTED:case $r.DATA_LOSS:return 1;default:return Vr(),0}}function xi(t){if(void 0===t)return Or("GRPC error has no .code"),$r.UNKNOWN;switch(t){case Si.OK:return $r.OK;case Si.CANCELLED:return $r.CANCELLED;case Si.UNKNOWN:return $r.UNKNOWN;case Si.DEADLINE_EXCEEDED:return $r.DEADLINE_EXCEEDED;case Si.RESOURCE_EXHAUSTED:return $r.RESOURCE_EXHAUSTED;case Si.INTERNAL:return $r.INTERNAL;case Si.UNAVAILABLE:return $r.UNAVAILABLE;case Si.UNAUTHENTICATED:return $r.UNAUTHENTICATED;case Si.INVALID_ARGUMENT:return $r.INVALID_ARGUMENT;case Si.NOT_FOUND:return $r.NOT_FOUND;case Si.ALREADY_EXISTS:return $r.ALREADY_EXISTS;case Si.PERMISSION_DENIED:return $r.PERMISSION_DENIED;case Si.FAILED_PRECONDITION:return $r.FAILED_PRECONDITION;case Si.ABORTED:return $r.ABORTED;case Si.OUT_OF_RANGE:return $r.OUT_OF_RANGE;case Si.UNIMPLEMENTED:return $r.UNIMPLEMENTED;case Si.DATA_LOSS:return $r.DATA_LOSS;default:return Vr()}}(Di=Si=Si||{})[Di.OK=0]="OK",Di[Di.CANCELLED=1]="CANCELLED",Di[Di.UNKNOWN=2]="UNKNOWN",Di[Di.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Di[Di.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Di[Di.NOT_FOUND=5]="NOT_FOUND",Di[Di.ALREADY_EXISTS=6]="ALREADY_EXISTS",Di[Di.PERMISSION_DENIED=7]="PERMISSION_DENIED",Di[Di.UNAUTHENTICATED=16]="UNAUTHENTICATED",Di[Di.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Di[Di.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Di[Di.ABORTED=10]="ABORTED",Di[Di.OUT_OF_RANGE=11]="OUT_OF_RANGE",Di[Di.UNIMPLEMENTED=12]="UNIMPLEMENTED",Di[Di.INTERNAL=13]="INTERNAL",Di[Di.UNAVAILABLE=14]="UNAVAILABLE",Di[Di.DATA_LOSS=15]="DATA_LOSS";var Oi=(Mi.prototype.st=function(t,e){return new Mi(this.P,this.root.st(t,e,this.P).copy(null,null,Ci.it,null,null))},Mi.prototype.remove=function(t){return new Mi(this.P,this.root.remove(t,this.P).copy(null,null,Ci.it,null,null))},Mi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Mi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Mi.prototype._=function(){return this.root._()},Object.defineProperty(Mi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Mi.prototype.rt=function(){return this.root.rt()},Mi.prototype.ot=function(){return this.root.ot()},Mi.prototype.ht=function(t){return this.root.ht(t)},Mi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Mi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Mi.prototype.at=function(t){return this.root.at(t)},Mi.prototype.ut=function(){return new Pi(this.root,null,this.P,!1)},Mi.prototype.ct=function(t){return new Pi(this.root,t,this.P,!1)},Mi.prototype.lt=function(){return new Pi(this.root,null,this.P,!0)},Mi.prototype._t=function(t){return new Pi(this.root,t,this.P,!0)},Mi),Pi=(Ui.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Ui.prototype.Tt=function(){return 0<this.dt.length},Ui.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Ui),Ci=(Vi.prototype.copy=function(t,e,n,r,i){return new Vi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Vi.prototype._=function(){return!1},Vi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Vi.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Vi.prototype.min=function(){return this.left._()?this:this.left.min()},Vi.prototype.rt=function(){return this.min().key},Vi.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Vi.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},Vi.prototype.At=function(){if(this.left._())return Vi.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.At(),null)).It()},Vi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.Pt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.gt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Vi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.At())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.It()},Vi.prototype.Rt=function(){return this.color},Vi.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},Vi.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},Vi.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},Vi.prototype.yt=function(){var t=this.copy(null,null,Vi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Vi.prototype.gt=function(){var t=this.copy(null,null,Vi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Vi.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Vi.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Vi.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Vr();if(this.right.Rt())throw Vr();var t=this.left.vt();if(t!==this.right.vt())throw Vr();return t+(this.Rt()?0:1)},Vi);function Vi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Vi.RED,this.left=null!=r?r:Vi.EMPTY,this.right=null!=i?i:Vi.EMPTY,this.size=this.left.size+1+this.right.size}function Ui(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Mi(t,e){this.P=t,this.root=e||Ci.EMPTY}function Fi(){this.size=0}Ci.EMPTY=null,Ci.RED=!0,Ci.it=!1,Ci.EMPTY=(Object.defineProperty(Fi.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Fi.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Fi.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Fi.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty(Fi.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Fi.prototype.copy=function(t,e,n,r,i){return this},Fi.prototype.st=function(t,e,n){return new Ci(t,e)},Fi.prototype.remove=function(t,e){return this},Fi.prototype._=function(){return!0},Fi.prototype.ht=function(t){return!1},Fi.prototype.at=function(t){return!1},Fi.prototype.rt=function(){return null},Fi.prototype.ot=function(){return null},Fi.prototype.Rt=function(){return!1},Fi.prototype.bt=function(){return!0},Fi.prototype.vt=function(){return 0},new Fi);var qi=(zi.prototype.has=function(t){return null!==this.data.get(t)},zi.prototype.first=function(){return this.data.rt()},zi.prototype.last=function(){return this.data.ot()},Object.defineProperty(zi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),zi.prototype.indexOf=function(t){return this.data.indexOf(t)},zi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},zi.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},zi.prototype.Dt=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},zi.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},zi.prototype.ut=function(){return new ji(this.data.ut())},zi.prototype.ct=function(t){return new ji(this.data.ct(t))},zi.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},zi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},zi.prototype._=function(){return this.data._()},zi.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},zi.prototype.isEqual=function(t){if(!(t instanceof zi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(0!==this.P(r,i))return!1}return!0},zi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},zi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},zi.prototype.copy=function(t){var e=new zi(this.P);return e.data=t,e},zi),ji=(Bi.prototype.wt=function(){return this.Ft.wt().key},Bi.prototype.Tt=function(){return this.Ft.Tt()},Bi),Gi=new Oi(ui.P);function Bi(t){this.Ft=t}function zi(t){this.P=t,this.data=new Oi(this.P)}var Hi=new Oi(ui.P);var Wi=new Oi(ui.P),Ki=new qi(ui.P);function Yi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ki,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Xi=new qi(qr);function Qi(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r}function Zi(t,e){this.targetId=t,this.ne=e}function Ji(t,e,n,r){void 0===n&&(n=Ni.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var $i=(lo.xt=function(t){return new lo(t.P)},lo.prototype.has=function(t){return null!=this.kt.get(t)},lo.prototype.get=function(t){return this.kt.get(t)},lo.prototype.first=function(){return this.$t.rt()},lo.prototype.last=function(){return this.$t.ot()},lo.prototype._=function(){return this.$t._()},lo.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(lo.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),lo.prototype.forEach=function(n){this.$t.ht(function(t,e){return n(t),!1})},lo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},lo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},lo.prototype.isEqual=function(t){if(!(t instanceof lo))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.ut(),n=t.$t.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(!r.isEqual(i))return!1}return!0},lo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},lo.prototype.copy=function(t,e){var n=new lo;return n.P=this.P,n.kt=t,n.$t=e,n},lo),to=(fo.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);!n||0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):Vr()},fo.prototype.Mt=function(){var n=[];return this.Ot.ht(function(t,e){n.push(e)}),n},fo),eo=(ho.Qt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ho(t,e,$i.xt(e),i,n,r,!0,!1)},Object.defineProperty(ho.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),ho.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&_u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ho),no=(co.zt=function(t,e){var n=new Map;return n.set(t,ro.Ht(t,e)),new co(ni.min(),n,Xi,Gi,Yi())},co),ro=(ao.Ht=function(t,e){return new ao(Ni.J,e,Yi(),Yi(),Yi())},ao),io=(Object.defineProperty(uo.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),uo.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},uo.prototype.le=function(){var n=Yi(),r=Yi(),i=Yi();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new ro(this.re,this.oe,n,r,i)},uo.prototype._e=function(){this.he=!1,this.ie=yo()},uo.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},uo.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},uo.prototype.we=function(){this.se+=1},uo.prototype.Te=function(){--this.se},uo.prototype.Ee=function(){this.he=!0,this.oe=!0},uo),oo=(so.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof au?this.Ve(r,t.ee):t.ee instanceof cu&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},so.prototype.pe=function(n){var r=this;this.be(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.Se(t)&&e.ce(n.resumeToken);break;case 1:e.Te(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.Te(),e.ae||r.removeTarget(t);break;case 3:r.Se(t)&&(e.Ee(),e.ce(n.resumeToken));break;case 4:r.Se(t)&&(r.De(t),e.ce(n.resumeToken));break;default:Vr()}})},so.prototype.be=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.Se(e)&&n(e)})},so.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ne.count,o=this.Ne(r);o&&(Ti(e=o.target)?0===i?(n=new ui(e.path),this.ye(r,n,new cu(n,ni.min()))):Ur(1===i):this.Fe(r)!==i&&(this.De(r),this.Pe=this.Pe.add(r)))},so.prototype.ke=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.Ne(e);r&&(t.Yt&&Ti(r.target)&&(n=new ui(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ye(e,n,new cu(n,i))),t.ue&&(s.set(e,t.le()),t._e()))});var r=Yi();this.Re.forEach(function(t,e){var n=!0;e.Dt(function(t){var e=o.Ne(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new no(i,s,this.Pe,this.Ae,r);return this.Ae=Gi,this.Re=po(),this.Pe=new qi(qr),t},so.prototype.Ve=function(t,e){var n;this.Se(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t)))},so.prototype.ye=function(t,e,n){var r;this.Se(t)&&(r=this.ve(t),this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n)))},so.prototype.removeTarget=function(t){this.me.delete(t)},so.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},so.prototype.we=function(t){this.ve(t).we()},so.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new io,this.me.set(t,e)),e},so.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new qi(qr),this.Re=this.Re.st(t,e)),e},so.prototype.Se=function(t){var e=null!==this.Ne(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},so.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},so.prototype.De=function(e){var n=this;this.me.set(e,new io),this.Ie.Oe(e).forEach(function(t){n.ye(e,t,null)})},so.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},so);function so(t){this.Ie=t,this.me=new Map,this.Ae=Gi,this.Re=po(),this.Pe=new qi(qr)}function uo(){this.se=0,this.ie=yo(),this.re=Ni.J,this.oe=!1,this.he=!0}function ao(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}function co(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}function ho(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}function fo(){this.Ot=new Oi(ui.P)}function lo(n){this.P=n?function(t,e){return n(t,e)||ui.P(t.key,e.key)}:function(t,e){return ui.P(t.key,e.key)},this.kt=Hi,this.$t=new Oi(this.P)}function po(){return new Oi(ui.P)}function yo(){return new Oi(ui.P)}function vo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function go(t){var e=_o(t.mapValue.fields.__local_write_time__.timestampValue);return new ei(e.seconds,e.nanos)}var mo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vo(t)?4:10:Vr()}function bo(r,i){var t,e,n,o=wo(r);if(o!==wo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return go(r).isEqual(go(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=_o(r.timestampValue),n=_o(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,So(r.bytesValue).isEqual(So(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ao((t=r).geoPointValue.latitude)===Ao(e.geoPointValue.latitude)&&Ao(t.geoPointValue.longitude)===Ao(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ao(t.integerValue)===Ao(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ao(t.doubleValue),r=Ao(e.doubleValue);return n===r?gi(n)===gi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return jr(r.arrayValue.values||[],i.arrayValue.values||[],bo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Wr(t)!==Wr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!bo(t[n],e[n])))return!1;return!0}();default:return Vr()}}function Eo(t,e){return void 0!==(t.values||[]).find(function(t){return bo(t,e)})}function Io(t,e){var n,r,i,o,s,u,a,c,h,f,l=wo(t),p=wo(e);if(l!==p)return qr(l,p);switch(l){case 0:return 0;case 1:return qr(t.booleanValue,e.booleanValue);case 2:return c=e,h=Ao(t.integerValue||t.doubleValue),f=Ao(c.integerValue||c.doubleValue),h<f?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return To(t.timestampValue,e.timestampValue);case 4:return To(go(t),go(e));case 5:return qr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=So(o),a=So(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=qr(n[i],r[i]);if(0!==o)return o}return qr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=qr(Ao(n.latitude),Ao(r.latitude)))?i:qr(Ao(n.longitude),Ao(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Io(n[i],r[i]);if(o)return o}return qr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=qr(r[s],o[s]);if(0!==u)return u;var a=Io(n[r[s]],i[o[s]]);if(0!==a)return a}return qr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function To(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qr(t,e);var n=_o(t),r=_o(e),i=qr(n.seconds,r.seconds);return 0!==i?i:qr(n.nanos,r.nanos)}function No(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=_o(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?So(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ui.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Vr();var t,e,n}(t)}function _o(t){if(Ur(!!t),"string"!=typeof t)return{seconds:Ao(t.seconds),nanos:Ao(t.nanos)};var e,n=0,r=mo.exec(t);Ur(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Ao(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function So(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function Do(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function ko(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function Lo(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var Po={asc:"ASCENDING",desc:"DESCENDING"},Co={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vo=function(t,e){this.s=t,this.Le=e};function Uo(t){return{integerValue:""+t}}function Mo(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Fo(t,e){return mi(e)?Uo(e):Mo(t,e)}function qo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function jo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Go(t){return Ur(!!t),ni.I((e=_o(t),new ei(e.seconds,e.nanos)));var e}function Bo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function zo(t){var e=ii.k(t);return Ur(ss(e)),e}function Ho(t,e){return Bo(t.s,e.path)}function Wo(t,e){var n=zo(e);return Ur(n.get(1)===t.s.projectId),Ur(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ui(Qo(n))}function Ko(t,e){return Bo(t.s,e)}function Yo(t){var e=zo(t);return 4===e.length?ii.$():Qo(e)}function Xo(t){return new ii(["projects",t.s.projectId,"databases",t.s.database]).F()}function Qo(t){return Ur(4<t.length&&"documents"===t.get(4)),t.V(5)}function Zo(t,e,n){return{name:Ho(t,e),fields:n.proto.mapValue.fields}}function Jo(t,e){var n,r,i,o,s,u;if(e instanceof Fs)n={update:Zo(t,e.key,e.value)};else if(e instanceof Qs)n={delete:Ho(t,e.key)};else if(e instanceof qs)n={update:Zo(t,e.key,e.data),updateMask:(r=e.qe,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof Hs)n={transform:{document:Ho(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof fs)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.F(),increment:e.Be};throw Vr()})}};else{if(!(e instanceof Zs))return Vr();n={verify:Ho(t,e.key)}}return e.Qe.Ue||(n.currentDocument=void 0!==(o=e.Qe).updateTime?{updateTime:(s=t,u=o.updateTime,qo(s,u.A()))}:void 0!==o.exists?{exists:o.exists}:Vr()),n}function $o(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?ks.updateTime(Go(n.updateTime)):void 0!==n.exists?ks.exists(n.exists):ks.We():ks.We();if(t.update){t.update.name;var o=Wo(e,t.update.name),s=new Js({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new _s(r.map(function(t){return si.q(t)})));return new qs(o,s,u,i)}return new Fs(o,s,i)}if(t.delete){var a=Wo(e,t.delete);return new Qs(a,i)}if(t.transform){var c=Wo(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Ur("REQUEST_TIME"===e.setToServerValue),i=new fs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new ls(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new gs(r)):"increment"in e?i=new Es(t,e.increment):Vr();var o=si.q(e.fieldPath);return new As(o,i)}(e,t)});return Ur(!0===i.exists),new Hs(c,h)}if(t.verify){var f=Wo(e,t.verify);return new Zs(f,i)}return Vr()}function ts(t,e){return{documents:[Ko(t,e.path)]}}function es(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ko(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ko(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NAN"}};if(Lo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(xo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NOT_NAN"}};if(Lo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:is(t.field),op:(e=t.op,Co[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:is((e=t).field),direction:(n=e.dir,Po[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||vi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=ns(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ns(e.endAt)),n}function ns(t){return{before:t.before,values:t.position}}function rs(t){var e=!!t.before,n=t.values||[];return new Zu(n,e)}function is(t){return{fieldPath:t.F()}}function os(t){return si.q(t.fieldPath)}function ss(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function us(){this.je=void 0}function as(t,e){return t instanceof Es?ko(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var cs,hs,fs=(o(ds,hs=us),ds),ls=(o(ps,cs=us),ps);function ps(t){var e=this;return(e=cs.call(this)||this).elements=t,e}function ds(){return null!==hs&&hs.apply(this,arguments)||this}function ys(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return bo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(o(ms,vs=us),ms);function ms(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function ws(t,e){for(var n=Ns(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!bo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var bs,Es=(o(Is,bs=us),Is);function Is(t,e){var n=this;return(n=bs.call(this)||this).serializer=t,n.Be=e,n}function Ts(t){return Ao(t.integerValue||t.doubleValue)}function Ns(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=(Ss.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ss.prototype.isEqual=function(t){return jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ss),As=function(t,e){this.field=t,this.transform=e};function Ss(t){(this.fields=t).sort(si.P)}function Ds(t,e){this.version=t,this.transformResults=e}var ks=(Rs.We=function(){return new Rs},Rs.exists=function(t){return new Rs(void 0,t)},Rs.updateTime=function(t){return new Rs(t)},Object.defineProperty(Rs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Rs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Rs);function Rs(t,e){this.updateTime=t,this.exists=e}function Ls(t,e){return void 0!==t.updateTime?e instanceof au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof au}function xs(){}function Os(t,e,n){return t instanceof Fs?new au(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof qs?function(t,e,n){if(!Ls(t.Qe,e))return new hu(t.key,n.version);var r=Bs(t,e);return new au(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Hs?function(t,e,n){if(Ur(null!=n.transformResults),!Ls(t.Qe,e))return new hu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Ur(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof au&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof ls?ys(i,o):i instanceof gs?ws(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ks(t,r.data(),i);return new au(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new cu(t.key,n.version,{hasCommittedMutations:!0})}function Ps(t,e,n,r){return t instanceof Fs?function(t,e){if(!Ls(t.Qe,e))return e;var n=Vs(e);return new au(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof qs?function(t,e){if(!Ls(t.Qe,e))return e;var n=Vs(e),r=Bs(t,e);return new au(t.key,n,r,{Ge:!0})}(t,e):t instanceof Hs?function(t,e,n,r){if(!Ls(t.Qe,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h,f=[],l=0,p=t;l<p.length;l++){var d=p[l],y=d.transform,v=null;n instanceof au&&(v=n.field(d.field)),null===v&&r instanceof au&&(v=r.field(d.field)),f.push((o=v,s=e,h=c=a=u=void 0,(i=y)instanceof fs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof ls?ys(i,o):i instanceof gs?ws(i,o):(a=as(u=i,o),c=Ts(a)+Ts(u.Be),ko(a)&&ko(u.Be)?Uo(c):Mo(u.serializer,c))))}return f}(t.fieldTransforms,n,e,r),s=Ks(t,i.data(),o);return new au(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Ls((i=t).Qe,o)?new cu(i.key,ni.min()):o);var i,o}function Cs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||jr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ls&&o instanceof ls||i instanceof gs&&o instanceof gs?jr(i.elements,o.elements,bo):i instanceof Es&&o instanceof Es?bo(i.Be,o.Be):i instanceof fs&&o instanceof fs);var n,r,i,o}))}function Vs(t){return t instanceof au?t.version:ni.min()}var Us,Ms,Fs=(o(Gs,Ms=xs),Gs),qs=(o(js,Us=xs),js);function js(t,e,n,r){var i=this;return(i=Us.call(this)||this).key=t,i.data=e,i.qe=n,i.Qe=r,i.type=1,i}function Gs(t,e,n){var r=this;return(r=Ms.call(this)||this).key=t,r.value=e,r.Qe=n,r.type=0,r}function Bs(t,e){return n=t,r=e instanceof au?e.data():Js.empty(),i=new $s(r),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var zs,Hs=(o(Ws,zs=xs),Ws);function Ws(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Qe=ks.exists(!0),n}function Ks(t,e,n){for(var r=new $s(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Ys,Xs,Qs=(o(ru,Xs=xs),ru),Zs=(o(nu,Ys=xs),nu),Js=(eu.empty=function(){return new eu({mapValue:{}})},eu.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},eu.prototype.isEqual=function(t){return bo(this.proto,t.proto)},eu),$s=(tu.prototype.set=function(t,e){return this.Je(t,e),this},tu.prototype.delete=function(t){return this.Je(t,null),this},tu.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===wo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},tu.prototype.ze=function(){var t=this.Xe(si.$(),this.Ye);return null!=t?new Js(t):this.He},tu.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},tu);function tu(t){void 0===t&&(t=Js.empty()),this.He=t,this.Ye=new Map}function eu(t){this.proto=t}function nu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Qe=e,n.type=4,n}function ru(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.Qe=e,n.type=3,n}function iu(t,e){this.key=t,this.version=e}var ou,su,uu,au=(o(pu,uu=iu),pu.prototype.field=function(t){return this.Ze.field(t)},pu.prototype.data=function(){return this.Ze},pu.prototype.tn=function(){return this.Ze.proto},pu.prototype.isEqual=function(t){return t instanceof pu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},pu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),pu),cu=(o(lu,su=iu),lu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu.prototype.isEqual=function(t){return t instanceof lu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},lu),hu=(o(fu,ou=iu),fu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu);function fu(){return null!==ou&&ou.apply(this,arguments)||this}function lu(t,e,n){var r=this;return(r=su.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function pu(t,e,n,r){var i=this;return(i=uu.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function du(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new ti($r.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new ti($r.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var yu=(vu.prototype.on=function(t){return new vu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},vu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},vu.prototype.an=function(){return!vi(this.limit)&&"F"===this.nn},vu.prototype.un=function(){return!vi(this.limit)&&"L"===this.nn},vu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},vu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},vu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},vu);function vu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function gu(t,e,n,r,i,o,s,u){return new yu(t,e,n,r,i,o,s,u)}function mu(t){return new yu(t)}function wu(t){return null!==t.collectionGroup}function bu(t){var e=du(t,yu);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new oa(n)),e.sn.push(new oa(si.L(),"asc"));else{for(var i,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.M()&&(o=!0)}o||(i=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new oa(si.L(),i)))}}return e.sn}function Eu(t){var e=du(t,yu);if(!e.rn)if("F"===e.nn)e.rn=bi(e.path,e.collectionGroup,bu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=bu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new oa(o.field,s))}var u=e.endAt?new Zu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Zu(e.startAt.position,!e.startAt.before):null;e.rn=bi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function Iu(t,e,n){return new yu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tu(t,e){return new yu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function Nu(t,e){return new yu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function _u(t,e){return Ii(Eu(t),Eu(e))&&t.nn===e.nn}function Au(t){return Ei(Eu(t))+"|lt:"+t.nn}function Su(t){return"Query(target="+(e=Eu(t),n=e.path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+No(e.value);var e}).join(", ")+"]"),vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+na(e.startAt)),e.endAt&&(n+=", endAt: "+na(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function Du(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.W(r.collectionGroup)&&r.path.D(o):ui.j(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.M()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||ra(e.startAt,bu(e),n))&&(!e.endAt||!ra(e.endAt,bu(e),n)));var e,n,r,o}function ku(u){return function(t,e){for(var n=!1,r=0,i=bu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.M()?ui.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?Io(n,r):Vr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.M()}return 0}}var Ru,Lu=(o(xu,Ru=function(){}),xu.create=function(t,e,n){if(t.M())return"in"===e||"not-in"===e?this.dn(t,e,n):new Vu(t,e,n);if(Lo(n)){if("=="!==e&&"!="!==e)throw new ti($r.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new xu(t,e,n)}if(xo(n)){if("=="!==e&&"!="!==e)throw new ti($r.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new xu(t,e,n)}return"array-contains"===e?new Ku(t,n):"in"===e?new Yu(t,n):"not-in"===e?new Xu(t,n):"array-contains-any"===e?new Qu(t,n):new xu(t,e,n)},xu.dn=function(t,e,n){return new("in"===e?Uu:Mu)(t,n)},xu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(Io(e,this.value)):null!==e&&wo(this.value)===wo(e)&&this.wn(Io(e,this.value))},xu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},xu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},xu);function xu(t,e,n){var r=this;return(r=Ru.call(this)||this).field=t,r.op=e,r.value=n,r}var Ou,Pu,Cu,Vu=(o(ju,Cu=Lu),ju.prototype.matches=function(t){var e=ui.P(t.key,this.key);return this.wn(e)},ju),Uu=(o(qu,Pu=Lu),qu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qu),Mu=(o(Fu,Ou=Lu),Fu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Fu);function Fu(t,e){var n=this;return(n=Ou.call(this,t,"not-in",e)||this).keys=Gu(0,e),n}function qu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=Gu(0,e),n}function ju(t,e,n){var r=this;return(r=Cu.call(this,t,e,n)||this).key=ui.U(n.referenceValue),r}function Gu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ui.U(t.referenceValue)})}var Bu,zu,Hu,Wu,Ku=(o(ea,Wu=Lu),ea.prototype.matches=function(t){var e=t.field(this.field);return Ro(e)&&Eo(e.arrayValue,this.value)},ea),Yu=(o(ta,Hu=Lu),ta.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Eo(this.value.arrayValue,e)},ta),Xu=(o($u,zu=Lu),$u.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!Eo(this.value.arrayValue,e)},$u),Qu=(o(Ju,Bu=Lu),Ju.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ro(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Eo(e.value.arrayValue,t)})},Ju),Zu=function(t,e){this.position=t,this.before=e};function Ju(t,e){return Bu.call(this,t,"array-contains-any",e)||this}function $u(t,e){return zu.call(this,t,"not-in",e)||this}function ta(t,e){return Hu.call(this,t,"in",e)||this}function ea(t,e){return Wu.call(this,t,"array-contains",e)||this}function na(t){return(t.before?"b":"a")+":"+t.position.map(No).join(",")}function ra(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.M()?ui.P(ui.U(s.referenceValue),n.key):Io(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ia(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!bo(t.position[n],e.position[n]))return!1;return!0}var oa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var sa=(Ia.prototype.En=function(t,e,n){for(var r=n.In,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Os(o,e,r[i]))}return e},Ia.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ps(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ps(a,e,o,this.Tn))}return e},Ia.prototype.An=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.mn(t.key,n.get(t.key));e&&(i=i.st(t.key,e))}),i},Ia.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Yi())},Ia.prototype.isEqual=function(t){return this.batchId===t.batchId&&jr(this.mutations,t.mutations,Cs)&&jr(this.baseMutations,t.baseMutations,Cs)},Ia),ua=(Ea.from=function(t,e,n){Ur(t.mutations.length===n.length);for(var r=Wi,i=t.mutations,o=0;o<i.length;o++)r=r.st(i[o].key,n[o].version);return new Ea(t,e,n,r)},Ea),aa=(ba.prototype.catch=function(t){return this.next(void 0,t)},ba.prototype.next=function(r,i){var o=this;return this.pn&&Vr(),this.pn=!0,this.yn?this.error?this.bn(i,this.error):this.vn(r,this.result):new ba(function(e,n){o.gn=function(t){o.vn(r,t).next(e,n)},o.Vn=function(t){o.bn(i,t).next(e,n)}})},ba.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ba.prototype.Dn=function(t){try{var e=t();return e instanceof ba?e:ba.resolve(e)}catch(t){return ba.reject(t)}},ba.prototype.vn=function(t,e){return t?this.Dn(function(){return t(e)}):ba.resolve(e)},ba.prototype.bn=function(t,e){return t?this.Dn(function(){return t(e)}):ba.reject(e)},ba.resolve=function(n){return new ba(function(t,e){t(n)})},ba.reject=function(n){return new ba(function(t,e){e(n)})},ba.Cn=function(t){return new ba(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ba.Nn=function(t){for(var n=ba.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ba.resolve(t):e()})}(r[e]);return n},ba.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Cn(i)},ba),ca=(Object.defineProperty(wa.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),wa.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},wa.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},wa.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?aa.resolve(n):this.qn(t,e)},wa.prototype.getEntries=function(t,e){return this.Bn(t,e)},wa.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},wa.prototype.On=function(){},wa),ha="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",fa=(ma.prototype.Wn=function(t){this.Qn.push(t)},ma.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},ma),la=(ga.prototype.Hn=function(e,n){var r=this;return this.Gn.Yn(e,n).next(function(t){return r.Jn(e,n,t)})},ga.prototype.Jn=function(t,r,i){return this.Kn.Ln(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].mn(r,t);return t})},ga.prototype.Xn=function(t,e,i){var o=Gi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].mn(t,e);o=o.st(t,e)}),o},ga.prototype.Zn=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ts(e,t)})},ga.prototype.ts=function(r,i){var o=this;return this.Gn.es(r,i).next(function(t){var e=o.Xn(r,i,t),n=Gi;return e.forEach(function(t,e){e=e||new cu(t,ni.min()),n=n.st(t,e)}),n})},ga.prototype.ns=function(t,e,n){return r=e,ui.j(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ss(t,e.path):wu(e)?this.rs(t,e,n):this.os(t,e,n);var r},ga.prototype.ss=function(t,e){return this.Hn(t,new ui(e)).next(function(t){var e=Hi;return t instanceof au&&(e=e.st(t.key,t)),e})},ga.prototype.rs=function(n,r,i){var o=this,s=r.collectionGroup,u=Hi;return this.zn.hs(n,s).next(function(t){return aa.forEach(t,function(t){var e=r.on(t.child(s));return o.os(n,e,i).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ga.prototype.os=function(e,n,t){var h,f,r=this;return this.Kn.ns(e,n,t).next(function(t){return h=t,r.Gn.as(e,n)}).next(function(t){return f=t,r.us(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=Ps(s,a,a,r.Tn);h=c instanceof au?h.st(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Du(n,e)||(h=h.remove(t))}),h})},ga.prototype.us=function(t,e,n){for(var r=Yi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof qs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof au&&(c=c.st(t,e))}),c})},ga),pa=(va._s=function(t,e){for(var n=Yi(),r=Yi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new va(t,e.fromCache,n,r)},va),da=(ya.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ya.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},ya);function ya(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}function va(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}function ga(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}function ma(){this.Qn=[]}function wa(){this.Fn=new Jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}function ba(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function Ea(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}function Ia(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}da.Es=-1;function Ta(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Na,_a=(xa.prototype.reset=function(){this.gs=0},xa.prototype.ps=function(){this.gs=this.Ps},xa.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},xa.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},xa.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},xa.prototype.vs=function(){return(Math.random()-.5)*this.gs},xa),Aa=(La.delete=function(t){return xr("SimpleDb","Removing database:",t),Ma(window.indexedDB.deleteDatabase(t)).Sn()},La.ks=function(){if("undefined"==typeof indexedDB)return!1;if(La.$s())return!0;var t=y(),e=La.Fs(t),n=0<e&&e<10,r=La.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},La.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},La.Ms=function(t,e){return t.store(e)},La.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},La.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},La.prototype.Ls=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Da("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new ti($r.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Da(e))},i.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Ns.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){xr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return o.qs(t)}),this.db)]}})})},La.prototype.Bs=function(e){this.qs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},La.prototype.runTransaction=function(r,c,h){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Ls()];case 2:return a.db=t.sent(),e=Pa.open(a.db,s?"readonly":"readwrite",c),n=h(e).catch(function(t){return e.abort(t),aa.reject(t)}).Sn(),r={},n.catch(function(){}),[4,e.Us];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,xr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},La.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},La),Sa=(Object.defineProperty(Ra.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(Ra.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(Ra.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),Ra.prototype.done=function(){this.Ws=!0},Ra.prototype.Gs=function(t){this.js=t},Ra.prototype.delete=function(){return Ma(this.Qs.delete())},Ra),Da=(o(ka,Na=ti),ka);function ka(t){var e=this;return(e=Na.call(this,$r.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Ra(t){this.Qs=t,this.Ws=!1,this.js=null}function La(t,e,n){this.name=t,this.version=e,this.Ns=n,12.2===La.Fs(y())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function xa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}function Oa(t){return"IndexedDbTransactionError"===t.name}var Pa=(Ua.open=function(t,e,n){try{return new Ua(t.transaction(n,e))}catch(t){throw new Da(t)}},Object.defineProperty(Ua.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ca(e)},Ua),Ca=(Va.prototype.put=function(t,e){var n=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ma(n)},Va.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),Ma(this.store.add(t))},Va.prototype.get=function(e){var n=this;return Ma(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Va.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),Ma(this.store.delete(t))},Va.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),Ma(this.store.count())},Va.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},Va.prototype.Js=function(t,e){xr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},Va.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},Va.prototype.ti=function(i){var t=this.cursor({});return new aa(function(n,r){t.onerror=function(t){var e=qa(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Va.prototype.Ys=function(t,s){var u=[];return new aa(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Sa(i),(n=s(i.primaryKey,i.value,e))instanceof aa&&(r=n.catch(function(t){return e.done(),aa.reject(t)}),u.push(r)),e.yn?o():null===e.Ks?i.continue():i.continue(e.Ks)):o()}}).next(function(){return aa.Cn(u)})},Va.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Va.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Va);function Va(t){this.store=t}function Ua(t){var n=this;this.transaction=t,this.aborted=!1,this.zs=new Ta,this.transaction.oncomplete=function(){n.zs.resolve()},this.transaction.onabort=function(){t.error?n.zs.reject(new Da(t.error)):n.zs.resolve()},this.transaction.onerror=function(t){var e=qa(t.target.error);n.zs.reject(new Da(e))}}function Ma(t){return new aa(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=qa(t.target.error);r(e)}})}var Fa=!1;function qa(t){var e=Aa.Fs(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new ti("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Fa||(Fa=!0,setTimeout(function(){throw r},0)),r}}return t}function ja(){return"undefined"!=typeof window?window:null}function Ga(){return"undefined"!=typeof document?document:null}var Ba=(Wa.ri=function(t,e,n,r,i){var o=new Wa(t,e,Date.now()+n,r,i);return o.start(n),o},Wa.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},Wa.prototype.Cs=function(){return this.hi()},Wa.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new ti($r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Wa.prototype.hi=function(){var e=this;this.ei.ai(function(){return null!==e.oi?(e.clearTimeout(),e.op().then(function(t){return e.ii.resolve(t)})):Promise.resolve()})},Wa.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},Wa),za=(Object.defineProperty(Ha.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),Ha.prototype.ai=function(t){this.enqueue(t)},Ha.prototype.mi=function(t){this.Ai(),this.Ri(t)},Ha.prototype.Pi=function(){var t;this.li||(this.li=!0,(t=Ga())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei))},Ha.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},Ha.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai(function(){return e.Vi()})},Ha.prototype.Vi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ci.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return t.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!Oa(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ci.length&&this.Ti.bs(function(){return n.Vi()}),t.label=5;case 5:return[2]}})})},Ha.prototype.Ri=function(t){var r=this,e=this.ui.then(function(){return r.di=!0,t().catch(function(t){throw r.fi=t,r.di=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.di=!1,t})});return this.ui=e},Ha.prototype.Ss=function(t,e,n){var r=this;this.Ai(),-1<this.wi.indexOf(t)&&(e=0);var i=Ba.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},Ha.prototype.Ai=function(){this.fi&&Vr()},Ha.prototype.pi=function(){},Ha.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ui];case 1:t.sent(),t.label=2;case 2:if(e!==this.ui)return[3,0];t.label=3;case 3:return[2]}})})},Ha.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},Ha.prototype.Si=function(r){var i=this;return this.bi().then(function(){i._i.sort(function(t,e){return t.ni-e.ni});for(var t=0,e=i._i;t<e.length;t++){var n=e[t];if(n.Cs(),"all"!==r&&n.ms===r)break}return i.bi()})},Ha.prototype.Di=function(t){this.wi.push(t)},Ha.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},Ha);function Ha(){var e=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new _a(this,"async_queue_retry"),this.Ei=function(){var t=Ga();t&&xr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ti.Ds()};var t=Ga();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ei)}function Wa(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new Ta,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}function Ka(t,e){if(Or("AsyncQueue",e+": "+t),Oa(t))return new ti($r.UNAVAILABLE,e+": "+t);throw t}function Ya(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=qr(n,i);return 0===s?qr(r,o):s}var Xa=($a.prototype.Fi=function(){return++this.Ni},$a.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Ya(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty($a.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),$a),Qa={$i:!1,xi:0,Oi:0,Mi:0},Za=(Ja.Ui=function(t){return new Ja(t,Ja.Qi,Ja.Wi)},Ja);function Ja(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function $a(t){this.Ci=t,this.buffer=new qi(Ya),this.Ni=0}Za.ji=-1,Za.Ki=1048576,Za.Gi=41943040,Za.Qi=10,Za.Wi=1e3,Za.zi=new Za(Za.Gi,Za.Qi,Za.Wi),Za.Hi=new Za(Za.ji,0,0);var tc=(rc.prototype.start=function(t){this.Yi.params.Li!==Za.ji&&this.Zi(t)},rc.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(rc.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),rc.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return Oa(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,xh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},rc),ec=(nc.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},nc.prototype.rr=function(t,e){var n=this;if(0===e)return aa.resolve(da.Es);var r=new Xa(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},nc.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},nc.prototype.ar=function(t,e){return this.nr.ar(t,e)},nc.prototype.ur=function(e,n){var r=this;return this.params.Li===Za.ji?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),aa.resolve(Qa)):this.cr(e).next(function(t){return t<r.params.Li?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Qa):r.lr(e,n)})},nc.prototype.cr=function(t){return this.nr.cr(t)},nc.prototype.lr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>h.params.Bi?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+t),h.params.Bi):t,s=Date.now(),h.rr(e,i)}).next(function(t){return r=t,u=Date.now(),h.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ar(e,r)}).next(function(t){return c=Date.now(),Lr()<=l.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),aa.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},nc);function nc(t,e){this.nr=t,this.params=e}function rc(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}function ic(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=oc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return oc(e)}function oc(t){return t+""}function sc(t){var e=t.length;if(Ur(2<=e),2===e)return Ur(""===t.charAt(0)&&""===t.charAt(1)),ii.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Vr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Vr()}o=s+2}return new ii(r)}var uc=function(t){this._r=t};function ac(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Wo(n,r.name),s=Go(r.updateTime),u=new Js({mapValue:{fields:r.fields}}),new au(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ui.K(e.noDocument.path),c=pc(e.noDocument.readTime);return new cu(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=ui.K(e.unknownDocument.path),f=pc(e.unknownDocument.version);return new hu(h,f)}return Vr()}function cc(t,e,n){var r,i,o=hc(n),s=e.key.path.p().N();if(e instanceof au){var u={name:Ho(r=t._r,(i=e).key),fields:i.tn().mapValue.fields,updateTime:qo(r,i.version.A())},a=e.hasCommittedMutations;return new Wc(null,null,u,a,o,s)}if(e instanceof cu){var c=e.key.path.N(),h=lc(e.version),f=e.hasCommittedMutations;return new Wc(null,new zc(c,h),null,f,o,s)}if(e instanceof hu){var l=e.key.path.N(),p=lc(e.version);return new Wc(new Hc(l,p),null,null,!0,o,s)}return Vr()}function hc(t){var e=t.A();return[e.seconds,e.nanoseconds]}function fc(t){var e=new ei(t[0],t[1]);return ni.I(e)}function lc(t){var e=t.A();return new Cc(e.seconds,e.nanoseconds)}function pc(t){var e=new ei(t.seconds,t.nanoseconds);return ni.I(e)}function dc(e,t){var n=(t.baseMutations||[]).map(function(t){return $o(e._r,t)}),r=t.mutations.map(function(t){return $o(e._r,t)}),i=ei.fromMillis(t.localWriteTimeMs);return new sa(t.batchId,i,n,r)}function yc(t){var e,n=pc(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?pc(t.lastLimboFreeSnapshotVersion):ni.min(),i=void 0!==t.query.documents?(Ur(1===(e=t.query).documents.length),Eu(mu(Yo(e.documents[0])))):function(t){var e,n=Yo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Ur(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=os(t.unaryFilter.field);return Lu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=os(t.unaryFilter.field);return Lu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=os(t.unaryFilter.field);return Lu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=os(t.unaryFilter.field);return Lu.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Vr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Lu.create(os(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Vr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Vr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new oa(os((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(a=r.limit,h=vi(c="object"==typeof a?a.value:a)?null:c);var f=null;r.startAt&&(f=rs(r.startAt));var l=null;return r.endAt&&(l=rs(r.endAt)),Eu(gu(n,o,u,s,h,"F",f,l))}(t.query);return new ki(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ni.fromBase64String(t.resumeToken))}function vc(t,e){var n=lc(e.Z),r=lc(e.lastLimboFreeSnapshotVersion),i=(Ti(e.target)?ts:es)(t._r,e.target),o=e.resumeToken.toBase64();return new Yc(e.targetId,Ei(e.target),n,o,e.sequenceNumber,r,i)}var gc=(mc.Tr=function(t,e,n,r){return Ur(""!==t.uid),new mc(t.Er()?t.uid:"",e,n,r)},mc.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ec(t).Zs({index:jc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},mc.prototype.mr=function(d,y,v,g){var m=this,w=Ic(d),b=Ec(d);return b.add({}).next(function(t){Ur("number"==typeof t);for(var e,n,r,i,o,s=new sa(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Jo(e._r,t)}),o=r.mutations.map(function(t){return Jo(e._r,t)}),new jc(n,r.batchId,r.Tn.toMillis(),i,o)),a=[],c=new qi(function(t,e){return qr(t.F(),e.F())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Gc.key(m.userId,l.key.path,t),c=c.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Gc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.zn.Ar(d,t))}),d.Wn(function(){m.wr[t]=s.keys()}),aa.Cn(a).next(function(){return s})})},mc.prototype.Rr=function(t,e){var n=this;return Ec(t).get(e).next(function(t){return t?(Ur(t.userId===n.userId),dc(n.serializer,t)):null})},mc.prototype.Pr=function(t,n){var r=this;return this.wr[n]?aa.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},mc.prototype.gr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Ec(t).Zs({index:jc.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Ur(e.batchId>=i),o=dc(r.serializer,e)),n.done()}).next(function(){return o})},mc.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ec(t).Zs({index:jc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},mc.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ec(t).Hs(jc.userMutationsIndex,n).next(function(t){return t.map(function(t){return dc(e.serializer,t)})})},mc.prototype.Yn=function(u,a){var c=this,t=Gc.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return Ic(u).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=sc(i);if(r===c.userId&&a.path.isEqual(s))return Ec(u).get(o).next(function(t){if(!t)throw Vr();Ur(t.userId===c.userId),h.push(dc(c.serializer,t))});n.done()}).next(function(){return h})},mc.prototype.es=function(r,t){var a=this,c=new qi(qr),i=[];return t.forEach(function(u){var t=Gc.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=Ic(r).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=sc(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),aa.Cn(i).next(function(){return a.pr(r,c)})},mc.prototype.as=function(t,e){var u=this,a=e.path,c=a.length+1,n=Gc.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new qi(qr);return Ic(t).Zs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=sc(i);r===u.userId&&a.D(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.pr(t,h)})},mc.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ec(e).get(t).next(function(t){if(null===t)throw Vr();Ur(t.userId===n.userId),r.push(dc(n.serializer,t))}))}),aa.Cn(i).next(function(){return r})},mc.prototype.br=function(e,n){var r=this;return bc(e.vr,this.userId,n).next(function(t){return e.Wn(function(){r.Sr(n.batchId)}),aa.forEach(t,function(t){return r.dr.Dr(e,t)})})},mc.prototype.Sr=function(t){delete this.wr[t]},mc.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return aa.resolve();var e=IDBKeyRange.lowerBound(Gc.prefixForUser(o.userId)),i=[];return Ic(n).Zs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=sc(t[1]),i.push(r)):n.done()}).next(function(){Ur(0===i.length)})})},mc.prototype.Nr=function(t,e){return wc(t,this.userId,e)},mc.prototype.Fr=function(t){var e=this;return Tc(t).get(this.userId).next(function(t){return t||new qc(e.userId,-1,"")})},mc);function mc(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}function wc(t,o,e){var n=Gc.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return Ic(t).Zs({range:r,Xs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function bc(t,e,n){var r=t.store(jc.store),i=t.store(Gc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ur(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Gc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return aa.Cn(o).next(function(){return c})}function Ec(t){return dh.Ms(t,jc.store)}function Ic(t){return dh.Ms(t,Gc.store)}function Tc(t){return dh.Ms(t,qc.store)}var Nc,_c=(Ac.prototype.xn=function(t,e,n){return Dc(t).put(kc(e),n)},Ac.prototype.Mn=function(t,e){var n=Dc(t),r=kc(e);return n.delete(r)},Ac.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Ac.prototype.Ln=function(t,e){var n=this;return Dc(t).get(kc(e)).next(function(t){return n.$r(t)})},Ac.prototype.xr=function(t,e){var n=this;return Dc(t).get(kc(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:Rc(t)}:null})},Ac.prototype.getEntries=function(t,e){var r=this,i=Gi;return this.Mr(t,e,function(t,e){var n=r.$r(e);i=i.st(t,n)}).next(function(){return i})},Ac.prototype.Lr=function(t,e){var r=this,i=Gi,o=new Oi(ui.P);return this.Mr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.st(t,n),o.st(t,Rc(e))):(i=i.st(t,null),o.st(t,0))}).next(function(){return{qr:i,Br:o}})},Ac.prototype.Mr=function(t,e,i){if(e._())return aa.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.ut(),s=o.wt();return Dc(t).Zs({range:n},function(t,e,n){for(var r=ui.K(t);s&&ui.P(s,r)<0;)i(s,null),s=o.wt();s&&s.isEqual(r)&&(i(s,e),s=o.Tt()?o.wt():null),s?n.Gs(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Tt()?o.wt():null})},Ac.prototype.ns=function(t,i,e){var n,r,o,s=this,u=Hi,a=i.path.length+1,c={};return e.isEqual(ni.min())?(n=i.path.N(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=hc(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=Wc.collectionReadTimeIndex),Dc(t).Zs(c,function(t,e,n){var r;t.length===a&&(r=ac(s.serializer,e),i.path.D(r.key.path)?r instanceof au&&Du(i,r)&&(u=u.st(r.key,r)):n.done())}).next(function(){return u})},Ac.prototype.Ur=function(t,e){var r=this,i=Gi,o=hc(e),n=Dc(t),s=IDBKeyRange.lowerBound(o,!0);return n.Zs({index:Wc.readTimeIndex,range:s},function(t,e){var n=ac(r.serializer,e);i=i.st(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:fc(o)}})},Ac.prototype.Wr=function(t){var e=Dc(t),r=ni.min();return e.Zs({index:Wc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=fc(e.readTime)),n.done()}).next(function(){return r})},Ac.prototype.jr=function(t){return new Ac.Kr(this,!!t&&t.Gr)},Ac.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ac.prototype.getMetadata=function(t){return Sc(t).get(Kc.key).next(function(t){return Ur(!!t),t})},Ac.prototype.kr=function(t,e){return Sc(t).put(Kc.key,e)},Ac.prototype.$r=function(t){if(t){var e=ac(this.serializer,t);return e instanceof cu&&e.version.isEqual(ni.min())?null:e}return null},Ac);function Ac(t,e){this.serializer=t,this.zn=e}function Sc(t){return dh.Ms(t,Kc.store)}function Dc(t){return dh.Ms(t,Wc.store)}function kc(t){return t.path.N()}function Rc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Vr();e=t.noDocument}return JSON.stringify(e).length}function Lc(t,e){var n=this;return(n=Nc.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}_c.Kr=(o(Lc,Nc=ca),Lc.prototype.Un=function(s){var u=this,a=[],c=0,h=new qi(function(t,e){return qr(t.F(),e.F())});return this.Fn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=cc(u.Hr.serializer,e,u.readTime),h=h.add(t.path.p()),r=Rc(n),c+=r-o,a.push(u.Hr.xn(s,t,n))):(c-=o,u.Gr?(i=cc(u.Hr.serializer,new cu(t,ni.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),h.forEach(function(t){a.push(u.Hr.zn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,c)),aa.Cn(a)},Lc.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},Lc.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},Lc);var xc=(Fc.prototype.Ar=function(t,e){return this.Jr.add(e),aa.resolve()},Fc.prototype.hs=function(t,e){return aa.resolve(this.Jr.getEntries(e))},Fc),Oc=(Mc.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new qi(ii.P),i=!r.has(n);return this.index[e]=r.add(n),i},Mc.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Mc.prototype.getEntries=function(t){return(this.index[t]||new qi(ii.P)).N()},Mc),Pc=(Uc.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Ur(t<e&&0<=t&&e<=10);var o,s=new Pa(r);t<1&&1<=e&&(n.createObjectStore(Vc.store),(o=n).createObjectStore(qc.store,{keyPath:qc.keyPath}),o.createObjectStore(jc.store,{keyPath:jc.keyPath,autoIncrement:!0}).createIndex(jc.userMutationsIndex,jc.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Gc.store),Jc(n),n.createObjectStore(Wc.store));var u,a=aa.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Xc.store),u.deleteObjectStore(Yc.store),u.deleteObjectStore(Qc.store),Jc(n)),a=a.next(function(){return t=s.store(Qc.store),e=new Qc(0,0,ni.min().A(),0),t.put(Qc.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(jc.store).Hs().next(function(t){r.deleteObjectStore(jc.store),r.createObjectStore(jc.store,{keyPath:jc.keyPath,autoIncrement:!0}).createIndex(jc.userMutationsIndex,jc.userMutationsKeyPath,{unique:!0});var e=i.store(jc.store),n=t.map(function(t){return e.put(t)});return aa.Cn(n)});var r,i})),a=a.next(function(){n.createObjectStore($c.store,{keyPath:$c.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Kc.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Wc.store)).createIndex(Wc.readTimeIndex,Wc.readTimeIndexPath,{unique:!1}),t.createIndex(Wc.collectionReadTimeIndex,Wc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Uc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Wc.store).Zs(function(t,e){n+=Rc(e)}).next(function(){var t=new Kc(n);return e.store(Kc.store).put(Kc.key,t)})},Uc.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(qc.store),e=r.store(jc.store);return t.Hs().next(function(t){return aa.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Hs(jc.userMutationsIndex,t).next(function(t){return aa.forEach(t,function(t){Ur(t.userId===n.userId);var e=dc(i.serializer,t);return bc(r,n.userId,e).next(function(){})})})})})},Uc.prototype.ensureSequenceNumbers=function(t){var s=t.store(Xc.store),e=t.store(Wc.store);return t.store(Qc.store).get(Qc.key).next(function(i){var o=[];return e.Zs(function(t,e){var n=new ii(t),r=[0,ic(n)];o.push(s.get(r).next(function(t){return t?aa.resolve():s.put(new Xc(0,ic(n),i.highestListenSequenceNumber))}))}).next(function(){return aa.Cn(o)})})},Uc.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:ic(n)})}}t.createObjectStore(Zc.store,{keyPath:Zc.keyPath});var r=e.store(Zc.store),o=new Oc;return e.store(Wc.store).Zs({Xs:!0},function(t,e){var n=new ii(t);return i(n.p())}).next(function(){return e.store(Gc.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1],r=(t[2],sc(n));return i(r.p())})})},Uc.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Yc.store);return o.Zs(function(t,e){var n=yc(e),r=vc(i.serializer,n);return o.put(r)})},Uc),Cc=function(t,e){this.seconds=t,this.nanoseconds=e},Vc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Uc(t){this.serializer=t}function Mc(){this.index={}}function Fc(){this.Jr=new Oc}Vc.store="owner",Vc.key="owner";var qc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};qc.store="mutationQueues",qc.keyPath="userId";var jc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};jc.store="mutations",jc.keyPath="batchId",jc.userMutationsIndex="userMutationsIndex",jc.userMutationsKeyPath=["userId","batchId"];var Gc=(Bc.prefixForUser=function(t){return[t]},Bc.prefixForPath=function(t,e){return[t,ic(e)]},Bc.key=function(t,e,n){return[t,ic(e),n]},Bc);function Bc(){}Gc.store="documentMutations",Gc.PLACEHOLDER=new Gc;var zc=function(t,e){this.path=t,this.readTime=e},Hc=function(t,e){this.path=t,this.version=e},Wc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Wc.store="remoteDocuments",Wc.readTimeIndex="readTimeIndex",Wc.readTimeIndexPath="readTime",Wc.collectionReadTimeIndex="collectionReadTimeIndex",Wc.collectionReadTimeIndexPath=["parentPath","readTime"];var Kc=function(t){this.byteSize=t};Kc.store="remoteDocumentGlobal",Kc.key="remoteDocumentGlobalKey";var Yc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Yc.store="targets",Yc.keyPath="targetId",Yc.queryTargetsIndexName="queryTargetsIndex",Yc.queryTargetsKeyPath=["canonicalId","targetId"];var Xc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Xc.store="targetDocuments",Xc.keyPath=["targetId","path"],Xc.documentTargetsIndex="documentTargetsIndex",Xc.documentTargetsKeyPath=["path","targetId"];var Qc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qc.key="targetGlobalKey",Qc.store="targetGlobal";var Zc=function(t,e){this.collectionId=t,this.parent=e};function Jc(t){t.createObjectStore(Xc.store,{keyPath:Xc.keyPath}).createIndex(Xc.documentTargetsIndex,Xc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Yc.store,{keyPath:Yc.keyPath}).createIndex(Yc.queryTargetsIndexName,Yc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Qc.store)}Zc.store="collectionParents",Zc.keyPath=["collectionId","parent"];var $c=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};$c.store="clientMetadata",$c.keyPath="clientId";var th=s(s(s([qc.store,jc.store,Gc.store,Wc.store,Yc.store,Vc.store,Qc.store,Xc.store],[$c.store]),[Kc.store]),[Zc.store]),eh=(nh.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return aa.resolve();var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:ic(i)};return rh(t).put(o)},nh.prototype.hs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Gr(i),""],!1,!0);return rh(t).Hs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(sc(r.parent))}return o})},nh);function nh(){this.Xr=new Oc}function rh(t){return dh.Ms(t,Zc.store)}var ih=(uh.prototype.next=function(){return this.Zr+=2,this.Zr},uh.to=function(){return new uh(0)},uh.eo=function(){return new uh(-1)},uh),oh=(sh.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new ih(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},sh.prototype.ro=function(t){return this.so(t).next(function(t){return ni.I(new ei(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},sh.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},sh.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},sh.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},sh.prototype.lo=function(t,e){return this.uo(t,e)},sh.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return ah(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Ur(0<t.targetCount),--t.targetCount,n.io(e,t)})},sh.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return ah(r).Zs(function(t,e){var n=yc(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return aa.Cn(a)}).next(function(){return u})},sh.prototype.be=function(t,r){return ah(t).Zs(function(t,e){var n=yc(e);r(n)})},sh.prototype.so=function(t){return ch(t).get(Qc.key).next(function(t){return Ur(null!==t),t})},sh.prototype.io=function(t,e){return ch(t).put(Qc.key,e)},sh.prototype.uo=function(t,e){return ah(t).put(vc(this.serializer,e))},sh.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},sh.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},sh.prototype.wo=function(t,i){var e=Ei(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return ah(t).Zs({range:n,index:Yc.queryTargetsIndexName},function(t,e,n){var r=yc(e);Ii(i,r.target)&&(o=r,n.done())}).next(function(){return o})},sh.prototype.To=function(n,t,r){var i=this,o=[],s=hh(n);return t.forEach(function(t){var e=ic(t.path);o.push(s.put(new Xc(r,e))),o.push(i.dr.Eo(n,r,t))}),aa.Cn(o)},sh.prototype.Io=function(n,t,r){var i=this,o=hh(n);return aa.forEach(t,function(t){var e=ic(t.path);return aa.Cn([o.delete([r,e]),i.dr.mo(n,r,t)])})},sh.prototype.fo=function(t,e){var n=hh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},sh.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=hh(t),o=Yi();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=sc(t[1]),i=new ui(r);o=o.add(i)}).next(function(){return o})},sh.prototype.Nr=function(t,e){var n=ic(e.path),r=IDBKeyRange.bound([n],[Gr(n)],!1,!0),i=0;return hh(t).Zs({index:Xc.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},sh.prototype.Me=function(t,e){return ah(t).get(e).next(function(t){return t?yc(t):null})},sh);function sh(t,e){this.dr=t,this.serializer=e}function uh(t){this.Zr=t}function ah(t){return dh.Ms(t,Yc.store)}function ch(t){return dh.Ms(t,Qc.store)}function hh(t){return dh.Ms(t,Xc.store)}var fh,lh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ph=(o(vh,fh=fa),vh),dh=(yh.Ms=function(t,e){if(t instanceof ph)return Aa.Ms(t.vr,e);throw Vr()},yh.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new ti($r.FAILED_PRECONDITION,lh);return e.Oo(),e.Mo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new da(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},yh.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},yh.prototype.Bo=function(n){var t=this;this.Fo.Bs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},yh.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},yh.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return mh(e).put(new $c(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Is.gi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(Oa(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Is.gi(function(){return n.Co(t)}),n.isPrimary=t})},yh.prototype.Qo=function(t){var e=this;return gh(t).get(Vc.key).next(function(t){return aa.resolve(e.Go(t))})},yh.prototype.zo=function(t){return mh(t).delete(this.clientId)},yh.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=yh.Ms(t,$c.store);return r.Hs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return aa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},yh.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},yh.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},yh.prototype.Wo=function(e){var i=this;return this.Vo?aa.resolve(!0):gh(e).get(Vc.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new ti($r.FAILED_PRECONDITION,lh);return!1}}return!(!i.networkEnabled||!i.inForeground)||mh(e).Hs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},yh.prototype.th=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Vc.store,$c.store],function(t){var e=new ph(t,da.Es);return n.jo(e).next(function(){return n.zo(e)})})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},yh.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},yh.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return mh(t).Hs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(yh.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),yh.prototype.oh=function(t){return gc.Tr(t,this.serializer,this.zn,this.dr)},yh.prototype.hh=function(){return this.ko},yh.prototype.ah=function(){return this.Kn},yh.prototype.uh=function(){return this.zn},yh.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,th,function(t){return o=new ph(t,i.yo?i.yo.next():da.Es),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Is.gi(function(){return i.Co(!1)}),new ti($r.FAILED_PRECONDITION,ha);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.jn(),t})},yh.prototype.lh=function(t){var e=this;return gh(t).get(Vc.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ti($r.FAILED_PRECONDITION,lh)})},yh.prototype.Ko=function(t){var e=new Vc(this.clientId,this.allowTabSynchronization,Date.now());return gh(t).put(Vc.key,e)},yh.ks=function(){return Aa.ks()},yh.prototype.jo=function(t){var e=this,n=gh(t);return n.get(Vc.key).next(function(t){return e.Go(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(Vc.key)):aa.resolve()})},yh.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},yh.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},yh.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},yh.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},yh.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},yh.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},yh.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},yh.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},yh.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},yh);function yh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Is=i,this.window=o,this.document=s,this.Po=a,this.Vo=c,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!yh.ks())throw new ti($r.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new wh(this,r),this.No=e+"main",this.serializer=new uc(u),this.Fo=new Aa(this.No,10,new Pc(this.serializer)),this.ko=new oh(this.dr,this.serializer),this.zn=new eh,this.Kn=new _c(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function vh(t,e){var n=this;return(n=fh.call(this)||this).vr=t,n.Ro=e,n}function gh(t){return dh.Ms(t,Vc.store)}function mh(t){return dh.Ms(t,$c.store)}var wh=(bh.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},bh.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},bh.prototype.be=function(t,e){return this.db.hh().be(t,e)},bh.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},bh.prototype.Eo=function(t,e,n){return Eh(t,n)},bh.prototype.mo=function(t,e,n){return Eh(t,n)},bh.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},bh.prototype.Dr=Eh,bh.prototype.dh=function(t,e){return r=e,i=!1,Tc(n=t).ti(function(t){return wc(n,t,r).next(function(t){return t&&(i=!0),aa.resolve(!t)})}).next(function(){return i});var n,r,i},bh.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.Ln(r,e).next(function(){return s.Mn(e),hh(r).delete([0,ic(e.path)])})}),u.push(n))}).next(function(){return aa.Cn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},bh.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},bh.prototype.wh=Eh,bh.prototype.fh=function(t,o){var s,e=hh(t),u=da.Es;return e.Zs({index:Xc.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==da.Es&&o(new ui(sc(s)),u),u=i,s=r):u=da.Es}).next(function(){u!==da.Es&&o(new ui(sc(s)),u)})},bh.prototype.cr=function(t){return this.db.ah().zr(t)},bh);function bh(t,e){this.db=t,this.Yi=new ec(this,e)}function Eh(t,e){return hh(t).put((n=t.Ro,new Xc(0,ic(e.path),n)));var n}function Ih(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Th=(Nh.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},Nh);function Nh(t,e,n){this.persistence=t,this.Th=e,this.Eh=new Oi(qr),this.Ih=new Jr(Ei,Ii),this.mh=ni.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new la(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}function _h(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,i,o,s,r,u,a=h.batch.keys(),c=f.Ah.jr({Gr:!0});return e=f,n=t,o=c,s=(i=h).batch,r=s.keys(),u=aa.resolve(),r.forEach(function(r){u=u.next(function(){return o.Ln(n,r)}).next(function(t){var e=t,n=i.Pn.get(r);Ur(null!==n),(!e||e.version.o(n)<0)&&(e=s.En(r,e,i))&&o.xn(e,i.Rn)})}),u.next(function(){return e.Gn.br(n,s)}).next(function(){return c.apply(t)}).next(function(){return f.Gn.Cr(t)}).next(function(){return f.Rh.Zn(t,a)})})}function Ah(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Sh(t,s){var h=t,f=s.Z,l=h.Eh;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Ah.jr({Gr:!0});l=h.Eh;var c=[];s.Wt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.ko.Io(a,t.Zt,e).next(function(){return h.ko.To(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(r=u.et(n,f).tt(a.Ro),l=l.st(e,r),i=u,s=t,Ur(0<(o=r).resumeToken.Y()),(0===i.resumeToken.Y()||3e8<=o.Z.m()-i.Z.m()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&c.push(h.ko.lo(a,r))))});var t,o=Gi,n=Yi();return s.Kt.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Kt.forEach(function(t,e){var n=r.get(t);e instanceof cu&&e.version.isEqual(ni.min())?(i.Mn(t,f),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,f),o=o.st(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Gt.has(t)&&c.push(h.persistence.dr.wh(a,t))})})),f.isEqual(ni.min())||(t=h.ko.ro(a).next(function(t){return h.ko.ho(a,a.Ro,f)}),c.push(t)),aa.Cn(c).next(function(){return i.apply(a)}).next(function(){return h.Rh.ts(a,o)})}).then(function(t){return h.Eh=l,t})}function Dh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,aa.resolve(n)):i.ko.no(e).next(function(t){return n=new ki(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(i.Eh=i.Eh.st(t.targetId,t),i.Ih.set(r,t.targetId)),t})}function kh(o,s,u){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Eh.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.dr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Oa(i=t.sent()))throw i;return xr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Eh=e.Eh.remove(s),e.Ih.delete(n.target),[2]}})})}function Rh(t,s,u){var a=t,c=ni.min(),h=Yi();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=Eu(s),(void 0!==(o=(i=t).Ih.get(r))?aa.resolve(i.Eh.get(o)):i.ko.wo(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.ko.Ao(e,t.targetId).next(function(t){h=t})}).next(function(){return a.Th.ns(e,s,u?c:ni.min(),u?h:Yi())}).next(function(t){return{documents:t,gh:h}});var t,n,r,i,o})}function Lh(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function xh(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==$r.FAILED_PRECONDITION||e.message!==ha)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Oh=(Mh.prototype._=function(){return this.Vh._()},Mh.prototype.Eo=function(t,e){var n=new Ph(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},Mh.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Mh.prototype.mo=function(t,e){this.Sh(new Ph(t,e))},Mh.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Mh.prototype.Ch=function(t){var e=this,n=new ui(new ii([])),r=new Ph(n,t),i=new Ph(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},Mh.prototype.Nh=function(){var e=this;this.Vh.forEach(function(t){return e.Sh(t)})},Mh.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},Mh.prototype.Fh=function(t){var e=new ui(new ii([])),n=new Ph(e,t),r=new Ph(e,t+1),i=Yi();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},Mh.prototype.Nr=function(t){var e=new Ph(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},Mh),Ph=(Uh.yh=function(t,e){return ui.P(t.key,e.key)||qr(t.kh,e.kh)},Uh.bh=function(t,e){return qr(t.kh,e.kh)||ui.P(t.key,e.key)},Uh),Ch=(Vh.prototype.Er=function(){return null!=this.uid},Vh.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},Vh.prototype.isEqual=function(t){return t.uid===this.uid},Vh);function Vh(t){this.uid=t}function Uh(t,e){this.key=t,this.kh=e}function Mh(){this.Vh=new qi(Ph.yh),this.ph=new qi(Ph.bh)}Ch.UNAUTHENTICATED=new Ch(null),Ch.xh=new Ch("google-credentials-uid"),Ch.Oh=new Ch("first-party-uid");function Fh(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}var qh,jh,Gh,Bh=(cf.prototype.getToken=function(){return Promise.resolve(null)},cf.prototype.qh=function(){},cf.prototype.Bh=function(t){(this.Lh=t)(Ch.UNAUTHENTICATED)},cf.prototype.Uh=function(){this.Lh=null},cf),zh=(af.prototype.getToken=function(){var e=this,n=this.jh,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.jh!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ur("string"==typeof t.accessToken),new Fh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},af.prototype.qh=function(){this.forceRefresh=!0},af.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},af.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},af.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Ur(null===t||"string"==typeof t),new Ch(t)},af),Hh=(Object.defineProperty(uf.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),uf),Wh=(sf.prototype.getToken=function(){return Promise.resolve(new Hh(this.Gh,this.zh))},sf.prototype.Bh=function(t){t(Ch.Oh)},sf.prototype.Uh=function(){},sf.prototype.qh=function(){},sf),Kh=(of.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},of.prototype.na=function(){return 2===this.state},of.prototype.start=function(){3!==this.state?this.auth():this.sa()},of.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},of.prototype.ia=function(){this.state=0,this.Ti.reset()},of.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,function(){return t.oa()}))},of.prototype.ha=function(t){this.aa(),this.stream.send(t)},of.prototype.oa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},of.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},of.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==e?this.Ti.reset():n&&n.code===$r.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):n&&n.code===$r.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ca(n)];case 1:return t.sent(),[2]}})})},of.prototype.ua=function(){},of.prototype.auth=function(){var n=this;this.state=1;var t=this.la(this.Zh),e=this.Zh;this.Xh.getToken().then(function(t){n.Zh===e&&n._a(t)},function(e){t(function(){var t=new ti($r.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fa(t)})})},of.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ca(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},of.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},of.prototype.fa=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},of.prototype.la=function(e){var n=this;return function(t){n.Is.ai(function(){return n.Zh===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},of),Yh=(o(rf,Gh=Kh),rf.prototype.da=function(t){return this.Jh.Ta("Listen",t)},rf.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Vr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(Ur(void 0===i||"string"==typeof i),Ni.fromBase64String(i||"")):(Ur(void 0===i||i instanceof Uint8Array),Ni.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=c&&(r=void 0===(n=c).code?$r.UNKNOWN:xi(n.code),new ti(r,n.message||"")),f=new Ji(s,u,a,h||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=Wo(t,l.document.name),d=Go(l.document.updateTime),y=new Js({mapValue:{fields:l.document.fields}}),v=new au(p,d,y,{}),g=l.targetIds||[],m=l.removedTargetIds||[];f=new Qi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=Wo(t,w.document),E=w.readTime?Go(w.readTime):ni.min(),I=new cu(b,E),T=w.removedTargetIds||[];f=new Qi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var _=Wo(t,N.document),A=N.removedTargetIds||[];f=new Qi([],A,_,null)}else{if(!("filter"in e))return Vr();e.filter;var S=e.filter;S.targetId;var D=S.count||0,k=new Ai(D),R=S.targetId;f=new Zi(R,k)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ni.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ni.min():Go(e.readTime)}(t);return this.listener.Ea(e,n)},rf.prototype.Ia=function(t){var e,n,r,i,o={};o.database=Xo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Ti(i)?{documents:ts(e,i)}:{query:es(e,i)}).targetId=n.targetId,0<n.resumeToken.Y()&&(r.resumeToken=jo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ha(o)},rf.prototype.ma=function(t){var e={};e.database=Xo(this.serializer),e.removeTarget=t,this.ha(e)},rf),Xh=(o(nf,jh=Kh),Object.defineProperty(nf.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),nf.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,jh.prototype.start.call(this)},nf.prototype.ua=function(){this.Aa&&this.Pa([])},nf.prototype.da=function(t){return this.Jh.Ta("Write",t)},nf.prototype.onMessage=function(t){if(Ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Ur(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Go(t.updateTime):Go(e);n.isEqual(ni.min())&&(n=Go(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ds(n,r)}(t,i)})):[]),n=Go(t.commitTime);return this.listener.ga(n,e)}var r,i;return Ur(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},nf.prototype.ya=function(){var t={};t.database=Xo(this.serializer),this.ha(t)},nf.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Jo(e.serializer,t)})};this.ha(n)},nf),Qh=(o(ef,qh=function(){}),ef.prototype.ba=function(){if(this.pa)throw new ti($r.FAILED_PRECONDITION,"The client has already been terminated.")},ef.prototype.va=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.va(e,n,r,t)}).catch(function(t){throw t.code===$r.UNAUTHENTICATED&&i.credentials.qh(),t})},ef.prototype.Sa=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.Sa(e,n,r,t)}).catch(function(t){throw t.code===$r.UNAUTHENTICATED&&i.credentials.qh(),t})},ef.prototype.terminate=function(){this.pa=!1},ef),Zh=(tf.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},tf.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,1<=this.Ca&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},tf.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},tf.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},tf.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(Or(e),this.Fa=!1):xr("OnlineStateTracker",e)},tf.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},tf),Jh=($h.prototype.start=function(){return this.enableNetwork()},$h.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},$h.prototype.iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},$h.prototype.au=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),0<this.Ba.length&&(xr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}})})},$h.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},$h.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},$h.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},$h.prototype.Me=function(t){return this.Ua.get(t)||null},$h.prototype.Oe=function(t){return this.fu.Oe(t)},$h.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},$h.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},$h.prototype.ou=function(){this.Qa=new oo(this),this.Ya.start(),this.Ha.ka()},$h.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&0<this.Ua.size},$h.prototype.Ga=function(){return 0===this.Wa.size},$h.prototype.uu=function(){this.Qa=null},$h.prototype.Ja=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.Ua.forEach(function(t,e){n.cu(t)}),[2]})})},$h.prototype.Xa=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.uu(),this.ru()?(this.Ha.Oa(e),this.ou()):this.Ha.set("Unknown"),[2]})})},$h.prototype.Za=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Ha.set("Online"),!(i instanceof Ji&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.du(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.wu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Qi?this.Qa.ge(i):i instanceof Zi?this.Qa.Ce(i):this.Qa.pe(i),o.isEqual(ni.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ah(this.La)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Tu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.wu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},$h.prototype.wu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Oa(n))throw n;return this.Wa.add(1),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),r=r||function(){return Ah(e.La)},this.ei.gi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},$h.prototype.Eu=function(e){var n=this;return e().catch(function(t){return n.wu(t,e)})},$h.prototype.Tu=function(r){var i=this,t=this.Qa.ke(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=i.Ua.get(e))&&i.Ua.set(e,n.et(t.resumeToken,r))}),t.jt.forEach(function(t){var e,n=i.Ua.get(t);n&&(i.Ua.set(t,n.et(Ni.J,n.Z)),i._u(t),e=new ki(n.target,t,1,n.sequenceNumber),i.cu(e))}),this.fu.Iu(t)},$h.prototype.du=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fu.mu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},$h.prototype.hu=function(){return g(this,void 0,void 0,function(){var i,o,s;return w(this,function(t){switch(t.label){case 0:i=0<this.Ba.length?this.Ba[this.Ba.length-1].batchId:-1,t.label=1;case 1:if(!this.Au())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.La,n=i,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Gn.gr(t,n)}))];case 3:return null===(o=t.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(i=o.batchId,this.Ru(o),[3,6]);case 4:return s=t.sent(),[4,this.wu(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}var e,n,r})})},$h.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},$h.prototype.Vu=function(){return this.Ba.length},$h.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},$h.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&0<this.Ba.length},$h.prototype.gu=function(){this.tu.start()},$h.prototype.eu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.tu.ya(),[2]})})},$h.prototype.su=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Ba;e<n.length;e++)r=n[e],this.tu.Pa(r.mutations);return[2]})})},$h.prototype.ga=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Ba.shift(),n=ua.from(e,i,o),[4,this.Eu(function(){return r.fu.yu(n)})];case 1:return t.sent(),[4,this.hu()];case 2:return t.sent(),[2]}})})},$h.prototype.nu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.tu.Ra?[4,this.pu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Pu()&&this.gu(),[2]}})})},$h.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Li(n=i.code)&&n!==$r.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu(function(){return r.fu.bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.hu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},$h.prototype.za=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}})})},$h.prototype.vu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ei.pi(),xr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(e)];case 2:return t.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return t.sent(),[2]}})})},$h.prototype.Su=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:t.sent(),this.Ha.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},$h);function $h(t,e,n,r,i){var o,s,u,a,c,h,f,l,p=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(xr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new Zh(n,r),this.Ya=(c=this.qa,h=n,f={wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)},(l=c).ba(),new Yh(h,l.Jh,l.credentials,l.serializer,f)),this.tu=(o=this.qa,s=n,u={wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)},(a=o).ba(),new Xh(s,a.Jh,a.credentials,a.serializer,u))}function tf(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}function ef(t,e,n){var r=this;return(r=qh.call(this)||this).credentials=t,r.Jh=e,r.serializer=n,r.pa=!1,r}function nf(t,e,n,r,i){var o=this;return(o=jh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Aa=!1,o}function rf(t,e,n,r,i){var o=this;return(o=Gh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function of(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new _a(t,e)}function sf(t,e){this.Gh=t,this.zh=e}function uf(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Ch.Oh}function af(t){var e=this;this.Qh=null,this.currentUser=Ch.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}function cf(){this.Lh=null}function hf(t,e){return"firestore_clients_"+t+"_"+e}function ff(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function lf(t,e){return"firestore_targets_"+t+"_"+e}function pf(t){this.key=t}function df(t){this.key=t}function yf(t,e,n){this.query=t,this.targetId=e,this.view=n}function vf(t){this.key=t,this.qc=!1}var gf=(Pf.Du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new ti(r.error.code,r.error.message)),i?new Pf(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Pf.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Pf),mf=(Of.Du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new ti(n.error.code,n.error.message)),r?new Of(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Of.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Of),wf=(xf.Du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Xi,o=0;r&&o<n.activeTargetIds.length;++o)r=mi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xf(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xf),bf=(Lf.Du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Lf(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},Lf),Ef=(Rf.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Rf.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Rf.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},Rf),If=(kf.ks=function(t){return!(!t||!t.localStorage)},kf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.fu.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.ku&&(o=this.getItem(hf(this.persistenceKey,i)))&&(s=wf.Du(i,o))&&(this.Ou=this.Ou.st(s.clientId,s));for(this.ju(),(u=this.storage.getItem(this.Wu))&&(a=this.Ku(u))&&this.Gu(a),c=0,h=this.Mu;c<h.length;c++)f=h[c],this.xu(f);return this.Mu=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},kf.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},kf.prototype.zu=function(){return this.Hu(this.Ou)},kf.prototype.Yu=function(n){var r=!1;return this.Ou.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},kf.prototype.Ju=function(t){this.Xu(t,"pending")},kf.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},kf.prototype.ec=function(t){var e,n,r="not-current";return this.Yu(t)&&(!(e=this.storage.getItem(lf(this.persistenceKey,t)))||(n=mf.Du(t,e))&&(r=n.state)),this.nc.Nu(t),this.ju(),r},kf.prototype.sc=function(t){this.nc.Fu(t),this.ju()},kf.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},kf.prototype.rc=function(t){this.removeItem(lf(this.persistenceKey,t))},kf.prototype.oc=function(t,e,n){this.hc(t,e,n)},kf.prototype.ac=function(t,e,n){var r=this;e.forEach(function(t){r.tc(t)}),this.currentUser=t,n.forEach(function(t){r.Ju(t)})},kf.prototype.uc=function(t){this.cc(t)},kf.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},kf.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},kf.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},kf.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},kf.prototype.xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(xr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Lu)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.Bu.test(u.key)){if(null==u.newValue)return e=this.lc(u.key),[2,this._c(e,null)];if(n=this.fc(u.key,u.newValue))return[2,this._c(n.clientId,n)]}else if(this.Uu.test(u.key)){if(null!==u.newValue&&(r=this.dc(u.key,u.newValue)))return[2,this.wc(r)]}else if(this.Qu.test(u.key)){if(null!==u.newValue&&(i=this.Tc(u.key,u.newValue)))return[2,this.Ec(i)]}else if(u.key===this.Wu){if(null!==u.newValue&&(o=this.Ku(u.newValue)))return[2,this.Gu(o)]}else u.key===this.qu&&(s=function(t){var e=da.Es;if(null!=t)try{var n=JSON.parse(t);Ur("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==da.Es&&this.fs(s)}else this.Mu.push(u);return[2]})})})}},Object.defineProperty(kf.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),kf.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},kf.prototype.Xu=function(t,e,n){var r=new gf(this.currentUser,t,e,n),i=ff(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},kf.prototype.tc=function(t){var e=ff(this.persistenceKey,this.currentUser,t);this.removeItem(e)},kf.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},kf.prototype.hc=function(t,e,n){var r=lf(this.persistenceKey,t),i=new mf(t,e,n);this.setItem(r,i.Cu())},kf.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},kf.prototype.fc=function(t,e){var n=this.lc(t);return wf.Du(n,e)},kf.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return gf.Du(new Ch(i),r,e)},kf.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return mf.Du(r,e)},kf.prototype.Ku=function(t){return bf.Du(t)},kf.prototype.wc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fu.Ic(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},kf.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},kf.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fu.Ac(s,u).then(function(){n.Ou=r})},kf.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},kf.prototype.Hu=function(t){var n=Xi;return t.forEach(function(t,e){n=n.Nt(e.activeTargetIds)}),n},kf),Tf=(Df.prototype.Ju=function(t){},Df.prototype.Zu=function(t,e,n){},Df.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},Df.prototype.oc=function(t,e,n){this.Pc[t]=e},Df.prototype.sc=function(t){this.Rc.Fu(t)},Df.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},Df.prototype.rc=function(t){delete this.Pc[t]},Df.prototype.zu=function(){return this.Rc.activeTargetIds},Df.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},Df.prototype.start=function(){return this.Rc=new Ef,Promise.resolve()},Df.prototype.ac=function(t,e,n){},Df.prototype.uc=function(t){},Df.prototype.th=function(){},Df.prototype.Ts=function(t){},Df),Nf=(Object.defineProperty(Sf.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),Sf.prototype.Sc=function(t,e){var u=this,a=e?e.Dc:new to,c=e?e.bc:this.bc,h=e?e.qt:this.qt,f=c,l=!1,p=this.query.an()&&c.size===this.query.limit?c.last():null,d=this.query.un()&&c.size===this.query.limit?c.first():null;if(t.ht(function(t,e){var n=c.get(t),r=(r=e instanceof au?e:null)&&(Du(u.query,r)?r:null),i=!!n&&u.qt.has(n.key),o=!!r&&(r.Ge||u.qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Cc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.pc(r,p)||d&&u.pc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),this.query.an()||this.query.un())for(;f.size>this.query.limit;){var n=this.query.an()?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{bc:f,Dc:a,Nc:l,qt:h}},Sf.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Sf.prototype.Un=function(t,e,n){var o=this,r=this.bc;this.bc=t.bc,this.qt=t.qt;var i=t.Dc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==i.length||a?{snapshot:new eo(this.query,t.bc,r,i,t.qt,0==u,a,!1),$c:s}:{$c:s}},Sf.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new to,qt:this.qt,Nc:!1},!1)):{$c:[]}},Sf.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},Sf.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gc=e.gc.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gc=e.gc.delete(t)}),this.Yt=t.Yt)},Sf.prototype.kc=function(){var e=this;if(!this.Yt)return[];var n=this.yc;this.yc=Yi(),this.bc.forEach(function(t){e.Oc(t.key)&&(e.yc=e.yc.add(t.key))});var r=[];return n.forEach(function(t){e.yc.has(t)||r.push(new df(t))}),this.yc.forEach(function(t){n.has(t)||r.push(new pf(t))}),r},Sf.prototype.Mc=function(t){this.gc=t.gh,this.yc=Yi();var e=this.Sc(t.documents);return this.Un(e,!0)},Sf.prototype.Lc=function(){return eo.Qt(this.query,this.bc,this.qt,0===this.Vc)},Sf),_f=(Object.defineProperty(Af.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),Af.prototype.subscribe=function(t){this.Wc=t},Af.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.nl("listen()"),(r=this.jc.get(s))?(e=r.targetId,this.Uc.ec(e),n=r.view.Lc(),[3,4]):[3,1];case 1:return[4,Dh(this.La,Eu(s))];case 2:return i=t.sent(),o=this.Uc.ec(i.targetId),e=i.targetId,[4,this.sl(s,e,"current"===o)];case 3:n=t.sent(),this.el&&this.Bc.listen(i),t.label=4;case 4:return[2,n]}})})},Af.prototype.sl=function(u,a,c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,Rh(this.La,u,!0)];case 1:return e=t.sent(),n=new Nf(u,e.gh),r=n.Sc(e.documents),i=ro.Ht(a,c&&"Offline"!==this.onlineState),o=n.Un(r,this.el,i),this.il(a,o.$c),s=new yf(u,a,n),[2,(this.jc.set(u,s),this.Kc.has(a)?this.Kc.get(a).push(u):this.Kc.set(a,[u]),o.snapshot)]}})})},Af.prototype.lu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.nl("unlisten()"),e=this.jc.get(i),1<(n=this.Kc.get(e.targetId)).length?[2,(this.Kc.set(e.targetId,n.filter(function(t){return!_u(t,i)})),void this.jc.delete(i))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,kh(this.La,e.targetId,!1).then(function(){r.Uc.rc(e.targetId),r.Bc.lu(e.targetId),r.rl(e.targetId)}).catch(xh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,kh(this.La,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Af.prototype.write=function(s,u){return g(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:this.nl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.La,c=s,f=e,l=ei.now(),n=c.reduce(function(t,e){return t.add(e.key)},Yi()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Zn(a,n).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof Hs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof au?t.field(i.field):void 0,s=as(i.transform,o||null);null!=s&&(e=null==e?(new $s).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new qs(o.key,s,function u(t){var a=[];return Kr(t.fields||{},function(t,e){var n=new si([t]);if(Oo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new _s(a)}(s.proto.mapValue),ks.exists(!0)))}return f.Gn.mr(a,l,n,c)})}).then(function(t){var e=t.An(h);return{batchId:t.batchId,Fn:e}}))];case 2:return r=t.sent(),this.Uc.Ju(r.batchId),this.ol(r.batchId,u),[4,this.hl(r.Fn)];case 3:return t.sent(),[4,this.Bc.hu()];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),o=Ka(i,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,c,h,f,l,n})})},Af.prototype.Iu=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.nl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Sh(this.La,n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Hc.get(e);n&&(Ur(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.qc=!0:0<t.Xt.size?Ur(n.qc):0<t.Zt.size&&(Ur(n.qc),n.qc=!1))}),[4,this.hl(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Af.prototype.xc=function(r,t){var i;(this.el&&0===t||!this.el&&1===t)&&(this.nl("applyOnlineStateChange()"),i=[],this.jc.forEach(function(t,e){var n=e.view.xc(r);n.snapshot&&i.push(n.snapshot)}),this.Wc.al(r),this.Wc.Ea(i),this.onlineState=r,this.el&&this.Uc.uc(r))},Af.prototype.mu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(u,"rejected",a),e=this.Hc.get(u),(n=e&&e.key)?(r=(r=new Oi(ui.P)).st(n,new cu(n,ni.min())),i=Yi().add(n),o=new no(ni.min(),new Map,new qi(qr),r,i),[4,this.Iu(o)]):[3,2];case 1:return t.sent(),this.zc=this.zc.remove(n),this.Hc.delete(u),this.ul(),[3,4];case 2:return[4,kh(this.La,u,!1).then(function(){return s.rl(u,a)}).catch(xh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Af.prototype.yu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.nl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,_h(this.La,r)];case 2:return n=t.sent(),this.cl(e,null),this.ll(e),this.Uc.Zu(e,"acknowledged"),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Af.prototype.bu=function(o,s){return g(this,void 0,void 0,function(){var n;return w(this,function(t){switch(t.label){case 0:this.nl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,r=o,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Gn.Rr(e,r).next(function(t){return Ur(null!==t),n=t.keys(),i.Gn.br(e,t)}).next(function(){return i.Gn.Cr(e)}).next(function(){return i.Rh.Zn(e,n)})}))];case 2:return n=t.sent(),this.cl(o,s),this.ll(o),this.Uc.Zu(o,"rejected",s),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,xh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})},Af.prototype._l=function(u){return g(this,void 0,void 0,function(){var r,i,o,s;return w(this,function(t){switch(t.label){case 0:this.Bc.Ga()||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.La,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.Gn.Vr(t)}))];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=this.Xc.get(r)||[]).push(u),this.Xc.set(r,i),[3,4]);case 3:return o=t.sent(),s=Ka(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},Af.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach(function(t){t.resolve()}),this.Xc.delete(t)},Af.prototype.fl=function(e){this.Xc.forEach(function(t){t.forEach(function(t){t.reject(new ti($r.CANCELLED,e))})}),this.Xc.clear()},Af.prototype.ol=function(t,e){var n=this.Jc[this.currentUser.$h()];n=(n=n||new Oi(qr)).st(t,e),this.Jc[this.currentUser.$h()]=n},Af.prototype.cl=function(t,e){var n,r=this.Jc[this.currentUser.$h()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Jc[this.currentUser.$h()]=r)},Af.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach(function(t){n.Yc.Nr(t)||n.wl(t)})},Af.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},Af.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof pf?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof df?(xr("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):Vr()}},Af.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(xr("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},Af.prototype.ul=function(){for(;0<this.Gc.length&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new vf(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new ki(Eu(mu(t.path)),e,2,da.Es))}},Af.prototype.El=function(){return this.zc},Af.prototype.Il=function(){return this.Gc},Af.prototype.hl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.jc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Sc(r);return n.Nc?Rh(u.La,i.query,!1).then(function(t){var e=t.documents;return i.view.Sc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.Un(t,u.el,n);u.il(i.targetId,r.$c),r.snapshot&&(u.el&&u.Uc.oc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=pa._s(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Wc.Ea(o),[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return aa.forEach(f,function(e){return aa.forEach(e.cs,function(t){return r.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return aa.forEach(e.ls,function(t){return r.persistence.dr.mo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Oa(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Eh.get(s),a=u.Z,c=u.nt(a),r.Eh=r.Eh.st(s,c));return[2]}})})}(this.La,s)];case 2:return t.sent(),[2]}})})},Af.prototype.nl=function(t){},Af.prototype.vu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(xr("SyncEngine","User change. New user:",n.$h()),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Gn,m=e.Rh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Gn.yr(v).next(function(t){return g=t,n=e.persistence.oh(o),m=new la(e.Ah,n,e.persistence.uh()),n.yr(v)}).next(function(t){for(var e=[],n=[],r=Yi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zn(v,r).next(function(t){return{ml:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.Gn=n,e.Rh=m,e.Th.Ph(e.Rh),r)]}})})}(this.La,n)]);case 1:return e=t.sent(),this.currentUser=n,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(n,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Af.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return Yi().add(e.key);var n=Yi(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.jc.get(s),n=n.Nt(u.view.vc);return n},Af);function Af(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new Jr(Au,_u),this.Kc=new Map,this.Gc=[],this.zc=new Oi(ui.P),this.Hc=new Map,this.Yc=new Oh,this.Jc={},this.Xc=new Map,this.Zc=ih.eo(),this.onlineState="Unknown",this.tl=void 0}function Sf(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=Yi(),this.qt=Yi(),this.pc=ku(t),this.bc=new $i(this.pc)}function Df(){this.Rc=new Ef,this.Pc={},this.Da=null,this.fs=null}function kf(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new Oi(qr),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=hf(this.persistenceKey,this.ku),this.qu="firestore_sequence_number_"+this.persistenceKey,this.Ou=this.Ou.st(this.ku,new Ef),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.$u)}function Rf(){this.activeTargetIds=Xi}function Lf(t,e){this.clientId=t,this.onlineState=e}function xf(t,e){this.clientId=t,this.activeTargetIds=e}function Of(t,e,n){this.targetId=t,this.state=e,this.error=n}function Pf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Cf(u,a,c,h){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).nl("applyBatchState()"),[4,(e=o.La,n=a,i=(r=e).Gn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Zn(e,t):aa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,o.Bc.hu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(o.cl(a,h||null),o.La.Gn.Sr(a)):Vr(),t.label=4;case 4:return[4,o.hl(s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Vf(h,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return r=h,!0!==f||!0===r.tl?[3,3]:(e=r.Uc.zu(),[4,Uf(r,e.N())]);case 1:return i=t.sent(),r.tl=!0,[4,r.Bc.Su(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Bc.listen(u);return[3,7];case 3:return!1!==f||!1===r.tl?[3,7]:(a=[],c=Promise.resolve(),r.Kc.forEach(function(t,e){r.Uc.ic(e)?a.push(e):c=c.then(function(){return r.rl(e),kh(r.La,e,!0)}),r.Bc.lu(e)}),[4,c]);case 4:return t.sent(),[4,Uf(r,a)];case 5:return t.sent(),(n=r).Hc.forEach(function(t,e){n.Bc.lu(e)}),n.Yc.Nh(),n.Hc=new Map,n.zc=new Oi(ui.P),r.tl=!1,[4,r.Bc.Su(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Uf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Kc.get(s))&&0!==a.length?[4,Dh(e.La,Eu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.jc.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,Rh((e=i).La,o.query,!0)];case 1:return n=t.sent(),r=o.view.Mc(n),[2,(e.el&&e.il(o.targetId,r.$c),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Lh(e.La,s)];case 8:return d=t.sent(),[4,Dh(e.La,d)];case 9:return u=t.sent(),[4,e.sl(Mf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Wc.Ea(r),n)]}})})}function Mf(t){return gu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ff(s,u,a,c){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).tl?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Kc.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.La,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=no.zt(u,"current"===a),[4,n.hl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,kh(n.La,u,!0)];case 6:return t.sent(),n.rl(u,c),[3,8];case 7:Vr(),t.label=8;case 8:return[2]}var r,e})})}function qf(){this.Pl=void 0,this.listeners=[]}var jf,Gf=(Zf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new qf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.fu.listen(e)];case 2:return i.Pl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ka(o,"Initialization of query '"+Su(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(u),u.xc(this.onlineState),r.Pl&&u.yl(r.Pl)&&this.pl(),[2]}})})},Zf.prototype.lu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.gl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]})})},Zf.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},Zf.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},Zf.prototype.al=function(i){this.onlineState=i;var o=!1;this.gl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xc(i)&&(o=!0)}),o&&this.pl()},Zf.prototype.bl=function(t){this.Vl.add(t),t.next()},Zf.prototype.vl=function(t){this.Vl.delete(t)},Zf.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},Zf),Bf=(Qf.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new eo(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},Qf.prototype.onError=function(t){this.Sl.error(t)},Qf.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},Qf.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},Qf.prototype.Nl=function(t){if(0<t.docChanges.length)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},Qf.prototype.kl=function(t){t=eo.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},Qf),zf=(Xf.prototype.Ph=function(t){this.xl=t},Xf.prototype.ns=function(e,r,i,o){var s=this;return r.hn()||i.isEqual(ni.min())?this.Ol(e,r):this.xl.Zn(e,o).next(function(t){var n=s.Ml(r,t);return(r.an()||r.un())&&s.Nc(r.nn,n,o,i)?s.Ol(e,r):(Lr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Su(r)),s.xl.ns(e,r,i).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},Xf.prototype.Ml=function(n,t){var r=new qi(ku(n));return t.forEach(function(t,e){e instanceof au&&Du(n,e)&&(r=r.add(e))}),r},Xf.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Xf.prototype.Ol=function(t,e){return Lr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Using full collection scan to execute query:",Su(e)),this.xl.ns(t,e,ni.min())},Xf),Hf=(Yf.prototype.Ir=function(t){return aa.resolve(0===this.Gn.length)},Yf.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,0<this.Gn.length&&this.Gn[this.Gn.length-1];var o=new sa(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Ph(a.key,i)),this.zn.Ar(t,a.key.path.p())}return aa.resolve(o)},Yf.prototype.Rr=function(t,e){return aa.resolve(this.Bl(e))},Yf.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return aa.resolve(this.Gn.length>i?this.Gn[i]:null)},Yf.prototype.Vr=function(){return aa.resolve(0===this.Gn.length?-1:this.Ll-1)},Yf.prototype.yr=function(t){return aa.resolve(this.Gn.slice())},Yf.prototype.Yn=function(t,e){var n=this,r=new Ph(e,0),i=new Ph(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),aa.resolve(o)},Yf.prototype.es=function(t,e){var r=this,i=new qi(qr);return e.forEach(function(t){var e=new Ph(t,0),n=new Ph(t,Number.POSITIVE_INFINITY);r.ql.St([e,n],function(t){i=i.add(t.kh)})}),aa.resolve(this.Ql(i))},Yf.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;ui.j(i)||(i=i.child(""));var o=new Ph(new ui(i),0),s=new qi(qr);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),aa.resolve(this.Ql(s))},Yf.prototype.Ql=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Bl(t);null!==e&&r.push(e)}),r},Yf.prototype.br=function(n,r){var i=this;Ur(0===this.Wl(r.batchId,"removed")),this.Gn.shift();var o=this.ql;return aa.forEach(r.mutations,function(t){var e=new Ph(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.ql=o})},Yf.prototype.Sr=function(t){},Yf.prototype.Nr=function(t,e){var n=new Ph(e,0),r=this.ql.Ct(n);return aa.resolve(e.isEqual(r&&r.key))},Yf.prototype.Cr=function(t){return this.Gn.length,aa.resolve()},Yf.prototype.Wl=function(t,e){return this.Ul(t)},Yf.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},Yf.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},Yf),Wf=(Kf.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},Kf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Kf.prototype.Ln=function(t,e){var n=this.docs.get(e);return aa.resolve(n?n.Or:null)},Kf.prototype.getEntries=function(t,e){var n=this,r=Gi;return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),aa.resolve(r)},Kf.prototype.ns=function(t,e,n){for(var r=Hi,i=new ui(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof au&&Du(e,c)&&(r=r.st(c.key,c))}return aa.resolve(r)},Kf.prototype.Kl=function(t,e){return aa.forEach(this.docs,function(t){return e(t)})},Kf.prototype.jr=function(t){return new Kf.Kr(this)},Kf.prototype.zr=function(t){return aa.resolve(this.size)},Kf);function Kf(t,e){this.zn=t,this.jl=e,this.docs=new Oi(ui.P),this.size=0}function Yf(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new qi(Ph.yh)}function Xf(){}function Qf(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}function Zf(t){this.fu=t,this.gl=new Jr(Au,_u),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}function Jf(t){var e=this;return(e=jf.call(this)||this).Hr=t,e}Wf.Kr=(o(Jf,jf=ca),Jf.prototype.Un=function(n){var r=this,i=[];return this.Fn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),aa.Cn(i)},Jf.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},Jf.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},Jf);var $f,tl,el=(ml.prototype.be=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),aa.resolve()},ml.prototype.ro=function(t){return aa.resolve(this.lastRemoteSnapshotVersion)},ml.prototype.oo=function(t){return aa.resolve(this.zl)},ml.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),aa.resolve(this.highestTargetId)},ml.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),aa.resolve()},ml.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new ih(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},ml.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,aa.resolve()},ml.prototype.lo=function(t,e){return this.uo(e),aa.resolve()},ml.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),--this.targetCount,aa.resolve()},ml.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gl.delete(t),u.push(o.fo(n,e.targetId)),s++)}),aa.Cn(u).next(function(){return s})},ml.prototype.do=function(t){return aa.resolve(this.targetCount)},ml.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return aa.resolve(n)},ml.prototype.To=function(t,e,n){return this.Hl.vh(e,n),aa.resolve()},ml.prototype.Io=function(e,t,n){this.Hl.Dh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),aa.Cn(i)},ml.prototype.fo=function(t,e){return this.Hl.Ch(e),aa.resolve()},ml.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return aa.resolve(n)},ml.prototype.Nr=function(t,e){return aa.resolve(this.Hl.Nr(e))},ml),nl=(gl.prototype.start=function(){return Promise.resolve()},gl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(gl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),gl.prototype.Bo=function(){},gl.prototype.Uo=function(){},gl.prototype.uh=function(){return this.zn},gl.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new Hf(this.zn,this.dr),this.Jl[t.$h()]=e),e},gl.prototype.hh=function(){return this.ko},gl.prototype.ah=function(){return this.Kn},gl.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new rl(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},gl.prototype.e_=function(e,n){return aa.Nn(Object.values(this.Jl).map(function(t){return function(){return t.Nr(e,n)}}))},gl),rl=(o(vl,tl=fa),vl),il=(yl.i_=function(t){return new yl(t)},Object.defineProperty(yl.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw Vr()},enumerable:!1,configurable:!0}),yl.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),aa.resolve()},yl.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),aa.resolve()},yl.prototype.Dr=function(t,e){return this.r_.add(e.toString()),aa.resolve()},yl.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},yl.prototype.Zl=function(){this.s_=new Set},yl.prototype.t_=function(n){var r=this,i=this.persistence.ah().jr();return aa.forEach(this.r_,function(t){var e=ui.B(t);return r.o_(n,e).next(function(t){t||i.Mn(e)})}).next(function(){return r.s_=null,i.apply(n)})},yl.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},yl.prototype.Xl=function(t){return 0},yl.prototype.o_=function(t,e){var n=this;return aa.Nn([function(){return aa.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},yl),ol=(dl.prototype.wa=function(t){this.u_=t},dl.prototype.ca=function(t){this.c_=t},dl.prototype.onMessage=function(t){this.l_=t},dl.prototype.close=function(){this.a_()},dl.prototype.send=function(t){this.h_(t)},dl.prototype.__=function(){this.u_()},dl.prototype.f_=function(t){this.c_(t)},dl.prototype.d_=function(t){this.l_(t)},dl),sl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ul=(pl.prototype.va=function(e,t,n,r){var i=this.I_(e,t);xr("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(e,i,o,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},pl.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},pl.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1-202072605451",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},pl.prototype.I_=function(t,e){var n=sl[t];return this.T_+"/v1/"+e+":"+n},o(ll,$f=pl),ll.prototype.A_=function(a,e,n,r){return new Promise(function(o,s){var u=new Ar;u.listenOnce(Nr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Tr.NO_ERROR:var t=u.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Tr.TIMEOUT:xr("Connection",'RPC "'+a+'" timed out'),s(new ti($r.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var e,n,r=u.getStatus();xr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values($r).indexOf(i)?i:$r.UNKNOWN,s(new ti(n,e.message))):s(new ti($r.UNKNOWN,"Server responded with status "+u.getStatus())):s(new ti($r.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{xr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},ll.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}xr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new ol({h_:function(t){f?xr("Connection","Not sending because WebChannel is closed:",t):(h||(xr("Connection","Opening WebChannel transport."),c.open(),h=!0),xr("Connection","WebChannel sending:",t),c.send(t))},a_:function(){return c.close()}});return a(_r.EventType.OPEN,function(){f||xr("Connection","WebChannel transport opened.")}),a(_r.EventType.CLOSE,function(){f||(f=!0,xr("Connection","WebChannel transport closed"),l.f_())}),a(_r.EventType.ERROR,function(t){f||(f=!0,Pr("Connection","WebChannel transport errored:",t),l.f_(new ti($r.UNAVAILABLE,"The operation could not be completed")))}),a(_r.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Ur(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(xr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Si[i];if(void 0!==t)return xi(t)}(),s=r.message,void 0===o&&(o=$r.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.f_(new ti(o,s)),c.close()):(xr("Connection","WebChannel received:",n),l.d_(n)))}),setTimeout(function(){l.__()},0),l},ll),al=(fl.prototype.Ka=function(t){this.y_.push(t)},fl.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},fl.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},fl.prototype.P_=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},fl.prototype.V_=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},fl.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fl),cl=(hl.prototype.Ka=function(t){},hl.prototype.th=function(){},hl);function hl(){}function fl(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}function ll(t){var e=this;return(e=$f.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function pl(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function dl(t){this.h_=t.h_,this.a_=t.a_}function yl(t){this.persistence=t,this.n_=new Oh,this.s_=null}function vl(t){var e=this;return(e=tl.call(this)||this).Ro=t,e}function gl(t){var e=this;this.Jl={},this.yo=new da(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new el(this),this.zn=new xc,this.Kn=new Wf(this.zn,function(t){return e.dr.Xl(t)})}function ml(t){this.persistence=t,this.Gl=new Jr(Ei,Ii),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this.zl=0,this.Hl=new Oh,this.targetCount=0,this.Yl=ih.to()}function wl(t){return new Vo(t,!0)}var bl,El,Il="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tl=(kl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uc=this.b_(e),this.persistence=this.v_(e),[4,this.persistence.start()];case 1:return t.sent(),this.S_=this.D_(e),this.La=this.C_(e),[2]}})})},kl.prototype.D_=function(t){return null},kl.prototype.C_=function(t){return e=this.persistence,n=new zf,r=t.N_,new Th(e,n,r);var e,n,r},kl.prototype.v_=function(t){if(t.k_.F_)throw new ti($r.FAILED_PRECONDITION,Il);return new nl(il.i_)},kl.prototype.b_=function(t){return new Tf},kl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},kl.prototype.clearPersistence=function(t,e){throw new ti($r.FAILED_PRECONDITION,Il)},kl),Nl=(o(Dl,El=Tl),Dl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,El.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.La)];case 2:return t.sent(),[2]}})})},Dl.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new tc(e,t.ei)},Dl.prototype.v_=function(t){var e=Ih(t.w_.s,t.w_.persistenceKey),n=wl(t.w_.s);return new dh(t.k_.synchronizeTabs,e,t.clientId,Za.Ui(t.k_.cacheSizeBytes),t.ei,ja(),Ga(),n,this.Uc,t.k_.Vo)},Dl.prototype.b_=function(t){return new Tf},Dl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Aa.ks()?(e=n+"main",[4,Aa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ih(t,e))},o(Sl,bl=Dl),Sl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,bl.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.x_.initialize(this,r)];case 2:return t.sent(),e=this.x_.fu,this.Uc instanceof If?(this.Uc.fu={Ic:Cf.bind(null,e),mc:Ff.bind(null,e),Ac:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=f).tl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Kc.has(i)?(xr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Lh(n.La,i)]):[3,6];case 2:return o=t.sent(),[4,Dh(n.La,o)];case 3:return s=t.sent(),[4,n.sl(Mf(o),s.targetId,!1)];case 4:t.sent(),n.Bc.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Kc.has(e)?[4,kh(n.La,e,!1).then(function(){n.Bc.lu(e),n.rl(e)}).catch(xh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.La.persistence.rh()}.bind(null,e)},[4,this.Uc.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Vf(this.x_.fu,e)];case 1:return t.sent(),this.S_&&(e&&!this.S_.tr?this.S_.start(this.La):e||this.S_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},Sl.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=ja();if(!If.ks(e))throw new ti($r.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ih(t.w_.s,t.w_.persistenceKey);return new If(e,t.ei,n,t.clientId,t.N_)}return new Tf},Sl),_l=(Al.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.La?[3,3]:(this.La=n.La,this.Uc=n.Uc,this.qa=this.O_(r),this.Bc=this.M_(r),this.fu=this.L_(r),this.q_=this.B_(r),this.Uc.Da=function(t){return e.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return t.sent(),[4,this.Bc.Su(this.fu.el)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Al.prototype.B_=function(t){return new Gf(this.fu)},Al.prototype.O_=function(t){var e,n,r=wl(t.w_.s),i=(e=t.w_,new ul(e));return n=t.credentials,new Qh(n,i,r)},Al.prototype.M_=function(t){var e=this;return new Jh(this.La,this.qa,t.ei,function(t){return e.fu.xc(t,0)},new(al.ks()?al:cl))},Al.prototype.L_=function(t){return e=this.La,n=this.Bc,r=this.qa,i=this.Uc,o=t.N_,s=t.Qc,u=!t.k_.F_||!t.k_.synchronizeTabs,a=new _f(e,n,r,i,o,s),u&&(a.tl=!0),a;var e,n,r,i,o,s,u,a},Al.prototype.terminate=function(){return this.Bc.th()},Al);function Al(){}function Sl(t){var e=this;return(e=bl.call(this)||this).x_=t,e}function Dl(){return null!==El&&El.apply(this,arguments)||this}function kl(){}function Rl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Ll=(xl.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},xl.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},xl.prototype.Q_=function(){this.muted=!0},xl.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},xl);function xl(t){this.observer=t,this.muted=!1}function Ol(t,e){if(0!==e.length)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Zl(e.length,"argument")+".")}function Pl(t,e,n){if(e.length!==n)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires "+Zl(n,"argument")+", but was called with "+Zl(e.length,"argument")+".")}function Cl(t,e,n){if(e.length<n)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Zl(n,"argument")+", but was called with "+Zl(e.length,"argument")+".")}function Vl(t,e,n,r){if(e.length<n||e.length>r)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Zl(e.length,"argument")+".")}function Ul(t,e,n,r){Bl(t,e,Ql(n)+" argument",r)}function Ml(t,e,n,r){void 0!==r&&Ul(t,e,n,r)}function Fl(t,e,n,r){Bl(t,e,n+" option",r)}function ql(t,e,n,r){void 0!==r&&Fl(t,e,n,r)}function jl(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Hl(s))}var u=Hl(n);throw new ti($r.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Gl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new ti($r.INVALID_ARGUMENT,"Invalid value "+Hl(r)+" provided to function "+t+"() for its "+Ql(n)+" argument. Acceptable values: "+e.join(", "));return r}function Bl(t,e,n,r){if(!("object"===e?zl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Hl(r);throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function zl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Hl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Wl(t,e,n){if(void 0===n)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ql(e)+" argument, but it was undefined.")}function Kl(n,t,r){Kr(t,function(t,e){if(r.indexOf(t)<0)throw new ti($r.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Yl(t,e,n,r){var i=Hl(r);return new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ql(n)+" argument to be a "+e+", but it was: "+i)}function Xl(t,e,n){if(n<=0)throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ql(e)+" argument to be a positive number, but it was: "+n+".")}function Ql(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Zl(t,e){return t+" "+e+(1===t?"":"s")}function Jl(){if("undefined"==typeof Uint8Array)throw new ti($r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $l(){if("undefined"==typeof atob)throw new ti($r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var tp,ep,np=(hp.fromBase64String=function(t){Pl("Blob.fromBase64String",arguments,1),Ul("Blob.fromBase64String","string",1,t),$l();try{return new hp(Ni.fromBase64String(t))}catch(t){throw new ti($r.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},hp.fromUint8Array=function(t){if(Pl("Blob.fromUint8Array",arguments,1),Jl(),!(t instanceof Uint8Array))throw Yl("Blob.fromUint8Array","Uint8Array",1,t);return new hp(Ni.fromUint8Array(t))},hp.prototype.toBase64=function(){return Pl("Blob.toBase64",arguments,0),$l(),this.W_.toBase64()},hp.prototype.toUint8Array=function(){return Pl("Blob.toUint8Array",arguments,0),Jl(),this.W_.toUint8Array()},hp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},hp.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},hp),rp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new ti($r.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Ul("FieldPath","string",e,t[e]),0===t[e].length)throw new ti($r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new si(t)},ip=(o(cp,ep=rp),cp.documentId=function(){return new cp(si.L().F())},cp.prototype.isEqual=function(t){if(!(t instanceof cp))throw Yl("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},cp),op=new RegExp("[~\\*/\\[\\]]"),sp=function(){this.K_=this},up=(o(ap,tp=sp),ap.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},ap.prototype.isEqual=function(t){return t instanceof ap},ap);function ap(t){var e=this;return(e=tp.call(this)||this).G_=t,e}function cp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ep.call(this,t)||this}function hp(t){$l(),this.W_=t}function fp(t,e,n){return new Fp({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var lp,pp,dp,yp,vp,gp,mp=(o(Up,gp=sp),Up.prototype.z_=function(t){return new As(t.path,new fs)},Up.prototype.isEqual=function(t){return t instanceof Up},Up),wp=(o(Vp,vp=sp),Vp.prototype.z_=function(t){var e=fp(this,t,!0),n=this.Z_.map(function(t){return Kp(t,e)}),r=new ls(n);return new As(t.path,r)},Vp.prototype.isEqual=function(t){return this===t},Vp),bp=(o(Cp,yp=sp),Cp.prototype.z_=function(t){var e=fp(this,t,!0),n=this.Z_.map(function(t){return Kp(t,e)}),r=new gs(n);return new As(t.path,r)},Cp.prototype.isEqual=function(t){return this===t},Cp),Ep=(o(Pp,dp=sp),Pp.prototype.z_=function(t){var e=new Es(t.serializer,Fo(t.serializer,this.tf));return new As(t.path,e)},Pp.prototype.isEqual=function(t){return this===t},Pp),Ip=(o(Op,pp=sp),Op.delete=function(){return Ol("FieldValue.delete",arguments),new Tp(new up("FieldValue.delete"))},Op.serverTimestamp=function(){return Ol("FieldValue.serverTimestamp",arguments),new Tp(new mp("FieldValue.serverTimestamp"))},Op.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cl("FieldValue.arrayUnion",arguments,1),new Tp(new wp("FieldValue.arrayUnion",t))},Op.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Cl("FieldValue.arrayRemove",arguments,1),new Tp(new bp("FieldValue.arrayRemove",t))},Op.increment=function(t){return Ul("FieldValue.increment","number",1,t),Pl("FieldValue.increment",arguments,1),new Tp(new Ep("FieldValue.increment",t))},Op),Tp=(o(xp,lp=Ip),xp.prototype.z_=function(t){return this.K_.z_(t)},xp.prototype.isEqual=function(t){return t instanceof xp&&this.K_.isEqual(t.K_)},xp),Np=(Object.defineProperty(Lp.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(Lp.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Lp.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},Lp.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},Lp.prototype.T=function(t){return qr(this.ef,t.ef)||qr(this.nf,t.nf)},Lp),_p=/^__.*__$/,Ap=function(t,e,n){this.sf=t,this.if=e,this.rf=n},Sp=(Rp.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new qs(t,this.data,this.qe,e)):n.push(new Fs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Hs(t,this.fieldTransforms)),n},Rp),Dp=(kp.prototype.hf=function(t,e){var n=[new qs(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Hs(t,this.fieldTransforms)),n},kp);function kp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Rp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Lp(t,e){if(Pl("GeoPoint",arguments,2),Ul("GeoPoint","number",1,t),Ul("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new ti($r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new ti($r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}function xp(t){var e=this;return(e=lp.call(this)||this).K_=t,e.G_=t.G_,e}function Op(){return pp.call(this)||this}function Pp(t,e){var n=this;return(n=dp.call(this)||this).G_=t,n.tf=e,n}function Cp(t,e){var n=this;return(n=yp.call(this)||this).G_=t,n.Z_=e,n}function Vp(t,e){var n=this;return(n=vp.call(this)||this).G_=t,n.Z_=e,n}function Up(t){var e=this;return(e=gp.call(this)||this).G_=t,e}function Mp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var Fp=(Object.defineProperty(Gp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Gp.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),Gp.prototype.uf=function(t){return new Gp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},Gp.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},Gp.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},Gp.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},Gp.prototype.Y_=function(t){return $p(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},Gp.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Gp.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},Gp.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(Mp(this.H_)&&_p.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},Gp),qp=(jp.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new Fp({H_:t,methodName:e,J_:n,path:si.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},jp);function jp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||wl(t)}function Gp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}function Bp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Qp("Data must be an object, but it was:",s,r);var u,a,c=Yp(r,s);if(o.merge)u=new _s(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof rp)d=p.j_;else{if("string"!=typeof p)throw Vr();d=Jp(e,p,n)}if(!s.contains(d))throw new ti($r.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");td(h,d)||h.push(d)}u=new _s(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Sp(new Js(c),u,a)}function zp(t,o,s,e){var u=t.wf(1,o,s);Qp("Data must be an object, but it was:",u,e);var a=[],c=new $s;Kr(e,function(t,e){var n,r=Jp(o,t,s),i=u._f(r);e instanceof sp&&e.K_ instanceof up?a.push(r):null!=(n=Kp(e,i))&&(a.push(r),c.set(r,n))});var n=new _s(a);return new Dp(c.ze(),n,u.fieldTransforms)}function Hp(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[Zp(e,r,n)],a=[i];if(o.length%2!=0)throw new ti($r.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Zp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],y=new $s,v=u.length-1;0<=v;--v){td(d,u[v])||(h=u[v],f=a[v],l=s._f(h),f instanceof sp&&f.K_ instanceof up?d.push(h):null!=(p=Kp(f,l))&&(d.push(h),y.set(h,p)))}var g=new _s(d);return new Dp(y.ze(),g,s.fieldTransforms)}function Wp(t,e,n,r){return void 0===r&&(r=!1),Kp(n,t.wf(r?4:3,e))}function Kp(s,t){if(Xp(s))return Qp("Unsupported field value:",t,s),Yp(s,t);if(s instanceof sp)return function(t,e){if(!Mp(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.X_&&4!==t.H_)throw t.Y_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Kp(i[r],t.ff(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Fo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:qo(e.serializer,n)}}if(t instanceof ei){var r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:qo(e.serializer,r)}}if(t instanceof Np)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof np)return{bytesValue:jo(e.serializer,t)};if(t instanceof Ap){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Bo(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+Hl(t))}(s,t)}function Yp(t,r){var i={};return Yr(t)?r.path&&0<r.path.length&&r.qe.push(r.path):Kr(t,function(t,e){var n=Kp(e,r.cf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Xp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Np||t instanceof np||t instanceof Ap||t instanceof sp)}function Qp(t,e,n){if(!Xp(n)||!zl(n)){var r=Hl(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function Zp(t,e,n){if(e instanceof rp)return e.j_;if("string"==typeof e)return Jp(t,e);throw $p("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Jp(t,e,n){try{return function(e){if(0<=e.search(op))throw new ti($r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ip.bind.apply(ip,s([void 0],e.split("."))))}catch(t){throw new ti($r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw $p(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function $p(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new ti($r.INVALID_ARGUMENT,(u+=". ")+t+a)}function td(t,e){return t.some(function(t){return t.isEqual(e)})}var ed=(sd.prototype.Af=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),0<this.mutations.length)throw new ti($r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Xo((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Ho(i.serializer,t)})},[4,i.Sa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Ur(!!e.found),e.found.name,e.found.updateTime;var n=Wo(t,e.found.name),r=Go(e.found.updateTime),i=new Js({mapValue:{fields:e.found.fields}});return new au(n,r,i,{})}(e,n):"missing"in n?function(t,e){Ur(!!e.missing),Ur(!!e.readTime);var n=Wo(t,e.missing),r=Go(e.readTime);return new cu(n,r)}(e,n):Vr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Ur(!!e),s.push(e)}),s)]}})})}(this.qa,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof cu||t instanceof au?n.Pf(t):Vr()}),e)]}})})},sd.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},sd.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},sd.prototype.delete=function(t){this.write([new Qs(t,this.Qe(t))]),this.mf.add(t.toString())},sd.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),this.If)throw this.If;return e=this.Tf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=ui.B(e);r.mutations.push(new Zs(n,r.Qe(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Xo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Jo(e.serializer,t)})},[4,e.va("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return t.sent(),this.Ef=!0,[2]}})})},sd.prototype.Pf=function(t){var e;if(t instanceof au)e=t.version;else{if(!(t instanceof cu))throw Vr();e=ni.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ti($r.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},sd.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?ks.updateTime(e):ks.We()},sd.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(this.mf.has(t.toString())||!e)return ks.exists(!0);if(e.isEqual(ni.min()))throw new ti($r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ks.updateTime(e)},sd.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},sd.prototype.Rf=function(){},sd),nd=(od.prototype.run=function(){this.yf()},od.prototype.yf=function(){var t=this;this.Ti.bs(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new ed(this.qa),(n=this.pf(e))&&n.then(function(t){r.ei.ai(function(){return e.commit().then(function(){r.ii.resolve(t)}).catch(function(t){r.bf(t)})})}).catch(function(t){r.bf(t)}),[2]})})})},od.prototype.pf=function(t){try{var e=this.updateFunction(t);return!vi(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},od.prototype.bf=function(t){var e=this;0<this.Vf&&this.vf(t)?(--this.Vf,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},od.prototype.vf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Li(e)},od),rd=(id.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new Ta,s=!1;return this.credentials.Bh(function(t){return s?void i.ei.gi(function(){return i.Bc.vu(t)}):(s=!0,xr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject))}),this.ei.ai(function(){return i.Sf.promise}),o.promise},id.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()})},id.prototype.Cf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:u,Qc:100,k_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Uc=i.Uc,this.La=i.La,this.S_=i.S_,this.qa=o.qa,this.Bc=o.Bc,this.fu=o.fu,this.Nf=o.q_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Ff(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Cf(new Tl,new _l,{F_:!1},u,a))];case 4:return[2]}})})},id.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===$r.FAILED_PRECONDITION||t.code===$r.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},id.prototype.Df=function(){if(this.ei.Ii)throw new ti($r.FAILED_PRECONDITION,"The client has already been terminated.")},id.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()})},id.prototype.terminate=function(){var t=this;this.ei.Pi();var r=new Ta;return this.ei.mi(function(){return g(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return t.sent(),[4,this.Uc.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.Uh(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Ka(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},id.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new Ta;return this.ei.ai(function(){return t.fu._l(e)}),e.promise},id.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Ll(n),o=new Bf(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lu(o)})}},id.prototype.kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,u,a){return g(this,void 0,void 0,function(){var s,e=this;return w(this,function(t){switch(t.label){case 0:return s=new Ta,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Rh.Hn(t,e)}))];case 1:return(r=t.sent())instanceof au?s.resolve(r):r instanceof cu?s.resolve(null):s.reject(new ti($r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Ka(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.ei,this.La,e))]}})})},id.prototype.$f=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ta,s=ud(e,n,mu(r.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new ti($r.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new ti($r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},id.prototype.xf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,a,c){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new Ta,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Rh(a,c,!0)];case 1:return e=t.sent(),n=new Nf(c,e.gh),r=n.Sc(e.documents),i=n.Un(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ka(o,"Failed to execute query '"+c+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ei,this.La,e))]}})})},id.prototype.Of=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ta,s=ud(e,n,r,{includeMetadataChanges:!0,$l:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new ti($r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},id.prototype.write=function(t){var e=this;this.Df();var n=new Ta;return this.ei.ai(function(){return e.fu.write(t,n)}),n.promise},id.prototype.s=function(){return this.w_.s},id.prototype.bl=function(t){var e=this;this.Df();var n=new Ll(t);return this.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(id.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),id.prototype.transaction=function(t){var e=this;this.Df();var n=new Ta;return this.ei.ai(function(){return new nd(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},id);function id(t,e){this.credentials=t,this.ei=e,this.clientId=Mr.t(),this.Sf=new Ta}function od(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new _a(this.ei,"transaction_retry")}function sd(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}function ud(t,e,n,r,i){var o=new Ll(i),s=new Bf(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lu(s)})}}var ad,cd,hd=(Dd.prototype.Bf=function(t){switch(wo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ao(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new np(So(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw Vr()}},Dd.prototype.Gf=function(t){var n=this,r={};return Kr(t.fields||{},function(t,e){r[t]=n.Bf(e)}),r},Dd.prototype.jf=function(t){return new Np(Ao(t.latitude),Ao(t.longitude))},Dd.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},Dd.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return vo(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(go(t));default:return null}},Dd.prototype.Uf=function(t){var e=_o(t),n=new ei(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Dd.prototype.Wf=function(t){var e=ii.k(t);Ur(ss(e));var n=new zr(e.get(1),e.get(3)),r=new ui(e.V(5));return n.isEqual(this.s)||Or("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},Dd),fd=Za.ji,ld=(Sd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Sd),pd=(Object.defineProperty(Ad.prototype,"rd",{get:function(){return this.od||(this.od=new qp(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),Ad.prototype.settings=function(t){Pl("Firestore.settings",arguments,1),Ul("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new ld(t);if(this.Zf&&!this.sd.isEqual(e))throw new ti($r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.sd=e).credentials&&(this.nd=function(t){if(!t)return new Bh;switch(t.type){case"gapi":var e=t.hd;return Ur(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Wh(e,t.zh||"0");case"provider":return t.hd;default:throw new ti($r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Ad.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},Ad.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},Ad.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new ti($r.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new ti($r.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},Ad.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.Zf&&!this.Zf.Mf)throw new ti($r.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ta,[2,(this.Jf.mi(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Ad.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ad.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),Ad.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},Ad.prototype.onSnapshotsInSync=function(t){if(this.Xf(),Rl(t))return this.Zf.bl(t);Ul("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},Ad.prototype.Xf=function(){return this.Zf||this.ad(new Tl,new _l,{F_:!1}),this.Zf},Ad.prototype.ld=function(){return new Br(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},Ad.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new rd(this.nd,this.Jf),this.Zf.start(r,t,e,n)},Ad.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new ti($r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new ti($r.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new zr(n)},Object.defineProperty(Ad.prototype,"app",{get:function(){if(!this.Yf)throw new ti($r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),Ad.prototype.collection=function(t){return Pl("Firestore.collection",arguments,1),Ul("Firestore.collection","non-empty string",1,t),this.Xf(),new Vd(ii.k(t),this,null)},Ad.prototype.doc=function(t){return Pl("Firestore.doc",arguments,1),Ul("Firestore.doc","non-empty string",1,t),this.Xf(),vd._d(ii.k(t),this,null)},Ad.prototype.collectionGroup=function(t){if(Pl("Firestore.collectionGroup",arguments,1),Ul("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new ti($r.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Pd((e=t,new yu(ii.$(),e)),this,null);var e},Ad.prototype.runTransaction=function(e){var n=this;return Pl("Firestore.runTransaction",arguments,1),Ul("Firestore.runTransaction","function",1,e),this.Xf().transaction(function(t){return e(new dd(n,t))})},Ad.prototype.batch=function(){return this.Xf(),new yd(this)},Object.defineProperty(Ad,"logLevel",{get:function(){switch(Lr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Ad.setLogLevel=function(t){Pl("Firestore.setLogLevel",arguments,1),Gl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},Ad.prototype.fd=function(){return this.sd.timestampsInSnapshots},Ad.prototype.dd=function(){return this.sd},Ad),dd=(_d.prototype.get=function(t){var n=this;Pl("Transaction.get",arguments,1);var r=Bd("Transaction.get",t,this.wd);return this.Td.Af([r.if]).then(function(t){if(!t||1!==t.length)return Vr();var e=t[0];if(e instanceof cu)return new md(n.wd,r.if,null,!1,!1,r.rf);if(e instanceof au)return new md(n.wd,r.if,e,!1,!1,r.rf);throw Vr()})},_d.prototype.set=function(t,e,n){Vl("Transaction.set",arguments,2,3);var r=Bd("Transaction.set",t,this.wd);n=qd("Transaction.set",n);var i=zd(r.rf,e,n),o=Bp(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},_d.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ip?(Cl("Transaction.update",arguments,3),r=Bd("Transaction.update",t,this.wd),Hp(this.wd.rd,"Transaction.update",r.if,e,n,o)):(Pl("Transaction.update",arguments,2),r=Bd("Transaction.update",t,this.wd),zp(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},_d.prototype.delete=function(t){Pl("Transaction.delete",arguments,1);var e=Bd("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},_d),yd=(Nd.prototype.set=function(t,e,n){Vl("WriteBatch.set",arguments,2,3),this.md();var r=Bd("WriteBatch.set",t,this.wd);n=qd("WriteBatch.set",n);var i=zd(r.rf,e,n),o=Bp(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,ks.We())),this},Nd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),i="string"==typeof e||e instanceof ip?(Cl("WriteBatch.update",arguments,3),r=Bd("WriteBatch.update",t,this.wd),Hp(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(Pl("WriteBatch.update",arguments,2),r=Bd("WriteBatch.update",t,this.wd),zp(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,ks.exists(!0))),this},Nd.prototype.delete=function(t){Pl("WriteBatch.delete",arguments,1),this.md();var e=Bd("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new Qs(e.if,ks.We())),this},Nd.prototype.commit=function(){return this.md(),this.Id=!0,0<this.Ed.length?this.wd.Xf().write(this.Ed):Promise.resolve()},Nd.prototype.md=function(){if(this.Id)throw new ti($r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Nd),vd=(o(Td,cd=Ap),Td._d=function(t,e,n){if(t.length%2!=0)throw new ti($r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new Td(new ui(t),e,n)},Object.defineProperty(Td.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"parent",{get:function(){return new Vd(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),Td.prototype.collection=function(t){if(Pl("DocumentReference.collection",arguments,1),Ul("DocumentReference.collection","non-empty string",1,t),!t)throw new ti($r.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ii.k(t);return new Vd(this.if.path.child(e),this.firestore,null)},Td.prototype.isEqual=function(t){if(!(t instanceof Td))throw Yl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},Td.prototype.set=function(t,e){Vl("DocumentReference.set",arguments,1,2),e=qd("DocumentReference.set",e);var n=zd(this.rf,t,e),r=Bp(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,ks.We()))},Td.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ip?(Cl("DocumentReference.update",arguments,2),Hp(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Pl("DocumentReference.update",arguments,1),zp(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,ks.exists(!0)))},Td.prototype.delete=function(){return Pl("DocumentReference.delete",arguments,0),this.Zf.write([new Qs(this.if,ks.We())])},Td.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Vl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Rl(i[u])||(Kl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),ql("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};Rl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Ul("DocumentReference.onSnapshot","function",u,i[u]),Ml("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ml("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(mu(this.if.path),c,h)},Td.prototype.get=function(t){var e=this;Vl("DocumentReference.get",arguments,0,1),Gd("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new md(e.firestore,e.if,t,!0,t instanceof au&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Ad(t)})},Td.prototype.withConverter=function(t){return new Td(this.if,this.firestore,t)},Td.prototype.Ad=function(t){var e=t.docs.get(this.if);return new md(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},Td),gd=(Id.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Id),md=(Ed.prototype.data=function(t){var e=this;if(Vl("DocumentSnapshot.data",arguments,0,1),t=jd("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new wd(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new hd(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",function(t){return new vd(t,e.wd,null)}).Bf(this.Rd.tn())}},Ed.prototype.get=function(t,e){var n=this;if(Vl("DocumentSnapshot.get",arguments,1,2),e=jd("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(Zp("DocumentSnapshot.get",t,this.if));if(null!==r)return new hd(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",function(t){return new vd(t,n.wd,n.rf)}).Bf(r)}},Object.defineProperty(Ed.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"ref",{get:function(){return new vd(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"metadata",{get:function(){return new gd(this.gd,this.Pd)},enumerable:!1,configurable:!0}),Ed.prototype.isEqual=function(t){if(!(t instanceof Ed))throw Yl("isEqual","DocumentSnapshot",1,t);return this.wd===t.wd&&this.Pd===t.Pd&&this.if.isEqual(t.if)&&(null===this.Rd?null===t.Rd:this.Rd.isEqual(t.Rd))&&this.rf===t.rf},Ed),wd=(o(bd,ad=md),bd.prototype.data=function(t){return ad.prototype.data.call(this,t)},bd);function bd(){return null!==ad&&ad.apply(this,arguments)||this}function Ed(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}function Id(t,e){this.hasPendingWrites=t,this.fromCache=e}function Td(t,e,n){var r=this;return(r=cd.call(this,e.sf,t,n)||this).if=t,r.firestore=e,r.rf=n,r.Zf=r.firestore.Xf(),r}function Nd(t){this.wd=t,this.Ed=[],this.Id=!1}function _d(t,e){this.wd=t,this.Td=e}function Ad(t,e,n,r){var i=this;if(void 0===n&&(n=new Tl),void 0===r&&(r=new _l),this.zf=n,this.Hf=r,this.Yf=null,this.Jf=new za,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Yf=o,this.sf=Ad.td(o),this.ed=o.name,this.nd=new zh(e)}else{var s=t;if(!s.projectId)throw new ti($r.INVALID_ARGUMENT,"Must provide projectId");this.sf=new zr(s.projectId,s.database),this.ed="[DEFAULT]",this.nd=new Bh}this.sd=new ld({})}function Sd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new ti($r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Fl("settings","non-empty string","host",t.host),this.host=t.host,ql("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Kl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ql("settings","object","credentials",t.credentials),this.credentials=t.credentials,ql("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ql("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ql("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Za.Gi;else{if(t.cacheSizeBytes!==fd&&t.cacheSizeBytes<Za.Ki)throw new ti($r.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Za.Ki);this.cacheSizeBytes=t.cacheSizeBytes}ql("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Dd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}function kd(t,e,n){if("string"==typeof n){if(""===n)throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!wu(e)&&-1!==n.indexOf("/"))throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ii.k(n));if(!ui.j(r))throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Do(t,new ui(r))}if(n instanceof Ap)return Do(t,n.if);throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Hl(n)+".")}function Rd(t,e){if(!Array.isArray(t)||0===t.length)throw new ti($r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new ti($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new ti($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new ti($r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Ld(t,e,n){if(!n.isEqual(e))throw new ti($r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function xd(t){if(t.un()&&0===t.en.length)throw new ti($r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Od,Pd=(Fd.prototype.where=function(t,e,n){var r;Pl("Query.where",arguments,3),Wl("Query.where",3,n),r="not-in"===e||"!="===e?e:Gl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Zp("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.M()){if("array-contains"===o||"array-contains-any"===o)throw new ti($r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Rd(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(kd(r,t,f))}u={arrayValue:{values:a}}}else u=kd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Rd(s,o),u=Wp(n,e,s,"in"===o||"not-in"===o);var l=Lu.create(i,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new ti($r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&Ld(0,e.field,r)}var i=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new ti($r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ti($r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.Vd,"Query.where",this.firestore.rd,this.firestore.sf,s,r,n);return new Fd((i=this.Vd,o=i.filters.concat([u]),new yu(i.path,i.collectionGroup,i.en.slice(),o,i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.rf)},Fd.prototype.orderBy=function(t,e){var n;if(Vl("Query.orderBy",arguments,1,2),Ml("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new ti($r.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Zp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new ti($r.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ti($r.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new oa(e,n);return i=s,null!==(r=t).cn()||null!==(o=r.ln())&&Ld(0,o,i.field),s}(this.Vd,o,n);return new Fd((r=this.Vd,i=r.en.concat([s]),new yu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.rf)},Fd.prototype.limit=function(t){return Pl("Query.limit",arguments,1),Ul("Query.limit","number",1,t),Xl("Query.limit",1,t),new Fd(Iu(this.Vd,t,"F"),this.firestore,this.rf)},Fd.prototype.limitToLast=function(t){return Pl("Query.limitToLast",arguments,1),Ul("Query.limitToLast","number",1,t),Xl("Query.limitToLast",1,t),new Fd(Iu(this.Vd,t,"L"),this.firestore,this.rf)},Fd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cl("Query.startAt",arguments,1);var r=this.yd("Query.startAt",t,e,!0);return new Fd(Tu(this.Vd,r),this.firestore,this.rf)},Fd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cl("Query.startAfter",arguments,1);var r=this.yd("Query.startAfter",t,e,!1);return new Fd(Tu(this.Vd,r),this.firestore,this.rf)},Fd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cl("Query.endBefore",arguments,1);var r=this.yd("Query.endBefore",t,e,!0);return new Fd(Nu(this.Vd,r),this.firestore,this.rf)},Fd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Cl("Query.endAt",arguments,1);var r=this.yd("Query.endAt",t,e,!1);return new Fd(Nu(this.Vd,r),this.firestore,this.rf)},Fd.prototype.isEqual=function(t){if(!(t instanceof Fd))throw Yl("isEqual","Query",1,t);return this.firestore===t.firestore&&_u(this.Vd,t.Vd)&&this.rf===t.rf},Fd.prototype.withConverter=function(t){return new Fd(this.Vd,this.firestore,t)},Fd.prototype.yd=function(h,t,e,n){if(Wl(h,1,t),t instanceof md)return Pl(h,s([t],e),1),function(t,e,n,r){if(!n)throw new ti($r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=bu(t);o<s.length;o++){var u=s[o];if(u.field.M())i.push(Do(e,n.key));else{var a=n.field(u.field);if(vo(a))throw new ti($r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.F();throw new ti($r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Zu(i,r)}(this.Vd,this.firestore.sf,t.Rd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new ti($r.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new ti($r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!wu(t)&&-1!==c.indexOf("/"))throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.k(c));if(!ui.j(h))throw new ti($r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ui(h);u.push(Do(e,f))}else{var l=Wp(n,r,c);u.push(l)}}return new Zu(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,h,r,n)},Fd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Vl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Rl(i[a])||(Kl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),ql("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Rl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Ul("Query.onSnapshot","function",a,i[a]),Ml("Query.onSnapshot","function",a+1,i[a+1]),Ml("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new Cd(r.firestore,r.Vd,t,r.rf))},error:i[a+1],complete:i[a+2]};return xd(this.Vd),this.firestore.Xf().listen(this.Vd,u,c)},Fd.prototype.get=function(t){var e=this;Vl("Query.get",arguments,0,1),Gd("Query.get",t),xd(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then(function(t){return new Cd(e.firestore,e.Vd,t,e.rf)})},Fd),Cd=(Object.defineProperty(Md.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),Md.prototype.forEach=function(e,n){var r=this;Vl("QuerySnapshot.forEach",arguments,1,2),Ul("QuerySnapshot.forEach","function",1,e),this.bd.docs.forEach(function(t){e.call(n,r.Dd(t,r.metadata.fromCache,r.bd.qt.has(t.key)))})},Object.defineProperty(Md.prototype,"query",{get:function(){return new Pd(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),Md.prototype.docChanges=function(t){t&&(Kl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ql("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new ti($r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},Md.prototype.isEqual=function(t){if(!(t instanceof Md))throw Yl("isEqual","QuerySnapshot",1,t);return this.wd===t.wd&&_u(this.pd,t.pd)&&this.bd.isEqual(t.bd)&&this.rf===t.rf},Md.prototype.Dd=function(t,e,n){return new wd(this.wd,t.key,t,e,n,this.rf)},Md),Vd=(o(Ud,Od=Pd),Object.defineProperty(Ud.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new vd(new ui(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),Ud.prototype.doc=function(t){Vl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Mr.t()),Ul("CollectionReference.doc","non-empty string",1,t);var e=ii.k(t);return vd._d(this.Vd.path.child(e),this.firestore,this.rf)},Ud.prototype.add=function(t){Pl("CollectionReference.add",arguments,1),Ul("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Ud.prototype.withConverter=function(t){return new Ud(this.Cd,this.firestore,t)},Ud);function Ud(t,e,n){var r=this;if(((r=Od.call(this,mu(t),e,n)||this).Cd=t).length%2!=1)throw new ti($r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Md(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new gd(n.hasPendingWrites,n.fromCache)}function Fd(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}function qd(t,e){if(void 0===e)return{merge:!1};if(Kl(t,e,["merge","mergeFields"]),ql(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Hl(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new ti($r.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Hl(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof ip}),void 0!==e.mergeFields&&void 0!==e.merge)throw new ti($r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function jd(t,e){return void 0===e?{}:(Kl(t,e,["serverTimestamps"]),jl(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Gd(t,e){Ml(t,"object",1,e),e&&(Kl(t,e,["source"]),jl(t,0,"source",e.source,["default","server","cache"]))}function Bd(t,e,n){if(e instanceof Ap){if(e.firestore!==n)throw new ti($r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Yl(t,"DocumentReference",1,e)}function zd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Hd,Wd={Firestore:pd,GeoPoint:Np,Timestamp:ei,Blob:np,Transaction:dd,WriteBatch:yd,DocumentReference:vd,DocumentSnapshot:md,Query:Pd,QueryDocumentSnapshot:wd,QuerySnapshot:Cd,CollectionReference:Vd,FieldPath:ip,FieldValue:Ip,setLogLevel:pd.setLogLevel,CACHE_SIZE_UNLIMITED:fd};(Hd=r.default).INTERNAL.registerComponent(new Sr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new _l,i=new Nl(r),new pd(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Wd))),Hd.registerVersion("@firebase/firestore","1.16.6-202072605451")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
