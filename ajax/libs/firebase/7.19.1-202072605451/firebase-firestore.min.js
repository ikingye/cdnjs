!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(qd){"use strict";try{(function(){var t,l,e,n,r=(n=qd)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,m="FirebaseError",b=(o(E,v=Error),E);function E(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=m,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(N,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var N=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k=D||self;function R(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),C=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:U).apply(null,arguments)}function F(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++C))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var Y,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var J=k.navigator;if(J){var $=J.userAgent;if($){Y=$;break t}}Y=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=R;var ot,st,ut=Q(Y,"Opera"),at=Q(Y,"Trident")||Q(Y,"MSIE"),ct=Q(Y,"Edge"),ht=ct||at,ft=Q(Y,"Gecko")&&!(Q(Y.toLowerCase(),"webkit")&&!Q(Y,"Edge"))&&!(Q(Y,"Trident")||Q(Y,"MSIE"))&&!Q(Y,"Edge"),lt=Q(Y.toLowerCase(),"webkit")&&!Q(Y,"Edge");function pt(){var t=k.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=Y,ft?/rv:([^\);]+)(\)|;)/.exec(st):ct?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=X(String(ot)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=k.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),It=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",R,e),k.removeEventListener("test",R,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},j(Nt,Tt);var _t={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),St=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Pt={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[At]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[At]?t.va(e,n,O(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!bt)return null;var u,a,c=jt(t);if(c||(t[Ot]=c=new Rt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=qt,r=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Lt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):kt(t)))}function Mt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Ft(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function qt(t,e){if(t.Y)return!0;if(bt)return Ft(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ft(t,e=new Nt(e,this))}function jt(t){return(t=t[Ot])instanceof Rt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==L(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function zt(){G.call(this),this.c=new Rt(this),(this.J=this).C=null}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Lt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(zt,G),zt.prototype[At]=!0,(S=zt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ht(o,r,!0,t)&&s;if(s=Ht(o=t.a=n,r,!0,t)&&s,s=Ht(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ht(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(zt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=k.JSON.stringify;function Kt(){this.b=this.a=null}var Yt,Xt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Zt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function Jt(t,e){var n;Yt||(n=k.Promise.resolve(void 0),Yt=function(){n.then(ee)}),$t||(Yt(),$t=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Kt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Xt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||k,this.f=M(this.Ya,this),this.g=q()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==L(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}j(ne,zt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ue,ae=(_(se=he,ue=oe=G),se.prototype=null===ue?Object.create(ue):(ce.prototype=ue.prototype,new ce),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){oe.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ce(){this.constructor=se}function he(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){G.call(this),this.b=t,this.a={}}j(fe,G);var le=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function ye(){this.a=!0}function ve(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),de(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var ge=null;function me(){return ge=ge||new zt}function we(t){Tt.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){Tt.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Te(t){Tt.call(this,"timingevent",t)}function Ne(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}j(we,Tt),j(Ee,Tt),j(Te,Tt);var _e={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Se.prototype.a=null;var Re,Le={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function xe(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Pe(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=Ve,t=ht?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(xe,Tt),j(Oe,Tt),j(Pe,Se),Re=new Pe;var Ve=45e3,Ue={},Me={};function Fe(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),Ge(t),t.l=tn(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ie(),u=!1),ve(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ue){t.h=4,Ie(),ve(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ve(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Ie(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ve(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),He(t))}function Ge(t){t.U=q()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(M(t.Ua,t),e)}function ze(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function He(t){0==t.g.v||t.A||ar(t.g,t)}function We(t){ze(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ur(p),Qn(p)}ir(p),Ie()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ne(M(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||ur(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Dn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,sn(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=lr(o,o.C?o.ga:null,o.fa),h.C?(kn(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(ze(f),Ge(f)),o.a=h):rr(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Xn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);be()}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ce.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||be(),ze(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,c=this.m,h=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+c+"\n"+h+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ie(),We(this),He(this);break t}ve(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(je(this,e,i),ht&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ve(this.c,this.f,i,null),Ke(this,i)),4==e&&We(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,Ge(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),We(this),He(this)}}}catch(t){}var a,c,h,f,l,p,d},S.Va=function(){var t,e;this.a&&(t=Hn(this.a),e=this.a.$(),this.D<e.length&&(ze(this),je(this,t,e),this.b&&4!=t&&Ge(this)))},S.cancel=function(){this.A=!0,We(this)},S.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),We(this),this.h=2,He(this)):Be(this,this.U-n)},(S=Xe.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Qe(this),this.a.concat()},S.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},S.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new vn).c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new vn(null,this.a))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof vn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=cn(e,dn)),t.b=new vn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,yn)),t.join("")};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Xe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=En(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function wn(t,e){return gn(t),e=En(t,e),Ze(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),W(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||Nn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=vn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=H(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Nn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Ln(){}function xn(){this.a=new Ln}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t,e;if(this.c=Rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Pn=k.JSON.parse;function Cn(t){zt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}j(Cn,zt);var Vn="",Un=/^https?$/i,Mn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Bn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=Hn(t)||2!=t.X()))if(t.l&&4==Hn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Hn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Je)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Un.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){zn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Xn(t){var e,n;Zn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=q(),Ge(e)),fr(t)}function Qn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function Zn(t){Qn(t),t.j&&(k.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&$n(t)}function $n(t){_n(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Fe(n,r,e)}function er(t,n){t.f&&Ye({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ye(t,function(t,e){var n=t;O(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ne(M(t.Aa,t),cr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,qe(n,t)}function ur(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ar(t,e){var n,r=null;if(t.a==e){ur(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,(i=me()).dispatchEvent(new Te(i)),$n(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ne(M(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||en(n,"https"),un(n)),i=n.toString(),o=r,u=new ye,k.Image?((s=new Image).onload=F(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=F(On,u,s,"TestLoadImage: error",!1,o),s.onabort=F(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=F(On,u,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),fr(t),Zn(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==Rn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof $e?tn(r):new $e(r,void 0);return""!=h.c?(e&&nn(h,e+"."+h.c),rn(h,h.h)):(o=(i=k.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new $e(null,void 0),o&&en(c,o),s&&nn(c,s),u&&rn(c,u),a&&(c.g=a),h=c),t.W&&tt(t.W,function(t,e){sn(h,e,t)}),e=t.A,n=t.na,e&&n&&sn(h,e,n),sn(h,"VER",t.ha),er(t,h),h}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function dr(){}function yr(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function vr(t,e){zt.call(this),this.a=new Yn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){Oe.call(this),this.status=1}function wr(t){this.a=t}(S=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(Re),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var i,o=new Xe(this.headers);r&&Ye(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=(i=this.a,at&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},S.Ta=function(){Gn(this)},S.X=function(){try{return 2<Hn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Yn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Wn(i,this.i,r),Dn(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||_n(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ne(M(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Qn(this),ir(this),Ie())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},yr.prototype.a=function(t,e){return new vr(t,e)},j(vr,zt),(S=vr.prototype).addEventListener=function(t,e,n,r){vr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){vr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=lr(t,null,t.fa),$n(t)},S.close=function(){Xn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Wt(t),Jn(this.a,e)):Jn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Xn(this.a),delete this.a,vr.S.G.call(this)},j(gr,xe),j(mr,Oe),j(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},yr.prototype.createWebChannel=yr.prototype.a,vr.prototype.send=vr.prototype.Pa,vr.prototype.open=vr.prototype.Oa,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Ae.COMPLETE="complete",(ke.EventType=Le).OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var br={createWebChannelTransport:function(){return new yr},ErrorCode:_e,EventType:Ae,WebChannel:ke,XhrIo:Cn},Er=br.createWebChannelTransport,Ir=br.ErrorCode,Tr=br.EventType,Nr=br.WebChannel,_r=br.XhrIo,Ar=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr="7.19.1-202072605451",kr=new p("@firebase/firestore");function Rr(){return kr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.DEBUG&&(e=n.map(Pr),kr.debug.apply(kr,s(["Firestore ("+Dr+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.ERROR&&(e=n.map(Pr),kr.error.apply(kr,s(["Firestore ("+Dr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.WARN&&(e=n.map(Pr),kr.warn.apply(kr,s(["Firestore ("+Dr+"): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Dr+") INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Vr(t){t||Cr()}var Ur=(Mr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Mr);function Mr(){}function Fr(t,e){return t<e?-1:e<t?1:0}function qr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function jr(t){return t+"\0"}function Gr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Br=(Object.defineProperty(zr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return t instanceof zr&&t.projectId===this.projectId&&t.database===this.database},zr.prototype.o=function(t){return Fr(this.projectId,t.projectId)||Fr(this.database,t.database)},zr);function zr(t,e){this.projectId=t,this.database=e||"(default)"}function Hr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Yr,Xr,Qr,Zr=(di.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},di.prototype.has=function(t){return void 0!==this.get(t)},di.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},di.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},di.prototype.forEach=function(u){Wr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},di.prototype._=function(){return Kr(this.l)},di),Jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$r=(o(pi,Qr=Error),pi),ti=(li.now=function(){return li.fromMillis(Date.now())},li.fromDate=function(t){return li.fromMillis(t.getTime())},li.fromMillis=function(t){var e=Math.floor(t/1e3);return new li(e,1e6*(t-1e3*e))},li.prototype.toDate=function(){return new Date(this.toMillis())},li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},li.prototype.T=function(t){return this.seconds===t.seconds?Fr(this.nanoseconds,t.nanoseconds):Fr(this.seconds,t.seconds)},li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},li),ei=(fi.I=function(t){return new fi(t)},fi.min=function(){return new fi(new ti(0,0))},fi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},fi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},fi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},fi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},fi.prototype.A=function(){return this.timestamp},fi),ni=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.P(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},hi.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},hi.prototype.v=function(){return this.segments[this.offset]},hi.prototype.S=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype._=function(){return 0===this.length},hi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},hi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ri=(o(ci,Xr=ni),ci.prototype.g=function(t,e,n){return new ci(t,e,n)},ci.prototype.F=function(){return this.N().join("/")},ci.prototype.toString=function(){return this.F()},ci.k=function(t){if(0<=t.indexOf("//"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ci(t.split("/").filter(function(t){return 0<t.length}))},ci.$=function(){return new ci([])},ci),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(o(ai,Yr=ni),ai.prototype.g=function(t,e,n){return new ai(t,e,n)},ai.O=function(t){return ii.test(t)},ai.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.O(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.F()},ai.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},ai.L=function(){return new ai(["__name__"])},ai.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new $r(Jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $r(Jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new $r(Jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.$=function(){return new ai([])},ai),si=(ui.B=function(t){return new ui(ri.k(t))},ui.U=function(t){return new ui(ri.k(t).V(5))},ui.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.P(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.P=function(t,e){return ri.P(t.path,e.path)},ui.j=function(t){return t.length%2==0},ui.K=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==Yr&&Yr.apply(this,arguments)||this}function ci(){return null!==Xr&&Xr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.R=n}function fi(t){this.timestamp=t}function li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t,e){var n=this;return(n=Qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function di(t,e){this.h=t,this.u=e,this.l={}}function yi(t){return null==t}function vi(t){return-0===t&&1/t==-1/0}function gi(t){return"number"==typeof t&&Number.isInteger(t)&&!vi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e,n=t;return null===n.G&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+To(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),yi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=ta(n.startAt)),n.endAt&&(e+="|ub:",e+=ta(n.endAt)),n.G=e),n.G}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!wo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!na(t.startAt,e.startAt)&&na(t.endAt,e.endAt)}function Ii(t){return si.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ti=(Ni.fromBase64String=function(t){return new Ni(atob(t))},Ni.fromUint8Array=function(t){return new Ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ni.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ni.prototype.Y=function(){return 2*this.H.length},Ni.prototype.o=function(t){return Fr(this.H,t.H)},Ni.prototype.isEqual=function(t){return this.H===t.H},Ni);function Ni(t){this.H=t}function _i(t){this.count=t}Ti.J=new Ti("");var Ai,Si,Di=(ki.prototype.tt=function(t){return new ki(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ki.prototype.et=function(t,e){return new ki(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ki.prototype.nt=function(t){return new ki(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},ki);function ki(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=Ti.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ri(t){switch(t){case Jr.OK:return Cr(),0;case Jr.CANCELLED:case Jr.UNKNOWN:case Jr.DEADLINE_EXCEEDED:case Jr.RESOURCE_EXHAUSTED:case Jr.INTERNAL:case Jr.UNAVAILABLE:case Jr.UNAUTHENTICATED:return;case Jr.INVALID_ARGUMENT:case Jr.NOT_FOUND:case Jr.ALREADY_EXISTS:case Jr.PERMISSION_DENIED:case Jr.FAILED_PRECONDITION:case Jr.ABORTED:case Jr.OUT_OF_RANGE:case Jr.UNIMPLEMENTED:case Jr.DATA_LOSS:return 1;default:return Cr(),0}}function Li(t){if(void 0===t)return xr("GRPC error has no .code"),Jr.UNKNOWN;switch(t){case Ai.OK:return Jr.OK;case Ai.CANCELLED:return Jr.CANCELLED;case Ai.UNKNOWN:return Jr.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return Jr.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return Jr.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return Jr.INTERNAL;case Ai.UNAVAILABLE:return Jr.UNAVAILABLE;case Ai.UNAUTHENTICATED:return Jr.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return Jr.INVALID_ARGUMENT;case Ai.NOT_FOUND:return Jr.NOT_FOUND;case Ai.ALREADY_EXISTS:return Jr.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return Jr.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return Jr.FAILED_PRECONDITION;case Ai.ABORTED:return Jr.ABORTED;case Ai.OUT_OF_RANGE:return Jr.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return Jr.UNIMPLEMENTED;case Ai.DATA_LOSS:return Jr.DATA_LOSS;default:return Cr()}}(Si=Ai=Ai||{})[Si.OK=0]="OK",Si[Si.CANCELLED=1]="CANCELLED",Si[Si.UNKNOWN=2]="UNKNOWN",Si[Si.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Si[Si.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Si[Si.NOT_FOUND=5]="NOT_FOUND",Si[Si.ALREADY_EXISTS=6]="ALREADY_EXISTS",Si[Si.PERMISSION_DENIED=7]="PERMISSION_DENIED",Si[Si.UNAUTHENTICATED=16]="UNAUTHENTICATED",Si[Si.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Si[Si.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Si[Si.ABORTED=10]="ABORTED",Si[Si.OUT_OF_RANGE=11]="OUT_OF_RANGE",Si[Si.UNIMPLEMENTED=12]="UNIMPLEMENTED",Si[Si.INTERNAL=13]="INTERNAL",Si[Si.UNAVAILABLE=14]="UNAVAILABLE",Si[Si.DATA_LOSS=15]="DATA_LOSS";var xi=(Ui.prototype.st=function(t,e){return new Ui(this.P,this.root.st(t,e,this.P).copy(null,null,Pi.it,null,null))},Ui.prototype.remove=function(t){return new Ui(this.P,this.root.remove(t,this.P).copy(null,null,Pi.it,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype._=function(){return this.root._()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.rt=function(){return this.root.rt()},Ui.prototype.ot=function(){return this.root.ot()},Ui.prototype.ht=function(t){return this.root.ht(t)},Ui.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.at=function(t){return this.root.at(t)},Ui.prototype.ut=function(){return new Oi(this.root,null,this.P,!1)},Ui.prototype.ct=function(t){return new Oi(this.root,t,this.P,!1)},Ui.prototype.lt=function(){return new Oi(this.root,null,this.P,!0)},Ui.prototype._t=function(t){return new Oi(this.root,t,this.P,!0)},Ui),Oi=(Vi.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Vi.prototype.Tt=function(){return 0<this.dt.length},Vi.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Vi),Pi=(Ci.prototype.copy=function(t,e,n,r,i){return new Ci(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ci.prototype._=function(){return!1},Ci.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ci.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Ci.prototype.min=function(){return this.left._()?this:this.left.min()},Ci.prototype.rt=function(){return this.min().key},Ci.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Ci.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},Ci.prototype.At=function(){if(this.left._())return Ci.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.At(),null)).It()},Ci.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.Pt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.gt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ci.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.At())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.It()},Ci.prototype.Rt=function(){return this.color},Ci.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},Ci.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},Ci.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},Ci.prototype.yt=function(){var t=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ci.prototype.gt=function(){var t=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ci.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ci.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Ci.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Cr();if(this.right.Rt())throw Cr();var t=this.left.vt();if(t!==this.right.vt())throw Cr();return t+(this.Rt()?0:1)},Ci);function Ci(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ci.RED,this.left=null!=r?r:Ci.EMPTY,this.right=null!=i?i:Ci.EMPTY,this.size=this.left.size+1+this.right.size}function Vi(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Ui(t,e){this.P=t,this.root=e||Pi.EMPTY}function Mi(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.it=!1,Pi.EMPTY=(Object.defineProperty(Mi.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Mi.prototype.copy=function(t,e,n,r,i){return this},Mi.prototype.st=function(t,e,n){return new Pi(t,e)},Mi.prototype.remove=function(t,e){return this},Mi.prototype._=function(){return!0},Mi.prototype.ht=function(t){return!1},Mi.prototype.at=function(t){return!1},Mi.prototype.rt=function(){return null},Mi.prototype.ot=function(){return null},Mi.prototype.Rt=function(){return!1},Mi.prototype.bt=function(){return!0},Mi.prototype.vt=function(){return 0},new Mi);var Fi=(Bi.prototype.has=function(t){return null!==this.data.get(t)},Bi.prototype.first=function(){return this.data.rt()},Bi.prototype.last=function(){return this.data.ot()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Bi.prototype.indexOf=function(t){return this.data.indexOf(t)},Bi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Bi.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Bi.prototype.Dt=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},Bi.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},Bi.prototype.ut=function(){return new qi(this.data.ut())},Bi.prototype.ct=function(t){return new qi(this.data.ct(t))},Bi.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},Bi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Bi.prototype._=function(){return this.data._()},Bi.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Bi.prototype.isEqual=function(t){if(!(t instanceof Bi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(0!==this.P(r,i))return!1}return!0},Bi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Bi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Bi.prototype.copy=function(t){var e=new Bi(this.P);return e.data=t,e},Bi),qi=(Gi.prototype.wt=function(){return this.Ft.wt().key},Gi.prototype.Tt=function(){return this.Ft.Tt()},Gi),ji=new xi(si.P);function Gi(t){this.Ft=t}function Bi(t){this.P=t,this.data=new xi(this.P)}var zi=new xi(si.P),Hi=new xi(si.P),Wi=new Fi(si.P);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Wi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Yi=new Fi(Fr);function Xi(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r}function Qi(t,e){this.targetId=t,this.ne=e}function Zi(t,e,n,r){void 0===n&&(n=Ti.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Ji=(fo.xt=function(t){return new fo(t.P)},fo.prototype.has=function(t){return null!=this.kt.get(t)},fo.prototype.get=function(t){return this.kt.get(t)},fo.prototype.first=function(){return this.$t.rt()},fo.prototype.last=function(){return this.$t.ot()},fo.prototype._=function(){return this.$t._()},fo.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(fo.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),fo.prototype.forEach=function(n){this.$t.ht(function(t,e){return n(t),!1})},fo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},fo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},fo.prototype.isEqual=function(t){if(!(t instanceof fo))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.ut(),n=t.$t.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(!r.isEqual(i))return!1}return!0},fo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},fo.prototype.copy=function(t,e){var n=new fo;return n.P=this.P,n.kt=t,n.$t=e,n},fo),$i=(ho.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);!n||0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):Cr()},ho.prototype.Mt=function(){var n=[];return this.Ot.ht(function(t,e){n.push(e)}),n},ho),to=(co.Qt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new co(t,e,Ji.xt(e),i,n,r,!0,!1)},Object.defineProperty(co.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),co.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&Tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},co),eo=(ao.zt=function(t,e){var n=new Map;return n.set(t,no.Ht(t,e)),new ao(ei.min(),n,Yi,ji,Ki())},ao),no=(uo.Ht=function(t,e){return new uo(Ti.J,e,Ki(),Ki(),Ki())},uo),ro=(Object.defineProperty(so.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),so.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},so.prototype.le=function(){var n=Ki(),r=Ki(),i=Ki();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new no(this.re,this.oe,n,r,i)},so.prototype._e=function(){this.he=!1,this.ie=po()},so.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},so.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},so.prototype.we=function(){this.se+=1},so.prototype.Te=function(){--this.se},so.prototype.Ee=function(){this.he=!0,this.oe=!0},so),io=(oo.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof su?this.Ve(r,t.ee):t.ee instanceof uu&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},oo.prototype.pe=function(n){var r=this;this.be(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.Se(t)&&e.ce(n.resumeToken);break;case 1:e.Te(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.Te(),e.ae||r.removeTarget(t);break;case 3:r.Se(t)&&(e.Ee(),e.ce(n.resumeToken));break;case 4:r.Se(t)&&(r.De(t),e.ce(n.resumeToken));break;default:Cr()}})},oo.prototype.be=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.Se(e)&&n(e)})},oo.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ne.count,o=this.Ne(r);o&&(Ii(e=o.target)?0===i?(n=new si(e.path),this.ye(r,n,new uu(n,ei.min()))):Vr(1===i):this.Fe(r)!==i&&(this.De(r),this.Pe=this.Pe.add(r)))},oo.prototype.ke=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.Ne(e);r&&(t.Yt&&Ii(r.target)&&(n=new si(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ye(e,n,new uu(n,i))),t.ue&&(s.set(e,t.le()),t._e()))});var r=Ki();this.Re.forEach(function(t,e){var n=!0;e.Dt(function(t){var e=o.Ne(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new eo(i,s,this.Pe,this.Ae,r);return this.Ae=ji,this.Re=lo(),this.Pe=new Fi(Fr),t},oo.prototype.Ve=function(t,e){var n;this.Se(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t)))},oo.prototype.ye=function(t,e,n){var r;this.Se(t)&&(r=this.ve(t),this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n)))},oo.prototype.removeTarget=function(t){this.me.delete(t)},oo.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},oo.prototype.we=function(t){this.ve(t).we()},oo.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new ro,this.me.set(t,e)),e},oo.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new Fi(Fr),this.Re=this.Re.st(t,e)),e},oo.prototype.Se=function(t){var e=null!==this.Ne(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},oo.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},oo.prototype.De=function(e){var n=this;this.me.set(e,new ro),this.Ie.Oe(e).forEach(function(t){n.ye(e,t,null)})},oo.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},oo);function oo(t){this.Ie=t,this.me=new Map,this.Ae=ji,this.Re=lo(),this.Pe=new Fi(Fr)}function so(){this.se=0,this.ie=po(),this.re=Ti.J,this.oe=!1,this.he=!0}function uo(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}function ao(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}function co(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}function ho(){this.Ot=new xi(si.P)}function fo(n){this.P=n?function(t,e){return n(t,e)||si.P(t.key,e.key)}:function(t,e){return si.P(t.key,e.key)},this.kt=zi,this.$t=new xi(this.P)}function lo(){return new xi(si.P)}function po(){return new xi(si.P)}function yo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vo(t){var e=No(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(e.seconds,e.nanos)}var go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yo(t)?4:10:Cr()}function wo(r,i){var t,e,n,o=mo(r);if(o!==mo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return vo(r).isEqual(vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=No(r.timestampValue),n=No(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Ao(r.bytesValue).isEqual(Ao(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,_o((t=r).geoPointValue.latitude)===_o(e.geoPointValue.latitude)&&_o(t.geoPointValue.longitude)===_o(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return _o(t.integerValue)===_o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=_o(t.doubleValue),r=_o(e.doubleValue);return n===r?vi(n)===vi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return qr(r.arrayValue.values||[],i.arrayValue.values||[],wo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Hr(t)!==Hr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!wo(t[n],e[n])))return!1;return!0}();default:return Cr()}}function bo(t,e){return void 0!==(t.values||[]).find(function(t){return wo(t,e)})}function Eo(t,e){var n,r,i,o,s,u,a,c,h,f,l=mo(t),p=mo(e);if(l!==p)return Fr(l,p);switch(l){case 0:return 0;case 1:return Fr(t.booleanValue,e.booleanValue);case 2:return c=e,(h=_o(t.integerValue||t.doubleValue))<(f=_o(c.integerValue||c.doubleValue))?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(vo(t),vo(e));case 5:return Fr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Fr(n[i],r[i]);if(0!==o)return o}return Fr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Fr(_o(n.latitude),_o(r.latitude)))?i:Fr(_o(n.longitude),_o(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Eo(n[i],r[i]);if(o)return o}return Fr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Fr(r[s],o[s]);if(0!==u)return u;var a=Eo(n[r[s]],i[o[s]]);if(0!==a)return a}return Fr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Fr(t,e);var n=No(t),r=No(e),i=Fr(n.seconds,r.seconds);return 0!==i?i:Fr(n.nanos,r.nanos)}function To(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=No(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ao(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,si.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Cr();var t,e,n}(t)}function No(t){if(Vr(!!t),"string"!=typeof t)return{seconds:_o(t.seconds),nanos:_o(t.nanos)};var e,n=0,r=go.exec(t);Vr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function _o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Ti.fromBase64String(t):Ti.fromUint8Array(t)}function So(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function Do(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function Ro(t){return t&&"nullValue"in t}function Lo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Co=function(t,e){this.s=t,this.Le=e};function Vo(t){return{integerValue:""+t}}function Uo(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Mo(t,e){return gi(e)?Vo(e):Uo(t,e)}function Fo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function jo(t){return Vr(!!t),ei.I((e=No(t),new ti(e.seconds,e.nanos)));var e}function Go(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function Bo(t){var e=ri.k(t);return Vr(os(e)),e}function zo(t,e){return Go(t.s,e.path)}function Ho(t,e){var n=Bo(e);return Vr(n.get(1)===t.s.projectId),Vr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new si(Xo(n))}function Wo(t,e){return Go(t.s,e)}function Ko(t){var e=Bo(t);return 4===e.length?ri.$():Xo(e)}function Yo(t){return new ri(["projects",t.s.projectId,"databases",t.s.database]).F()}function Xo(t){return Vr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Qo(t,e,n){return{name:zo(t,e),fields:n.proto.mapValue.fields}}function Zo(t,e){var n,r,i,o;if(e instanceof Us)n={update:Qo(t,e.key,e.value)};else if(e instanceof Ys)n={delete:zo(t,e.key)};else if(e instanceof Ms)n={update:Qo(t,e.key,e.data),updateMask:(r=e.qe,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof Bs)n={transform:{document:zo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof fs)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof vs)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.F(),increment:e.Be};throw Cr()})}};else{if(!(e instanceof Xs))return Cr();n={verify:zo(t,e.key)}}return e.Qe.Ue||(n.currentDocument=void 0!==(o=e.Qe).updateTime?{updateTime:Fo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Cr()),n}function Jo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ds.updateTime(jo(n.updateTime)):void 0!==n.exists?Ds.exists(n.exists):Ds.We():Ds.We();if(t.update){t.update.name;var o=Ho(e,t.update.name),s=new Qs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ns(r.map(function(t){return oi.q(t)})));return new Ms(o,s,u,i)}return new Us(o,s,i)}if(t.delete){var a=Ho(e,t.delete);return new Ys(a,i)}if(t.transform){var c=Ho(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Vr("REQUEST_TIME"===e.setToServerValue),i=new hs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new fs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new vs(r)):"increment"in e?i=new bs(t,e.increment):Cr();var o=oi.q(e.fieldPath);return new _s(o,i)}(e,t)});return Vr(!0===i.exists),new Bs(c,h)}if(t.verify){var f=Ho(e,t.verify);return new Xs(f,i)}return Cr()}function $o(t,e){return{documents:[Wo(t,e.path)]}}function ts(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Wo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Wo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NAN"}};if(Ro(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rs(t.field),op:(e=t.op,Po[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:rs((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||yi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=es(e.endAt)),n}function es(t){return{before:t.before,values:t.position}}function ns(t){var e=!!t.before,n=t.values||[];return new Xu(n,e)}function rs(t){return{fieldPath:t.F()}}function is(t){return oi.q(t.fieldPath)}function os(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ss(){this.je=void 0}function us(t,e){return t instanceof bs?Do(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var as,cs,hs=(o(ps,cs=ss),ps),fs=(o(ls,as=ss),ls);function ls(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ps(){return null!==cs&&cs.apply(this,arguments)||this}function ds(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return wo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ys,vs=(o(gs,ys=ss),gs);function gs(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function ms(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!wo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(o(Es,ws=ss),Es);function Es(t,e){var n=this;return(n=ws.call(this)||this).serializer=t,n.Be=e,n}function Is(t){return _o(t.integerValue||t.doubleValue)}function Ts(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ns=(As.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},As.prototype.isEqual=function(t){return qr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As),_s=function(t,e){this.field=t,this.transform=e};function As(t){(this.fields=t).sort(oi.P)}function Ss(t,e){this.version=t,this.transformResults=e}var Ds=(ks.We=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof su&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof su}function Ls(){}function xs(t,e,n,r){return t instanceof Us?function(t,e){if(!Rs(t.Qe,e))return e;var n=Ps(e);return new su(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Ms?function(t,e){if(!Rs(t.Qe,e))return e;var n=Ps(e),r=js(t,e);return new su(t.key,n,r,{Ge:!0})}(t,e):t instanceof Bs?function(t,e,n,r){if(!Rs(t.Qe,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof su&&(y=n.field(p.field)),null===y&&r instanceof su&&(y=r.field(p.field)),h.push((o=y,c=a=u=s=void 0,(i=d)instanceof hs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof fs?ds(i,o):i instanceof vs?ms(i,o):(a=Is(u=us(s=i,o))+Is(s.Be),Do(u)&&Do(s.Be)?Vo(a):Uo(s.serializer,a))))}return h}(t.fieldTransforms,n,e,r),s=Hs(t,i.data(),o);return new su(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Rs((i=t).Qe,o)?new uu(i.key,ei.min()):o);var i,o}function Os(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||qr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof fs&&o instanceof fs||i instanceof vs&&o instanceof vs?qr(i.elements,o.elements,wo):i instanceof bs&&o instanceof bs?wo(i.Be,o.Be):i instanceof hs&&o instanceof hs);var n,r,i,o}))}function Ps(t){return t instanceof su?t.version:ei.min()}var Cs,Vs,Us=(o(qs,Vs=Ls),qs),Ms=(o(Fs,Cs=Ls),Fs);function Fs(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.qe=n,i.Qe=r,i.type=1,i}function qs(t,e,n){var r=this;return(r=Vs.call(this)||this).key=t,r.value=e,r.Qe=n,r.type=0,r}function js(t,e){return n=t,r=e instanceof su?e.data():Qs.empty(),i=new Zs(r),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Gs,Bs=(o(zs,Gs=Ls),zs);function zs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Qe=Ds.exists(!0),n}function Hs(t,e,n){for(var r=new Zs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Ws,Ks,Ys=(o(eu,Ks=Ls),eu),Xs=(o(tu,Ws=Ls),tu),Qs=($s.empty=function(){return new $s({mapValue:{}})},$s.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},$s.prototype.isEqual=function(t){return wo(this.proto,t.proto)},$s),Zs=(Js.prototype.set=function(t,e){return this.Je(t,e),this},Js.prototype.delete=function(t){return this.Je(t,null),this},Js.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===mo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Js.prototype.ze=function(){var t=this.Xe(oi.$(),this.Ye);return null!=t?new Qs(t):this.He},Js.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Js);function Js(t){void 0===t&&(t=Qs.empty()),this.He=t,this.Ye=new Map}function $s(t){this.proto=t}function tu(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.Qe=e,n.type=4,n}function eu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Qe=e,n.type=3,n}function nu(t,e){this.key=t,this.version=e}var ru,iu,ou,su=(o(fu,ou=nu),fu.prototype.field=function(t){return this.Ze.field(t)},fu.prototype.data=function(){return this.Ze},fu.prototype.tn=function(){return this.Ze.proto},fu.prototype.isEqual=function(t){return t instanceof fu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},fu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu),uu=(o(hu,iu=nu),hu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),au=(o(cu,ru=nu),cu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu);function cu(){return null!==ru&&ru.apply(this,arguments)||this}function hu(t,e,n){var r=this;return(r=iu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fu(t,e,n,r){var i=this;return(i=ou.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $r(Jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $r(Jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var pu=(du.prototype.on=function(t){return new du(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},du.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},du.prototype.an=function(){return!yi(this.limit)&&"F"===this.nn},du.prototype.un=function(){return!yi(this.limit)&&"L"===this.nn},du.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},du.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},du.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},du);function du(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function yu(t,e,n,r,i,o,s,u){return new pu(t,e,n,r,i,o,s,u)}function vu(t){return new pu(t)}function gu(t){return null!==t.collectionGroup}function mu(t){var e=lu(t,pu);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new ra(n)),e.sn.push(new ra(oi.L(),"asc"));else{for(var i,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.M()&&(o=!0)}o||(i=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new ra(oi.L(),i)))}}return e.sn}function wu(t){var e=lu(t,pu);if(!e.rn)if("F"===e.nn)e.rn=wi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ra(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.rn=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function bu(t,e,n){return new pu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return new pu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function Iu(t,e){return new pu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function Tu(t,e){return Ei(wu(t),wu(e))&&t.nn===e.nn}function Nu(t){return bi(wu(t))+"|lt:"+t.nn}function _u(t){return"Query(target="+(n=(e=wu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+To(e.value);var e}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ta(e.startAt)),e.endAt&&(n+=", endAt: "+ta(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function Au(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.W(r.collectionGroup)&&r.path.D(o):si.j(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.M()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||ea(e.startAt,mu(e),n))&&(!e.endAt||!ea(e.endAt,mu(e),n)));var e,n,r,o}function Su(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.M()?si.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Eo(o,s):Cr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.M()}return 0}}var Du,ku=(o(Ru,Du=function(){}),Ru.create=function(t,e,n){if(t.M())return"in"===e||"not-in"===e?this.dn(t,e,n):new Pu(t,e,n);if(Ro(n)){if("=="!==e&&"!="!==e)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Ru(t,e,n)}if(Lo(n)){if("=="!==e&&"!="!==e)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Ru(t,e,n)}return"array-contains"===e?new Hu(t,n):"in"===e?new Wu(t,n):"not-in"===e?new Ku(t,n):"array-contains-any"===e?new Yu(t,n):new Ru(t,e,n)},Ru.dn=function(t,e,n){return new("in"===e?Cu:Vu)(t,n)},Ru.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(Eo(e,this.value)):null!==e&&mo(this.value)===mo(e)&&this.wn(Eo(e,this.value))},Ru.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},Ru.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Ru);function Ru(t,e,n){var r=this;return(r=Du.call(this)||this).field=t,r.op=e,r.value=n,r}var Lu,xu,Ou,Pu=(o(Fu,Ou=ku),Fu.prototype.matches=function(t){var e=si.P(t.key,this.key);return this.wn(e)},Fu),Cu=(o(Mu,xu=ku),Mu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Mu),Vu=(o(Uu,Lu=ku),Uu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Uu);function Uu(t,e){var n=this;return(n=Lu.call(this,t,"not-in",e)||this).keys=qu(0,e),n}function Mu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=qu(0,e),n}function Fu(t,e,n){var r=this;return(r=Ou.call(this,t,e,n)||this).key=si.U(n.referenceValue),r}function qu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return si.U(t.referenceValue)})}var ju,Gu,Bu,zu,Hu=(o($u,zu=ku),$u.prototype.matches=function(t){var e=t.field(this.field);return ko(e)&&bo(e.arrayValue,this.value)},$u),Wu=(o(Ju,Bu=ku),Ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&bo(this.value.arrayValue,e)},Ju),Ku=(o(Zu,Gu=ku),Zu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!bo(this.value.arrayValue,e)},Zu),Yu=(o(Qu,ju=ku),Qu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return bo(e.value.arrayValue,t)})},Qu),Xu=function(t,e){this.position=t,this.before=e};function Qu(t,e){return ju.call(this,t,"array-contains-any",e)||this}function Zu(t,e){return Gu.call(this,t,"not-in",e)||this}function Ju(t,e){return Bu.call(this,t,"in",e)||this}function $u(t,e){return zu.call(this,t,"array-contains",e)||this}function ta(t){return(t.before?"b":"a")+":"+t.position.map(To).join(",")}function ea(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.M()?si.P(si.U(s.referenceValue),n.key):Eo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function na(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!wo(t.position[n],e.position[n]))return!1;return!0}var ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ia=(ba.prototype.En=function(t,e,n){for(var r,i,o,s=n.In,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Us?new su(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ms?function(t,e,n){if(!Rs(t.Qe,e))return new au(t.key,n.version);var r=js(t,e);return new su(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Bs?function(t,e,n){if(Vr(null!=n.transformResults),!Rs(t.Qe,e))return new au(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof su&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof fs?ds(i,o):i instanceof vs?ms(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Hs(t,r.data(),i);return new su(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new uu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ba.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=xs(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=xs(a,e,o,this.Tn))}return e},ba.prototype.An=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.mn(t.key,n.get(t.key));e&&(i=i.st(t.key,e))}),i},ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,Os)&&qr(this.baseMutations,t.baseMutations,Os)},ba),oa=(wa.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=Hi,i=t.mutations,o=0;o<i.length;o++)r=r.st(i[o].key,n[o].version);return new wa(t,e,n,r)},wa),sa=(ma.prototype.catch=function(t){return this.next(void 0,t)},ma.prototype.next=function(r,i){var o=this;return this.pn&&Cr(),this.pn=!0,this.yn?this.error?this.bn(i,this.error):this.vn(r,this.result):new ma(function(e,n){o.gn=function(t){o.vn(r,t).next(e,n)},o.Vn=function(t){o.bn(i,t).next(e,n)}})},ma.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ma.prototype.Dn=function(t){try{var e=t();return e instanceof ma?e:ma.resolve(e)}catch(t){return ma.reject(t)}},ma.prototype.vn=function(t,e){return t?this.Dn(function(){return t(e)}):ma.resolve(e)},ma.prototype.bn=function(t,e){return t?this.Dn(function(){return t(e)}):ma.reject(e)},ma.resolve=function(n){return new ma(function(t,e){t(n)})},ma.reject=function(n){return new ma(function(t,e){e(n)})},ma.Cn=function(t){return new ma(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ma.Nn=function(t){for(var n=ma.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ma.resolve(t):e()})}(r[e]);return n},ma.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Cn(i)},ma),ua=(Object.defineProperty(ga.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),ga.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},ga.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},ga.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?sa.resolve(n):this.qn(t,e)},ga.prototype.getEntries=function(t,e){return this.Bn(t,e)},ga.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},ga.prototype.On=function(){},ga),aa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ca=(va.prototype.Wn=function(t){this.Qn.push(t)},va.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},va),ha=(ya.prototype.Hn=function(e,n){var r=this;return this.Gn.Yn(e,n).next(function(t){return r.Jn(e,n,t)})},ya.prototype.Jn=function(t,r,i){return this.Kn.Ln(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].mn(r,t);return t})},ya.prototype.Xn=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].mn(t,e);o=o.st(t,e)}),o},ya.prototype.Zn=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ts(e,t)})},ya.prototype.ts=function(r,i){var o=this;return this.Gn.es(r,i).next(function(t){var e=o.Xn(r,i,t),n=ji;return e.forEach(function(t,e){e=e||new uu(t,ei.min()),n=n.st(t,e)}),n})},ya.prototype.ns=function(t,e,n){return r=e,si.j(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ss(t,e.path):gu(e)?this.rs(t,e,n):this.os(t,e,n);var r},ya.prototype.ss=function(t,e){return this.Hn(t,new si(e)).next(function(t){var e=zi;return t instanceof su&&(e=e.st(t.key,t)),e})},ya.prototype.rs=function(n,r,i){var o=this,s=r.collectionGroup,u=zi;return this.zn.hs(n,s).next(function(t){return sa.forEach(t,function(t){var e=r.on(t.child(s));return o.os(n,e,i).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ya.prototype.os=function(e,n,t){var h,f,r=this;return this.Kn.ns(e,n,t).next(function(t){return h=t,r.Gn.as(e,n)}).next(function(t){return f=t,r.us(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=xs(s,a,a,r.Tn);h=c instanceof su?h.st(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Au(n,e)||(h=h.remove(t))}),h})},ya.prototype.us=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ms&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof su&&(c=c.st(t,e))}),c})},ya),fa=(da._s=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new da(t,e.fromCache,n,r)},da),la=(pa.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},pa.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},pa);function pa(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}function da(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}function ya(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}function va(){this.Qn=[]}function ga(){this.Fn=new Zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}function ma(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function wa(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}function ba(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function Ea(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}la.Es=-1;var Ia,Ta=(Ra.prototype.reset=function(){this.gs=0},Ra.prototype.ps=function(){this.gs=this.Ps},Ra.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},Ra.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},Ra.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},Ra.prototype.vs=function(){return(Math.random()-.5)*this.gs},Ra),Na=(ka.delete=function(t){return Lr("SimpleDb","Removing database:",t),Va(window.indexedDB.deleteDatabase(t)).Sn()},ka.ks=function(){if("undefined"==typeof indexedDB)return!1;if(ka.$s())return!0;var t=y(),e=ka.Fs(t),n=0<e&&e<10,r=ka.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},ka.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},ka.Ms=function(t,e){return t.store(e)},ka.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},ka.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},ka.prototype.Ls=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Lr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Aa("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new $r(Jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Aa(e))},i.onupgradeneeded=function(t){Lr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Ns.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Lr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return o.qs(t)}),this.db)]}})})},ka.prototype.Bs=function(e){this.qs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ka.prototype.runTransaction=function(r,c,h){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Ls()];case 2:return a.db=t.sent(),e=xa.open(a.db,s?"readonly":"readwrite",c),n=h(e).catch(function(t){return e.abort(t),sa.reject(t)}).Sn(),r={},n.catch(function(){}),[4,e.Us];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Lr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ka.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ka),_a=(Object.defineProperty(Da.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),Da.prototype.done=function(){this.Ws=!0},Da.prototype.Gs=function(t){this.js=t},Da.prototype.delete=function(){return Va(this.Qs.delete())},Da),Aa=(o(Sa,Ia=$r),Sa);function Sa(t){var e=this;return(e=Ia.call(this,Jr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Da(t){this.Qs=t,this.Ws=!1,this.js=null}function ka(t,e,n){this.name=t,this.version=e,this.Ns=n,12.2===ka.Fs(y())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ra(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}function La(t){return"IndexedDbTransactionError"===t.name}var xa=(Ca.open=function(t,e,n){try{return new Ca(t.transaction(n,e))}catch(t){throw new Aa(t)}},Object.defineProperty(Ca.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),Ca.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(Lr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ca.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Oa(e)},Ca),Oa=(Pa.prototype.put=function(t,e){return Va(void 0!==e?(Lr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Lr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Pa.prototype.add=function(t){return Lr("SimpleDb","ADD",this.store.name,t,t),Va(this.store.add(t))},Pa.prototype.get=function(e){var n=this;return Va(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Lr("SimpleDb","GET",n.store.name,e,t),t})},Pa.prototype.delete=function(t){return Lr("SimpleDb","DELETE",this.store.name,t),Va(this.store.delete(t))},Pa.prototype.count=function(){return Lr("SimpleDb","COUNT",this.store.name),Va(this.store.count())},Pa.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},Pa.prototype.Js=function(t,e){Lr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},Pa.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},Pa.prototype.ti=function(i){var t=this.cursor({});return new sa(function(n,r){t.onerror=function(t){var e=Ma(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Pa.prototype.Ys=function(t,s){var u=[];return new sa(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new _a(i),(n=s(i.primaryKey,i.value,e))instanceof sa&&(r=n.catch(function(t){return e.done(),sa.reject(t)}),u.push(r)),e.yn?o():null===e.Ks?i.continue():i.continue(e.Ks)):o()}}).next(function(){return sa.Cn(u)})},Pa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Pa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Pa);function Pa(t){this.store=t}function Ca(t){var n=this;this.transaction=t,this.aborted=!1,this.zs=new Ea,this.transaction.oncomplete=function(){n.zs.resolve()},this.transaction.onabort=function(){t.error?n.zs.reject(new Aa(t.error)):n.zs.resolve()},this.transaction.onerror=function(t){var e=Ma(t.target.error);n.zs.reject(new Aa(e))}}function Va(t){return new sa(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ma(t.target.error);r(e)}})}var Ua=!1;function Ma(t){var e=Na.Fs(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new $r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ua||(Ua=!0,setTimeout(function(){throw r},0)),r}}return t}function Fa(){return"undefined"!=typeof window?window:null}function qa(){return"undefined"!=typeof document?document:null}var ja=(za.ri=function(t,e,n,r,i){var o=new za(t,e,Date.now()+n,r,i);return o.start(n),o},za.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},za.prototype.Cs=function(){return this.hi()},za.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new $r(Jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},za.prototype.hi=function(){var e=this;this.ei.ai(function(){return null!==e.oi?(e.clearTimeout(),e.op().then(function(t){return e.ii.resolve(t)})):Promise.resolve()})},za.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},za),Ga=(Object.defineProperty(Ba.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),Ba.prototype.ai=function(t){this.enqueue(t)},Ba.prototype.mi=function(t){this.Ai(),this.Ri(t)},Ba.prototype.Pi=function(){var t;this.li||(this.li=!0,(t=qa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei))},Ba.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},Ba.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai(function(){return e.Vi()})},Ba.prototype.Vi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ci.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return t.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ci.length&&this.Ti.bs(function(){return n.Vi()}),t.label=5;case 5:return[2]}})})},Ba.prototype.Ri=function(t){var r=this,e=this.ui.then(function(){return r.di=!0,t().catch(function(t){throw r.fi=t,r.di=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.di=!1,t})});return this.ui=e},Ba.prototype.Ss=function(t,e,n){var r=this;this.Ai(),-1<this.wi.indexOf(t)&&(e=0);var i=ja.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},Ba.prototype.Ai=function(){this.fi&&Cr()},Ba.prototype.pi=function(){},Ba.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ui];case 1:t.sent(),t.label=2;case 2:if(e!==this.ui)return[3,0];t.label=3;case 3:return[2]}})})},Ba.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},Ba.prototype.Si=function(r){var i=this;return this.bi().then(function(){i._i.sort(function(t,e){return t.ni-e.ni});for(var t=0,e=i._i;t<e.length;t++){var n=e[t];if(n.Cs(),"all"!==r&&n.ms===r)break}return i.bi()})},Ba.prototype.Di=function(t){this.wi.push(t)},Ba.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},Ba);function Ba(){var e=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new Ta(this,"async_queue_retry"),this.Ei=function(){var t=qa();t&&Lr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ti.Ds()};var t=qa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ei)}function za(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new Ea,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}function Ha(t,e){if(xr("AsyncQueue",e+": "+t),La(t))return new $r(Jr.UNAVAILABLE,e+": "+t);throw t}function Wa(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Fr(n,i);return 0===s?Fr(r,o):s}var Ka=(Za.prototype.Fi=function(){return++this.Ni},Za.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Wa(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Za.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Za),Ya={$i:!1,xi:0,Oi:0,Mi:0},Xa=(Qa.Ui=function(t){return new Qa(t,Qa.Qi,Qa.Wi)},Qa);function Qa(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Za(t){this.Ci=t,this.buffer=new Fi(Wa),this.Ni=0}Xa.ji=-1,Xa.Ki=1048576,Xa.Gi=41943040,Xa.Qi=10,Xa.Wi=1e3,Xa.zi=new Xa(Xa.Gi,Xa.Qi,Xa.Wi),Xa.Hi=new Xa(Xa.ji,0,0);var Ja=(ec.prototype.start=function(t){this.Yi.params.Li!==Xa.ji&&this.Zi(t)},ec.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(ec.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),ec.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;Lr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return La(e=t.sent())?(Lr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Dh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},ec),$a=(tc.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},tc.prototype.rr=function(t,e){var n=this;if(0===e)return sa.resolve(la.Es);var r=new Ka(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},tc.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},tc.prototype.ar=function(t,e){return this.nr.ar(t,e)},tc.prototype.ur=function(e,n){var r=this;return this.params.Li===Xa.ji?(Lr("LruGarbageCollector","Garbage collection skipped; disabled"),sa.resolve(Ya)):this.cr(e).next(function(t){return t<r.params.Li?(Lr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Ya):r.lr(e,n)})},tc.prototype.cr=function(t){return this.nr.cr(t)},tc.prototype.lr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>h.params.Bi?(Lr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+t),h.params.Bi):t,s=Date.now(),h.rr(e,i)}).next(function(t){return r=t,u=Date.now(),h.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ar(e,r)}).next(function(t){return c=Date.now(),Rr()<=l.DEBUG&&Lr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),sa.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},tc);function tc(t,e){this.nr=t,this.params=e}function ec(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}function nc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=rc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return rc(o)}function rc(t){return t+""}function ic(t){var e=t.length;if(Vr(2<=e),2===e)return Vr(""===t.charAt(0)&&""===t.charAt(1)),ri.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Cr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Cr()}o=s+2}return new ri(r)}var oc=function(t){this._r=t};function sc(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Ho(n,r.name),s=jo(r.updateTime),u=new Qs({mapValue:{fields:r.fields}}),new su(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=si.K(e.noDocument.path),c=fc(e.noDocument.readTime);return new uu(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=si.K(e.unknownDocument.path),f=fc(e.unknownDocument.version);return new au(h,f)}return Cr()}function uc(t,e,n){var r,i,o=ac(n),s=e.key.path.p().N();if(e instanceof su){var u={name:zo(r=t._r,(i=e).key),fields:i.tn().mapValue.fields,updateTime:Fo(r,i.version.A())},a=e.hasCommittedMutations;return new zc(null,null,u,a,o,s)}if(e instanceof uu){var c=e.key.path.N(),h=hc(e.version),f=e.hasCommittedMutations;return new zc(null,new Gc(c,h),null,f,o,s)}if(e instanceof au){var l=e.key.path.N(),p=hc(e.version);return new zc(new Bc(l,p),null,null,!0,o,s)}return Cr()}function ac(t){var e=t.A();return[e.seconds,e.nanoseconds]}function cc(t){var e=new ti(t[0],t[1]);return ei.I(e)}function hc(t){var e=t.A();return new Oc(e.seconds,e.nanoseconds)}function fc(t){var e=new ti(t.seconds,t.nanoseconds);return ei.I(e)}function lc(e,t){var n=(t.baseMutations||[]).map(function(t){return Jo(e._r,t)}),r=t.mutations.map(function(t){return Jo(e._r,t)}),i=ti.fromMillis(t.localWriteTimeMs);return new ia(t.batchId,i,n,r)}function pc(t){var e,n=fc(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?fc(t.lastLimboFreeSnapshotVersion):ei.min(),i=void 0!==t.query.documents?(Vr(1===(e=t.query).documents.length),wu(vu(Ko(e.documents[0])))):function(t){var e,n=Ko(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Vr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=is(t.unaryFilter.field);return ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=is(t.unaryFilter.field);return ku.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=is(t.unaryFilter.field);return ku.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=is(t.unaryFilter.field);return ku.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}(e)]:void 0!==e.fieldFilter?[(n=e,ku.create(is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ra(is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(h=yi(c="object"==typeof(a=r.limit)?a.value:a)?null:c);var f=null;r.startAt&&(f=ns(r.startAt));var l=null;return r.endAt&&(l=ns(r.endAt)),wu(yu(n,o,u,s,h,"F",f,l))}(t.query);return new Di(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ti.fromBase64String(t.resumeToken))}function dc(t,e){var n=hc(e.Z),r=hc(e.lastLimboFreeSnapshotVersion),i=(Ii(e.target)?$o:ts)(t._r,e.target),o=e.resumeToken.toBase64();return new Wc(e.targetId,bi(e.target),n,o,e.sequenceNumber,r,i)}var yc=(vc.Tr=function(t,e,n,r){return Vr(""!==t.uid),new vc(t.Er()?t.uid:"",e,n,r)},vc.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wc(t).Zs({index:Fc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},vc.prototype.mr=function(d,y,v,g){var m=this,w=bc(d),b=wc(d);return b.add({}).next(function(t){Vr("number"==typeof t);for(var e,n,r,i,o,s=new ia(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Zo(e._r,t)}),o=r.mutations.map(function(t){return Zo(e._r,t)}),new Fc(n,r.batchId,r.Tn.toMillis(),i,o)),a=[],c=new Fi(function(t,e){return Fr(t.F(),e.F())}),h=0,f=g;h<f.length;h++){var l=f[h],p=qc.key(m.userId,l.key.path,t),c=c.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,qc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.zn.Ar(d,t))}),d.Wn(function(){m.wr[t]=s.keys()}),sa.Cn(a).next(function(){return s})})},vc.prototype.Rr=function(t,e){var n=this;return wc(t).get(e).next(function(t){return t?(Vr(t.userId===n.userId),lc(n.serializer,t)):null})},vc.prototype.Pr=function(t,n){var r=this;return this.wr[n]?sa.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},vc.prototype.gr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return wc(t).Zs({index:Fc.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Vr(e.batchId>=i),o=lc(r.serializer,e)),n.done()}).next(function(){return o})},vc.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return wc(t).Zs({index:Fc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},vc.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wc(t).Hs(Fc.userMutationsIndex,n).next(function(t){return t.map(function(t){return lc(e.serializer,t)})})},vc.prototype.Yn=function(u,a){var c=this,t=qc.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return bc(u).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ic(i);if(r===c.userId&&a.path.isEqual(s))return wc(u).get(o).next(function(t){if(!t)throw Cr();Vr(t.userId===c.userId),h.push(lc(c.serializer,t))});n.done()}).next(function(){return h})},vc.prototype.es=function(r,t){var a=this,c=new Fi(Fr),i=[];return t.forEach(function(u){var t=qc.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=bc(r).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ic(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),sa.Cn(i).next(function(){return a.pr(r,c)})},vc.prototype.as=function(t,e){var u=this,a=e.path,c=a.length+1,n=qc.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new Fi(Fr);return bc(t).Zs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ic(i);r===u.userId&&a.D(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.pr(t,h)})},vc.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(wc(e).get(t).next(function(t){if(null===t)throw Cr();Vr(t.userId===n.userId),r.push(lc(n.serializer,t))}))}),sa.Cn(i).next(function(){return r})},vc.prototype.br=function(e,n){var r=this;return mc(e.vr,this.userId,n).next(function(t){return e.Wn(function(){r.Sr(n.batchId)}),sa.forEach(t,function(t){return r.dr.Dr(e,t)})})},vc.prototype.Sr=function(t){delete this.wr[t]},vc.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return sa.resolve();var e=IDBKeyRange.lowerBound(qc.prefixForUser(o.userId)),i=[];return bc(n).Zs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=ic(t[1]),i.push(r)):n.done()}).next(function(){Vr(0===i.length)})})},vc.prototype.Nr=function(t,e){return gc(t,this.userId,e)},vc.prototype.Fr=function(t){var e=this;return Ec(t).get(this.userId).next(function(t){return t||new Mc(e.userId,-1,"")})},vc);function vc(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}function gc(t,o,e){var n=qc.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return bc(t).Zs({range:r,Xs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function mc(t,e,n){var r=t.store(Fc.store),i=t.store(qc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Vr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=qc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return sa.Cn(o).next(function(){return c})}function wc(t){return lh.Ms(t,Fc.store)}function bc(t){return lh.Ms(t,qc.store)}function Ec(t){return lh.Ms(t,Mc.store)}var Ic,Tc=(Nc.prototype.xn=function(t,e,n){return Ac(t).put(Sc(e),n)},Nc.prototype.Mn=function(t,e){var n=Ac(t),r=Sc(e);return n.delete(r)},Nc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Nc.prototype.Ln=function(t,e){var n=this;return Ac(t).get(Sc(e)).next(function(t){return n.$r(t)})},Nc.prototype.xr=function(t,e){var n=this;return Ac(t).get(Sc(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:Dc(t)}:null})},Nc.prototype.getEntries=function(t,e){var r=this,i=ji;return this.Mr(t,e,function(t,e){var n=r.$r(e);i=i.st(t,n)}).next(function(){return i})},Nc.prototype.Lr=function(t,e){var r=this,i=ji,o=new xi(si.P);return this.Mr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.st(t,n),o.st(t,Dc(e))):(i=i.st(t,null),o.st(t,0))}).next(function(){return{qr:i,Br:o}})},Nc.prototype.Mr=function(t,e,i){if(e._())return sa.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.ut(),s=o.wt();return Ac(t).Zs({range:n},function(t,e,n){for(var r=si.K(t);s&&si.P(s,r)<0;)i(s,null),s=o.wt();s&&s.isEqual(r)&&(i(s,e),s=o.Tt()?o.wt():null),s?n.Gs(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Tt()?o.wt():null})},Nc.prototype.ns=function(t,i,e){var n,r,o,s=this,u=zi,a=i.path.length+1,c={};return e.isEqual(ei.min())?(n=i.path.N(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=ac(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=zc.collectionReadTimeIndex),Ac(t).Zs(c,function(t,e,n){var r;t.length===a&&(r=sc(s.serializer,e),i.path.D(r.key.path)?r instanceof su&&Au(i,r)&&(u=u.st(r.key,r)):n.done())}).next(function(){return u})},Nc.prototype.Ur=function(t,e){var r=this,i=ji,o=ac(e),n=Ac(t),s=IDBKeyRange.lowerBound(o,!0);return n.Zs({index:zc.readTimeIndex,range:s},function(t,e){var n=sc(r.serializer,e);i=i.st(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:cc(o)}})},Nc.prototype.Wr=function(t){var e=Ac(t),r=ei.min();return e.Zs({index:zc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=cc(e.readTime)),n.done()}).next(function(){return r})},Nc.prototype.jr=function(t){return new Nc.Kr(this,!!t&&t.Gr)},Nc.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Nc.prototype.getMetadata=function(t){return _c(t).get(Hc.key).next(function(t){return Vr(!!t),t})},Nc.prototype.kr=function(t,e){return _c(t).put(Hc.key,e)},Nc.prototype.$r=function(t){if(t){var e=sc(this.serializer,t);return e instanceof uu&&e.version.isEqual(ei.min())?null:e}return null},Nc);function Nc(t,e){this.serializer=t,this.zn=e}function _c(t){return lh.Ms(t,Hc.store)}function Ac(t){return lh.Ms(t,zc.store)}function Sc(t){return t.path.N()}function Dc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}function kc(t,e){var n=this;return(n=Ic.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Tc.Kr=(o(kc,Ic=ua),kc.prototype.Un=function(s){var u=this,a=[],c=0,h=new Fi(function(t,e){return Fr(t.F(),e.F())});return this.Fn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=uc(u.Hr.serializer,e,u.readTime),h=h.add(t.path.p()),r=Dc(n),c+=r-o,a.push(u.Hr.xn(s,t,n))):(c-=o,u.Gr?(i=uc(u.Hr.serializer,new uu(t,ei.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),h.forEach(function(t){a.push(u.Hr.zn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,c)),sa.Cn(a)},kc.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},kc.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},kc);var Rc=(Uc.prototype.Ar=function(t,e){return this.Jr.add(e),sa.resolve()},Uc.prototype.hs=function(t,e){return sa.resolve(this.Jr.getEntries(e))},Uc),Lc=(Vc.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Fi(ri.P),i=!r.has(n);return this.index[e]=r.add(n),i},Vc.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Vc.prototype.getEntries=function(t){return(this.index[t]||new Fi(ri.P)).N()},Vc),xc=(Cc.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Vr(t<e&&0<=t&&e<=10);var o,s=new xa(r);t<1&&1<=e&&(n.createObjectStore(Pc.store),(o=n).createObjectStore(Mc.store,{keyPath:Mc.keyPath}),o.createObjectStore(Fc.store,{keyPath:Fc.keyPath,autoIncrement:!0}).createIndex(Fc.userMutationsIndex,Fc.userMutationsKeyPath,{unique:!0}),o.createObjectStore(qc.store),Qc(n),n.createObjectStore(zc.store));var u,a=sa.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Kc.store),u.deleteObjectStore(Wc.store),u.deleteObjectStore(Yc.store),Qc(n)),a=a.next(function(){return t=s.store(Yc.store),e=new Yc(0,0,ei.min().A(),0),t.put(Yc.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Fc.store).Hs().next(function(t){r.deleteObjectStore(Fc.store),r.createObjectStore(Fc.store,{keyPath:Fc.keyPath,autoIncrement:!0}).createIndex(Fc.userMutationsIndex,Fc.userMutationsKeyPath,{unique:!0});var e=i.store(Fc.store),n=t.map(function(t){return e.put(t)});return sa.Cn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Zc.store,{keyPath:Zc.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Hc.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(zc.store)).createIndex(zc.readTimeIndex,zc.readTimeIndexPath,{unique:!1}),t.createIndex(zc.collectionReadTimeIndex,zc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Cc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(zc.store).Zs(function(t,e){n+=Dc(e)}).next(function(){var t=new Hc(n);return e.store(Hc.store).put(Hc.key,t)})},Cc.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Mc.store),e=r.store(Fc.store);return t.Hs().next(function(t){return sa.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Hs(Fc.userMutationsIndex,t).next(function(t){return sa.forEach(t,function(t){Vr(t.userId===n.userId);var e=lc(i.serializer,t);return mc(r,n.userId,e).next(function(){})})})})})},Cc.prototype.ensureSequenceNumbers=function(t){var s=t.store(Kc.store),e=t.store(zc.store);return t.store(Yc.store).get(Yc.key).next(function(i){var o=[];return e.Zs(function(t,e){var n=new ri(t),r=[0,nc(n)];o.push(s.get(r).next(function(t){return t?sa.resolve():s.put(new Kc(0,nc(n),i.highestListenSequenceNumber))}))}).next(function(){return sa.Cn(o)})})},Cc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:nc(n)})}}t.createObjectStore(Xc.store,{keyPath:Xc.keyPath});var i=e.store(Xc.store),o=new Lc;return e.store(zc.store).Zs({Xs:!0},function(t,e){return r(new ri(t).p())}).next(function(){return e.store(qc.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1];return r((t[2],ic(n)).p())})})},Cc.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Wc.store);return o.Zs(function(t,e){var n=pc(e),r=dc(i.serializer,n);return o.put(r)})},Cc),Oc=function(t,e){this.seconds=t,this.nanoseconds=e},Pc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Cc(t){this.serializer=t}function Vc(){this.index={}}function Uc(){this.Jr=new Lc}Pc.store="owner",Pc.key="owner";var Mc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Mc.store="mutationQueues",Mc.keyPath="userId";var Fc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Fc.store="mutations",Fc.keyPath="batchId",Fc.userMutationsIndex="userMutationsIndex",Fc.userMutationsKeyPath=["userId","batchId"];var qc=(jc.prefixForUser=function(t){return[t]},jc.prefixForPath=function(t,e){return[t,nc(e)]},jc.key=function(t,e,n){return[t,nc(e),n]},jc);function jc(){}qc.store="documentMutations",qc.PLACEHOLDER=new qc;var Gc=function(t,e){this.path=t,this.readTime=e},Bc=function(t,e){this.path=t,this.version=e},zc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zc.store="remoteDocuments",zc.readTimeIndex="readTimeIndex",zc.readTimeIndexPath="readTime",zc.collectionReadTimeIndex="collectionReadTimeIndex",zc.collectionReadTimeIndexPath=["parentPath","readTime"];var Hc=function(t){this.byteSize=t};Hc.store="remoteDocumentGlobal",Hc.key="remoteDocumentGlobalKey";var Wc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Wc.store="targets",Wc.keyPath="targetId",Wc.queryTargetsIndexName="queryTargetsIndex",Wc.queryTargetsKeyPath=["canonicalId","targetId"];var Kc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Kc.store="targetDocuments",Kc.keyPath=["targetId","path"],Kc.documentTargetsIndex="documentTargetsIndex",Kc.documentTargetsKeyPath=["path","targetId"];var Yc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Yc.key="targetGlobalKey",Yc.store="targetGlobal";var Xc=function(t,e){this.collectionId=t,this.parent=e};function Qc(t){t.createObjectStore(Kc.store,{keyPath:Kc.keyPath}).createIndex(Kc.documentTargetsIndex,Kc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Wc.store,{keyPath:Wc.keyPath}).createIndex(Wc.queryTargetsIndexName,Wc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Yc.store)}Xc.store="collectionParents",Xc.keyPath=["collectionId","parent"];var Zc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Zc.store="clientMetadata",Zc.keyPath="clientId";var Jc=s(s(s([Mc.store,Fc.store,qc.store,zc.store,Wc.store,Pc.store,Yc.store,Kc.store],[Zc.store]),[Hc.store]),[Xc.store]),$c=(th.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return sa.resolve();var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:nc(i)};return eh(t).put(o)},th.prototype.hs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[jr(i),""],!1,!0);return eh(t).Hs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ic(r.parent))}return o})},th);function th(){this.Xr=new Lc}function eh(t){return lh.Ms(t,Xc.store)}var nh=(oh.prototype.next=function(){return this.Zr+=2,this.Zr},oh.to=function(){return new oh(0)},oh.eo=function(){return new oh(-1)},oh),rh=(ih.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new nh(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},ih.prototype.ro=function(t){return this.so(t).next(function(t){return ei.I(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ih.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},ih.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},ih.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},ih.prototype.lo=function(t,e){return this.uo(t,e)},ih.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return sh(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Vr(0<t.targetCount),--t.targetCount,n.io(e,t)})},ih.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return sh(r).Zs(function(t,e){var n=pc(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return sa.Cn(a)}).next(function(){return u})},ih.prototype.be=function(t,r){return sh(t).Zs(function(t,e){var n=pc(e);r(n)})},ih.prototype.so=function(t){return uh(t).get(Yc.key).next(function(t){return Vr(null!==t),t})},ih.prototype.io=function(t,e){return uh(t).put(Yc.key,e)},ih.prototype.uo=function(t,e){return sh(t).put(dc(this.serializer,e))},ih.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ih.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},ih.prototype.wo=function(t,i){var e=bi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return sh(t).Zs({range:n,index:Wc.queryTargetsIndexName},function(t,e,n){var r=pc(e);Ei(i,r.target)&&(o=r,n.done())}).next(function(){return o})},ih.prototype.To=function(n,t,r){var i=this,o=[],s=ah(n);return t.forEach(function(t){var e=nc(t.path);o.push(s.put(new Kc(r,e))),o.push(i.dr.Eo(n,r,t))}),sa.Cn(o)},ih.prototype.Io=function(n,t,r){var i=this,o=ah(n);return sa.forEach(t,function(t){var e=nc(t.path);return sa.Cn([o.delete([r,e]),i.dr.mo(n,r,t)])})},ih.prototype.fo=function(t,e){var n=ah(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ih.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ah(t),o=Ki();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=ic(t[1]),i=new si(r);o=o.add(i)}).next(function(){return o})},ih.prototype.Nr=function(t,e){var n=nc(e.path),r=IDBKeyRange.bound([n],[jr(n)],!1,!0),i=0;return ah(t).Zs({index:Kc.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ih.prototype.Me=function(t,e){return sh(t).get(e).next(function(t){return t?pc(t):null})},ih);function ih(t,e){this.dr=t,this.serializer=e}function oh(t){this.Zr=t}function sh(t){return lh.Ms(t,Wc.store)}function uh(t){return lh.Ms(t,Yc.store)}function ah(t){return lh.Ms(t,Kc.store)}var ch,hh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fh=(o(dh,ch=ca),dh),lh=(ph.Ms=function(t,e){if(t instanceof fh)return Na.Ms(t.vr,e);throw Cr()},ph.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new $r(Jr.FAILED_PRECONDITION,hh);return e.Oo(),e.Mo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new la(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},ph.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},ph.prototype.Bo=function(n){var t=this;this.Fo.Bs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},ph.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},ph.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return vh(e).put(new Zc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Is.gi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(La(t))return Lr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Lr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Is.gi(function(){return n.Co(t)}),n.isPrimary=t})},ph.prototype.Qo=function(t){var e=this;return yh(t).get(Pc.key).next(function(t){return sa.resolve(e.Go(t))})},ph.prototype.zo=function(t){return vh(t).delete(this.clientId)},ph.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=ph.Ms(t,Zc.store);return r.Hs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return sa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},ph.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},ph.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},ph.prototype.Wo=function(e){var i=this;return this.Vo?sa.resolve(!0):yh(e).get(Pc.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new $r(Jr.FAILED_PRECONDITION,hh);return!1}}return!(!i.networkEnabled||!i.inForeground)||vh(e).Hs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Lr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},ph.prototype.th=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Pc.store,Zc.store],function(t){var e=new fh(t,la.Es);return n.jo(e).next(function(){return n.zo(e)})})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},ph.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},ph.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return vh(t).Hs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(ph.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),ph.prototype.oh=function(t){return yc.Tr(t,this.serializer,this.zn,this.dr)},ph.prototype.hh=function(){return this.ko},ph.prototype.ah=function(){return this.Kn},ph.prototype.uh=function(){return this.zn},ph.prototype.runTransaction=function(e,n,r){var i=this;Lr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Jc,function(t){return o=new fh(t,i.yo?i.yo.next():la.Es),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Is.gi(function(){return i.Co(!1)}),new $r(Jr.FAILED_PRECONDITION,aa);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.jn(),t})},ph.prototype.lh=function(t){var e=this;return yh(t).get(Pc.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new $r(Jr.FAILED_PRECONDITION,hh)})},ph.prototype.Ko=function(t){var e=new Pc(this.clientId,this.allowTabSynchronization,Date.now());return yh(t).put(Pc.key,e)},ph.ks=function(){return Na.ks()},ph.prototype.jo=function(t){var e=this,n=yh(t);return n.get(Pc.key).next(function(t){return e.Go(t)?(Lr("IndexedDbPersistence","Releasing primary lease."),n.delete(Pc.key)):sa.resolve()})},ph.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},ph.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},ph.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},ph.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},ph.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},ph.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return Lr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},ph.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},ph.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},ph.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},ph);function ph(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Is=i,this.window=o,this.document=s,this.Po=a,this.Vo=c,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!ph.ks())throw new $r(Jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new gh(this,r),this.No=e+"main",this.serializer=new oc(u),this.Fo=new Na(this.No,10,new xc(this.serializer)),this.ko=new rh(this.dr,this.serializer),this.zn=new $c,this.Kn=new Tc(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function dh(t,e){var n=this;return(n=ch.call(this)||this).vr=t,n.Ro=e,n}function yh(t){return lh.Ms(t,Pc.store)}function vh(t){return lh.Ms(t,Zc.store)}var gh=(mh.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},mh.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},mh.prototype.be=function(t,e){return this.db.hh().be(t,e)},mh.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},mh.prototype.Eo=function(t,e,n){return wh(t,n)},mh.prototype.mo=function(t,e,n){return wh(t,n)},mh.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},mh.prototype.Dr=wh,mh.prototype.dh=function(t,e){return r=e,i=!1,Ec(n=t).ti(function(t){return gc(n,t,r).next(function(t){return t&&(i=!0),sa.resolve(!t)})}).next(function(){return i});var n,r,i},mh.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.Ln(r,e).next(function(){return s.Mn(e),ah(r).delete([0,nc(e.path)])})}),u.push(n))}).next(function(){return sa.Cn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},mh.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},mh.prototype.wh=wh,mh.prototype.fh=function(t,o){var s,e=ah(t),u=la.Es;return e.Zs({index:Kc.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==la.Es&&o(new si(ic(s)),u),u=i,s=r):u=la.Es}).next(function(){u!==la.Es&&o(new si(ic(s)),u)})},mh.prototype.cr=function(t){return this.db.ah().zr(t)},mh);function mh(t,e){this.db=t,this.Yi=new $a(this,e)}function wh(t,e){return ah(t).put((n=t.Ro,new Kc(0,nc(e.path),n)));var n}function bh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Eh=(Ih.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},Ih);function Ih(t,e,n){this.persistence=t,this.Th=e,this.Eh=new xi(Fr),this.Ih=new Zr(bi,Ei),this.mh=ei.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new ha(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}function Th(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Nh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,sa.resolve(n)):i.ko.no(e).next(function(t){return n=new Di(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(i.Eh=i.Eh.st(t.targetId,t),i.Ih.set(r,t.targetId)),t})}function _h(o,s,u){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Eh.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.dr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!La(i=t.sent()))throw i;return Lr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Eh=e.Eh.remove(s),e.Ih.delete(n.target),[2]}})})}function Ah(t,s,u){var a=t,c=ei.min(),h=Ki();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=wu(s),(void 0!==(o=(i=t).Ih.get(r))?sa.resolve(i.Eh.get(o)):i.ko.wo(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.ko.Ao(e,t.targetId).next(function(t){h=t})}).next(function(){return a.Th.ns(e,s,u?c:ei.min(),u?h:Ki())}).next(function(t){return{documents:t,gh:h}});var t,n,r,i,o})}function Sh(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Dh(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Jr.FAILED_PRECONDITION||e.message!==aa)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var kh=(Ph.prototype._=function(){return this.Vh._()},Ph.prototype.Eo=function(t,e){var n=new Rh(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},Ph.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Ph.prototype.mo=function(t,e){this.Sh(new Rh(t,e))},Ph.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Ph.prototype.Ch=function(t){var e=this,n=new si(new ri([])),r=new Rh(n,t),i=new Rh(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},Ph.prototype.Nh=function(){var e=this;this.Vh.forEach(function(t){return e.Sh(t)})},Ph.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},Ph.prototype.Fh=function(t){var e=new si(new ri([])),n=new Rh(e,t),r=new Rh(e,t+1),i=Ki();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},Ph.prototype.Nr=function(t){var e=new Rh(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},Ph),Rh=(Oh.yh=function(t,e){return si.P(t.key,e.key)||Fr(t.kh,e.kh)},Oh.bh=function(t,e){return Fr(t.kh,e.kh)||si.P(t.key,e.key)},Oh),Lh=(xh.prototype.Er=function(){return null!=this.uid},xh.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},xh.prototype.isEqual=function(t){return t.uid===this.uid},xh);function xh(t){this.uid=t}function Oh(t,e){this.key=t,this.kh=e}function Ph(){this.Vh=new Fi(Rh.yh),this.ph=new Fi(Rh.bh)}function Ch(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}Lh.UNAUTHENTICATED=new Lh(null),Lh.xh=new Lh("google-credentials-uid"),Lh.Oh=new Lh("first-party-uid");var Vh,Uh,Mh,Fh=(of.prototype.getToken=function(){return Promise.resolve(null)},of.prototype.qh=function(){},of.prototype.Bh=function(t){(this.Lh=t)(Lh.UNAUTHENTICATED)},of.prototype.Uh=function(){this.Lh=null},of),qh=(rf.prototype.getToken=function(){var e=this,n=this.jh,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.jh!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new Ch(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},rf.prototype.qh=function(){this.forceRefresh=!0},rf.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},rf.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},rf.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new Lh(t)},rf),jh=(Object.defineProperty(nf.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),nf),Gh=(ef.prototype.getToken=function(){return Promise.resolve(new jh(this.Gh,this.zh))},ef.prototype.Bh=function(t){t(Lh.Oh)},ef.prototype.Uh=function(){},ef.prototype.qh=function(){},ef),Bh=(tf.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},tf.prototype.na=function(){return 2===this.state},tf.prototype.start=function(){3!==this.state?this.auth():this.sa()},tf.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},tf.prototype.ia=function(){this.state=0,this.Ti.reset()},tf.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,function(){return t.oa()}))},tf.prototype.ha=function(t){this.aa(),this.stream.send(t)},tf.prototype.oa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},tf.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},tf.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==e?this.Ti.reset():n&&n.code===Jr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):n&&n.code===Jr.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ca(n)];case 1:return t.sent(),[2]}})})},tf.prototype.ua=function(){},tf.prototype.auth=function(){var n=this;this.state=1;var t=this.la(this.Zh),e=this.Zh;this.Xh.getToken().then(function(t){n.Zh===e&&n._a(t)},function(e){t(function(){var t=new $r(Jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fa(t)})})},tf.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ca(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},tf.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},tf.prototype.fa=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},tf.prototype.la=function(e){var n=this;return function(t){n.Is.ai(function(){return n.Zh===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},tf),zh=(o($h,Mh=Bh),$h.prototype.da=function(t){return this.Jh.Ta("Listen",t)},$h.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(Vr(void 0===i||"string"==typeof i),Ti.fromBase64String(i||"")):(Vr(void 0===i||i instanceof Uint8Array),Ti.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=new Zi(s,u,a,c&&(r=void 0===(n=c).code?Jr.UNKNOWN:Li(n.code),new $r(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Ho(t,f.document.name),p=jo(f.document.updateTime),d=new Qs({mapValue:{fields:f.document.fields}}),y=new su(l,p,d,{}),h=new Xi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Ho(t,v.document),m=v.readTime?jo(v.readTime):ei.min(),w=new uu(g,m);h=new Xi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Ho(t,b.document);h=new Xi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Cr();e.filter;var I=e.filter;I.targetId;var T=new _i(I.count||0);h=new Qi(I.targetId,T)}return h}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ei.min():jo(e.readTime)}(t);return this.listener.Ea(e,n)},$h.prototype.Ia=function(t){var e,n,r,i,o={};o.database=Yo(this.serializer),o.addTarget=(e=this.serializer,(r=Ii(i=(n=t).target)?{documents:$o(e,i)}:{query:ts(e,i)}).targetId=n.targetId,0<n.resumeToken.Y()&&(r.resumeToken=qo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ha(o)},$h.prototype.ma=function(t){var e={};e.database=Yo(this.serializer),e.removeTarget=t,this.ha(e)},$h),Hh=(o(Jh,Uh=Bh),Object.defineProperty(Jh.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),Jh.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,Uh.prototype.start.call(this)},Jh.prototype.ua=function(){this.Aa&&this.Pa([])},Jh.prototype.da=function(t){return this.Jh.Ta("Write",t)},Jh.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Vr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(ei.min())&&(n=jo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ss(n,r)}(t,i)})):[]),n=jo(t.commitTime);return this.listener.ga(n,e)}var r,i;return Vr(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},Jh.prototype.ya=function(){var t={};t.database=Yo(this.serializer),this.ha(t)},Jh.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Zo(e.serializer,t)})};this.ha(n)},Jh),Wh=(o(Zh,Vh=function(){}),Zh.prototype.ba=function(){if(this.pa)throw new $r(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},Zh.prototype.va=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.va(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.qh(),t})},Zh.prototype.Sa=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.Sa(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.qh(),t})},Zh.prototype.terminate=function(){this.pa=!1},Zh),Kh=(Qh.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},Qh.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,1<=this.Ca&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},Qh.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},Qh.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},Qh.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(xr(e),this.Fa=!1):Lr("OnlineStateTracker",e)},Qh.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},Qh),Yh=(Xh.prototype.start=function(){return this.enableNetwork()},Xh.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},Xh.prototype.iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xh.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},Xh.prototype.au=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),0<this.Ba.length&&(Lr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}})})},Xh.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},Xh.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},Xh.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},Xh.prototype.Me=function(t){return this.Ua.get(t)||null},Xh.prototype.Oe=function(t){return this.fu.Oe(t)},Xh.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},Xh.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},Xh.prototype.ou=function(){this.Qa=new io(this),this.Ya.start(),this.Ha.ka()},Xh.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&0<this.Ua.size},Xh.prototype.Ga=function(){return 0===this.Wa.size},Xh.prototype.uu=function(){this.Qa=null},Xh.prototype.Ja=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.Ua.forEach(function(t,e){n.cu(t)}),[2]})})},Xh.prototype.Xa=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.uu(),this.ru()?(this.Ha.Oa(e),this.ou()):this.Ha.set("Unknown"),[2]})})},Xh.prototype.Za=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Ha.set("Online"),!(i instanceof Zi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.du(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.wu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Xi?this.Qa.ge(i):i instanceof Qi?this.Qa.Ce(i):this.Qa.pe(i),o.isEqual(ei.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Th(this.La)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Tu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.wu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Xh.prototype.wu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!La(n))throw n;return this.Wa.add(1),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),r=r||function(){return Th(e.La)},this.ei.gi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Xh.prototype.Eu=function(e){var n=this;return e().catch(function(t){return n.wu(t,e)})},Xh.prototype.Tu=function(r){var i=this,t=this.Qa.ke(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=i.Ua.get(e))&&i.Ua.set(e,n.et(t.resumeToken,r))}),t.jt.forEach(function(t){var e,n=i.Ua.get(t);n&&(i.Ua.set(t,n.et(Ti.J,n.Z)),i._u(t),e=new Di(n.target,t,1,n.sequenceNumber),i.cu(e))}),this.fu.Iu(t)},Xh.prototype.du=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fu.mu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Xh.prototype.hu=function(){return g(this,void 0,void 0,function(){var i,o,s;return w(this,function(t){switch(t.label){case 0:i=0<this.Ba.length?this.Ba[this.Ba.length-1].batchId:-1,t.label=1;case 1:if(!this.Au())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.La,n=i,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Gn.gr(t,n)}))];case 3:return null===(o=t.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(i=o.batchId,this.Ru(o),[3,6]);case 4:return s=t.sent(),[4,this.wu(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}var e,n,r})})},Xh.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},Xh.prototype.Vu=function(){return this.Ba.length},Xh.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},Xh.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&0<this.Ba.length},Xh.prototype.gu=function(){this.tu.start()},Xh.prototype.eu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.tu.ya(),[2]})})},Xh.prototype.su=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Ba;e<n.length;e++)r=n[e],this.tu.Pa(r.mutations);return[2]})})},Xh.prototype.ga=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Ba.shift(),n=oa.from(e,i,o),[4,this.Eu(function(){return r.fu.yu(n)})];case 1:return t.sent(),[4,this.hu()];case 2:return t.sent(),[2]}})})},Xh.prototype.nu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.tu.Ra?[4,this.pu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Pu()&&this.gu(),[2]}})})},Xh.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Ri(n=i.code)&&n!==Jr.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu(function(){return r.fu.bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.hu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Xh.prototype.za=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}})})},Xh.prototype.vu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ei.pi(),Lr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(e)];case 2:return t.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return t.sent(),[2]}})})},Xh.prototype.Su=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:t.sent(),this.Ha.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Xh);function Xh(t,e,n,r,i){var o,s,u,a,c,h,f,l,p=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new Kh(n,r),this.Ya=(c=this.qa,h=n,f={wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)},(l=c).ba(),new zh(h,l.Jh,l.credentials,l.serializer,f)),this.tu=(o=this.qa,s=n,u={wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)},(a=o).ba(),new Hh(s,a.Jh,a.credentials,a.serializer,u))}function Qh(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}function Zh(t,e,n){var r=this;return(r=Vh.call(this)||this).credentials=t,r.Jh=e,r.serializer=n,r.pa=!1,r}function Jh(t,e,n,r,i){var o=this;return(o=Uh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Aa=!1,o}function $h(t,e,n,r,i){var o=this;return(o=Mh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function tf(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new Ta(t,e)}function ef(t,e){this.Gh=t,this.zh=e}function nf(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Lh.Oh}function rf(t){var e=this;this.Qh=null,this.currentUser=Lh.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}function of(){this.Lh=null}function sf(t,e){return"firestore_clients_"+t+"_"+e}function uf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function af(t,e){return"firestore_targets_"+t+"_"+e}function cf(t){this.key=t}function hf(t){this.key=t}function ff(t,e,n){this.query=t,this.targetId=e,this.view=n}function lf(t){this.key=t,this.qc=!1}var pf=(Rf.Du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new $r(r.error.code,r.error.message)),i?new Rf(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Rf.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rf),df=(kf.Du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new $r(n.error.code,n.error.message)),r?new kf(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},kf.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},kf),yf=(Df.Du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Yi,o=0;r&&o<n.activeTargetIds.length;++o)r=gi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Df(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Df),vf=(Sf.Du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sf(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},Sf),gf=(Af.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Af.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Af.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},Af),mf=(_f.ks=function(t){return!(!t||!t.localStorage)},_f.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.fu.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.ku&&(o=this.getItem(sf(this.persistenceKey,i)))&&(s=yf.Du(i,o))&&(this.Ou=this.Ou.st(s.clientId,s));for(this.ju(),(u=this.storage.getItem(this.Wu))&&(a=this.Ku(u))&&this.Gu(a),c=0,h=this.Mu;c<h.length;c++)f=h[c],this.xu(f);return this.Mu=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},_f.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},_f.prototype.zu=function(){return this.Hu(this.Ou)},_f.prototype.Yu=function(n){var r=!1;return this.Ou.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},_f.prototype.Ju=function(t){this.Xu(t,"pending")},_f.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},_f.prototype.ec=function(t){var e,n,r="not-current";return this.Yu(t)&&(!(e=this.storage.getItem(af(this.persistenceKey,t)))||(n=df.Du(t,e))&&(r=n.state)),this.nc.Nu(t),this.ju(),r},_f.prototype.sc=function(t){this.nc.Fu(t),this.ju()},_f.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},_f.prototype.rc=function(t){this.removeItem(af(this.persistenceKey,t))},_f.prototype.oc=function(t,e,n){this.hc(t,e,n)},_f.prototype.ac=function(t,e,n){var r=this;e.forEach(function(t){r.tc(t)}),this.currentUser=t,n.forEach(function(t){r.Ju(t)})},_f.prototype.uc=function(t){this.cc(t)},_f.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},_f.prototype.getItem=function(t){var e=this.storage.getItem(t);return Lr("SharedClientState","READ",t,e),e},_f.prototype.setItem=function(t,e){Lr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},_f.prototype.removeItem=function(t){Lr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},_f.prototype.xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Lr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Lu)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.Bu.test(u.key)){if(null==u.newValue)return e=this.lc(u.key),[2,this._c(e,null)];if(n=this.fc(u.key,u.newValue))return[2,this._c(n.clientId,n)]}else if(this.Uu.test(u.key)){if(null!==u.newValue&&(r=this.dc(u.key,u.newValue)))return[2,this.wc(r)]}else if(this.Qu.test(u.key)){if(null!==u.newValue&&(i=this.Tc(u.key,u.newValue)))return[2,this.Ec(i)]}else if(u.key===this.Wu){if(null!==u.newValue&&(o=this.Ku(u.newValue)))return[2,this.Gu(o)]}else u.key===this.qu&&(s=function(t){var e=la.Es;if(null!=t)try{var n=JSON.parse(t);Vr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==la.Es&&this.fs(s)}else this.Mu.push(u);return[2]})})})}},Object.defineProperty(_f.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),_f.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},_f.prototype.Xu=function(t,e,n){var r=new pf(this.currentUser,t,e,n),i=uf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},_f.prototype.tc=function(t){var e=uf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},_f.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},_f.prototype.hc=function(t,e,n){var r=af(this.persistenceKey,t),i=new df(t,e,n);this.setItem(r,i.Cu())},_f.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},_f.prototype.fc=function(t,e){var n=this.lc(t);return yf.Du(n,e)},_f.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return pf.Du(new Lh(i),r,e)},_f.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return df.Du(r,e)},_f.prototype.Ku=function(t){return vf.Du(t)},_f.prototype.wc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fu.Ic(e.batchId,e.state,e.error)]:(Lr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},_f.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},_f.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fu.Ac(s,u).then(function(){n.Ou=r})},_f.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},_f.prototype.Hu=function(t){var n=Yi;return t.forEach(function(t,e){n=n.Nt(e.activeTargetIds)}),n},_f),wf=(Nf.prototype.Ju=function(t){},Nf.prototype.Zu=function(t,e,n){},Nf.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},Nf.prototype.oc=function(t,e,n){this.Pc[t]=e},Nf.prototype.sc=function(t){this.Rc.Fu(t)},Nf.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},Nf.prototype.rc=function(t){delete this.Pc[t]},Nf.prototype.zu=function(){return this.Rc.activeTargetIds},Nf.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},Nf.prototype.start=function(){return this.Rc=new gf,Promise.resolve()},Nf.prototype.ac=function(t,e,n){},Nf.prototype.uc=function(t){},Nf.prototype.th=function(){},Nf.prototype.Ts=function(t){},Nf),bf=(Object.defineProperty(Tf.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),Tf.prototype.Sc=function(t,e){var u=this,a=e?e.Dc:new $i,c=e?e.bc:this.bc,h=e?e.qt:this.qt,f=c,l=!1,p=this.query.an()&&c.size===this.query.limit?c.last():null,d=this.query.un()&&c.size===this.query.limit?c.first():null;if(t.ht(function(t,e){var n=c.get(t),r=(r=e instanceof su?e:null)&&(Au(u.query,r)?r:null),i=!!n&&u.qt.has(n.key),o=!!r&&(r.Ge||u.qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Cc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.pc(r,p)||d&&u.pc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),this.query.an()||this.query.un())for(;f.size>this.query.limit;){var n=this.query.an()?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{bc:f,Dc:a,Nc:l,qt:h}},Tf.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Tf.prototype.Un=function(t,e,n){var o=this,r=this.bc;this.bc=t.bc,this.qt=t.qt;var i=t.Dc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==i.length||a?{snapshot:new to(this.query,t.bc,r,i,t.qt,0==u,a,!1),$c:s}:{$c:s}},Tf.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new $i,qt:this.qt,Nc:!1},!1)):{$c:[]}},Tf.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},Tf.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gc=e.gc.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gc=e.gc.delete(t)}),this.Yt=t.Yt)},Tf.prototype.kc=function(){var e=this;if(!this.Yt)return[];var n=this.yc;this.yc=Ki(),this.bc.forEach(function(t){e.Oc(t.key)&&(e.yc=e.yc.add(t.key))});var r=[];return n.forEach(function(t){e.yc.has(t)||r.push(new hf(t))}),this.yc.forEach(function(t){n.has(t)||r.push(new cf(t))}),r},Tf.prototype.Mc=function(t){this.gc=t.gh,this.yc=Ki();var e=this.Sc(t.documents);return this.Un(e,!0)},Tf.prototype.Lc=function(){return to.Qt(this.query,this.bc,this.qt,0===this.Vc)},Tf),Ef=(Object.defineProperty(If.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),If.prototype.subscribe=function(t){this.Wc=t},If.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.nl("listen()"),(r=this.jc.get(s))?(e=r.targetId,this.Uc.ec(e),n=r.view.Lc(),[3,4]):[3,1];case 1:return[4,Nh(this.La,wu(s))];case 2:return i=t.sent(),o=this.Uc.ec(i.targetId),e=i.targetId,[4,this.sl(s,e,"current"===o)];case 3:n=t.sent(),this.el&&this.Bc.listen(i),t.label=4;case 4:return[2,n]}})})},If.prototype.sl=function(u,a,c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,Ah(this.La,u,!0)];case 1:return e=t.sent(),n=new bf(u,e.gh),r=n.Sc(e.documents),i=no.Ht(a,c&&"Offline"!==this.onlineState),o=n.Un(r,this.el,i),this.il(a,o.$c),s=new ff(u,a,n),[2,(this.jc.set(u,s),this.Kc.has(a)?this.Kc.get(a).push(u):this.Kc.set(a,[u]),o.snapshot)]}})})},If.prototype.lu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.nl("unlisten()"),e=this.jc.get(i),1<(n=this.Kc.get(e.targetId)).length?[2,(this.Kc.set(e.targetId,n.filter(function(t){return!Tu(t,i)})),void this.jc.delete(i))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,_h(this.La,e.targetId,!1).then(function(){r.Uc.rc(e.targetId),r.Bc.lu(e.targetId),r.rl(e.targetId)}).catch(Dh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,_h(this.La,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},If.prototype.write=function(s,u){return g(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:this.nl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.La,c=s,f=e,l=ti.now(),n=c.reduce(function(t,e){return t.add(e.key)},Ki()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Zn(a,n).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof Bs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof su?t.field(i.field):void 0,s=us(i.transform,o||null);null!=s&&(e=null==e?(new Zs).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Ms(o.key,s,function u(t){var a=[];return Wr(t.fields||{},function(t,e){var n=new oi([t]);if(xo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ns(a)}(s.proto.mapValue),Ds.exists(!0)))}return f.Gn.mr(a,l,n,c)})}).then(function(t){var e=t.An(h);return{batchId:t.batchId,Fn:e}}))];case 2:return r=t.sent(),this.Uc.Ju(r.batchId),this.ol(r.batchId,u),[4,this.hl(r.Fn)];case 3:return t.sent(),[4,this.Bc.hu()];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),o=Ha(i,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,c,h,f,l,n})})},If.prototype.Iu=function(i){return g(this,void 0,void 0,function(){var n,r=this;return w(this,function(t){switch(t.label){case 0:this.nl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,h=e,f=(s=i).Z,l=h.Eh,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Ah.jr({Gr:!0});l=h.Eh;var c=[];s.Wt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.ko.Io(a,t.Zt,e).next(function(){return h.ko.To(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(r=u.et(n,f).tt(a.Ro),l=l.st(e,r),i=u,s=t,Vr(0<(o=r).resumeToken.Y()),(0===i.resumeToken.Y()||3e8<=o.Z.m()-i.Z.m()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&c.push(h.ko.lo(a,r))))});var t,o=ji,n=Ki();return s.Kt.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Kt.forEach(function(t,e){var n=r.get(t);e instanceof uu&&e.version.isEqual(ei.min())?(i.Mn(t,f),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,f),o=o.st(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Gt.has(t)&&c.push(h.persistence.dr.wh(a,t))})})),f.isEqual(ei.min())||(t=h.ko.ro(a).next(function(t){return h.ko.ho(a,a.Ro,f)}),c.push(t)),sa.Cn(c).next(function(){return i.apply(a)}).next(function(){return h.Rh.ts(a,o)})}).then(function(t){return h.Eh=l,t}))];case 2:return n=t.sent(),i.Wt.forEach(function(t,e){var n=r.Hc.get(e);n&&(Vr(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.qc=!0:0<t.Xt.size?Vr(n.qc):0<t.Zt.size&&(Vr(n.qc),n.qc=!1))}),[4,this.hl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,h,f,l})})},If.prototype.xc=function(r,t){var i;(this.el&&0===t||!this.el&&1===t)&&(this.nl("applyOnlineStateChange()"),i=[],this.jc.forEach(function(t,e){var n=e.view.xc(r);n.snapshot&&i.push(n.snapshot)}),this.Wc.al(r),this.Wc.Ea(i),this.onlineState=r,this.el&&this.Uc.uc(r))},If.prototype.mu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(u,"rejected",a),e=this.Hc.get(u),(n=e&&e.key)?(r=(r=new xi(si.P)).st(n,new uu(n,ei.min())),i=Ki().add(n),o=new eo(ei.min(),new Map,new Fi(Fr),r,i),[4,this.Iu(o)]):[3,2];case 1:return t.sent(),this.zc=this.zc.remove(n),this.Hc.delete(u),this.ul(),[3,4];case 2:return[4,_h(this.La,u,!1).then(function(){return s.rl(u,a)}).catch(Dh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},If.prototype.yu=function(i){return g(this,void 0,void 0,function(){var n,r;return w(this,function(t){switch(t.label){case 0:this.nl("applySuccessfulWrite()"),n=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,h=i,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=h.batch.keys(),n=f.Ah.jr({Gr:!0}),r=f,o=t,s=n,u=(i=h).batch,a=u.keys(),c=sa.resolve();return a.forEach(function(r){c=c.next(function(){return s.Ln(o,r)}).next(function(t){var e=t,n=i.Pn.get(r);Vr(null!==n),(!e||e.version.o(n)<0)&&(e=u.En(r,e,i))&&s.xn(e,i.Rn)})}),c.next(function(){return r.Gn.br(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Gn.Cr(t)}).next(function(){return f.Rh.Zn(t,e)})}))];case 2:return r=t.sent(),this.cl(n,null),this.ll(n),this.Uc.Zu(n,"acknowledged"),[4,this.hl(r)];case 3:return t.sent(),[3,6];case 4:return[4,Dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})},If.prototype.bu=function(o,s){return g(this,void 0,void 0,function(){var n;return w(this,function(t){switch(t.label){case 0:this.nl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,r=o,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Gn.Rr(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.Gn.br(e,t)}).next(function(){return i.Gn.Cr(e)}).next(function(){return i.Rh.Zn(e,n)})}))];case 2:return n=t.sent(),this.cl(o,s),this.ll(o),this.Uc.Zu(o,"rejected",s),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})},If.prototype._l=function(u){return g(this,void 0,void 0,function(){var r,i,o,s;return w(this,function(t){switch(t.label){case 0:this.Bc.Ga()||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.La,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.Gn.Vr(t)}))];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=this.Xc.get(r)||[]).push(u),this.Xc.set(r,i),[3,4]);case 3:return o=t.sent(),s=Ha(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},If.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach(function(t){t.resolve()}),this.Xc.delete(t)},If.prototype.fl=function(e){this.Xc.forEach(function(t){t.forEach(function(t){t.reject(new $r(Jr.CANCELLED,e))})}),this.Xc.clear()},If.prototype.ol=function(t,e){var n=(n=(n=this.Jc[this.currentUser.$h()])||new xi(Fr)).st(t,e);this.Jc[this.currentUser.$h()]=n},If.prototype.cl=function(t,e){var n,r=this.Jc[this.currentUser.$h()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Jc[this.currentUser.$h()]=r)},If.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach(function(t){n.Yc.Nr(t)||n.wl(t)})},If.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},If.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof cf?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof hf?(Lr("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):Cr()}},If.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(Lr("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},If.prototype.ul=function(){for(;0<this.Gc.length&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new lf(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new Di(wu(vu(t.path)),e,2,la.Es))}},If.prototype.El=function(){return this.zc},If.prototype.Il=function(){return this.Gc},If.prototype.hl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.jc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Sc(r);return n.Nc?Ah(u.La,i.query,!1).then(function(t){var e=t.documents;return i.view.Sc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.Un(t,u.el,n);u.il(i.targetId,r.$c),r.snapshot&&(u.el&&u.Uc.oc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=fa._s(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Wc.Ea(o),[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return sa.forEach(f,function(e){return sa.forEach(e.cs,function(t){return r.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return sa.forEach(e.ls,function(t){return r.persistence.dr.mo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Eh.get(s),a=u.Z,c=u.nt(a),r.Eh=r.Eh.st(s,c));return[2]}})})}(this.La,s)];case 2:return t.sent(),[2]}})})},If.prototype.nl=function(t){},If.prototype.vu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Lr("SyncEngine","User change. New user:",n.$h()),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Gn,m=e.Rh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Gn.yr(v).next(function(t){return g=t,n=e.persistence.oh(o),m=new ha(e.Ah,n,e.persistence.uh()),n.yr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zn(v,r).next(function(t){return{ml:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.Gn=n,e.Rh=m,e.Th.Ph(e.Rh),r)]}})})}(this.La,n)]);case 1:return e=t.sent(),this.currentUser=n,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(n,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},If.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return Ki().add(e.key);var n=Ki(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.jc.get(s),n=n.Nt(u.view.vc);return n},If);function If(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new Zr(Nu,Tu),this.Kc=new Map,this.Gc=[],this.zc=new xi(si.P),this.Hc=new Map,this.Yc=new kh,this.Jc={},this.Xc=new Map,this.Zc=nh.eo(),this.onlineState="Unknown",this.tl=void 0}function Tf(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=Ki(),this.qt=Ki(),this.pc=Su(t),this.bc=new Ji(this.pc)}function Nf(){this.Rc=new gf,this.Pc={},this.Da=null,this.fs=null}function _f(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new xi(Fr),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=sf(this.persistenceKey,this.ku),this.qu="firestore_sequence_number_"+this.persistenceKey,this.Ou=this.Ou.st(this.ku,new gf),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.$u)}function Af(){this.activeTargetIds=Yi}function Sf(t,e){this.clientId=t,this.onlineState=e}function Df(t,e){this.clientId=t,this.activeTargetIds=e}function kf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Rf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Lf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Kc.get(s))&&0!==a.length?[4,Nh(e.La,wu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.jc.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,Ah((e=i).La,o.query,!0)];case 1:return n=t.sent(),r=o.view.Mc(n),[2,(e.el&&e.il(o.targetId,r.$c),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Sh(e.La,s)];case 8:return d=t.sent(),[4,Nh(e.La,d)];case 9:return u=t.sent(),[4,e.sl(xf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Wc.Ea(r),n)]}})})}function xf(t){return yu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Of(){this.Pl=void 0,this.listeners=[]}var Pf,Cf=(zf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new Of),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.fu.listen(e)];case 2:return i.Pl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ha(o,"Initialization of query '"+_u(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(u),u.xc(this.onlineState),r.Pl&&u.yl(r.Pl)&&this.pl(),[2]}})})},zf.prototype.lu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.gl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]})})},zf.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},zf.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},zf.prototype.al=function(i){this.onlineState=i;var o=!1;this.gl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xc(i)&&(o=!0)}),o&&this.pl()},zf.prototype.bl=function(t){this.Vl.add(t),t.next()},zf.prototype.vl=function(t){this.Vl.delete(t)},zf.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},zf),Vf=(Bf.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new to(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},Bf.prototype.onError=function(t){this.Sl.error(t)},Bf.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},Bf.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},Bf.prototype.Nl=function(t){if(0<t.docChanges.length)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},Bf.prototype.kl=function(t){t=to.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},Bf),Uf=(Gf.prototype.Ph=function(t){this.xl=t},Gf.prototype.ns=function(e,r,i,o){var s=this;return r.hn()||i.isEqual(ei.min())?this.Ol(e,r):this.xl.Zn(e,o).next(function(t){var n=s.Ml(r,t);return(r.an()||r.un())&&s.Nc(r.nn,n,o,i)?s.Ol(e,r):(Rr()<=l.DEBUG&&Lr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_u(r)),s.xl.ns(e,r,i).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},Gf.prototype.Ml=function(n,t){var r=new Fi(Su(n));return t.forEach(function(t,e){e instanceof su&&Au(n,e)&&(r=r.add(e))}),r},Gf.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Gf.prototype.Ol=function(t,e){return Rr()<=l.DEBUG&&Lr("IndexFreeQueryEngine","Using full collection scan to execute query:",_u(e)),this.xl.ns(t,e,ei.min())},Gf),Mf=(jf.prototype.Ir=function(t){return sa.resolve(0===this.Gn.length)},jf.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,0<this.Gn.length&&this.Gn[this.Gn.length-1];var o=new ia(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Rh(a.key,i)),this.zn.Ar(t,a.key.path.p())}return sa.resolve(o)},jf.prototype.Rr=function(t,e){return sa.resolve(this.Bl(e))},jf.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return sa.resolve(this.Gn.length>i?this.Gn[i]:null)},jf.prototype.Vr=function(){return sa.resolve(0===this.Gn.length?-1:this.Ll-1)},jf.prototype.yr=function(t){return sa.resolve(this.Gn.slice())},jf.prototype.Yn=function(t,e){var n=this,r=new Rh(e,0),i=new Rh(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),sa.resolve(o)},jf.prototype.es=function(t,e){var r=this,i=new Fi(Fr);return e.forEach(function(t){var e=new Rh(t,0),n=new Rh(t,Number.POSITIVE_INFINITY);r.ql.St([e,n],function(t){i=i.add(t.kh)})}),sa.resolve(this.Ql(i))},jf.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;si.j(i)||(i=i.child(""));var o=new Rh(new si(i),0),s=new Fi(Fr);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),sa.resolve(this.Ql(s))},jf.prototype.Ql=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Bl(t);null!==e&&r.push(e)}),r},jf.prototype.br=function(n,r){var i=this;Vr(0===this.Wl(r.batchId,"removed")),this.Gn.shift();var o=this.ql;return sa.forEach(r.mutations,function(t){var e=new Rh(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.ql=o})},jf.prototype.Sr=function(t){},jf.prototype.Nr=function(t,e){var n=new Rh(e,0),r=this.ql.Ct(n);return sa.resolve(e.isEqual(r&&r.key))},jf.prototype.Cr=function(t){return this.Gn.length,sa.resolve()},jf.prototype.Wl=function(t,e){return this.Ul(t)},jf.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},jf.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},jf),Ff=(qf.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},qf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},qf.prototype.Ln=function(t,e){var n=this.docs.get(e);return sa.resolve(n?n.Or:null)},qf.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),sa.resolve(r)},qf.prototype.ns=function(t,e,n){for(var r=zi,i=new si(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof su&&Au(e,c)&&(r=r.st(c.key,c))}return sa.resolve(r)},qf.prototype.Kl=function(t,e){return sa.forEach(this.docs,function(t){return e(t)})},qf.prototype.jr=function(t){return new qf.Kr(this)},qf.prototype.zr=function(t){return sa.resolve(this.size)},qf);function qf(t,e){this.zn=t,this.jl=e,this.docs=new xi(si.P),this.size=0}function jf(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new Fi(Rh.yh)}function Gf(){}function Bf(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}function zf(t){this.fu=t,this.gl=new Zr(Nu,Tu),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}function Hf(t){var e=this;return(e=Pf.call(this)||this).Hr=t,e}Ff.Kr=(o(Hf,Pf=ua),Hf.prototype.Un=function(n){var r=this,i=[];return this.Fn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),sa.Cn(i)},Hf.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},Hf.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},Hf);var Wf,Kf,Yf=(fl.prototype.be=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),sa.resolve()},fl.prototype.ro=function(t){return sa.resolve(this.lastRemoteSnapshotVersion)},fl.prototype.oo=function(t){return sa.resolve(this.zl)},fl.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),sa.resolve(this.highestTargetId)},fl.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),sa.resolve()},fl.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new nh(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},fl.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,sa.resolve()},fl.prototype.lo=function(t,e){return this.uo(e),sa.resolve()},fl.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),--this.targetCount,sa.resolve()},fl.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gl.delete(t),u.push(o.fo(n,e.targetId)),s++)}),sa.Cn(u).next(function(){return s})},fl.prototype.do=function(t){return sa.resolve(this.targetCount)},fl.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return sa.resolve(n)},fl.prototype.To=function(t,e,n){return this.Hl.vh(e,n),sa.resolve()},fl.prototype.Io=function(e,t,n){this.Hl.Dh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),sa.Cn(i)},fl.prototype.fo=function(t,e){return this.Hl.Ch(e),sa.resolve()},fl.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return sa.resolve(n)},fl.prototype.Nr=function(t,e){return sa.resolve(this.Hl.Nr(e))},fl),Xf=(hl.prototype.start=function(){return Promise.resolve()},hl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(hl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),hl.prototype.Bo=function(){},hl.prototype.Uo=function(){},hl.prototype.uh=function(){return this.zn},hl.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new Mf(this.zn,this.dr),this.Jl[t.$h()]=e),e},hl.prototype.hh=function(){return this.ko},hl.prototype.ah=function(){return this.Kn},hl.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new Qf(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},hl.prototype.e_=function(e,n){return sa.Nn(Object.values(this.Jl).map(function(t){return function(){return t.Nr(e,n)}}))},hl),Qf=(o(cl,Kf=ca),cl),Zf=(al.i_=function(t){return new al(t)},Object.defineProperty(al.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw Cr()},enumerable:!1,configurable:!0}),al.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),sa.resolve()},al.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),sa.resolve()},al.prototype.Dr=function(t,e){return this.r_.add(e.toString()),sa.resolve()},al.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},al.prototype.Zl=function(){this.s_=new Set},al.prototype.t_=function(n){var r=this,i=this.persistence.ah().jr();return sa.forEach(this.r_,function(t){var e=si.B(t);return r.o_(n,e).next(function(t){t||i.Mn(e)})}).next(function(){return r.s_=null,i.apply(n)})},al.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},al.prototype.Xl=function(t){return 0},al.prototype.o_=function(t,e){var n=this;return sa.Nn([function(){return sa.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},al),Jf=(ul.prototype.wa=function(t){this.u_=t},ul.prototype.ca=function(t){this.c_=t},ul.prototype.onMessage=function(t){this.l_=t},ul.prototype.close=function(){this.a_()},ul.prototype.send=function(t){this.h_(t)},ul.prototype.__=function(){this.u_()},ul.prototype.f_=function(t){this.c_(t)},ul.prototype.d_=function(t){this.l_(t)},ul),$f={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},tl=(sl.prototype.va=function(e,t,n,r){var i=this.I_(e,t);Lr("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(e,i,o,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},sl.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},sl.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1-202072605451",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},sl.prototype.I_=function(t,e){var n=$f[t];return this.T_+"/v1/"+e+":"+n},o(ol,Wf=sl),ol.prototype.A_=function(a,e,n,r){return new Promise(function(o,s){var u=new _r;u.listenOnce(Tr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ir.NO_ERROR:var t=u.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ir.TIMEOUT:Lr("Connection",'RPC "'+a+'" timed out'),s(new $r(Jr.DEADLINE_EXCEEDED,"Request time out"));break;case Ir.HTTP_ERROR:var e,n,r=u.getStatus();Lr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Jr).indexOf(i)?i:Jr.UNKNOWN,s(new $r(n,e.message))):s(new $r(Jr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new $r(Jr.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{Lr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},ol.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Er(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Lr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new Jf({h_:function(t){f?Lr("Connection","Not sending because WebChannel is closed:",t):(h||(Lr("Connection","Opening WebChannel transport."),c.open(),h=!0),Lr("Connection","WebChannel sending:",t),c.send(t))},a_:function(){return c.close()}});return a(Nr.EventType.OPEN,function(){f||Lr("Connection","WebChannel transport opened.")}),a(Nr.EventType.CLOSE,function(){f||(f=!0,Lr("Connection","WebChannel transport closed"),l.f_())}),a(Nr.EventType.ERROR,function(t){f||(f=!0,Or("Connection","WebChannel transport errored:",t),l.f_(new $r(Jr.UNAVAILABLE,"The operation could not be completed")))}),a(Nr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Vr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Lr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ai[i];if(void 0!==t)return Li(t)}(),s=r.message,void 0===o&&(o=Jr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.f_(new $r(o,s)),c.close()):(Lr("Connection","WebChannel received:",n),l.d_(n)))}),setTimeout(function(){l.__()},0),l},ol),el=(il.prototype.Ka=function(t){this.y_.push(t)},il.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},il.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},il.prototype.P_=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},il.prototype.V_=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},il.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},il),nl=(rl.prototype.Ka=function(t){},rl.prototype.th=function(){},rl);function rl(){}function il(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}function ol(t){var e=this;return(e=Wf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function sl(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function ul(t){this.h_=t.h_,this.a_=t.a_}function al(t){this.persistence=t,this.n_=new kh,this.s_=null}function cl(t){var e=this;return(e=Kf.call(this)||this).Ro=t,e}function hl(t){var e=this;this.Jl={},this.yo=new la(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new Yf(this),this.zn=new Rc,this.Kn=new Ff(this.zn,function(t){return e.dr.Xl(t)})}function fl(t){this.persistence=t,this.Gl=new Zr(bi,Ei),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.zl=0,this.Hl=new kh,this.targetCount=0,this.Yl=nh.to()}function ll(t){return new Co(t,!0)}var pl,dl,yl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",vl=(Il.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uc=this.b_(e),this.persistence=this.v_(e),[4,this.persistence.start()];case 1:return t.sent(),this.S_=this.D_(e),this.La=this.C_(e),[2]}})})},Il.prototype.D_=function(t){return null},Il.prototype.C_=function(t){return e=this.persistence,n=new Uf,r=t.N_,new Eh(e,n,r);var e,n,r},Il.prototype.v_=function(t){if(t.k_.F_)throw new $r(Jr.FAILED_PRECONDITION,yl);return new Xf(Zf.i_)},Il.prototype.b_=function(t){return new wf},Il.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},Il.prototype.clearPersistence=function(t,e){throw new $r(Jr.FAILED_PRECONDITION,yl)},Il),gl=(o(El,dl=vl),El.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,dl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.La)];case 2:return t.sent(),[2]}})})},El.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new Ja(e,t.ei)},El.prototype.v_=function(t){var e=bh(t.w_.s,t.w_.persistenceKey),n=ll(t.w_.s);return new lh(t.k_.synchronizeTabs,e,t.clientId,Xa.Ui(t.k_.cacheSizeBytes),t.ei,Fa(),qa(),n,this.Uc,t.k_.Vo)},El.prototype.b_=function(t){return new wf},El.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Na.ks()?(e=n+"main",[4,Na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(bh(t,e))},o(bl,pl=El),bl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,pl.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.x_.initialize(this,r)];case 2:return t.sent(),e=this.x_.fu,this.Uc instanceof mf?(this.Uc.fu={Ic:function(u,a,c,h){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).nl("applyBatchState()"),[4,(e=o.La,n=a,i=(r=e).Gn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Zn(e,t):sa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,o.Bc.hu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(o.cl(a,h||null),o.La.Gn.Sr(a)):Cr(),t.label=4;case 4:return[4,o.hl(s)];case 5:return t.sent(),[3,7];case 6:Lr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),mc:function(s,u,a,c){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).tl?(Lr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Kc.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.La,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=eo.zt(u,"current"===a),[4,n.hl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,_h(n.La,u,!0)];case 6:return t.sent(),n.rl(u,c),[3,8];case 7:Cr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),Ac:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=f).tl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Kc.has(i)?(Lr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Sh(n.La,i)]):[3,6];case 2:return o=t.sent(),[4,Nh(n.La,o)];case 3:return s=t.sent(),[4,n.sl(xf(o),s.targetId,!1)];case 4:t.sent(),n.Bc.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Kc.has(e)?[4,_h(n.La,e,!1).then(function(){n.Bc.lu(e),n.rl(e)}).catch(Dh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.La.persistence.rh()}.bind(null,e)},[4,this.Uc.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return r=h,!0!==f||!0===r.tl?[3,3]:(e=r.Uc.zu(),[4,Lf(r,e.N())]);case 1:return i=t.sent(),r.tl=!0,[4,r.Bc.Su(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Bc.listen(u);return[3,7];case 3:return!1!==f||!1===r.tl?[3,7]:(a=[],c=Promise.resolve(),r.Kc.forEach(function(t,e){r.Uc.ic(e)?a.push(e):c=c.then(function(){return r.rl(e),_h(r.La,e,!0)}),r.Bc.lu(e)}),[4,c]);case 4:return t.sent(),[4,Lf(r,a)];case 5:return t.sent(),(n=r).Hc.forEach(function(t,e){n.Bc.lu(e)}),n.Yc.Nh(),n.Hc=new Map,n.zc=new xi(si.P),r.tl=!1,[4,r.Bc.Su(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.x_.fu,e)];case 1:return t.sent(),this.S_&&(e&&!this.S_.tr?this.S_.start(this.La):e||this.S_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},bl.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=Fa();if(!mf.ks(e))throw new $r(Jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=bh(t.w_.s,t.w_.persistenceKey);return new mf(e,t.ei,n,t.clientId,t.N_)}return new wf},bl),ml=(wl.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.La?[3,3]:(this.La=n.La,this.Uc=n.Uc,this.qa=this.O_(r),this.Bc=this.M_(r),this.fu=this.L_(r),this.q_=this.B_(r),this.Uc.Da=function(t){return e.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return t.sent(),[4,this.Bc.Su(this.fu.el)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},wl.prototype.B_=function(t){return new Cf(this.fu)},wl.prototype.O_=function(t){var e,n=ll(t.w_.s),r=(e=t.w_,new tl(e)),i=t.credentials;return new Wh(i,r,n)},wl.prototype.M_=function(t){var e=this;return new Yh(this.La,this.qa,t.ei,function(t){return e.fu.xc(t,0)},new(el.ks()?el:nl))},wl.prototype.L_=function(t){return e=this.La,n=this.Bc,r=this.qa,i=this.Uc,o=t.N_,s=t.Qc,u=!t.k_.F_||!t.k_.synchronizeTabs,a=new Ef(e,n,r,i,o,s),u&&(a.tl=!0),a;var e,n,r,i,o,s,u,a},wl.prototype.terminate=function(){return this.Bc.th()},wl);function wl(){}function bl(t){var e=this;return(e=pl.call(this)||this).x_=t,e}function El(){return null!==dl&&dl.apply(this,arguments)||this}function Il(){}function Tl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Nl=(_l.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},_l.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},_l.prototype.Q_=function(){this.muted=!0},_l.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},_l);function _l(t){this.observer=t,this.muted=!1}function Al(t,e){if(0!==e.length)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+zl(e.length,"argument")+".")}function Sl(t,e,n){if(e.length!==n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires "+zl(n,"argument")+", but was called with "+zl(e.length,"argument")+".")}function Dl(t,e,n){if(e.length<n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+zl(n,"argument")+", but was called with "+zl(e.length,"argument")+".")}function kl(t,e,n,r){if(e.length<n||e.length>r)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+zl(e.length,"argument")+".")}function Rl(t,e,n,r){Vl(t,e,Bl(n)+" argument",r)}function Ll(t,e,n,r){void 0!==r&&Rl(t,e,n,r)}function xl(t,e,n,r){Vl(t,e,n+" option",r)}function Ol(t,e,n,r){void 0!==r&&xl(t,e,n,r)}function Pl(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Ml(s))}var u=Ml(n);throw new $r(Jr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Cl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new $r(Jr.INVALID_ARGUMENT,"Invalid value "+Ml(r)+" provided to function "+t+"() for its "+Bl(n)+" argument. Acceptable values: "+e.join(", "));return r}function Vl(t,e,n,r){if(!("object"===e?Ul(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Ml(r);throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Ul(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ml(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Fl(t,e,n){if(void 0===n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Bl(e)+" argument, but it was undefined.")}function ql(n,t,r){Wr(t,function(t,e){if(r.indexOf(t)<0)throw new $r(Jr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function jl(t,e,n,r){var i=Ml(r);return new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Bl(n)+" argument to be a "+e+", but it was: "+i)}function Gl(t,e,n){if(n<=0)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Bl(e)+" argument to be a positive number, but it was: "+n+".")}function Bl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function zl(t,e){return t+" "+e+(1===t?"":"s")}function Hl(){if("undefined"==typeof Uint8Array)throw new $r(Jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Wl(){if("undefined"==typeof atob)throw new $r(Jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Kl,Yl,Xl=(rp.fromBase64String=function(t){Sl("Blob.fromBase64String",arguments,1),Rl("Blob.fromBase64String","string",1,t),Wl();try{return new rp(Ti.fromBase64String(t))}catch(t){throw new $r(Jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},rp.fromUint8Array=function(t){if(Sl("Blob.fromUint8Array",arguments,1),Hl(),!(t instanceof Uint8Array))throw jl("Blob.fromUint8Array","Uint8Array",1,t);return new rp(Ti.fromUint8Array(t))},rp.prototype.toBase64=function(){return Sl("Blob.toBase64",arguments,0),Wl(),this.W_.toBase64()},rp.prototype.toUint8Array=function(){return Sl("Blob.toUint8Array",arguments,0),Hl(),this.W_.toUint8Array()},rp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},rp.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},rp),Ql=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $r(Jr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Rl("FieldPath","string",e,t[e]),0===t[e].length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new oi(t)},Zl=(o(np,Yl=Ql),np.documentId=function(){return new np(oi.L().F())},np.prototype.isEqual=function(t){if(!(t instanceof np))throw jl("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},np),Jl=new RegExp("[~\\*/\\[\\]]"),$l=function(){this.K_=this},tp=(o(ep,Kl=$l),ep.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},ep.prototype.isEqual=function(t){return t instanceof ep},ep);function ep(t){var e=this;return(e=Kl.call(this)||this).G_=t,e}function np(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yl.call(this,t)||this}function rp(t){Wl(),this.W_=t}function ip(t,e,n){return new xp({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var op,sp,up,ap,cp,hp,fp=(o(Rp,hp=$l),Rp.prototype.z_=function(t){return new _s(t.path,new hs)},Rp.prototype.isEqual=function(t){return t instanceof Rp},Rp),lp=(o(kp,cp=$l),kp.prototype.z_=function(t){var e=ip(this,t,!0),n=this.Z_.map(function(t){return qp(t,e)}),r=new fs(n);return new _s(t.path,r)},kp.prototype.isEqual=function(t){return this===t},kp),pp=(o(Dp,ap=$l),Dp.prototype.z_=function(t){var e=ip(this,t,!0),n=this.Z_.map(function(t){return qp(t,e)}),r=new vs(n);return new _s(t.path,r)},Dp.prototype.isEqual=function(t){return this===t},Dp),dp=(o(Sp,up=$l),Sp.prototype.z_=function(t){var e=new bs(t.serializer,Mo(t.serializer,this.tf));return new _s(t.path,e)},Sp.prototype.isEqual=function(t){return this===t},Sp),yp=(o(Ap,sp=$l),Ap.delete=function(){return Al("FieldValue.delete",arguments),new vp(new tp("FieldValue.delete"))},Ap.serverTimestamp=function(){return Al("FieldValue.serverTimestamp",arguments),new vp(new fp("FieldValue.serverTimestamp"))},Ap.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dl("FieldValue.arrayUnion",arguments,1),new vp(new lp("FieldValue.arrayUnion",t))},Ap.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dl("FieldValue.arrayRemove",arguments,1),new vp(new pp("FieldValue.arrayRemove",t))},Ap.increment=function(t){return Rl("FieldValue.increment","number",1,t),Sl("FieldValue.increment",arguments,1),new vp(new dp("FieldValue.increment",t))},Ap),vp=(o(_p,op=yp),_p.prototype.z_=function(t){return this.K_.z_(t)},_p.prototype.isEqual=function(t){return t instanceof _p&&this.K_.isEqual(t.K_)},_p),gp=(Object.defineProperty(Np.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(Np.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Np.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},Np.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},Np.prototype.T=function(t){return Fr(this.ef,t.ef)||Fr(this.nf,t.nf)},Np),mp=/^__.*__$/,wp=function(t,e,n){this.sf=t,this.if=e,this.rf=n},bp=(Tp.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Ms(t,this.data,this.qe,e)):n.push(new Us(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},Tp),Ep=(Ip.prototype.hf=function(t,e){var n=[new Ms(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Bs(t,this.fieldTransforms)),n},Ip);function Ip(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Tp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Np(t,e){if(Sl("GeoPoint",arguments,2),Rl("GeoPoint","number",1,t),Rl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $r(Jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $r(Jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}function _p(t){var e=this;return(e=op.call(this)||this).K_=t,e.G_=t.G_,e}function Ap(){return sp.call(this)||this}function Sp(t,e){var n=this;return(n=up.call(this)||this).G_=t,n.tf=e,n}function Dp(t,e){var n=this;return(n=ap.call(this)||this).G_=t,n.Z_=e,n}function kp(t,e){var n=this;return(n=cp.call(this)||this).G_=t,n.Z_=e,n}function Rp(t){var e=this;return(e=hp.call(this)||this).G_=t,e}function Lp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var xp=(Object.defineProperty(Cp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Cp.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),Cp.prototype.uf=function(t){return new Cp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},Cp.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},Cp.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},Cp.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},Cp.prototype.Y_=function(t){return Wp(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},Cp.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Cp.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},Cp.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(Lp(this.H_)&&mp.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},Cp),Op=(Pp.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new xp({H_:t,methodName:e,J_:n,path:oi.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Pp);function Pp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||ll(t)}function Cp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}function Vp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Bp("Data must be an object, but it was:",s,r);var u,a,c=jp(r,s);if(o.merge)u=new Ns(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Ql)d=p.j_;else{if("string"!=typeof p)throw Cr();d=Hp(e,p,n)}if(!s.contains(d))throw new $r(Jr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Kp(h,d)||h.push(d)}u=new Ns(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new bp(new Qs(c),u,a)}function Up(t,o,s,e){var u=t.wf(1,o,s);Bp("Data must be an object, but it was:",u,e);var a=[],c=new Zs;Wr(e,function(t,e){var n,r=Hp(o,t,s),i=u._f(r);e instanceof $l&&e.K_ instanceof tp?a.push(r):null!=(n=qp(e,i))&&(a.push(r),c.set(r,n))});var n=new Ns(a);return new Ep(c.ze(),n,u.fieldTransforms)}function Mp(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[zp(e,r,n)],a=[i];if(o.length%2!=0)throw new $r(Jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(zp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],y=new Zs,v=u.length-1;0<=v;--v)Kp(d,u[v])||(h=u[v],f=a[v],l=s._f(h),f instanceof $l&&f.K_ instanceof tp?d.push(h):null!=(p=qp(f,l))&&(d.push(h),y.set(h,p)));var g=new Ns(d);return new Ep(y.ze(),g,s.fieldTransforms)}function Fp(t,e,n,r){return void 0===r&&(r=!1),qp(n,t.wf(r?4:3,e))}function qp(s,t){if(Gp(s))return Bp("Unsupported field value:",t,s),jp(s,t);if(s instanceof $l)return function(t,e){if(!Lp(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.X_&&4!==t.H_)throw t.Y_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=qp(i[r],t.ff(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Mo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:Fo(e.serializer,n)}}if(t instanceof ti){var r=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Fo(e.serializer,r)}}if(t instanceof gp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xl)return{bytesValue:qo(e.serializer,t)};if(t instanceof wp){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Go(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+Ml(t))}(s,t)}function jp(t,r){var i={};return Kr(t)?r.path&&0<r.path.length&&r.qe.push(r.path):Wr(t,function(t,e){var n=qp(e,r.cf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Gp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof gp||t instanceof Xl||t instanceof wp||t instanceof $l)}function Bp(t,e,n){if(!Gp(n)||!Ul(n)){var r=Ml(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function zp(t,e,n){if(e instanceof Ql)return e.j_;if("string"==typeof e)return Hp(t,e);throw Wp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Hp(t,e,n){try{return function(e){if(0<=e.search(Jl))throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Zl.bind.apply(Zl,s([void 0],e.split("."))))}catch(t){throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Wp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Wp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new $r(Jr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Kp(t,e){return t.some(function(t){return t.isEqual(e)})}var Yp=($p.prototype.Af=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),0<this.mutations.length)throw new $r(Jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Yo((i=u).serializer)+"/documents",n={documents:a.map(function(t){return zo(i.serializer,t)})},[4,i.Sa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=Ho(t,e.found.name),r=jo(e.found.updateTime),i=new Qs({mapValue:{fields:e.found.fields}});return new su(n,r,i,{})}(e,n):"missing"in n?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);var n=Ho(t,e.missing),r=jo(e.readTime);return new uu(n,r)}(e,n):Cr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Vr(!!e),s.push(e)}),s)]}})})}(this.qa,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof uu||t instanceof su?n.Pf(t):Cr()}),e)]}})})},$p.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},$p.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},$p.prototype.delete=function(t){this.write([new Ys(t,this.Qe(t))]),this.mf.add(t.toString())},$p.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),this.If)throw this.If;return e=this.Tf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=si.B(e);r.mutations.push(new Xs(n,r.Qe(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Yo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Zo(e.serializer,t)})},[4,e.va("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return t.sent(),this.Ef=!0,[2]}})})},$p.prototype.Pf=function(t){var e;if(t instanceof su)e=t.version;else{if(!(t instanceof uu))throw Cr();e=ei.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $r(Jr.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},$p.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?Ds.updateTime(e):Ds.We()},$p.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(this.mf.has(t.toString())||!e)return Ds.exists(!0);if(e.isEqual(ei.min()))throw new $r(Jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ds.updateTime(e)},$p.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},$p.prototype.Rf=function(){},$p),Xp=(Jp.prototype.run=function(){this.yf()},Jp.prototype.yf=function(){var t=this;this.Ti.bs(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Yp(this.qa),(n=this.pf(e))&&n.then(function(t){r.ei.ai(function(){return e.commit().then(function(){r.ii.resolve(t)}).catch(function(t){r.bf(t)})})}).catch(function(t){r.bf(t)}),[2]})})})},Jp.prototype.pf=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},Jp.prototype.bf=function(t){var e=this;0<this.Vf&&this.vf(t)?(--this.Vf,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},Jp.prototype.vf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ri(e)},Jp),Qp=(Zp.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new Ea,s=!1;return this.credentials.Bh(function(t){return s?void i.ei.gi(function(){return i.Bc.vu(t)}):(s=!0,Lr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject))}),this.ei.ai(function(){return i.Sf.promise}),o.promise},Zp.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()})},Zp.prototype.Cf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:u,Qc:100,k_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Uc=i.Uc,this.La=i.La,this.S_=i.S_,this.qa=o.qa,this.Bc=o.Bc,this.fu=o.fu,this.Nf=o.q_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Ff(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Cf(new vl,new ml,{F_:!1},u,a))];case 4:return[2]}})})},Zp.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===Jr.FAILED_PRECONDITION||t.code===Jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Zp.prototype.Df=function(){if(this.ei.Ii)throw new $r(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},Zp.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()})},Zp.prototype.terminate=function(){var t=this;this.ei.Pi();var r=new Ea;return this.ei.mi(function(){return g(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return t.sent(),[4,this.Uc.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.Uh(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Ha(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},Zp.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new Ea;return this.ei.ai(function(){return t.fu._l(e)}),e.promise},Zp.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Nl(n),o=new Vf(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lu(o)})}},Zp.prototype.kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,u,a){return g(this,void 0,void 0,function(){var s,e=this;return w(this,function(t){switch(t.label){case 0:return s=new Ea,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Rh.Hn(t,e)}))];case 1:return(r=t.sent())instanceof su?s.resolve(r):r instanceof uu?s.resolve(null):s.reject(new $r(Jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Ha(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.ei,this.La,e))]}})})},Zp.prototype.$f=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ea,s=td(e,n,vu(r.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new $r(Jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new $r(Jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Zp.prototype.xf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,a,c){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new Ea,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ah(a,c,!0)];case 1:return e=t.sent(),n=new bf(c,e.gh),r=n.Sc(e.documents),i=n.Un(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ha(o,"Failed to execute query '"+c+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ei,this.La,e))]}})})},Zp.prototype.Of=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ea,s=td(e,n,r,{includeMetadataChanges:!0,$l:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new $r(Jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Zp.prototype.write=function(t){var e=this;this.Df();var n=new Ea;return this.ei.ai(function(){return e.fu.write(t,n)}),n.promise},Zp.prototype.s=function(){return this.w_.s},Zp.prototype.bl=function(t){var e=this;this.Df();var n=new Nl(t);return this.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(Zp.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),Zp.prototype.transaction=function(t){var e=this;this.Df();var n=new Ea;return this.ei.ai(function(){return new Xp(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},Zp);function Zp(t,e){this.credentials=t,this.ei=e,this.clientId=Ur.t(),this.Sf=new Ea}function Jp(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new Ta(this.ei,"transaction_retry")}function $p(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}function td(t,e,n,r,i){var o=new Nl(i),s=new Vf(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lu(s)})}}var ed,nd,rd=(Ed.prototype.Bf=function(t){switch(mo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _o(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new Xl(Ao(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw Cr()}},Ed.prototype.Gf=function(t){var n=this,r={};return Wr(t.fields||{},function(t,e){r[t]=n.Bf(e)}),r},Ed.prototype.jf=function(t){return new gp(_o(t.latitude),_o(t.longitude))},Ed.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},Ed.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return yo(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(vo(t));default:return null}},Ed.prototype.Uf=function(t){var e=No(t),n=new ti(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Ed.prototype.Wf=function(t){var e=ri.k(t);Vr(os(e));var n=new Br(e.get(1),e.get(3)),r=new si(e.V(5));return n.isEqual(this.s)||xr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},Ed),id=Xa.ji,od=(bd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},bd),sd=(Object.defineProperty(wd.prototype,"rd",{get:function(){return this.od||(this.od=new Op(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),wd.prototype.settings=function(t){Sl("Firestore.settings",arguments,1),Rl("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new od(t);if(this.Zf&&!this.sd.isEqual(e))throw new $r(Jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.sd=e).credentials&&(this.nd=function(t){if(!t)return new Fh;switch(t.type){case"gapi":var e=t.hd;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Gh(e,t.zh||"0");case"provider":return t.hd;default:throw new $r(Jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},wd.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},wd.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},wd.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new $r(Jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new $r(Jr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},wd.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.Zf&&!this.Zf.Mf)throw new $r(Jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ea,[2,(this.Jf.mi(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},wd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(wd.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),wd.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},wd.prototype.onSnapshotsInSync=function(t){if(this.Xf(),Tl(t))return this.Zf.bl(t);Rl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},wd.prototype.Xf=function(){return this.Zf||this.ad(new vl,new ml,{F_:!1}),this.Zf},wd.prototype.ld=function(){return new Gr(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},wd.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new Qp(this.nd,this.Jf),this.Zf.start(r,t,e,n)},wd.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $r(Jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $r(Jr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Br(n)},Object.defineProperty(wd.prototype,"app",{get:function(){if(!this.Yf)throw new $r(Jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),wd.prototype.collection=function(t){return Sl("Firestore.collection",arguments,1),Rl("Firestore.collection","non-empty string",1,t),this.Xf(),new kd(ri.k(t),this,null)},wd.prototype.doc=function(t){return Sl("Firestore.doc",arguments,1),Rl("Firestore.doc","non-empty string",1,t),this.Xf(),cd._d(ri.k(t),this,null)},wd.prototype.collectionGroup=function(t){if(Sl("Firestore.collectionGroup",arguments,1),Rl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Sd((e=t,new pu(ri.$(),e)),this,null);var e},wd.prototype.runTransaction=function(e){var n=this;return Sl("Firestore.runTransaction",arguments,1),Rl("Firestore.runTransaction","function",1,e),this.Xf().transaction(function(t){return e(new ud(n,t))})},wd.prototype.batch=function(){return this.Xf(),new ad(this)},Object.defineProperty(wd,"logLevel",{get:function(){switch(Rr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),wd.setLogLevel=function(t){Sl("Firestore.setLogLevel",arguments,1),Cl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),kr.setLogLevel(t)},wd.prototype.fd=function(){return this.sd.timestampsInSnapshots},wd.prototype.dd=function(){return this.sd},wd),ud=(md.prototype.get=function(t){var n=this;Sl("Transaction.get",arguments,1);var r=Vd("Transaction.get",t,this.wd);return this.Td.Af([r.if]).then(function(t){if(!t||1!==t.length)return Cr();var e=t[0];if(e instanceof uu)return new fd(n.wd,r.if,null,!1,!1,r.rf);if(e instanceof su)return new fd(n.wd,r.if,e,!1,!1,r.rf);throw Cr()})},md.prototype.set=function(t,e,n){kl("Transaction.set",arguments,2,3);var r=Vd("Transaction.set",t,this.wd);n=Od("Transaction.set",n);var i=Ud(r.rf,e,n),o=Vp(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},md.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Zl?(Dl("Transaction.update",arguments,3),r=Vd("Transaction.update",t,this.wd),Mp(this.wd.rd,"Transaction.update",r.if,e,n,o)):(Sl("Transaction.update",arguments,2),r=Vd("Transaction.update",t,this.wd),Up(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},md.prototype.delete=function(t){Sl("Transaction.delete",arguments,1);var e=Vd("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},md),ad=(gd.prototype.set=function(t,e,n){kl("WriteBatch.set",arguments,2,3),this.md();var r=Vd("WriteBatch.set",t,this.wd);n=Od("WriteBatch.set",n);var i=Ud(r.rf,e,n),o=Vp(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,Ds.We())),this},gd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),i="string"==typeof e||e instanceof Zl?(Dl("WriteBatch.update",arguments,3),r=Vd("WriteBatch.update",t,this.wd),Mp(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(Sl("WriteBatch.update",arguments,2),r=Vd("WriteBatch.update",t,this.wd),Up(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,Ds.exists(!0))),this},gd.prototype.delete=function(t){Sl("WriteBatch.delete",arguments,1),this.md();var e=Vd("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new Ys(e.if,Ds.We())),this},gd.prototype.commit=function(){return this.md(),this.Id=!0,0<this.Ed.length?this.wd.Xf().write(this.Ed):Promise.resolve()},gd.prototype.md=function(){if(this.Id)throw new $r(Jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},gd),cd=(o(vd,nd=wp),vd._d=function(t,e,n){if(t.length%2!=0)throw new $r(Jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new vd(new si(t),e,n)},Object.defineProperty(vd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"parent",{get:function(){return new kd(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),vd.prototype.collection=function(t){if(Sl("DocumentReference.collection",arguments,1),Rl("DocumentReference.collection","non-empty string",1,t),!t)throw new $r(Jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ri.k(t);return new kd(this.if.path.child(e),this.firestore,null)},vd.prototype.isEqual=function(t){if(!(t instanceof vd))throw jl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},vd.prototype.set=function(t,e){kl("DocumentReference.set",arguments,1,2),e=Od("DocumentReference.set",e);var n=Ud(this.rf,t,e),r=Vp(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,Ds.We()))},vd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Zl?(Dl("DocumentReference.update",arguments,2),Mp(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Sl("DocumentReference.update",arguments,1),Up(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,Ds.exists(!0)))},vd.prototype.delete=function(){return Sl("DocumentReference.delete",arguments,0),this.Zf.write([new Ys(this.if,Ds.We())])},vd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];kl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Tl(i[u])||(ql("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Ol("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};Tl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Rl("DocumentReference.onSnapshot","function",u,i[u]),Ll("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ll("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(vu(this.if.path),c,h)},vd.prototype.get=function(t){var e=this;kl("DocumentReference.get",arguments,0,1),Cd("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new fd(e.firestore,e.if,t,!0,t instanceof su&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Ad(t)})},vd.prototype.withConverter=function(t){return new vd(this.if,this.firestore,t)},vd.prototype.Ad=function(t){var e=t.docs.get(this.if);return new fd(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},vd),hd=(yd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},yd),fd=(dd.prototype.data=function(t){var e=this;if(kl("DocumentSnapshot.data",arguments,0,1),t=Pd("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new ld(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new rd(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",function(t){return new cd(t,e.wd,null)}).Bf(this.Rd.tn())}},dd.prototype.get=function(t,e){var n=this;if(kl("DocumentSnapshot.get",arguments,1,2),e=Pd("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(zp("DocumentSnapshot.get",t,this.if));if(null!==r)return new rd(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",function(t){return new cd(t,n.wd,n.rf)}).Bf(r)}},Object.defineProperty(dd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"ref",{get:function(){return new cd(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"metadata",{get:function(){return new hd(this.gd,this.Pd)},enumerable:!1,configurable:!0}),dd.prototype.isEqual=function(t){if(!(t instanceof dd))throw jl("isEqual","DocumentSnapshot",1,t);return this.wd===t.wd&&this.Pd===t.Pd&&this.if.isEqual(t.if)&&(null===this.Rd?null===t.Rd:this.Rd.isEqual(t.Rd))&&this.rf===t.rf},dd),ld=(o(pd,ed=fd),pd.prototype.data=function(t){return ed.prototype.data.call(this,t)},pd);function pd(){return null!==ed&&ed.apply(this,arguments)||this}function dd(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}function yd(t,e){this.hasPendingWrites=t,this.fromCache=e}function vd(t,e,n){var r=this;return(r=nd.call(this,e.sf,t,n)||this).if=t,r.firestore=e,r.rf=n,r.Zf=r.firestore.Xf(),r}function gd(t){this.wd=t,this.Ed=[],this.Id=!1}function md(t,e){this.wd=t,this.Td=e}function wd(t,e,n,r){var i=this;if(void 0===n&&(n=new vl),void 0===r&&(r=new ml),this.zf=n,this.Hf=r,this.Yf=null,this.Jf=new Ga,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Yf=o,this.sf=wd.td(o),this.ed=o.name,this.nd=new qh(e)}else{var s=t;if(!s.projectId)throw new $r(Jr.INVALID_ARGUMENT,"Must provide projectId");this.sf=new Br(s.projectId,s.database),this.ed="[DEFAULT]",this.nd=new Fh}this.sd=new od({})}function bd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new $r(Jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else xl("settings","non-empty string","host",t.host),this.host=t.host,Ol("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ql("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Ol("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ol("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Ol("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Ol("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Xa.Gi;else{if(t.cacheSizeBytes!==id&&t.cacheSizeBytes<Xa.Ki)throw new $r(Jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Xa.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Ol("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Ed(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}function Id(t,e,n){if("string"==typeof n){if(""===n)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ri.k(n));if(!si.j(r))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return So(t,new si(r))}if(n instanceof wp)return So(t,n.if);throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ml(n)+".")}function Td(t,e){if(!Array.isArray(t)||0===t.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Nd(t,e,n){if(!n.isEqual(e))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function _d(t){if(t.un()&&0===t.en.length)throw new $r(Jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ad,Sd=(xd.prototype.where=function(t,e,n){var r;Sl("Query.where",arguments,3),Fl("Query.where",3,n),r="not-in"===e||"!="===e?e:Cl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=zp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.M()){if("array-contains"===i||"array-contains-any"===i)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Td(o,i);for(var u=[],a=0,c=o;a<c.length;a++){var h=c[a];u.push(Id(n,t,h))}s={arrayValue:{values:u}}}else s=Id(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Td(o,i),s=Fp(e,"Query.where",o,"in"===i||"not-in"===i);var f=ku.create(r,i,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&Nd(0,e.field,r)}var i=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new $r(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $r(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.Vd,this.firestore.rd,this.firestore.sf,s,r,n);return new xd((o=(i=this.Vd).filters.concat([u]),new pu(i.path,i.collectionGroup,i.en.slice(),o,i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.rf)},xd.prototype.orderBy=function(t,e){var n;if(kl("Query.orderBy",arguments,1,2),Ll("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $r(Jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=zp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new ra(e,n),s=o;return null!==(r=t).cn()||null!==(i=r.ln())&&Nd(0,i,s.field),o}(this.Vd,o,n);return new xd((i=(r=this.Vd).en.concat([s]),new pu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.rf)},xd.prototype.limit=function(t){return Sl("Query.limit",arguments,1),Rl("Query.limit","number",1,t),Gl("Query.limit",1,t),new xd(bu(this.Vd,t,"F"),this.firestore,this.rf)},xd.prototype.limitToLast=function(t){return Sl("Query.limitToLast",arguments,1),Rl("Query.limitToLast","number",1,t),Gl("Query.limitToLast",1,t),new xd(bu(this.Vd,t,"L"),this.firestore,this.rf)},xd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.startAt",arguments,1);var r=this.yd("Query.startAt",t,e,!0);return new xd(Eu(this.Vd,r),this.firestore,this.rf)},xd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.startAfter",arguments,1);var r=this.yd("Query.startAfter",t,e,!1);return new xd(Eu(this.Vd,r),this.firestore,this.rf)},xd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.endBefore",arguments,1);var r=this.yd("Query.endBefore",t,e,!0);return new xd(Iu(this.Vd,r),this.firestore,this.rf)},xd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dl("Query.endAt",arguments,1);var r=this.yd("Query.endAt",t,e,!1);return new xd(Iu(this.Vd,r),this.firestore,this.rf)},xd.prototype.isEqual=function(t){if(!(t instanceof xd))throw jl("isEqual","Query",1,t);return this.firestore===t.firestore&&Tu(this.Vd,t.Vd)&&this.rf===t.rf},xd.prototype.withConverter=function(t){return new xd(this.Vd,this.firestore,t)},xd.prototype.yd=function(h,t,e,n){if(Fl(h,1,t),t instanceof fd)return Sl(h,s([t],e),1),function(t,e,n,r){if(!n)throw new $r(Jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.M())i.push(So(e,n.key));else{var a=n.field(u.field);if(yo(a))throw new $r(Jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.F();throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(this.Vd,this.firestore.sf,t.Rd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new $r(Jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!gu(t)&&-1!==c.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.k(c));if(!si.j(h))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new si(h);u.push(So(e,f))}else{var l=Fp(n,r,c);u.push(l)}}return new Xu(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,h,r,n)},xd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];kl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Tl(i[a])||(ql("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Ol("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Tl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Rl("Query.onSnapshot","function",a,i[a]),Ll("Query.onSnapshot","function",a+1,i[a+1]),Ll("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new Dd(r.firestore,r.Vd,t,r.rf))},error:i[a+1],complete:i[a+2]};return _d(this.Vd),this.firestore.Xf().listen(this.Vd,u,c)},xd.prototype.get=function(t){var e=this;kl("Query.get",arguments,0,1),Cd("Query.get",t),_d(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then(function(t){return new Dd(e.firestore,e.Vd,t,e.rf)})},xd),Dd=(Object.defineProperty(Ld.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),Ld.prototype.forEach=function(e,n){var r=this;kl("QuerySnapshot.forEach",arguments,1,2),Rl("QuerySnapshot.forEach","function",1,e),this.bd.docs.forEach(function(t){e.call(n,r.Dd(t,r.metadata.fromCache,r.bd.qt.has(t.key)))})},Object.defineProperty(Ld.prototype,"query",{get:function(){return new Sd(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),Ld.prototype.docChanges=function(t){t&&(ql("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ol("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new $r(Jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},Ld.prototype.isEqual=function(t){if(!(t instanceof Ld))throw jl("isEqual","QuerySnapshot",1,t);return this.wd===t.wd&&Tu(this.pd,t.pd)&&this.bd.isEqual(t.bd)&&this.rf===t.rf},Ld.prototype.Dd=function(t,e,n){return new ld(this.wd,t.key,t,e,n,this.rf)},Ld),kd=(o(Rd,Ad=Sd),Object.defineProperty(Rd.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new cd(new si(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),Rd.prototype.doc=function(t){kl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ur.t()),Rl("CollectionReference.doc","non-empty string",1,t);var e=ri.k(t);return cd._d(this.Vd.path.child(e),this.firestore,this.rf)},Rd.prototype.add=function(t){Sl("CollectionReference.add",arguments,1),Rl("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Rd.prototype.withConverter=function(t){return new Rd(this.Cd,this.firestore,t)},Rd);function Rd(t,e,n){var r=this;if(((r=Ad.call(this,vu(t),e,n)||this).Cd=t).length%2!=1)throw new $r(Jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Ld(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new hd(n.hasPendingWrites,n.fromCache)}function xd(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}function Od(t,e){if(void 0===e)return{merge:!1};if(ql(t,e,["merge","mergeFields"]),Ol(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ml(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Zl))throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Ml(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new $r(Jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Pd(t,e){return void 0===e?{}:(ql(t,e,["serverTimestamps"]),Pl(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Cd(t,e){Ll(t,"object",1,e),e&&(ql(t,e,["source"]),Pl(t,0,"source",e.source,["default","server","cache"]))}function Vd(t,e,n){if(e instanceof wp){if(e.firestore!==n)throw new $r(Jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw jl(t,"DocumentReference",1,e)}function Ud(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Md,Fd={Firestore:sd,GeoPoint:gp,Timestamp:ti,Blob:Xl,Transaction:ud,WriteBatch:ad,DocumentReference:cd,DocumentSnapshot:fd,Query:Sd,QueryDocumentSnapshot:ld,QuerySnapshot:Dd,CollectionReference:kd,FieldPath:Zl,FieldValue:yp,setLogLevel:sd.setLogLevel,CACHE_SIZE_UNLIMITED:id};(Md=r.default).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new ml,i=new gl(r),new sd(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Fd))),Md.registerVersion("@firebase/firestore","1.16.6-202072605451")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});