!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(If){"use strict";try{(function(){var t,u,e,n,i=(n=If)&&"object"==typeof n&&"default"in n?n:{default:n},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function h(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},l=u.INFO,f=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),p=(Object.defineProperty(v.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),v.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(v.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),v.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},v.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},v.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},v.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},v.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},v);function v(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,w="FirebaseError",b=(o(E,m=Error),E);function E(t,e){var n=m.call(this,e)||this;return n.code=t,n.name=w,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(A.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(T,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new b(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},A);function A(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var k,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=S||self;function O(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var V="closure_uid_"+(1e9*Math.random()>>>0),C=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function q(t,e,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,V)&&this[V]||(this[V]=++C))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var X,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var Z=_.navigator;if(Z){var J=Z.userAgent;if(J){X=J;break t}}X=""}function tt(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function rt(t){return rt[" "](t),t}rt[" "]=O;var ot,st,ut=Y(X,"Opera"),at=Y(X,"Trident")||Y(X,"MSIE"),ht=Y(X,"Edge"),ct=ht||at,lt=Y(X,"Gecko")&&!(Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge"))&&!(Y(X,"Trident")||Y(X,"MSIE"))&&!Y(X,"Edge"),ft=Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge");function pt(){var t=_.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=X,lt?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):ft?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=Q(String(ot)).split("."),n=Q(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=_.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),It=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{rt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},F(Tt,At);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function St(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++kt,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=B(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Vt={};function Ct(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Bt(i),e&&e[Rt]?e.wa(n,i,P(r)?!!r.capture:!!r,o):Ut(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,i,r);return null}return n=Bt(n),t&&t[Rt]?t.va(e,n,P(i)?!!i.capture:!!i,r):Ut(t,e,n,!1,i,r)}function Ut(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=P(r)?!!r.capture:!!r;if(s&&!bt)return null;var u,a,h=Ft(t);if(h||(t[Pt]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)It||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Mt(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Rt]?Lt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ft(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):_t(t)))}function qt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function xt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Mt(t),n.call(i,e)}function jt(t,e){if(t.Y)return!0;if(bt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=_,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function Ft(t){return(t=t[Pt])instanceof Ot?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==L(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function Wt(){G.call(this),this.c=new Ot(this),(this.J=this).C=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Lt(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}F(Wt,G),Wt.prototype[Rt]=!0,(k=Wt.prototype).addEventListener=function(t,e,n,i){Ct(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=P(r)?!!r.capture:!!r,i=Bt(i),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Dt(s=e.a[n],i,r,o))&&(_t(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,i,r,o)),(i=-1<e?n[e]:null)&&Mt(i))}(this,t,e,n,i)},k.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new At(t,n):t instanceof At?t.target=t.target||n:(s=t,it(t=new At(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=zt(o,i,!0,t)&&s;if(s=zt(o=t.a=n,i,!0,t)&&s,s=zt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=zt(o=t.a=e[r],i,!1,t)&&s;return s},k.G=function(){if(Wt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)_t(n[i]);delete e.a[t],e.b--}}this.C=null},k.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},k.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var $t=_.JSON.stringify;function Ht(){this.b=this.a=null}var Xt,Qt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Kt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Zt(t,e){var n;Xt||(n=_.Promise.resolve(void 0),Xt=function(){n.then(ee)}),Jt||(Xt(),Jt=!0),te.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Ht;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){_.setTimeout(function(){throw t},0)}(t)}var i=Qt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Jt=!1}function ne(t,e){Wt.call(this),this.b=t||1,this.a=e||_,this.f=q(this.Ya,this),this.g=j()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==L(t))n&&(t=q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=q(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}F(ne,Wt),(k=ne.prototype).aa=!1,k.M=null,k.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},k.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},k.G=function(){ne.S.G.call(this),ie(this),delete this.a};var oe,se,ue,ae=(N(se=ce,ue=oe=G),se.prototype=null===ue?Object.create(ue):(he.prototype=ue.prototype,new he),ce.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ce.prototype.G=function(){oe.prototype.G.call(this),this.a&&(_.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ce);function he(){this.constructor=se}function ce(t,e,n){var i=oe.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function le(t){G.call(this),this.b=t,this.a={}}F(le,G);var fe=[];function pe(t,e,n,i){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var r=0;r<n.length;r++){var o=Ct(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ye(){this.a=!0}function ve(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return $t(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}le.prototype.G=function(){le.S.G.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var ge=null;function me(){return ge=ge||new Wt}function we(t){At.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){At.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Ae(t){At.call(this,"timingevent",t)}function Te(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}F(we,At),F(Ee,At),F(Ae,At);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Re={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function ke(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}ke.prototype.a=null;var Oe,Le={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function De(){At.call(this,"d")}function Pe(){At.call(this,"c")}function Ve(){}function Ce(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new le(this),this.P=Ue,t=ct?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(De,At),F(Pe,At),F(Ve,ke),Oe=new Ve;var Ue=45e3,Me={},qe={};function xe(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Ge(t),t.l=tn(t.i);var s,u,a,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),bn(n.b,"t",i),t.D=0,t.a=pi(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(q(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Fe(t,e,n){for(var i,r,o,s,u=!0;!t.A&&t.D<n.length;){var a=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?qe:(o=Number(r.substring(o,s)),isNaN(o)?Me:(s+=1)+o>r.length?qe:(r=r.substr(s,o),i.D=s+o,r)));if(a==qe){4==e&&(t.h=4,Ie(),u=!1),ve(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,Ie(),ve(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ve(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,Ie(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),oi(e),e.F=!0)):(ve(t.c,t.f,n,"[Invalid Chunked Response]"),$e(t),ze(t))}function Ge(t){t.U=j()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(q(t.Ua,t),e)}function We(t){t.o&&(_.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ai(t.g,t)}function $e(t){We(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,i,r,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||kn(p.b,t)))if(p.I=t.N,!t.C&&kn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ui(p),Yn(p)}ri(p),Ie()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(q(p.Ra,p),6e3));if(Rn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ci(p,11)}else if(!t.C&&p.a!=t||ui(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Y(u,"spdy")||Y(u,"quic")||Y(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Sn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,sn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fi(o,o.C?o.ga:null,o.fa),c.C?(_n(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(We(l),Ge(l)),o.a=c):ii(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||ci(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ci(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);be()}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)W(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ke(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Ke(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(k=Ce.prototype).setTimeout=function(t){this.P=t},k.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},k.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ct&&!this.a.$())){this.A||4!=e||7==n||be(),We(this);var i=this.a.X();this.N=i;var r=this.a.$();if(this.b=200==i,a=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=i,a.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ie(),$e(this),ze(this);break t}ve(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,u)}this.I?(Fe(this,e,r),ct&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ve(this.c,this.f,r,null),He(this,r)),4==e&&$e(this),this.b&&!this.A&&(4==e?ai(this.g,this):(this.b=!1,Ge(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),$e(this),ze(this)}}}catch(t){}var a,h,c,l,f,p,d},k.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(We(this),Fe(this,t,e),this.b&&4!=t&&Ge(this)))},k.cancel=function(){this.A=!0,$e(this)},k.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),$e(this),this.h=2,ze(this)):Be(this,this.U-n)},(k=Qe.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},k.L=function(){return Ye(this),this.a.concat()},k.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},k.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},k.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new vn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Ze))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new vn(null,this.a))}function tn(t){return new Je(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var i,r;e instanceof vn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(gn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},i)),i.f=r):(n||(e=hn(e,dn)),t.b=new vn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,yn)),t.join("")};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Qe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=En(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function wn(t,e){return gn(t),e=En(t,e),Ke(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),$(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function An(t){this.g=t||Tn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ia&&_.ia.ya&&_.ia.ya()&&_.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(k=vn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},k.forEach=function(n,i){gn(this),this.a.forEach(function(t,e){W(t,function(t){n.call(i,t,e,this)},this)},this)},k.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},k.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=z(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},k.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},k.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},k.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function Rn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Sn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return $(t.c);var i=t.c;try{for(var r=R(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Ln(){}function Dn(){this.a=new Ln}function Pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}An.prototype.cancel=function(){var t,e;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Vn=_.JSON.parse;function Cn(t){Wt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}F(Cn,Wt);var Un="",Mn=/^https?$/i,qn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),Bn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Ze)[1]||null)&&_.self&&_.self.location&&(r=(i=_.self.location.protocol).substr(0,i.length-1)),n=!Mn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Fn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Wn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function $n(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",tt(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new An(t&&t.concurrentRequestLimit),this.ka=new Dn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),ei(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.i.toString(),"")),!n&&_.Image&&((new Image).src=e.i,n=!0),n||(e.a=pi(e.g,null),e.a.ba(e.i)),e.u=j(),Ge(e)),li(t)}function Yn(t){t.a&&(oi(t),t.a.cancel(),t.a=null)}function Kn(t){Yn(t),t.j&&(_.clearTimeout(t.j),t.j=null),ui(t),t.b.cancel(),t.h&&("number"==typeof t.h&&_.clearTimeout(t.h),t.h=null)}function Zn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Nn(t.b)||t.h||(t.h=!0,Zt(t.Ba,t),t.u=0)}function ti(t,e){var n=e?e.f:t.R++,i=tn(t.B);sn(i,"SID",t.J),sn(i,"RID",n),sn(i,"AID",t.P),ei(t,i),t.i&&t.l&&$n(i,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ni(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sn(t.b,n),xe(n,i,e)}function ei(t,n){t.f&&Xe({},function(t,e){sn(n,e,t)})}function ni(t,e,n){n=Math.min(t.g.length,n);var i=t.f?q(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i){var r="req"+h+"_"||"";try{Xe(t,function(t,e){var n=t;P(t)&&(n=$t(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ii(t){t.a||t.j||(t.U=1,Zt(t.Aa,t),t.o=0)}function ri(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(q(t.Aa,t),hi(t,t.o)),t.o++,1)}function oi(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function si(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),ei(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&$n(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,je(n,t)}function ui(t){null!=t.m&&(_.clearTimeout(t.m),t.m=null)}function ai(t,e){var n,i=null;if(t.a==e){ui(t),oi(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;i=e.s,_n(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)1==r?(i=e.j?e.j.length:0,e=j()-e.u,n=t.u,(r=me()).dispatchEvent(new Ae(r)),Jn(t)):ii(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Rn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(q(t.Ba,t,e),hi(t,t.u)),t.u++,1}}(t,e)||2==r&&ri(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ci(t,5);break;case 4:ci(t,10);break;case 3:ci(t,6);break;default:ci(t,2)}}function hi(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ci(t,e){var n,i,r,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=q(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||en(n,"https"),un(n)),r=n.toString(),o=i,u=new ye,_.Image?((s=new Image).onload=x(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=x(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=x(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(Pn,u,s,"TestLoadImage: timeout",!1,o),_.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),li(t),Kn(t)}function li(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,$(t.g),t.g.length=0),t.f.qa())}function fi(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Je?tn(i):new Je(i,void 0);return""!=c.c?(e&&nn(c,e+"."+c.c),rn(c,c.h)):(o=(r=_.location).protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Je(null,void 0),o&&en(h,o),s&&nn(h,s),u&&rn(h,u),a&&(h.g=a),c=h),t.W&&tt(t.W,function(t,e){sn(c,e,t)}),e=t.A,n=t.na,e&&n&&sn(c,e,n),sn(c,"VER",t.ha),ei(t,c),c}function pi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function di(){}function yi(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function vi(t,e){Wt.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wi(this)}function gi(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mi(){Pe.call(this),this.status=1}function wi(t){this.a=t}(k=Cn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(Oe),this.a.onreadystatechange=q(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&Xe(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=xn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=_.FormData&&t instanceof _.FormData,0<=B(qn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=(r=this.a,at&&mt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=q(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},k.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},k.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},k.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},k.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},k.Ta=function(){Gn(this)},k.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},k.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},k.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Vn(e)}},k.ua=function(){return this.h},k.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(k=Xn.prototype).ha=8,k.v=1,k.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),i=this.l;if(this.O&&(i?it(i=et(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ni(this,n,e),sn(r=tn(this.B),"RID",t),sn(r,"CVER",22),this.A&&sn(r,"X-HTTP-Session-Id",this.A),ei(this,r),this.i&&i&&$n(r,this.i,i),Sn(this.b,n),this.Ga&&sn(r,"TYPE","init"),this.da?(sn(r,"$req",e),sn(r,"SID","null"),n.V=!0,xe(n,r,null)):xe(n,r,e),this.v=2}}else 3==this.v&&(t?ti(this,t):0==this.g.length||Nn(this.b)||ti(this))},k.Aa=function(){var t;this.j=null,si(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(q(this.Sa,this),t))},k.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),si(this))},k.Ra=function(){null!=this.m&&(this.m=null,Yn(this),ri(this),Ie())},k.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(k=di.prototype).ta=function(){},k.sa=function(){},k.ra=function(){},k.qa=function(){},k.Ha=function(){},yi.prototype.a=function(t,e){return new vi(t,e)},F(vi,Wt),(k=vi.prototype).addEventListener=function(t,e,n,i){vi.S.addEventListener.call(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){vi.S.removeEventListener.call(this,t,e,n,i)},k.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=fi(t,null,t.fa),Jn(t)},k.close=function(){Qn(this.a)},k.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Zn(this.a,e)):this.g?((e={}).__data__=$t(t),Zn(this.a,e)):Zn(this.a,t)},k.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,vi.S.G.call(this)},F(gi,De),F(mi,Pe),F(wi,di),wi.prototype.ta=function(){this.a.dispatchEvent("a")},wi.prototype.sa=function(t){this.a.dispatchEvent(new gi(t))},wi.prototype.ra=function(t){this.a.dispatchEvent(new mi)},wi.prototype.qa=function(){this.a.dispatchEvent("b")},yi.prototype.createWebChannel=yi.prototype.a,vi.prototype.send=vi.prototype.Pa,vi.prototype.open=vi.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Re.COMPLETE="complete",(_e.EventType=Le).OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",Wt.prototype.listen=Wt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var bi={createWebChannelTransport:function(){return new yi},ErrorCode:Ne,EventType:Re,WebChannel:_e,XhrIo:Cn},Ei=bi.createWebChannelTransport,Ii=bi.ErrorCode,Ai=bi.EventType,Ti=bi.WebChannel,Ni=bi.XhrIo,Ri=(ki.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},ki.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},ki.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ki);function ki(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Si="7.19.1-202072605451",_i=new p("@firebase/firestore");function Oi(){return _i.logLevel}function Li(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.DEBUG&&(e=n.map(Vi),_i.debug.apply(_i,s(["Firestore ("+Si+"): "+t],e)))}function Di(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.ERROR&&(e=n.map(Vi),_i.error.apply(_i,s(["Firestore ("+Si+"): "+t],e)))}function Pi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.WARN&&(e=n.map(Vi),_i.warn.apply(_i,s(["Firestore ("+Si+"): "+t],e)))}function Vi(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ci(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Si+") INTERNAL ASSERTION FAILED: "+t;throw Di(e),new Error(e)}function Ui(t){t||Ci()}var Mi=(qi.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},qi);function qi(){}function xi(t,e){return t<e?-1:e<t?1:0}function ji(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Fi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Gi=(Object.defineProperty(Bi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Bi.prototype.isEqual=function(t){return t instanceof Bi&&t.projectId===this.projectId&&t.database===this.database},Bi.prototype.o=function(t){return xi(this.projectId,t.projectId)||xi(this.database,t.database)},Bi);function Bi(t,e){this.projectId=t,this.database=e||"(default)"}function Wi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hi,Xi,Qi,Yi=(pr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},pr.prototype.has=function(t){return void 0!==this.get(t)},pr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},pr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},pr.prototype.forEach=function(u){zi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},pr.prototype._=function(){return $i(this.l)},pr),Ki={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Zi=(o(fr,Qi=Error),fr),Ji=(lr.now=function(){return lr.fromMillis(Date.now())},lr.fromDate=function(t){return lr.fromMillis(t.getTime())},lr.fromMillis=function(t){var e=Math.floor(t/1e3);return new lr(e,1e6*(t-1e3*e))},lr.prototype.toDate=function(){return new Date(this.toMillis())},lr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},lr.prototype.m=function(t){return this.seconds===t.seconds?xi(this.nanoseconds,t.nanoseconds):xi(this.seconds,t.seconds)},lr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},lr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},lr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},lr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},lr),tr=(cr.T=function(t){return new cr(t)},cr.min=function(){return new cr(new Ji(0,0))},cr.prototype.o=function(t){return this.timestamp.m(t.timestamp)},cr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},cr.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},cr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},cr.prototype.R=function(){return this.timestamp},cr),er=(Object.defineProperty(hr.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),hr.prototype.isEqual=function(t){return 0===hr.P(this,t)},hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},hr.prototype.limit=function(){return this.offset+this.length},hr.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},hr.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},hr.prototype.v=function(){return this.segments[this.offset]},hr.prototype.S=function(){return this.get(this.length-1)},hr.prototype.get=function(t){return this.segments[this.offset+t]},hr.prototype._=function(){return 0===this.length},hr.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hr.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},hr.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hr),nr=(o(ar,Xi=er),ar.prototype.V=function(t,e,n){return new ar(t,e,n)},ar.prototype.N=function(){return this.F().join("/")},ar.prototype.toString=function(){return this.N()},ar.$=function(t){if(0<=t.indexOf("//"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ar(t.split("/").filter(function(t){return 0<t.length}))},ar.k=function(){return new ar([])},ar),ir=/^[_a-zA-Z][_a-zA-Z0-9]*$/,rr=(o(ur,Hi=er),ur.prototype.V=function(t,e,n){return new ur(t,e,n)},ur.O=function(t){return ir.test(t)},ur.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ur.O(t)||(t="`"+t+"`"),t}).join(".")},ur.prototype.toString=function(){return this.N()},ur.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ur.M=function(){return new ur(["__name__"])},ur.q=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Zi(Ki.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Zi(Ki.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ur(e)},ur.k=function(){return new ur([])},ur),or=(sr.U=function(t){return new sr(nr.$(t))},sr.B=function(t){return new sr(nr.$(t).p(5))},sr.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},sr.prototype.isEqual=function(t){return null!==t&&0===nr.P(this.path,t.path)},sr.prototype.toString=function(){return this.path.toString()},sr.P=function(t,e){return nr.P(t.path,e.path)},sr.j=function(t){return t.length%2==0},sr.G=function(t){return new sr(new nr(t.slice()))},sr);function sr(t){this.path=t}function ur(){return null!==Hi&&Hi.apply(this,arguments)||this}function ar(){return null!==Xi&&Xi.apply(this,arguments)||this}function hr(t,e,n){void 0===e?e=0:e>t.length&&Ci(),void 0===n?n=t.length-e:n>t.length-e&&Ci(),this.segments=t,this.offset=e,this.A=n}function cr(t){this.timestamp=t}function lr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function fr(t,e){var n=this;return(n=Qi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function pr(t,e){this.h=t,this.u=e,this.l={}}function dr(t){return null==t}function yr(t){return-0===t&&1/t==-1/0}var vr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.K=null};function gr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new vr(t,e,n,i,r,o,s)}function mr(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+Eo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),dr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Bu(n.startAt)),n.endAt&&(e+="|ub:",e+=Bu(n.endAt)),n.K=e),n.K}function wr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zu(t.startAt,e.startAt)&&zu(t.endAt,e.endAt)}function br(t){return or.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Er=(Ir.fromBase64String=function(t){return new Ir(atob(t))},Ir.fromUint8Array=function(t){return new Ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ir.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ir.prototype.Y=function(){return 2*this.H.length},Ir.prototype.o=function(t){return xi(this.H,t.H)},Ir.prototype.isEqual=function(t){return this.H===t.H},Ir);function Ir(t){this.H=t}function Ar(t){this.count=t}Er.J=new Er("");var Tr,Nr,Rr=(kr.prototype.tt=function(t){return new kr(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},kr.prototype.et=function(t,e){return new kr(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},kr.prototype.nt=function(t){return new kr(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},kr);function kr(t,e,n,i,r,o,s){void 0===r&&(r=tr.min()),void 0===o&&(o=tr.min()),void 0===s&&(s=Er.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.Z=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Sr(t){switch(t){case Ki.OK:return Ci(),0;case Ki.CANCELLED:case Ki.UNKNOWN:case Ki.DEADLINE_EXCEEDED:case Ki.RESOURCE_EXHAUSTED:case Ki.INTERNAL:case Ki.UNAVAILABLE:case Ki.UNAUTHENTICATED:return;case Ki.INVALID_ARGUMENT:case Ki.NOT_FOUND:case Ki.ALREADY_EXISTS:case Ki.PERMISSION_DENIED:case Ki.FAILED_PRECONDITION:case Ki.ABORTED:case Ki.OUT_OF_RANGE:case Ki.UNIMPLEMENTED:case Ki.DATA_LOSS:return 1;default:return Ci(),0}}function _r(t){if(void 0===t)return Di("GRPC error has no .code"),Ki.UNKNOWN;switch(t){case Tr.OK:return Ki.OK;case Tr.CANCELLED:return Ki.CANCELLED;case Tr.UNKNOWN:return Ki.UNKNOWN;case Tr.DEADLINE_EXCEEDED:return Ki.DEADLINE_EXCEEDED;case Tr.RESOURCE_EXHAUSTED:return Ki.RESOURCE_EXHAUSTED;case Tr.INTERNAL:return Ki.INTERNAL;case Tr.UNAVAILABLE:return Ki.UNAVAILABLE;case Tr.UNAUTHENTICATED:return Ki.UNAUTHENTICATED;case Tr.INVALID_ARGUMENT:return Ki.INVALID_ARGUMENT;case Tr.NOT_FOUND:return Ki.NOT_FOUND;case Tr.ALREADY_EXISTS:return Ki.ALREADY_EXISTS;case Tr.PERMISSION_DENIED:return Ki.PERMISSION_DENIED;case Tr.FAILED_PRECONDITION:return Ki.FAILED_PRECONDITION;case Tr.ABORTED:return Ki.ABORTED;case Tr.OUT_OF_RANGE:return Ki.OUT_OF_RANGE;case Tr.UNIMPLEMENTED:return Ki.UNIMPLEMENTED;case Tr.DATA_LOSS:return Ki.DATA_LOSS;default:return Ci()}}(Nr=Tr=Tr||{})[Nr.OK=0]="OK",Nr[Nr.CANCELLED=1]="CANCELLED",Nr[Nr.UNKNOWN=2]="UNKNOWN",Nr[Nr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nr[Nr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nr[Nr.NOT_FOUND=5]="NOT_FOUND",Nr[Nr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nr[Nr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nr[Nr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nr[Nr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nr[Nr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nr[Nr.ABORTED=10]="ABORTED",Nr[Nr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nr[Nr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nr[Nr.INTERNAL=13]="INTERNAL",Nr[Nr.UNAVAILABLE=14]="UNAVAILABLE",Nr[Nr.DATA_LOSS=15]="DATA_LOSS";var Or=(Cr.prototype.st=function(t,e){return new Cr(this.P,this.root.st(t,e,this.P).copy(null,null,Dr.it,null,null))},Cr.prototype.remove=function(t){return new Cr(this.P,this.root.remove(t,this.P).copy(null,null,Dr.it,null,null))},Cr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Cr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Cr.prototype._=function(){return this.root._()},Object.defineProperty(Cr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Cr.prototype.rt=function(){return this.root.rt()},Cr.prototype.ot=function(){return this.root.ot()},Cr.prototype.ht=function(t){return this.root.ht(t)},Cr.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Cr.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Cr.prototype.at=function(t){return this.root.at(t)},Cr.prototype.ut=function(){return new Lr(this.root,null,this.P,!1)},Cr.prototype.ct=function(t){return new Lr(this.root,t,this.P,!1)},Cr.prototype.lt=function(){return new Lr(this.root,null,this.P,!0)},Cr.prototype._t=function(t){return new Lr(this.root,t,this.P,!0)},Cr),Lr=(Vr.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Vr.prototype.Tt=function(){return 0<this.dt.length},Vr.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Vr),Dr=(Pr.prototype.copy=function(t,e,n,i,r){return new Pr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Pr.prototype._=function(){return!1},Pr.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Pr.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Pr.prototype.min=function(){return this.left._()?this:this.left.min()},Pr.prototype.rt=function(){return this.min().key},Pr.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Pr.prototype.st=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.st(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.st(t,e,n))).It()},Pr.prototype.Rt=function(){if(this.left._())return Pr.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.Rt(),null)).It()},Pr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.At()&&(i=i.Vt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.yt()),0===e(t,i.key)){if(i.right._())return Pr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Rt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.It()},Pr.prototype.At=function(){return this.color},Pr.prototype.It=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Vt()),t.left.At()&&t.right.At()&&(t=t.gt()),t},Pr.prototype.Pt=function(){var t=this.gt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).pt()).gt()),t},Pr.prototype.yt=function(){var t=this.gt();return t.left.left.At()&&(t=(t=t.Vt()).gt()),t},Pr.prototype.pt=function(){var t=this.copy(null,null,Pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pr.prototype.Vt=function(){var t=this.copy(null,null,Pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pr.prototype.gt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pr.prototype.vt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Pr.prototype.bt=function(){if(this.At()&&this.left.At())throw Ci();if(this.right.At())throw Ci();var t=this.left.bt();if(t!==this.right.bt())throw Ci();return t+(this.At()?0:1)},Pr);function Pr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Pr.RED,this.left=null!=i?i:Pr.EMPTY,this.right=null!=r?r:Pr.EMPTY,this.size=this.left.size+1+this.right.size}function Vr(t,e,n,i){this.ft=i,this.dt=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.ft?t.left:t.right;else{if(0===r){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Cr(t,e){this.P=t,this.root=e||Dr.EMPTY}function Ur(){this.size=0}Dr.EMPTY=null,Dr.RED=!0,Dr.it=!1,Dr.EMPTY=(Object.defineProperty(Ur.prototype,"key",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"value",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"color",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"left",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"right",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Ur.prototype.copy=function(t,e,n,i,r){return this},Ur.prototype.st=function(t,e,n){return new Dr(t,e)},Ur.prototype.remove=function(t,e){return this},Ur.prototype._=function(){return!0},Ur.prototype.ht=function(t){return!1},Ur.prototype.at=function(t){return!1},Ur.prototype.rt=function(){return null},Ur.prototype.ot=function(){return null},Ur.prototype.At=function(){return!1},Ur.prototype.vt=function(){return!0},Ur.prototype.bt=function(){return 0},new Ur);var Mr=(Fr.prototype.has=function(t){return null!==this.data.get(t)},Fr.prototype.first=function(){return this.data.rt()},Fr.prototype.last=function(){return this.data.ot()},Object.defineProperty(Fr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fr.prototype.indexOf=function(t){return this.data.indexOf(t)},Fr.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Fr.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var i=n.wt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},Fr.prototype.Ct=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},Fr.prototype.Dt=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},Fr.prototype.ut=function(){return new qr(this.data.ut())},Fr.prototype.ct=function(t){return new qr(this.data.ct(t))},Fr.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},Fr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fr.prototype._=function(){return this.data._()},Fr.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fr.prototype.isEqual=function(t){if(!(t instanceof Fr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(0!==this.P(i,r))return!1}return!0},Fr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fr.prototype.copy=function(t){var e=new Fr(this.P);return e.data=t,e},Fr),qr=(jr.prototype.wt=function(){return this.Nt.wt().key},jr.prototype.Tt=function(){return this.Nt.Tt()},jr),xr=new Or(or.P);function jr(t){this.Nt=t}function Fr(t){this.P=t,this.data=new Or(this.P)}var Gr=new Or(or.P),Br=new Or(or.P),Wr=new Mr(or.P);function zr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Wr,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var $r=new Mr(xi);function Hr(t,e,n,i){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=i}function Xr(t,e){this.targetId=t,this.ne=e}function Qr(t,e,n,i){void 0===n&&(n=Er.J),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Yr=(ho.Ot=function(t){return new ho(t.P)},ho.prototype.has=function(t){return null!=this.$t.get(t)},ho.prototype.get=function(t){return this.$t.get(t)},ho.prototype.first=function(){return this.kt.rt()},ho.prototype.last=function(){return this.kt.ot()},ho.prototype._=function(){return this.kt._()},ho.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.kt.ht(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.st(t.key,t),e.kt.st(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.kt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.ut(),n=t.kt.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(!i.isEqual(r))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.P=this.P,n.$t=t,n.kt=e,n},ho),Kr=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.st(e,t):3===t.type&&1!==n.type?this.xt=this.xt.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):Ci()},ao.prototype.Lt=function(){var n=[];return this.xt.ht(function(t,e){n.push(e)}),n},ao),Zr=(uo.Wt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new uo(t,e,Yr.Ot(e),r,n,i,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ut===t.Ut&&this.qt.isEqual(t.qt)&&fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Mt.isEqual(t.Mt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},uo),Jr=(so.zt=function(t,e){var n=new Map;return n.set(t,to.Ht(t,e)),new so(tr.min(),n,$r,xr,zr())},so),to=(oo.Ht=function(t,e){return new oo(Er.J,e,zr(),zr(),zr())},oo),eo=(Object.defineProperty(ro.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),ro.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},ro.prototype.le=function(){var n=zr(),i=zr(),r=zr();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Ci()}}),new to(this.re,this.oe,n,i,r)},ro.prototype._e=function(){this.he=!1,this.ie=lo()},ro.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},ro.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},ro.prototype.we=function(){this.se+=1},ro.prototype.me=function(){--this.se},ro.prototype.Te=function(){this.he=!0,this.oe=!0},ro),no=(io.prototype.Ve=function(t){for(var e=0,n=t.te;e<n.length;e++){var i=n[e];t.ee instanceof Ys?this.ye(i,t.ee):t.ee instanceof Ks&&this.pe(i,t.key,t.ee)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.ee)}},io.prototype.ge=function(n){var i=this;this.ve(n,function(t){var e=i.be(t);switch(n.state){case 0:i.Se(t)&&e.ce(n.resumeToken);break;case 1:e.me(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.me(),e.ae||i.removeTarget(t);break;case 3:i.Se(t)&&(e.Te(),e.ce(n.resumeToken));break;case 4:i.Se(t)&&(i.Ce(t),e.ce(n.resumeToken));break;default:Ci()}})},io.prototype.ve=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){i.Se(e)&&n(e)})},io.prototype.De=function(t){var e,n,i=t.targetId,r=t.ne.count,o=this.Fe(i);o&&(br(e=o.target)?0===r?(n=new or(e.path),this.pe(i,n,new Ks(n,tr.min()))):Ui(1===r):this.Ne(i)!==r&&(this.Ce(i),this.Pe=this.Pe.add(i)))},io.prototype.$e=function(r){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,i=o.Fe(e);i&&(t.Yt&&br(i.target)&&(n=new or(i.target.path),null!==o.Re.get(n)||o.ke(e,n)||o.pe(e,n,new Ks(n,r))),t.ue&&(s.set(e,t.le()),t._e()))});var i=zr();this.Ae.forEach(function(t,e){var n=!0;e.Ct(function(t){var e=o.Fe(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Jr(r,s,this.Pe,this.Re,i);return this.Re=xr,this.Ae=co(),this.Pe=new Mr(xi),t},io.prototype.ye=function(t,e){var n;this.Se(t)&&(n=this.ke(t,e.key)?2:0,this.be(t).fe(e.key,n),this.Re=this.Re.st(e.key,e),this.Ae=this.Ae.st(e.key,this.Oe(e.key).add(t)))},io.prototype.pe=function(t,e,n){var i;this.Se(t)&&(i=this.be(t),this.ke(t,e)?i.fe(e,1):i.de(e),this.Ae=this.Ae.st(e,this.Oe(e).delete(t)),n&&(this.Re=this.Re.st(e,n)))},io.prototype.removeTarget=function(t){this.Ie.delete(t)},io.prototype.Ne=function(t){var e=this.be(t).le();return this.Ee.xe(t).size+e.Jt.size-e.Zt.size},io.prototype.we=function(t){this.be(t).we()},io.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new eo,this.Ie.set(t,e)),e},io.prototype.Oe=function(t){var e=this.Ae.get(t);return e||(e=new Mr(xi),this.Ae=this.Ae.st(t,e)),e},io.prototype.Se=function(t){var e=null!==this.Fe(t);return e||Li("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Fe=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.Ee.Le(t)},io.prototype.Ce=function(e){var n=this;this.Ie.set(e,new eo),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},io.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},io);function io(t){this.Ee=t,this.Ie=new Map,this.Re=xr,this.Ae=co(),this.Pe=new Mr(xi)}function ro(){this.se=0,this.ie=lo(),this.re=Er.J,this.oe=!1,this.he=!0}function oo(t,e,n,i,r){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=i,this.Zt=r}function so(t,e,n,i,r){this.Z=t,this.Qt=e,this.jt=n,this.Gt=i,this.Kt=r}function uo(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Mt=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Ut=s,this.Bt=u}function ao(){this.xt=new Or(or.P)}function ho(n){this.P=n?function(t,e){return n(t,e)||or.P(t.key,e.key)}:function(t,e){return or.P(t.key,e.key)},this.$t=Gr,this.kt=new Or(this.P)}function co(){return new Or(or.P)}function lo(){return new Or(or.P)}function fo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function po(t){var e=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new Ji(e.seconds,e.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:Ci()}function go(i,r){var t,e,n,o=vo(i);if(o!==vo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return po(i).isEqual(po(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Io(i.timestampValue),n=Io(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,To(i.bytesValue).isEqual(To(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Ao((t=i).geoPointValue.latitude)===Ao(e.geoPointValue.latitude)&&Ao(t.geoPointValue.longitude)===Ao(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ao(t.integerValue)===Ao(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ao(t.doubleValue),i=Ao(e.doubleValue);return n===i?yr(n)===yr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return ji(i.arrayValue.values||[],r.arrayValue.values||[],go);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Wi(t)!==Wi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!go(t[n],e[n])))return!1;return!0}();default:return Ci()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,i,r,o,s,u,a,h,c,l,f=vo(t),p=vo(e);if(f!==p)return xi(f,p);switch(f){case 0:return 0;case 1:return xi(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Ao(t.integerValue||t.doubleValue))<(l=Ao(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return xi(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=xi(n[r],i[r]);if(0!==o)return o}return xi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=xi(Ao(n.latitude),Ao(i.latitude)))?r:xi(Ao(n.longitude),Ao(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=wo(n[r],i[r]);if(o)return o}return xi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=xi(i[s],o[s]);if(0!==u)return u;var a=wo(n[i[s]],r[o[s]]);if(0!==a)return a}return xi(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Ci()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xi(t,e);var n=Io(t),i=Io(e),r=xi(n.seconds,i.seconds);return 0!==r?r:xi(n.nanos,i.nanos)}function Eo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Io(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?To(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,or.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Ci();var t,e,n}(t)}function Io(t){if(Ui(!!t),"string"!=typeof t)return{seconds:Ao(t.seconds),nanos:Ao(t.nanos)};var e,n=0,i=yo.exec(t);Ui(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Ao(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?Er.fromBase64String(t):Er.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function Ro(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var Lo={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Me=e};function Vo(t){return{integerValue:""+t}}function Co(t,e){if(t.Me){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yr(e)?"-0":e}}function Uo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!yr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Vo(e):Co(t,e);var n}function Mo(t,e){return t.Me?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.Me?e.toBase64():e.toUint8Array()}function xo(t){return Ui(!!t),tr.T((e=Io(t),new Ji(e.seconds,e.nanos)));var e}function jo(t,e){return new nr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Fo(t,e){return jo(t.s,e.path)}function Go(t,e){var n,i,r=(Ui(Qo(i=nr.$(e))),i);return Ui(r.get(1)===t.s.projectId),Ui(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new or((Ui(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Bo(t,e){return jo(t.s,e)}function Wo(t){return new nr(["projects",t.s.projectId,"databases",t.s.database]).N()}function zo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function $o(t,e){var n,i,r,o;if(e instanceof ks)n={update:zo(t,e.key,e.value)};else if(e instanceof qs)n={delete:Fo(t,e.key)};else if(e instanceof Ss)n={update:zo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Ps)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ts)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof es)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ss)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof cs)return{fieldPath:t.field.N(),increment:e.Ue};throw Ci()})}};else{if(!(e instanceof xs))return Ci();n={verify:Fo(t,e.key)}}return e.We.Be||(n.currentDocument=void 0!==(o=e.We).updateTime?{updateTime:Mo(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Ci()),n}function Ho(t){return{before:t.before,values:t.position}}function Xo(t){return{fieldPath:t.N()}}function Qo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Yo(){this.Qe=void 0}function Ko(t,e){return t instanceof cs?Ro(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Zo,Jo,ts=(o(is,Jo=Yo),is),es=(o(ns,Zo=Yo),ns);function ns(t){var e=this;return(e=Zo.call(this)||this).elements=t,e}function is(){return null!==Jo&&Jo.apply(this,arguments)||this}function rs(t,e){for(var n=ps(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var os,ss=(o(us,os=Yo),us);function us(t){var e=this;return(e=os.call(this)||this).elements=t,e}function as(t,e){for(var n=ps(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!go(t,e)})}(r[i]);return{arrayValue:{values:n}}}var hs,cs=(o(ls,hs=Yo),ls);function ls(t,e){var n=this;return(n=hs.call(this)||this).serializer=t,n.Ue=e,n}function fs(t){return Ao(t.integerValue||t.doubleValue)}function ps(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ds(t,e){this.field=t,this.transform=e}var ys=(vs.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},vs.prototype.isEqual=function(t){return ji(this.fields,t.fields,function(t,e){return t.isEqual(e)})},vs);function vs(t){(this.fields=t).sort(rr.P)}function gs(t,e){this.version=t,this.transformResults=e}var ms=(ws.Ge=function(){return new ws},ws.exists=function(t){return new ws(void 0,t)},ws.updateTime=function(t){return new ws(t)},Object.defineProperty(ws.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ws.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ws);function ws(t,e){this.updateTime=t,this.exists=e}function bs(t,e){return void 0!==t.updateTime?e instanceof Ys&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ys}function Es(){}function Is(t,e,n,i){return t instanceof ks?function(t,e){if(!bs(t.We,e))return e;var n=Ts(e);return new Ys(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Ss?function(t,e){if(!bs(t.We,e))return e;var n=Ts(e),i=Ls(t,e);return new Ys(t.key,n,i,{Ke:!0})}(t,e):t instanceof Ps?function(t,e,n,i){if(!bs(t.We,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Ys&&(y=n.field(p.field)),null===y&&i instanceof Ys&&(y=i.field(p.field)),c.push((o=y,h=a=u=s=void 0,(r=d)instanceof ts?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):r instanceof es?rs(r,o):r instanceof ss?as(r,o):(a=fs(u=Ko(s=r,o))+fs(s.Ue),Ro(u)&&Ro(s.Ue)?Vo(a):Co(s.serializer,a))))}return c}(t.fieldTransforms,n,e,i),s=Cs(t,r.data(),o);return new Ys(t.key,r.version,s,{Ke:!0})}(t,e,i,n):(o=e,bs((r=t).We,o)?new Ks(r.key,tr.min()):o);var r,o}function As(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.We.isEqual(e.We)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||ji(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof es&&o instanceof es||r instanceof ss&&o instanceof ss?ji(r.elements,o.elements,go):r instanceof cs&&o instanceof cs?go(r.Ue,o.Ue):r instanceof ts&&o instanceof ts);var n,i,r,o}))}function Ts(t){return t instanceof Ys?t.version:tr.min()}var Ns,Rs,ks=(o(Os,Rs=Es),Os),Ss=(o(_s,Ns=Es),_s);function _s(t,e,n,i){var r=this;return(r=Ns.call(this)||this).key=t,r.data=e,r.qe=n,r.We=i,r.type=1,r}function Os(t,e,n){var i=this;return(i=Rs.call(this)||this).key=t,i.value=e,i.We=n,i.type=0,i}function Ls(t,e){return n=t,i=e instanceof Ys?e.data():js.empty(),r=new Fs(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Ds,Ps=(o(Vs,Ds=Es),Vs);function Vs(t,e){var n=this;return(n=Ds.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.We=ms.exists(!0),n}function Cs(t,e,n){for(var i=new Fs(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Us,Ms,qs=(o(zs,Ms=Es),zs),xs=(o(Ws,Us=Es),Ws),js=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Bs.prototype.isEqual=function(t){return go(this.proto,t.proto)},Bs),Fs=(Gs.prototype.set=function(t,e){return this.Je(t,e),this},Gs.prototype.delete=function(t){return this.Je(t,null),this},Gs.prototype.Je=function(t,e){for(var n=this.Ye,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},Gs.prototype.ze=function(){var t=this.Xe(rr.k(),this.Ye);return null!=t?new js(t):this.He},Gs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.He.field(i),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Gs);function Gs(t){void 0===t&&(t=js.empty()),this.He=t,this.Ye=new Map}function Bs(t){this.proto=t}function Ws(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.We=e,n.type=4,n}function zs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.We=e,n.type=3,n}function $s(t,e){this.key=t,this.version=e}var Hs,Xs,Qs,Ys=(o(eu,Qs=$s),eu.prototype.field=function(t){return this.Ze.field(t)},eu.prototype.data=function(){return this.Ze},eu.prototype.tn=function(){return this.Ze.proto},eu.prototype.isEqual=function(t){return t instanceof eu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},eu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),eu),Ks=(o(tu,Xs=$s),tu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu.prototype.isEqual=function(t){return t instanceof tu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},tu),Zs=(o(Js,Hs=$s),Js.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js);function Js(){return null!==Hs&&Hs.apply(this,arguments)||this}function tu(t,e,n){var i=this;return(i=Xs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function eu(t,e,n,i){var r=this;return(r=Qs.call(this,t,e)||this).Ze=n,r.Ke=!!i.Ke,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function nu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Zi(Ki.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Zi(Ki.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var iu=(ru.prototype.on=function(t){return new ru(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},ru.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.L())},ru.prototype.an=function(){return!dr(this.limit)&&"F"===this.nn},ru.prototype.un=function(){return!dr(this.limit)&&"L"===this.nn},ru.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},ru.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},ru.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},ru);function ru(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=i,this.limit=r,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function ou(t){return new iu(t)}function su(t){return null!==t.collectionGroup}function uu(t){var e=nu(t,iu);if(null===e.sn){e.sn=[];var n=e.ln(),i=e.cn();if(null!==n&&null===i)n.L()||e.sn.push(new $u(n)),e.sn.push(new $u(rr.M(),"asc"));else{for(var r,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.L()&&(o=!0)}o||(r=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new $u(rr.M(),r)))}}return e.sn}function au(t){var e=nu(t,iu);if(!e.rn)if("F"===e.nn)e.rn=gr(e.path,e.collectionGroup,uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=uu(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new $u(o.field,s))}var u=e.endAt?new qu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new qu(e.startAt.position,!e.startAt.before):null;e.rn=gr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function hu(t,e,n){return new iu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cu(t,e){return new iu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function lu(t,e){return new iu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function fu(t,e){return wr(au(t),au(e))&&t.nn===e.nn}function pu(t){return mr(au(t))+"|lt:"+t.nn}function du(t){return"Query(target="+(n=(e=au(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+Eo(e.value);var e}).join(", ")+"]"),dr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Bu(e.startAt)),e.endAt&&(n+=", endAt: "+Bu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function yu(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.W(i.collectionGroup)&&i.path.C(o):or.j(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.en;e<n.length;e++){var i=n[e];if(!i.field.L()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Wu(e.startAt,uu(e),n))&&(!e.endAt||!Wu(e.endAt,uu(e),n)));var e,n,i,o}function vu(u){return function(t,e){for(var n=!1,i=0,r=uu(u);i<r.length;i++){var o=r[i],s=function(t,e,n){var i,r,o,s,u=t.field.L()?or.P(e.key,n.key):(i=t.field,r=n,o=e.field(i),s=r.field(i),null!==o&&null!==s?wo(o,s):Ci());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Ci()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var gu,mu=(o(wu,gu=function(){}),wu.create=function(t,e,n){if(t.L())return"in"===e||"not-in"===e?this.dn(t,e,n):new Au(t,e,n);if(So(n)){if("=="!==e&&"!="!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new wu(t,e,n)}if(_o(n)){if("=="!==e&&"!="!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new wu(t,e,n)}return"array-contains"===e?new Vu(t,n):"in"===e?new Cu(t,n):"not-in"===e?new Uu(t,n):"array-contains-any"===e?new Mu(t,n):new wu(t,e,n)},wu.dn=function(t,e,n){return new("in"===e?Tu:Nu)(t,n)},wu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(wo(e,this.value)):null!==e&&vo(this.value)===vo(e)&&this.wn(wo(e,this.value))},wu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ci()}},wu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},wu);function wu(t,e,n){var i=this;return(i=gu.call(this)||this).field=t,i.op=e,i.value=n,i}var bu,Eu,Iu,Au=(o(Su,Iu=mu),Su.prototype.matches=function(t){var e=or.P(t.key,this.key);return this.wn(e)},Su),Tu=(o(ku,Eu=mu),ku.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ku),Nu=(o(Ru,bu=mu),Ru.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ru);function Ru(t,e){var n=this;return(n=bu.call(this,t,"not-in",e)||this).keys=_u(0,e),n}function ku(t,e){var n=this;return(n=Eu.call(this,t,"in",e)||this).keys=_u(0,e),n}function Su(t,e,n){var i=this;return(i=Iu.call(this,t,e,n)||this).key=or.B(n.referenceValue),i}function _u(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return or.B(t.referenceValue)})}var Ou,Lu,Du,Pu,Vu=(o(Gu,Pu=mu),Gu.prototype.matches=function(t){var e=t.field(this.field);return ko(e)&&mo(e.arrayValue,this.value)},Gu),Cu=(o(Fu,Du=mu),Fu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&mo(this.value.arrayValue,e)},Fu),Uu=(o(ju,Lu=mu),ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!mo(this.value.arrayValue,e)},ju),Mu=(o(xu,Ou=mu),xu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},xu),qu=function(t,e){this.position=t,this.before=e};function xu(t,e){return Ou.call(this,t,"array-contains-any",e)||this}function ju(t,e){return Lu.call(this,t,"not-in",e)||this}function Fu(t,e){return Du.call(this,t,"in",e)||this}function Gu(t,e){return Pu.call(this,t,"array-contains",e)||this}function Bu(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function Wu(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.L()?or.P(or.B(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function zu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var $u=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Hu=(ra.prototype.Tn=function(t,e,n){for(var i,r,o,s=n.En,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(i=a,r=e,o=s[u],e=i instanceof ks?new Ys(i.key,o.version,i.value,{hasCommittedMutations:!0}):i instanceof Ss?function(t,e,n){if(!bs(t.We,e))return new Zs(t.key,n.version);var i=Ls(t,e);return new Ys(t.key,n.version,i,{hasCommittedMutations:!0})}(i,r,o):i instanceof Ps?function(t,e,n){if(Ui(null!=n.transformResults),!bs(t.We,e))return new Zs(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Ui(t.length===n.length);for(var r,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Ys&&(c=e.field(a.field)),i.push((r=h,o=c,s=n[u],r instanceof es?rs(r,o):r instanceof ss?as(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Cs(t,i.data(),r);return new Ys(t.key,o,s,{hasCommittedMutations:!0})}(i,r,o):new Ks(i.key,o.version,{hasCommittedMutations:!0}))}return e},ra.prototype.In=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=Is(r,e,e,this.mn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Is(a,e,o,this.mn))}return e},ra.prototype.Rn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.In(t.key,n.get(t.key));e&&(r=r.st(t.key,e))}),r},ra.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zr())},ra.prototype.isEqual=function(t){return this.batchId===t.batchId&&ji(this.mutations,t.mutations,As)&&ji(this.baseMutations,t.baseMutations,As)},ra),Xu=(ia.from=function(t,e,n){Ui(t.mutations.length===n.length);for(var i=Br,r=t.mutations,o=0;o<r.length;o++)i=i.st(r[o].key,n[o].version);return new ia(t,e,n,i)},ia),Qu=(na.prototype.catch=function(t){return this.next(void 0,t)},na.prototype.next=function(i,r){var o=this;return this.gn&&Ci(),this.gn=!0,this.pn?this.error?this.vn(r,this.error):this.bn(i,this.result):new na(function(e,n){o.Vn=function(t){o.bn(i,t).next(e,n)},o.yn=function(t){o.vn(r,t).next(e,n)}})},na.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},na.prototype.Cn=function(t){try{var e=t();return e instanceof na?e:na.resolve(e)}catch(t){return na.reject(t)}},na.prototype.bn=function(t,e){return t?this.Cn(function(){return t(e)}):na.resolve(e)},na.prototype.vn=function(t,e){return t?this.Cn(function(){return t(e)}):na.reject(e)},na.resolve=function(n){return new na(function(t,e){t(n)})},na.reject=function(n){return new na(function(t,e){e(n)})},na.Dn=function(t){return new na(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},na.Fn=function(t){for(var n=na.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?na.resolve(t):e()})}(i[e]);return n},na.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Dn(r)},na),Yu=(ea.prototype.On=function(e,n){var i=this;return this.$n.xn(e,n).next(function(t){return i.Ln(e,n,t)})},ea.prototype.Ln=function(t,i,r){return this.Nn.Mn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].In(i,t);return t})},ea.prototype.qn=function(t,e,r){var o=xr;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].In(t,e);o=o.st(t,e)}),o},ea.prototype.Un=function(e,t){var n=this;return this.Nn.getEntries(e,t).next(function(t){return n.Bn(e,t)})},ea.prototype.Bn=function(i,r){var o=this;return this.$n.Wn(i,r).next(function(t){var e=o.qn(i,r,t),n=xr;return e.forEach(function(t,e){e=e||new Ks(t,tr.min()),n=n.st(t,e)}),n})},ea.prototype.Qn=function(t,e,n){return i=e,or.j(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.jn(t,e.path):su(e)?this.Gn(t,e,n):this.Kn(t,e,n);var i},ea.prototype.jn=function(t,e){return this.On(t,new or(e)).next(function(t){var e=Gr;return t instanceof Ys&&(e=e.st(t.key,t)),e})},ea.prototype.Gn=function(n,i,r){var o=this,s=i.collectionGroup,u=Gr;return this.kn.zn(n,s).next(function(t){return Qu.forEach(t,function(t){var e=i.on(t.child(s));return o.Kn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ea.prototype.Kn=function(e,n,t){var c,l,i=this;return this.Nn.Qn(e,n,t).next(function(t){return c=t,i.$n.Hn(e,n)}).next(function(t){return l=t,i.Yn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=Is(s,a,a,i.mn);c=h instanceof Ys?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){yu(n,e)||(c=c.remove(t))}),c})},ea.prototype.Yn=function(t,e,n){for(var i=zr(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Ss&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Nn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ys&&(h=h.st(t,e))}),h})},ea),Ku=(ta.Zn=function(t,e){for(var n=zr(),i=zr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new ta(t,e.fromCache,n,i)},ta),Zu=(Ju.prototype.es=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ju.prototype.next=function(){var t=++this.previousValue;return this.ns&&this.ns(t),t},Ju);function Ju(t,e){var n=this;this.previousValue=t,e&&(e.ts=function(t){return n.es(t)},this.ns=function(t){return e.ss(t)})}function ta(t,e,n,i){this.targetId=t,this.fromCache=e,this.Jn=n,this.Xn=i}function ea(t,e,n){this.Nn=t,this.$n=e,this.kn=n}function na(t){var e=this;this.Vn=null,this.yn=null,this.result=void 0,this.error=void 0,this.pn=!1,this.gn=!1,t(function(t){e.pn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.pn=!0,e.error=t,e.yn&&e.yn(t)})}function ia(t,e,n,i){this.batch=t,this.An=e,this.En=n,this.Pn=i}function ra(t,e,n,i){this.batchId=t,this.mn=e,this.baseMutations=n,this.mutations=i}function oa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Zu.rs=-1;var sa=(ua.prototype.reset=function(){this.ls=0},ua.prototype.ds=function(){this.ls=this.cs},ua.prototype.ws=function(t){var e=this;this.cancel();var n=Math.floor(this.ls+this.ms()),i=Math.max(0,Date.now()-this.fs),r=Math.max(0,n-i);0<r&&Li("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.ls+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this._s=this.os.Ts(this.hs,r,function(){return e.fs=Date.now(),t()}),this.ls*=this.us,this.ls<this.as&&(this.ls=this.as),this.ls>this.cs&&(this.ls=this.cs)},ua.prototype.Es=function(){null!==this._s&&(this._s.Is(),this._s=null)},ua.prototype.cancel=function(){null!==this._s&&(this._s.cancel(),this._s=null)},ua.prototype.ms=function(){return(Math.random()-.5)*this.ls},ua);function ua(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.os=t,this.hs=e,this.as=n,this.us=i,this.cs=r,this.ls=0,this._s=null,this.fs=Date.now(),this.reset()}function aa(t){return"IndexedDbTransactionError"===t.name}function ha(){return"undefined"!=typeof document?document:null}var ca=(pa.ys=function(t,e,n,i,r){var o=new pa(t,e,Date.now()+n,i,r);return o.start(n),o},pa.prototype.start=function(t){var e=this;this.ps=setTimeout(function(){return e.gs()},t)},pa.prototype.Is=function(){return this.gs()},pa.prototype.cancel=function(t){null!==this.ps&&(this.clearTimeout(),this.Vs.reject(new Zi(Ki.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},pa.prototype.gs=function(){var e=this;this.Rs.vs(function(){return null!==e.ps?(e.clearTimeout(),e.op().then(function(t){return e.Vs.resolve(t)})):Promise.resolve()})},pa.prototype.clearTimeout=function(){null!==this.ps&&(this.Ps(this),clearTimeout(this.ps),this.ps=null)},pa),la=(Object.defineProperty(fa.prototype,"xs",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),fa.prototype.vs=function(t){this.enqueue(t)},fa.prototype.Ls=function(t){this.Ms(),this.qs(t)},fa.prototype.Us=function(){var t;this.Cs||(this.Cs=!0,(t=ha())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Os))},fa.prototype.enqueue=function(t){return this.Ms(),this.Cs?new Promise(function(t){}):this.qs(t)},fa.prototype.Bs=function(t){var e=this;this.Ss.push(t),this.vs(function(){return e.Ws()})},fa.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Ss.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ss[0]()];case 2:return t.sent(),this.Ss.shift(),this.ks.reset(),[3,4];case 3:if(!aa(e=t.sent()))throw e;return Li("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ss.length&&this.ks.ws(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},fa.prototype.qs=function(t){var i=this,e=this.bs.then(function(){return i.Ns=!0,t().catch(function(t){throw i.Fs=t,i.Ns=!1,Di("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Ns=!1,t})});return this.bs=e},fa.prototype.Ts=function(t,e,n){var i=this;this.Ms(),-1<this.$s.indexOf(t)&&(e=0);var r=ca.ys(this,t,e,n,function(t){return i.Qs(t)});return this.Ds.push(r),r},fa.prototype.Ms=function(){this.Fs&&Ci()},fa.prototype.js=function(){},fa.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.bs];case 1:t.sent(),t.label=2;case 2:if(e!==this.bs)return[3,0];t.label=3;case 3:return[2]}})})},fa.prototype.Ks=function(t){for(var e=0,n=this.Ds;e<n.length;e++)if(n[e].hs===t)return!0;return!1},fa.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Ds.sort(function(t,e){return t.As-e.As});for(var t=0,e=r.Ds;t<e.length;t++){var n=e[t];if(n.Is(),"all"!==i&&n.hs===i)break}return r.Gs()})},fa.prototype.Hs=function(t){this.$s.push(t)},fa.prototype.Qs=function(t){var e=this.Ds.indexOf(t);this.Ds.splice(e,1)},fa);function fa(){var e=this;this.bs=Promise.resolve(),this.Ss=[],this.Cs=!1,this.Ds=[],this.Fs=null,this.Ns=!1,this.$s=[],this.ks=new sa(this,"async_queue_retry"),this.Os=function(){var t=ha();t&&Li("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ks.Es()};var t=ha();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Os)}function pa(t,e,n,i,r){this.Rs=t,this.hs=e,this.As=n,this.op=i,this.Ps=r,this.Vs=new oa,this.then=this.Vs.promise.then.bind(this.Vs.promise),this.Vs.promise.catch(function(t){})}function da(t,e){if(Di("AsyncQueue",e+": "+t),aa(t))return new Zi(Ki.UNAVAILABLE,e+": "+t);throw t}var ya=(va.Zs=function(t){return new va(t,va.ti,va.ei)},va);function va(t,e,n){this.Ys=t,this.Js=e,this.Xs=n}ya.ni=-1,ya.si=1048576,ya.ii=41943040,ya.ti=10,ya.ei=1e3,ya.ri=new ya(ya.ii,ya.ti,ya.ei),ya.oi=new ya(ya.ni,0,0);var ga=(Ta.prototype.ai=function(t,e){return this.hi.add(e),Qu.resolve()},Ta.prototype.zn=function(t,e){return Qu.resolve(this.hi.getEntries(e))},Ta),ma=(Aa.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Mr(nr.P),r=!i.has(n);return this.index[e]=i.add(n),r},Aa.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Aa.prototype.getEntries=function(t){return(this.index[t]||new Mr(nr.P)).F()},Aa),wa=(Ia.prototype.next=function(){return this.ui+=2,this.ui},Ia.ci=function(){return new Ia(0)},Ia.li=function(){return new Ia(-1)},Ia),ba=(Ea.prototype.yi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pi(t,n.fi)})},Ea);function Ea(t,e,n){this.persistence=t,this._i=e,this.fi=new Or(xi),this.di=new Yi(mr,wr),this.wi=tr.min(),this.$n=t.mi(n),this.Ti=t.Ei(),this.Ii=t.Ri(),this.Ai=new Yu(this.Ti,this.$n,this.persistence.Pi()),this._i.Vi(this.Ai)}function Ia(t){this.ui=t}function Aa(){this.index={}}function Ta(){this.hi=new ma}function Na(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Di(t)})}function Ra(o,s,u){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:n=(e=o).fi.get(s),i=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",i,function(t){return e.persistence.Li.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!aa(r=t.sent()))throw r;return Li("LocalStore","Failed to update sequence numbers for target "+s+": "+r),[3,5];case 5:return e.fi=e.fi.remove(s),e.di.delete(n.target),[2]}})})}function ka(t,s,u){var a=t,h=tr.min(),c=zr();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,i=au(s),(void 0!==(o=(r=t).di.get(i))?Qu.resolve(r.fi.get(o)):r.Ii.Ui(n,i)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Ii.Bi(e,t.targetId).next(function(t){c=t})}).next(function(){return a._i.Qn(e,s,u?h:tr.min(),u?c:zr())}).next(function(t){return{documents:t,Wi:c}});var t,n,i,r,o})}function Sa(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Ki.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Li("LocalStore","Unexpectedly lost primary lease"),[2]})})}var _a=(Va.prototype._=function(){return this.Qi._()},Va.prototype.zi=function(t,e){var n=new Oa(t,e);this.Qi=this.Qi.add(n),this.Gi=this.Gi.add(n)},Va.prototype.Hi=function(t,e){var n=this;t.forEach(function(t){return n.zi(t,e)})},Va.prototype.Yi=function(t,e){this.Ji(new Oa(t,e))},Va.prototype.Xi=function(t,e){var n=this;t.forEach(function(t){return n.Yi(t,e)})},Va.prototype.Zi=function(t){var e=this,n=new or(new nr([])),i=new Oa(n,t),r=new Oa(n,t+1),o=[];return this.Gi.St([i,r],function(t){e.Ji(t),o.push(t.key)}),o},Va.prototype.tr=function(){var e=this;this.Qi.forEach(function(t){return e.Ji(t)})},Va.prototype.Ji=function(t){this.Qi=this.Qi.delete(t),this.Gi=this.Gi.delete(t)},Va.prototype.er=function(t){var e=new or(new nr([])),n=new Oa(e,t),i=new Oa(e,t+1),r=zr();return this.Gi.St([n,i],function(t){r=r.add(t.key)}),r},Va.prototype.nr=function(t){var e=new Oa(t,0),n=this.Qi.Dt(e);return null!==n&&t.isEqual(n.key)},Va),Oa=(Pa.ji=function(t,e){return or.P(t.key,e.key)||xi(t.sr,e.sr)},Pa.Ki=function(t,e){return xi(t.sr,e.sr)||or.P(t.key,e.key)},Pa),La=(Da.prototype.ir=function(){return null!=this.uid},Da.prototype.rr=function(){return this.ir()?"uid:"+this.uid:"anonymous-user"},Da.prototype.isEqual=function(t){return t.uid===this.uid},Da);function Da(t){this.uid=t}function Pa(t,e){this.key=t,this.sr=e}function Va(){this.Qi=new Mr(Oa.ji),this.Gi=new Mr(Oa.Ki)}function Ca(t,e){this.user=e,this.type="OAuth",this.ar={},this.ar.Authorization="Bearer "+t}function Ua(t){this.key=t}function Ma(t){this.key=t}function qa(t,e,n){this.query=t,this.targetId=e,this.view=n}function xa(t){this.key=t,this.Lh=!1}function ja(){this.va=void 0,this.listeners=[]}La.UNAUTHENTICATED=new La(null),La.or=new La("google-credentials-uid"),La.hr=new La("first-party-uid");var Fa,Ga,Ba,Wa,za=(Sh.prototype.getToken=function(){return Promise.resolve(null)},Sh.prototype.cr=function(){},Sh.prototype.lr=function(t){(this.ur=t)(La.UNAUTHENTICATED)},Sh.prototype._r=function(){this.ur=null},Sh),$a=(kh.prototype.getToken=function(){var e=this,n=this.mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.mr!==n?(Li("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ui("string"==typeof t.accessToken),new Ca(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},kh.prototype.cr=function(){this.forceRefresh=!0},kh.prototype.lr=function(t){this.ur=t,this.wr&&t(this.currentUser)},kh.prototype._r=function(){this.auth&&this.auth.removeAuthTokenListener(this.dr),this.dr=null,this.ur=null},kh.prototype.Tr=function(){var t=this.auth&&this.auth.getUid();return Ui(null===t||"string"==typeof t),new La(t)},kh),Ha=(Object.defineProperty(Rh.prototype,"ar",{get:function(){var t={"X-Goog-AuthUser":this.Ir},e=this.Er.auth.Rr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Rh),Xa=(Nh.prototype.getToken=function(){return Promise.resolve(new Ha(this.Er,this.Ir))},Nh.prototype.lr=function(t){t(La.hr)},Nh.prototype._r=function(){},Nh.prototype.cr=function(){},Nh),Qa=(Th.prototype.gr=function(){return 1===this.state||2===this.state||4===this.state},Th.prototype.vr=function(){return 2===this.state},Th.prototype.start=function(){3!==this.state?this.auth():this.br()},Th.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Th.prototype.Sr=function(){this.state=0,this.ks.reset()},Th.prototype.Cr=function(){var t=this;this.vr()&&null===this.pr&&(this.pr=this.os.Ts(this.Ar,6e4,function(){return t.Dr()}))},Th.prototype.Fr=function(t){this.Nr(),this.stream.send(t)},Th.prototype.Dr=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.vr()?[2,this.close(0)]:[2]})})},Th.prototype.Nr=function(){this.pr&&(this.pr.cancel(),this.pr=null)},Th.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Nr(),this.ks.cancel(),this.yr++,3!==e?this.ks.reset():n&&n.code===Ki.RESOURCE_EXHAUSTED?(Di(n.toString()),Di("Using maximum backoff delay to prevent overloading the backend."),this.ks.ds()):n&&n.code===Ki.UNAUTHENTICATED&&this.Vr.cr(),null!==this.stream&&(this.$r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.kr(n)];case 1:return t.sent(),[2]}})})},Th.prototype.$r=function(){},Th.prototype.auth=function(){var n=this;this.state=1;var t=this.Or(this.yr),e=this.yr;this.Vr.getToken().then(function(t){n.yr===e&&n.xr(t)},function(e){t(function(){var t=new Zi(Ki.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Lr(t)})})},Th.prototype.xr=function(t){var e=this,n=this.Or(this.yr);this.stream=this.Mr(t),this.stream.qr(function(){n(function(){return e.state=2,e.listener.qr()})}),this.stream.kr(function(t){n(function(){return e.Lr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Th.prototype.br=function(){var t=this;this.state=4,this.ks.ws(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Th.prototype.Lr=function(t){return Li("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Th.prototype.Or=function(e){var n=this;return function(t){n.os.vs(function(){return n.yr===e?t():(Li("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Th),Ya=(o(Ah,Ba=Qa),Ah.prototype.Mr=function(t){return this.Pr.Ur("Listen",t)},Ah.prototype.onMessage=function(t){this.ks.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ci(),u=e.targetChange.targetIds||[],a=(r=e.targetChange.resumeToken,t.Me?(Ui(void 0===r||"string"==typeof r),Er.fromBase64String(r||"")):(Ui(void 0===r||r instanceof Uint8Array),Er.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=new Qr(s,u,a,h&&(i=void 0===(n=h).code?Ki.UNKNOWN:_r(n.code),new Zi(i,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Go(t,l.document.name),p=xo(l.document.updateTime),d=new js({mapValue:{fields:l.document.fields}}),y=new Ys(f,p,d,{}),c=new Hr(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Go(t,v.document),m=v.readTime?xo(v.readTime):tr.min(),w=new Ks(g,m);c=new Hr([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Go(t,b.document);c=new Hr([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Ci();e.filter;var I=e.filter;I.targetId;var A=new Ar(I.count||0);c=new Xr(I.targetId,A)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return tr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?tr.min():xo(e.readTime)}(t);return this.listener.Br(e,n)},Ah.prototype.Wr=function(t){var e,n,i,r,o={};o.database=Wo(this.serializer),o.addTarget=(e=this.serializer,(i=br(r=(n=t).target)?{documents:{documents:[Bo(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Bo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_o(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,Do[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo((e=t).field),direction:(n=e.dir,Lo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Me||dr(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ho(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ho(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.Y()&&(i.resumeToken=qo(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ci()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Fr(o)},Ah.prototype.Qr=function(t){var e={};e.database=Wo(this.serializer),e.removeTarget=t,this.Fr(e)},Ah),Ka=(o(Ih,Ga=Qa),Object.defineProperty(Ih.prototype,"Gr",{get:function(){return this.jr},enumerable:!1,configurable:!0}),Ih.prototype.start=function(){this.jr=!1,this.lastStreamToken=void 0,Ga.prototype.start.call(this)},Ih.prototype.$r=function(){this.jr&&this.Kr([])},Ih.prototype.Mr=function(t){return this.Pr.Ur("Write",t)},Ih.prototype.onMessage=function(t){if(Ui(!!t.streamToken),this.lastStreamToken=t.streamToken,this.jr){this.ks.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Ui(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(tr.min())&&(n=xo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new gs(n,i)}(t,r)})):[]),n=xo(t.commitTime);return this.listener.zr(n,e)}var i,r;return Ui(!t.writeResults||0===t.writeResults.length),this.jr=!0,this.listener.Hr()},Ih.prototype.Yr=function(){var t={};t.database=Wo(this.serializer),this.Fr(t)},Ih.prototype.Kr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return $o(e.serializer,t)})};this.Fr(n)},Ih),Za=(o(Eh,Fa=function(){}),Eh.prototype.Xr=function(){if(this.Jr)throw new Zi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")},Eh.prototype.Zr=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.Zr(e,n,i,t)}).catch(function(t){throw t.code===Ki.UNAUTHENTICATED&&r.credentials.cr(),t})},Eh.prototype.to=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.to(e,n,i,t)}).catch(function(t){throw t.code===Ki.UNAUTHENTICATED&&r.credentials.cr(),t})},Eh.prototype.terminate=function(){this.Jr=!1},Eh),Ja=(bh.prototype.ro=function(){var t=this;0===this.no&&(this.oo("Unknown"),this.so=this.Rs.Ts("online_state_timeout",1e4,function(){return t.so=null,t.ho("Backend didn't respond within 10 seconds."),t.oo("Offline"),Promise.resolve()}))},bh.prototype.ao=function(t){"Online"===this.state?this.oo("Unknown"):(this.no++,1<=this.no&&(this.uo(),this.ho("Connection failed 1 times. Most recent error: "+t.toString()),this.oo("Offline")))},bh.prototype.set=function(t){this.uo(),this.no=0,"Online"===t&&(this.io=!1),this.oo(t)},bh.prototype.oo=function(t){t!==this.state&&(this.state=t,this.eo(t))},bh.prototype.ho=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.io?(Di(e),this.io=!1):Li("OnlineStateTracker",e)},bh.prototype.uo=function(){null!==this.so&&(this.so.cancel(),this.so=null)},bh),th=(wh.prototype.start=function(){return this.enableNetwork()},wh.prototype.enableNetwork=function(){return this.wo.delete(0),this.Co()},wh.prototype.Co=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(this.Do()?this.Fo():this.Ro.set("Unknown"),[4,this.No()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},wh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(0),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),[2]}})})},wh.prototype.$o=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.po.stop()];case 1:return t.sent(),[4,this.Ao.stop()];case 2:return t.sent(),0<this._o.length&&(Li("RemoteStore","Stopping write stream with "+this._o.length+" pending writes"),this._o=[]),this.ko(),[2]}})})},wh.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Li("RemoteStore","RemoteStore shutting down."),this.wo.add(5),[4,this.$o()];case 1:return t.sent(),this.mo.Oo(),this.Ro.set("Unknown"),[2]}})})},wh.prototype.listen=function(t){this.fo.has(t.targetId)||(this.fo.set(t.targetId,t),this.Do()?this.Fo():this.Ao.vr()&&this.xo(t))},wh.prototype.Lo=function(t){this.fo.delete(t),this.Ao.vr()&&this.Mo(t),0===this.fo.size&&(this.Ao.vr()?this.Ao.Cr():this.Eo()&&this.Ro.set("Unknown"))},wh.prototype.Le=function(t){return this.fo.get(t)||null},wh.prototype.xe=function(t){return this.qo.xe(t)},wh.prototype.xo=function(t){this.do.we(t.targetId),this.Ao.Wr(t)},wh.prototype.Mo=function(t){this.do.we(t),this.Ao.Qr(t)},wh.prototype.Fo=function(){this.do=new no(this),this.Ao.start(),this.Ro.ro()},wh.prototype.Do=function(){return this.Eo()&&!this.Ao.gr()&&0<this.fo.size},wh.prototype.Eo=function(){return 0===this.wo.size},wh.prototype.ko=function(){this.do=null},wh.prototype.Po=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fo.forEach(function(t,e){n.xo(t)}),[2]})})},wh.prototype.Vo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ko(),this.Do()?(this.Ro.ao(e),this.Fo()):this.Ro.set("Unknown"),[2]})})},wh.prototype.yo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.Ro.set("Online"),!(r instanceof Qr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Uo(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Li("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Bo(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof Hr?this.do.Ve(r):r instanceof Xr?this.do.De(r):this.do.ge(r),o.isEqual(tr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Na(this.co)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Wo(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Li("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Bo(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},wh.prototype.Bo=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!aa(n))throw n;return this.wo.add(1),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),i=i||function(){return Na(e.co)},this.Rs.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Li("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.wo.delete(1),[4,this.Co()];case 2:return t.sent(),[2]}})})}),[2]}})})},wh.prototype.Qo=function(e){var n=this;return e().catch(function(t){return n.Bo(t,e)})},wh.prototype.Wo=function(i){var r=this,t=this.do.$e(i);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=r.fo.get(e))&&r.fo.set(e,n.et(t.resumeToken,i))}),t.jt.forEach(function(t){var e,n=r.fo.get(t);n&&(r.fo.set(t,n.et(Er.J,n.Z)),r.Mo(t),e=new Rr(n.target,t,1,n.sequenceNumber),r.xo(e))}),this.qo.jo(t)},wh.prototype.Uo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.fo.has(r)?[4,this.qo.Go(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.fo.delete(r),this.do.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},wh.prototype.No=function(){return d(this,void 0,void 0,function(){var r,o,s;return y(this,function(t){switch(t.label){case 0:r=0<this._o.length?this._o[this._o.length-1].batchId:-1,t.label=1;case 1:if(!this.Ko())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.co,n=r,(i=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),i.$n.qi(t,n)}))];case 3:return null===(o=t.sent())?(0===this._o.length&&this.po.Cr(),[3,7]):(r=o.batchId,this.zo(o),[3,6]);case 4:return s=t.sent(),[4,this.Bo(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ho()&&this.Yo(),[2]}var e,n,i})})},wh.prototype.Ko=function(){return this.Eo()&&this._o.length<10},wh.prototype.Jo=function(){return this._o.length},wh.prototype.zo=function(t){this._o.push(t),this.po.vr()&&this.po.Gr&&this.po.Kr(t.mutations)},wh.prototype.Ho=function(){return this.Eo()&&!this.po.gr()&&0<this._o.length},wh.prototype.Yo=function(){this.po.start()},wh.prototype.vo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.po.Yr(),[2]})})},wh.prototype.So=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this._o;e<n.length;e++)i=n[e],this.po.Kr(i.mutations);return[2]})})},wh.prototype.zr=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this._o.shift(),n=Xu.from(e,r,o),[4,this.Qo(function(){return i.qo.Xo(n)})];case 1:return t.sent(),[4,this.No()];case 2:return t.sent(),[2]}})})},wh.prototype.bo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.po.Gr?[4,this.Zo(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ho()&&this.Yo(),[2]}})})},wh.prototype.Zo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Sr(n=r.code)&&n!==Ki.ABORTED?(e=this._o.shift(),this.po.Sr(),[4,this.Qo(function(){return i.qo.th(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.No()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},wh.prototype.Io=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(4),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),this.po.Sr(),this.Ao.Sr(),this.wo.delete(4),[4,this.Co()];case 2:return t.sent(),[2]}})})},wh.prototype.eh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rs.js(),Li("RemoteStore","RemoteStore received new credentials"),this.wo.add(3),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),[4,this.qo.eh(e)];case 2:return t.sent(),this.wo.delete(3),[4,this.Co()];case 3:return t.sent(),[2]}})})},wh.prototype.nh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.wo.delete(2),[4,this.Co()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.wo.add(2),[4,this.$o()]);case 3:t.sent(),this.Ro.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},wh),eh=(mh.prototype.sh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},mh.prototype.ih=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},mh.prototype.rh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},mh),nh=(gh.prototype.ah=function(t){},gh.prototype.uh=function(t,e,n){},gh.prototype.lh=function(t){return this.oh.sh(t),this.hh[t]||"not-current"},gh.prototype._h=function(t,e,n){this.hh[t]=e},gh.prototype.fh=function(t){this.oh.ih(t)},gh.prototype.dh=function(t){return this.oh.activeTargetIds.has(t)},gh.prototype.wh=function(t){delete this.hh[t]},gh.prototype.mh=function(){return this.oh.activeTargetIds},gh.prototype.Th=function(t){return this.oh.activeTargetIds.has(t)},gh.prototype.start=function(){return this.oh=new eh,Promise.resolve()},gh.prototype.Eh=function(t,e,n){},gh.prototype.Ih=function(t){},gh.prototype.Oo=function(){},gh.prototype.ss=function(t){},gh),ih=(Object.defineProperty(vh.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),vh.prototype.gh=function(t,e){var u=this,a=e?e.vh:new Kr,h=e?e.yh:this.yh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.un()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),i=(i=e instanceof Ys?e:null)&&(yu(u.query,i)?i:null),r=!!n&&u.qt.has(n.key),o=!!i&&(i.Ke||u.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.bh(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.Vh(i,p)||d&&u.Vh(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.an()||this.query.un())for(;l.size>this.query.limit;){var n=this.query.an()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{yh:l,vh:a,Sh:f,qt:c}},vh.prototype.bh=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},vh.prototype.Ch=function(t,e,n){var o=this,i=this.yh;this.yh=t.yh,this.qt=t.qt;var r=t.vh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.Vh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ci()}}var i,r}),this.Dh(n);var s=e?this.Fh():[],u=0===this.Ph.size&&this.Yt?1:0,a=u!==this.Ah;return this.Ah=u,0!==r.length||a?{snapshot:new Zr(this.query,t.yh,i,r,t.qt,0==u,a,!1),Nh:s}:{Nh:s}},vh.prototype.$h=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Ch({yh:this.yh,vh:new Kr,qt:this.qt,Sh:!1},!1)):{Nh:[]}},vh.prototype.kh=function(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).Ke},vh.prototype.Dh=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.Rh=e.Rh.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.Rh=e.Rh.delete(t)}),this.Yt=t.Yt)},vh.prototype.Fh=function(){var e=this;if(!this.Yt)return[];var n=this.Ph;this.Ph=zr(),this.yh.forEach(function(t){e.kh(t.key)&&(e.Ph=e.Ph.add(t.key))});var i=[];return n.forEach(function(t){e.Ph.has(t)||i.push(new Ma(t))}),this.Ph.forEach(function(t){n.has(t)||i.push(new Ua(t))}),i},vh.prototype.Oh=function(t){this.Rh=t.Wi,this.Ph=zr();var e=this.gh(t.documents);return this.Ch(e,!0)},vh.prototype.xh=function(){return Zr.Wt(this.query,this.yh,this.qt,0===this.Ah)},vh),rh=(Object.defineProperty(yh.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),yh.prototype.subscribe=function(t){this.Bh=t},yh.prototype.listen=function(h){return d(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return this.ta("listen()"),(s=this.Wh.get(h))?(n=s.targetId,this.qh.lh(n),o=s.view.xh(),[3,4]):[3,1];case 1:return[4,(e=this.co,i=au(h),(r=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.Ui(e,i).next(function(t){return t?(n=t,Qu.resolve(n)):r.Ii.ea(e).next(function(t){return n=new Rr(i,t,0,e.$i),r.Ii.na(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(r.fi=r.fi.st(t.targetId,t),r.di.set(i,t.targetId)),t}))];case 2:return u=t.sent(),a=this.qh.lh(u.targetId),n=u.targetId,[4,this.sa(h,n,"current"===a)];case 3:o=t.sent(),this.Zh&&this.Mh.listen(u),t.label=4;case 4:return[2,o]}var e,i,r})})},yh.prototype.sa=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,ka(this.co,u,!0)];case 1:return e=t.sent(),n=new ih(u,e.Wi),i=n.gh(e.documents),r=to.Ht(a,h&&"Offline"!==this.onlineState),o=n.Ch(i,this.Zh,r),this.ia(a,o.Nh),s=new qa(u,a,n),[2,(this.Wh.set(u,s),this.Qh.has(a)?this.Qh.get(a).push(u):this.Qh.set(a,[u]),o.snapshot)]}})})},yh.prototype.Lo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ta("unlisten()"),e=this.Wh.get(r),1<(n=this.Qh.get(e.targetId)).length?[2,(this.Qh.set(e.targetId,n.filter(function(t){return!fu(t,r)})),void this.Wh.delete(r))]:this.Zh?(this.qh.fh(e.targetId),this.qh.Th(e.targetId)?[3,2]:[4,Ra(this.co,e.targetId,!1).then(function(){i.qh.wh(e.targetId),i.Mh.Lo(e.targetId),i.ra(e.targetId)}).catch(Sa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ra(e.targetId),[4,Ra(this.co,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},yh.prototype.write=function(s,u){return d(this,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:this.ta("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.co,h=s,l=e,f=Ji.now(),n=h.reduce(function(t,e){return t.add(e.key)},zr()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ai.Un(a,n).next(function(t){c=t;for(var u,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(u=o,e=c.get(o.key),u instanceof Ps?function(t){for(var e=null,n=0,i=u.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Ys?t.field(r.field):void 0,s=Ko(r.transform,o||null);null!=s&&(e=null==e?(new Fs).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Ss(o.key,s,function u(t){var a=[];return zi(t.fields||{},function(t,e){var n=new rr([t]);if(Oo(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new ys(a)}(s.proto.mapValue),ms.exists(!0)))}return l.$n.oa(a,f,n,h)})}).then(function(t){var e=t.Rn(c);return{batchId:t.batchId,ha:e}}))];case 2:return i=t.sent(),this.qh.ah(i.batchId),this.aa(i.batchId,u),[4,this.ua(i.ha)];case 3:return t.sent(),[4,this.Mh.No()];case 4:return t.sent(),[3,6];case 5:return r=t.sent(),o=da(r,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,l,f,n})})},yh.prototype.jo=function(r){return d(this,void 0,void 0,function(){var n,i=this;return y(this,function(t){switch(t.label){case 0:this.ta("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=e,l=(s=r).Z,f=c.fi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var r=c.Ti.gi({vi:!0});f=c.fi;var h=[];s.Qt.forEach(function(t,e){var n,i,r,o,s,u=f.get(e);u&&(h.push(c.Ii.Fi(a,t.Zt,e).next(function(){return c.Ii.Ni(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(i=u.et(n,l).tt(a.$i),f=f.st(e,i),r=u,s=t,Ui(0<(o=i).resumeToken.Y()),(0===r.resumeToken.Y()||3e8<=o.Z.I()-r.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.Ii.ki(a,i))))});var t,o=xr,n=zr();return s.Gt.forEach(function(t,e){n=n.add(t)}),h.push(r.getEntries(a,n).next(function(i){s.Gt.forEach(function(t,e){var n=i.get(t);e instanceof Ks&&e.version.isEqual(tr.min())?(r.Oi(t,l),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.bi(e,l),o=o.st(t,e)):Li("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Kt.has(t)&&h.push(c.persistence.Li.xi(a,t))})})),l.isEqual(tr.min())||(t=c.Ii.Di(a).next(function(t){return c.Ii.Mi(a,a.$i,l)}),h.push(t)),Qu.Dn(h).next(function(){return r.apply(a)}).next(function(){return c.Ai.Bn(a,o)})}).then(function(t){return c.fi=f,t}))];case 2:return n=t.sent(),r.Qt.forEach(function(t,e){var n=i.Kh.get(e);n&&(Ui(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.Lh=!0:0<t.Xt.size?Ui(n.Lh):0<t.Zt.size&&(Ui(n.Lh),n.Lh=!1))}),[4,this.ua(n,r)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,l,f})})},yh.prototype.$h=function(i,t){var r;(this.Zh&&0===t||!this.Zh&&1===t)&&(this.ta("applyOnlineStateChange()"),r=[],this.Wh.forEach(function(t,e){var n=e.view.$h(i);n.snapshot&&r.push(n.snapshot)}),this.Bh.ca(i),this.Bh.Br(r),this.onlineState=i,this.Zh&&this.qh.Ih(i))},yh.prototype.Go=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ta("rejectListens()"),this.qh._h(u,"rejected",a),e=this.Kh.get(u),(n=e&&e.key)?(i=(i=new Or(or.P)).st(n,new Ks(n,tr.min())),r=zr().add(n),o=new Jr(tr.min(),new Map,new Mr(xi),i,r),[4,this.jo(o)]):[3,2];case 1:return t.sent(),this.Gh=this.Gh.remove(n),this.Kh.delete(u),this.la(),[3,4];case 2:return[4,Ra(this.co,u,!1).then(function(){return s.ra(u,a)}).catch(Sa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},yh.prototype.Xo=function(r){return d(this,void 0,void 0,function(){var n,i;return y(this,function(t){switch(t.label){case 0:this.ta("applySuccessfulWrite()"),n=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=r,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ti.gi({vi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Qu.resolve();return a.forEach(function(i){h=h.next(function(){return s.Mn(o,i)}).next(function(t){var e=t,n=r.Pn.get(i);Ui(null!==n),(!e||e.version.o(n)<0)&&(e=u.Tn(i,e,r))&&s.bi(e,r.An)})}),h.next(function(){return i.$n.Si(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.$n.Ci(t)}).next(function(){return l.Ai.Un(t,e)})}))];case 2:return i=t.sent(),this._a(n,null),this.fa(n),this.qh.uh(n,"acknowledged"),[4,this.ua(i)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})},yh.prototype.th=function(o,s){return d(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:this.ta("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,i=o,(r=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.$n.da(e,i).next(function(t){return Ui(null!==t),n=t.keys(),r.$n.Si(e,t)}).next(function(){return r.$n.Ci(e)}).next(function(){return r.Ai.Un(e,n)})}))];case 2:return n=t.sent(),this._a(o,s),this.fa(o),this.qh.uh(o,"rejected",s),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,Sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,i,r})})},yh.prototype.wa=function(u){return d(this,void 0,void 0,function(){var i,r,o,s;return y(this,function(t){switch(t.label){case 0:this.Mh.Eo()||Li("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.co,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.$n.ma(t)}))];case 2:return-1===(i=t.sent())?[2,void u.resolve()]:((r=this.Yh.get(i)||[]).push(u),this.Yh.set(i,r),[3,4]);case 3:return o=t.sent(),s=da(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},yh.prototype.fa=function(t){(this.Yh.get(t)||[]).forEach(function(t){t.resolve()}),this.Yh.delete(t)},yh.prototype.Ta=function(e){this.Yh.forEach(function(t){t.forEach(function(t){t.reject(new Zi(Ki.CANCELLED,e))})}),this.Yh.clear()},yh.prototype.aa=function(t,e){var n=(n=(n=this.Hh[this.currentUser.rr()])||new Or(xi)).st(t,e);this.Hh[this.currentUser.rr()]=n},yh.prototype._a=function(t,e){var n,i=this.Hh[this.currentUser.rr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Hh[this.currentUser.rr()]=i)},yh.prototype.ra=function(t,e){var n=this;void 0===e&&(e=null),this.qh.fh(t);for(var i=0,r=this.Qh.get(t);i<r.length;i++){var o=r[i];this.Wh.delete(o),e&&this.Bh.Ea(o,e)}this.Qh.delete(t),this.Zh&&this.zh.Zi(t).forEach(function(t){n.zh.nr(t)||n.Ia(t)})},yh.prototype.Ia=function(t){var e=this.Gh.get(t);null!==e&&(this.Mh.Lo(e),this.Gh=this.Gh.remove(t),this.Kh.delete(e),this.la())},yh.prototype.ia=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Ua?(this.zh.zi(r.key,t),this.Ra(r)):r instanceof Ma?(Li("SyncEngine","Document no longer in limbo: "+r.key),this.zh.Yi(r.key,t),this.zh.nr(r.key)||this.Ia(r.key)):Ci()}},yh.prototype.Ra=function(t){var e=t.key;this.Gh.get(e)||(Li("SyncEngine","New document in limbo: "+e),this.jh.push(e),this.la())},yh.prototype.la=function(){for(;0<this.jh.length&&this.Gh.size<this.Uh;){var t=this.jh.shift(),e=this.Jh.next();this.Kh.set(e,new xa(t)),this.Gh=this.Gh.st(t,e),this.Mh.listen(new Rr(au(ou(t.path)),e,2,Zu.rs))}},yh.prototype.Aa=function(){return this.Gh},yh.prototype.Pa=function(){return this.jh},yh.prototype.ua=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wh.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.gh(i);return n.Sh?ka(u.co,r.query,!1).then(function(t){var e=t.documents;return r.view.gh(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(r.targetId),i=r.view.Ch(t,u.Zh,n);u.ia(r.targetId,i.Nh),i.snapshot&&(u.Zh&&u.qh._h(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Ku.Zn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bh.Br(o),[4,function(c,l){return d(this,void 0,void 0,function(){var i,e,n,r,o,s,u,a,h;return y(this,function(t){switch(t.label){case 0:i=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Qu.forEach(l,function(e){return Qu.forEach(e.Jn,function(t){return i.persistence.Li.zi(n,e.targetId,t)}).next(function(){return Qu.forEach(e.Xn,function(t){return i.persistence.Li.Yi(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!aa(e=t.sent()))throw e;return Li("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,r=l;n<r.length;n++)o=r[n],s=o.targetId,o.fromCache||(u=i.fi.get(s),a=u.Z,h=u.nt(a),i.fi=i.fi.st(s,h));return[2]}})})}(this.co,s)];case 2:return t.sent(),[2]}})})},yh.prototype.ta=function(t){},yh.prototype.eh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Li("SyncEngine","User change. New user:",n.rr()),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,m,i;return y(this,function(t){switch(t.label){case 0:return n=(e=r).$n,m=e.Ai,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.$n.Va(v).next(function(t){return g=t,n=e.persistence.mi(o),m=new Yu(e.Ti,n,e.persistence.Pi()),n.Va(v)}).next(function(t){for(var e=[],n=[],i=zr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Un(v,i).next(function(t){return{ya:t,pa:e,ga:n}})})})];case 1:return i=t.sent(),[2,(e.$n=n,e.Ai=m,e._i.Vi(e.Ai),i)]}})})}(this.co,n)]);case 1:return e=t.sent(),this.currentUser=n,this.Ta("'waitForPendingWrites' promise is rejected due to a user change."),this.qh.Eh(n,e.pa,e.ga),[4,this.ua(e.ya)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},yh.prototype.xe=function(t){var e=this.Kh.get(t);if(e&&e.Lh)return zr().add(e.key);var n=zr(),i=this.Qh.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Wh.get(s),n=n.Ft(u.view.ph);return n},yh),oh=(dh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.ba.get(e))||(n=!0,i=new ja),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.qo.listen(e)];case 2:return r.va=t.sent(),[3,4];case 3:return o=t.sent(),s=da(o,"Initialization of query '"+du(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.ba.set(e,i),i.listeners.push(u),u.$h(this.onlineState),i.va&&u.Ca(i.va)&&this.Da(),[2]}})})},dh.prototype.Lo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.ba.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.ba.delete(e),this.qo.Lo(e))]:[2]})})},dh.prototype.Br=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.ba.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ca(r)&&(e=!0);s.va=r}}e&&this.Da()},dh.prototype.Ea=function(t,e){var n=this.ba.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.ba.delete(t)},dh.prototype.ca=function(r){this.onlineState=r;var o=!1;this.ba.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].$h(r)&&(o=!0)}),o&&this.Da()},dh.prototype.Fa=function(t){this.Sa.add(t),t.next()},dh.prototype.Na=function(t){this.Sa.delete(t)},dh.prototype.Da=function(){this.Sa.forEach(function(t){t.next()})},dh),sh=(ph.prototype.Ca=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Zr(t.query,t.docs,t.Mt,e,t.qt,t.fromCache,t.Ut,!0)}var o=!1;return this.ka?this.xa(t)&&(this.$a.next(t),o=!0):this.La(t,this.onlineState)&&(this.Ma(t),o=!0),this.Oa=t,o},ph.prototype.onError=function(t){this.$a.error(t)},ph.prototype.$h=function(t){this.onlineState=t;var e=!1;return this.Oa&&!this.ka&&this.La(this.Oa,t)&&(this.Ma(this.Oa),e=!0),e},ph.prototype.La=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qa&&n||t.docs._()&&"Offline"!==e)},ph.prototype.xa=function(t){if(0<t.docChanges.length)return!0;var e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ut&&!e)&&!0===this.options.includeMetadataChanges},ph.prototype.Ma=function(t){t=Zr.Wt(t.query,t.docs,t.qt,t.fromCache),this.ka=!0,this.$a.next(t)},ph),uh=(fh.prototype.Vi=function(t){this.Ua=t},fh.prototype.Qn=function(e,i,r,o){var s=this;return i.hn()||r.isEqual(tr.min())?this.Ba(e,i):this.Ua.Un(e,o).next(function(t){var n=s.Wa(i,t);return(i.an()||i.un())&&s.Sh(i.nn,n,o,r)?s.Ba(e,i):(Oi()<=u.DEBUG&&Li("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),du(i)),s.Ua.Qn(e,i,r).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},fh.prototype.Wa=function(n,t){var i=new Mr(vu(n));return t.forEach(function(t,e){e instanceof Ys&&yu(n,e)&&(i=i.add(e))}),i},fh.prototype.Sh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},fh.prototype.Ba=function(t,e){return Oi()<=u.DEBUG&&Li("IndexFreeQueryEngine","Using full collection scan to execute query:",du(e)),this.Ua.Qn(t,e,tr.min())},fh),ah=(lh.prototype.Ga=function(t){return Qu.resolve(0===this.$n.length)},lh.prototype.oa=function(t,e,n,i){var r=this.Qa;this.Qa++,0<this.$n.length&&this.$n[this.$n.length-1];var o=new Hu(r,e,n,i);this.$n.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.ja=this.ja.add(new Oa(a.key,r)),this.kn.ai(t,a.key.path.g())}return Qu.resolve(o)},lh.prototype.da=function(t,e){return Qu.resolve(this.Ka(e))},lh.prototype.qi=function(t,e){var n=e+1,i=this.za(n),r=i<0?0:i;return Qu.resolve(this.$n.length>r?this.$n[r]:null)},lh.prototype.ma=function(){return Qu.resolve(0===this.$n.length?-1:this.Qa-1)},lh.prototype.Va=function(t){return Qu.resolve(this.$n.slice())},lh.prototype.xn=function(t,e){var n=this,i=new Oa(e,0),r=new Oa(e,Number.POSITIVE_INFINITY),o=[];return this.ja.St([i,r],function(t){var e=n.Ka(t.sr);o.push(e)}),Qu.resolve(o)},lh.prototype.Wn=function(t,e){var i=this,r=new Mr(xi);return e.forEach(function(t){var e=new Oa(t,0),n=new Oa(t,Number.POSITIVE_INFINITY);i.ja.St([e,n],function(t){r=r.add(t.sr)})}),Qu.resolve(this.Ha(r))},lh.prototype.Hn=function(t,e){var n=e.path,i=n.length+1,r=n;or.j(r)||(r=r.child(""));var o=new Oa(new or(r),0),s=new Mr(xi);return this.ja.Ct(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.sr)),!0)},o),Qu.resolve(this.Ha(s))},lh.prototype.Ha=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ka(t);null!==e&&i.push(e)}),i},lh.prototype.Si=function(n,i){var r=this;Ui(0===this.Ya(i.batchId,"removed")),this.$n.shift();var o=this.ja;return Qu.forEach(i.mutations,function(t){var e=new Oa(t.key,i.batchId);return o=o.delete(e),r.Li.Ja(n,t.key)}).next(function(){r.ja=o})},lh.prototype.Xa=function(t){},lh.prototype.nr=function(t,e){var n=new Oa(e,0),i=this.ja.Dt(n);return Qu.resolve(e.isEqual(i&&i.key))},lh.prototype.Ci=function(t){return this.$n.length,Qu.resolve()},lh.prototype.Ya=function(t,e){return this.za(t)},lh.prototype.za=function(t){return 0===this.$n.length?0:t-this.$n[0].batchId},lh.prototype.Ka=function(t){var e=this.za(t);return e<0||e>=this.$n.length?null:this.$n[e]},lh),hh=(ch.prototype.bi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Za(e);return this.docs=this.docs.st(i,{tu:e,size:s,readTime:n}),this.size+=s-o,this.kn.ai(t,i.path.g())},ch.prototype.Oi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},ch.prototype.Mn=function(t,e){var n=this.docs.get(e);return Qu.resolve(n?n.tu:null)},ch.prototype.getEntries=function(t,e){var n=this,i=xr;return e.forEach(function(t){var e=n.docs.get(t);i=i.st(t,e?e.tu:null)}),Qu.resolve(i)},ch.prototype.Qn=function(t,e,n){for(var i=Gr,r=new or(e.path.child("")),o=this.docs.ct(r);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.tu,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Ys&&yu(e,h)&&(i=i.st(h.key,h))}return Qu.resolve(i)},ch.prototype.eu=function(t,e){return Qu.forEach(this.docs,function(t){return e(t)})},ch.prototype.gi=function(t){return new ch.nu(this)},ch.prototype.su=function(t){return Qu.resolve(this.size)},ch);function ch(t,e){this.kn=t,this.Za=e,this.docs=new Or(or.P),this.size=0}function lh(t,e){this.kn=t,this.Li=e,this.$n=[],this.Qa=1,this.ja=new Mr(Oa.ji)}function fh(){}function ph(t,e,n){this.query=t,this.$a=e,this.ka=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}function dh(t){this.qo=t,this.ba=new Yi(pu,fu),this.onlineState="Unknown",this.Sa=new Set,this.qo.subscribe(this)}function yh(t,e,n,i,r,o){this.co=t,this.Mh=e,this.lo=n,this.qh=i,this.currentUser=r,this.Uh=o,this.Bh=null,this.Wh=new Yi(pu,fu),this.Qh=new Map,this.jh=[],this.Gh=new Or(or.P),this.Kh=new Map,this.zh=new _a,this.Hh={},this.Yh=new Map,this.Jh=wa.li(),this.onlineState="Unknown",this.Xh=void 0}function vh(t,e){this.query=t,this.Rh=e,this.Ah=null,this.Yt=!1,this.Ph=zr(),this.qt=zr(),this.Vh=vu(t),this.yh=new Yr(this.Vh)}function gh(){this.oh=new eh,this.hh={},this.eo=null,this.ts=null}function mh(){this.activeTargetIds=$r}function wh(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.co=t,this.lo=e,this.Rs=n,this._o=[],this.fo=new Map,this.do=null,this.wo=new Set,this.mo=r,this.mo.To(function(t){n.vs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(Li("RemoteStore","Restarting streams for network reachability change."),[4,this.Io()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ro=new Ja(n,i),this.Ao=(h=this.lo,c=n,l={qr:this.Po.bind(this),kr:this.Vo.bind(this),Br:this.yo.bind(this)},(f=h).Xr(),new Ya(c,f.Pr,f.credentials,f.serializer,l)),this.po=(o=this.lo,s=n,u={qr:this.vo.bind(this),kr:this.bo.bind(this),Hr:this.So.bind(this),zr:this.zr.bind(this)},(a=o).Xr(),new Ka(s,a.Pr,a.credentials,a.serializer,u))}function bh(t,e){this.Rs=t,this.eo=e,this.state="Unknown",this.no=0,this.so=null,this.io=!0}function Eh(t,e,n){var i=this;return(i=Fa.call(this)||this).credentials=t,i.Pr=e,i.serializer=n,i.Jr=!1,i}function Ih(t,e,n,i,r){var o=this;return(o=Ga.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.jr=!1,o}function Ah(t,e,n,i,r){var o=this;return(o=Ba.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Th(t,e,n,i,r,o){this.os=t,this.Ar=n,this.Pr=i,this.Vr=r,this.listener=o,this.state=0,this.yr=0,this.pr=null,this.stream=null,this.ks=new sa(t,e)}function Nh(t,e){this.Er=t,this.Ir=e}function Rh(t,e){this.Er=t,this.Ir=e,this.type="FirstParty",this.user=La.hr}function kh(t){var e=this;this.dr=null,this.currentUser=La.UNAUTHENTICATED,this.wr=!1,this.mr=0,this.ur=null,this.forceRefresh=!1,this.dr=function(){e.mr++,e.currentUser=e.Tr(),e.wr=!0,e.ur&&e.ur(e.currentUser)},this.mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.dr):(this.dr(null),t.get().then(function(t){e.auth=t,e.dr&&e.auth.addAuthTokenListener(e.dr)},function(){}))}function Sh(){this.ur=null}function _h(t){var e=this;return(e=Wa.call(this)||this).uu=t,e}function Oh(){this.ha=new Yi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.iu=!1}hh.nu=(Object.defineProperty(Oh.prototype,"readTime",{get:function(){return this.ru},set:function(t){this.ru=t},enumerable:!1,configurable:!0}),Oh.prototype.bi=function(t,e){this.ou(),this.readTime=e,this.ha.set(t.key,t)},Oh.prototype.Oi=function(t,e){this.ou(),e&&(this.readTime=e),this.ha.set(t,null)},Oh.prototype.Mn=function(t,e){this.ou();var n=this.ha.get(e);return void 0!==n?Qu.resolve(n):this.hu(t,e)},Oh.prototype.getEntries=function(t,e){return this.au(t,e)},Oh.prototype.apply=function(t){return this.ou(),this.iu=!0,this.Ch(t)},Oh.prototype.ou=function(){},o(_h,Wa=Oh),_h.prototype.Ch=function(n){var i=this,r=[];return this.ha.forEach(function(t,e){e?r.push(i.uu.bi(n,e,i.readTime)):i.uu.Oi(t)}),Qu.Dn(r)},_h.prototype.hu=function(t,e){return this.uu.Mn(t,e)},_h.prototype.au=function(t,e){return this.uu.getEntries(t,e)},_h);var Lh,Dh,Ph=(Kh.prototype.ve=function(t,n){return this.cu.forEach(function(t,e){return n(e)}),Qu.resolve()},Kh.prototype.Di=function(t){return Qu.resolve(this.lastRemoteSnapshotVersion)},Kh.prototype.du=function(t){return Qu.resolve(this.lu)},Kh.prototype.ea=function(t){return this.highestTargetId=this.fu.next(),Qu.resolve(this.highestTargetId)},Kh.prototype.Mi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lu&&(this.lu=e),Qu.resolve()},Kh.prototype.wu=function(t){this.cu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fu=new wa(e),this.highestTargetId=e),t.sequenceNumber>this.lu&&(this.lu=t.sequenceNumber)},Kh.prototype.na=function(t,e){return this.wu(e),this.targetCount+=1,Qu.resolve()},Kh.prototype.ki=function(t,e){return this.wu(e),Qu.resolve()},Kh.prototype.mu=function(t,e){return this.cu.delete(e.target),this._u.Zi(e.targetId),--this.targetCount,Qu.resolve()},Kh.prototype.Tu=function(n,i,r){var o=this,s=0,u=[];return this.cu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.cu.delete(t),u.push(o.Eu(n,e.targetId)),s++)}),Qu.Dn(u).next(function(){return s})},Kh.prototype.Iu=function(t){return Qu.resolve(this.targetCount)},Kh.prototype.Ui=function(t,e){var n=this.cu.get(e)||null;return Qu.resolve(n)},Kh.prototype.Ni=function(t,e,n){return this._u.Hi(e,n),Qu.resolve()},Kh.prototype.Fi=function(e,t,n){this._u.Xi(t,n);var i=this.persistence.Li,r=[];return i&&t.forEach(function(t){r.push(i.Ja(e,t))}),Qu.Dn(r)},Kh.prototype.Eu=function(t,e){return this._u.Zi(e),Qu.resolve()},Kh.prototype.Bi=function(t,e){var n=this._u.er(e);return Qu.resolve(n)},Kh.prototype.nr=function(t,e){return Qu.resolve(this._u.nr(e))},Kh),Vh=(Yh.prototype.start=function(){return Promise.resolve()},Yh.prototype.Oo=function(){return this.Pu=!1,Promise.resolve()},Object.defineProperty(Yh.prototype,"yu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),Yh.prototype.pu=function(){},Yh.prototype.gu=function(){},Yh.prototype.Pi=function(){return this.kn},Yh.prototype.mi=function(t){var e=this.Ru[t.rr()];return e||(e=new ah(this.kn,this.Li),this.Ru[t.rr()]=e),e},Yh.prototype.Ri=function(){return this.Ii},Yh.prototype.Ei=function(){return this.Nn},Yh.prototype.runTransaction=function(t,e,n){var i=this;Li("MemoryPersistence","Starting transaction:",t);var r=new Ch(this.Au.next());return this.Li.vu(),n(r).next(function(t){return i.Li.bu(r).next(function(){return t})}).Sn().then(function(t){return r.Su(),t})},Yh.prototype.Cu=function(e,n){return Qu.Fn(Object.values(this.Ru).map(function(t){return function(){return t.nr(e,n)}}))},Yh),Ch=(Qh.prototype.Fu=function(t){this.Du.push(t)},Qh.prototype.Su=function(){this.Du.forEach(function(t){return t()})},o(Xh,Dh=Qh),Xh),Uh=(Hh.ku=function(t){return new Hh(t)},Object.defineProperty(Hh.prototype,"Ou",{get:function(){if(this.$u)return this.$u;throw Ci()},enumerable:!1,configurable:!0}),Hh.prototype.zi=function(t,e,n){return this.Nu.zi(n,e),this.Ou.delete(n.toString()),Qu.resolve()},Hh.prototype.Yi=function(t,e,n){return this.Nu.Yi(n,e),this.Ou.add(n.toString()),Qu.resolve()},Hh.prototype.Ja=function(t,e){return this.Ou.add(e.toString()),Qu.resolve()},Hh.prototype.removeTarget=function(t,e){var n=this;this.Nu.Zi(e.targetId).forEach(function(t){return n.Ou.add(t.toString())});var i=this.persistence.Ri();return i.Bi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ou.add(t.toString())})}).next(function(){return i.mu(t,e)})},Hh.prototype.vu=function(){this.$u=new Set},Hh.prototype.bu=function(n){var i=this,r=this.persistence.Ei().gi();return Qu.forEach(this.Ou,function(t){var e=or.U(t);return i.xu(n,e).next(function(t){t||r.Oi(e)})}).next(function(){return i.$u=null,r.apply(n)})},Hh.prototype.xi=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Ou.delete(e.toString()):n.Ou.add(e.toString())})},Hh.prototype.Vu=function(t){return 0},Hh.prototype.xu=function(t,e){var n=this;return Qu.Fn([function(){return Qu.resolve(n.Nu.nr(e))},function(){return n.persistence.Ri().nr(t,e)},function(){return n.persistence.Cu(t,e)}])},Hh),Mh=($h.prototype.qr=function(t){this.qu=t},$h.prototype.kr=function(t){this.Uu=t},$h.prototype.onMessage=function(t){this.Bu=t},$h.prototype.close=function(){this.Mu()},$h.prototype.send=function(t){this.Lu(t)},$h.prototype.Wu=function(){this.qu()},$h.prototype.Qu=function(t){this.Uu(t)},$h.prototype.ju=function(t){this.Bu(t)},$h),qh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},xh=(zh.prototype.Zr=function(e,t,n,i){var r=this.Hu(e,t);Li("RestConnection","Sending: ",r,n);var o={};return this.Yu(o,i),this.Ju(e,r,o,n).then(function(t){return Li("RestConnection","Received: ",t),t},function(t){throw Pi("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},zh.prototype.to=function(t,e,n,i){return this.Zr(t,e,n,i)},zh.prototype.Yu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1-202072605451",t["Content-Type"]="text/plain",e)for(var n in e.ar)e.ar.hasOwnProperty(n)&&(t[n]=e.ar[n])},zh.prototype.Hu=function(t,e){var n=qh[t];return this.Ku+"/v1/"+e+":"+n},o(Wh,Lh=zh),Wh.prototype.Ju=function(a,e,n,i){return new Promise(function(o,s){var u=new Ni;u.listenOnce(Ai.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ii.NO_ERROR:var t=u.getResponseJson();Li("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ii.TIMEOUT:Li("Connection",'RPC "'+a+'" timed out'),s(new Zi(Ki.DEADLINE_EXCEEDED,"Request time out"));break;case Ii.HTTP_ERROR:var e,n,i=u.getStatus();Li("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ki).indexOf(r)?r:Ki.UNKNOWN,s(new Zi(n,e.message))):s(new Zi(Ki.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Zi(Ki.UNAVAILABLE,"Connection failed."));break;default:Ci()}}finally{Li("Connection",'RPC "'+a+'" completed.')}var r});var t=JSON.stringify(i);u.send(e,"POST",t,n,15)})},Wh.prototype.Ur=function(t,e){var n,i,r=[this.Ku,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ei(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Yu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(i=g()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Li("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Mh({Lu:function(t){l?Li("Connection","Not sending because WebChannel is closed:",t):(c||(Li("Connection","Opening WebChannel transport."),h.open(),c=!0),Li("Connection","WebChannel sending:",t),h.send(t))},Mu:function(){return h.close()}});return a(Ti.EventType.OPEN,function(){l||Li("Connection","WebChannel transport opened.")}),a(Ti.EventType.CLOSE,function(){l||(l=!0,Li("Connection","WebChannel transport closed"),f.Qu())}),a(Ti.EventType.ERROR,function(t){l||(l=!0,Pi("Connection","WebChannel transport errored:",t),f.Qu(new Zi(Ki.UNAVAILABLE,"The operation could not be completed")))}),a(Ti.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Ui(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Li("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Tr[r];if(void 0!==t)return _r(t)}(),s=i.message,void 0===o&&(o=Ki.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Qu(new Zi(o,s)),h.close()):(Li("Connection","WebChannel received:",n),f.ju(n)))}),setTimeout(function(){f.Wu()},0),f},Wh),jh=(Bh.prototype.To=function(t){this.nc.push(t)},Bh.prototype.Oo=function(){window.removeEventListener("online",this.Xu),window.removeEventListener("offline",this.tc)},Bh.prototype.sc=function(){window.addEventListener("online",this.Xu),window.addEventListener("offline",this.tc)},Bh.prototype.Zu=function(){Li("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(0)},Bh.prototype.ec=function(){Li("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(1)},Bh.ic=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Bh),Fh=(Gh.prototype.To=function(t){},Gh.prototype.Oo=function(){},Gh);function Gh(){}function Bh(){var t=this;this.Xu=function(){return t.Zu()},this.tc=function(){return t.ec()},this.nc=[],this.sc()}function Wh(t){var e=this;return(e=Lh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function zh(t){this.Gu=t,this.s=t.s;var e=t.ssl?"https":"http";this.Ku=e+"://"+t.host,this.zu="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function $h(t){this.Lu=t.Lu,this.Mu=t.Mu}function Hh(t){this.persistence=t,this.Nu=new _a,this.$u=null}function Xh(t){var e=this;return(e=Dh.call(this)||this).$i=t,e}function Qh(){this.Du=[]}function Yh(t){var e=this;this.Ru={},this.Au=new Zu(0),this.Pu=!1,this.Pu=!0,this.Li=t(this),this.Ii=new Ph(this),this.kn=new ga,this.Nn=new hh(this.kn,function(t){return e.Li.Vu(t)})}function Kh(t){this.persistence=t,this.cu=new Yi(mr,wr),this.lastRemoteSnapshotVersion=tr.min(),this.highestTargetId=0,this.lu=0,this._u=new _a,this.targetCount=0,this.fu=wa.ci()}function Zh(t){return new Po(t,!0)}var Jh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",tc=(ic.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.qh=this.rc(e),this.persistence=this.oc(e),[4,this.persistence.start()];case 1:return t.sent(),this.hc=this.ac(e),this.co=this.uc(e),[2]}})})},ic.prototype.ac=function(t){return null},ic.prototype.uc=function(t){return e=this.persistence,n=new uh,i=t.cc,new ba(e,n,i);var e,n,i},ic.prototype.oc=function(t){if(t._c.lc)throw new Zi(Ki.FAILED_PRECONDITION,Jh);return new Vh(Uh.ku)},ic.prototype.rc=function(t){return new nh},ic.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.hc&&this.hc.stop(),[4,this.qh.Oo()];case 1:return t.sent(),[4,this.persistence.Oo()];case 2:return t.sent(),[2]}})})},ic.prototype.clearPersistence=function(t,e){throw new Zi(Ki.FAILED_PRECONDITION,Jh)},ic),ec=(nc.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.co?[3,3]:(this.co=n.co,this.qh=n.qh,this.lo=this.fc(i),this.Mh=this.dc(i),this.qo=this.wc(i),this.mc=this.Tc(i),this.qh.eo=function(t){return e.qo.$h(t,1)},this.Mh.qo=this.qo,[4,this.Mh.start()]);case 1:return t.sent(),[4,this.Mh.nh(this.qo.Zh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},nc.prototype.Tc=function(t){return new oh(this.qo)},nc.prototype.fc=function(t){var e,n=Zh(t.Gu.s),i=(e=t.Gu,new xh(e)),r=t.credentials;return new Za(r,i,n)},nc.prototype.dc=function(t){var e=this;return new th(this.co,this.lo,t.Rs,function(t){return e.qo.$h(t,0)},new(jh.ic()?jh:Fh))},nc.prototype.wc=function(t){return e=this.co,n=this.Mh,i=this.lo,r=this.qh,o=t.cc,s=t.Uh,u=!t._c.lc||!t._c.synchronizeTabs,a=new rh(e,n,i,r,o,s),u&&(a.Xh=!0),a;var e,n,i,r,o,s,u,a},nc.prototype.terminate=function(){return this.Mh.Oo()},nc);function nc(){}function ic(){}function rc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var oc=(sc.prototype.next=function(t){this.observer.next&&this.Ec(this.observer.next,t)},sc.prototype.error=function(t){this.observer.error?this.Ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},sc.prototype.Ic=function(){this.muted=!0},sc.prototype.Ec=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},sc);function sc(t){this.observer=t,this.muted=!1}function uc(t,e){if(0!==e.length)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Nc(e.length,"argument")+".")}function ac(t,e,n){if(e.length!==n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires "+Nc(n,"argument")+", but was called with "+Nc(e.length,"argument")+".")}function hc(t,e,n){if(e.length<n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Nc(n,"argument")+", but was called with "+Nc(e.length,"argument")+".")}function cc(t,e,n,i){if(e.length<n||e.length>i)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Nc(e.length,"argument")+".")}function lc(t,e,n,i){gc(t,e,Tc(n)+" argument",i)}function fc(t,e,n,i){void 0!==i&&lc(t,e,n,i)}function pc(t,e,n,i){gc(t,e,n+" option",i)}function dc(t,e,n,i){void 0!==i&&pc(t,e,n,i)}function yc(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(wc(s))}var u=wc(n);throw new Zi(Ki.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function vc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid value "+wc(i)+" provided to function "+t+"() for its "+Tc(n)+" argument. Acceptable values: "+e.join(", "));return i}function gc(t,e,n,i){if(!("object"===e?mc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=wc(i);throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function mc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function wc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ci();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function bc(t,e,n){if(void 0===n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Tc(e)+" argument, but it was undefined.")}function Ec(n,t,i){zi(t,function(t,e){if(i.indexOf(t)<0)throw new Zi(Ki.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Ic(t,e,n,i){var r=wc(i);return new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+Tc(n)+" argument to be a "+e+", but it was: "+r)}function Ac(t,e,n){if(n<=0)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+Tc(e)+" argument to be a positive number, but it was: "+n+".")}function Tc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Nc(t,e){return t+" "+e+(1===t?"":"s")}function Rc(){if("undefined"==typeof Uint8Array)throw new Zi(Ki.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function kc(){if("undefined"==typeof atob)throw new Zi(Ki.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Sc,_c,Oc=(qc.fromBase64String=function(t){ac("Blob.fromBase64String",arguments,1),lc("Blob.fromBase64String","string",1,t),kc();try{return new qc(Er.fromBase64String(t))}catch(t){throw new Zi(Ki.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},qc.fromUint8Array=function(t){if(ac("Blob.fromUint8Array",arguments,1),Rc(),!(t instanceof Uint8Array))throw Ic("Blob.fromUint8Array","Uint8Array",1,t);return new qc(Er.fromUint8Array(t))},qc.prototype.toBase64=function(){return ac("Blob.toBase64",arguments,0),kc(),this.Rc.toBase64()},qc.prototype.toUint8Array=function(){return ac("Blob.toUint8Array",arguments,0),Rc(),this.Rc.toUint8Array()},qc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},qc.prototype.isEqual=function(t){return this.Rc.isEqual(t.Rc)},qc),Lc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Zi(Ki.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(lc("FieldPath","string",e,t[e]),0===t[e].length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ac=new rr(t)},Dc=(o(Mc,_c=Lc),Mc.documentId=function(){return new Mc(rr.M().N())},Mc.prototype.isEqual=function(t){if(!(t instanceof Mc))throw Ic("isEqual","FieldPath",1,t);return this.Ac.isEqual(t.Ac)},Mc),Pc=new RegExp("[~\\*/\\[\\]]"),Vc=function(){this.Pc=this},Cc=(o(Uc,Sc=Vc),Uc.prototype.yc=function(t){if(2!==t.pc)throw 1===t.pc?t.gc(this.Vc+"() can only appear at the top level of your update data"):t.gc(this.Vc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Uc.prototype.isEqual=function(t){return t instanceof Uc},Uc);function Uc(t){var e=this;return(e=Sc.call(this)||this).Vc=t,e}function Mc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _c.call(this,t)||this}function qc(t){kc(),this.Rc=t}function xc(t,e,n){return new pl({pc:3,vc:e.settings.vc,methodName:t.Vc,bc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var jc,Fc,Gc,Bc,Wc,zc,$c=(o(ll,zc=Vc),ll.prototype.yc=function(t){return new ds(t.path,new ts)},ll.prototype.isEqual=function(t){return t instanceof ll},ll),Hc=(o(cl,Wc=Vc),cl.prototype.yc=function(t){var e=xc(this,t,!0),n=this.Sc.map(function(t){return El(t,e)}),i=new es(n);return new ds(t.path,i)},cl.prototype.isEqual=function(t){return this===t},cl),Xc=(o(hl,Bc=Vc),hl.prototype.yc=function(t){var e=xc(this,t,!0),n=this.Sc.map(function(t){return El(t,e)}),i=new ss(n);return new ds(t.path,i)},hl.prototype.isEqual=function(t){return this===t},hl),Qc=(o(al,Gc=Vc),al.prototype.yc=function(t){var e=new cs(t.serializer,Uo(t.serializer,this.Cc));return new ds(t.path,e)},al.prototype.isEqual=function(t){return this===t},al),Yc=(o(ul,Fc=Vc),ul.delete=function(){return uc("FieldValue.delete",arguments),new Kc(new Cc("FieldValue.delete"))},ul.serverTimestamp=function(){return uc("FieldValue.serverTimestamp",arguments),new Kc(new $c("FieldValue.serverTimestamp"))},ul.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return hc("FieldValue.arrayUnion",arguments,1),new Kc(new Hc("FieldValue.arrayUnion",t))},ul.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return hc("FieldValue.arrayRemove",arguments,1),new Kc(new Xc("FieldValue.arrayRemove",t))},ul.increment=function(t){return lc("FieldValue.increment","number",1,t),ac("FieldValue.increment",arguments,1),new Kc(new Qc("FieldValue.increment",t))},ul),Kc=(o(sl,jc=Yc),sl.prototype.yc=function(t){return this.Pc.yc(t)},sl.prototype.isEqual=function(t){return t instanceof sl&&this.Pc.isEqual(t.Pc)},sl),Zc=(Object.defineProperty(ol.prototype,"latitude",{get:function(){return this.Dc},enumerable:!1,configurable:!0}),Object.defineProperty(ol.prototype,"longitude",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),ol.prototype.isEqual=function(t){return this.Dc===t.Dc&&this.Fc===t.Fc},ol.prototype.toJSON=function(){return{latitude:this.Dc,longitude:this.Fc}},ol.prototype.m=function(t){return xi(this.Dc,t.Dc)||xi(this.Fc,t.Fc)},ol),Jc=/^__.*__$/,tl=function(t,e,n){this.Nc=t,this.$c=e,this.kc=n},el=(rl.prototype.Oc=function(t,e){var n=[];return null!==this.qe?n.push(new Ss(t,this.data,this.qe,e)):n.push(new ks(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},rl),nl=(il.prototype.Oc=function(t,e){var n=[new Ss(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},il);function il(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function rl(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function ol(t,e){if(ac("GeoPoint",arguments,2),lc("GeoPoint","number",1,t),lc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Zi(Ki.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Zi(Ki.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Dc=t,this.Fc=e}function sl(t){var e=this;return(e=jc.call(this)||this).Pc=t,e.Vc=t.Vc,e}function ul(){return Fc.call(this)||this}function al(t,e){var n=this;return(n=Gc.call(this)||this).Vc=t,n.Cc=e,n}function hl(t,e){var n=this;return(n=Bc.call(this)||this).Vc=t,n.Sc=e,n}function cl(t,e){var n=this;return(n=Wc.call(this)||this).Vc=t,n.Sc=e,n}function ll(t){var e=this;return(e=zc.call(this)||this).Vc=t,e}function fl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ci()}}var pl=(Object.defineProperty(vl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(vl.prototype,"pc",{get:function(){return this.settings.pc},enumerable:!1,configurable:!0}),vl.prototype.Lc=function(t){return new vl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},vl.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.qc(t),i},vl.prototype.Uc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.xc(),i},vl.prototype.Bc=function(t){return this.Lc({path:void 0,bc:!0})},vl.prototype.gc=function(t){return kl(t,this.settings.methodName,this.settings.Wc||!1,this.path,this.settings.vc)},vl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},vl.prototype.xc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qc(this.path.get(t))},vl.prototype.qc=function(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(fl(this.pc)&&Jc.test(t))throw this.gc('Document fields cannot begin and end with "__"')},vl),dl=(yl.prototype.Qc=function(t,e,n,i){return void 0===i&&(i=!1),new pl({pc:t,methodName:e,vc:n,path:rr.k(),bc:!1,Wc:i},this.s,this.serializer,this.ignoreUndefinedProperties)},yl);function yl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Zh(t)}function vl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.qe=o||[]}function gl(t,e,n,i,r,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,r);Tl("Data must be an object, but it was:",s,i);var u,a,h=Il(i,s);if(o.merge)u=new ys(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Lc)d=p.Ac;else{if("string"!=typeof p)throw Ci();d=Rl(e,p,n)}if(!s.contains(d))throw new Zi(Ki.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Sl(c,d)||c.push(d)}u=new ys(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new el(new js(h),u,a)}function ml(t,o,s,e){var u=t.Qc(1,o,s);Tl("Data must be an object, but it was:",u,e);var a=[],h=new Fs;zi(e,function(t,e){var n,i=Rl(o,t,s),r=u.Uc(i);e instanceof Vc&&e.Pc instanceof Cc?a.push(i):null!=(n=El(e,r))&&(a.push(i),h.set(i,n))});var n=new ys(a);return new nl(h.ze(),n,u.fieldTransforms)}function wl(t,e,n,i,r,o){var s=t.Qc(1,e,n),u=[Nl(e,i,n)],a=[r];if(o.length%2!=0)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Nl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new Fs,v=u.length-1;0<=v;--v)Sl(d,u[v])||(c=u[v],l=a[v],f=s.Uc(c),l instanceof Vc&&l.Pc instanceof Cc?d.push(c):null!=(p=El(l,f))&&(d.push(c),y.set(c,p)));var g=new ys(d);return new nl(y.ze(),g,s.fieldTransforms)}function bl(t,e,n,i){return void 0===i&&(i=!1),El(n,t.Qc(i?4:3,e))}function El(s,t){if(Al(s))return Tl("Unsupported field value:",t,s),Il(s,t);if(s instanceof Vc)return function(t,e){if(!fl(e.pc))throw e.gc(t.Vc+"() can only be used with update() and set()");if(!e.path)throw e.gc(t.Vc+"() is not currently supported inside arrays");var n=t.yc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.bc&&4!==t.pc)throw t.gc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=El(r[i],t.Bc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ji.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof Ji){var i=new Ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,i)}}if(t instanceof Zc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Oc)return{bytesValue:qo(e.serializer,t)};if(t instanceof tl){var r=e.s,o=t.Nc;if(!o.isEqual(r))throw e.gc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:jo(t.Nc||e.s,t.$c.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.gc("Unsupported field value: "+wc(t))}(s,t)}function Il(t,i){var r={};return $i(t)?i.path&&0<i.path.length&&i.qe.push(i.path):zi(t,function(t,e){var n=El(e,i.Mc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Al(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ji||t instanceof Zc||t instanceof Oc||t instanceof tl||t instanceof Vc)}function Tl(t,e,n){if(!Al(n)||!mc(n)){var i=wc(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function Nl(t,e,n){if(e instanceof Lc)return e.Ac;if("string"==typeof e)return Rl(t,e);throw kl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Rl(t,e,n){try{return function(e){if(0<=e.search(Pc))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Dc.bind.apply(Dc,s([void 0],e.split("."))))}catch(t){throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ac}catch(e){throw kl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function kl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+i),s&&(a+=" in document "+r),a+=")"),new Zi(Ki.INVALID_ARGUMENT,(u+=". ")+t+a)}function Sl(t,e){return t.some(function(t){return t.isEqual(e)})}var _l=(Vl.prototype.Hc=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),0<this.mutations.length)throw new Zi(Ki.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Wo((r=u).serializer)+"/documents",n={documents:a.map(function(t){return Fo(r.serializer,t)})},[4,r.to("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Ui(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),i=xo(e.found.updateTime),r=new js({mapValue:{fields:e.found.fields}});return new Ys(n,i,r,{})}(e,n):"missing"in n?function(t,e){Ui(!!e.missing),Ui(!!e.readTime);var n=Go(t,e.missing),i=xo(e.readTime);return new Ks(n,i)}(e,n):Ci());o.set(i.key.toString(),i)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Ui(!!e),s.push(e)}),s)]}})})}(this.lo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ks||t instanceof Ys?n.Jc(t):Ci()}),e)]}})})},Vl.prototype.set=function(t,e){this.write(e.Oc(t,this.We(t))),this.zc.add(t.toString())},Vl.prototype.update=function(t,e){try{this.write(e.Oc(t,this.Xc(t)))}catch(t){this.Kc=t}this.zc.add(t.toString())},Vl.prototype.delete=function(t){this.write([new qs(t,this.We(t))]),this.zc.add(t.toString())},Vl.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),this.Kc)throw this.Kc;return e=this.jc,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=or.U(e);i.mutations.push(new xs(n,i.We(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Wo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return $o(e.serializer,t)})},[4,e.Zr("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.lo,this.mutations)];case 1:return t.sent(),this.Gc=!0,[2]}})})},Vl.prototype.Jc=function(t){var e;if(t instanceof Ys)e=t.version;else{if(!(t instanceof Ks))throw Ci();e=tr.min()}var n=this.jc.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Zi(Ki.ABORTED,"Document version changed between two reads.")}else this.jc.set(t.key.toString(),e)},Vl.prototype.We=function(t){var e=this.jc.get(t.toString());return!this.zc.has(t.toString())&&e?ms.updateTime(e):ms.Ge()},Vl.prototype.Xc=function(t){var e=this.jc.get(t.toString());if(this.zc.has(t.toString())||!e)return ms.exists(!0);if(e.isEqual(tr.min()))throw new Zi(Ki.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ms.updateTime(e)},Vl.prototype.write=function(t){this.Yc(),this.mutations=this.mutations.concat(t)},Vl.prototype.Yc=function(){},Vl),Ol=(Pl.prototype.run=function(){this.tl()},Pl.prototype.tl=function(){var t=this;this.ks.ws(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new _l(this.lo),(n=this.el(e))&&n.then(function(t){i.Rs.vs(function(){return e.commit().then(function(){i.Vs.resolve(t)}).catch(function(t){i.nl(t)})})}).catch(function(t){i.nl(t)}),[2]})})})},Pl.prototype.el=function(t){try{var e=this.updateFunction(t);return!dr(e)&&e.catch&&e.then?e:(this.Vs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vs.reject(t),null}},Pl.prototype.nl=function(t){var e=this;0<this.Zc&&this.sl(t)?(--this.Zc,this.Rs.vs(function(){return e.tl(),Promise.resolve()})):this.Vs.reject(t)},Pl.prototype.sl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Sr(e)},Pl),Ll=(Dl.prototype.start=function(t,e,n,i){var r=this;this.rl(),this.Gu=t;var o=new oa,s=!1;return this.credentials.lr(function(t){return s?void r.Rs.Bs(function(){return r.Mh.eh(t)}):(s=!0,Li("FirestoreClient","Initializing. user=",t.uid),r.ol(e,n,i,t,o).then(r.il.resolve,r.il.reject))}),this.Rs.vs(function(){return r.il.promise}),o.promise},Dl.prototype.enableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!0),t.Mh.enableNetwork()})},Dl.prototype.ol=function(r,o,s,u,a){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Rs:this.Rs,Gu:this.Gu,clientId:this.clientId,credentials:this.credentials,cc:u,Uh:100,_c:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.qh=r.qh,this.co=r.co,this.hc=r.hc,this.lo=o.lo,this.Mh=o.Mh,this.qo=o.qo,this.hl=o.mc,this.persistence.pu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.ol(new tc,new ec,{lc:!1},u,a))];case 4:return[2]}})})},Dl.prototype.al=function(t){return"FirebaseError"===t.name?t.code===Ki.FAILED_PRECONDITION||t.code===Ki.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Dl.prototype.rl=function(){if(this.Rs.xs)throw new Zi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")},Dl.prototype.disableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!1),t.Mh.disableNetwork()})},Dl.prototype.terminate=function(){var t=this;this.Rs.Us();var i=new oa;return this.Rs.Ls(function(){return d(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.hc&&this.hc.stop(),[4,this.Mh.Oo()];case 1:return t.sent(),[4,this.qh.Oo()];case 2:return t.sent(),[4,this.persistence.Oo()];case 3:return t.sent(),this.credentials._r(),i.resolve(),[3,5];case 4:return e=t.sent(),n=da(e,"Failed to shutdown persistence"),i.reject(n),[3,5];case 5:return[2]}})})}),i.promise},Dl.prototype.waitForPendingWrites=function(){var t=this;this.rl();var e=new oa;return this.Rs.vs(function(){return t.qo.wa(e)}),e.promise},Dl.prototype.listen=function(t,e,n){var i=this;this.rl();var r=new oc(n),o=new sh(t,r,e);return this.Rs.vs(function(){return i.hl.listen(o)}),function(){r.Ic(),i.Rs.vs(function(){return i.hl.Lo(o)})}},Dl.prototype.ul=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,u,a){return d(this,void 0,void 0,function(){var s,e=this;return y(this,function(t){switch(t.label){case 0:return s=new oa,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Ai.On(t,e)}))];case 1:return(i=t.sent())instanceof Ys?s.resolve(i):i instanceof Ks?s.resolve(null):s.reject(new Zi(Ki.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),o=da(r,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.Rs,this.co,e))]}})})},Dl.prototype.cl=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new oa,s=Cl(e,n,ou(i.path),{includeMetadataChanges:!0,qa:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Zi(Ki.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Zi(Ki.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Dl.prototype.ll=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,a,h){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return u=new oa,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ka(a,h,!0)];case 1:return e=t.sent(),n=new ih(h,e.Wi),i=n.gh(e.documents),r=n.Ch(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=da(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.Rs,this.co,e))]}})})},Dl.prototype._l=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new oa,s=Cl(e,n,i,{includeMetadataChanges:!0,qa:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Zi(Ki.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Dl.prototype.write=function(t){var e=this;this.rl();var n=new oa;return this.Rs.vs(function(){return e.qo.write(t,n)}),n.promise},Dl.prototype.s=function(){return this.Gu.s},Dl.prototype.Fa=function(t){var e=this;this.rl();var n=new oc(t);return this.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Fa(n)]})})}),function(){n.Ic(),e.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Na(n)]})})})}},Object.defineProperty(Dl.prototype,"fl",{get:function(){return this.Rs.xs},enumerable:!1,configurable:!0}),Dl.prototype.transaction=function(t){var e=this;this.rl();var n=new oa;return this.Rs.vs(function(){return new Ol(e.Rs,e.lo,t,n).run(),Promise.resolve()}),n.promise},Dl);function Dl(t,e){this.credentials=t,this.Rs=e,this.clientId=Mi.t(),this.il=new oa}function Pl(t,e,n,i){this.Rs=t,this.lo=e,this.updateFunction=n,this.Vs=i,this.Zc=5,this.ks=new sa(this.Rs,"transaction_retry")}function Vl(t){this.lo=t,this.jc=new Map,this.mutations=[],this.Gc=!1,this.Kc=null,this.zc=new Set}function Cl(t,e,n,i,r){var o=new oc(r),s=new sh(n,o,i);return t.vs(function(){return e.listen(s)}),function(){o.Ic(),t.vs(function(){return e.Lo(s)})}}var Ul,Ml,ql=(nf.prototype.ml=function(t){switch(vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ao(t.integerValue||t.doubleValue);case 3:return this.Tl(t.timestampValue);case 4:return this.El(t);case 5:return t.stringValue;case 6:return new Oc(To(t.bytesValue));case 7:return this.Il(t.referenceValue);case 8:return this.Rl(t.geoPointValue);case 9:return this.Al(t.arrayValue);case 10:return this.Pl(t.mapValue);default:throw Ci()}},nf.prototype.Pl=function(t){var n=this,i={};return zi(t.fields||{},function(t,e){i[t]=n.ml(e)}),i},nf.prototype.Rl=function(t){return new Zc(Ao(t.latitude),Ao(t.longitude))},nf.prototype.Al=function(t){var e=this;return(t.values||[]).map(function(t){return e.ml(t)})},nf.prototype.El=function(t){switch(this.dl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return fo(n)?t(n):n}(t);return null==e?null:this.ml(e);case"estimate":return this.Tl(po(t));default:return null}},nf.prototype.Tl=function(t){var e=Io(t),n=new Ji(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},nf.prototype.Il=function(t){var e=nr.$(t);Ui(Qo(e));var n=new Gi(e.get(1),e.get(3)),i=new or(e.p(5));return n.isEqual(this.s)||Di("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.wl(i)},nf),xl=ya.ni,jl=(ef.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},ef),Fl=(Object.defineProperty(tf.prototype,"Nl",{get:function(){return this.$l||(this.$l=new dl(this.Nc,this.Fl.ignoreUndefinedProperties)),this.$l},enumerable:!1,configurable:!0}),tf.prototype.settings=function(t){ac("Firestore.settings",arguments,1),lc("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Fl),t)).merge;var e=new jl(t);if(this.bl&&!this.Fl.isEqual(e))throw new Zi(Ki.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Fl=e).credentials&&(this.Dl=function(t){if(!t)return new za;switch(t.type){case"gapi":var e=t.kl;return Ui(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xa(e,t.Ir||"0");case"provider":return t.kl;default:throw new Zi(Ki.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},tf.prototype.enableNetwork=function(){return this.vl(),this.bl.enableNetwork()},tf.prototype.disableNetwork=function(){return this.vl(),this.bl.disableNetwork()},tf.prototype.enablePersistence=function(t){var e,n;if(this.bl)throw new Zi(Ki.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Di("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Zi(Ki.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ol(this.Vl,this.yl,{lc:!0,cacheSizeBytes:this.Fl.cacheSizeBytes,synchronizeTabs:i,xl:r})},tf.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.bl&&!this.bl.fl)throw new Zi(Ki.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new oa,[2,(this.gl.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Vl.clearPersistence(this.Nc,this.Cl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},tf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(tf.prototype,"Ll",{get:function(){return this.vl(),this.bl.fl},enumerable:!1,configurable:!0}),tf.prototype.waitForPendingWrites=function(){return this.vl(),this.bl.waitForPendingWrites()},tf.prototype.onSnapshotsInSync=function(t){if(this.vl(),rc(t))return this.bl.Fa(t);lc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.bl.Fa(e)},tf.prototype.vl=function(){return this.bl||this.Ol(new tc,new ec,{lc:!1}),this.bl},tf.prototype.Ml=function(){return new Fi(this.Nc,this.Cl,this.Fl.host,this.Fl.ssl,this.Fl.experimentalForceLongPolling)},tf.prototype.Ol=function(t,e,n){var i=this.Ml();return this.bl=new Ll(this.Dl,this.gl),this.bl.start(i,t,e,n)},tf.Sl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Zi(Ki.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Zi(Ki.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Gi(n)},Object.defineProperty(tf.prototype,"app",{get:function(){if(!this.pl)throw new Zi(Ki.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pl},enumerable:!1,configurable:!0}),tf.prototype.collection=function(t){return ac("Firestore.collection",arguments,1),lc("Firestore.collection","non-empty string",1,t),this.vl(),new lf(nr.$(t),this,null)},tf.prototype.doc=function(t){return ac("Firestore.doc",arguments,1),lc("Firestore.doc","non-empty string",1,t),this.vl(),Wl.ql(nr.$(t),this,null)},tf.prototype.collectionGroup=function(t){if(ac("Firestore.collectionGroup",arguments,1),lc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.vl(),new hf((e=t,new iu(nr.k(),e)),this,null);var e},tf.prototype.runTransaction=function(e){var n=this;return ac("Firestore.runTransaction",arguments,1),lc("Firestore.runTransaction","function",1,e),this.vl().transaction(function(t){return e(new Gl(n,t))})},tf.prototype.batch=function(){return this.vl(),new Bl(this)},Object.defineProperty(tf,"logLevel",{get:function(){switch(Oi()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),tf.setLogLevel=function(t){ac("Firestore.setLogLevel",arguments,1),vc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_i.setLogLevel(t)},tf.prototype.Ul=function(){return this.Fl.timestampsInSnapshots},tf.prototype.Bl=function(){return this.Fl},tf),Gl=(Jl.prototype.get=function(t){var n=this;ac("Transaction.get",arguments,1);var i=mf("Transaction.get",t,this.Wl);return this.Ql.Hc([i.$c]).then(function(t){if(!t||1!==t.length)return Ci();var e=t[0];if(e instanceof Ks)return new $l(n.Wl,i.$c,null,!1,!1,i.kc);if(e instanceof Ys)return new $l(n.Wl,i.$c,e,!1,!1,i.kc);throw Ci()})},Jl.prototype.set=function(t,e,n){cc("Transaction.set",arguments,2,3);var i=mf("Transaction.set",t,this.Wl);n=yf("Transaction.set",n);var r=wf(i.kc,e,n),o=gl(this.Wl.Nl,"Transaction.set",i.$c,r,null!==i.kc,n);return this.Ql.set(i.$c,o),this},Jl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Dc?(hc("Transaction.update",arguments,3),i=mf("Transaction.update",t,this.Wl),wl(this.Wl.Nl,"Transaction.update",i.$c,e,n,o)):(ac("Transaction.update",arguments,2),i=mf("Transaction.update",t,this.Wl),ml(this.Wl.Nl,"Transaction.update",i.$c,e)),this.Ql.update(i.$c,r),this},Jl.prototype.delete=function(t){ac("Transaction.delete",arguments,1);var e=mf("Transaction.delete",t,this.Wl);return this.Ql.delete(e.$c),this},Jl),Bl=(Zl.prototype.set=function(t,e,n){cc("WriteBatch.set",arguments,2,3),this.Kl();var i=mf("WriteBatch.set",t,this.Wl);n=yf("WriteBatch.set",n);var r=wf(i.kc,e,n),o=gl(this.Wl.Nl,"WriteBatch.set",i.$c,r,null!==i.kc,n);return this.jl=this.jl.concat(o.Oc(i.$c,ms.Ge())),this},Zl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Kl(),r="string"==typeof e||e instanceof Dc?(hc("WriteBatch.update",arguments,3),i=mf("WriteBatch.update",t,this.Wl),wl(this.Wl.Nl,"WriteBatch.update",i.$c,e,n,o)):(ac("WriteBatch.update",arguments,2),i=mf("WriteBatch.update",t,this.Wl),ml(this.Wl.Nl,"WriteBatch.update",i.$c,e)),this.jl=this.jl.concat(r.Oc(i.$c,ms.exists(!0))),this},Zl.prototype.delete=function(t){ac("WriteBatch.delete",arguments,1),this.Kl();var e=mf("WriteBatch.delete",t,this.Wl);return this.jl=this.jl.concat(new qs(e.$c,ms.Ge())),this},Zl.prototype.commit=function(){return this.Kl(),this.Gl=!0,0<this.jl.length?this.Wl.vl().write(this.jl):Promise.resolve()},Zl.prototype.Kl=function(){if(this.Gl)throw new Zi(Ki.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Zl),Wl=(o(Kl,Ml=tl),Kl.ql=function(t,e,n){if(t.length%2!=0)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Kl(new or(t),e,n)},Object.defineProperty(Kl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Kl.prototype,"parent",{get:function(){return new lf(this.$c.path.g(),this.firestore,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Kl.prototype,"path",{get:function(){return this.$c.path.N()},enumerable:!1,configurable:!0}),Kl.prototype.collection=function(t){if(ac("DocumentReference.collection",arguments,1),lc("DocumentReference.collection","non-empty string",1,t),!t)throw new Zi(Ki.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=nr.$(t);return new lf(this.$c.path.child(e),this.firestore,null)},Kl.prototype.isEqual=function(t){if(!(t instanceof Kl))throw Ic("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$c.isEqual(t.$c)&&this.kc===t.kc},Kl.prototype.set=function(t,e){cc("DocumentReference.set",arguments,1,2),e=yf("DocumentReference.set",e);var n=wf(this.kc,t,e),i=gl(this.firestore.Nl,"DocumentReference.set",this.$c,n,null!==this.kc,e);return this.bl.write(i.Oc(this.$c,ms.Ge()))},Kl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Dc?(hc("DocumentReference.update",arguments,2),wl(this.firestore.Nl,"DocumentReference.update",this.$c,t,e,i)):(ac("DocumentReference.update",arguments,1),ml(this.firestore.Nl,"DocumentReference.update",this.$c,t)),this.bl.write(n.Oc(this.$c,ms.exists(!0)))},Kl.prototype.delete=function(){return ac("DocumentReference.delete",arguments,0),this.bl.write([new qs(this.$c,ms.Ge())])},Kl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];cc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof r[u]||rc(r[u])||(Ec("DocumentReference.onSnapshot",s=r[u],["includeMetadataChanges"]),dc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};rc(r[u])?(a=r[u],r[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),r[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),r[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(lc("DocumentReference.onSnapshot","function",u,r[u]),fc("DocumentReference.onSnapshot","function",u+1,r[u+1]),fc("DocumentReference.onSnapshot","function",u+2,r[u+2]));var c={next:function(t){r[u]&&r[u](i.zl(t))},error:r[u+1],complete:r[u+2]};return this.bl.listen(ou(this.$c.path),h,c)},Kl.prototype.get=function(t){var e=this;cc("DocumentReference.get",arguments,0,1),gf("DocumentReference.get",t);var n=this.firestore.vl();return t&&"cache"===t.source?n.ul(this.$c).then(function(t){return new $l(e.firestore,e.$c,t,!0,t instanceof Ys&&t.Ke,e.kc)}):n.cl(this.$c,t).then(function(t){return e.zl(t)})},Kl.prototype.withConverter=function(t){return new Kl(this.$c,this.firestore,t)},Kl.prototype.zl=function(t){var e=t.docs.get(this.$c);return new $l(this.firestore,this.$c,e,t.fromCache,t.hasPendingWrites,this.kc)},Kl),zl=(Yl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Yl),$l=(Ql.prototype.data=function(t){var e=this;if(cc("DocumentSnapshot.data",arguments,0,1),t=vf("DocumentSnapshot.data",t),this.Hl){if(this.kc){var n=new Hl(this.Wl,this.$c,this.Hl,this.Yl,this.Jl,null);return this.kc.fromFirestore(n,t)}return new ql(this.Wl.Nc,this.Wl.Ul(),t.serverTimestamps||"none",function(t){return new Wl(t,e.Wl,null)}).ml(this.Hl.tn())}},Ql.prototype.get=function(t,e){var n=this;if(cc("DocumentSnapshot.get",arguments,1,2),e=vf("DocumentSnapshot.get",e),this.Hl){var i=this.Hl.data().field(Nl("DocumentSnapshot.get",t,this.$c));if(null!==i)return new ql(this.Wl.Nc,this.Wl.Ul(),e.serverTimestamps||"none",function(t){return new Wl(t,n.Wl,n.kc)}).ml(i)}},Object.defineProperty(Ql.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"ref",{get:function(){return new Wl(this.$c,this.Wl,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"exists",{get:function(){return null!==this.Hl},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"metadata",{get:function(){return new zl(this.Jl,this.Yl)},enumerable:!1,configurable:!0}),Ql.prototype.isEqual=function(t){if(!(t instanceof Ql))throw Ic("isEqual","DocumentSnapshot",1,t);return this.Wl===t.Wl&&this.Yl===t.Yl&&this.$c.isEqual(t.$c)&&(null===this.Hl?null===t.Hl:this.Hl.isEqual(t.Hl))&&this.kc===t.kc},Ql),Hl=(o(Xl,Ul=$l),Xl.prototype.data=function(t){return Ul.prototype.data.call(this,t)},Xl);function Xl(){return null!==Ul&&Ul.apply(this,arguments)||this}function Ql(t,e,n,i,r,o){this.Wl=t,this.$c=e,this.Hl=n,this.Yl=i,this.Jl=r,this.kc=o}function Yl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Kl(t,e,n){var i=this;return(i=Ml.call(this,e.Nc,t,n)||this).$c=t,i.firestore=e,i.kc=n,i.bl=i.firestore.vl(),i}function Zl(t){this.Wl=t,this.jl=[],this.Gl=!1}function Jl(t,e){this.Wl=t,this.Ql=e}function tf(t,e,n,i){var r=this;if(void 0===n&&(n=new tc),void 0===i&&(i=new ec),this.Vl=n,this.yl=i,this.pl=null,this.gl=new la,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.vl(),[4,this.bl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.pl=o,this.Nc=tf.Sl(o),this.Cl=o.name,this.Dl=new $a(e)}else{var s=t;if(!s.projectId)throw new Zi(Ki.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new Gi(s.projectId,s.database),this.Cl="[DEFAULT]",this.Dl=new za}this.Fl=new jl({})}function ef(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Zi(Ki.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else pc("settings","non-empty string","host",t.host),this.host=t.host,dc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ec("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),dc("settings","object","credentials",t.credentials),this.credentials=t.credentials,dc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),dc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Di("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Di("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,dc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ya.ii;else{if(t.cacheSizeBytes!==xl&&t.cacheSizeBytes<ya.si)throw new Zi(Ki.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ya.si);this.cacheSizeBytes=t.cacheSizeBytes}dc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function nf(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.dl=n,this.wl=i}function rf(t,e,n){if("string"==typeof n){if(""===n)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!su(e)&&-1!==n.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(nr.$(n));if(!or.j(i))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return No(t,new or(i))}if(n instanceof tl)return No(t,n.$c);throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+wc(n)+".")}function of(t,e){if(!Array.isArray(t)||0===t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function sf(t,e,n){if(!n.isEqual(e))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function uf(t){if(t.un()&&0===t.en.length)throw new Zi(Ki.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var af,hf=(df.prototype.where=function(t,e,n){var i;ac("Query.where",arguments,3),bc("Query.where",3,n),i="not-in"===e||"!="===e?e:vc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=Nl("Query.where",t),u=function(t,e,n,i,r,o){var s;if(i.L()){if("array-contains"===r||"array-contains-any"===r)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r||"not-in"===r){of(o,r);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(rf(n,t,c))}s={arrayValue:{values:u}}}else s=rf(n,t,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||of(o,r),s=bl(e,"Query.where",o,"in"===r||"not-in"===r);var l=mu.create(i,r,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.cn();null!==i&&sf(0,e.field,i)}var r=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,l),l}(this.Xl,this.firestore.Nl,this.firestore.Nc,s,i,n);return new df((o=(r=this.Xl).filters.concat([u]),new iu(r.path,r.collectionGroup,r.en.slice(),o,r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.kc)},df.prototype.orderBy=function(t,e){var n;if(cc("Query.orderBy",arguments,1,2),fc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=Nl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o=new $u(e,n),s=o;return null!==(i=t).cn()||null!==(r=i.ln())&&sf(0,r,s.field),o}(this.Xl,o,n);return new df((r=(i=this.Xl).en.concat([s]),new iu(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.kc)},df.prototype.limit=function(t){return ac("Query.limit",arguments,1),lc("Query.limit","number",1,t),Ac("Query.limit",1,t),new df(hu(this.Xl,t,"F"),this.firestore,this.kc)},df.prototype.limitToLast=function(t){return ac("Query.limitToLast",arguments,1),lc("Query.limitToLast","number",1,t),Ac("Query.limitToLast",1,t),new df(hu(this.Xl,t,"L"),this.firestore,this.kc)},df.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];hc("Query.startAt",arguments,1);var i=this.Zl("Query.startAt",t,e,!0);return new df(cu(this.Xl,i),this.firestore,this.kc)},df.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];hc("Query.startAfter",arguments,1);var i=this.Zl("Query.startAfter",t,e,!1);return new df(cu(this.Xl,i),this.firestore,this.kc)},df.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];hc("Query.endBefore",arguments,1);var i=this.Zl("Query.endBefore",t,e,!0);return new df(lu(this.Xl,i),this.firestore,this.kc)},df.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];hc("Query.endAt",arguments,1);var i=this.Zl("Query.endAt",t,e,!1);return new df(lu(this.Xl,i),this.firestore,this.kc)},df.prototype.isEqual=function(t){if(!(t instanceof df))throw Ic("isEqual","Query",1,t);return this.firestore===t.firestore&&fu(this.Xl,t.Xl)&&this.kc===t.kc},df.prototype.withConverter=function(t){return new df(this.Xl,this.firestore,t)},df.prototype.Zl=function(c,t,e,n){if(bc(c,1,t),t instanceof $l)return ac(c,s([t],e),1),function(t,e,n,i){if(!n)throw new Zi(Ki.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=uu(t);o<s.length;o++){var u=s[o];if(u.field.L())r.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Zi(Ki.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(a)}}return new qu(r,i)}(this.Xl,this.firestore.Nc,t.Hl,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.en;if(r.length>s.length)throw new Zi(Ki.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<r.length;a++){var h=r[a];if(s[a].field.L()){if("string"!=typeof h)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!su(t)&&-1!==h.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(nr.$(h));if(!or.j(c))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new or(c);u.push(No(e,l))}else{var f=bl(n,i,h);u.push(f)}}return new qu(u,o)}(this.Xl,this.firestore.Nc,this.firestore.Nl,c,i,n)},df.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];cc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof r[a]||rc(r[a])||(Ec("Query.onSnapshot",u=r[a],["includeMetadataChanges"]),dc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),rc(r[a])?(s=r[a],r[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(lc("Query.onSnapshot","function",a,r[a]),fc("Query.onSnapshot","function",a+1,r[a+1]),fc("Query.onSnapshot","function",a+2,r[a+2]));var h={next:function(t){r[a]&&r[a](new cf(i.firestore,i.Xl,t,i.kc))},error:r[a+1],complete:r[a+2]};return uf(this.Xl),this.firestore.vl().listen(this.Xl,u,h)},df.prototype.get=function(t){var e=this;cc("Query.get",arguments,0,1),gf("Query.get",t),uf(this.Xl);var n=this.firestore.vl();return(t&&"cache"===t.source?n.ll(this.Xl):n._l(this.Xl,t)).then(function(t){return new cf(e.firestore,e.Xl,t,e.kc)})},df),cf=(Object.defineProperty(pf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"empty",{get:function(){return this.e_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"size",{get:function(){return this.e_.docs.size},enumerable:!1,configurable:!0}),pf.prototype.forEach=function(e,n){var i=this;cc("QuerySnapshot.forEach",arguments,1,2),lc("QuerySnapshot.forEach","function",1,e),this.e_.docs.forEach(function(t){e.call(n,i.i_(t,i.metadata.fromCache,i.e_.qt.has(t.key)))})},Object.defineProperty(pf.prototype,"query",{get:function(){return new hf(this.t_,this.Wl,this.kc)},enumerable:!1,configurable:!0}),pf.prototype.docChanges=function(t){t&&(Ec("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),dc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.e_.Bt)throw new Zi(Ki.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.n_&&this.s_===e||(this.n_=function(r,e,o){if(r.Mt._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Mt;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ci()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.e_,e,this.i_.bind(this)),this.s_=e),this.n_},pf.prototype.isEqual=function(t){if(!(t instanceof pf))throw Ic("isEqual","QuerySnapshot",1,t);return this.Wl===t.Wl&&fu(this.t_,t.t_)&&this.e_.isEqual(t.e_)&&this.kc===t.kc},pf.prototype.i_=function(t,e,n){return new Hl(this.Wl,t.key,t,e,n,this.kc)},pf),lf=(o(ff,af=hf),Object.defineProperty(ff.prototype,"id",{get:function(){return this.Xl.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"parent",{get:function(){var t=this.Xl.path.g();return t._()?null:new Wl(new or(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"path",{get:function(){return this.Xl.path.N()},enumerable:!1,configurable:!0}),ff.prototype.doc=function(t){cc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Mi.t()),lc("CollectionReference.doc","non-empty string",1,t);var e=nr.$(t);return Wl.ql(this.Xl.path.child(e),this.firestore,this.kc)},ff.prototype.add=function(t){ac("CollectionReference.add",arguments,1),lc("CollectionReference.add","object",1,this.kc?this.kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},ff.prototype.withConverter=function(t){return new ff(this.r_,this.firestore,t)},ff);function ff(t,e,n){var i=this;if(((i=af.call(this,ou(t),e,n)||this).r_=t).length%2!=1)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function pf(t,e,n,i){this.Wl=t,this.t_=e,this.e_=n,this.kc=i,this.n_=null,this.s_=null,this.metadata=new zl(n.hasPendingWrites,n.fromCache)}function df(t,e,n){this.Xl=t,this.firestore=e,this.kc=n}function yf(t,e){if(void 0===e)return{merge:!1};if(Ec(t,e,["merge","mergeFields"]),dc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+wc(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof Dc))throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+wc(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function vf(t,e){return void 0===e?{}:(Ec(t,e,["serverTimestamps"]),yc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function gf(t,e){fc(t,"object",1,e),e&&(Ec(t,e,["source"]),yc(t,0,"source",e.source,["default","server","cache"]))}function mf(t,e,n){if(e instanceof tl){if(e.firestore!==n)throw new Zi(Ki.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ic(t,"DocumentReference",1,e)}function wf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var bf,Ef={Firestore:Fl,GeoPoint:Zc,Timestamp:Ji,Blob:Oc,Transaction:Gl,WriteBatch:Bl,DocumentReference:Wl,DocumentSnapshot:$l,Query:hf,QueryDocumentSnapshot:Hl,QuerySnapshot:cf,CollectionReference:lf,FieldPath:Dc,FieldValue:Yc,setLogLevel:Fl.setLogLevel,CACHE_SIZE_UNLIMITED:xl};(bf=i.default).INTERNAL.registerComponent(new Ri("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Fl(e,n,new tc,new ec);var e,n},"PUBLIC").setServiceProps(Object.assign({},Ef))),bf.registerVersion("@firebase/firestore","1.16.6-202072605451")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});