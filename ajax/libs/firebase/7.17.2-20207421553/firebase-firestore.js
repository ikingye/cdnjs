!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Od){"use strict";try{(function(){Od=Od&&Object.prototype.hasOwnProperty.call(Od,"default")?Od.default:Od;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},k=_||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),L=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:V).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++L))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=k.navigator;if(J){var Z=J.userAgent;if(Z){W=Z;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=D;var it,ot,st=X(W,"Opera"),ut=X(W,"Trident")||X(W,"MSIE"),at=X(W,"Edge"),ht=at||ut,ct=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ft=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function lt(){var t=k.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=W,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=k.document&&ut?lt()||(parseInt(it,10)||void 0):void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",D,e),k.removeEventListener("test",D,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},q(Tt,It);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Rt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[At]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[At]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=qt(t);if(h||(t[Ot]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?xt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(xt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):kt(t)))}function Mt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(wt)return Ut(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new Tt(e,this))}function qt(t){return(t=t[Ot])instanceof Dt?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==x(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new Dt(this),(this.J=this).C=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&xt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(Gt,F),Gt.prototype[At]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=k.JSON.stringify;function Kt(){this.b=this.a=null}var Wt,Qt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Yt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Jt(t,e){var n;Wt||(n=k.Promise.resolve(void 0),Wt=function(){n.then(te)}),Zt||(Wt(),Zt=!0),$t.add(t,e)}Kt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Kt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||k,this.f=M(this.Ya,this),this.g=j()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==x(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}q(ee,Gt),(A=ee.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},A.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie,oe,se,ue=(T(oe=he,se=ie=F),oe.prototype=null===se?Object.create(se):(ae.prototype=se.prototype,new ae),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){ie.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ae(){this.constructor=oe}function he(t,e,n){var r=ie.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ce(t){F.call(this),this.b=t,this.a={}}q(ce,F);var fe=[];function le(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Gt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Te(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}q(me,It),q(be,It),q(Ie,It);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}_e.prototype.a=null;var De,xe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Pe(){It.call(this,"d")}function Oe(){It.call(this,"c")}function Re(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ce(this),this.P=Ce,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Pe,It),q(Oe,It),q(Re,_e),De=new Re;var Ce=45e3,Ve={},Me={};function Ue(t,e,n){t.H=1,t.i=sn($e(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Fe(t),t.l=$e(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),wn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(M(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function qe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ve:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ee(14),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ve){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Ee(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ir(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),ze(t))}function Fe(t){t.U=j()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(M(t.Ua,t),e)}function Ge(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ur(t.g,t)}function He(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;sr(p),Xn(p)}rr(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(M(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||sr(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(X(u,"spdy")||X(u,"quic")||X(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Sn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fr(o,o.C?o.ga:null,o.fa),c.C?(kn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Ge(f),Fe(f)),o.a=c):nr(o),0<p.g.length&&Zn(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||r<=0?3:2),Ge(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,f=this.l,l=this.f,p=this.T,d=e,y=i,h.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+p+"]: "+c+"\n"+f+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ee(12),He(this),ze(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,a)}this.I?(qe(this,e,o),ht&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),Ke(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?ur(this.g,this):(this.b=!1,Fe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),He(this),ze(this)}}}catch(t){}var h,c,f,l,p,d,y},A.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),qe(this,t,e),this.b&&4!=t&&Fe(this)))},A.cancel=function(){this.A=!0,He(this)},A.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),He(this),this.h=2,ze(this)):Be(this,this.U-n)},(A=Qe.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Xe(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ze?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=un(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=un(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function $e(t){return new Ze(t)}function tn(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?un(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(vn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},r)),r.f=i):(n||(e=an(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,dn)),t.join("")};var cn=/[#\/\?@]/g,fn=/[#\?:]/g,ln=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function mn(t,e){return vn(t),e=bn(t,e),Ye(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),H(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||Tn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){vn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Sn(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function Pn(){this.a=new xn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Rn=k.JSON.parse;function Ln(t){Gt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}q(Ln,Gt);var Cn="",Vn=/^https?$/i,Mn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),Bn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Je)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",qn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,on(n=$e(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),tr(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=sn($e(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=j(),Fe(e)),cr(t)}function Xn(t){t.a&&(ir(t),t.a.cancel(),t.a=null)}function Yn(t){Xn(t),t.j&&(k.clearTimeout(t.j),t.j=null),sr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Zn(t)}function Zn(t){Nn(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.P),tr(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=er(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sn(t.b,n),Ue(n,r,e)}function tr(t,n){t.f&&We({},function(t,e){on(n,e,t)})}function er(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;O(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function nr(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function rr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(M(t.Aa,t),ar(t,t.o)),t.o++,1)}function ir(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function or(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),tr(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn($e(e)),n.j=null,n.I=!0,je(n,t)}function sr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ur(t,e){var n,r=null;if(t.a==e){sr(t),ir(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=ge()).dispatchEvent(new Ie(i)),Zn(t)):nr(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(M(t.Ba,t,e),ar(t,t.u)),t.u++,1}}(t,e)||2==i&&rr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function ar(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new Ze("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||tn(n,"https"),sn(n)),i=n.toString(),o=r,u=new de,k.Image?((s=new Image).onload=U(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=U(On,u,s,"TestLoadImage: error",!1,o),s.onabort=U(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(On,u,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function fr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Ze?$e(r):new Ze(r,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(i=k.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Ze(null,void 0),o&&tn(h,o),s&&en(h,s),u&&nn(h,u),a&&(h.g=a),c=h),t.W&&$(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),tr(t,c),c}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function pr(){}function dr(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Gt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mr(this)}function vr(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Oe.call(this),this.status=1}function mr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(De),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,ut&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Fn(this):this.Ta())},A.Ta=function(){Fn(this)},A.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Wn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=er(this,n,e),on(i=$e(this.B),"RID",t),on(i,"CVER",22),this.A&&on(i,"X-HTTP-Session-Id",this.A),tr(this,i),this.i&&r&&Hn(i,this.i,r),Sn(this.b,n),this.Ga&&on(i,"TYPE","init"),this.da?(on(i,"$req",e),on(i,"SID","null"),n.V=!0,Ue(n,i,null)):Ue(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||Nn(this.b)||$n(this))},A.Aa=function(){var t;this.j=null,or(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(M(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),or(this))},A.Ra=function(){null!=this.m&&(this.m=null,Xn(this),rr(this),Ee(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(A=pr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},dr.prototype.a=function(t,e){return new yr(t,e)},q(yr,Gt),(A=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=fr(t,null,t.fa),Zn(t)},A.close=function(){Qn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Ht(t),Jn(this.a,e)):Jn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,yr.S.G.call(this)},q(vr,Pe),q(gr,Oe),q(mr,pr),mr.prototype.ta=function(){this.a.dispatchEvent("a")},mr.prototype.sa=function(t){this.a.dispatchEvent(new vr(t))},mr.prototype.ra=function(t){this.a.dispatchEvent(new gr)},mr.prototype.qa=function(){this.a.dispatchEvent("b")},dr.prototype.createWebChannel=dr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Ae.COMPLETE="complete",(ke.EventType=xe).OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var wr={createWebChannelTransport:function(){return new dr},ErrorCode:Ne,EventType:Ae,WebChannel:ke,XhrIo:Ln},br=wr.createWebChannelTransport,Er=wr.ErrorCode,Ir=wr.EventType,Tr=wr.WebChannel,Nr=wr.XhrIo,Ar=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Sr="7.17.2-20207421553",kr=new c("@firebase/firestore");function Dr(){return kr.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.DEBUG&&(e=n.map(Rr),kr.debug.apply(kr,i(["Firestore ("+Sr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.ERROR&&(e=n.map(Rr),kr.error.apply(kr,i(["Firestore ("+Sr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.WARN&&(e=n.map(Rr),kr.warn.apply(kr,i(["Firestore ("+Sr+"): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Sr+") INTERNAL ASSERTION FAILED: "+t;throw Pr(e),new Error(e)}function Cr(t){t||Lr()}var Vr=(Mr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Mr);function Mr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function qr(t){return t+"\0"}function Fr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Br=(Object.defineProperty(Gr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gr.prototype.isEqual=function(t){return t instanceof Gr&&t.projectId===this.projectId&&t.database===this.database},Gr.prototype.o=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},Gr);function Gr(t,e){this.projectId=t,this.database=e||"(default)"}function zr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wr,Qr,Xr,Yr=(pi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},pi.prototype.has=function(t){return void 0!==this.get(t)},pi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},pi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},pi.prototype.forEach=function(u){Hr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},pi.prototype._=function(){return Kr(this.l)},pi),Jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Zr=(n(li,Xr=Error),li),$r=(fi.now=function(){return fi.fromMillis(Date.now())},fi.fromDate=function(t){return fi.fromMillis(t.getTime())},fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new fi(e,1e6*(t-1e3*e))},fi.prototype.toDate=function(){return new Date(this.toMillis())},fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},fi.prototype.T=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},fi),ti=(ci.I=function(t){return new ci(t)},ci.min=function(){return new ci(new $r(0,0))},ci.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ci.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ci.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ci.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ci.prototype.A=function(){return this.timestamp},ci),ei=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.P(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},hi.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},hi.prototype.v=function(){return this.segments[this.offset]},hi.prototype.S=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype._=function(){return 0===this.length},hi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},hi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ni=(n(ai,Qr=ei),ai.prototype.g=function(t,e,n){return new ai(t,e,n)},ai.prototype.N=function(){return this.F().join("/")},ai.prototype.toString=function(){return this.N()},ai.k=function(t){if(0<=t.indexOf("//"))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ai(t.split("/").filter(function(t){return 0<t.length}))},ai.$=function(){return new ai([])},ai),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=(n(ui,Wr=ei),ui.prototype.g=function(t,e,n){return new ui(t,e,n)},ui.M=function(t){return ri.test(t)},ui.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ui.M(t)||(t="`"+t+"`"),t}).join(".")},ui.prototype.toString=function(){return this.N()},ui.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},ui.L=function(){return new ui(["__name__"])},ui.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Zr(Jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Zr(Jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Zr(Jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ui(e)},ui.$=function(){return new ui([])},ui),oi=(si.B=function(t){return new si(ni.k(t).V(5))},si.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},si.prototype.isEqual=function(t){return null!==t&&0===ni.P(this.path,t.path)},si.prototype.toString=function(){return this.path.toString()},si.P=function(t,e){return ni.P(t.path,e.path)},si.W=function(t){return t.length%2==0},si.j=function(t){return new si(new ni(t.slice()))},si);function si(t){this.path=t}function ui(){return null!==Wr&&Wr.apply(this,arguments)||this}function ai(){return null!==Qr&&Qr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.R=n}function ci(t){this.timestamp=t}function fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function li(t,e){var n=this;return(n=Xr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function pi(t,e){this.h=t,this.u=e,this.l={}}function di(t){return null==t}function yi(t){return-0===t&&1/t==-1/0}function vi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+Io(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),di(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Wu(n.startAt)),n.endAt&&(e+="|ub:",e+=Wu(n.endAt)),n.K=e),n.K}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xu(t.startAt,e.startAt)&&Xu(t.endAt,e.endAt)}function Ei(t){return oi.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ti.fromBase64String=function(t){return new Ti(atob(t))},Ti.fromUint8Array=function(t){return new Ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ti.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ti.prototype.H=function(){return 2*this.G.length},Ti.prototype.o=function(t){return Ur(this.G,t.G)},Ti.prototype.isEqual=function(t){return this.G===t.G},Ti);function Ti(t){this.G=t}Ii.Y=new Ii("");function Ni(t){this.count=t}var Ai,_i,Si=(ki.prototype.Z=function(t){return new ki(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ki.prototype.tt=function(t,e){return new ki(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ki.prototype.et=function(t){return new ki(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},ki);function ki(t,e,n,r,i,o,s){void 0===i&&(i=ti.min()),void 0===o&&(o=ti.min()),void 0===s&&(s=Ii.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Di(t){switch(t){case Jr.OK:return Lr(),0;case Jr.CANCELLED:case Jr.UNKNOWN:case Jr.DEADLINE_EXCEEDED:case Jr.RESOURCE_EXHAUSTED:case Jr.INTERNAL:case Jr.UNAVAILABLE:case Jr.UNAUTHENTICATED:return;case Jr.INVALID_ARGUMENT:case Jr.NOT_FOUND:case Jr.ALREADY_EXISTS:case Jr.PERMISSION_DENIED:case Jr.FAILED_PRECONDITION:case Jr.ABORTED:case Jr.OUT_OF_RANGE:case Jr.UNIMPLEMENTED:case Jr.DATA_LOSS:return 1;default:return Lr(),0}}function xi(t){if(void 0===t)return Pr("GRPC error has no .code"),Jr.UNKNOWN;switch(t){case Ai.OK:return Jr.OK;case Ai.CANCELLED:return Jr.CANCELLED;case Ai.UNKNOWN:return Jr.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return Jr.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return Jr.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return Jr.INTERNAL;case Ai.UNAVAILABLE:return Jr.UNAVAILABLE;case Ai.UNAUTHENTICATED:return Jr.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return Jr.INVALID_ARGUMENT;case Ai.NOT_FOUND:return Jr.NOT_FOUND;case Ai.ALREADY_EXISTS:return Jr.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return Jr.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return Jr.FAILED_PRECONDITION;case Ai.ABORTED:return Jr.ABORTED;case Ai.OUT_OF_RANGE:return Jr.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return Jr.UNIMPLEMENTED;case Ai.DATA_LOSS:return Jr.DATA_LOSS;default:return Lr()}}(_i=Ai=Ai||{})[_i.OK=0]="OK",_i[_i.CANCELLED=1]="CANCELLED",_i[_i.UNKNOWN=2]="UNKNOWN",_i[_i.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_i[_i.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_i[_i.NOT_FOUND=5]="NOT_FOUND",_i[_i.ALREADY_EXISTS=6]="ALREADY_EXISTS",_i[_i.PERMISSION_DENIED=7]="PERMISSION_DENIED",_i[_i.UNAUTHENTICATED=16]="UNAUTHENTICATED",_i[_i.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_i[_i.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_i[_i.ABORTED=10]="ABORTED",_i[_i.OUT_OF_RANGE=11]="OUT_OF_RANGE",_i[_i.UNIMPLEMENTED=12]="UNIMPLEMENTED",_i[_i.INTERNAL=13]="INTERNAL",_i[_i.UNAVAILABLE=14]="UNAVAILABLE",_i[_i.DATA_LOSS=15]="DATA_LOSS";var Pi=(Vi.prototype.nt=function(t,e){return new Vi(this.P,this.root.nt(t,e,this.P).copy(null,null,Ri.st,null,null))},Vi.prototype.remove=function(t){return new Vi(this.P,this.root.remove(t,this.P).copy(null,null,Ri.st,null,null))},Vi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vi.prototype._=function(){return this.root._()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vi.prototype.it=function(){return this.root.it()},Vi.prototype.rt=function(){return this.root.rt()},Vi.prototype.ot=function(t){return this.root.ot(t)},Vi.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Vi.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vi.prototype.ht=function(t){return this.root.ht(t)},Vi.prototype.at=function(){return new Oi(this.root,null,this.P,!1)},Vi.prototype.ut=function(t){return new Oi(this.root,t,this.P,!1)},Vi.prototype.ct=function(){return new Oi(this.root,null,this.P,!0)},Vi.prototype.lt=function(t){return new Oi(this.root,t,this.P,!0)},Vi),Oi=(Ci.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ci.prototype.wt=function(){return 0<this.ft.length},Ci.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ci),Ri=(Li.prototype.copy=function(t,e,n,r,i){return new Li(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Li.prototype._=function(){return!1},Li.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Li.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Li.prototype.min=function(){return this.left._()?this:this.left.min()},Li.prototype.it=function(){return this.min().key},Li.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Li.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Li.prototype.It=function(){if(this.left._())return Li.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Li.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return Li.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Li.prototype.At=function(){return this.color},Li.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Li.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},Li.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Li.prototype.Vt=function(){var t=this.copy(null,null,Li.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Li.prototype.Pt=function(){var t=this.copy(null,null,Li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Li.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Li.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Li.prototype.bt=function(){if(this.At()&&this.left.At())throw Lr();if(this.right.At())throw Lr();var t=this.left.bt();if(t!==this.right.bt())throw Lr();return t+(this.At()?0:1)},Li);function Li(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Li.RED,this.left=null!=r?r:Li.EMPTY,this.right=null!=i?i:Li.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Vi(t,e){this.P=t,this.root=e||Ri.EMPTY}function Mi(){this.size=0}Ri.EMPTY=null,Ri.RED=!0,Ri.st=!1,Ri.EMPTY=(Object.defineProperty(Mi.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Mi.prototype.copy=function(t,e,n,r,i){return this},Mi.prototype.nt=function(t,e,n){return new Ri(t,e)},Mi.prototype.remove=function(t,e){return this},Mi.prototype._=function(){return!0},Mi.prototype.ot=function(t){return!1},Mi.prototype.ht=function(t){return!1},Mi.prototype.it=function(){return null},Mi.prototype.rt=function(){return null},Mi.prototype.At=function(){return!1},Mi.prototype.pt=function(){return!0},Mi.prototype.bt=function(){return 0},new Mi);var Ui=(Bi.prototype.has=function(t){return null!==this.data.get(t)},Bi.prototype.first=function(){return this.data.it()},Bi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Bi.prototype.indexOf=function(t){return this.data.indexOf(t)},Bi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Bi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Bi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Bi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Bi.prototype.at=function(){return new ji(this.data.at())},Bi.prototype.ut=function(t){return new ji(this.data.ut(t))},Bi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Bi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Bi.prototype._=function(){return this.data._()},Bi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Bi.prototype.isEqual=function(t){if(!(t instanceof Bi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Bi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Bi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Bi.prototype.copy=function(t){var e=new Bi(this.P);return e.data=t,e},Bi),ji=(Fi.prototype.dt=function(){return this.Ft.dt().key},Fi.prototype.wt=function(){return this.Ft.wt()},Fi),qi=new Pi(oi.P);function Fi(t){this.Ft=t}function Bi(t){this.P=t,this.data=new Pi(this.P)}var Gi=new Pi(oi.P);var zi=new Pi(oi.P),Hi=new Ui(oi.P);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Ui(Ur);function Qi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Xi(t,e){this.targetId=t,this.ee=e}function Yi(t,e,n,r){void 0===n&&(n=Ii.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Ji=(co.$t=function(t){return new co(t.P)},co.prototype.has=function(t){return null!=this.Nt.get(t)},co.prototype.get=function(t){return this.Nt.get(t)},co.prototype.first=function(){return this.kt.it()},co.prototype.last=function(){return this.kt.rt()},co.prototype._=function(){return this.kt._()},co.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.kt.nt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.kt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.P=this.P,n.Nt=t,n.kt=e,n},co),Zi=(ho.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Lr()},ho.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ho),$i=(ao.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Ji.$t(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&Tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),to=(uo.Gt=function(t,e){var n=new Map;return n.set(t,eo.zt(t,e)),new uo(ti.min(),n,Wi,qi,Ki())},uo),eo=(so.zt=function(t,e){return new so(Ii.Y,e,Ki(),Ki(),Ki())},so),no=(Object.defineProperty(oo.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),oo.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},oo.prototype.ce=function(){var n=Ki(),r=Ki(),i=Ki();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new eo(this.ie,this.re,n,r,i)},oo.prototype.le=function(){this.oe=!1,this.se=lo()},oo.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},oo.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},oo.prototype.de=function(){this.ne+=1},oo.prototype.we=function(){--this.ne},oo.prototype.Te=function(){this.oe=!0,this.re=!0},oo),ro=(io.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof su?this.ge(r,t.te):t.te instanceof uu&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},io.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Lr()}})},io.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},io.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(Ei(e=o.target)?0===i?(n=new oi(e.path),this.Ve(r,n,new uu(n,ti.min()))):Cr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},io.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&Ei(r.target)&&(n=new oi(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.Ve(e,n,new uu(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Ki();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new to(i,s,this.Re,this.me,r);return this.me=qi,this.Ae=fo(),this.Re=new Ui(Ur),t},io.prototype.ge=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.$e(e.key).add(t)))},io.prototype.Ve=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.$e(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},io.prototype.removeTarget=function(t){this.Ie.delete(t)},io.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},io.prototype.de=function(t){this.be(t).de()},io.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new no,this.Ie.set(t,e)),e},io.prototype.$e=function(t){var e=this.Ae.get(t);return e||(e=new Ui(Ur),this.Ae=this.Ae.nt(t,e)),e},io.prototype.ve=function(t){var e=null!==this.Ce(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},io.prototype.Se=function(e){var n=this;this.Ie.set(e,new no),this.Ee.xe(e).forEach(function(t){n.Ve(e,t,null)})},io.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},io);function io(t){this.Ee=t,this.Ie=new Map,this.me=qi,this.Ae=fo(),this.Re=new Ui(Ur)}function oo(){this.ne=0,this.se=lo(),this.ie=Ii.Y,this.re=!1,this.oe=!0}function so(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function uo(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function ho(){this.xt=new Pi(oi.P)}function co(n){this.P=n?function(t,e){return n(t,e)||oi.P(t.key,e.key)}:function(t,e){return oi.P(t.key,e.key)},this.Nt=Gi,this.kt=new Pi(this.P)}function fo(){return new Pi(oi.P)}function lo(){return new Pi(oi.P)}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yo(t){var e=To(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Lr()}function mo(r,i){var t,e,n,o=go(r);if(o!==go(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yo(r).isEqual(yo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),n=To(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Ao(r.bytesValue).isEqual(Ao(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,No((t=r).geoPointValue.latitude)===No(e.geoPointValue.latitude)&&No(t.geoPointValue.longitude)===No(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return No(t.integerValue)===No(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=No(t.doubleValue),r=No(e.doubleValue);return n===r?yi(n)===yi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return jr(r.arrayValue.values||[],i.arrayValue.values||[],mo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(zr(t)!==zr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!mo(t[n],e[n])))return!1;return!0}();default:return Lr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i,o,s,u,a,h,c,f,l=go(t),p=go(e);if(l!==p)return Ur(l,p);switch(l){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return h=e,c=No(t.integerValue||t.doubleValue),f=No(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Eo(t.timestampValue,e.timestampValue);case 4:return Eo(yo(t),yo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ur(No(n.latitude),No(r.latitude)))?i:Ur(No(n.longitude),No(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;var a=bo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function Eo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=To(t),r=To(e),i=Ur(n.seconds,r.seconds);return 0!==i?i:Ur(n.nanos,r.nanos)}function Io(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=To(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ao(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,oi.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Lr();var t,e,n}(t)}function To(t){if(Cr(!!t),"string"!=typeof t)return{seconds:No(t.seconds),nanos:No(t.nanos)};var e,n=0,r=vo.exec(t);Cr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function No(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function _o(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function So(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Ro={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Oe=e};function Co(t){return{integerValue:""+t}}function Vo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function Mo(t,e){return vi(e)?Co(e):Vo(t,e)}function Uo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function jo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function qo(t){return Cr(!!t),ti.I((e=To(t),new $r(e.seconds,e.nanos)));var e}function Fo(t,e){return new ni(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Bo(t){var e=ni.k(t);return Cr(is(e)),e}function Go(t,e){return Fo(t.s,e.path)}function zo(t,e){var n=Bo(e);return Cr(n.get(1)===t.s.projectId),Cr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new oi(Qo(n))}function Ho(t,e){return Fo(t.s,e)}function Ko(t){var e=Bo(t);return 4===e.length?ni.$():Qo(e)}function Wo(t){return new ni(["projects",t.s.projectId,"databases",t.s.database]).N()}function Qo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Xo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i,o,s,u;if(e instanceof Ms)n={update:Xo(t,e.key,e.value)};else if(e instanceof Qs)n={delete:Go(t,e.key)};else if(e instanceof Us)n={update:Xo(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.N(),increment:e.qe};throw Lr()})}};else{if(!(e instanceof Xs))return Lr();n={verify:Go(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:(s=t,u=o.updateTime,Uo(s,u.A()))}:void 0!==o.exists?{exists:o.exists}:Lr()),n}function Jo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ss.updateTime(qo(n.updateTime)):void 0!==n.exists?Ss.exists(n.exists):Ss.We():Ss.We();if(t.update){t.update.name;var o=zo(e,t.update.name),s=new Ys({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ts(r.map(function(t){return ii.q(t)})));return new Us(o,s,u,i)}return new Ms(o,s,i)}if(t.delete){var a=zo(e,t.delete);return new Qs(a,i)}if(t.transform){var h=zo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),i=new hs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new cs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ys(r)):"increment"in e?i=new ws(t,e.increment):Lr();var o=ii.q(e.fieldPath);return new Ns(o,i)}(e,t)});return Cr(!0===i.exists),new Gs(h,c)}if(t.verify){var f=zo(e,t.verify);return new Xs(f,i)}return Lr()}function Zo(t,e){return{documents:[Ho(t,e.path)]}}function $o(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ho(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ho(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,Ro[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ns((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||di(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=ts(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ts(e.endAt)),n}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,n=t.values||[];return new Fu(n,e)}function ns(t){return{fieldPath:t.N()}}function rs(t){return ii.q(t.fieldPath)}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function os(){this.Qe=void 0}function ss(t,e){return t instanceof ws?So(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var us,as,hs=(n(ls,as=os),ls),cs=(n(fs,us=os),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(n(vs,ds=os),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(n(bs,ms=os),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).serializer=t,n.qe=e,n}function Es(t){return No(t.integerValue||t.doubleValue)}function Is(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ts=(As.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},As.prototype.isEqual=function(t){return jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As),Ns=function(t,e){this.field=t,this.transform=e};function As(t){(this.fields=t).sort(ii.P)}function _s(t,e){this.version=t,this.transformResults=e}var Ss=(ks.We=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof su&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof su}function xs(){}function Ps(t,e,n){return t instanceof Ms?new su(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Us?function(t,e,n){if(!Ds(t.Ue,e))return new au(t.key,n.version);var r=Fs(t,e);return new su(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Cr(null!=n.transformResults),!Ds(t.Ue,e))return new au(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof su&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof cs?ps(i,o):i instanceof ys?gs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Hs(t,r.data(),i);return new su(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new uu(t.key,n.version,{hasCommittedMutations:!0})}function Os(t,e,n,r){return t instanceof Ms?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e);return new su(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Us?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e),r=Fs(t,e);return new su(t.key,n,r,{Ke:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!Ds(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c,f=[],l=0,p=t;l<p.length;l++){var d=p[l],y=d.transform,v=null;n instanceof su&&(v=n.field(d.field)),null===v&&r instanceof su&&(v=r.field(d.field)),f.push((o=v,s=e,c=h=a=u=void 0,(i=y)instanceof hs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof cs?ps(i,o):i instanceof ys?gs(i,o):(a=ss(u=i,o),h=Es(a)+Es(u.qe),So(a)&&So(u.qe)?Co(h):Vo(u.serializer,h))))}return f}(t.fieldTransforms,n,e,r),s=Hs(t,i.data(),o);return new su(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ds((i=t).Ue,o)?new uu(i.key,ti.min()):o);var i,o}function Rs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||jr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof cs&&o instanceof cs||i instanceof ys&&o instanceof ys?jr(i.elements,o.elements,mo):i instanceof ws&&o instanceof ws?mo(i.qe,o.qe):i instanceof hs&&o instanceof hs);var n,r,i,o}))}function Ls(t){return t instanceof su?t.version:ti.min()}var Cs,Vs,Ms=(n(qs,Vs=xs),qs),Us=(n(js,Cs=xs),js);function js(t,e,n,r){var i=this;return(i=Cs.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function qs(t,e,n){var r=this;return(r=Vs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Fs(t,e){return n=t,r=e instanceof su?e.data():Ys.empty(),i=new Js(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var Bs,Gs=(n(zs,Bs=xs),zs);function zs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=Ss.exists(!0),n}function Hs(t,e,n){for(var r=new Js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Ks,Ws,Qs=(n(eu,Ws=xs),eu),Xs=(n(tu,Ks=xs),tu),Ys=($s.empty=function(){return new $s({mapValue:{}})},$s.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},$s.prototype.isEqual=function(t){return mo(this.proto,t.proto)},$s),Js=(Zs.prototype.set=function(t,e){return this.Ye(t,e),this},Zs.prototype.delete=function(t){return this.Ye(t,null),this},Zs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Zs.prototype.Ge=function(){var t=this.Je(ii.$(),this.He);return null!=t?new Ys(t):this.ze},Zs.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Zs);function Zs(t){void 0===t&&(t=Ys.empty()),this.ze=t,this.He=new Map}function $s(t){this.proto=t}function tu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ue=e,n.type=4,n}function eu(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.Ue=e,n.type=3,n}function nu(t,e){this.key=t,this.version=e}var ru,iu,ou,su=(n(fu,ou=nu),fu.prototype.field=function(t){return this.Xe.field(t)},fu.prototype.data=function(){return this.Xe},fu.prototype.Ze=function(){return this.Xe.proto},fu.prototype.isEqual=function(t){return t instanceof fu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},fu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu),uu=(n(cu,iu=nu),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),au=(n(hu,ru=nu),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu);function hu(){return null!==ru&&ru.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=iu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function fu(t,e,n,r){var i=this;return(i=ou.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function lu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Zr(Jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Zr(Jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var pu=(du.prototype.rn=function(t){return new du(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},du.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},du.prototype.hn=function(){return!di(this.limit)&&"F"===this.en},du.prototype.an=function(){return!di(this.limit)&&"L"===this.en},du.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},du.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},du.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},du);function du(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function yu(t,e,n,r,i,o,s,u){return new pu(t,e,n,r,i,o,s,u)}function vu(t){return new pu(t)}function gu(t){return null!==t.collectionGroup}function mu(t){var e=lu(t,pu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Yu(n)),e.nn.push(new Yu(ii.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Yu(ii.L(),i)))}}return e.nn}function wu(t){var e=lu(t,pu);if(!e.sn)if("F"===e.en)e.sn=mi(e.path,e.collectionGroup,mu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=mu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Yu(o.field,s))}var u=e.endAt?new Fu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Fu(e.startAt.position,!e.startAt.before):null;e.sn=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function bu(t,e,n){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function Iu(t,e){return new pu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function Tu(t,e){return bi(wu(t),wu(e))&&t.en===e.en}function Nu(t){return wi(wu(t))+"|lt:"+t.en}function Au(t){return"Query(target="+(e=wu(t),n=e.path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+Io(e.value);var e}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Wu(e.startAt)),e.endAt&&(n+=", endAt: "+Wu(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function _u(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):oi.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Qu(e.startAt,mu(e),n))&&(!e.endAt||!Qu(e.endAt,mu(e),n)));var e,n,r,o}function Su(u){return function(t,e){for(var n=!1,r=0,i=mu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.O()?oi.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?bo(n,r):Lr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var ku,Du=(n(xu,ku=function(){}),xu.create=function(t,e,n){if(t.O())return"in"===e?new Mu(t,n):new Vu(t,e,n);if(Do(n)){if("=="!==e)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new xu(t,e,n)}if(xo(n)){if("=="!==e)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new xu(t,e,n)}return"array-contains"===e?new Uu(t,n):"in"===e?new ju(t,n):"array-contains-any"===e?new qu(t,n):new xu(t,e,n)},xu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value)===go(e)&&this.fn(bo(e,this.value))},xu.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},xu.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},xu);function xu(t,e,n){var r=this;return(r=ku.call(this)||this).field=t,r.op=e,r.value=n,r}var Pu,Ou,Ru,Lu,Cu,Vu=(n(Ku,Cu=Du),Ku.prototype.matches=function(t){var e=oi.P(t.key,this.key);return this.fn(e)},Ku),Mu=(n(Hu,Lu=Du),Hu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Hu),Uu=(n(zu,Ru=Du),zu.prototype.matches=function(t){var e=t.field(this.field);return ko(e)&&wo(e.arrayValue,this.value)},zu),ju=(n(Gu,Ou=Du),Gu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&wo(this.value.arrayValue,e)},Gu),qu=(n(Bu,Pu=Du),Bu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},Bu),Fu=function(t,e){this.position=t,this.before=e};function Bu(t,e){return Pu.call(this,t,"array-contains-any",e)||this}function Gu(t,e){return Ou.call(this,t,"in",e)||this}function zu(t,e){return Ru.call(this,t,"array-contains",e)||this}function Hu(t,e){var n=this;return(n=Lu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return oi.B(t.referenceValue)}),n}function Ku(t,e,n){var r=this;return(r=Cu.call(this,t,e,n)||this).key=oi.B(n.referenceValue),r}function Wu(t){return(t.before?"b":"a")+":"+t.position.map(Io).join(",")}function Qu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?oi.P(oi.B(s.referenceValue),n.key):bo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Xu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var Yu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Ju=(pa.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ps(o,e,r[i]))}return e},pa.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Os(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Os(a,e,o,this.dn))}return e},pa.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},pa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},pa.prototype.isEqual=function(t){return this.batchId===t.batchId&&jr(this.mutations,t.mutations,Rs)&&jr(this.baseMutations,t.baseMutations,Rs)},pa),Zu=(la.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new la(t,e,n,r)},la),$u=(fa.prototype.catch=function(t){return this.next(void 0,t)},fa.prototype.next=function(r,i){var o=this;return this.Vn&&Lr(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new fa(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},fa.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},fa.prototype.vn=function(t){try{var e=t();return e instanceof fa?e:fa.resolve(e)}catch(t){return fa.reject(t)}},fa.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):fa.resolve(e)},fa.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):fa.reject(e)},fa.resolve=function(n){return new fa(function(t,e){t(n)})},fa.reject=function(n){return new fa(function(t,e){e(n)})},fa.Sn=function(t){return new fa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},fa.Dn=function(t){for(var n=fa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?fa.resolve(t):e()})}(r[e]);return n},fa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},fa),ta=(Object.defineProperty(ca.prototype,"readTime",{get:function(){return this.Nn},set:function(t){this.Nn=t},enumerable:!1,configurable:!0}),ca.prototype.kn=function(t,e){this.$n(),this.readTime=e,this.Cn.set(t.key,t)},ca.prototype.xn=function(t,e){this.$n(),e&&(this.readTime=e),this.Cn.set(t,null)},ca.prototype.Mn=function(t,e){this.$n();var n=this.Cn.get(e);return void 0!==n?$u.resolve(n):this.On(t,e)},ca.prototype.getEntries=function(t,e){return this.Ln(t,e)},ca.prototype.apply=function(t){return this.$n(),this.Fn=!0,this.qn(t)},ca.prototype.$n=function(){},ca),ea="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",na=(ha.prototype.Un=function(t){this.Bn.push(t)},ha.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},ha),ra=(aa.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},aa.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},aa.prototype.Yn=function(t,e,i){var o=qi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},aa.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},aa.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=qi;return e.forEach(function(t,e){e=e||new uu(t,ti.min()),n=n.nt(t,e)}),n})},aa.prototype.ts=function(t,e,n){return r=e,oi.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):gu(e)?this.ns(t,e,n):this.ss(t,e,n);var r},aa.prototype.es=function(t,e){return this.Gn(t,new oi(e)).next(function(t){var e=Gi;return t instanceof su&&(e=e.nt(t.key,t)),e})},aa.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=Gi;return this.Kn.rs(n,s).next(function(t){return $u.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},aa.prototype.ss=function(e,n,t){var c,f,r=this;return this.Qn.ts(e,n,t).next(function(t){return c=t,r.jn.os(e,n)}).next(function(t){return f=t,r.hs(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Os(s,a,a,r.dn);c=h instanceof su?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){_u(n,e)||(c=c.remove(t))}),c})},aa.prototype.hs=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Us&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof su&&(h=h.nt(t,e))}),h})},aa),ia=(ua.cs=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ua(t,e.fromCache,n,r)},ua),oa=(sa.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},sa.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},sa);function sa(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function ua(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function aa(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function ha(){this.Bn=[]}function ca(){this.Cn=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function fa(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function la(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function pa(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}oa.ws=-1;function da(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ya=(va.prototype.reset=function(){this.Rs=0},va.prototype.Vs=function(){this.Rs=this.As},va.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},va.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},va.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},va.prototype.ps=function(){return(Math.random()-.5)*this.Rs},va);function va(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function ga(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ma(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return ma(e)}function ma(t){return t+""}function wa(t){var e=t.length;if(Cr(2<=e),2===e)return Cr(""===t.charAt(0)&&""===t.charAt(1)),ni.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new ni(r)}var ba=(Aa.prototype.Cs=function(t,e){return this.Ds.add(e),$u.resolve()},Aa.prototype.rs=function(t,e){return $u.resolve(this.Ds.getEntries(e))},Aa),Ea=(Na.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Ui(ni.P),i=!r.has(n);return this.index[e]=r.add(n),i},Na.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Na.prototype.getEntries=function(t){return(this.index[t]||new Ui(ni.P)).F()},Na),Ia=(Ta.prototype.Cs=function(t,e){var n=this;if(this.Fs.has(e))return $u.resolve();var r=e.S(),i=e.p();t.Un(function(){n.Fs.add(e)});var o={collectionId:r,parent:ga(i)};return _a(t).put(o)},Ta.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[qr(i),""],!1,!0);return _a(t).Ns(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(wa(r.parent))}return o})},Ta);function Ta(){this.Fs=new Ea}function Na(){this.index={}}function Aa(){this.Ds=new Ea}function _a(t){return eh.ks(t,Rh.store)}var Sa=function(t){this.$s=t};function ka(t,e){if(e.document)return n=t.$s,r=e.document,i=!!e.hasCommittedMutations,o=zo(n,r.name),s=qo(r.updateTime),u=new Ys({mapValue:{fields:r.fields}}),new su(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=oi.j(e.noDocument.path),h=Ra(e.noDocument.readTime);return new uu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=oi.j(e.unknownDocument.path),f=Ra(e.unknownDocument.version);return new au(c,f)}return Lr()}function Da(t,e,n){var r,i,o=xa(n),s=e.key.path.p().F();if(e instanceof su){var u={name:Go(r=t.$s,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Uo(r,i.version.A())},a=e.hasCommittedMutations;return new kh(null,null,u,a,o,s)}if(e instanceof uu){var h=e.key.path.F(),c=Oa(e.version),f=e.hasCommittedMutations;return new kh(null,new _h(h,c),null,f,o,s)}if(e instanceof au){var l=e.key.path.F(),p=Oa(e.version);return new kh(new Sh(l,p),null,null,!0,o,s)}return Lr()}function xa(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Pa(t){var e=new $r(t[0],t[1]);return ti.I(e)}function Oa(t){var e=t.A();return new wh(e.seconds,e.nanoseconds)}function Ra(t){var e=new $r(t.seconds,t.nanoseconds);return ti.I(e)}function La(e,t){var n=(t.baseMutations||[]).map(function(t){return Jo(e.$s,t)}),r=t.mutations.map(function(t){return Jo(e.$s,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new Ju(t.batchId,i,n,r)}function Ca(t){var e,n=Ra(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?Ra(t.lastLimboFreeSnapshotVersion):ti.min(),i=void 0!==t.query.documents?(Cr(1===(e=t.query).documents.length),wu(vu(Ko(e.documents[0])))):function(t){var e,n=Ko(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Cr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return Du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return Du.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Du.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Lr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Yu(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(a=r.limit,c=di(h="object"==typeof a?a.value:a)?null:h);var f=null;r.startAt&&(f=es(r.startAt));var l=null;return r.endAt&&(l=es(r.endAt)),wu(yu(n,o,u,s,c,"F",f,l))}(t.query);return new Si(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ii.fromBase64String(t.resumeToken))}function Va(t,e){var n=Oa(e.X),r=Oa(e.lastLimboFreeSnapshotVersion),i=(Ei(e.target)?Zo:$o)(t.$s,e.target),o=e.resumeToken.toBase64();return new xh(e.targetId,wi(e.target),n,o,e.sequenceNumber,r,i)}var Ma,Ua=(ja.prototype.kn=function(t,e,n){return Fa(t).put(Ba(e),n)},ja.prototype.xn=function(t,e){var n=Fa(t),r=Ba(e);return n.delete(r)},ja.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.xs(e,t)})},ja.prototype.Mn=function(t,e){var n=this;return Fa(t).get(Ba(e)).next(function(t){return n.Ms(t)})},ja.prototype.Os=function(t,e){var n=this;return Fa(t).get(Ba(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:Ga(t)}:null})},ja.prototype.getEntries=function(t,e){var r=this,i=qi;return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},ja.prototype.Bs=function(t,e){var r=this,i=qi,o=new Pi(oi.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,Ga(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},ja.prototype.qs=function(t,e,i){if(e._())return $u.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return Fa(t).Qs({range:n},function(t,e,n){for(var r=oi.j(t);s&&oi.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},ja.prototype.ts=function(t,i,e){var n,r,o,s=this,u=Gi,a=i.path.length+1,h={};return e.isEqual(ti.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=xa(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=kh.collectionReadTimeIndex),Fa(t).Qs(h,function(t,e,n){var r;t.length===a&&(r=ka(s.serializer,e),i.path.D(r.key.path)?r instanceof su&&_u(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},ja.prototype.Ks=function(t,e){var r=this,i=qi,o=xa(e),n=Fa(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:kh.readTimeIndex,range:s},function(t,e){var n=ka(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:Pa(o)}})},ja.prototype.zs=function(t){var e=Fa(t),r=ti.min();return e.Qs({index:kh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Pa(e.readTime)),n.done()}).next(function(){return r})},ja.prototype.Hs=function(t){return new ja.Ys(this,!!t&&t.Js)},ja.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},ja.prototype.getMetadata=function(t){return qa(t).get(Dh.key).next(function(t){return Cr(!!t),t})},ja.prototype.xs=function(t,e){return qa(t).put(Dh.key,e)},ja.prototype.Ms=function(t){if(t){var e=ka(this.serializer,t);return e instanceof uu&&e.version.isEqual(ti.min())?null:e}return null},ja);function ja(t,e){this.serializer=t,this.Kn=e}function qa(t){return eh.ks(t,Dh.store)}function Fa(t){return eh.ks(t,kh.store)}function Ba(t){return t.path.F()}function Ga(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}function za(t,e){var n=this;return(n=Ma.call(this)||this).Zs=t,n.Js=e,n.ti=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ua.Ys=(n(za,Ma=ta),za.prototype.qn=function(s){var u=this,a=[],h=0,c=new Ui(function(t,e){return Ur(t.N(),e.N())});return this.Cn.forEach(function(t,e){var n,r,i,o=u.ti.get(t);e?(n=Da(u.Zs.serializer,e,u.readTime),c=c.add(t.path.p()),r=Ga(n),h+=r-o,a.push(u.Zs.kn(s,t,n))):(h-=o,u.Js?(i=Da(u.Zs.serializer,new uu(t,ti.min()),u.readTime),a.push(u.Zs.kn(s,t,i))):a.push(u.Zs.xn(s,t)))}),c.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,h)),$u.Sn(a)},za.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},za.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},za);var Ha=(Qa.prototype.next=function(){return this.ei+=2,this.ei},Qa.ni=function(){return new Qa(0)},Qa.si=function(){return new Qa(-1)},Qa),Ka=(Wa.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new Ha(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},Wa.prototype.ai=function(t){return this.oi(t).next(function(t){return ti.I(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Wa.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},Wa.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},Wa.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},Wa.prototype.di=function(t,e){return this._i(t,e)},Wa.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Xa(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.hi(e,t)})},Wa.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Xa(r).Qs(function(t,e){var n=Ca(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return $u.Sn(a)}).next(function(){return u})},Wa.prototype.pe=function(t,r){return Xa(t).Qs(function(t,e){var n=Ca(e);r(n)})},Wa.prototype.oi=function(t){return Ya(t).get(Oh.key).next(function(t){return Cr(null!==t),t})},Wa.prototype.hi=function(t,e){return Ya(t).put(Oh.key,e)},Wa.prototype._i=function(t,e){return Xa(t).put(Va(this.serializer,e))},Wa.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Wa.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},Wa.prototype.mi=function(t,i){var e=wi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Xa(t).Qs({range:n,index:xh.queryTargetsIndexName},function(t,e,n){var r=Ca(e);bi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},Wa.prototype.Ai=function(n,t,r){var i=this,o=[],s=Ja(n);return t.forEach(function(t){var e=ga(t.path);o.push(s.put(new Ph(r,e))),o.push(i.ii.Ri(n,r,t))}),$u.Sn(o)},Wa.prototype.Pi=function(n,t,r){var i=this,o=Ja(n);return $u.forEach(t,function(t){var e=ga(t.path);return $u.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},Wa.prototype.Ti=function(t,e){var n=Ja(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Wa.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ja(t),o=Ki();return r.Qs({range:n,yi:!0},function(t,e,n){var r=wa(t[1]),i=new oi(r);o=o.add(i)}).next(function(){return o})},Wa.prototype.pi=function(t,e){var n=ga(e.path),r=IDBKeyRange.bound([n],[qr(n)],!1,!0),i=0;return Ja(t).Qs({index:Ph.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Wa.prototype.Me=function(t,e){return Xa(t).get(e).next(function(t){return t?Ca(t):null})},Wa);function Wa(t,e){this.ii=t,this.serializer=e}function Qa(t){this.ei=t}function Xa(t){return eh.ks(t,xh.store)}function Ya(t){return eh.ks(t,Oh.store)}function Ja(t){return eh.ks(t,Ph.store)}var Za,$a="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",th=(n(rh,Za=na),rh),eh=(nh.ks=function(t,e){if(t instanceof th)return Uh.ks(t.bi,e);throw Lr()},nh.prototype.start=function(){var e=this;return Uh.Ui(this.Li,gh,new mh(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Zr(Jr.FAILED_PRECONDITION,$a);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new oa(t,e.Si)}).then(function(){e.Fi=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},nh.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},nh.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},nh.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},nh.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return oh(e).put(new Ch(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(zh(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},nh.prototype.tr=function(t){var e=this;return ih(t).get(bh.key).next(function(t){return $u.resolve(e.rr(t))})},nh.prototype.or=function(t){return oh(t).delete(this.clientId)},nh.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.xi,18e5)?[3,2]:(this.xi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=nh.ks(t,Ch.store);return r.Ns().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return $u.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},nh.prototype.Gi=function(){var t=this;this.$i=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},nh.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},nh.prototype.nr=function(e){var i=this;return this.Di?$u.resolve(!0):ih(e).get(bh.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new Zr(Jr.FAILED_PRECONDITION,$a);return!1}}return!(!i.networkEnabled||!i.inForeground)||oh(e).Ns().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},nh.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Fi=!1,this.dr(),this.$i&&(this.$i.cancel(),this.$i=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){xr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},nh.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},nh.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return oh(t).Ns().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(nh.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),nh.prototype.mr=function(t){return ch.Ar(t,this.serializer,this.Kn,this.ii)},nh.prototype.Rr=function(){return this.qi},nh.prototype.Pr=function(){return this.Qn},nh.prototype.gr=function(){return this.Kn},nh.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Mh,function(t){return o=new th(t,i.Ci?i.Ci.next():oa.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw Pr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new Zr(Jr.FAILED_PRECONDITION,ea);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},nh.prototype.Vr=function(t){var e=this;return ih(t).get(bh.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Zr(Jr.FAILED_PRECONDITION,$a)})},nh.prototype.ir=function(t){var e=new bh(this.clientId,this.allowTabSynchronization,Date.now());return ih(t).put(bh.key,e)},nh.Oi=function(){return Uh.Oi()},nh.prototype.sr=function(t){var e=this,n=ih(t);return n.get(bh.key).next(function(t){return e.rr(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(bh.key)):$u.resolve()})},nh.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Pr("Detected an update time that is in the future: "+t+" > "+n),1))},nh.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)},nh.prototype.wr=function(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)},nh.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ni=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.Ni))},nh.prototype.Tr=function(){this.Ni&&(this.window.removeEventListener("unload",this.Ni),this.Ni=null)},nh.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Pr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},nh.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){Pr("Failed to set zombie client id.",t)}},nh.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},nh.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},nh);function nh(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=h,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.ki=null,this.$i=null,this.xi=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!nh.Oi())throw new Zr(Jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new sh(this,r),this.Li=e+"main",this.serializer=new Sa(u),this.qi=new Ka(this.ii,this.serializer),this.Kn=new Ia,this.Qn=new Ua(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&Pr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function rh(t,e){var n=this;return(n=Za.call(this)||this).bi=t,n.vi=e,n}function ih(t){return eh.ks(t,bh.store)}function oh(t){return eh.ks(t,Ch.store)}var sh=(uh.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},uh.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},uh.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},uh.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},uh.prototype.Ri=function(t,e,n){return ah(t,n)},uh.prototype.gi=function(t,e,n){return ah(t,n)},uh.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},uh.prototype.Dr=ah,uh.prototype.Cr=function(t,e){return r=e,i=!1,vh(n=t).Fr(function(t){return lh(n,t,r).next(function(t){return t&&(i=!0),$u.resolve(!t)})}).next(function(){return i});var n,r,i},uh.prototype.Nr=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){var n;t<=i&&(n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.xn(e),Ja(r).delete([0,ga(e.path)])})}),u.push(n))}).next(function(){return $u.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},uh.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},uh.prototype.kr=ah,uh.prototype.Sr=function(t,o){var s,e=Ja(t),u=oa.ws;return e.Qs({index:Ph.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==oa.ws&&o(new oi(wa(s)),u),u=i,s=r):u=oa.ws}).next(function(){u!==oa.ws&&o(new oi(wa(s)),u)})},uh.prototype.$r=function(t){return this.db.Pr().Xs(t)},uh);function uh(t,e){this.db=t,this.yr=new fc(this,e)}function ah(t,e){return Ja(t).put((n=t.vi,new Ph(0,ga(e.path),n)));var n}function hh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ch=(fh.Ar=function(t,e,n,r){return Cr(""!==t.uid),new fh(t.Mr()?t.uid:"",e,n,r)},fh.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return dh(t).Qs({index:Th.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},fh.prototype.Lr=function(d,y,v,g){var m=this,w=yh(d),b=dh(d);return b.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new Ju(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Yo(e.$s,t)}),o=r.mutations.map(function(t){return Yo(e.$s,t)}),new Th(n,r.batchId,r.dn.toMillis(),i,o)),a=[],h=new Ui(function(t,e){return Ur(t.N(),e.N())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Nh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Nh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Kn.Cs(d,t))}),d.Un(function(){m.xr[t]=s.keys()}),$u.Sn(a).next(function(){return s})})},fh.prototype.qr=function(t,e){var n=this;return dh(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),La(n.serializer,t)):null})},fh.prototype.Br=function(t,n){var r=this;return this.xr[n]?$u.resolve(this.xr[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.xr[n]=e}return null})},fh.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return dh(t).Qs({index:Th.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=La(r.serializer,e)),n.done()}).next(function(){return o})},fh.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return dh(t).Qs({index:Th.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},fh.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return dh(t).Ns(Th.userMutationsIndex,n).next(function(t){return t.map(function(t){return La(e.serializer,t)})})},fh.prototype.zn=function(u,a){var h=this,t=Nh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return yh(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=wa(i);if(r===h.userId&&a.path.isEqual(s))return dh(u).get(o).next(function(t){if(!t)throw Lr();Cr(t.userId===h.userId),c.push(La(h.serializer,t))});n.done()}).next(function(){return c})},fh.prototype.Zn=function(r,t){var a=this,h=new Ui(Ur),i=[];return t.forEach(function(u){var t=Nh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=yh(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=wa(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),$u.Sn(i).next(function(){return a.jr(r,h)})},fh.prototype.os=function(t,e){var u=this,a=e.path,h=a.length+1,n=Nh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Ui(Ur);return yh(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=wa(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.jr(t,c)})},fh.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(dh(e).get(t).next(function(t){if(null===t)throw Lr();Cr(t.userId===n.userId),r.push(La(n.serializer,t))}))}),$u.Sn(i).next(function(){return r})},fh.prototype.Kr=function(e,n){var r=this;return ph(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),$u.forEach(t,function(t){return r.ii.Dr(e,t)})})},fh.prototype.Gr=function(t){delete this.xr[t]},fh.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return $u.resolve();var e=IDBKeyRange.lowerBound(Nh.prefixForUser(o.userId)),i=[];return yh(n).Qs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=wa(t[1]),i.push(r)):n.done()}).next(function(){Cr(0===i.length)})})},fh.prototype.pi=function(t,e){return lh(t,this.userId,e)},fh.prototype.Hr=function(t){var e=this;return vh(t).get(this.userId).next(function(t){return t||new Ih(e.userId,-1,"")})},fh);function fh(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.xr={}}function lh(t,o,e){var n=Nh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return yh(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ph(t,e,n){var r=t.store(Th.store),i=t.store(Nh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Cr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Nh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return $u.Sn(o).next(function(){return h})}function dh(t){return eh.ks(t,Th.store)}function yh(t){return eh.ks(t,Nh.store)}function vh(t){return eh.ks(t,Ih.store)}var gh=10,mh=(Eh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Cr(t<e&&0<=t&&e<=gh);var o,s=new Hh(r);t<1&&1<=e&&(n.createObjectStore(bh.store),(o=n).createObjectStore(Ih.store,{keyPath:Ih.keyPath}),o.createObjectStore(Th.store,{keyPath:Th.keyPath,autoIncrement:!0}).createIndex(Th.userMutationsIndex,Th.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Nh.store),Lh(n),n.createObjectStore(kh.store));var u,a=$u.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Ph.store),u.deleteObjectStore(xh.store),u.deleteObjectStore(Oh.store),Lh(n)),a=a.next(function(){return t=s.store(Oh.store),e=new Oh(0,0,ti.min().A(),0),t.put(Oh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Th.store).Ns().next(function(t){r.deleteObjectStore(Th.store),r.createObjectStore(Th.store,{keyPath:Th.keyPath,autoIncrement:!0}).createIndex(Th.userMutationsIndex,Th.userMutationsKeyPath,{unique:!0});var e=i.store(Th.store),n=t.map(function(t){return e.put(t)});return $u.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Ch.store,{keyPath:Ch.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Dh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(kh.store)).createIndex(kh.readTimeIndex,kh.readTimeIndexPath,{unique:!1}),t.createIndex(kh.collectionReadTimeIndex,kh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Eh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(kh.store).Qs(function(t,e){n+=Ga(e)}).next(function(){var t=new Dh(n);return e.store(Dh.store).put(Dh.key,t)})},Eh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Ih.store),e=r.store(Th.store);return t.Ns().next(function(t){return $u.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ns(Th.userMutationsIndex,t).next(function(t){return $u.forEach(t,function(t){Cr(t.userId===n.userId);var e=La(i.serializer,t);return ph(r,n.userId,e).next(function(){})})})})})},Eh.prototype.ensureSequenceNumbers=function(t){var s=t.store(Ph.store),e=t.store(kh.store);return t.store(Oh.store).get(Oh.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new ni(t),r=[0,ga(n)];o.push(s.get(r).next(function(t){return t?$u.resolve():s.put(new Ph(0,ga(n),i.highestListenSequenceNumber))}))}).next(function(){return $u.Sn(o)})})},Eh.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:ga(n)})}}t.createObjectStore(Rh.store,{keyPath:Rh.keyPath});var r=e.store(Rh.store),o=new Ea;return e.store(kh.store).Qs({yi:!0},function(t,e){var n=new ni(t);return i(n.p())}).next(function(){return e.store(Nh.store).Qs({yi:!0},function(t,e){t[0];var n=t[1],r=(t[2],wa(n));return i(r.p())})})},Eh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(xh.store);return o.Qs(function(t,e){var n=Ca(e),r=Va(i.serializer,n);return o.put(r)})},Eh),wh=function(t,e){this.seconds=t,this.nanoseconds=e},bh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Eh(t){this.serializer=t}bh.store="owner",bh.key="owner";var Ih=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ih.store="mutationQueues",Ih.keyPath="userId";var Th=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Th.store="mutations",Th.keyPath="batchId",Th.userMutationsIndex="userMutationsIndex",Th.userMutationsKeyPath=["userId","batchId"];var Nh=(Ah.prefixForUser=function(t){return[t]},Ah.prefixForPath=function(t,e){return[t,ga(e)]},Ah.key=function(t,e,n){return[t,ga(e),n]},Ah);function Ah(){}Nh.store="documentMutations",Nh.PLACEHOLDER=new Nh;var _h=function(t,e){this.path=t,this.readTime=e},Sh=function(t,e){this.path=t,this.version=e},kh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};kh.store="remoteDocuments",kh.readTimeIndex="readTimeIndex",kh.readTimeIndexPath="readTime",kh.collectionReadTimeIndex="collectionReadTimeIndex",kh.collectionReadTimeIndexPath=["parentPath","readTime"];var Dh=function(t){this.byteSize=t};Dh.store="remoteDocumentGlobal",Dh.key="remoteDocumentGlobalKey";var xh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};xh.store="targets",xh.keyPath="targetId",xh.queryTargetsIndexName="queryTargetsIndex",xh.queryTargetsKeyPath=["canonicalId","targetId"];var Ph=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ph.store="targetDocuments",Ph.keyPath=["targetId","path"],Ph.documentTargetsIndex="documentTargetsIndex",Ph.documentTargetsKeyPath=["path","targetId"];var Oh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Oh.key="targetGlobalKey",Oh.store="targetGlobal";var Rh=function(t,e){this.collectionId=t,this.parent=e};function Lh(t){t.createObjectStore(Ph.store,{keyPath:Ph.keyPath}).createIndex(Ph.documentTargetsIndex,Ph.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(xh.store,{keyPath:xh.keyPath}).createIndex(xh.queryTargetsIndexName,xh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Oh.store)}Rh.store="collectionParents",Rh.keyPath=["collectionId","parent"];var Ch=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ch.store="clientMetadata",Ch.keyPath="clientId";var Vh,Mh=i(i(i([Ih.store,Th.store,Nh.store,kh.store,xh.store,bh.store,Oh.store,Ph.store],[Ch.store]),[Dh.store]),[Rh.store]),Uh=(Gh.Ui=function(o,t,s){return xr("SimpleDb","Opening database:",o),new $u(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Gh(e))},i.onblocked=function(){r(new Zr(Jr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Zr(Jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,gh).next(function(){xr("SimpleDb","Database upgrade to version "+gh+" complete")})}}).bn()},Gh.delete=function(t){return xr("SimpleDb","Removing database:",t),Xh(window.indexedDB.deleteDatabase(t)).bn()},Gh.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(Gh.Jr())return!0;var t=p(),e=Gh.Yr(t),n=0<e&&e<10,r=Gh.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Gh.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},Gh.ks=function(t,e){return t.store(e)},Gh.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Gh.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Gh.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},Gh.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=Hh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),$u.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,xr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Gh.prototype.close=function(){this.db.close()},Gh),jh=(Object.defineProperty(Bh.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(Bh.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(Bh.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Bh.prototype.done=function(){this.no=!0},Bh.prototype.js=function(t){this.so=t},Bh.prototype.delete=function(){return Xh(this.eo.delete())},Bh),qh=(n(Fh,Vh=Zr),Fh);function Fh(t){var e=this;return(e=Vh.call(this,Jr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Bh(t){this.eo=t,this.no=!1,this.so=null}function Gh(t){this.db=t,12.2===Gh.Yr(p())&&Pr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function zh(t){return"IndexedDbTransactionError"===t.name}var Hh=(Qh.open=function(t,e,n){return new Qh(t.transaction(n,e))},Object.defineProperty(Qh.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Qh.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Qh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Kh(e)},Qh),Kh=(Wh.prototype.put=function(t,e){var n=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Xh(n)},Wh.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),Xh(this.store.add(t))},Wh.prototype.get=function(e){var n=this;return Xh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Wh.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),Xh(this.store.delete(t))},Wh.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),Xh(this.store.count())},Wh.prototype.Ns=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},Wh.prototype.ho=function(t,e){xr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},Wh.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},Wh.prototype.Fr=function(i){var t=this.cursor({});return new $u(function(n,r){t.onerror=function(t){var e=Jh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Wh.prototype.oo=function(t,s){var u=[];return new $u(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new jh(i),(n=s(i.primaryKey,i.value,e))instanceof $u&&(r=n.catch(function(t){return e.done(),$u.reject(t)}),u.push(r)),e.gn?o():null===e.io?i.continue():i.continue(e.io)):o()}}).next(function(){return $u.Sn(u)})},Wh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Wh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Wh);function Wh(t){this.store=t}function Qh(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new da,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new qh(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=Jh(t.target.error);n.ro.reject(new qh(e))}}function Xh(t){return new $u(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Jh(t.target.error);r(e)}})}var Yh=!1;function Jh(t){var e=Uh.Yr(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Zr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Yh||(Yh=!0,setTimeout(function(){throw r},0)),r}}return t}function Zh(){return"undefined"!=typeof window?window:null}var $h=(nc._o=function(t,e,n,r,i){var o=new nc(t,e,Date.now()+n,r,i);return o.start(n),o},nc.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},nc.prototype.Ss=function(){return this.do()},nc.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new Zr(Jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},nc.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},nc.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},nc),tc=(Object.defineProperty(ec.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),ec.prototype.Zi=function(t){this.enqueue(t)},ec.prototype.po=function(t){this.bo(),this.vo(t)},ec.prototype.So=function(t){return this.bo(),this.vo(t)},ec.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=Zh())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ec.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},ec.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},ec.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!zh(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},ec.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},ec.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=$h._o(this,t,e,n,function(t){return r.Fo(t)});return this.Io.push(i),i},ec.prototype.bo=function(){this.mo&&Lr()},ec.prototype.No=function(){},ec.prototype.ko=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},ec.prototype.$o=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},ec.prototype.xo=function(r){var i=this;return this.ko().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.ko()})},ec.prototype.Mo=function(t){this.Ro.push(t)},ec.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},ec);function ec(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new ya(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=Zh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function nc(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new da,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function rc(t,e){if(Pr("AsyncQueue",e+": "+t),zh(t))return new Zr(Jr.UNAVAILABLE,e+": "+t);throw t}function ic(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ur(n,i);return 0===s?Ur(r,o):s}var oc=(hc.prototype.qo=function(){return++this.Lo},hc.prototype.Bo=function(t){var e,n=[t,this.qo()];this.buffer.size<this.Oo?this.buffer=this.buffer.add(n):ic(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(hc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),hc),sc={Uo:!1,Wo:0,Qo:0,jo:0},uc=(ac.Ho=function(t){return new ac(t,ac.Yo,ac.Jo)},ac);function ac(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function hc(t){this.Oo=t,this.buffer=new Ui(ic),this.Lo=0}uc.Xo=-1,uc.Zo=1048576,uc.th=41943040,uc.Yo=10,uc.Jo=1e3,uc.eh=new uc(uc.th,uc.Yo,uc.Jo),uc.nh=new uc(uc.Xo,0,0);var cc=(yc.prototype.start=function(t){this.yr.params.Ko!==uc.Xo&&this.rh(t)},yc.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(yc.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),yc.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return zh(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},yc),fc=(dc.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},dc.prototype.uh=function(t,e){var n=this;if(0===e)return $u.resolve(oa.ws);var r=new oc(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},dc.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},dc.prototype.Nr=function(t,e){return this.hh.Nr(t,e)},dc.prototype.lh=function(e,n){var r=this;return this.params.Ko===uc.Xo?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),$u.resolve(sc)):this.$r(e).next(function(t){return t<r.params.Ko?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),sc):r._h(e,n)})},dc.prototype.$r=function(t){return this.hh.$r(t)},dc.prototype._h=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>c.params.zo?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.zo+" from "+t),c.params.zo):t,s=Date.now(),c.uh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Nr(e,r)}).next(function(t){return h=Date.now(),Dr()<=l.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),$u.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},dc),lc=(pc.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.jn.Qr(v).next(function(t){return g=t,e=r.persistence.mr(i),m=new ra(r.Eh,e,r.persistence.gr()),e.Qr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Jn(v,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},pc.prototype.Vh=function(h){var c,f=this,l=$r.now(),t=h.reduce(function(t,e){return t.add(e.key)},Ki());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Ih.Jn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof Gs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof su?t.field(i.field):void 0,s=ss(i.transform,o||null);null!=s&&(e=null==e?(new Js).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Us(o.key,s,function u(t){var a=[];return Hr(t.fields||{},function(t,e){var n=new ii([t]);if(Po(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ts(a)}(s.proto.mapValue),Ss.exists(!0)))}return f.jn.Lr(a,l,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Cn:e}})},pc.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},pc.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return Cr(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},pc.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},pc.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},pc.prototype.vh=function(a){var h=this,c=a.X,f=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Eh.Hs({Js:!0});f=h.dh;var s=[];a.Wt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.qi.Pi(o,t.Xt,e).next(function(){return h.qi.Ai(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.vi),f=f.nt(e,r),pc.Sh(i,r,t)&&s.push(h.qi.di(o,r))))});var t,u=qi,n=Ki();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof uu&&e.version.isEqual(ti.min())?(i.xn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.kn(e,c),u=u.nt(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.ii.kr(o,t))})})),c.isEqual(ti.min())||(t=h.qi.ai(o).next(function(t){return h.qi.ci(o,o.vi,c)}),s.push(t)),$u.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ih.Xn(o,u)})}).then(function(t){return h.dh=f,t})},pc.Sh=function(t,e,n){return Cr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},pc.prototype.Ch=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return $u.forEach(c,function(e){return $u.forEach(e.as,function(t){return h.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return $u.forEach(e.us,function(t){return h.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!zh(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},pc.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},pc.prototype.Nh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},pc.prototype.kh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,$u.resolve(n)):i.qi.ri(e).next(function(t){return n=new Si(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},pc.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?$u.resolve(this.dh.get(n)):this.qi.mi(t,e)},pc.prototype.$h=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!zh(r=t.sent()))throw r;return xr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},pc.prototype.xh=function(t,n){var r=this,i=ti.min(),o=Ki();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,wu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:ti.min(),n?o:Ki())}).next(function(t){return{documents:t,Mh:o}})})},pc.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=$u.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);Cr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.kn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},pc.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},pc);function pc(t,e,n){this.persistence=t,this.fh=e,this.dh=new Pi(Ur),this.wh=new Yr(wi,bi),this.Th=ti.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new ra(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function dc(t,e){this.hh=t,this.params=e}function yc(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function vc(t,e){var n=t,r=n.qi,i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function gc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Jr.FAILED_PRECONDITION||e.message!==ea)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}lc.Dh=3e8;var mc=(Tc.prototype._=function(){return this.Oh._()},Tc.prototype.Ri=function(t,e){var n=new wc(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},Tc.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},Tc.prototype.gi=function(t,e){this.Wh(new wc(t,e))},Tc.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},Tc.prototype.jh=function(t){var e=this,n=new oi(new ni([])),r=new wc(n,t),i=new wc(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},Tc.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},Tc.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},Tc.prototype.Gh=function(t){var e=new oi(new ni([])),n=new wc(e,t),r=new wc(e,t+1),i=Ki();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},Tc.prototype.pi=function(t){var e=new wc(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},Tc),wc=(Ic.Lh=function(t,e){return oi.P(t.key,e.key)||Ur(t.zh,e.zh)},Ic.Bh=function(t,e){return Ur(t.zh,e.zh)||oi.P(t.key,e.key)},Ic),bc=(Ec.prototype.Mr=function(){return null!=this.uid},Ec.prototype.Hh=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},Ec.prototype.isEqual=function(t){return t.uid===this.uid},Ec);function Ec(t){this.uid=t}function Ic(t,e){this.key=t,this.zh=e}function Tc(){this.Oh=new Ui(wc.Lh),this.qh=new Ui(wc.Bh)}bc.UNAUTHENTICATED=new bc(null),bc.Yh=new bc("google-credentials-uid"),bc.Jh=new bc("first-party-uid");function Nc(t,e){this.user=e,this.type="OAuth",this.Xh={},this.Xh.Authorization="Bearer "+t}var Ac,_c,Sc,kc=(Wc.prototype.getToken=function(){return Promise.resolve(null)},Wc.prototype.ta=function(){},Wc.prototype.ea=function(t){(this.Zh=t)(bc.UNAUTHENTICATED)},Wc.prototype.na=function(){this.Zh=null},Wc),Dc=(Kc.prototype.getToken=function(){var e=this,n=this.ra,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.ra!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Nc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Kc.prototype.ta=function(){this.forceRefresh=!0},Kc.prototype.ea=function(t){this.Zh=t,this.ia&&t(this.currentUser)},Kc.prototype.na=function(){this.auth&&this.auth.removeAuthTokenListener(this.sa),this.sa=null,this.Zh=null},Kc.prototype.oa=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new bc(t)},Kc),xc=(Object.defineProperty(Hc.prototype,"Xh",{get:function(){var t={"X-Goog-AuthUser":this.aa},e=this.ha.auth.ua([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Hc),Pc=(zc.prototype.getToken=function(){return Promise.resolve(new xc(this.ha,this.aa))},zc.prototype.ea=function(t){t(bc.Jh)},zc.prototype.na=function(){},zc.prototype.ta=function(){},zc),Oc=(Gc.prototype.wa=function(){return 1===this.state||2===this.state||4===this.state},Gc.prototype.Ta=function(){return 2===this.state},Gc.prototype.start=function(){3!==this.state?this.auth():this.Ea()},Gc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.wa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Gc.prototype.Ia=function(){this.state=0,this.Po.reset()},Gc.prototype.ma=function(){var t=this;this.Ta()&&null===this.da&&(this.da=this.Ts.bs(this.ca,6e4,function(){return t.Aa()}))},Gc.prototype.Ra=function(t){this.Pa(),this.stream.send(t)},Gc.prototype.Aa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ta()?[2,this.close(0)]:[2]})})},Gc.prototype.Pa=function(){this.da&&(this.da.cancel(),this.da=null)},Gc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Pa(),this.Po.cancel(),this.fa++,3!==e?this.Po.reset():n&&n.code===Jr.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Jr.UNAUTHENTICATED&&this._a.ta(),null!==this.stream&&(this.ga(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Va(n)];case 1:return t.sent(),[2]}})})},Gc.prototype.ga=function(){},Gc.prototype.auth=function(){var n=this;this.state=1;var t=this.ya(this.fa),e=this.fa;this._a.getToken().then(function(t){n.fa===e&&n.pa(t)},function(e){t(function(){var t=new Zr(Jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ba(t)})})},Gc.prototype.pa=function(t){var e=this,n=this.ya(this.fa);this.stream=this.va(t),this.stream.Sa(function(){n(function(){return e.state=2,e.listener.Sa()})}),this.stream.Va(function(t){n(function(){return e.ba(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Gc.prototype.Ea=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Gc.prototype.ba=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Gc.prototype.ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.fa===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Gc),Rc=(n(Bc,Sc=Oc),Bc.prototype.va=function(t){return this.la.Da("Listen",t)},Bc.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Lr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Cr(void 0===i||"string"==typeof i),Ii.fromBase64String(i||"")):(Cr(void 0===i||i instanceof Uint8Array),Ii.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?Jr.UNKNOWN:xi(n.code),new Zr(r,n.message||"")),f=new Yi(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=zo(t,l.document.name),d=qo(l.document.updateTime),y=new Ys({mapValue:{fields:l.document.fields}}),v=new su(p,d,y,{}),g=l.targetIds||[],m=l.removedTargetIds||[];f=new Qi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=zo(t,w.document),E=w.readTime?qo(w.readTime):ti.min(),I=new uu(b,E),T=w.removedTargetIds||[];f=new Qi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var A=zo(t,N.document),_=N.removedTargetIds||[];f=new Qi([],_,A,null)}else{if(!("filter"in e))return Lr();e.filter;var S=e.filter;S.targetId;var k=S.count||0,D=new Ni(k),x=S.targetId;f=new Xi(x,D)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ti.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ti.min():qo(e.readTime)}(t);return this.listener.Ca(e,n)},Bc.prototype.Fa=function(t){var e,n,r,i,o={};o.database=Wo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Ei(i)?{documents:Zo(e,i)}:{query:$o(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=jo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ra(o)},Bc.prototype.Na=function(t){var e={};e.database=Wo(this.serializer),e.removeTarget=t,this.Ra(e)},Bc),Lc=(n(Fc,_c=Oc),Object.defineProperty(Fc.prototype,"$a",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Fc.prototype.start=function(){this.ka=!1,this.lastStreamToken=void 0,_c.prototype.start.call(this)},Fc.prototype.ga=function(){this.ka&&this.xa([])},Fc.prototype.va=function(t){return this.la.Da("Write",t)},Fc.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ka){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Cr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?qo(t.updateTime):qo(e);n.isEqual(ti.min())&&(n=qo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new _s(n,r)}(t,i)})):[]),n=qo(t.commitTime);return this.listener.Ma(n,e)}var r,i;return Cr(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.Oa()},Fc.prototype.La=function(){var t={};t.database=Wo(this.serializer),this.Ra(t)},Fc.prototype.xa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.Ra(n)},Fc),Cc=(n(qc,Ac=function(){}),qc.prototype.Ba=function(){if(this.qa)throw new Zr(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},qc.prototype.start=function(t){this.la=t},qc.prototype.Ua=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Ua(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.ta(),t})},qc.prototype.Wa=function(e,n,r){var i=this;return this.Ba(),this.credentials.getToken().then(function(t){return i.la.Wa(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.ta(),t})},qc.prototype.Qa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.qa=!1,[2]})})},qc),Vc=(jc.prototype.Ha=function(){var t=this;0===this.Ka&&(this.Ya("Unknown"),this.Ga=this.ao.bs("online_state_timeout",1e4,function(){return t.Ga=null,t.Ja("Backend didn't respond within 10 seconds."),t.Ya("Offline"),Promise.resolve()}))},jc.prototype.Xa=function(t){"Online"===this.state?this.Ya("Unknown"):(this.Ka++,1<=this.Ka&&(this.Za(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Ya("Offline")))},jc.prototype.set=function(t){this.Za(),this.Ka=0,"Online"===t&&(this.za=!1),this.Ya(t)},jc.prototype.Ya=function(t){t!==this.state&&(this.state=t,this.ja(t))},jc.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Pr(e),this.za=!1):xr("OnlineStateTracker",e)},jc.prototype.Za=function(){null!==this.Ga&&(this.Ga.cancel(),this.Ga=null)},jc),Mc=(Uc.prototype.start=function(){return this.enableNetwork()},Uc.prototype.enableNetwork=function(){return this.ru.delete(0),this.mu()},Uc.prototype.mu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(this.Au()?this.Ru():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Uc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(0),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Uc.prototype.gu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.nu.length&&(xr("RemoteStore","Stopping write stream with "+this.nu.length+" pending writes"),this.nu=[]),this.Vu(),[2]}})})},Uc.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","RemoteStore shutting down."),this.ru.add(5),[4,this.gu()];case 1:return t.sent(),this.ou._r(),this.cu.set("Unknown"),[2]}})})},Uc.prototype.listen=function(t){this.su.has(t.targetId)||(this.su.set(t.targetId,t),this.Au()?this.Ru():this.lu.Ta()&&this.yu(t))},Uc.prototype.pu=function(t){this.su.delete(t),this.lu.Ta()&&this.bu(t),0===this.su.size&&(this.lu.Ta()?this.lu.ma():this.au()&&this.cu.set("Unknown"))},Uc.prototype.Me=function(t){return this.su.get(t)||null},Uc.prototype.xe=function(t){return this.vu.xe(t)},Uc.prototype.yu=function(t){this.iu.de(t.targetId),this.lu.Fa(t)},Uc.prototype.bu=function(t){this.iu.de(t),this.lu.Na(t)},Uc.prototype.Ru=function(){this.iu=new ro(this),this.lu.start(),this.cu.Ha()},Uc.prototype.Au=function(){return this.au()&&!this.lu.wa()&&0<this.su.size},Uc.prototype.au=function(){return 0===this.ru.size},Uc.prototype.Vu=function(){this.iu=null},Uc.prototype._u=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.su.forEach(function(t,e){n.yu(t)}),[2]})})},Uc.prototype.fu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Vu(),this.Au()?(this.cu.Xa(e),this.Ru()):this.cu.set("Unknown"),[2]})})},Uc.prototype.du=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(i instanceof Yi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Su(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Qi?this.iu.Pe(i):i instanceof Xi?this.iu.De(i):this.iu.ye(i),o.isEqual(ti.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.tu.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Cu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Du(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Uc.prototype.Du=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!zh(n))throw n;return this.ru.add(1),[4,this.gu()];case 1:return t.sent(),this.cu.set("Offline"),r=r||function(){return e.tu.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.ru.delete(1),[4,this.mu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Uc.prototype.Fu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Uc.prototype.Cu=function(r){var i=this,t=this.iu.Ne(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.su.get(e))&&i.su.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.su.get(t);n&&(i.su.set(t,n.tt(Ii.Y,n.X)),i.bu(t),e=new Si(n.target,t,1,n.sequenceNumber),i.yu(e))}),this.vu.vh(t)},Uc.prototype.Su=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.su.has(i)?[4,this.vu.Nu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.su.delete(i),this.iu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Uc.prototype.Pu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.nu.length?this.nu[this.nu.length-1].batchId:-1,t.label=1;case 1:if(!this.ku())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.tu.Fh(e)];case 3:return null===(n=t.sent())?(0===this.nu.length&&this.wu.ma(),[3,7]):(e=n.batchId,this.$u(n),[3,6]);case 4:return r=t.sent(),[4,this.Du(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.xu()&&this.Mu(),[2]}})})},Uc.prototype.ku=function(){return this.au()&&this.nu.length<10},Uc.prototype.Ou=function(){return this.nu.length},Uc.prototype.$u=function(t){this.nu.push(t),this.wu.Ta()&&this.wu.$a&&this.wu.xa(t.mutations)},Uc.prototype.xu=function(){return this.au()&&!this.wu.wa()&&0<this.nu.length},Uc.prototype.Mu=function(){this.wu.start()},Uc.prototype.Tu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.wu.La(),[2]})})},Uc.prototype.Iu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.nu;e<n.length;e++)r=n[e],this.wu.xa(r.mutations);return[2]})})},Uc.prototype.Ma=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.nu.shift(),n=Zu.from(e,i,o),[4,this.Fu(function(){return r.vu.Lu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Uc.prototype.Eu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.wu.$a?[4,this.qu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.xu()&&this.Mu(),[2]}})})},Uc.prototype.qu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Di(n=i.code)&&n!==Jr.ABORTED?(e=this.nu.shift(),this.wu.Ia(),[4,this.Fu(function(){return r.vu.Bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Uc.prototype.uu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ru.add(4),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),this.wu.Ia(),this.lu.Ia(),this.ru.delete(4),[4,this.mu()];case 2:return t.sent(),[2]}})})},Uc.prototype.Uu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.No(),xr("RemoteStore","RemoteStore received new credentials"),this.ru.add(3),[4,this.gu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.vu.Uu(e)];case 2:return t.sent(),this.ru.delete(3),[4,this.mu()];case 3:return t.sent(),[2]}})})},Uc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.ru.delete(2),[4,this.mu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.ru.add(2),[4,this.gu()]);case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Uc);function Uc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.tu=t,this.eu=e,this.ao=n,this.nu=[],this.su=new Map,this.iu=null,this.ru=new Set,this.ou=i,this.ou.hu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?(xr("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new Vc(n,r),this.lu=(h=this.eu,c=n,f={Sa:this._u.bind(this),Va:this.fu.bind(this),Ca:this.du.bind(this)},(l=h).Ba(),new Rc(c,l.la,l.credentials,l.serializer,f)),this.wu=(o=this.eu,s=n,u={Sa:this.Tu.bind(this),Va:this.Eu.bind(this),Oa:this.Iu.bind(this),Ma:this.Ma.bind(this)},(a=o).Ba(),new Lc(s,a.la,a.credentials,a.serializer,u))}function jc(t,e){this.ao=t,this.ja=e,this.state="Unknown",this.Ka=0,this.Ga=null,this.za=!0}function qc(t,e){var n=this;return(n=Ac.call(this)||this).credentials=t,n.serializer=e,n.qa=!1,n}function Fc(t,e,n,r,i){var o=this;return(o=_c.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ka=!1,o}function Bc(t,e,n,r,i){var o=this;return(o=Sc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Gc(t,e,n,r,i,o){this.Ts=t,this.ca=n,this.la=r,this._a=i,this.listener=o,this.state=0,this.fa=0,this.da=null,this.stream=null,this.Po=new ya(t,e)}function zc(t,e){this.ha=t,this.aa=e}function Hc(t,e){this.ha=t,this.aa=e,this.type="FirstParty",this.user=bc.Jh}function Kc(t){var e=this;this.sa=null,this.currentUser=bc.UNAUTHENTICATED,this.ia=!1,this.ra=0,this.Zh=null,this.forceRefresh=!1,this.sa=function(){e.ra++,e.currentUser=e.oa(),e.ia=!0,e.Zh&&e.Zh(e.currentUser)},this.ra=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.sa):(this.sa(null),t.get().then(function(t){e.auth=t,e.sa&&e.auth.addAuthTokenListener(e.sa)},function(){}))}function Wc(){this.Zh=null}function Qc(t,e){return"firestore_clients_"+t+"_"+e}function Xc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function Yc(t,e){return"firestore_targets_"+t+"_"+e}function Jc(t){this.key=t}function Zc(t){this.key=t}function $c(t,e,n){this.query=t,this.targetId=e,this.view=n}function tf(t){this.key=t,this.Zc=!1}var ef=(wf.Qu=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Zr(r.error.code,r.error.message)),i?new wf(t,e,r.state,o):(Pr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},wf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},wf),nf=(mf.Qu=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Zr(n.error.code,n.error.message)),r?new mf(t,n.state,i):(Pr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},mf.prototype.ju=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},mf),rf=(gf.Qu=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wi,o=0;r&&o<n.activeTargetIds.length;++o)r=vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new gf(t,i):(Pr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},gf),of=(vf.Qu=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new vf(e.clientId,e.onlineState):(Pr("SharedClientState","Failed to parse online state: "+t),null)},vf),sf=(yf.prototype.Ku=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},yf.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},yf.prototype.ju=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},yf),uf=(df.Oi=function(t){return!(!t||!t.localStorage)},df.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.vu.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.zu&&(o=this.getItem(Qc(this.persistenceKey,i)))&&(s=rf.Qu(i,o))&&(this.Ju=this.Ju.nt(s.clientId,s));for(this.rc(),(u=this.storage.getItem(this.ic))&&(a=this.oc(u))&&this.hc(a),h=0,c=this.Xu;h<c.length;h++)f=c[h],this.Yu(f);return this.Xu=[],this.window.addEventListener("unload",function(){return l._r()}),this.Hi=!0,[2]}})})},df.prototype.ds=function(t){this.setItem(this.tc,JSON.stringify(t))},df.prototype.ac=function(){return this.uc(this.Ju)},df.prototype.cc=function(n){var r=!1;return this.Ju.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},df.prototype.lc=function(t){this._c(t,"pending")},df.prototype.fc=function(t,e,n){this._c(t,e,n),this.dc(t)},df.prototype.wc=function(t){var e,n,r="not-current";return this.cc(t)&&(!(e=this.storage.getItem(Yc(this.persistenceKey,t)))||(n=nf.Qu(t,e))&&(r=n.state)),this.Tc.Ku(t),this.rc(),r},df.prototype.Ec=function(t){this.Tc.Gu(t),this.rc()},df.prototype.Ic=function(t){return this.Tc.activeTargetIds.has(t)},df.prototype.mc=function(t){this.removeItem(Yc(this.persistenceKey,t))},df.prototype.Ac=function(t,e,n){this.Rc(t,e,n)},df.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.dc(t)}),this.currentUser=t,n.forEach(function(t){r.lc(t)})},df.prototype.Pc=function(t){this.gc(t)},df.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.Hu),this.removeItem(this.Zu),this.Hi=!1)},df.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},df.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},df.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},df.prototype.Yu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(xr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Zu)return void Pr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.ec.test(u.key)){if(null==u.newValue)return e=this.Vc(u.key),[2,this.yc(e,null)];if(n=this.pc(u.key,u.newValue))return[2,this.yc(n.clientId,n)]}else if(this.nc.test(u.key)){if(null!==u.newValue&&(r=this.bc(u.key,u.newValue)))return[2,this.vc(r)]}else if(this.sc.test(u.key)){if(null!==u.newValue&&(i=this.Sc(u.key,u.newValue)))return[2,this.Dc(i)]}else if(u.key===this.ic){if(null!==u.newValue&&(o=this.oc(u.newValue)))return[2,this.hc(o)]}else u.key===this.tc&&(s=function(t){var e=oa.ws;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){Pr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==oa.ws&&this.ls(s)}else this.Xu.push(u);return[2]})})})}},Object.defineProperty(df.prototype,"Tc",{get:function(){return this.Ju.get(this.zu)},enumerable:!1,configurable:!0}),df.prototype.rc=function(){this.setItem(this.Zu,this.Tc.ju())},df.prototype._c=function(t,e,n){var r=new ef(this.currentUser,t,e,n),i=Xc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ju())},df.prototype.dc=function(t){var e=Xc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},df.prototype.gc=function(t){var e={clientId:this.zu,onlineState:t};this.storage.setItem(this.ic,JSON.stringify(e))},df.prototype.Rc=function(t,e,n){var r=Yc(this.persistenceKey,t),i=new nf(t,e,n);this.setItem(r,i.ju())},df.prototype.Vc=function(t){var e=this.ec.exec(t);return e?e[1]:null},df.prototype.pc=function(t,e){var n=this.Vc(t);return rf.Qu(n,e)},df.prototype.bc=function(t,e){var n=this.nc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ef.Qu(new bc(i),r,e)},df.prototype.Sc=function(t,e){var n=this.sc.exec(t),r=Number(n[1]);return nf.Qu(r,e)},df.prototype.oc=function(t){return of.Qu(t)},df.prototype.vc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.vu.Cc(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},df.prototype.Dc=function(t){return this.vu.Fc(t.targetId,t.state,t.error)},df.prototype.yc=function(t,e){var n=this,r=e?this.Ju.nt(t,e):this.Ju.remove(t),i=this.uc(this.Ju),o=this.uc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.vu.Nc(s,u).then(function(){n.Ju=r})},df.prototype.hc=function(t){this.Ju.get(t.clientId)&&this.ja(t.onlineState)},df.prototype.uc=function(t){var n=Wi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},df),af=(pf.prototype.lc=function(t){},pf.prototype.fc=function(t,e,n){},pf.prototype.wc=function(t){return this.kc.Ku(t),this.$c[t]||"not-current"},pf.prototype.Ac=function(t,e,n){this.$c[t]=e},pf.prototype.Ec=function(t){this.kc.Gu(t)},pf.prototype.Ic=function(t){return this.kc.activeTargetIds.has(t)},pf.prototype.mc=function(t){delete this.$c[t]},pf.prototype.ac=function(){return this.kc.activeTargetIds},pf.prototype.cc=function(t){return this.kc.activeTargetIds.has(t)},pf.prototype.start=function(){return this.kc=new sf,Promise.resolve()},pf.prototype.Ah=function(t,e,n){},pf.prototype.Pc=function(t){},pf.prototype._r=function(){},pf.prototype.ds=function(t){},pf),hf=(Object.defineProperty(lf.prototype,"Bc",{get:function(){return this.xc},enumerable:!1,configurable:!0}),lf.prototype.Uc=function(t,e){var u=this,a=e?e.Wc:new Zi,h=e?e.qc:this.qc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof su?e:null)&&(_u(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Qc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Lc(r,p)||d&&u.Lc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{qc:f,Wc:a,jc:l,Lt:c}},lf.prototype.Qc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},lf.prototype.qn=function(t,e,n){var o=this,r=this.qc;this.qc=t.qc,this.Lt=t.Lt;var i=t.Wc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Lc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.Kc(n);var s=e?this.Gc():[],u=0===this.Oc.size&&this.Ht?1:0,a=u!==this.Mc;return this.Mc=u,0!==i.length||a?{snapshot:new $i(this.query,t.qc,r,i,t.Lt,0==u,a,!1),zc:s}:{zc:s}},lf.prototype.Hc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({qc:this.qc,Wc:new Zi,Lt:this.Lt,jc:!1},!1)):{zc:[]}},lf.prototype.Yc=function(t){return!this.xc.has(t)&&!!this.qc.has(t)&&!this.qc.get(t).Ke},lf.prototype.Kc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.xc=e.xc.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.xc=e.xc.delete(t)}),this.Ht=t.Ht)},lf.prototype.Gc=function(){var e=this;if(!this.Ht)return[];var n=this.Oc;this.Oc=Ki(),this.qc.forEach(function(t){e.Yc(t.key)&&(e.Oc=e.Oc.add(t.key))});var r=[];return n.forEach(function(t){e.Oc.has(t)||r.push(new Zc(t))}),this.Oc.forEach(function(t){n.has(t)||r.push(new Jc(t))}),r},lf.prototype.Jc=function(t){this.xc=t.Mh,this.Oc=Ki();var e=this.Uc(t.documents);return this.qn(e,!0)},lf.prototype.Xc=function(){return $i.Ut(this.query,this.qc,this.Lt,0===this.Mc)},lf),cf=(Object.defineProperty(ff.prototype,"dl",{get:function(){return!0===this.fl},enumerable:!1,configurable:!0}),ff.prototype.subscribe=function(t){this.sl=t},ff.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.wl("listen()"),(r=this.il.get(s))?(e=r.targetId,this.el.wc(e),n=r.view.Xc(),[3,4]):[3,1];case 1:return[4,this.tu.kh(wu(s))];case 2:return i=t.sent(),o=this.el.wc(i.targetId),e=i.targetId,[4,this.Tl(s,e,"current"===o)];case 3:n=t.sent(),this.dl&&this.tl.listen(i),t.label=4;case 4:return[2,n]}})})},ff.prototype.Tl=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.tu.xh(u,!0)];case 1:return e=t.sent(),n=new hf(u,e.Mh),r=n.Uc(e.documents),i=eo.zt(a,h&&"Offline"!==this.onlineState),o=n.qn(r,this.dl,i),this.El(a,o.zc),s=new $c(u,a,n),[2,(this.il.set(u,s),this.rl.has(a)?this.rl.get(a).push(u):this.rl.set(a,[u]),o.snapshot)]}})})},ff.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.wl("unlisten()"),e=this.il.get(i),1<(n=this.rl.get(e.targetId)).length?[2,(this.rl.set(e.targetId,n.filter(function(t){return!Tu(t,i)})),void this.il.delete(i))]:this.dl?(this.el.Ec(e.targetId),this.el.cc(e.targetId)?[3,2]:[4,this.tu.$h(e.targetId,!1).then(function(){r.el.mc(e.targetId),r.tl.pu(e.targetId),r.Il(e.targetId)}).catch(gc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Il(e.targetId),[4,this.tu.$h(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},ff.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.wl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.tu.Vh(i)];case 2:return e=t.sent(),this.el.lc(e.batchId),this.ml(e.batchId,o),[4,this.Al(e.Cn)];case 3:return t.sent(),[4,this.tl.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=rc(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},ff.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.wl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.al.get(e);n&&(Cr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Zc=!0:0<t.Jt.size?Cr(n.Zc):0<t.Xt.size&&(Cr(n.Zc),n.Zc=!1))}),[4,this.Al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,gc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ff.prototype.Hc=function(r,t){var i;(this.dl&&0===t||!this.dl&&1===t)&&(this.wl("applyOnlineStateChange()"),i=[],this.il.forEach(function(t,e){var n=e.view.Hc(r);n.snapshot&&i.push(n.snapshot)}),this.sl.Rl(r),this.sl.Ca(i),this.onlineState=r,this.dl&&this.el.Pc(r))},ff.prototype.Nu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.wl("rejectListens()"),this.el.Ac(u,"rejected",a),e=this.al.get(u),(n=e&&e.key)?(r=(r=new Pi(oi.P)).nt(n,new uu(n,ti.min())),i=Ki().add(n),o=new to(ti.min(),new Map,new Ui(Ur),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.hl=this.hl.remove(n),this.al.delete(u),this.Pl(),[3,4];case 2:return[4,this.tu.$h(u,!1).then(function(){return s.Il(u,a)}).catch(gc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},ff.prototype.Lu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.wl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.yh(r)];case 2:return n=t.sent(),this.gl(e,null),this.Vl(e),this.el.fc(e,"acknowledged"),[4,this.Al(n)];case 3:return t.sent(),[3,6];case 4:return[4,gc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ff.prototype.Bu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.wl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.tu.bh(n)];case 2:return e=t.sent(),this.gl(n,r),this.Vl(n),this.el.fc(n,"rejected",r),[4,this.Al(e)];case 3:return t.sent(),[3,6];case 4:return[4,gc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ff.prototype.yl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.tl.au()||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.tu.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.ll.get(e)||[]).push(o),this.ll.set(e,n),[3,4]);case 3:return r=t.sent(),i=rc(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},ff.prototype.Vl=function(t){(this.ll.get(t)||[]).forEach(function(t){t.resolve()}),this.ll.delete(t)},ff.prototype.pl=function(e){this.ll.forEach(function(t){t.forEach(function(t){t.reject(new Zr(Jr.CANCELLED,e))})}),this.ll.clear()},ff.prototype.ml=function(t,e){var n=this.cl[this.currentUser.Hh()];n=(n=n||new Pi(Ur)).nt(t,e),this.cl[this.currentUser.Hh()]=n},ff.prototype.gl=function(t,e){var n,r=this.cl[this.currentUser.Hh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.cl[this.currentUser.Hh()]=r)},ff.prototype.Il=function(t,e){var n=this;void 0===e&&(e=null),this.el.Ec(t);for(var r=0,i=this.rl.get(t);r<i.length;r++){var o=i[r];this.il.delete(o),e&&this.sl.bl(o,e)}this.rl.delete(t),this.dl&&this.ul.jh(t).forEach(function(t){n.ul.pi(t)||n.vl(t)})},ff.prototype.vl=function(t){var e=this.hl.get(t);null!==e&&(this.tl.pu(e),this.hl=this.hl.remove(t),this.al.delete(e),this.Pl())},ff.prototype.El=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Jc?(this.ul.Ri(i.key,t),this.Sl(i)):i instanceof Zc?(xr("SyncEngine","Document no longer in limbo: "+i.key),this.ul.gi(i.key,t),this.ul.pi(i.key)||this.vl(i.key)):Lr()}},ff.prototype.Sl=function(t){var e=t.key;this.hl.get(e)||(xr("SyncEngine","New document in limbo: "+e),this.ol.push(e),this.Pl())},ff.prototype.Pl=function(){for(;0<this.ol.length&&this.hl.size<this.nl;){var t=this.ol.shift(),e=this._l.next();this.al.set(e,new tf(t)),this.hl=this.hl.nt(t,e),this.tl.listen(new Si(wu(vu(t.path)),e,2,oa.ws))}},ff.prototype.Dl=function(){return this.hl},ff.prototype.Cl=function(){return this.ol},ff.prototype.Al=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.il.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Uc(r);return n.jc?u.tu.xh(i.query,!1).then(function(t){var e=t.documents;return i.view.Uc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.qn(t,u.dl,n);u.El(i.targetId,r.zc),r.snapshot&&(u.dl&&u.el.Ac(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ia.cs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.sl.Ca(o),[4,this.tu.Ch(s)];case 2:return t.sent(),[2]}})})},ff.prototype.wl=function(t){},ff.prototype.Uu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(xr("SyncEngine","User change. New user:",n.Hh()),[4,this.tu.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.pl("'waitForPendingWrites' promise is rejected due to a user change."),this.el.Ah(n,e.Ph,e.gh),[4,this.Al(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ff.prototype.xe=function(t){var e=this.al.get(t);if(e&&e.Zc)return Ki().add(e.key);var n=Ki(),r=this.rl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.il.get(s),n=n.Ct(u.view.Bc);return n},ff);function ff(t,e,n,r,i,o){this.tu=t,this.tl=e,this.eu=n,this.el=r,this.currentUser=i,this.nl=o,this.sl=null,this.il=new Yr(Nu,Tu),this.rl=new Map,this.ol=[],this.hl=new Pi(oi.P),this.al=new Map,this.ul=new mc,this.cl={},this.ll=new Map,this._l=Ha.si(),this.onlineState="Unknown",this.fl=void 0}function lf(t,e){this.query=t,this.xc=e,this.Mc=null,this.Ht=!1,this.Oc=Ki(),this.Lt=Ki(),this.Lc=Su(t),this.qc=new Ji(this.Lc)}function pf(){this.kc=new sf,this.$c={},this.ja=null,this.ls=null}function df(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.zu=r,this.vu=null,this.ja=null,this.ls=null,this.Hu=this.Yu.bind(this),this.Ju=new Pi(Ur),this.Hi=!1,this.Xu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Zu=Qc(this.persistenceKey,this.zu),this.tc="firestore_sequence_number_"+this.persistenceKey,this.Ju=this.Ju.nt(this.zu,new sf),this.ec=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.nc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.sc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ic="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Hu)}function yf(){this.activeTargetIds=Wi}function vf(t,e){this.clientId=t,this.onlineState=e}function gf(t,e){this.clientId=t,this.activeTargetIds=e}function mf(t,e,n){this.targetId=t,this.state=e,this.error=n}function wf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function bf(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).wl("applyBatchState()"),[4,(e=o.tu,n=a,i=(r=e).jn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.Ih.Jn(e,t):$u.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.tl.Pu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.gl(a,c||null),o.tu.jn.Gr(a)):Lr(),t.label=4;case 4:return[4,o.Al(s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Ef(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.fl?[3,3]:(e=r.el.ac(),[4,If(r,e.F())]);case 1:return i=t.sent(),r.fl=!0,[4,r.tl.Wu(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.tl.listen(u);return[3,7];case 3:return!1!==f||!1===r.fl?[3,7]:(a=[],h=Promise.resolve(),r.rl.forEach(function(t,e){r.el.Ic(e)?a.push(e):h=h.then(function(){return r.Il(e),r.tu.$h(e,!0)}),r.tl.pu(e)}),[4,h]);case 4:return t.sent(),[4,If(r,a)];case 5:return t.sent(),(n=r).al.forEach(function(t,e){n.tl.pu(e)}),n.ul.Kh(),n.al=new Map,n.hl=new Pi(oi.P),r.fl=!1,[4,r.tl.Wu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function If(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.rl.get(s))&&0!==a.length?[4,e.tu.kh(wu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.il.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).tu.xh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Jc(n),[2,(e.dl&&e.El(o.targetId,r.zc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,vc(e.tu,s)];case 8:return d=t.sent(),[4,e.tu.kh(d)];case 9:return u=t.sent(),[4,e.Tl(Tf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.sl.Ca(r),n)]}})})}function Tf(t){return yu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Nf(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).fl?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.rl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.tu,e=r.Eh,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=to.Gt(u,"current"===a),[4,n.Al(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.tu.$h(u,!0)];case 6:return t.sent(),n.Il(u,h),[3,8];case 7:Lr(),t.label=8;case 8:return[2]}var r,e})})}function Af(){this.Fl=void 0,this.listeners=[]}var _f,Sf=(Vf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Nl.get(e))||(n=!0,r=new Af),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.vu.listen(e)];case 2:return i.Fl=t.sent(),[3,4];case 3:return o=t.sent(),s=rc(o,"Initialization of query '"+Au(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.Nl.set(e,r),r.listeners.push(u),u.Hc(this.onlineState),r.Fl&&u.$l(r.Fl)&&this.xl(),[2]}})})},Vf.prototype.pu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.Nl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.Nl.delete(e),this.vu.pu(e))]:[2]})})},Vf.prototype.Ca=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Nl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].$l(i)&&(e=!0);s.Fl=i}}e&&this.xl()},Vf.prototype.bl=function(t,e){var n=this.Nl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Nl.delete(t)},Vf.prototype.Rl=function(i){this.onlineState=i;var o=!1;this.Nl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Hc(i)&&(o=!0)}),o&&this.xl()},Vf.prototype.Ml=function(t){this.kl.add(t),t.next()},Vf.prototype.Ol=function(t){this.kl.delete(t)},Vf.prototype.xl=function(){this.kl.forEach(function(t){t.next()})},Vf),kf=(Cf.prototype.$l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.ql?this.Ul(t)&&(this.Ll.next(t),o=!0):this.Wl(t,this.onlineState)&&(this.Ql(t),o=!0),this.Bl=t,o},Cf.prototype.onError=function(t){this.Ll.error(t)},Cf.prototype.Hc=function(t){this.onlineState=t;var e=!1;return this.Bl&&!this.ql&&this.Wl(this.Bl,t)&&(this.Ql(this.Bl),e=!0),e},Cf.prototype.Wl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.jl&&n||t.docs._()&&"Offline"!==e)},Cf.prototype.Ul=function(t){if(0<t.docChanges.length)return!0;var e=this.Bl&&this.Bl.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Cf.prototype.Ql=function(t){t=$i.Ut(t.query,t.docs,t.Lt,t.fromCache),this.ql=!0,this.Ll.next(t)},Cf),Df=(Lf.prototype.mh=function(t){this.Kl=t},Lf.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual(ti.min())?this.Gl(e,r):this.Kl.Jn(e,o).next(function(t){var n=s.zl(r,t);return(r.hn()||r.an())&&s.jc(r.en,n,o,i)?s.Gl(e,r):(Dr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(r)),s.Kl.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Lf.prototype.zl=function(n,t){var r=new Ui(Su(n));return t.forEach(function(t,e){e instanceof su&&_u(n,e)&&(r=r.add(e))}),r},Lf.prototype.jc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Lf.prototype.Gl=function(t,e){return Dr()<=l.DEBUG&&xr("IndexFreeQueryEngine","Using full collection scan to execute query:",Au(e)),this.Kl.ts(t,e,ti.min())},Lf),xf=(Rf.prototype.Or=function(t){return $u.resolve(0===this.jn.length)},Rf.prototype.Lr=function(t,e,n,r){var i=this.Hl;this.Hl++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new Ju(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Yl=this.Yl.add(new wc(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return $u.resolve(o)},Rf.prototype.qr=function(t,e){return $u.resolve(this.Jl(e))},Rf.prototype.Ur=function(t,e){var n=e+1,r=this.Xl(n),i=r<0?0:r;return $u.resolve(this.jn.length>i?this.jn[i]:null)},Rf.prototype.Wr=function(){return $u.resolve(0===this.jn.length?-1:this.Hl-1)},Rf.prototype.Qr=function(t){return $u.resolve(this.jn.slice())},Rf.prototype.zn=function(t,e){var n=this,r=new wc(e,0),i=new wc(e,Number.POSITIVE_INFINITY),o=[];return this.Yl.vt([r,i],function(t){var e=n.Jl(t.zh);o.push(e)}),$u.resolve(o)},Rf.prototype.Zn=function(t,e){var r=this,i=new Ui(Ur);return e.forEach(function(t){var e=new wc(t,0),n=new wc(t,Number.POSITIVE_INFINITY);r.Yl.vt([e,n],function(t){i=i.add(t.zh)})}),$u.resolve(this.Zl(i))},Rf.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;oi.W(i)||(i=i.child(""));var o=new wc(new oi(i),0),s=new Ui(Ur);return this.Yl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),$u.resolve(this.Zl(s))},Rf.prototype.Zl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&r.push(e)}),r},Rf.prototype.Kr=function(n,r){var i=this;Cr(0===this.t_(r.batchId,"removed")),this.jn.shift();var o=this.Yl;return $u.forEach(r.mutations,function(t){var e=new wc(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.Yl=o})},Rf.prototype.Gr=function(t){},Rf.prototype.pi=function(t,e){var n=new wc(e,0),r=this.Yl.Dt(n);return $u.resolve(e.isEqual(r&&r.key))},Rf.prototype.zr=function(t){return this.jn.length,$u.resolve()},Rf.prototype.t_=function(t,e){return this.Xl(t)},Rf.prototype.Xl=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},Rf.prototype.Jl=function(t){var e=this.Xl(t);return e<0||e>=this.jn.length?null:this.jn[e]},Rf),Pf=(Of.prototype.kn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.e_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},Of.prototype.xn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Of.prototype.Mn=function(t,e){var n=this.docs.get(e);return $u.resolve(n?n.Ls:null)},Of.prototype.getEntries=function(t,e){var n=this,r=qi;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),$u.resolve(r)},Of.prototype.ts=function(t,e,n){for(var r=Gi,i=new oi(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ls,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof su&&_u(e,h)&&(r=r.nt(h.key,h))}return $u.resolve(r)},Of.prototype.n_=function(t,e){return $u.forEach(this.docs,function(t){return e(t)})},Of.prototype.Hs=function(t){return new Of.Ys(this)},Of.prototype.Xs=function(t){return $u.resolve(this.size)},Of);function Of(t,e){this.Kn=t,this.e_=e,this.docs=new Pi(oi.P),this.size=0}function Rf(t,e){this.Kn=t,this.ii=e,this.jn=[],this.Hl=1,this.Yl=new Ui(wc.Lh)}function Lf(){}function Cf(t,e,n){this.query=t,this.Ll=e,this.ql=!1,this.Bl=null,this.onlineState="Unknown",this.options=n||{}}function Vf(t){this.vu=t,this.Nl=new Yr(Nu,Tu),this.onlineState="Unknown",this.kl=new Set,this.vu.subscribe(this)}function Mf(t){var e=this;return(e=_f.call(this)||this).Zs=t,e}Pf.Ys=(n(Mf,_f=ta),Mf.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.kn(n,e,r.readTime)):r.Zs.xn(t)}),$u.Sn(i)},Mf.prototype.On=function(t,e){return this.Zs.Mn(t,e)},Mf.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},Mf);var Uf,jf,qf=(rl.prototype.pe=function(t,n){return this.s_.forEach(function(t,e){return n(e)}),$u.resolve()},rl.prototype.ai=function(t){return $u.resolve(this.lastRemoteSnapshotVersion)},rl.prototype.ui=function(t){return $u.resolve(this.i_)},rl.prototype.ri=function(t){return this.highestTargetId=this.o_.next(),$u.resolve(this.highestTargetId)},rl.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.i_&&(this.i_=e),$u.resolve()},rl.prototype._i=function(t){this.s_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.o_=new Ha(e),this.highestTargetId=e),t.sequenceNumber>this.i_&&(this.i_=t.sequenceNumber)},rl.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,$u.resolve()},rl.prototype.di=function(t,e){return this._i(e),$u.resolve()},rl.prototype.wi=function(t,e){return this.s_.delete(e.target),this.r_.jh(e.targetId),--this.targetCount,$u.resolve()},rl.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.s_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.s_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),$u.Sn(u).next(function(){return s})},rl.prototype.Ii=function(t){return $u.resolve(this.targetCount)},rl.prototype.mi=function(t,e){var n=this.s_.get(e)||null;return $u.resolve(n)},rl.prototype.Ai=function(t,e,n){return this.r_.Uh(e,n),$u.resolve()},rl.prototype.Pi=function(e,t,n){this.r_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),$u.Sn(i)},rl.prototype.Ti=function(t,e){return this.r_.jh(e),$u.resolve()},rl.prototype.Vi=function(t,e){var n=this.r_.Gh(e);return $u.resolve(n)},rl.prototype.pi=function(t,e){return $u.resolve(this.r_.pi(e))},rl),Ff=(nl.prototype.start=function(){return Promise.resolve()},nl.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(nl.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),nl.prototype.Yi=function(){},nl.prototype.Xi=function(){},nl.prototype.gr=function(){return this.Kn},nl.prototype.mr=function(t){var e=this.h_[t.Hh()];return e||(e=new xf(this.Kn,this.ii),this.h_[t.Hh()]=e),e},nl.prototype.Rr=function(){return this.qi},nl.prototype.Pr=function(){return this.Qn},nl.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new Bf(this.Ci.next());return this.ii.u_(),n(i).next(function(t){return r.ii.c_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},nl.prototype.l_=function(e,n){return $u.Dn(Object.values(this.h_).map(function(t){return function(){return t.pi(e,n)}}))},nl),Bf=(n(el,jf=na),el),Gf=(tl.d_=function(t){return new tl(t)},Object.defineProperty(tl.prototype,"w_",{get:function(){if(this.f_)return this.f_;throw Lr()},enumerable:!1,configurable:!0}),tl.prototype.Ri=function(t,e,n){return this.__.Ri(n,e),this.w_.delete(n),$u.resolve()},tl.prototype.gi=function(t,e,n){return this.__.gi(n,e),this.w_.add(n),$u.resolve()},tl.prototype.Dr=function(t,e){return this.w_.add(e),$u.resolve()},tl.prototype.removeTarget=function(t,e){var n=this;this.__.jh(e.targetId).forEach(function(t){return n.w_.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.w_.add(t)})}).next(function(){return r.wi(t,e)})},tl.prototype.u_=function(){this.f_=new Set},tl.prototype.c_=function(t){var n=this,r=this.persistence.Pr().Hs();return $u.forEach(this.w_,function(e){return n.T_(t,e).next(function(t){t||r.xn(e)})}).next(function(){return n.f_=null,r.apply(t)})},tl.prototype.kr=function(t,e){var n=this;return this.T_(t,e).next(function(t){t?n.w_.delete(e):n.w_.add(e)})},tl.prototype.a_=function(t){return 0},tl.prototype.T_=function(t,e){var n=this;return $u.Dn([function(){return $u.resolve(n.__.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.l_(t,e)}])},tl),zf=($f.prototype.Sa=function(t){this.m_=t},$f.prototype.Va=function(t){this.A_=t},$f.prototype.onMessage=function(t){this.R_=t},$f.prototype.close=function(){this.I_()},$f.prototype.send=function(t){this.E_(t)},$f.prototype.P_=function(){this.m_()},$f.prototype.g_=function(t){this.A_(t)},$f.prototype.V_=function(t){this.R_(t)},$f),Hf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Kf=(Zf.prototype.Ua=function(e,t,n,r){var i=this.v_(e,t);xr("RestConnection","Sending: ",i,n);var o={};return this.S_(o,r),this.D_(e,i,o,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Zf.prototype.Wa=function(t,e,n,r){return this.Ua(t,e,n,r)},Zf.prototype.S_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2-20207421553",t["Content-Type"]="text/plain",e)for(var n in e.Xh)e.Xh.hasOwnProperty(n)&&(t[n]=e.Xh[n])},Zf.prototype.v_=function(t,e){var n=Hf[t];return this.p_+"/v1/"+e+":"+n},n(Jf,Uf=Zf),Jf.prototype.D_=function(a,e,n,r){return new Promise(function(o,s){var u=new Nr;u.listenOnce(Ir.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var t=u.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:xr("Connection",'RPC "'+a+'" timed out'),s(new Zr(Jr.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=u.getStatus();xr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Jr).indexOf(i)?i:Jr.UNKNOWN,s(new Zr(n,e.message))):s(new Zr(Jr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Zr(Jr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{xr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},Jf.prototype.Da=function(t,e){var n,r,i=[this.p_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=br(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.S_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}xr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new zf({E_:function(t){f?xr("Connection","Not sending because WebChannel is closed:",t):(c||(xr("Connection","Opening WebChannel transport."),h.open(),c=!0),xr("Connection","WebChannel sending:",t),h.send(t))},I_:function(){return h.close()}});return a(Tr.EventType.OPEN,function(){f||xr("Connection","WebChannel transport opened.")}),a(Tr.EventType.CLOSE,function(){f||(f=!0,xr("Connection","WebChannel transport closed"),l.g_())}),a(Tr.EventType.ERROR,function(t){f||(f=!0,Or("Connection","WebChannel transport errored:",t),l.g_(new Zr(Jr.UNAVAILABLE,"The operation could not be completed")))}),a(Tr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Cr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(xr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ai[i];if(void 0!==t)return xi(t)}(),s=r.message,void 0===o&&(o=Jr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.g_(new Zr(o,s)),h.close()):(xr("Connection","WebChannel received:",n),l.V_(n)))}),setTimeout(function(){l.P_()},0),l},Jf),Wf=(Yf.prototype.hu=function(t){this.x_.push(t)},Yf.prototype._r=function(){window.removeEventListener("online",this.C_),window.removeEventListener("offline",this.N_)},Yf.prototype.M_=function(){window.addEventListener("online",this.C_),window.addEventListener("offline",this.N_)},Yf.prototype.F_=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(0)},Yf.prototype.k_=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.x_;t<e.length;t++)(0,e[t])(1)},Yf.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Yf),Qf=(Xf.prototype.hu=function(t){},Xf.prototype._r=function(){},Xf);function Xf(){}function Yf(){var t=this;this.C_=function(){return t.F_()},this.N_=function(){return t.k_()},this.x_=[],this.M_()}function Jf(t){var e=this;return(e=Uf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Zf(t){this.y_=t,this.s=t.s;var e=t.ssl?"https":"http";this.p_=e+"://"+t.host,this.b_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function $f(t){this.E_=t.E_,this.I_=t.I_}function tl(t){this.persistence=t,this.__=new mc,this.f_=null}function el(t){var e=this;return(e=jf.call(this)||this).vi=t,e}function nl(t){var e=this;this.h_={},this.Ci=new oa(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new qf(this),this.Kn=new ba,this.Qn=new Pf(this.Kn,function(t){return e.ii.a_(t)})}function rl(t){this.persistence=t,this.s_=new Yr(wi,bi),this.lastRemoteSnapshotVersion=ti.min(),this.highestTargetId=0,this.i_=0,this.r_=new mc,this.targetCount=0,this.o_=Ha.ni()}function il(t){return new Lo(t,!0)}var ol,sl,ul="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",al=(dl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.el=this.O_(e),this.persistence=this.L_(e),[4,this.persistence.start()];case 1:return t.sent(),this.q_=this.B_(e),this.tu=this.U_(e),[2]}})})},dl.prototype.B_=function(t){return null},dl.prototype.U_=function(t){return e=this.persistence,n=new Df,r=t.W_,new lc(e,n,r);var e,n,r},dl.prototype.L_=function(t){if(t.j_.Q_)throw new Zr(Jr.FAILED_PRECONDITION,ul);return new Ff(Gf.d_)},dl.prototype.O_=function(t){return new af},dl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.el._r()];case 1:return t.sent(),[4,this.persistence._r()];case 2:return t.sent(),[2]}})})},dl.prototype.clearPersistence=function(t,e){throw new Zr(Jr.FAILED_PRECONDITION,ul)},dl),hl=(n(pl,sl=al),pl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,sl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Eh,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.tu)];case 2:return t.sent(),[2]}})})},pl.prototype.B_=function(t){var e=this.persistence.ii.yr;return new cc(e,t.ao)},pl.prototype.L_=function(t){var e=hh(t.y_.s,t.y_.persistenceKey),n=il(t.y_.s);return new eh(t.j_.synchronizeTabs,e,t.clientId,uc.Ho(t.j_.cacheSizeBytes),t.ao,Zh(),"undefined"!=typeof document?document:null,n,this.el,t.j_.Di)},pl.prototype.O_=function(t){return new af},pl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Uh.Oi()?(e=n+"main",[4,Uh.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(hh(t,e))},n(ll,ol=pl),ll.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,ol.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.K_.initialize(this,r)];case 2:return t.sent(),e=this.K_.vu,this.el instanceof uf?(this.el.vu={Cc:bf.bind(null,e),Fc:Nf.bind(null,e),Nc:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).fl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.rl.has(i)?(xr("SyncEngine","Adding an already active target "+i),[3,5]):[4,vc(n.tu,i)]):[3,6];case 2:return o=t.sent(),[4,n.tu.kh(o)];case 3:return s=t.sent(),[4,n.Tl(Tf(o),s.targetId,!1)];case 4:t.sent(),n.tl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.rl.has(e)?[4,n.tu.$h(e,!1).then(function(){n.tl.pu(e),n.Il(e)}).catch(gc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Ir:function(t){return t.tu.persistence.Ir()}.bind(null,e)},[4,this.el.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Ef(this.K_.vu,e)];case 1:return t.sent(),this.q_&&(e&&!this.q_.Hi?this.q_.start(this.tu):e||this.q_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},ll.prototype.O_=function(t){if(t.j_.Q_&&t.j_.synchronizeTabs){var e=Zh();if(!uf.Oi(e))throw new Zr(Jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=hh(t.y_.s,t.y_.persistenceKey);return new uf(e,t.ao,n,t.clientId,t.W_)}return new af},ll),cl=(fl.prototype.initialize=function(r,i){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.tu?[2]:(this.tu=r.tu,this.el=r.el,this.eu=this.G_(i),[4,this.z_(i)]);case 1:return e=t.sent(),this.eu.start(e),this.tl=this.H_(i),this.vu=this.Y_(i),this.J_=this.X_(i),this.el.ja=function(t){return n.vu.Hc(t,1)},this.tl.vu=this.vu,[4,this.tl.start()];case 2:return t.sent(),[4,this.tl.Wu(this.vu.dl)];case 3:return t.sent(),[2]}})})},fl.prototype.z_=function(t){return e=t.y_,Promise.resolve(new Kf(e));var e},fl.prototype.X_=function(t){return new Sf(this.vu)},fl.prototype.G_=function(t){var e,n=il(t.y_.s);return e=t.credentials,new Cc(e,n)},fl.prototype.H_=function(t){var e=this;return new Mc(this.tu,this.eu,t.ao,function(t){return e.vu.Hc(t,0)},new(Wf.Oi()?Wf:Qf))},fl.prototype.Y_=function(t){return e=this.tu,n=this.tl,r=this.eu,i=this.el,o=t.W_,s=t.nl,u=!t.j_.Q_||!t.j_.synchronizeTabs,a=new cf(e,n,r,i,o,s),u&&(a.fl=!0),a;var e,n,r,i,o,s,u,a},fl.prototype.terminate=function(){return this.tl._r()},fl);function fl(){}function ll(t){var e=this;return(e=ol.call(this)||this).K_=t,e}function pl(){return null!==sl&&sl.apply(this,arguments)||this}function dl(){}function yl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var vl=(gl.prototype.next=function(t){this.observer.next&&this.Z_(this.observer.next,t)},gl.prototype.error=function(t){this.observer.error?this.Z_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},gl.prototype.tf=function(){this.muted=!0},gl.prototype.Z_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},gl);function gl(t){this.observer=t,this.muted=!1}function ml(t,e){if(0!==e.length)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Vl(e.length,"argument")+".")}function wl(t,e,n){if(e.length!==n)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires "+Vl(n,"argument")+", but was called with "+Vl(e.length,"argument")+".")}function bl(t,e,n){if(e.length<n)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Vl(n,"argument")+", but was called with "+Vl(e.length,"argument")+".")}function El(t,e,n,r){if(e.length<n||e.length>r)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Vl(e.length,"argument")+".")}function Il(t,e,n,r){kl(t,e,Cl(n)+" argument",r)}function Tl(t,e,n,r){void 0!==r&&Il(t,e,n,r)}function Nl(t,e,n,r){kl(t,e,n+" option",r)}function Al(t,e,n,r){void 0!==r&&Nl(t,e,n,r)}function _l(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(xl(s))}var u=xl(n);throw new Zr(Jr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Sl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid value "+xl(r)+" provided to function "+t+"() for its "+Cl(n)+" argument. Acceptable values: "+e.join(", "));return r}function kl(t,e,n,r){if(!("object"===e?Dl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=xl(r);throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Dl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function xl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Pl(t,e,n){if(void 0===n)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Cl(e)+" argument, but it was undefined.")}function Ol(n,t,r){Hr(t,function(t,e){if(r.indexOf(t)<0)throw new Zr(Jr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Rl(t,e,n,r){var i=xl(r);return new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Cl(n)+" argument to be a "+e+", but it was: "+i)}function Ll(t,e,n){if(n<=0)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Cl(e)+" argument to be a positive number, but it was: "+n+".")}function Cl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Vl(t,e){return t+" "+e+(1===t?"":"s")}function Ml(){if("undefined"==typeof Uint8Array)throw new Zr(Jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ul(){if("undefined"==typeof atob)throw new Zr(Jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var jl,ql,Fl=(Xl.fromBase64String=function(t){wl("Blob.fromBase64String",arguments,1),Il("Blob.fromBase64String","string",1,t),Ul();try{return new Xl(Ii.fromBase64String(t))}catch(t){throw new Zr(Jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Xl.fromUint8Array=function(t){if(wl("Blob.fromUint8Array",arguments,1),Ml(),!(t instanceof Uint8Array))throw Rl("Blob.fromUint8Array","Uint8Array",1,t);return new Xl(Ii.fromUint8Array(t))},Xl.prototype.toBase64=function(){return wl("Blob.toBase64",arguments,0),Ul(),this.ef.toBase64()},Xl.prototype.toUint8Array=function(){return wl("Blob.toUint8Array",arguments,0),Ml(),this.ef.toUint8Array()},Xl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Xl.prototype.isEqual=function(t){return this.ef.isEqual(t.ef)},Xl),Bl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Zr(Jr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Il("FieldPath","string",e,t[e]),0===t[e].length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.nf=new ii(t)},Gl=(n(Ql,ql=Bl),Ql.documentId=function(){return new Ql(ii.L().N())},Ql.prototype.isEqual=function(t){if(!(t instanceof Ql))throw Rl("isEqual","FieldPath",1,t);return this.nf.isEqual(t.nf)},Ql),zl=new RegExp("[~\\*/\\[\\]]"),Hl=function(){this.sf=this},Kl=(n(Wl,jl=Hl),Wl.prototype.rf=function(t){if(2!==t.hf)throw 1===t.hf?t.af(this.if+"() can only appear at the top level of your update data"):t.af(this.if+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Wl.prototype.isEqual=function(t){return t instanceof Wl},Wl);function Wl(t){var e=this;return(e=jl.call(this)||this).if=t,e}function Ql(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ql.call(this,t)||this}function Xl(t){Ul(),this.ef=t}function Yl(t,e,n){return new Np({hf:3,uf:e.settings.uf,methodName:t.if,cf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Jl,Zl,$l,tp,ep,np,rp=(n(Ip,np=Hl),Ip.prototype.rf=function(t){return new Ns(t.path,new hs)},Ip.prototype.isEqual=function(t){return t instanceof Ip},Ip),ip=(n(Ep,ep=Hl),Ep.prototype.rf=function(t){var e=Yl(this,t,!0),n=this.lf.map(function(t){return Op(t,e)}),r=new cs(n);return new Ns(t.path,r)},Ep.prototype.isEqual=function(t){return this===t},Ep),op=(n(bp,tp=Hl),bp.prototype.rf=function(t){var e=Yl(this,t,!0),n=this.lf.map(function(t){return Op(t,e)}),r=new ys(n);return new Ns(t.path,r)},bp.prototype.isEqual=function(t){return this===t},bp),sp=(n(wp,$l=Hl),wp.prototype.rf=function(t){var e=new ws(t.serializer,Mo(t.serializer,this._f));return new Ns(t.path,e)},wp.prototype.isEqual=function(t){return this===t},wp),up=(n(mp,Zl=Hl),mp.delete=function(){return ml("FieldValue.delete",arguments),new ap(new Kl("FieldValue.delete"))},mp.serverTimestamp=function(){return ml("FieldValue.serverTimestamp",arguments),new ap(new rp("FieldValue.serverTimestamp"))},mp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bl("FieldValue.arrayUnion",arguments,1),new ap(new ip("FieldValue.arrayUnion",t))},mp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bl("FieldValue.arrayRemove",arguments,1),new ap(new op("FieldValue.arrayRemove",t))},mp.increment=function(t){return Il("FieldValue.increment","number",1,t),wl("FieldValue.increment",arguments,1),new ap(new sp("FieldValue.increment",t))},mp),ap=(n(gp,Jl=up),gp.prototype.rf=function(t){return this.sf.rf(t)},gp.prototype.isEqual=function(t){return t instanceof gp&&this.sf.isEqual(t.sf)},gp),hp=(Object.defineProperty(vp.prototype,"latitude",{get:function(){return this.ff},enumerable:!1,configurable:!0}),Object.defineProperty(vp.prototype,"longitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),vp.prototype.isEqual=function(t){return this.ff===t.ff&&this.df===t.df},vp.prototype.T=function(t){return Ur(this.ff,t.ff)||Ur(this.df,t.df)},vp),cp=/^__.*__$/,fp=function(t,e,n){this.wf=t,this.Tf=e,this.Ef=n},lp=(yp.prototype.If=function(t,e){var n=[];return null!==this.Le?n.push(new Us(t,this.data,this.Le,e)):n.push(new Ms(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},yp),pp=(dp.prototype.If=function(t,e){var n=[new Us(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},dp);function dp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function yp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function vp(t,e){if(wl("GeoPoint",arguments,2),Il("GeoPoint","number",1,t),Il("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Zr(Jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Zr(Jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ff=t,this.df=e}function gp(t){var e=this;return(e=Jl.call(this)||this).sf=t,e.if=t.if,e}function mp(){return Zl.call(this)||this}function wp(t,e){var n=this;return(n=$l.call(this)||this).if=t,n._f=e,n}function bp(t,e){var n=this;return(n=tp.call(this)||this).if=t,n.lf=e,n}function Ep(t,e){var n=this;return(n=ep.call(this)||this).if=t,n.lf=e,n}function Ip(t){var e=this;return(e=np.call(this)||this).if=t,e}function Tp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Np=(Object.defineProperty(Sp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"hf",{get:function(){return this.settings.hf},enumerable:!1,configurable:!0}),Sp.prototype.Af=function(t){return new Sp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Sp.prototype.Rf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.Pf(t),r},Sp.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Af({path:n,cf:!1});return r.mf(),r},Sp.prototype.Vf=function(t){return this.Af({path:void 0,cf:!0})},Sp.prototype.af=function(t){return Up(t,this.settings.methodName,this.settings.yf||!1,this.path,this.settings.uf)},Sp.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Sp.prototype.mf=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Pf(this.path.get(t))},Sp.prototype.Pf=function(t){if(0===t.length)throw this.af("Document fields must not be empty");if(Tp(this.hf)&&cp.test(t))throw this.af('Document fields cannot begin and end with "__"')},Sp),Ap=(_p.prototype.pf=function(t,e,n,r){return void 0===r&&(r=!1),new Np({hf:t,methodName:e,uf:n,path:ii.$(),cf:!1,yf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},_p);function _p(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||il(t)}function Sp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mf(),this.fieldTransforms=i||[],this.Le=o||[]}function kp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.pf(o.merge||o.mergeFields?2:0,e,n,i);Cp("Data must be an object, but it was:",s,r);var u,a,h=Rp(r,s);if(o.merge)u=new Ts(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Bl)d=p.nf;else{if("string"!=typeof p)throw Lr();d=Mp(e,p,n)}if(!s.contains(d))throw new Zr(Jr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");jp(c,d)||c.push(d)}u=new Ts(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new lp(new Ys(h),u,a)}function Dp(t,o,s,e){var u=t.pf(1,o,s);Cp("Data must be an object, but it was:",u,e);var a=[],h=new Js;Hr(e,function(t,e){var n,r=Mp(o,t,s),i=u.gf(r);e instanceof Hl&&e.sf instanceof Kl?a.push(r):null!=(n=Op(e,i))&&(a.push(r),h.set(r,n))});var n=new Ts(a);return new pp(h.Ge(),n,u.fieldTransforms)}function xp(t,e,n,r,i,o){var s=t.pf(1,e,n),u=[Vp(e,r,n)],a=[i];if(o.length%2!=0)throw new Zr(Jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Vp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Js,v=u.length-1;0<=v;--v){jp(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof Hl&&f.sf instanceof Kl?d.push(c):null!=(p=Op(f,l))&&(d.push(c),y.set(c,p)))}var g=new Ts(d);return new pp(y.Ge(),g,s.fieldTransforms)}function Pp(t,e,n,r){return void 0===r&&(r=!1),Op(n,t.pf(r?4:3,e))}function Op(s,t){if(Lp(s))return Cp("Unsupported field value:",t,s),Rp(s,t);if(s instanceof Hl)return function(t,e){if(!Tp(e.hf))throw e.af(t.if+"() can only be used with update() and set()");if(!e.path)throw e.af(t.if+"() is not currently supported inside arrays");var n=t.rf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.cf&&4!==t.hf)throw t.af("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Op(i[r],t.Vf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Mo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof hp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fl)return{bytesValue:jo(e.serializer,t)};if(t instanceof fp){var i=e.s,o=t.wf;if(!o.isEqual(i))throw e.af("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Fo(t.wf||e.s,t.Tf.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.af("Unsupported field value: "+xl(t))}(s,t)}function Rp(t,r){var i={};return Kr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Hr(t,function(t,e){var n=Op(e,r.Rf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Lp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof hp||t instanceof Fl||t instanceof fp||t instanceof Hl)}function Cp(t,e,n){if(!Lp(n)||!Dl(n)){var r=xl(n);throw"an object"===r?e.af(t+" a custom object"):e.af(t+" "+r)}}function Vp(t,e,n){if(e instanceof Bl)return e.nf;if("string"==typeof e)return Mp(t,e);throw Up("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Mp(t,e,n){try{return function(e){if(0<=e.search(zl))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Gl.bind.apply(Gl,i([void 0],e.split("."))))}catch(t){throw new Zr(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).nf}catch(e){throw Up(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Up(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Zr(Jr.INVALID_ARGUMENT,(u+=". ")+t+a)}function jp(t,e){return t.some(function(t){return t.isEqual(e)})}var qp=(Hp.prototype.Cf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new Zr(Jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Wo((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Go(i.serializer,t)})},[4,i.Wa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=zo(t,e.found.name),r=qo(e.found.updateTime),i=new Ys({mapValue:{fields:e.found.fields}});return new su(n,r,i,{})}(e,n):"missing"in n?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);var n=zo(t,e.missing),r=qo(e.readTime);return new uu(n,r)}(e,n):Lr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Cr(!!e),s.push(e)}),s)]}})})}(this.eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof uu||t instanceof su?n.Nf(t):Lr()}),e)]}})})},Hp.prototype.set=function(t,e){this.write(e.If(t,this.Ue(t))),this.Df.add(t)},Hp.prototype.update=function(t,e){try{this.write(e.If(t,this.kf(t)))}catch(t){this.Sf=t}this.Df.add(t)},Hp.prototype.delete=function(t){this.write([new Qs(t,this.Ue(t))]),this.Df.add(t)},Hp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Sf)throw this.Sf;return e=this.bf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new oi(ni.k(e));r.mutations.push(new Xs(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Wo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.Ua("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.eu,this.mutations)];case 1:return t.sent(),this.vf=!0,[2]}})})},Hp.prototype.Nf=function(t){var e;if(t instanceof su)e=t.version;else{if(!(t instanceof uu))throw Lr();e=ti.min()}var n=this.bf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Zr(Jr.ABORTED,"Document version changed between two reads.")}else this.bf.set(t.key.toString(),e)},Hp.prototype.Ue=function(t){var e=this.bf.get(t.toString());return!this.Df.has(t)&&e?Ss.updateTime(e):Ss.We()},Hp.prototype.kf=function(t){var e=this.bf.get(t.toString());if(this.Df.has(t)||!e)return Ss.exists(!0);if(e.isEqual(ti.min()))throw new Zr(Jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ss.updateTime(e)},Hp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},Hp.prototype.Ff=function(){},Hp),Fp=(zp.prototype.run=function(){this.xf()},zp.prototype.xf=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new qp(this.eu),(n=this.Mf(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.Of(t)})})}).catch(function(t){r.Of(t)}),[2]})})})},zp.prototype.Mf=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},zp.prototype.Of=function(t){var e=this;0<this.$f&&this.Lf(t)?(--this.$f,this.ao.Zi(function(){return e.xf(),Promise.resolve()})):this.lo.reject(t)},zp.prototype.Lf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Di(e)},zp),Bp=(Gp.prototype.start=function(t,e,n,r){var i=this;this.Bf(),this.y_=t;var o=new da,s=!1;return this.credentials.ea(function(t){return s?void i.ao.er(function(){return i.tl.Uu(t)}):(s=!0,xr("FirestoreClient","Initializing. user=",t.uid),i.Uf(e,n,r,t,o).then(i.qf.resolve,i.qf.reject))}),this.ao.Zi(function(){return i.qf.promise}),o.promise},Gp.prototype.enableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.tl.enableNetwork()})},Gp.prototype.Uf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ao:this.ao,y_:this.y_,clientId:this.clientId,credentials:this.credentials,W_:u,nl:100,j_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.el=i.el,this.tu=i.tu,this.q_=i.q_,this.eu=o.eu,this.tl=o.tl,this.vu=o.vu,this.Wf=o.J_,this.persistence.Yi(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Qf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Uf(new al,new cl,{Q_:!1},u,a))];case 4:return[2]}})})},Gp.prototype.Qf=function(t){return"FirebaseError"===t.name?t.code===Jr.FAILED_PRECONDITION||t.code===Jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Gp.prototype.Bf=function(){if(this.ao.yo)throw new Zr(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},Gp.prototype.disableNetwork=function(){var t=this;return this.Bf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.tl.disableNetwork()})},Gp.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.q_&&this.q_.stop(),[4,this.tl._r()];case 1:return t.sent(),[4,this.el._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.na(),[2]}})})})},Gp.prototype.waitForPendingWrites=function(){var t=this;this.Bf();var e=new da;return this.ao.Zi(function(){return t.vu.yl(e)}),e.promise},Gp.prototype.listen=function(t,e,n){var r=this;this.Bf();var i=new vl(n),o=new kf(t,i,e);return this.ao.Zi(function(){return r.Wf.listen(o)}),function(){i.tf(),r.ao.Zi(function(){return r.Wf.pu(o)})}},Gp.prototype.jf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new da,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.Nh(s)];case 1:return(e=t.sent())instanceof su?i.resolve(e):e instanceof uu?i.resolve(null):i.reject(new Zr(Jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=rc(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ao,this.tu,e))]}})})},Gp.prototype.Kf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new da,s=Kp(e,n,vu(r.path),{includeMetadataChanges:!0,jl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Zr(Jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Zr(Jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Gp.prototype.Gf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new da,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.xh(h,!0)];case 1:return e=t.sent(),n=new hf(h,e.Mh),r=n.Uc(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=rc(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ao,this.tu,e))]}})})},Gp.prototype.zf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bf(),[4,this.qf.promise];case 1:return[2,(t.sent(),e=this.ao,n=this.Wf,r=u,i=a,o=new da,s=Kp(e,n,r,{includeMetadataChanges:!0,jl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Zr(Jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Gp.prototype.write=function(t){var e=this;this.Bf();var n=new da;return this.ao.Zi(function(){return e.vu.write(t,n)}),n.promise},Gp.prototype.s=function(){return this.y_.s},Gp.prototype.Ml=function(t){var e=this;this.Bf();var n=new vl(t);return this.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ml(n)]})})}),function(){n.tf(),e.ao.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ol(n)]})})})}},Object.defineProperty(Gp.prototype,"Hf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Gp.prototype.transaction=function(t){var e=this;this.Bf();var n=new da;return this.ao.Zi(function(){return new Fp(e.ao,e.eu,t,n).run(),Promise.resolve()}),n.promise},Gp);function Gp(t,e){this.credentials=t,this.ao=e,this.clientId=Vr.t(),this.qf=new da}function zp(t,e,n,r){this.ao=t,this.eu=e,this.updateFunction=n,this.lo=r,this.$f=5,this.Po=new ya(this.ao,"transaction_retry")}function Hp(t){this.eu=t,this.bf=new Map,this.mutations=[],this.vf=!1,this.Sf=null,this.Df=new Set}function Kp(t,e,n,r,i){var o=new vl(i),s=new kf(n,o,r);return t.Zi(function(){return e.listen(s)}),function(){o.tf(),t.Zi(function(){return e.pu(s)})}}var Wp,Qp,Xp=(pd.prototype.Xf=function(t){switch(go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return No(t.integerValue||t.doubleValue);case 3:return this.Zf(t.timestampValue);case 4:return this.td(t);case 5:return t.stringValue;case 6:return new Fl(Ao(t.bytesValue));case 7:return this.ed(t.referenceValue);case 8:return this.nd(t.geoPointValue);case 9:return this.sd(t.arrayValue);case 10:return this.rd(t.mapValue);default:throw Lr()}},pd.prototype.rd=function(t){var n=this,r={};return Hr(t.fields||{},function(t,e){r[t]=n.Xf(e)}),r},pd.prototype.nd=function(t){return new hp(No(t.latitude),No(t.longitude))},pd.prototype.sd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Xf(t)})},pd.prototype.td=function(t){switch(this.Yf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return po(n)?t(n):n}(t);return null==e?null:this.Xf(e);case"estimate":return this.Zf(yo(t));default:return null}},pd.prototype.Zf=function(t){var e=To(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},pd.prototype.ed=function(t){var e=ni.k(t);Cr(is(e));var n=new Br(e.get(1),e.get(3)),r=new oi(e.V(5));return n.isEqual(this.s)||Pr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Jf(r)},pd),Yp=uc.Xo,Jp=(ld.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},ld),Zp=(Object.defineProperty(fd.prototype,"Ed",{get:function(){return this.Id||(this.Id=new Ap(this.wf,this.Td.ignoreUndefinedProperties)),this.Id},enumerable:!1,configurable:!0}),fd.prototype.settings=function(t){wl("Firestore.settings",arguments,1),Il("Firestore.settings","object",1,t);var e=new Jp(t);if(this._d&&!this.Td.isEqual(e))throw new Zr(Jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Td=e).credentials&&(this.wd=function(t){if(!t)return new kc;switch(t.type){case"gapi":var e=t.md;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pc(e,t.aa||"0");case"provider":return t.md;default:throw new Zr(Jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},fd.prototype.enableNetwork=function(){return this.ld(),this._d.enableNetwork()},fd.prototype.disableNetwork=function(){return this.ld(),this._d.disableNetwork()},fd.prototype.enablePersistence=function(t){var e,n;if(this._d)throw new Zr(Jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Pr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Zr(Jr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ad(this.od,this.hd,{Q_:!0,cacheSizeBytes:this.Td.cacheSizeBytes,synchronizeTabs:r,Di:i})},fd.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this._d&&!this._d.Hf)throw new Zr(Jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new da,[2,(this.ud.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.od.clearPersistence(this.wf,this.dd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},fd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(fd.prototype,"Rd",{get:function(){return this.ld(),this._d.Hf},enumerable:!1,configurable:!0}),fd.prototype.waitForPendingWrites=function(){return this.ld(),this._d.waitForPendingWrites()},fd.prototype.onSnapshotsInSync=function(t){if(this.ld(),yl(t))return this._d.Ml(t);Il("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this._d.Ml(e)},fd.prototype.ld=function(){return this._d||this.Ad(new al,new cl,{Q_:!1}),this._d},fd.prototype.Pd=function(){return new Fr(this.wf,this.dd,this.Td.host,this.Td.ssl,this.Td.forceLongPolling)},fd.prototype.Ad=function(t,e,n){var r=this.Pd();return this._d=new Bp(this.wd,this.ud),this._d.start(r,t,e,n)},fd.fd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Zr(Jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Zr(Jr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Br(n)},Object.defineProperty(fd.prototype,"app",{get:function(){if(!this.ad)throw new Zr(Jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ad},enumerable:!1,configurable:!0}),fd.prototype.collection=function(t){return wl("Firestore.collection",arguments,1),Il("Firestore.collection","non-empty string",1,t),this.ld(),new Ed(ni.k(t),this,null)},fd.prototype.doc=function(t){return wl("Firestore.doc",arguments,1),Il("Firestore.doc","non-empty string",1,t),this.ld(),ed.gd(ni.k(t),this,null)},fd.prototype.collectionGroup=function(t){if(wl("Firestore.collectionGroup",arguments,1),Il("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ld(),new wd((e=t,new pu(ni.$(),e)),this,null);var e},fd.prototype.runTransaction=function(e){var n=this;return wl("Firestore.runTransaction",arguments,1),Il("Firestore.runTransaction","function",1,e),this.ld().transaction(function(t){return e(new $p(n,t))})},fd.prototype.batch=function(){return this.ld(),new td(this)},Object.defineProperty(fd,"logLevel",{get:function(){switch(Dr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),fd.setLogLevel=function(t){wl("Firestore.setLogLevel",arguments,1),Sl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),kr.setLogLevel(t)},fd.prototype.Vd=function(){return this.Td.timestampsInSnapshots},fd),$p=(cd.prototype.get=function(t){var n=this;wl("Transaction.get",arguments,1);var r=kd("Transaction.get",t,this.yd);return this.pd.Cf([r.Tf]).then(function(t){if(!t||1!==t.length)return Lr();var e=t[0];if(e instanceof uu)return new rd(n.yd,r.Tf,null,!1,!1,r.Ef);if(e instanceof su)return new rd(n.yd,r.Tf,e,!1,!1,r.Ef);throw Lr()})},cd.prototype.set=function(t,e,n){El("Transaction.set",arguments,2,3);var r=kd("Transaction.set",t,this.yd);n=Ad("Transaction.set",n);var i=Dd(r.Ef,e,n),o=kp(this.yd.Ed,"Transaction.set",r.Tf,i,null!==r.Ef,n);return this.pd.set(r.Tf,o),this},cd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Gl?(bl("Transaction.update",arguments,3),r=kd("Transaction.update",t,this.yd),xp(this.yd.Ed,"Transaction.update",r.Tf,e,n,o)):(wl("Transaction.update",arguments,2),r=kd("Transaction.update",t,this.yd),Dp(this.yd.Ed,"Transaction.update",r.Tf,e)),this.pd.update(r.Tf,i),this},cd.prototype.delete=function(t){wl("Transaction.delete",arguments,1);var e=kd("Transaction.delete",t,this.yd);return this.pd.delete(e.Tf),this},cd),td=(hd.prototype.set=function(t,e,n){El("WriteBatch.set",arguments,2,3),this.Sd();var r=kd("WriteBatch.set",t,this.yd);n=Ad("WriteBatch.set",n);var i=Dd(r.Ef,e,n),o=kp(this.yd.Ed,"WriteBatch.set",r.Tf,i,null!==r.Ef,n);return this.bd=this.bd.concat(o.If(r.Tf,Ss.We())),this},hd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Sd(),i="string"==typeof e||e instanceof Gl?(bl("WriteBatch.update",arguments,3),r=kd("WriteBatch.update",t,this.yd),xp(this.yd.Ed,"WriteBatch.update",r.Tf,e,n,o)):(wl("WriteBatch.update",arguments,2),r=kd("WriteBatch.update",t,this.yd),Dp(this.yd.Ed,"WriteBatch.update",r.Tf,e)),this.bd=this.bd.concat(i.If(r.Tf,Ss.exists(!0))),this},hd.prototype.delete=function(t){wl("WriteBatch.delete",arguments,1),this.Sd();var e=kd("WriteBatch.delete",t,this.yd);return this.bd=this.bd.concat(new Qs(e.Tf,Ss.We())),this},hd.prototype.commit=function(){return this.Sd(),this.vd=!0,0<this.bd.length?this.yd.ld().write(this.bd):Promise.resolve()},hd.prototype.Sd=function(){if(this.vd)throw new Zr(Jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},hd),ed=(n(ad,Qp=fp),ad.gd=function(t,e,n){if(t.length%2!=0)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new ad(new oi(t),e,n)},Object.defineProperty(ad.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"parent",{get:function(){return new Ed(this.Tf.path.p(),this.firestore,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"path",{get:function(){return this.Tf.path.N()},enumerable:!1,configurable:!0}),ad.prototype.collection=function(t){if(wl("DocumentReference.collection",arguments,1),Il("DocumentReference.collection","non-empty string",1,t),!t)throw new Zr(Jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ni.k(t);return new Ed(this.Tf.path.child(e),this.firestore,null)},ad.prototype.isEqual=function(t){if(!(t instanceof ad))throw Rl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Tf.isEqual(t.Tf)&&this.Ef===t.Ef},ad.prototype.set=function(t,e){El("DocumentReference.set",arguments,1,2),e=Ad("DocumentReference.set",e);var n=Dd(this.Ef,t,e),r=kp(this.firestore.Ed,"DocumentReference.set",this.Tf,n,null!==this.Ef,e);return this._d.write(r.If(this.Tf,Ss.We()))},ad.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Gl?(bl("DocumentReference.update",arguments,2),xp(this.firestore.Ed,"DocumentReference.update",this.Tf,t,e,r)):(wl("DocumentReference.update",arguments,1),Dp(this.firestore.Ed,"DocumentReference.update",this.Tf,t)),this._d.write(n.If(this.Tf,Ss.exists(!0)))},ad.prototype.delete=function(){return wl("DocumentReference.delete",arguments,0),this._d.write([new Qs(this.Tf,Ss.We())])},ad.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];El("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||yl(i[u])||(Ol("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Al("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};yl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Il("DocumentReference.onSnapshot","function",u,i[u]),Tl("DocumentReference.onSnapshot","function",u+1,i[u+1]),Tl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Dd(t))},error:i[u+1],complete:i[u+2]};return this._d.listen(vu(this.Tf.path),h,c)},ad.prototype.get=function(t){var e=this;El("DocumentReference.get",arguments,0,1),Sd("DocumentReference.get",t);var n=this.firestore.ld();return t&&"cache"===t.source?n.jf(this.Tf).then(function(t){return new rd(e.firestore,e.Tf,t,!0,t instanceof su&&t.Ke,e.Ef)}):n.Kf(this.Tf,t).then(function(t){return e.Dd(t)})},ad.prototype.withConverter=function(t){return new ad(this.Tf,this.firestore,t)},ad.prototype.Dd=function(t){var e=t.docs.get(this.Tf);return new rd(this.firestore,this.Tf,e,t.fromCache,t.hasPendingWrites,this.Ef)},ad),nd=(ud.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ud),rd=(sd.prototype.data=function(t){var e=this;if(El("DocumentSnapshot.data",arguments,0,1),t=_d("DocumentSnapshot.data",t),this.Cd){if(this.Ef){var n=new id(this.yd,this.Tf,this.Cd,this.Fd,this.Nd,null);return this.Ef.fromFirestore(n,t)}return new Xp(this.yd.wf,this.yd.Vd(),t.serverTimestamps||"none",function(t){return new ed(t,e.yd,null)}).Xf(this.Cd.Ze())}},sd.prototype.get=function(t,e){var n=this;if(El("DocumentSnapshot.get",arguments,1,2),e=_d("DocumentSnapshot.get",e),this.Cd){var r=this.Cd.data().field(Vp("DocumentSnapshot.get",t,this.Tf));if(null!==r)return new Xp(this.yd.wf,this.yd.Vd(),e.serverTimestamps||"none",function(t){return new ed(t,n.yd,n.Ef)}).Xf(r)}},Object.defineProperty(sd.prototype,"id",{get:function(){return this.Tf.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"ref",{get:function(){return new ed(this.Tf,this.yd,this.Ef)},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"exists",{get:function(){return null!==this.Cd},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"metadata",{get:function(){return new nd(this.Nd,this.Fd)},enumerable:!1,configurable:!0}),sd.prototype.isEqual=function(t){if(!(t instanceof sd))throw Rl("isEqual","DocumentSnapshot",1,t);return this.yd===t.yd&&this.Fd===t.Fd&&this.Tf.isEqual(t.Tf)&&(null===this.Cd?null===t.Cd:this.Cd.isEqual(t.Cd))&&this.Ef===t.Ef},sd),id=(n(od,Wp=rd),od.prototype.data=function(t){return Wp.prototype.data.call(this,t)},od);function od(){return null!==Wp&&Wp.apply(this,arguments)||this}function sd(t,e,n,r,i,o){this.yd=t,this.Tf=e,this.Cd=n,this.Fd=r,this.Nd=i,this.Ef=o}function ud(t,e){this.hasPendingWrites=t,this.fromCache=e}function ad(t,e,n){var r=this;return(r=Qp.call(this,e.wf,t,n)||this).Tf=t,r.firestore=e,r.Ef=n,r._d=r.firestore.ld(),r}function hd(t){this.yd=t,this.bd=[],this.vd=!1}function cd(t,e){this.yd=t,this.pd=e}function fd(t,e,n,r){var i=this;if(void 0===n&&(n=new al),void 0===r&&(r=new cl),this.od=n,this.hd=r,this.ad=null,this.ud=new tc,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ld(),[4,this._d.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ad=o,this.wf=fd.fd(o),this.dd=o.name,this.wd=new Dc(e)}else{var s=t;if(!s.projectId)throw new Zr(Jr.INVALID_ARGUMENT,"Must provide projectId");this.wf=new Br(s.projectId,s.database),this.dd="[DEFAULT]",this.wd=new kc}this.Td=new Jp({})}function ld(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Zr(Jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Nl("settings","non-empty string","host",t.host),this.host=t.host,Al("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ol("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Al("settings","object","credentials",t.credentials),this.credentials=t.credentials,Al("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Al("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Pr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Pr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Al("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=uc.th;else{if(t.cacheSizeBytes!==Yp&&t.cacheSizeBytes<uc.Zo)throw new Zr(Jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+uc.Zo);this.cacheSizeBytes=t.cacheSizeBytes}Al("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function pd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Yf=n,this.Jf=r}function dd(t,e,n){if("string"==typeof n){if(""===n)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!gu(e)&&-1!==n.indexOf("/"))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ni.k(n));if(!oi.W(r))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return _o(t,new oi(r))}if(n instanceof fp)return _o(t,n.Tf);throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+xl(n)+".")}function yd(t,e){if(!Array.isArray(t)||0===t.length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function vd(t,e,n){if(!n.isEqual(e))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gd(t){if(t.an()&&0===t.tn.length)throw new Zr(Jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var md,wd=(Nd.prototype.where=function(t,e,n){wl("Query.where",arguments,3),Pl("Query.where",3,n);var r,i,o=Sl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Vp("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.O()){if("array-contains"===o||"array-contains-any"===o)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){yd(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var f=c[h];a.push(dd(r,t,f))}u={arrayValue:{values:a}}}else u=dd(r,t,s)}else"in"!==o&&"array-contains-any"!==o||yd(s,o),u=Pp(n,e,s,"in"===o);var l=Du.create(i,o,u);return function(t,e){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&vd(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}(t,l),l}(this.kd,"Query.where",this.firestore.Ed,this.firestore.wf,s,o,n);return new Nd((r=this.kd,i=r.filters.concat([u]),new pu(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},Nd.prototype.orderBy=function(t,e){var n;if(El("Query.orderBy",arguments,1,2),Tl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Zr(Jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Vp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new Yu(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&vd(0,o,i.field),s}(this.kd,o,n);return new Nd((r=this.kd,i=r.tn.concat([s]),new pu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Ef)},Nd.prototype.limit=function(t){return wl("Query.limit",arguments,1),Il("Query.limit","number",1,t),Ll("Query.limit",1,t),new Nd(bu(this.kd,t,"F"),this.firestore,this.Ef)},Nd.prototype.limitToLast=function(t){return wl("Query.limitToLast",arguments,1),Il("Query.limitToLast","number",1,t),Ll("Query.limitToLast",1,t),new Nd(bu(this.kd,t,"L"),this.firestore,this.Ef)},Nd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bl("Query.startAt",arguments,1);var r=this.$d("Query.startAt",t,e,!0);return new Nd(Eu(this.kd,r),this.firestore,this.Ef)},Nd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bl("Query.startAfter",arguments,1);var r=this.$d("Query.startAfter",t,e,!1);return new Nd(Eu(this.kd,r),this.firestore,this.Ef)},Nd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bl("Query.endBefore",arguments,1);var r=this.$d("Query.endBefore",t,e,!0);return new Nd(Iu(this.kd,r),this.firestore,this.Ef)},Nd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];bl("Query.endAt",arguments,1);var r=this.$d("Query.endAt",t,e,!1);return new Nd(Iu(this.kd,r),this.firestore,this.Ef)},Nd.prototype.isEqual=function(t){if(!(t instanceof Nd))throw Rl("isEqual","Query",1,t);return this.firestore===t.firestore&&Tu(this.kd,t.kd)&&this.Ef===t.Ef},Nd.prototype.withConverter=function(t){return new Nd(this.kd,this.firestore,t)},Nd.prototype.$d=function(c,t,e,n){if(Pl(c,1,t),t instanceof rd)return wl(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Zr(Jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=mu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(_o(e,n.key));else{var a=n.field(u.field);if(po(a))throw new Zr(Jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Fu(i,r)}(this.kd,this.firestore.wf,t.Cd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Zr(Jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!gu(t)&&-1!==h.indexOf("/"))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ni.k(h));if(!oi.W(c))throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new oi(c);u.push(_o(e,f))}else{var l=Pp(n,r,h);u.push(l)}}return new Fu(u,o)}(this.kd,this.firestore.wf,this.firestore.Ed,c,r,n)},Nd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];El("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||yl(i[a])||(Ol("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Al("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),yl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Il("Query.onSnapshot","function",a,i[a]),Tl("Query.onSnapshot","function",a+1,i[a+1]),Tl("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new bd(r.firestore,r.kd,t,r.Ef))},error:i[a+1],complete:i[a+2]};return gd(this.kd),this.firestore.ld().listen(this.kd,u,h)},Nd.prototype.get=function(t){var e=this;El("Query.get",arguments,0,1),Sd("Query.get",t),gd(this.kd);var n=this.firestore.ld();return(t&&"cache"===t.source?n.Gf(this.kd):n.zf(this.kd,t)).then(function(t){return new bd(e.firestore,e.kd,t,e.Ef)})},Nd),bd=(Object.defineProperty(Td.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"empty",{get:function(){return this.Md.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"size",{get:function(){return this.Md.docs.size},enumerable:!1,configurable:!0}),Td.prototype.forEach=function(e,n){var r=this;El("QuerySnapshot.forEach",arguments,1,2),Il("QuerySnapshot.forEach","function",1,e),this.Md.docs.forEach(function(t){e.call(n,r.qd(t,r.metadata.fromCache,r.Md.Lt.has(t.key)))})},Object.defineProperty(Td.prototype,"query",{get:function(){return new wd(this.xd,this.yd,this.Ef)},enumerable:!1,configurable:!0}),Td.prototype.docChanges=function(t){t&&(Ol("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Al("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Md.Bt)throw new Zr(Jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Od&&this.Ld===e||(this.Od=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Md,e,this.qd.bind(this)),this.Ld=e),this.Od},Td.prototype.isEqual=function(t){if(!(t instanceof Td))throw Rl("isEqual","QuerySnapshot",1,t);return this.yd===t.yd&&Tu(this.xd,t.xd)&&this.Md.isEqual(t.Md)&&this.Ef===t.Ef},Td.prototype.qd=function(t,e,n){return new id(this.yd,t.key,t,e,n,this.Ef)},Td),Ed=(n(Id,md=wd),Object.defineProperty(Id.prototype,"id",{get:function(){return this.kd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"parent",{get:function(){var t=this.kd.path.p();return t._()?null:new ed(new oi(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"path",{get:function(){return this.kd.path.N()},enumerable:!1,configurable:!0}),Id.prototype.doc=function(t){El("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Vr.t()),Il("CollectionReference.doc","non-empty string",1,t);var e=ni.k(t);return ed.gd(this.kd.path.child(e),this.firestore,this.Ef)},Id.prototype.add=function(t){wl("CollectionReference.add",arguments,1),Il("CollectionReference.add","object",1,this.Ef?this.Ef.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Id.prototype.withConverter=function(t){return new Id(this.Bd,this.firestore,t)},Id);function Id(t,e,n){var r=this;if(((r=md.call(this,vu(t),e,n)||this).Bd=t).length%2!=1)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function Td(t,e,n,r){this.yd=t,this.xd=e,this.Md=n,this.Ef=r,this.Od=null,this.Ld=null,this.metadata=new nd(n.hasPendingWrites,n.fromCache)}function Nd(t,e,n){this.kd=t,this.firestore=e,this.Ef=n}function Ad(t,e){if(void 0===e)return{merge:!1};if(Ol(t,e,["merge","mergeFields"]),Al(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+xl(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Zr(Jr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+xl(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Gl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function _d(t,e){return void 0===e?{}:(Ol(t,e,["serverTimestamps"]),_l(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Sd(t,e){Tl(t,"object",1,e),e&&(Ol(t,e,["source"]),_l(t,0,"source",e.source,["default","server","cache"]))}function kd(t,e,n){if(e instanceof fp){if(e.firestore!==n)throw new Zr(Jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Rl(t,"DocumentReference",1,e)}function Dd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var xd,Pd={Firestore:Zp,GeoPoint:hp,Timestamp:$r,Blob:Fl,Transaction:$p,WriteBatch:td,DocumentReference:ed,DocumentSnapshot:rd,Query:wd,QueryDocumentSnapshot:id,QuerySnapshot:bd,CollectionReference:Ed,FieldPath:Gl,FieldValue:up,setLogLevel:Zp.setLogLevel,CACHE_SIZE_UNLIMITED:Yp};(xd=Od).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new cl,i=new hl(r),new Zp(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Pd))),xd.registerVersion("@firebase/firestore","1.16.3-20207421553")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
