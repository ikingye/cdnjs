!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ff){"use strict";try{(function(){ff=ff&&Object.prototype.hasOwnProperty.call(ff,"default")?ff.default:ff;var t,a,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function y(n,i){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var u={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},h=a.INFO,c=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(n(w,v=Error),w);function w(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={},O=_||self;function S(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++V))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var $=O.navigator;if($){var J=$.userAgent;if(J){W=J;break t}}W=""}function Z(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function it(t){return it[" "](t),t}it[" "]=S;var rt,ot,st=X(W,"Opera"),at=X(W,"Trident")||X(W,"MSIE"),ut=X(W,"Edge"),ht=ut||at,ct=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),lt=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ft(){var t=O.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=W,ct?/rv:([^\);]+)(\)|;)/.exec(ot):ut?/Edge\/([\d\.]+)/.exec(ot):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):lt?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),at){var yt=ft();if(null!=yt&&yt>parseFloat(pt)){rt=String(yt);break t}}rt=pt}var vt={};function gt(a){return t=a,e=function(){for(var t=0,e=Y(String(rt)).split("."),n=Y(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=O.document&&at?ft()||(parseInt(rt,10)||void 0):void 0,wt=!at||9<=Number(mt),bt=at&&!gt("9"),Et=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",S,e),O.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{it(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},F(Tt,It);var At={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Rt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++_t,this.Y=this.Z=!1}function Ot(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=G(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(Ot(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}St.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Rt(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Gt(i);return e&&e[Nt]?e.wa(n,i,P(r)?!!r.capture:!!r,o):Ct(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=Gt(n),t&&t[Nt]?t.va(e,n,P(i)?!!i.capture:!!i,r):Ct(t,e,n,!1,i,r)}function Ct(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=P(r)?!!r.capture:!!r;if(s&&!wt)return null;var a,u,h=Ft(t);if(h||(t[Pt]=h=new St(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(a=qt,i=u=wt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Et||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ut(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?Dt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Mt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ft(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Ot(t)))}function Mt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function xt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Ut(t),n.call(i,e)}function qt(t,e){if(t.Y)return!0;if(wt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=O,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function Ft(t){return(t=t[Pt])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==D(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Bt(){j.call(this),this.c=new St(this),(this.J=this).C=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Dt(t.c,u),r=!1!==s.call(a,i)&&r)}return r&&!i.defaultPrevented}F(Bt,j),Bt.prototype[Nt]=!0,(N=Bt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=P(r)?!!r.capture:!!r,i=Gt(i),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=kt(s=e.a[n],i,r,o))&&(Ot(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ut(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=zt(o,i,!0,t)&&s;if(s=zt(o=t.a=n,i,!0,t)&&s,s=zt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=zt(o=t.a=e[r],i,!1,t)&&s;return s},N.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Ot(n[i]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Ht=O.JSON.stringify;function Kt(){this.b=this.a=null}var Wt,Yt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Qt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function $t(t,e){var n;Wt||(n=O.Promise.resolve(void 0),Wt=function(){n.then(te)}),Jt||(Wt(),Jt=!0),Zt.add(t,e)}Kt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Kt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var i=Yt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Jt=!1}function ee(t,e){Bt.call(this),this.b=t||1,this.a=e||O,this.f=M(this.Ya,this),this.g=q()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==D(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}F(ee,Bt),(N=ee.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},N.G=function(){ee.S.G.call(this),ne(this),delete this.a};var re,oe,se,ae=(T(oe=he,se=re=j),oe.prototype=null===se?Object.create(se):(ue.prototype=se.prototype,new ue),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){re.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ue(){this.constructor=oe}function he(t,e,n){var i=re.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function ce(t){j.call(this),this.b=t,this.a={}}F(ce,j);var le=[];function fe(t,e,n,i){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Bt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Te(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}F(me,It),F(be,It),F(Ie,It);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Re(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}_e.prototype.a=null;var Se,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ke(){It.call(this,"d")}function Pe(){It.call(this,"c")}function Le(){}function Ve(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new ce(this),this.P=Ce,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(ke,It),F(Pe,It),F(Le,_e),Se=new Le;var Ce=45e3,Ue={},Me={};function xe(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),je(t),t.l=Ze(t.i);var s,a,u,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),wn(n.b,"t",i),t.D=0,t.a=fi(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function Fe(t,e,n){for(var i,r,o,s,a=!0;!t.A&&t.D<n.length;){var u=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?Me:(o=Number(r.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>r.length?Me:(r=r.substr(s,o),i.D=s+o,r)));if(u==Me){4==e&&(t.h=4,Ee(14),a=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ue){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}ye(t.c,t.f,u,null),Ke(t,u)}4==e&&0==n.length&&(t.h=1,Ee(16),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ri(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),ze(t))}function je(t){t.U=q()+t.P,Ge(t,t.P)}function Ge(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(M(t.Ua,t),e)}function Be(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ai(t.g,t)}function He(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,i,r,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;si(p),Xn(p)}ii(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(M(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hi(p,11)}else if(!t.C&&p.a!=t||si(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(X(a,"spdy")||X(a,"quic")||X(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Rn(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=li(o,o.C?o.ga:null,o.fa),c.C?(On(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Be(l),je(l)),o.a=c):ni(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||hi(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hi(p,7):Yn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ye)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Qe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Qe(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Ve.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),i=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||i<=0?3:2),Be(this);var r=this.a.X();this.N=r;var o=this.a.$();if(this.b=200==r,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,y=r,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Ee(12),He(this),ze(this);break t}ye(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(Fe(this,e,o),ht&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),Ke(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?ai(this.g,this):(this.b=!1,je(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),He(this),ze(this)}}}catch(t){}var h,c,l,f,p,d,y},N.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),Fe(this,t,e),this.b&&4!=t&&je(this)))},N.cancel=function(){this.A=!0,He(this)},N.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),He(this),this.h=2,ze(this)):Ge(this,this.U-n)},(N=Ye.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Xe(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function Ze(t){return new Je(t)}function tn(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var i,r;e instanceof yn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(vn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},i)),i.f=r):(n||(e=un(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,dn)),t.join("")};var cn=/[#\/\?@]/g,ln=/[#\?:]/g,fn=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new Ye,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i,r=t[n].indexOf("="),o=null;0<=r?(i=t[n].substring(0,r),o=t[n].substring(r+1)):i=t[n],e(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function mn(t,e){return vn(t),e=bn(t,e),Qe(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),H(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||Tn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){vn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(i,t,e,this)},this)},this)},N.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Rn(t,e){t.a?t.a.add(e):t.b=e}function On(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var i=t.c;try{for(var r=A(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Dn(){}function kn(){this.a=new Dn}function Pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Ln=O.JSON.parse;function Vn(t){Bt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}F(Vn,Bt);var Cn="",Un=/^https?$/i,Mn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),Gn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match($e)[1]||null)&&O.self&&O.self.location&&(r=(i=O.self.location.protocol).substr(0,i.length-1)),n=!Un.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<zn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Fn(t)}}finally{Gn(t)}}}function Gn(t,e){if(t.a){Bn(t);var n=t.a,i=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",Z(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Yn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,on(n=Ze(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),ti(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=fi(e.g,null),e.a.ba(e.i)),e.u=q(),je(e)),ci(t)}function Xn(t){t.a&&(ri(t),t.a.cancel(),t.a=null)}function Qn(t){Xn(t),t.j&&(O.clearTimeout(t.j),t.j=null),si(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){An(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,i=Ze(t.B);on(i,"SID",t.J),on(i,"RID",n),on(i,"AID",t.P),ti(t,i),t.i&&t.l&&Hn(i,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ei(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Rn(t.b,n),xe(n,i,e)}function ti(t,n){t.f&&We({},function(t,e){on(n,e,t)})}function ei(t,e,n){n=Math.min(t.g.length,n);var i=t.f?M(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{!function(t,i,e){var r=e||"";try{We(t,function(t,e){var n=t;P(t)&&(n=Ht(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ni(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function ii(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(M(t.Aa,t),ui(t,t.o)),t.o++,1)}function ri(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function oi(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),ti(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,qe(n,t)}function si(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ai(t,e){var n,i=null;if(t.a==e){si(t),ri(t),t.a=null;var r=2}else{if(!_n(t.b,e))return;i=e.s,On(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b){1==r?(i=e.j?e.j.length:0,e=q()-e.u,n=t.u,(r=ge()).dispatchEvent(new Ie(r)),Jn(t)):ni(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(M(t.Ba,t,e),ui(t,t.u)),t.u++,1}}(t,e)||2==r&&ii(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:hi(t,5);break;case 4:hi(t,10);break;case 3:hi(t,6);break;default:hi(t,2)}}function ui(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hi(t,e){var n,i,r,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=M(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||tn(n,"https"),sn(n)),r=n.toString(),o=i,a=new de,O.Image?((s=new Image).onload=x(Pn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=x(Pn,a,s,"TestLoadImage: error",!1,o),s.onabort=x(Pn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(Pn,a,s,"TestLoadImage: timeout",!1,o),O.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),ci(t),Qn(t)}function ci(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function li(t,e,n){var i,r,o,s,a,u,h,c=(i=n)instanceof Je?Ze(i):new Je(i,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(r=O.location,o=r.protocol,s=e?e+"."+r.hostname:r.hostname,a=+r.port,u=n,h=new Je(null,void 0),o&&tn(h,o),s&&en(h,s),a&&nn(h,a),u&&(h.g=u),c=h),t.W&&Z(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),ti(t,c),c}function fi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function pi(){}function di(){if(at&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yi(t,e){Bt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mi(this)}function vi(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gi(){Pe.call(this),this.status=1}function mi(t){this.a=t}(N=Vn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Re(this.H):Re(Se),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var r,o=new Ye(this.headers);i&&We(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=xn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=G(Mn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(r=this.a,at&&gt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},N.xa=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),Vn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},N.Ta=function(){jn(this)},N.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),i=this.l;if(this.O&&(i?nt(i=tt(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ei(this,n,e),on(r=Ze(this.B),"RID",t),on(r,"CVER",22),this.A&&on(r,"X-HTTP-Session-Id",this.A),ti(this,r),this.i&&i&&Hn(r,this.i,i),Rn(this.b,n),this.Ga&&on(r,"TYPE","init"),this.da?(on(r,"$req",e),on(r,"SID","null"),n.V=!0,xe(n,r,null)):xe(n,r,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||An(this.b)||Zn(this))},N.Aa=function(){var t;this.j=null,oi(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),oi(this))},N.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ii(this),Ee(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(N=pi.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},di.prototype.a=function(t,e){return new yi(t,e)},F(yi,Bt),(N=yi.prototype).addEventListener=function(t,e,n,i){yi.S.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){yi.S.removeEventListener.call(this,t,e,n,i)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=li(t,null,t.fa),Jn(t)},N.close=function(){Yn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,yi.S.G.call(this)},F(vi,ke),F(gi,Pe),F(mi,pi),mi.prototype.ta=function(){this.a.dispatchEvent("a")},mi.prototype.sa=function(t){this.a.dispatchEvent(new vi(t))},mi.prototype.ra=function(t){this.a.dispatchEvent(new gi)},mi.prototype.qa=function(){this.a.dispatchEvent("b")},di.prototype.createWebChannel=di.prototype.a,yi.prototype.send=yi.prototype.Pa,yi.prototype.open=yi.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ne.COMPLETE="complete",(Oe.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var wi={createWebChannelTransport:function(){return new di},ErrorCode:Ae,EventType:Ne,WebChannel:Oe,XhrIo:Vn},bi=wi.createWebChannelTransport,Ei=wi.ErrorCode,Ii=wi.EventType,Ti=wi.WebChannel,Ai=wi.XhrIo,Ni=(_i.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_i.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_i.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_i);function _i(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ri="7.17.2-20207421553",Oi=new l("@firebase/firestore");function Si(){return Oi.logLevel}function Di(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.DEBUG&&(e=n.map(Li),Oi.debug.apply(Oi,r(["Firestore ("+Ri+"): "+t],e)))}function ki(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.ERROR&&(e=n.map(Li),Oi.error.apply(Oi,r(["Firestore ("+Ri+"): "+t],e)))}function Pi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Oi.logLevel<=a.WARN&&(e=n.map(Li),Oi.warn.apply(Oi,r(["Firestore ("+Ri+"): "+t],e)))}function Li(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Ri+") INTERNAL ASSERTION FAILED: "+t;throw ki(e),new Error(e)}function Ci(t){t||Vi()}var Ui=(Mi.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Mi);function Mi(){}function xi(t,e){return t<e?-1:e<t?1:0}function qi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Fi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var ji=(Object.defineProperty(Gi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gi.prototype.isEqual=function(t){return t instanceof Gi&&t.projectId===this.projectId&&t.database===this.database},Gi.prototype.o=function(t){return xi(this.projectId,t.projectId)||xi(this.database,t.database)},Gi);function Gi(t,e){this.projectId=t,this.database=e||"(default)"}function Bi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Hi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ki,Wi,Yi,Xi=(fr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(this.u(s,t))return a}},fr.prototype.has=function(t){return void 0!==this.get(t)},fr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},fr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},fr.prototype.forEach=function(a){zi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},fr.prototype._=function(){return Hi(this.l)},fr),Qi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$i=(n(lr,Yi=Error),lr),Ji=(cr.now=function(){return cr.fromMillis(Date.now())},cr.fromDate=function(t){return cr.fromMillis(t.getTime())},cr.fromMillis=function(t){var e=Math.floor(t/1e3);return new cr(e,1e6*(t-1e3*e))},cr.prototype.toDate=function(){return new Date(this.toMillis())},cr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},cr.prototype.T=function(t){return this.seconds===t.seconds?xi(this.nanoseconds,t.nanoseconds):xi(this.seconds,t.seconds)},cr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},cr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},cr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},cr),Zi=(hr.m=function(t){return new hr(t)},hr.min=function(){return new hr(new Ji(0,0))},hr.prototype.o=function(t){return this.timestamp.T(t.timestamp)},hr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},hr.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},hr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},hr.prototype.R=function(){return this.timestamp},hr),tr=(Object.defineProperty(ur.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),ur.prototype.isEqual=function(t){return 0===ur.P(this,t)},ur.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ur?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ur.prototype.limit=function(){return this.offset+this.length},ur.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ur.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ur.prototype.v=function(){return this.segments[this.offset]},ur.prototype.S=function(){return this.get(this.length-1)},ur.prototype.get=function(t){return this.segments[this.offset+t]},ur.prototype._=function(){return 0===this.length},ur.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ur.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ur.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ur.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ur.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ur),er=(n(ar,Wi=tr),ar.prototype.V=function(t,e,n){return new ar(t,e,n)},ar.prototype.$=function(){return this.F().join("/")},ar.prototype.toString=function(){return this.$()},ar.N=function(t){if(0<=t.indexOf("//"))throw new $i(Qi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ar(t.split("/").filter(function(t){return 0<t.length}))},ar.k=function(){return new ar([])},ar),nr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ir=(n(sr,Ki=tr),sr.prototype.V=function(t,e,n){return new sr(t,e,n)},sr.L=function(t){return nr.test(t)},sr.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.L(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.$()},sr.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},sr.q=function(){return new sr(["__name__"])},sr.M=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new $i(Qi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new $i(Qi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new $i(Qi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new $i(Qi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr.k=function(){return new sr([])},sr),rr=(or.U=function(t){return new or(er.N(t).p(5))},or.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},or.prototype.isEqual=function(t){return null!==t&&0===er.P(this.path,t.path)},or.prototype.toString=function(){return this.path.toString()},or.P=function(t,e){return er.P(t.path,e.path)},or.W=function(t){return t.length%2==0},or.j=function(t){return new or(new er(t.slice()))},or);function or(t){this.path=t}function sr(){return null!==Ki&&Ki.apply(this,arguments)||this}function ar(){return null!==Wi&&Wi.apply(this,arguments)||this}function ur(t,e,n){void 0===e?e=0:e>t.length&&Vi(),void 0===n?n=t.length-e:n>t.length-e&&Vi(),this.segments=t,this.offset=e,this.A=n}function hr(t){this.timestamp=t}function cr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $i(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $i(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $i(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $i(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function lr(t,e){var n=this;return(n=Yi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function fr(t,e){this.h=t,this.u=e,this.l={}}function pr(t){return null==t}function dr(t){return-0===t&&1/t==-1/0}var yr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.G=null};function vr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new yr(t,e,n,i,r,o,s)}function gr(t){var e,n=t;return null===n.G&&(e=n.path.$(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.$()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),pr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ua(n.startAt)),n.endAt&&(e+="|ub:",e+=Ua(n.endAt)),n.G=e),n.G}function mr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xa(t.startAt,e.startAt)&&xa(t.endAt,e.endAt)}function wr(t){return rr.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var br=(Er.fromBase64String=function(t){return new Er(atob(t))},Er.fromUint8Array=function(t){return new Er(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Er.prototype.toBase64=function(){return t=this.K,btoa(t);var t},Er.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},Er.prototype.H=function(){return 2*this.K.length},Er.prototype.o=function(t){return xi(this.K,t.K)},Er.prototype.isEqual=function(t){return this.K===t.K},Er);function Er(t){this.K=t}br.Y=new br("");function Ir(t){this.count=t}var Tr,Ar,Nr=(_r.prototype.Z=function(t){return new _r(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_r.prototype.tt=function(t,e){return new _r(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_r.prototype.et=function(t){return new _r(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},_r);function _r(t,e,n,i,r,o,s){void 0===r&&(r=Zi.min()),void 0===o&&(o=Zi.min()),void 0===s&&(s=br.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.J=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Rr(t){switch(t){case Qi.OK:return Vi(),0;case Qi.CANCELLED:case Qi.UNKNOWN:case Qi.DEADLINE_EXCEEDED:case Qi.RESOURCE_EXHAUSTED:case Qi.INTERNAL:case Qi.UNAVAILABLE:case Qi.UNAUTHENTICATED:return;case Qi.INVALID_ARGUMENT:case Qi.NOT_FOUND:case Qi.ALREADY_EXISTS:case Qi.PERMISSION_DENIED:case Qi.FAILED_PRECONDITION:case Qi.ABORTED:case Qi.OUT_OF_RANGE:case Qi.UNIMPLEMENTED:case Qi.DATA_LOSS:return 1;default:return Vi(),0}}function Or(t){if(void 0===t)return ki("GRPC error has no .code"),Qi.UNKNOWN;switch(t){case Tr.OK:return Qi.OK;case Tr.CANCELLED:return Qi.CANCELLED;case Tr.UNKNOWN:return Qi.UNKNOWN;case Tr.DEADLINE_EXCEEDED:return Qi.DEADLINE_EXCEEDED;case Tr.RESOURCE_EXHAUSTED:return Qi.RESOURCE_EXHAUSTED;case Tr.INTERNAL:return Qi.INTERNAL;case Tr.UNAVAILABLE:return Qi.UNAVAILABLE;case Tr.UNAUTHENTICATED:return Qi.UNAUTHENTICATED;case Tr.INVALID_ARGUMENT:return Qi.INVALID_ARGUMENT;case Tr.NOT_FOUND:return Qi.NOT_FOUND;case Tr.ALREADY_EXISTS:return Qi.ALREADY_EXISTS;case Tr.PERMISSION_DENIED:return Qi.PERMISSION_DENIED;case Tr.FAILED_PRECONDITION:return Qi.FAILED_PRECONDITION;case Tr.ABORTED:return Qi.ABORTED;case Tr.OUT_OF_RANGE:return Qi.OUT_OF_RANGE;case Tr.UNIMPLEMENTED:return Qi.UNIMPLEMENTED;case Tr.DATA_LOSS:return Qi.DATA_LOSS;default:return Vi()}}(Ar=Tr=Tr||{})[Ar.OK=0]="OK",Ar[Ar.CANCELLED=1]="CANCELLED",Ar[Ar.UNKNOWN=2]="UNKNOWN",Ar[Ar.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ar[Ar.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ar[Ar.NOT_FOUND=5]="NOT_FOUND",Ar[Ar.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ar[Ar.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ar[Ar.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ar[Ar.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ar[Ar.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ar[Ar.ABORTED=10]="ABORTED",Ar[Ar.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ar[Ar.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ar[Ar.INTERNAL=13]="INTERNAL",Ar[Ar.UNAVAILABLE=14]="UNAVAILABLE",Ar[Ar.DATA_LOSS=15]="DATA_LOSS";var Sr=(Vr.prototype.nt=function(t,e){return new Vr(this.P,this.root.nt(t,e,this.P).copy(null,null,kr.st,null,null))},Vr.prototype.remove=function(t){return new Vr(this.P,this.root.remove(t,this.P).copy(null,null,kr.st,null,null))},Vr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vr.prototype._=function(){return this.root._()},Object.defineProperty(Vr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vr.prototype.it=function(){return this.root.it()},Vr.prototype.rt=function(){return this.root.rt()},Vr.prototype.ot=function(t){return this.root.ot(t)},Vr.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Vr.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vr.prototype.ht=function(t){return this.root.ht(t)},Vr.prototype.at=function(){return new Dr(this.root,null,this.P,!1)},Vr.prototype.ut=function(t){return new Dr(this.root,t,this.P,!1)},Vr.prototype.ct=function(){return new Dr(this.root,null,this.P,!0)},Vr.prototype.lt=function(t){return new Dr(this.root,t,this.P,!0)},Vr),Dr=(Lr.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Lr.prototype.wt=function(){return 0<this.ft.length},Lr.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Lr),kr=(Pr.prototype.copy=function(t,e,n,i,r){return new Pr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Pr.prototype._=function(){return!1},Pr.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Pr.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Pr.prototype.min=function(){return this.left._()?this:this.left.min()},Pr.prototype.it=function(){return this.min().key},Pr.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Pr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.nt(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.nt(t,e,n))).Et()},Pr.prototype.It=function(){if(this.left._())return Pr.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Pr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.Rt()||i.left.left.Rt()||(i=i.At()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.Rt()&&(i=i.Pt()),i.right._()||i.right.Rt()||i.right.left.Rt()||(i=i.Vt()),0===e(t,i.key)){if(i.right._())return Pr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.It())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.Et()},Pr.prototype.Rt=function(){return this.color},Pr.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Pr.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Pr.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Pr.prototype.pt=function(){var t=this.copy(null,null,Pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pr.prototype.Pt=function(){var t=this.copy(null,null,Pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pr.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pr.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Pr.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Vi();if(this.right.Rt())throw Vi();var t=this.left.vt();if(t!==this.right.vt())throw Vi();return t+(this.Rt()?0:1)},Pr);function Pr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Pr.RED,this.left=null!=i?i:Pr.EMPTY,this.right=null!=r?r:Pr.EMPTY,this.size=this.left.size+1+this.right.size}function Lr(t,e,n,i){this._t=i,this.ft=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this._t?t.left:t.right;else{if(0===r){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Vr(t,e){this.P=t,this.root=e||kr.EMPTY}function Cr(){this.size=0}kr.EMPTY=null,kr.RED=!0,kr.st=!1,kr.EMPTY=(Object.defineProperty(Cr.prototype,"key",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"value",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"color",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"left",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"right",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Cr.prototype.copy=function(t,e,n,i,r){return this},Cr.prototype.nt=function(t,e,n){return new kr(t,e)},Cr.prototype.remove=function(t,e){return this},Cr.prototype._=function(){return!0},Cr.prototype.ot=function(t){return!1},Cr.prototype.ht=function(t){return!1},Cr.prototype.it=function(){return null},Cr.prototype.rt=function(){return null},Cr.prototype.Rt=function(){return!1},Cr.prototype.gt=function(){return!0},Cr.prototype.vt=function(){return 0},new Cr);var Ur=(Fr.prototype.has=function(t){return null!==this.data.get(t)},Fr.prototype.first=function(){return this.data.it()},Fr.prototype.last=function(){return this.data.rt()},Object.defineProperty(Fr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fr.prototype.indexOf=function(t){return this.data.indexOf(t)},Fr.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Fr.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var i=n.dt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},Fr.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Fr.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Fr.prototype.at=function(){return new Mr(this.data.at())},Fr.prototype.ut=function(t){return new Mr(this.data.ut(t))},Fr.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Fr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fr.prototype._=function(){return this.data._()},Fr.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fr.prototype.isEqual=function(t){if(!(t instanceof Fr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(0!==this.P(i,r))return!1}return!0},Fr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fr.prototype.copy=function(t){var e=new Fr(this.P);return e.data=t,e},Fr),Mr=(qr.prototype.dt=function(){return this.Ft.dt().key},qr.prototype.wt=function(){return this.Ft.wt()},qr),xr=new Sr(rr.P);function qr(t){this.Ft=t}function Fr(t){this.P=t,this.data=new Sr(this.P)}var jr=new Sr(rr.P);var Gr=new Sr(rr.P),Br=new Ur(rr.P);function zr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Br,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var Hr=new Ur(xi);function Kr(t,e,n,i){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=i}function Wr(t,e){this.targetId=t,this.ee=e}function Yr(t,e,n,i){void 0===n&&(n=br.Y),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Xr=(uo.kt=function(t){return new uo(t.P)},uo.prototype.has=function(t){return null!=this.$t.get(t)},uo.prototype.get=function(t){return this.$t.get(t)},uo.prototype.first=function(){return this.Nt.it()},uo.prototype.last=function(){return this.Nt.rt()},uo.prototype._=function(){return this.Nt._()},uo.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(uo.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),uo.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},uo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},uo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var i=e.dt().key,r=n.dt().key;if(!i.isEqual(r))return!1}return!0},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},uo.prototype.copy=function(t,e){var n=new uo;return n.P=this.P,n.$t=t,n.Nt=e,n},uo),Qr=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Vi()},ao.prototype.Lt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ao),$r=(so.Bt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new so(t,e,Xr.kt(e),r,n,i,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Mt===t.Mt&&this.qt.isEqual(t.qt)&&fa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},so),Jr=(oo.zt=function(t,e){var n=new Map;return n.set(t,Zr.Kt(t,e)),new oo(Zi.min(),n,Hr,xr,zr())},oo),Zr=(ro.Kt=function(t,e){return new ro(br.Y,e,zr(),zr(),zr())},ro),to=(Object.defineProperty(io.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),io.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},io.prototype.ce=function(){var n=zr(),i=zr(),r=zr();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Vi()}}),new Zr(this.ie,this.re,n,i,r)},io.prototype.le=function(){this.oe=!1,this.se=co()},io.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},io.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},io.prototype.de=function(){this.ne+=1},io.prototype.we=function(){--this.ne},io.prototype.Te=function(){this.oe=!0,this.re=!0},io),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var i=n[e];t.te instanceof Qs?this.Ve(i,t.te):t.te instanceof $s&&this.pe(i,t.key,t.te)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.te)}},no.prototype.ye=function(n){var i=this;this.ge(n,function(t){var e=i.ve(t);switch(n.state){case 0:i.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||i.removeTarget(t);break;case 3:i.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:i.be(t)&&(i.Se(t),e.ue(n.resumeToken));break;default:Vi()}})},no.prototype.ge=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ee.forEach(function(t,e){i.be(e)&&n(e)})},no.prototype.Ce=function(t){var e,n,i=t.targetId,r=t.ee.count,o=this.De(i);o&&(wr(e=o.target)?0===r?(n=new rr(e.path),this.pe(i,n,new $s(n,Zi.min()))):Ci(1===r):this.Fe(i)!==r&&(this.Se(i),this.Ae=this.Ae.add(i)))},no.prototype.$e=function(r){var o=this,s=new Map;this.Ee.forEach(function(t,e){var n,i=o.De(e);i&&(t.Ht&&wr(i.target)&&(n=new rr(i.target.path),null!==o.Ie.get(n)||o.Ne(e,n)||o.pe(e,n,new $s(n,r))),t.ae&&(s.set(e,t.ce()),t.le()))});var i=zr();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Jr(r,s,this.Ae,this.Ie,i);return this.Ie=xr,this.Re=ho(),this.Ae=new Ur(xi),t},no.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.Ne(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},no.prototype.pe=function(t,e,n){var i;this.be(t)&&(i=this.ve(t),this.Ne(t,e)?i._e(e,1):i.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},no.prototype.removeTarget=function(t){this.Ee.delete(t)},no.prototype.Fe=function(t){var e=this.ve(t).ce();return this.me.xe(t).size+e.Yt.size-e.Jt.size},no.prototype.de=function(t){this.ve(t).de()},no.prototype.ve=function(t){var e=this.Ee.get(t);return e||(e=new to,this.Ee.set(t,e)),e},no.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Ur(xi),this.Re=this.Re.nt(t,e)),e},no.prototype.be=function(t){var e=null!==this.De(t);return e||Di("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.De=function(t){var e=this.Ee.get(t);return e&&e.he?null:this.me.Le(t)},no.prototype.Se=function(e){var n=this;this.Ee.set(e,new to),this.me.xe(e).forEach(function(t){n.pe(e,t,null)})},no.prototype.Ne=function(t,e){return this.me.xe(t).has(e)},no);function no(t){this.me=t,this.Ee=new Map,this.Ie=xr,this.Re=ho(),this.Ae=new Ur(xi)}function io(){this.ne=0,this.se=co(),this.ie=br.Y,this.re=!1,this.oe=!0}function ro(t,e,n,i,r){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=i,this.Jt=r}function oo(t,e,n,i,r){this.J=t,this.Wt=e,this.Qt=n,this.jt=i,this.Gt=r}function so(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.Ot=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Mt=s,this.Ut=a}function ao(){this.xt=new Sr(rr.P)}function uo(n){this.P=n?function(t,e){return n(t,e)||rr.P(t.key,e.key)}:function(t,e){return rr.P(t.key,e.key)},this.$t=jr,this.Nt=new Sr(this.P)}function ho(){return new Sr(rr.P)}function co(){return new Sr(rr.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ji(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Vi()}function vo(i,r){var t,e,n,o=yo(i);if(o!==yo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return fo(i).isEqual(fo(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Eo(i.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,To(i.bytesValue).isEqual(To(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Io((t=i).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),i=Io(e.doubleValue);return n===i?dr(n)===dr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return qi(i.arrayValue.values||[],r.arrayValue.values||[],vo);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Bi(t)!==Bi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return Vi()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,i,r,o,s,a,u,h,c,l,f=yo(t),p=yo(e);if(f!==p)return xi(f,p);switch(f){case 0:return 0;case 1:return xi(t.booleanValue,e.booleanValue);case 2:return h=e,c=Io(t.integerValue||t.doubleValue),l=Io(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return xi(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=To(o),u=To(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=xi(n[r],i[r]);if(0!==o)return o}return xi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=xi(Io(n.latitude),Io(i.latitude)))?r:xi(Io(n.longitude),Io(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=mo(n[r],i[r]);if(o)return o}return xi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var a=xi(i[s],o[s]);if(0!==a)return a;var u=mo(n[i[s]],r[o[s]]);if(0!==u)return u}return xi(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Vi()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xi(t,e);var n=Eo(t),i=Eo(e),r=xi(n.seconds,i.seconds);return 0!==r?r:xi(n.nanos,i.nanos)}function bo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Eo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?To(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,rr.U(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Vi();var t,e,n}(t)}function Eo(t){if(Ci(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e,n=0,i=po.exec(t);Ci(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?br.fromBase64String(t):br.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function No(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function Ro(t){return t&&"nullValue"in t}function Oo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function So(t){return t&&"mapValue"in t}var Do={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Oe=e};function Lo(t){return{integerValue:""+t}}function Vo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dr(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!dr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Lo(e):Vo(t,e);var n}function Uo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function xo(t){return Ci(!!t),Zi.m((e=Eo(t),new Ji(e.seconds,e.nanos)));var e}function qo(t,e){return new er(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function Fo(t,e){return qo(t.s,e.path)}function jo(t,e){var n,i,r=(Ci(Yo(i=er.N(e))),i);return Ci(r.get(1)===t.s.projectId),Ci(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new rr((Ci(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Go(t,e){return qo(t.s,e)}function Bo(t){return new er(["projects",t.s.projectId,"databases",t.s.database]).$()}function zo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Ho(t,e){var n,i,r,o,s,a;if(e instanceof Rs)n={update:zo(t,e.key,e.value)};else if(e instanceof xs)n={delete:Fo(t,e.key)};else if(e instanceof Os)n={update:zo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.$())}),{fieldPaths:r})};else if(e instanceof Ls)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Zo)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.$(),increment:e.Me};throw Vi()})}};else{if(!(e instanceof qs))return Vi();n={verify:Fo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:(s=t,a=o.updateTime,Uo(s,a.R()))}:void 0!==o.exists?{exists:o.exists}:Vi()),n}function Ko(t){return{before:t.before,values:t.position}}function Wo(t){return{fieldPath:t.$()}}function Yo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Xo(){this.We=void 0}function Qo(t,e){return t instanceof hs?No(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var $o,Jo,Zo=(n(ns,Jo=Xo),ns),ts=(n(es,$o=Xo),es);function es(t){var e=this;return(e=$o.call(this)||this).elements=t,e}function ns(){return null!==Jo&&Jo.apply(this,arguments)||this}function is(t,e){for(var n=fs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var rs,os=(n(ss,rs=Xo),ss);function ss(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function as(t,e){for(var n=fs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(r[i]);return{arrayValue:{values:n}}}var us,hs=(n(cs,us=Xo),cs);function cs(t,e){var n=this;return(n=us.call(this)||this).serializer=t,n.Me=e,n}function ls(t){return Io(t.integerValue||t.doubleValue)}function fs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ys.prototype.isEqual=function(t){return qi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort(ir.P)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.je=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof Qs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Qs}function bs(){}function Es(t,e,n){return t instanceof Rs?new Qs(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Os?function(t,e,n){if(!ws(t.Be,e))return new Js(t.key,n.version);var i=ks(t,e);return new Qs(t.key,n.version,i,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ls?function(t,e,n){if(Ci(null!=n.transformResults),!ws(t.Be,e))return new Js(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Ci(t.length===n.length);for(var r,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Qs&&(c=e.field(u.field)),i.push((r=h,o=c,s=n[a],r instanceof ts?is(r,o):r instanceof os?as(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Cs(t,i.data(),r);return new Qs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new $s(t.key,n.version,{hasCommittedMutations:!0})}function Is(t,e,n,i){return t instanceof Rs?function(t,e){if(!ws(t.Be,e))return e;var n=As(e);return new Qs(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Os?function(t,e){if(!ws(t.Be,e))return e;var n=As(e),i=ks(t,e);return new Qs(t.key,n,i,{Ge:!0})}(t,e):t instanceof Ls?function(t,e,n,i){if(!ws(t.Be,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,a,u,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],y=d.transform,v=null;n instanceof Qs&&(v=n.field(d.field)),null===v&&i instanceof Qs&&(v=i.field(d.field)),l.push((o=v,s=e,c=h=u=a=void 0,(r=y)instanceof Zo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):r instanceof ts?is(r,o):r instanceof os?as(r,o):(u=Qo(a=r,o),h=ls(u)+ls(a.Me),No(u)&&No(a.Me)?Lo(h):Vo(a.serializer,h))))}return l}(t.fieldTransforms,n,e,i),s=Cs(t,r.data(),o);return new Qs(t.key,r.version,s,{Ge:!0})}(t,e,i,n):(o=e,ws((r=t).Be,o)?new $s(r.key,Zi.min()):o);var r,o}function Ts(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||qi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof ts&&o instanceof ts||r instanceof os&&o instanceof os?qi(r.elements,o.elements,vo):r instanceof hs&&o instanceof hs?vo(r.Me,o.Me):r instanceof Zo&&o instanceof Zo);var n,i,r,o}))}function As(t){return t instanceof Qs?t.version:Zi.min()}var Ns,_s,Rs=(n(Ds,_s=bs),Ds),Os=(n(Ss,Ns=bs),Ss);function Ss(t,e,n,i){var r=this;return(r=Ns.call(this)||this).key=t,r.data=e,r.qe=n,r.Be=i,r.type=1,r}function Ds(t,e,n){var i=this;return(i=_s.call(this)||this).key=t,i.value=e,i.Be=n,i.type=0,i}function ks(t,e){return n=t,i=e instanceof Qs?e.data():Fs.empty(),r=new js(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Ps,Ls=(n(Vs,Ps=bs),Vs);function Vs(t,e){var n=this;return(n=Ps.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=gs.exists(!0),n}function Cs(t,e,n){for(var i=new js(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Us,Ms,xs=(n(Hs,Ms=bs),Hs),qs=(n(zs,Us=bs),zs),Fs=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!So(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Bs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Bs),js=(Gs.prototype.set=function(t,e){return this.Ye(t,e),this},Gs.prototype.delete=function(t){return this.Ye(t,null),this},Gs.prototype.Ye=function(t,e){for(var n=this.He,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},Gs.prototype.ze=function(){var t=this.Xe(ir.k(),this.He);return null!=t?new Fs(t):this.Ke},Gs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.Ke.field(i),s=So(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Gs);function Gs(t){void 0===t&&(t=Fs.empty()),this.Ke=t,this.He=new Map}function Bs(t){this.proto=t}function zs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.Be=e,n.type=4,n}function Hs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.Be=e,n.type=3,n}function Ks(t,e){this.key=t,this.version=e}var Ws,Ys,Xs,Qs=(n(ea,Xs=Ks),ea.prototype.field=function(t){return this.Je.field(t)},ea.prototype.data=function(){return this.Je},ea.prototype.Ze=function(){return this.Je.proto},ea.prototype.isEqual=function(t){return t instanceof ea&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},ea.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ea.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ea),$s=(n(ta,Ys=Ks),ta.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ta.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ta.prototype.isEqual=function(t){return t instanceof ta&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ta),Js=(n(Zs,Ws=Ks),Zs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs);function Zs(){return null!==Ws&&Ws.apply(this,arguments)||this}function ta(t,e,n){var i=this;return(i=Ys.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function ea(t,e,n,i){var r=this;return(r=Xs.call(this,t,e)||this).Je=n,r.Ge=!!i.Ge,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function na(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $i(Qi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $i(Qi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ia=(ra.prototype.rn=function(t){return new ra(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},ra.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},ra.prototype.hn=function(){return!pr(this.limit)&&"F"===this.en},ra.prototype.an=function(){return!pr(this.limit)&&"L"===this.en},ra.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},ra.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},ra.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},ra);function ra(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=i,this.limit=r,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function oa(t){return new ia(t)}function sa(t){return null!==t.collectionGroup}function aa(t){var e=na(t,ia);if(null===e.nn){e.nn=[];var n=e.cn(),i=e.un();if(null!==n&&null===i)n.O()||e.nn.push(new qa(n)),e.nn.push(new qa(ir.q(),"asc"));else{for(var r,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.O()&&(o=!0)}o||(r=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new qa(ir.q(),r)))}}return e.nn}function ua(t){var e=na(t,ia);if(!e.sn)if("F"===e.en)e.sn=vr(e.path,e.collectionGroup,aa(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=aa(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new qa(o.field,s))}var a=e.endAt?new Da(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Da(e.startAt.position,!e.startAt.before):null;e.sn=vr(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function ha(t,e,n){return new ia(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ca(t,e){return new ia(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function la(t,e){return new ia(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function fa(t,e){return mr(ua(t),ua(e))&&t.en===e.en}function pa(t){return gr(ua(t))+"|lt:"+t.en}function da(t){return"Query(target="+(e=ua(t),n=e.path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),pr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ua(e.startAt)),e.endAt&&(n+=", endAt: "+Ua(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function ya(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.B(i.collectionGroup)&&i.path.C(o):rr.W(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.tn;e<n.length;e++){var i=n[e];if(!i.field.O()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Ma(e.startAt,aa(e),n))&&(!e.endAt||!Ma(e.endAt,aa(e),n)));var e,n,i,o}function va(a){return function(t,e){for(var n=!1,i=0,r=aa(a);i<r.length;i++){var o=r[i],s=function(t,r,e){var n=t.field.O()?rr.P(r.key,e.key):function(t,e){var n=r.field(t),i=e.field(t);return null!==n&&null!==i?mo(n,i):Vi()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Vi()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var ga,ma=(n(wa,ga=function(){}),wa.create=function(t,e,n){if(t.O())return"in"===e?new _a(t,n):new Na(t,e,n);if(Ro(n)){if("=="!==e)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new wa(t,e,n)}if(Oo(n)){if("=="!==e)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new wa(t,e,n)}return"array-contains"===e?new Ra(t,n):"in"===e?new Oa(t,n):"array-contains-any"===e?new Sa(t,n):new wa(t,e,n)},wa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.fn(mo(e,this.value))},wa.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Vi()}},wa.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},wa);function wa(t,e,n){var i=this;return(i=ga.call(this)||this).field=t,i.op=e,i.value=n,i}var ba,Ea,Ia,Ta,Aa,Na=(n(Ca,Aa=ma),Ca.prototype.matches=function(t){var e=rr.P(t.key,this.key);return this.fn(e)},Ca),_a=(n(Va,Ta=ma),Va.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Va),Ra=(n(La,Ia=ma),La.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},La),Oa=(n(Pa,Ea=ma),Pa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},Pa),Sa=(n(ka,ba=ma),ka.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},ka),Da=function(t,e){this.position=t,this.before=e};function ka(t,e){return ba.call(this,t,"array-contains-any",e)||this}function Pa(t,e){return Ea.call(this,t,"in",e)||this}function La(t,e){return Ia.call(this,t,"array-contains",e)||this}function Va(t,e){var n=this;return(n=Ta.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return rr.U(t.referenceValue)}),n}function Ca(t,e,n){var i=this;return(i=Aa.call(this,t,e,n)||this).key=rr.U(n.referenceValue),i}function Ua(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Ma(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.O()?rr.P(rr.U(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function xa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var qa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Fa=($a.prototype.wn=function(t,e,n){for(var i=n.Tn,r=0;r<this.mutations.length;r++){var o=this.mutations[r];o.key.isEqual(t)&&(e=Es(o,e,i[r]))}return e},$a.prototype.mn=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=Is(r,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Is(u,e,o,this.dn))}return e},$a.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.mn(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},$a.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zr())},$a.prototype.isEqual=function(t){return this.batchId===t.batchId&&qi(this.mutations,t.mutations,Ts)&&qi(this.baseMutations,t.baseMutations,Ts)},$a),ja=(Qa.from=function(t,e,n){Ci(t.mutations.length===n.length);for(var i=Gr,r=t.mutations,o=0;o<r.length;o++)i=i.nt(r[o].key,n[o].version);return new Qa(t,e,n,i)},Qa),Ga=(Xa.prototype.catch=function(t){return this.next(void 0,t)},Xa.prototype.next=function(i,r){var o=this;return this.pn&&Vi(),this.pn=!0,this.Vn?this.error?this.yn(r,this.error):this.gn(i,this.result):new Xa(function(e,n){o.An=function(t){o.gn(i,t).next(e,n)},o.Pn=function(t){o.yn(r,t).next(e,n)}})},Xa.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Xa.prototype.bn=function(t){try{var e=t();return e instanceof Xa?e:Xa.resolve(e)}catch(t){return Xa.reject(t)}},Xa.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):Xa.resolve(e)},Xa.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):Xa.reject(e)},Xa.resolve=function(n){return new Xa(function(t,e){t(n)})},Xa.reject=function(n){return new Xa(function(t,e){e(n)})},Xa.Sn=function(t){return new Xa(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Xa.Cn=function(t){for(var n=Xa.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?Xa.resolve(t):e()})}(i[e]);return n},Xa.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Sn(r)},Xa),Ba=(Ya.prototype.Nn=function(e,n){var i=this;return this.Fn.kn(e,n).next(function(t){return i.xn(e,n,t)})},Ya.prototype.xn=function(t,i,r){return this.Dn.Ln(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].mn(i,t);return t})},Ya.prototype.On=function(t,e,r){var o=xr;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].mn(t,e);o=o.nt(t,e)}),o},Ya.prototype.qn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},Ya.prototype.Mn=function(i,r){var o=this;return this.Fn.Un(i,r).next(function(t){var e=o.On(i,r,t),n=xr;return e.forEach(function(t,e){e=e||new $s(t,Zi.min()),n=n.nt(t,e)}),n})},Ya.prototype.Bn=function(t,e,n){return i=e,rr.W(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.Wn(t,e.path):sa(e)?this.Qn(t,e,n):this.jn(t,e,n);var i},Ya.prototype.Wn=function(t,e){return this.Nn(t,new rr(e)).next(function(t){var e=jr;return t instanceof Qs&&(e=e.nt(t.key,t)),e})},Ya.prototype.Qn=function(n,i,r){var o=this,s=i.collectionGroup,a=jr;return this.$n.Gn(n,s).next(function(t){return Ga.forEach(t,function(t){var e=i.rn(t.child(s));return o.jn(n,e,r).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Ya.prototype.jn=function(e,n,t){var c,l,i=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,i.Fn.zn(e,n)}).next(function(t){return l=t,i.Kn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=Is(s,u,u,i.dn);c=h instanceof Qs?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){ya(n,e)||(c=c.remove(t))}),c})},Ya.prototype.Kn=function(t,e,n){for(var i=zr(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof Os&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.Dn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Qs&&(h=h.nt(t,e))}),h})},Ya),za=(Wa.Xn=function(t,e){for(var n=zr(),i=zr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Wa(t,e.fromCache,n,i)},Wa),Ha=(Ka.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ka.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},Ka);function Ka(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function Wa(t,e,n,i){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=i}function Ya(t,e,n){this.Dn=t,this.Fn=e,this.$n=n}function Xa(t){var e=this;this.An=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Qa(t,e,n,i){this.batch=t,this.In=e,this.Tn=n,this.Rn=i}function $a(t,e,n,i){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=i}Ha.ns=-1;function Ja(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Za=(su.prototype.reset=function(){this.us=0},su.prototype._s=function(){this.us=this.as},su.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),i=Math.max(0,Date.now()-this.ls),r=Math.max(0,n-i);0<r&&Di("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.cs=this.ss.ws(this.rs,r,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},su.prototype.Ts=function(){null!==this.cs&&(this.cs.ms(),this.cs=null)},su.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},su.prototype.ds=function(){return(Math.random()-.5)*this.us},su),tu=(ou.prototype.Is=function(t,e){return this.Es.add(e),Ga.resolve()},ou.prototype.Gn=function(t,e){return Ga.resolve(this.Es.getEntries(e))},ou),eu=(ru.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Ur(er.P),r=!i.has(n);return this.index[e]=i.add(n),r},ru.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},ru.prototype.getEntries=function(t){return(this.index[t]||new Ur(er.P)).F()},ru),nu=(iu.prototype.next=function(){return this.Rs+=2,this.Rs},iu.As=function(){return new iu(0)},iu.Ps=function(){return new iu(-1)},iu);function iu(t){this.Rs=t}function ru(){this.index={}}function ou(){this.Es=new eu}function su(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=i,this.as=r,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function au(t){return"IndexedDbTransactionError"===t.name}function uu(){return"undefined"!=typeof window?window:null}var hu=(fu.vs=function(t,e,n,i,r){var o=new fu(t,e,Date.now()+n,i,r);return o.start(n),o},fu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},fu.prototype.ms=function(){return this.Ss()},fu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new $i(Qi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},fu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},fu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},fu),cu=(Object.defineProperty(lu.prototype,"Ms",{get:function(){return this.$s},enumerable:!1,configurable:!0}),lu.prototype.Cs=function(t){this.enqueue(t)},lu.prototype.Us=function(t){this.Bs(),this.Ws(t)},lu.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},lu.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.$s?[3,2]:(this.$s=!0,(e=uu())&&e.removeEventListener("visibilitychange",this.qs),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},lu.prototype.enqueue=function(t){return this.Bs(),this.$s?new Promise(function(t){}):this.Ws(t)},lu.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.zs()})},lu.prototype.zs=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Os.reset(),[3,4];case 3:if(!au(e=t.sent()))throw e;return Di("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Os.fs(function(){return n.zs()}),t.label=5;case 5:return[2]}})})},lu.prototype.Ws=function(t){var i=this,e=this.Ds.then(function(){return i.xs=!0,t().catch(function(t){throw i.ks=t,i.xs=!1,ki("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.xs=!1,t})});return this.Ds=e},lu.prototype.ws=function(t,e,n){var i=this;this.Bs(),-1<this.Ls.indexOf(t)&&(e=0);var r=hu.vs(this,t,e,n,function(t){return i.Ks(t)});return this.Ns.push(r),r},lu.prototype.Bs=function(){this.ks&&Vi()},lu.prototype.Hs=function(){},lu.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},lu.prototype.Xs=function(t){for(var e=0,n=this.Ns;e<n.length;e++)if(n[e].rs===t)return!0;return!1},lu.prototype.Js=function(i){var r=this;return this.Ys().then(function(){r.Ns.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=r.Ns;t<e.length;t++){var n=e[t];if(n.ms(),"all"!==i&&n.rs===i)break}return r.Ys()})},lu.prototype.Zs=function(t){this.Ls.push(t)},lu.prototype.Ks=function(t){var e=this.Ns.indexOf(t);this.Ns.splice(e,1)},lu);function lu(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.$s=!1,this.Ns=[],this.ks=null,this.xs=!1,this.Ls=[],this.Os=new Za(this,"async_queue_retry"),this.qs=function(){return t.Os.Ts()};var e=uu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qs)}function fu(t,e,n,i,r){this.Vs=t,this.rs=e,this.ps=n,this.op=i,this.ys=r,this.gs=new Ja,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function pu(t,e){if(ki("AsyncQueue",e+": "+t),au(t))return new $i(Qi.UNAVAILABLE,e+": "+t);throw t}var du=(yu.si=function(t){return new yu(t,yu.ii,yu.ri)},yu);function yu(t,e,n){this.ti=t,this.ei=e,this.ni=n}du.oi=-1,du.hi=1048576,du.ai=41943040,du.ii=10,du.ri=1e3,du.ui=new du(du.ai,du.ii,du.ri),du.ci=new du(du.oi,0,0);var vu=(gu.prototype.Vi=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ri,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Fn.pi(v).next(function(t){return g=t,e=i.persistence.wi(r),m=new Ba(i.Ti,e,i.persistence.Ai()),e.pi(v)}).next(function(t){for(var e=[],n=[],i=zr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.qn(v,i).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ri=m,this.li.Pi(this.Ri),n)]}})})},gu.prototype.bi=function(h){var c,l=this,f=Ji.now(),t=h.reduce(function(t,e){return t.add(e.key)},zr());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ri.qn(u,t).next(function(t){c=t;for(var a,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(a=o,e=c.get(o.key),a instanceof Ls?function(t){for(var e=null,n=0,i=a.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Qs?t.field(r.field):void 0,s=Qo(r.transform,o||null);null!=s&&(e=null==e?(new js).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Os(o.key,s,function a(t){var u=[];return zi(t.fields||{},function(t,e){var n=new ir([t]);if(So(e)){var i=a(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new ds(u)}(s.proto.mapValue),gs.exists(!0)))}return l.Fn.Si(u,f,n,h)})}).then(function(t){var e=t.En(c);return{batchId:t.batchId,Ci:e}})},gu.prototype.Di=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Ti.Fi({$i:!0});return r.Ni(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Fn.ki(t)}).next(function(){return r.Ri.qn(t,e)})})},gu.prototype.xi=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Fn.Li(e,t).next(function(t){return Ci(null!==t),n=t.keys(),i.Fn.Oi(e,t)}).next(function(){return i.Fn.ki(e)}).next(function(){return i.Ri.qn(e,n)})})},gu.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.qi(t)})},gu.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ei.Mi(t)})},gu.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Ti.Fi({$i:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n,i,r=l.get(e);r&&(s.push(h.Ei.Bi(o,t.Jt,e).next(function(){return h.Ei.Wi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(i=r.tt(n,c).Z(o.Qi),l=l.nt(e,i),gu.ji(r,i,t)&&s.push(h.Ei.Gi(o,i))))});var t,a=xr,n=zr();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.jt.forEach(function(t,e){var n=i.get(t);e instanceof $s&&e.version.isEqual(Zi.min())?(r.zi(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.Ki(e,c),a=a.nt(t,e)):Di("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),c.isEqual(Zi.min())||(t=h.Ei.Mi(o).next(function(t){return h.Ei.Xi(o,o.Qi,c)}),s.push(t)),Ga.Sn(s).next(function(){return r.apply(o)}).next(function(){return h.Ri.Mn(o,a)})}).then(function(t){return h._i=l,t})},gu.ji=function(t,e,n){return Ci(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},gu.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ga.forEach(c,function(e){return Ga.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return Ga.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!au(e=t.sent()))throw e;return Di("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},gu.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},gu.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ri.Nn(t,e)})},gu.prototype.rr=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ei.or(e,i).next(function(t){return t?(n=t,Ga.resolve(n)):r.Ei.hr(e).next(function(t){return n=new Nr(i,t,0,e.Qi),r.Ei.ar(e,n).next(function(){return n})})})}).then(function(t){var e=r._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(r._i=r._i.nt(t.targetId,t),r.fi.set(i,t.targetId)),t})},gu.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?Ga.resolve(this._i.get(n)):this.Ei.or(t,e)},gu.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,i,r=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return r.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!au(i=t.sent()))throw i;return Di("LocalStore","Failed to update sequence numbers for target "+o+": "+i),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},gu.prototype.cr=function(t,n){var i=this,r=Zi.min(),o=zr();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.or(e,ua(t)).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ei.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return i.li.Bn(e,t,n?r:Zi.min(),n?o:zr())}).next(function(t){return{documents:t,_r:o}})})},gu.prototype.Ni=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=Ga.resolve();return n.forEach(function(i){a=a.next(function(){return o.Ln(t,i)}).next(function(t){var e=t,n=r.Rn.get(i);Ci(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(i,e,r))&&o.Ki(e,r.In)})}),a.next(function(){return e.Fn.Oi(t,s)})},gu.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},gu);function gu(t,e,n){this.persistence=t,this.li=e,this._i=new Sr(xi),this.fi=new Xi(gr,mr),this.di=Zi.min(),this.Fn=t.wi(n),this.Ti=t.mi(),this.Ei=t.Ii(),this.Ri=new Ba(this.Ti,this.Fn,this.persistence.Ai()),this.li.Pi(this.Ri)}function mu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Qi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Di("LocalStore","Unexpectedly lost primary lease"),[2]})})}vu.Ji=3e8;var wu=(Au.prototype._=function(){return this.Tr._()},Au.prototype.tr=function(t,e){var n=new bu(t,e);this.Tr=this.Tr.add(n),this.Er=this.Er.add(n)},Au.prototype.Rr=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},Au.prototype.er=function(t,e){this.Ar(new bu(t,e))},Au.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},Au.prototype.Vr=function(t){var e=this,n=new rr(new er([])),i=new bu(n,t),r=new bu(n,t+1),o=[];return this.Er.bt([i,r],function(t){e.Ar(t),o.push(t.key)}),o},Au.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Ar(t)})},Au.prototype.Ar=function(t){this.Tr=this.Tr.delete(t),this.Er=this.Er.delete(t)},Au.prototype.yr=function(t){var e=new rr(new er([])),n=new bu(e,t),i=new bu(e,t+1),r=zr();return this.Er.bt([n,i],function(t){r=r.add(t.key)}),r},Au.prototype.gr=function(t){var e=new bu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},Au),bu=(Tu.mr=function(t,e){return rr.P(t.key,e.key)||xi(t.vr,e.vr)},Tu.Ir=function(t,e){return xi(t.vr,e.vr)||rr.P(t.key,e.key)},Tu),Eu=(Iu.prototype.br=function(){return null!=this.uid},Iu.prototype.Sr=function(){return this.br()?"uid:"+this.uid:"anonymous-user"},Iu.prototype.isEqual=function(t){return t.uid===this.uid},Iu);function Iu(t){this.uid=t}function Tu(t,e){this.key=t,this.vr=e}function Au(){this.Tr=new Ur(bu.mr),this.Er=new Ur(bu.Ir)}Eu.UNAUTHENTICATED=new Eu(null),Eu.Cr=new Eu("google-credentials-uid"),Eu.Dr=new Eu("first-party-uid");function Nu(t,e){this.user=e,this.type="OAuth",this.Fr={},this.Fr.Authorization="Bearer "+t}function _u(t){this.key=t}function Ru(t){this.key=t}function Ou(t,e,n){this.query=t,this.targetId=e,this.view=n}function Su(t){this.key=t,this.oa=!1}function Du(){this.qa=void 0,this.listeners=[]}var ku,Pu,Lu,Vu,Cu=(mh.prototype.getToken=function(){return Promise.resolve(null)},mh.prototype.Nr=function(){},mh.prototype.kr=function(t){(this.$r=t)(Eu.UNAUTHENTICATED)},mh.prototype.xr=function(){this.$r=null},mh),Uu=(gh.prototype.getToken=function(){var e=this,n=this.qr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.qr!==n?(Di("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ci("string"==typeof t.accessToken),new Nu(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},gh.prototype.Nr=function(){this.forceRefresh=!0},gh.prototype.kr=function(t){this.$r=t,this.Or&&t(this.currentUser)},gh.prototype.xr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Lr),this.Lr=null,this.$r=null},gh.prototype.Mr=function(){var t=this.auth&&this.auth.getUid();return Ci(null===t||"string"==typeof t),new Eu(t)},gh),Mu=(Object.defineProperty(vh.prototype,"Fr",{get:function(){var t={"X-Goog-AuthUser":this.Br},e=this.Ur.auth.Wr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),vh),xu=(yh.prototype.getToken=function(){return Promise.resolve(new Mu(this.Ur,this.Br))},yh.prototype.kr=function(t){t(Eu.Dr)},yh.prototype.xr=function(){},yh.prototype.Nr=function(){},yh),qu=(dh.prototype.Hr=function(){return 1===this.state||2===this.state||4===this.state},dh.prototype.Yr=function(){return 2===this.state},dh.prototype.start=function(){3!==this.state?this.auth():this.Xr()},dh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Hr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},dh.prototype.Jr=function(){this.state=0,this.Os.reset()},dh.prototype.Zr=function(){var t=this;this.Yr()&&null===this.Kr&&(this.Kr=this.ss.ws(this.Qr,6e4,function(){return t.to()}))},dh.prototype.eo=function(t){this.no(),this.stream.send(t)},dh.prototype.to=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Yr()?[2,this.close(0)]:[2]})})},dh.prototype.no=function(){this.Kr&&(this.Kr.cancel(),this.Kr=null)},dh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.no(),this.Os.cancel(),this.zr++,3!==e?this.Os.reset():n&&n.code===Qi.RESOURCE_EXHAUSTED?(ki(n.toString()),ki("Using maximum backoff delay to prevent overloading the backend."),this.Os._s()):n&&n.code===Qi.UNAUTHENTICATED&&this.Gr.Nr(),null!==this.stream&&(this.so(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.io(n)];case 1:return t.sent(),[2]}})})},dh.prototype.so=function(){},dh.prototype.auth=function(){var n=this;this.state=1;var t=this.ro(this.zr),e=this.zr;this.Gr.getToken().then(function(t){n.zr===e&&n.oo(t)},function(e){t(function(){var t=new $i(Qi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ho(t)})})},dh.prototype.oo=function(t){var e=this,n=this.ro(this.zr);this.stream=this.ao(t),this.stream.uo(function(){n(function(){return e.state=2,e.listener.uo()})}),this.stream.io(function(t){n(function(){return e.ho(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},dh.prototype.Xr=function(){var t=this;this.state=4,this.Os.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},dh.prototype.ho=function(t){return Di("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},dh.prototype.ro=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.zr===e?t():(Di("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},dh),Fu=(n(ph,Lu=qu),ph.prototype.ao=function(t){return this.jr.co("Listen",t)},ph.prototype.onMessage=function(t){this.Os.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Vi(),a=e.targetChange.targetIds||[],u=(r=e.targetChange.resumeToken,t.Oe?(Ci(void 0===r||"string"==typeof r),br.fromBase64String(r||"")):(Ci(void 0===r||r instanceof Uint8Array),br.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=h&&(i=void 0===(n=h).code?Qi.UNKNOWN:Or(n.code),new $i(i,n.message||"")),l=new Yr(s,a,u,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=jo(t,f.document.name),d=xo(f.document.updateTime),y=new Fs({mapValue:{fields:f.document.fields}}),v=new Qs(p,d,y,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new Kr(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=jo(t,w.document),E=w.readTime?xo(w.readTime):Zi.min(),I=new $s(b,E),T=w.removedTargetIds||[];l=new Kr([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=jo(t,A.document),_=A.removedTargetIds||[];l=new Kr([],_,N,null)}else{if(!("filter"in e))return Vi();e.filter;var R=e.filter;R.targetId;var O=R.count||0,S=new Ir(O),D=R.targetId;l=new Wr(D,S)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Zi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Zi.min():xo(e.readTime)}(t);return this.listener.lo(e,n)},ph.prototype._o=function(t){var e,n,i,r,o={};o.database=Bo(this.serializer),o.addTarget=(e=this.serializer,r=(n=t).target,(i=wr(r)?{documents:{documents:[Go(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Go(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Oo(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Wo(t.field),op:(e=t.op,ko[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Wo((e=t).field),direction:(n=e.dir,Do[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Oe||pr(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ko(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ko(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.H()&&(i.resumeToken=Mo(e,n.resumeToken)),i);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vi()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.eo(o)},ph.prototype.fo=function(t){var e={};e.database=Bo(this.serializer),e.removeTarget=t,this.eo(e)},ph),ju=(n(fh,Pu=qu),Object.defineProperty(fh.prototype,"wo",{get:function(){return this.do},enumerable:!1,configurable:!0}),fh.prototype.start=function(){this.do=!1,this.lastStreamToken=void 0,Pu.prototype.start.call(this)},fh.prototype.so=function(){this.do&&this.To([])},fh.prototype.ao=function(t){return this.jr.co("Write",t)},fh.prototype.onMessage=function(t){if(Ci(!!t.streamToken),this.lastStreamToken=t.streamToken,this.do){this.Os.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Ci(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(Zi.min())&&(n=xo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new vs(n,i)}(t,r)})):[]),n=xo(t.commitTime);return this.listener.mo(n,e)}var i,r;return Ci(!t.writeResults||0===t.writeResults.length),this.do=!0,this.listener.Eo()},fh.prototype.Io=function(){var t={};t.database=Bo(this.serializer),this.eo(t)},fh.prototype.To=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ho(e.serializer,t)})};this.eo(n)},fh),Gu=(n(lh,ku=function(){}),lh.prototype.Ao=function(){if(this.Ro)throw new $i(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},lh.prototype.start=function(t){this.jr=t},lh.prototype.Po=function(e,n,i){var r=this;return this.Ao(),this.credentials.getToken().then(function(t){return r.jr.Po(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.Nr(),t})},lh.prototype.Vo=function(e,n,i){var r=this;return this.Ao(),this.credentials.getToken().then(function(t){return r.jr.Vo(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.Nr(),t})},lh.prototype.po=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ro=!1,[2]})})},lh),Bu=(ch.prototype.Co=function(){var t=this;0===this.vo&&(this.Do("Unknown"),this.bo=this.Vs.ws("online_state_timeout",1e4,function(){return t.bo=null,t.Fo("Backend didn't respond within 10 seconds."),t.Do("Offline"),Promise.resolve()}))},ch.prototype.$o=function(t){"Online"===this.state?this.Do("Unknown"):(this.vo++,1<=this.vo&&(this.No(),this.Fo("Connection failed 1 times. Most recent error: "+t.toString()),this.Do("Offline")))},ch.prototype.set=function(t){this.No(),this.vo=0,"Online"===t&&(this.So=!1),this.Do(t)},ch.prototype.Do=function(t){t!==this.state&&(this.state=t,this.yo(t))},ch.prototype.Fo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.So?(ki(e),this.So=!1):Di("OnlineStateTracker",e)},ch.prototype.No=function(){null!==this.bo&&(this.bo.cancel(),this.bo=null)},ch),zu=(hh.prototype.start=function(){return this.enableNetwork()},hh.prototype.enableNetwork=function(){return this.Mo.delete(0),this.th()},hh.prototype.th=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(this.eh()?this.nh():this.jo.set("Unknown"),[4,this.sh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},hh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(0),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),[2]}})})},hh.prototype.ih=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Yo.stop()];case 1:return t.sent(),[4,this.Go.stop()];case 2:return t.sent(),0<this.Lo.length&&(Di("RemoteStore","Stopping write stream with "+this.Lo.length+" pending writes"),this.Lo=[]),this.rh(),[2]}})})},hh.prototype.oh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Di("RemoteStore","RemoteStore shutting down."),this.Mo.add(5),[4,this.ih()];case 1:return t.sent(),this.Uo.oh(),this.jo.set("Unknown"),[2]}})})},hh.prototype.listen=function(t){this.Oo.has(t.targetId)||(this.Oo.set(t.targetId,t),this.eh()?this.nh():this.Go.Yr()&&this.hh(t))},hh.prototype.ah=function(t){this.Oo.delete(t),this.Go.Yr()&&this.uh(t),0===this.Oo.size&&(this.Go.Yr()?this.Go.Zr():this.Wo()&&this.jo.set("Unknown"))},hh.prototype.Le=function(t){return this.Oo.get(t)||null},hh.prototype.xe=function(t){return this.lh.xe(t)},hh.prototype.hh=function(t){this.qo.de(t.targetId),this.Go._o(t)},hh.prototype.uh=function(t){this.qo.de(t),this.Go.fo(t)},hh.prototype.nh=function(){this.qo=new eo(this),this.Go.start(),this.jo.Co()},hh.prototype.eh=function(){return this.Wo()&&!this.Go.Hr()&&0<this.Oo.size},hh.prototype.Wo=function(){return 0===this.Mo.size},hh.prototype.rh=function(){this.qo=null},hh.prototype.zo=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.Oo.forEach(function(t,e){n.hh(t)}),[2]})})},hh.prototype.Ko=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.rh(),this.eh()?(this.jo.$o(e),this.nh()):this.jo.set("Unknown"),[2]})})},hh.prototype.Ho=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.jo.set("Online"),!(r instanceof Yr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this._h(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Di("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.fh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof Kr?this.qo.Pe(r):r instanceof Wr?this.qo.Ce(r):this.qo.ye(r),o.isEqual(Zi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.ko.Mi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.dh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Di("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.fh(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},hh.prototype.fh=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!au(n))throw n;return this.Mo.add(1),[4,this.ih()];case 1:return t.sent(),this.jo.set("Offline"),i=i||function(){return e.ko.Mi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Di("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.Mo.delete(1),[4,this.th()];case 2:return t.sent(),[2]}})})}),[2]}})})},hh.prototype.wh=function(e){var n=this;return e().catch(function(t){return n.fh(t,e)})},hh.prototype.dh=function(i){var r=this,t=this.qo.$e(i);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=r.Oo.get(e))&&r.Oo.set(e,n.tt(t.resumeToken,i))}),t.Qt.forEach(function(t){var e,n=r.Oo.get(t);n&&(r.Oo.set(t,n.tt(br.Y,n.J)),r.uh(t),e=new Nr(n.target,t,1,n.sequenceNumber),r.hh(e))}),this.lh.Ui(t)},hh.prototype._h=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.Oo.has(r)?[4,this.lh.Th(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.Oo.delete(r),this.qo.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},hh.prototype.sh=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:e=0<this.Lo.length?this.Lo[this.Lo.length-1].batchId:-1,t.label=1;case 1:if(!this.mh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.ko.nr(e)];case 3:return null===(n=t.sent())?(0===this.Lo.length&&this.Yo.Zr(),[3,7]):(e=n.batchId,this.Eh(n),[3,6]);case 4:return i=t.sent(),[4,this.fh(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ih()&&this.Rh(),[2]}})})},hh.prototype.mh=function(){return this.Wo()&&this.Lo.length<10},hh.prototype.Ah=function(){return this.Lo.length},hh.prototype.Eh=function(t){this.Lo.push(t),this.Yo.Yr()&&this.Yo.wo&&this.Yo.To(t.mutations)},hh.prototype.Ih=function(){return this.Wo()&&!this.Yo.Hr()&&0<this.Lo.length},hh.prototype.Rh=function(){this.Yo.start()},hh.prototype.Xo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Yo.Io(),[2]})})},hh.prototype.Zo=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this.Lo;e<n.length;e++)i=n[e],this.Yo.To(i.mutations);return[2]})})},hh.prototype.mo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Lo.shift(),n=ja.from(e,r,o),[4,this.wh(function(){return i.lh.Ph(n)})];case 1:return t.sent(),[4,this.sh()];case 2:return t.sent(),[2]}})})},hh.prototype.Jo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Yo.wo?[4,this.Vh(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ih()&&this.Rh(),[2]}})})},hh.prototype.Vh=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Rr(n=r.code)&&n!==Qi.ABORTED?(e=this.Lo.shift(),this.Yo.Jr(),[4,this.wh(function(){return i.lh.ph(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.sh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},hh.prototype.Qo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Mo.add(4),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),this.Yo.Jr(),this.Go.Jr(),this.Mo.delete(4),[4,this.th()];case 2:return t.sent(),[2]}})})},hh.prototype.yh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Di("RemoteStore","RemoteStore received new credentials"),this.Mo.add(3),[4,this.ih()];case 1:return t.sent(),this.jo.set("Unknown"),[4,this.lh.yh(e)];case 2:return t.sent(),this.Mo.delete(3),[4,this.th()];case 3:return t.sent(),[2]}})})},hh.prototype.gh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Mo.delete(2),[4,this.th()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Mo.add(2),[4,this.ih()]);case 3:t.sent(),this.jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},hh),Hu=(uh.prototype.vh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},uh.prototype.bh=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},uh.prototype.Sh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},uh),Ku=(ah.prototype.Fh=function(t){},ah.prototype.$h=function(t,e,n){},ah.prototype.Nh=function(t){return this.Ch.vh(t),this.Dh[t]||"not-current"},ah.prototype.kh=function(t,e,n){this.Dh[t]=e},ah.prototype.xh=function(t){this.Ch.bh(t)},ah.prototype.Lh=function(t){return this.Ch.activeTargetIds.has(t)},ah.prototype.Oh=function(t){delete this.Dh[t]},ah.prototype.qh=function(){return this.Ch.activeTargetIds},ah.prototype.Mh=function(t){return this.Ch.activeTargetIds.has(t)},ah.prototype.start=function(){return this.Ch=new Hu,Promise.resolve()},ah.prototype.Vi=function(t,e,n){},ah.prototype.Uh=function(t){},ah.prototype.oh=function(){},ah.prototype.es=function(t){},ah),Wu=(Object.defineProperty(sh.prototype,"zh",{get:function(){return this.Bh},enumerable:!1,configurable:!0}),sh.prototype.Kh=function(t,e){var a=this,u=e?e.Hh:new Qr,h=e?e.Gh:this.Gh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),i=(i=e instanceof Qs?e:null)&&(ya(a.query,i)?i:null),r=!!n&&a.qt.has(n.key),o=!!i&&(i.Ge||a.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.Yh(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.jh(i,p)||d&&a.jh(i,d)<0)&&(f=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Gh:l,Hh:u,Xh:f,qt:c}},sh.prototype.Yh=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},sh.prototype.Jh=function(t,e,n){var o=this,i=this.Gh;this.Gh=t.Gh,this.qt=t.qt;var r=t.Hh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.jh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vi()}}var i,r}),this.Zh(n);var s=e?this.ta():[],a=0===this.Qh.size&&this.Ht?1:0,u=a!==this.Wh;return this.Wh=a,0!==r.length||u?{snapshot:new $r(this.query,t.Gh,i,r,t.qt,0==a,u,!1),ea:s}:{ea:s}},sh.prototype.na=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Jh({Gh:this.Gh,Hh:new Qr,qt:this.qt,Xh:!1},!1)):{ea:[]}},sh.prototype.sa=function(t){return!this.Bh.has(t)&&!!this.Gh.has(t)&&!this.Gh.get(t).Ge},sh.prototype.Zh=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Bh=e.Bh.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Bh=e.Bh.delete(t)}),this.Ht=t.Ht)},sh.prototype.ta=function(){var e=this;if(!this.Ht)return[];var n=this.Qh;this.Qh=zr(),this.Gh.forEach(function(t){e.sa(t.key)&&(e.Qh=e.Qh.add(t.key))});var i=[];return n.forEach(function(t){e.Qh.has(t)||i.push(new Ru(t))}),this.Qh.forEach(function(t){n.has(t)||i.push(new _u(t))}),i},sh.prototype.ia=function(t){this.Bh=t._r,this.Qh=zr();var e=this.Kh(t.documents);return this.Jh(e,!0)},sh.prototype.ra=function(){return $r.Bt(this.query,this.Gh,this.qt,0===this.Wh)},sh),Yu=(Object.defineProperty(oh.prototype,"Aa",{get:function(){return!0===this.Ra},enumerable:!1,configurable:!0}),oh.prototype.subscribe=function(t){this.ca=t},oh.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.Pa("listen()"),(i=this.la.get(s))?(e=i.targetId,this.aa.Nh(e),n=i.view.ra(),[3,4]):[3,1];case 1:return[4,this.ko.rr(ua(s))];case 2:return r=t.sent(),o=this.aa.Nh(r.targetId),e=r.targetId,[4,this.Va(s,e,"current"===o)];case 3:n=t.sent(),this.Aa&&this.ha.listen(r),t.label=4;case 4:return[2,n]}})})},oh.prototype.Va=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.ko.cr(a,!0)];case 1:return e=t.sent(),n=new Wu(a,e._r),i=n.Kh(e.documents),r=Zr.Kt(u,h&&"Offline"!==this.onlineState),o=n.Jh(i,this.Aa,r),this.pa(u,o.ea),s=new Ou(a,u,n),[2,(this.la.set(a,s),this._a.has(u)?this._a.get(u).push(a):this._a.set(u,[a]),o.snapshot)]}})})},oh.prototype.ah=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("unlisten()"),e=this.la.get(r),1<(n=this._a.get(e.targetId)).length?[2,(this._a.set(e.targetId,n.filter(function(t){return!fa(t,r)})),void this.la.delete(r))]:this.Aa?(this.aa.xh(e.targetId),this.aa.Mh(e.targetId)?[3,2]:[4,this.ko.ur(e.targetId,!1).then(function(){i.aa.Oh(e.targetId),i.ha.ah(e.targetId),i.ya(e.targetId)}).catch(mu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ya(e.targetId),[4,this.ko.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},oh.prototype.write=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:this.Pa("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.ko.bi(r)];case 2:return e=t.sent(),this.aa.Fh(e.batchId),this.ga(e.batchId,o),[4,this.va(e.Ci)];case 3:return t.sent(),[4,this.ha.sh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=pu(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},oh.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.Pa("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=i.wa.get(e);n&&(Ci(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.oa=!0:0<t.Xt.size?Ci(n.oa):0<t.Jt.size&&(Ci(n.oa),n.oa=!1))}),[4,this.va(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,mu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oh.prototype.na=function(i,t){var r;(this.Aa&&0===t||!this.Aa&&1===t)&&(this.Pa("applyOnlineStateChange()"),r=[],this.la.forEach(function(t,e){var n=e.view.na(i);n.snapshot&&r.push(n.snapshot)}),this.ca.ba(i),this.ca.lo(r),this.onlineState=i,this.Aa&&this.aa.Uh(i))},oh.prototype.Th=function(a,u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.Pa("rejectListens()"),this.aa.kh(a,"rejected",u),e=this.wa.get(a),(n=e&&e.key)?(i=(i=new Sr(rr.P)).nt(n,new $s(n,Zi.min())),r=zr().add(n),o=new Jr(Zi.min(),new Map,new Ur(xi),i,r),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.da=this.da.remove(n),this.wa.delete(a),this.Sa(),[3,4];case 2:return[4,this.ko.ur(a,!1).then(function(){return s.ya(a,u)}).catch(mu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},oh.prototype.Ph=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.Pa("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.Di(i)];case 2:return n=t.sent(),this.Ca(e,null),this.Da(e),this.aa.$h(e,"acknowledged"),[4,this.va(n)];case 3:return t.sent(),[3,6];case 4:return[4,mu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oh.prototype.ph=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.Pa("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ko.xi(n)];case 2:return e=t.sent(),this.Ca(n,i),this.Da(n),this.aa.$h(n,"rejected",i),[4,this.va(e)];case 3:return t.sent(),[3,6];case 4:return[4,mu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oh.prototype.Fa=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:this.ha.Wo()||Di("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ko.qi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Ea.get(e)||[]).push(o),this.Ea.set(e,n),[3,4]);case 3:return i=t.sent(),r=pu(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},oh.prototype.Da=function(t){(this.Ea.get(t)||[]).forEach(function(t){t.resolve()}),this.Ea.delete(t)},oh.prototype.$a=function(e){this.Ea.forEach(function(t){t.forEach(function(t){t.reject(new $i(Qi.CANCELLED,e))})}),this.Ea.clear()},oh.prototype.ga=function(t,e){var n=this.ma[this.currentUser.Sr()];n=(n=n||new Sr(xi)).nt(t,e),this.ma[this.currentUser.Sr()]=n},oh.prototype.Ca=function(t,e){var n,i=this.ma[this.currentUser.Sr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.ma[this.currentUser.Sr()]=i)},oh.prototype.ya=function(t,e){var n=this;void 0===e&&(e=null),this.aa.xh(t);for(var i=0,r=this._a.get(t);i<r.length;i++){var o=r[i];this.la.delete(o),e&&this.ca.Na(o,e)}this._a.delete(t),this.Aa&&this.Ta.Vr(t).forEach(function(t){n.Ta.gr(t)||n.ka(t)})},oh.prototype.ka=function(t){var e=this.da.get(t);null!==e&&(this.ha.ah(e),this.da=this.da.remove(t),this.wa.delete(e),this.Sa())},oh.prototype.pa=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof _u?(this.Ta.tr(r.key,t),this.xa(r)):r instanceof Ru?(Di("SyncEngine","Document no longer in limbo: "+r.key),this.Ta.er(r.key,t),this.Ta.gr(r.key)||this.ka(r.key)):Vi()}},oh.prototype.xa=function(t){var e=t.key;this.da.get(e)||(Di("SyncEngine","New document in limbo: "+e),this.fa.push(e),this.Sa())},oh.prototype.Sa=function(){for(;0<this.fa.length&&this.da.size<this.ua;){var t=this.fa.shift(),e=this.Ia.next();this.wa.set(e,new Su(t)),this.da=this.da.nt(t,e),this.ha.listen(new Nr(ua(oa(t.path)),e,2,Ha.ns))}},oh.prototype.La=function(){return this.da},oh.prototype.Oa=function(){return this.fa},oh.prototype.va=function(i,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.la.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Kh(i);return n.Xh?a.ko.cr(r.query,!1).then(function(t){var e=t.documents;return r.view.Kh(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(r.targetId),i=r.view.Jh(t,a.Aa,n);a.pa(r.targetId,i.ea),i.snapshot&&(a.Aa&&a.aa.kh(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=za.Xn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.ca.lo(o),[4,this.ko.Zi(s)];case 2:return t.sent(),[2]}})})},oh.prototype.Pa=function(t){},oh.prototype.yh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Di("SyncEngine","User change. New user:",n.Sr()),[4,this.ko.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.$a("'waitForPendingWrites' promise is rejected due to a user change."),this.aa.Vi(n,e.gi,e.vi),[4,this.va(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},oh.prototype.xe=function(t){var e=this.wa.get(t);if(e&&e.oa)return zr().add(e.key);var n=zr(),i=this._a.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],a=this.la.get(s),n=n.Dt(a.view.zh);return n},oh),Xu=(rh.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(i=this.Ma.get(e))||(n=!0,i=new Du),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.lh.listen(e)];case 2:return r.qa=t.sent(),[3,4];case 3:return o=t.sent(),s=pu(o,"Initialization of query '"+da(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.Ma.set(e,i),i.listeners.push(a),a.na(this.onlineState),i.qa&&a.Ba(i.qa)&&this.Wa(),[2]}})})},rh.prototype.ah=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.Ma.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.Ma.delete(e),this.lh.ah(e))]:[2]})})},rh.prototype.lo=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.Ma.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Ba(r)&&(e=!0);s.qa=r}}e&&this.Wa()},rh.prototype.Na=function(t,e){var n=this.Ma.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.Ma.delete(t)},rh.prototype.ba=function(r){this.onlineState=r;var o=!1;this.Ma.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].na(r)&&(o=!0)}),o&&this.Wa()},rh.prototype.Qa=function(t){this.Ua.add(t),t.next()},rh.prototype.ja=function(t){this.Ua.delete(t)},rh.prototype.Wa=function(){this.Ua.forEach(function(t){t.next()})},rh),Qu=(ih.prototype.Ba=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new $r(t.query,t.docs,t.Ot,e,t.qt,t.fromCache,t.Mt,!0)}var o=!1;return this.za?this.Ha(t)&&(this.Ga.next(t),o=!0):this.Ya(t,this.onlineState)&&(this.Xa(t),o=!0),this.Ka=t,o},ih.prototype.onError=function(t){this.Ga.error(t)},ih.prototype.na=function(t){this.onlineState=t;var e=!1;return this.Ka&&!this.za&&this.Ya(this.Ka,t)&&(this.Xa(this.Ka),e=!0),e},ih.prototype.Ya=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ja&&n||t.docs._()&&"Offline"!==e)},ih.prototype.Ha=function(t){if(0<t.docChanges.length)return!0;var e=this.Ka&&this.Ka.hasPendingWrites!==t.hasPendingWrites;return!(!t.Mt&&!e)&&!0===this.options.includeMetadataChanges},ih.prototype.Xa=function(t){t=$r.Bt(t.query,t.docs,t.qt,t.fromCache),this.za=!0,this.Ga.next(t)},ih),$u=(nh.prototype.Pi=function(t){this.Za=t},nh.prototype.Bn=function(e,i,r,o){var s=this;return i.on()||r.isEqual(Zi.min())?this.tu(e,i):this.Za.qn(e,o).next(function(t){var n=s.eu(i,t);return(i.hn()||i.an())&&s.Xh(i.en,n,o,r)?s.tu(e,i):(Si()<=a.DEBUG&&Di("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),da(i)),s.Za.Bn(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},nh.prototype.eu=function(n,t){var i=new Ur(va(n));return t.forEach(function(t,e){e instanceof Qs&&ya(n,e)&&(i=i.add(e))}),i},nh.prototype.Xh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},nh.prototype.tu=function(t,e){return Si()<=a.DEBUG&&Di("IndexFreeQueryEngine","Using full collection scan to execute query:",da(e)),this.Za.Bn(t,e,Zi.min())},nh),Ju=(eh.prototype.iu=function(t){return Ga.resolve(0===this.Fn.length)},eh.prototype.Si=function(t,e,n,i){var r=this.nu;this.nu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Fa(r,e,n,i);this.Fn.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.su=this.su.add(new bu(u.key,r)),this.$n.Is(t,u.key.path.g())}return Ga.resolve(o)},eh.prototype.Li=function(t,e){return Ga.resolve(this.ru(e))},eh.prototype.sr=function(t,e){var n=e+1,i=this.ou(n),r=i<0?0:i;return Ga.resolve(this.Fn.length>r?this.Fn[r]:null)},eh.prototype.qi=function(){return Ga.resolve(0===this.Fn.length?-1:this.nu-1)},eh.prototype.pi=function(t){return Ga.resolve(this.Fn.slice())},eh.prototype.kn=function(t,e){var n=this,i=new bu(e,0),r=new bu(e,Number.POSITIVE_INFINITY),o=[];return this.su.bt([i,r],function(t){var e=n.ru(t.vr);o.push(e)}),Ga.resolve(o)},eh.prototype.Un=function(t,e){var i=this,r=new Ur(xi);return e.forEach(function(t){var e=new bu(t,0),n=new bu(t,Number.POSITIVE_INFINITY);i.su.bt([e,n],function(t){r=r.add(t.vr)})}),Ga.resolve(this.hu(r))},eh.prototype.zn=function(t,e){var n=e.path,i=n.length+1,r=n;rr.W(r)||(r=r.child(""));var o=new bu(new rr(r),0),s=new Ur(xi);return this.su.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.vr)),!0)},o),Ga.resolve(this.hu(s))},eh.prototype.hu=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.ru(t);null!==e&&i.push(e)}),i},eh.prototype.Oi=function(n,i){var r=this;Ci(0===this.au(i.batchId,"removed")),this.Fn.shift();var o=this.su;return Ga.forEach(i.mutations,function(t){var e=new bu(t.key,i.batchId);return o=o.delete(e),r.Yi.uu(n,t.key)}).next(function(){r.su=o})},eh.prototype.cu=function(t){},eh.prototype.gr=function(t,e){var n=new bu(e,0),i=this.su.Ct(n);return Ga.resolve(e.isEqual(i&&i.key))},eh.prototype.ki=function(t){return this.Fn.length,Ga.resolve()},eh.prototype.au=function(t,e){return this.ou(t)},eh.prototype.ou=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},eh.prototype.ru=function(t){var e=this.ou(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},eh),Zu=(th.prototype.Ki=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.lu(e);return this.docs=this.docs.nt(i,{_u:e,size:s,readTime:n}),this.size+=s-o,this.$n.Is(t,i.path.g())},th.prototype.zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},th.prototype.Ln=function(t,e){var n=this.docs.get(e);return Ga.resolve(n?n._u:null)},th.prototype.getEntries=function(t,e){var n=this,i=xr;return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e._u:null)}),Ga.resolve(i)},th.prototype.Bn=function(t,e,n){for(var i=jr,r=new rr(e.path.child("")),o=this.docs.ut(r);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u._u,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Qs&&ya(e,h)&&(i=i.nt(h.key,h))}return Ga.resolve(i)},th.prototype.fu=function(t,e){return Ga.forEach(this.docs,function(t){return e(t)})},th.prototype.Fi=function(t){return new th.du(this)},th.prototype.wu=function(t){return Ga.resolve(this.size)},th);function th(t,e){this.$n=t,this.lu=e,this.docs=new Sr(rr.P),this.size=0}function eh(t,e){this.$n=t,this.Yi=e,this.Fn=[],this.nu=1,this.su=new Ur(bu.mr)}function nh(){}function ih(t,e,n){this.query=t,this.Ga=e,this.za=!1,this.Ka=null,this.onlineState="Unknown",this.options=n||{}}function rh(t){this.lh=t,this.Ma=new Xi(pa,fa),this.onlineState="Unknown",this.Ua=new Set,this.lh.subscribe(this)}function oh(t,e,n,i,r,o){this.ko=t,this.ha=e,this.xo=n,this.aa=i,this.currentUser=r,this.ua=o,this.ca=null,this.la=new Xi(pa,fa),this._a=new Map,this.fa=[],this.da=new Sr(rr.P),this.wa=new Map,this.Ta=new wu,this.ma={},this.Ea=new Map,this.Ia=nu.Ps(),this.onlineState="Unknown",this.Ra=void 0}function sh(t,e){this.query=t,this.Bh=e,this.Wh=null,this.Ht=!1,this.Qh=zr(),this.qt=zr(),this.jh=va(t),this.Gh=new Xr(this.jh)}function ah(){this.Ch=new Hu,this.Dh={},this.yo=null,this.Jn=null}function uh(){this.activeTargetIds=Hr}function hh(t,e,n,i,r){var o,s,a,u,h,c,l,f,p=this;this.ko=t,this.xo=e,this.Vs=n,this.Lo=[],this.Oo=new Map,this.qo=null,this.Mo=new Set,this.Uo=r,this.Uo.Bo(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Wo()?(Di("RemoteStore","Restarting streams for network reachability change."),[4,this.Qo()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.jo=new Bu(n,i),this.Go=(h=this.xo,c=n,l={uo:this.zo.bind(this),io:this.Ko.bind(this),lo:this.Ho.bind(this)},(f=h).Ao(),new Fu(c,f.jr,f.credentials,f.serializer,l)),this.Yo=(o=this.xo,s=n,a={uo:this.Xo.bind(this),io:this.Jo.bind(this),Eo:this.Zo.bind(this),mo:this.mo.bind(this)},(u=o).Ao(),new ju(s,u.jr,u.credentials,u.serializer,a))}function ch(t,e){this.Vs=t,this.yo=e,this.state="Unknown",this.vo=0,this.bo=null,this.So=!0}function lh(t,e){var n=this;return(n=ku.call(this)||this).credentials=t,n.serializer=e,n.Ro=!1,n}function fh(t,e,n,i,r){var o=this;return(o=Pu.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.do=!1,o}function ph(t,e,n,i,r){var o=this;return(o=Lu.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function dh(t,e,n,i,r,o){this.ss=t,this.Qr=n,this.jr=i,this.Gr=r,this.listener=o,this.state=0,this.zr=0,this.Kr=null,this.stream=null,this.Os=new Za(t,e)}function yh(t,e){this.Ur=t,this.Br=e}function vh(t,e){this.Ur=t,this.Br=e,this.type="FirstParty",this.user=Eu.Dr}function gh(t){var e=this;this.Lr=null,this.currentUser=Eu.UNAUTHENTICATED,this.Or=!1,this.qr=0,this.$r=null,this.forceRefresh=!1,this.Lr=function(){e.qr++,e.currentUser=e.Mr(),e.Or=!0,e.$r&&e.$r(e.currentUser)},this.qr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Lr):(this.Lr(null),t.get().then(function(t){e.auth=t,e.Lr&&e.auth.addAuthTokenListener(e.Lr)},function(){}))}function mh(){this.$r=null}function wh(t){var e=this;return(e=Vu.call(this)||this).Au=t,e}function bh(){this.Ci=new Xi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Tu=!1}Zu.du=(Object.defineProperty(bh.prototype,"readTime",{get:function(){return this.mu},set:function(t){this.mu=t},enumerable:!1,configurable:!0}),bh.prototype.Ki=function(t,e){this.Eu(),this.readTime=e,this.Ci.set(t.key,t)},bh.prototype.zi=function(t,e){this.Eu(),e&&(this.readTime=e),this.Ci.set(t,null)},bh.prototype.Ln=function(t,e){this.Eu();var n=this.Ci.get(e);return void 0!==n?Ga.resolve(n):this.Iu(t,e)},bh.prototype.getEntries=function(t,e){return this.Ru(t,e)},bh.prototype.apply=function(t){return this.Eu(),this.Tu=!0,this.Jh(t)},bh.prototype.Eu=function(){},n(wh,Vu=bh),wh.prototype.Jh=function(n){var i=this,r=[];return this.Ci.forEach(function(t,e){e?r.push(i.Au.Ki(n,e,i.readTime)):i.Au.zi(t)}),Ga.Sn(r)},wh.prototype.Iu=function(t,e){return this.Au.Ln(t,e)},wh.prototype.Ru=function(t,e){return this.Au.getEntries(t,e)},wh);var Eh,Ih,Th=(jh.prototype.ge=function(t,n){return this.Pu.forEach(function(t,e){return n(e)}),Ga.resolve()},jh.prototype.Mi=function(t){return Ga.resolve(this.lastRemoteSnapshotVersion)},jh.prototype.gu=function(t){return Ga.resolve(this.Vu)},jh.prototype.hr=function(t){return this.highestTargetId=this.yu.next(),Ga.resolve(this.highestTargetId)},jh.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Vu&&(this.Vu=e),Ga.resolve()},jh.prototype.vu=function(t){this.Pu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.yu=new nu(e),this.highestTargetId=e),t.sequenceNumber>this.Vu&&(this.Vu=t.sequenceNumber)},jh.prototype.ar=function(t,e){return this.vu(e),this.targetCount+=1,Ga.resolve()},jh.prototype.Gi=function(t,e){return this.vu(e),Ga.resolve()},jh.prototype.bu=function(t,e){return this.Pu.delete(e.target),this.pu.Vr(e.targetId),--this.targetCount,Ga.resolve()},jh.prototype.Su=function(n,i,r){var o=this,s=0,a=[];return this.Pu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Pu.delete(t),a.push(o.Cu(n,e.targetId)),s++)}),Ga.Sn(a).next(function(){return s})},jh.prototype.Du=function(t){return Ga.resolve(this.targetCount)},jh.prototype.or=function(t,e){var n=this.Pu.get(e)||null;return Ga.resolve(n)},jh.prototype.Wi=function(t,e,n){return this.pu.Rr(e,n),Ga.resolve()},jh.prototype.Bi=function(e,t,n){this.pu.Pr(t,n);var i=this.persistence.Yi,r=[];return i&&t.forEach(function(t){r.push(i.uu(e,t))}),Ga.Sn(r)},jh.prototype.Cu=function(t,e){return this.pu.Vr(e),Ga.resolve()},jh.prototype.lr=function(t,e){var n=this.pu.yr(e);return Ga.resolve(n)},jh.prototype.gr=function(t,e){return Ga.resolve(this.pu.gr(e))},jh),Ah=(Fh.prototype.start=function(){return Promise.resolve()},Fh.prototype.oh=function(){return this.Nu=!1,Promise.resolve()},Object.defineProperty(Fh.prototype,"xu",{get:function(){return this.Nu},enumerable:!1,configurable:!0}),Fh.prototype.Lu=function(){},Fh.prototype.Ou=function(){},Fh.prototype.Ai=function(){return this.$n},Fh.prototype.wi=function(t){var e=this.Fu[t.Sr()];return e||(e=new Ju(this.$n,this.Yi),this.Fu[t.Sr()]=e),e},Fh.prototype.Ii=function(){return this.Ei},Fh.prototype.mi=function(){return this.Dn},Fh.prototype.runTransaction=function(t,e,n){var i=this;Di("MemoryPersistence","Starting transaction:",t);var r=new Nh(this.$u.next());return this.Yi.qu(),n(r).next(function(t){return i.Yi.Mu(r).next(function(){return t})}).vn().then(function(t){return r.Uu(),t})},Fh.prototype.Bu=function(e,n){return Ga.Cn(Object.values(this.Fu).map(function(t){return function(){return t.gr(e,n)}}))},Fh),Nh=(qh.prototype.Qu=function(t){this.Wu.push(t)},qh.prototype.Uu=function(){this.Wu.forEach(function(t){return t()})},n(xh,Ih=qh),xh),_h=(Mh.zu=function(t){return new Mh(t)},Object.defineProperty(Mh.prototype,"Ku",{get:function(){if(this.Gu)return this.Gu;throw Vi()},enumerable:!1,configurable:!0}),Mh.prototype.tr=function(t,e,n){return this.ju.tr(n,e),this.Ku.delete(n),Ga.resolve()},Mh.prototype.er=function(t,e,n){return this.ju.er(n,e),this.Ku.add(n),Ga.resolve()},Mh.prototype.uu=function(t,e){return this.Ku.add(e),Ga.resolve()},Mh.prototype.removeTarget=function(t,e){var n=this;this.ju.Vr(e.targetId).forEach(function(t){return n.Ku.add(t)});var i=this.persistence.Ii();return i.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ku.add(t)})}).next(function(){return i.bu(t,e)})},Mh.prototype.qu=function(){this.Gu=new Set},Mh.prototype.Mu=function(t){var n=this,i=this.persistence.mi().Fi();return Ga.forEach(this.Ku,function(e){return n.Hu(t,e).next(function(t){t||i.zi(e)})}).next(function(){return n.Gu=null,i.apply(t)})},Mh.prototype.Hi=function(t,e){var n=this;return this.Hu(t,e).next(function(t){t?n.Ku.delete(e):n.Ku.add(e)})},Mh.prototype.ku=function(t){return 0},Mh.prototype.Hu=function(t,e){var n=this;return Ga.Cn([function(){return Ga.resolve(n.ju.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.Bu(t,e)}])},Mh),Rh=(Uh.prototype.uo=function(t){this.Ju=t},Uh.prototype.io=function(t){this.Zu=t},Uh.prototype.onMessage=function(t){this.tc=t},Uh.prototype.close=function(){this.Xu()},Uh.prototype.send=function(t){this.Yu(t)},Uh.prototype.ec=function(){this.Ju()},Uh.prototype.nc=function(t){this.Zu(t)},Uh.prototype.sc=function(t){this.tc(t)},Uh),Oh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Sh=(Ch.prototype.Po=function(e,t,n,i){var r=this.hc(e,t);Di("RestConnection","Sending: ",r,n);var o={};return this.ac(o,i),this.uc(e,r,o,n).then(function(t){return Di("RestConnection","Received: ",t),t},function(t){throw Pi("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Ch.prototype.Vo=function(t,e,n,i){return this.Po(t,e,n,i)},Ch.prototype.ac=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2-20207421553",t["Content-Type"]="text/plain",e)for(var n in e.Fr)e.Fr.hasOwnProperty(n)&&(t[n]=e.Fr[n])},Ch.prototype.hc=function(t,e){var n=Oh[t];return this.rc+"/v1/"+e+":"+n},n(Vh,Eh=Ch),Vh.prototype.uc=function(u,e,n,i){return new Promise(function(o,s){var a=new Ai;a.listenOnce(Ii.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Ei.NO_ERROR:var t=a.getResponseJson();Di("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ei.TIMEOUT:Di("Connection",'RPC "'+u+'" timed out'),s(new $i(Qi.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:var e,n,i=a.getStatus();Di("Connection",'RPC "'+u+'" failed with status:',i,"response text:",a.getResponseText()),0<i?(e=a.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Qi).indexOf(r)?r:Qi.UNKNOWN,s(new $i(n,e.message))):s(new $i(Qi.UNKNOWN,"Server responded with status "+a.getStatus())):s(new $i(Qi.UNAVAILABLE,"Connection failed."));break;default:Vi()}}finally{Di("Connection",'RPC "'+u+'" completed.')}var r});var t=JSON.stringify(i);a.send(e,"POST",t,n,15)})},Vh.prototype.co=function(t,e){var n,i,r=[this.rc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=bi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ac(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Di("Connection","Creating WebChannel: "+a,s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Rh({Yu:function(t){l?Di("Connection","Not sending because WebChannel is closed:",t):(c||(Di("Connection","Opening WebChannel transport."),h.open(),c=!0),Di("Connection","WebChannel sending:",t),h.send(t))},Xu:function(){return h.close()}});return u(Ti.EventType.OPEN,function(){l||Di("Connection","WebChannel transport opened.")}),u(Ti.EventType.CLOSE,function(){l||(l=!0,Di("Connection","WebChannel transport closed"),f.nc())}),u(Ti.EventType.ERROR,function(t){l||(l=!0,Pi("Connection","WebChannel transport errored:",t),f.nc(new $i(Qi.UNAVAILABLE,"The operation could not be completed")))}),u(Ti.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Ci(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Di("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Tr[r];if(void 0!==t)return Or(t)}(),s=i.message,void 0===o&&(o=Qi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.nc(new $i(o,s)),h.close()):(Di("Connection","WebChannel received:",n),f.sc(n)))}),setTimeout(function(){f.ec()},0),f},Vh),Dh=(Lh.prototype.Bo=function(t){this.dc.push(t)},Lh.prototype.oh=function(){window.removeEventListener("online",this.cc),window.removeEventListener("offline",this._c)},Lh.prototype.wc=function(){window.addEventListener("online",this.cc),window.addEventListener("offline",this._c)},Lh.prototype.lc=function(){Di("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(0)},Lh.prototype.fc=function(){Di("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.dc;t<e.length;t++)(0,e[t])(1)},Lh.Tc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Lh),kh=(Ph.prototype.Bo=function(t){},Ph.prototype.oh=function(){},Ph);function Ph(){}function Lh(){var t=this;this.cc=function(){return t.lc()},this._c=function(){return t.fc()},this.dc=[],this.wc()}function Vh(t){var e=this;return(e=Eh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Ch(t){this.ic=t,this.s=t.s;var e=t.ssl?"https":"http";this.rc=e+"://"+t.host,this.oc="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Uh(t){this.Yu=t.Yu,this.Xu=t.Xu}function Mh(t){this.persistence=t,this.ju=new wu,this.Gu=null}function xh(t){var e=this;return(e=Ih.call(this)||this).Qi=t,e}function qh(){this.Wu=[]}function Fh(t){var e=this;this.Fu={},this.$u=new Ha(0),this.Nu=!1,this.Nu=!0,this.Yi=t(this),this.Ei=new Th(this),this.$n=new tu,this.Dn=new Zu(this.$n,function(t){return e.Yi.ku(t)})}function jh(t){this.persistence=t,this.Pu=new Xi(gr,mr),this.lastRemoteSnapshotVersion=Zi.min(),this.highestTargetId=0,this.Vu=0,this.pu=new wu,this.targetCount=0,this.yu=nu.As()}function Gh(t){return new Po(t,!0)}var Bh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",zh=(Wh.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.aa=this.mc(e),this.persistence=this.Ec(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ic=this.Rc(e),this.ko=this.Ac(e),[2]}})})},Wh.prototype.Rc=function(t){return null},Wh.prototype.Ac=function(t){return e=this.persistence,n=new $u,i=t.Pc,new vu(e,n,i);var e,n,i},Wh.prototype.Ec=function(t){if(t.pc.Vc)throw new $i(Qi.FAILED_PRECONDITION,Bh);return new Ah(_h.zu)},Wh.prototype.mc=function(t){return new Ku},Wh.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.aa.oh()];case 1:return t.sent(),[4,this.persistence.oh()];case 2:return t.sent(),[2]}})})},Wh.prototype.clearPersistence=function(t,e){throw new $i(Qi.FAILED_PRECONDITION,Bh)},Wh),Hh=(Kh.prototype.initialize=function(i,r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.ko?[2]:(this.ko=i.ko,this.aa=i.aa,this.xo=this.yc(r),[4,this.gc(r)]);case 1:return e=t.sent(),this.xo.start(e),this.ha=this.vc(r),this.lh=this.bc(r),this.Sc=this.Cc(r),this.aa.yo=function(t){return n.lh.na(t,1)},this.ha.lh=this.lh,[4,this.ha.start()];case 2:return t.sent(),[4,this.ha.gh(this.lh.Aa)];case 3:return t.sent(),[2]}})})},Kh.prototype.gc=function(t){return e=t.ic,Promise.resolve(new Sh(e));var e},Kh.prototype.Cc=function(t){return new Xu(this.lh)},Kh.prototype.yc=function(t){var e,n=Gh(t.ic.s);return e=t.credentials,new Gu(e,n)},Kh.prototype.vc=function(t){var e=this;return new zu(this.ko,this.xo,t.Vs,function(t){return e.lh.na(t,0)},new(Dh.Tc()?Dh:kh))},Kh.prototype.bc=function(t){return e=this.ko,n=this.ha,i=this.xo,r=this.aa,o=t.Pc,s=t.ua,a=!t.pc.Vc||!t.pc.synchronizeTabs,u=new Yu(e,n,i,r,o,s),a&&(u.Ra=!0),u;var e,n,i,r,o,s,a,u},Kh.prototype.terminate=function(){return this.ha.oh()},Kh);function Kh(){}function Wh(){}function Yh(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Xh=(Qh.prototype.next=function(t){this.observer.next&&this.Dc(this.observer.next,t)},Qh.prototype.error=function(t){this.observer.error?this.Dc(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Qh.prototype.Fc=function(){this.muted=!0},Qh.prototype.Dc=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Qh);function Qh(t){this.observer=t,this.muted=!1}function $h(t,e){if(0!==e.length)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+yc(e.length,"argument")+".")}function Jh(t,e,n){if(e.length!==n)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires "+yc(n,"argument")+", but was called with "+yc(e.length,"argument")+".")}function Zh(t,e,n){if(e.length<n)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+yc(n,"argument")+", but was called with "+yc(e.length,"argument")+".")}function tc(t,e,n,i){if(e.length<n||e.length>i)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+yc(e.length,"argument")+".")}function ec(t,e,n,i){ac(t,e,dc(n)+" argument",i)}function nc(t,e,n,i){void 0!==i&&ec(t,e,n,i)}function ic(t,e,n,i){ac(t,e,n+" option",i)}function rc(t,e,n,i){void 0!==i&&ic(t,e,n,i)}function oc(t,e,n,i,u){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=u;r<o.length;r++){var s=o[r];if(s===n)return;i.push(hc(s))}var a=hc(n);throw new $i(Qi.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function sc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new $i(Qi.INVALID_ARGUMENT,"Invalid value "+hc(i)+" provided to function "+t+"() for its "+dc(n)+" argument. Acceptable values: "+e.join(", "));return i}function ac(t,e,n,i){if(!("object"===e?uc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=hc(i);throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function uc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function hc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vi();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function cc(t,e,n){if(void 0===n)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+dc(e)+" argument, but it was undefined.")}function lc(n,t,i){zi(t,function(t,e){if(i.indexOf(t)<0)throw new $i(Qi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function fc(t,e,n,i){var r=hc(i);return new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+dc(n)+" argument to be a "+e+", but it was: "+r)}function pc(t,e,n){if(n<=0)throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+dc(e)+" argument to be a positive number, but it was: "+n+".")}function dc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function yc(t,e){return t+" "+e+(1===t?"":"s")}function vc(){if("undefined"==typeof Uint8Array)throw new $i(Qi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function gc(){if("undefined"==typeof atob)throw new $i(Qi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var mc,wc,bc=(Oc.fromBase64String=function(t){Jh("Blob.fromBase64String",arguments,1),ec("Blob.fromBase64String","string",1,t),gc();try{return new Oc(br.fromBase64String(t))}catch(t){throw new $i(Qi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Oc.fromUint8Array=function(t){if(Jh("Blob.fromUint8Array",arguments,1),vc(),!(t instanceof Uint8Array))throw fc("Blob.fromUint8Array","Uint8Array",1,t);return new Oc(br.fromUint8Array(t))},Oc.prototype.toBase64=function(){return Jh("Blob.toBase64",arguments,0),gc(),this.$c.toBase64()},Oc.prototype.toUint8Array=function(){return Jh("Blob.toUint8Array",arguments,0),vc(),this.$c.toUint8Array()},Oc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Oc.prototype.isEqual=function(t){return this.$c.isEqual(t.$c)},Oc),Ec=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $i(Qi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ec("FieldPath","string",e,t[e]),0===t[e].length)throw new $i(Qi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Nc=new ir(t)},Ic=(n(Rc,wc=Ec),Rc.documentId=function(){return new Rc(ir.q().$())},Rc.prototype.isEqual=function(t){if(!(t instanceof Rc))throw fc("isEqual","FieldPath",1,t);return this.Nc.isEqual(t.Nc)},Rc),Tc=new RegExp("[~\\*/\\[\\]]"),Ac=function(){this.kc=this},Nc=(n(_c,mc=Ac),_c.prototype.Lc=function(t){if(2!==t.Oc)throw 1===t.Oc?t.qc(this.xc+"() can only appear at the top level of your update data"):t.qc(this.xc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},_c.prototype.isEqual=function(t){return t instanceof _c},_c);function _c(t){var e=this;return(e=mc.call(this)||this).xc=t,e}function Rc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wc.call(this,t)||this}function Oc(t){gc(),this.$c=t}function Sc(t,e,n){return new il({Oc:3,Mc:e.settings.Mc,methodName:t.xc,Uc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Dc,kc,Pc,Lc,Vc,Cc,Uc=(n(el,Cc=Ac),el.prototype.Lc=function(t){return new ps(t.path,new Zo)},el.prototype.isEqual=function(t){return t instanceof el},el),Mc=(n(tl,Vc=Ac),tl.prototype.Lc=function(t){var e=Sc(this,t,!0),n=this.Bc.map(function(t){return ll(t,e)}),i=new ts(n);return new ps(t.path,i)},tl.prototype.isEqual=function(t){return this===t},tl),xc=(n(Zc,Lc=Ac),Zc.prototype.Lc=function(t){var e=Sc(this,t,!0),n=this.Bc.map(function(t){return ll(t,e)}),i=new os(n);return new ps(t.path,i)},Zc.prototype.isEqual=function(t){return this===t},Zc),qc=(n(Jc,Pc=Ac),Jc.prototype.Lc=function(t){var e=new hs(t.serializer,Co(t.serializer,this.Wc));return new ps(t.path,e)},Jc.prototype.isEqual=function(t){return this===t},Jc),Fc=(n($c,kc=Ac),$c.delete=function(){return $h("FieldValue.delete",arguments),new jc(new Nc("FieldValue.delete"))},$c.serverTimestamp=function(){return $h("FieldValue.serverTimestamp",arguments),new jc(new Uc("FieldValue.serverTimestamp"))},$c.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Zh("FieldValue.arrayUnion",arguments,1),new jc(new Mc("FieldValue.arrayUnion",t))},$c.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Zh("FieldValue.arrayRemove",arguments,1),new jc(new xc("FieldValue.arrayRemove",t))},$c.increment=function(t){return ec("FieldValue.increment","number",1,t),Jh("FieldValue.increment",arguments,1),new jc(new qc("FieldValue.increment",t))},$c),jc=(n(Qc,Dc=Fc),Qc.prototype.Lc=function(t){return this.kc.Lc(t)},Qc.prototype.isEqual=function(t){return t instanceof Qc&&this.kc.isEqual(t.kc)},Qc),Gc=(Object.defineProperty(Xc.prototype,"latitude",{get:function(){return this.Qc},enumerable:!1,configurable:!0}),Object.defineProperty(Xc.prototype,"longitude",{get:function(){return this.jc},enumerable:!1,configurable:!0}),Xc.prototype.isEqual=function(t){return this.Qc===t.Qc&&this.jc===t.jc},Xc.prototype.T=function(t){return xi(this.Qc,t.Qc)||xi(this.jc,t.jc)},Xc),Bc=/^__.*__$/,zc=function(t,e,n){this.Gc=t,this.zc=e,this.Kc=n},Hc=(Yc.prototype.Hc=function(t,e){var n=[];return null!==this.qe?n.push(new Os(t,this.data,this.qe,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ls(t,this.fieldTransforms)),n},Yc),Kc=(Wc.prototype.Hc=function(t,e){var n=[new Os(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ls(t,this.fieldTransforms)),n},Wc);function Wc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Yc(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Xc(t,e){if(Jh("GeoPoint",arguments,2),ec("GeoPoint","number",1,t),ec("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $i(Qi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $i(Qi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Qc=t,this.jc=e}function Qc(t){var e=this;return(e=Dc.call(this)||this).kc=t,e.xc=t.xc,e}function $c(){return kc.call(this)||this}function Jc(t,e){var n=this;return(n=Pc.call(this)||this).xc=t,n.Wc=e,n}function Zc(t,e){var n=this;return(n=Lc.call(this)||this).xc=t,n.Bc=e,n}function tl(t,e){var n=this;return(n=Vc.call(this)||this).xc=t,n.Bc=e,n}function el(t){var e=this;return(e=Cc.call(this)||this).xc=t,e}function nl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vi()}}var il=(Object.defineProperty(sl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(sl.prototype,"Oc",{get:function(){return this.settings.Oc},enumerable:!1,configurable:!0}),sl.prototype.Xc=function(t){return new sl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},sl.prototype.Jc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Xc({path:n,Uc:!1});return i.Zc(t),i},sl.prototype.tl=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Xc({path:n,Uc:!1});return i.Yc(),i},sl.prototype.el=function(t){return this.Xc({path:void 0,Uc:!0})},sl.prototype.qc=function(t){return gl(t,this.settings.methodName,this.settings.nl||!1,this.path,this.settings.Mc)},sl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},sl.prototype.Yc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Zc(this.path.get(t))},sl.prototype.Zc=function(t){if(0===t.length)throw this.qc("Document fields must not be empty");if(nl(this.Oc)&&Bc.test(t))throw this.qc('Document fields cannot begin and end with "__"')},sl),rl=(ol.prototype.sl=function(t,e,n,i){return void 0===i&&(i=!1),new il({Oc:t,methodName:e,Mc:n,path:ir.k(),Uc:!1,nl:i},this.s,this.serializer,this.ignoreUndefinedProperties)},ol);function ol(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Gh(t)}function sl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Yc(),this.fieldTransforms=r||[],this.qe=o||[]}function al(t,e,n,i,r,o){void 0===o&&(o={});var s=t.sl(o.merge||o.mergeFields?2:0,e,n,r);dl("Data must be an object, but it was:",s,i);var a,u,h=fl(i,s);if(o.merge)a=new ds(s.qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Ec)d=p.Nc;else{if("string"!=typeof p)throw Vi();d=vl(e,p,n)}if(!s.contains(d))throw new $i(Qi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");ml(c,d)||c.push(d)}a=new ds(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Hc(new Fs(h),a,u)}function ul(t,o,s,e){var a=t.sl(1,o,s);dl("Data must be an object, but it was:",a,e);var u=[],h=new js;zi(e,function(t,e){var n,i=vl(o,t,s),r=a.tl(i);e instanceof Ac&&e.kc instanceof Nc?u.push(i):null!=(n=ll(e,r))&&(u.push(i),h.set(i,n))});var n=new ds(u);return new Kc(h.ze(),n,a.fieldTransforms)}function hl(t,e,n,i,r,o){var s=t.sl(1,e,n),a=[yl(e,i,n)],u=[r];if(o.length%2!=0)throw new $i(Qi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(yl(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new js,v=a.length-1;0<=v;--v){ml(d,a[v])||(c=a[v],l=u[v],f=s.tl(c),l instanceof Ac&&l.kc instanceof Nc?d.push(c):null!=(p=ll(l,f))&&(d.push(c),y.set(c,p)))}var g=new ds(d);return new Kc(y.ze(),g,s.fieldTransforms)}function cl(t,e,n,i){return void 0===i&&(i=!1),ll(n,t.sl(i?4:3,e))}function ll(s,t){if(pl(s))return dl("Unsupported field value:",t,s),fl(s,t);if(s instanceof Ac)return function(t,e){if(!nl(e.Oc))throw e.qc(t.xc+"() can only be used with update() and set()");if(!e.path)throw e.qc(t.xc+"() is not currently supported inside arrays");var n=t.Lc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.Uc&&4!==t.Oc)throw t.qc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=ll(r[i],t.el(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ji.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof Ji){var i=new Ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,i)}}if(t instanceof Gc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bc)return{bytesValue:Mo(e.serializer,t)};if(t instanceof zc){var r=e.s,o=t.Gc;if(!o.isEqual(r))throw e.qc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:qo(t.Gc||e.s,t.zc.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.qc("Unsupported field value: "+hc(t))}(s,t)}function fl(t,i){var r={};return Hi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):zi(t,function(t,e){var n=ll(e,i.Jc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function pl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ji||t instanceof Gc||t instanceof bc||t instanceof zc||t instanceof Ac)}function dl(t,e,n){if(!pl(n)||!uc(n)){var i=hc(n);throw"an object"===i?e.qc(t+" a custom object"):e.qc(t+" "+i)}}function yl(t,e,n){if(e instanceof Ec)return e.Nc;if("string"==typeof e)return vl(t,e);throw gl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function vl(t,e,n){try{return function(e){if(0<=e.search(Tc))throw new $i(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ic.bind.apply(Ic,r([void 0],e.split("."))))}catch(t){throw new $i(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Nc}catch(e){throw gl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function gl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+i),s&&(u+=" in document "+r),u+=")"),new $i(Qi.INVALID_ARGUMENT,(a+=". ")+t+u)}function ml(t,e){return t.some(function(t){return t.isEqual(e)})}var wl=(Al.prototype.al=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.ul(),0<this.mutations.length)throw new $i(Qi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Bo((r=a).serializer)+"/documents",n={documents:u.map(function(t){return Fo(r.serializer,t)})},[4,r.Vo("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Ci(!!e.found),e.found.name,e.found.updateTime;var n=jo(t,e.found.name),i=xo(e.found.updateTime),r=new Fs({mapValue:{fields:e.found.fields}});return new Qs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Ci(!!e.missing),Ci(!!e.readTime);var n=jo(t,e.missing),i=xo(e.readTime);return new $s(n,i)}(e,n):Vi());o.set(i.key.toString(),i)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Ci(!!e),s.push(e)}),s)]}})})}(this.xo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Qs?n.cl(t):Vi()}),e)]}})})},Al.prototype.set=function(t,e){this.write(e.Hc(t,this.Be(t))),this.hl.add(t)},Al.prototype.update=function(t,e){try{this.write(e.Hc(t,this.ll(t)))}catch(t){this.ol=t}this.hl.add(t)},Al.prototype.delete=function(t){this.write([new xs(t,this.Be(t))]),this.hl.add(t)},Al.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.ul(),this.ol)throw this.ol;return e=this.il,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new rr(er.N(e));i.mutations.push(new qs(n,i.Be(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Bo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return Ho(e.serializer,t)})},[4,e.Po("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.xo,this.mutations)];case 1:return t.sent(),this.rl=!0,[2]}})})},Al.prototype.cl=function(t){var e;if(t instanceof Qs)e=t.version;else{if(!(t instanceof $s))throw Vi();e=Zi.min()}var n=this.il.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $i(Qi.ABORTED,"Document version changed between two reads.")}else this.il.set(t.key.toString(),e)},Al.prototype.Be=function(t){var e=this.il.get(t.toString());return!this.hl.has(t)&&e?gs.updateTime(e):gs.je()},Al.prototype.ll=function(t){var e=this.il.get(t.toString());if(this.hl.has(t)||!e)return gs.exists(!0);if(e.isEqual(Zi.min()))throw new $i(Qi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},Al.prototype.write=function(t){this.ul(),this.mutations=this.mutations.concat(t)},Al.prototype.ul=function(){},Al),bl=(Tl.prototype.run=function(){this.fl()},Tl.prototype.fl=function(){var t=this;this.Os.fs(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new wl(this.xo),(n=this.dl(e))&&n.then(function(t){i.Vs.Cs(function(){return e.commit().then(function(){i.gs.resolve(t)}).catch(function(t){i.wl(t)})})}).catch(function(t){i.wl(t)}),[2]})})})},Tl.prototype.dl=function(t){try{var e=this.updateFunction(t);return!pr(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},Tl.prototype.wl=function(t){var e=this;0<this._l&&this.Tl(t)?(--this._l,this.Vs.Cs(function(){return e.fl(),Promise.resolve()})):this.gs.reject(t)},Tl.prototype.Tl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Rr(e)},Tl),El=(Il.prototype.start=function(t,e,n,i){var r=this;this.El(),this.ic=t;var o=new Ja,s=!1;return this.credentials.kr(function(t){return s?void r.Vs.Gs(function(){return r.ha.yh(t)}):(s=!0,Di("FirestoreClient","Initializing. user=",t.uid),r.Il(e,n,i,t,o).then(r.ml.resolve,r.ml.reject))}),this.Vs.Cs(function(){return r.ml.promise}),o.promise},Il.prototype.enableNetwork=function(){var t=this;return this.El(),this.Vs.enqueue(function(){return t.persistence.Ou(!0),t.ha.enableNetwork()})},Il.prototype.Il=function(r,o,s,a,u){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Vs:this.Vs,ic:this.ic,clientId:this.clientId,credentials:this.credentials,Pc:a,ua:100,pc:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.aa=r.aa,this.ko=r.ko,this.Ic=r.Ic,this.xo=o.xo,this.ha=o.ha,this.lh=o.lh,this.Rl=o.Sc,this.persistence.Lu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.Al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Il(new zh,new Hh,{Vc:!1},a,u))];case 4:return[2]}})})},Il.prototype.Al=function(t){return"FirebaseError"===t.name?t.code===Qi.FAILED_PRECONDITION||t.code===Qi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Il.prototype.El=function(){if(this.Vs.Ms)throw new $i(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},Il.prototype.disableNetwork=function(){var t=this;return this.El(),this.Vs.enqueue(function(){return t.persistence.Ou(!1),t.ha.disableNetwork()})},Il.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ic&&this.Ic.stop(),[4,this.ha.oh()];case 1:return t.sent(),[4,this.aa.oh()];case 2:return t.sent(),[4,this.persistence.oh()];case 3:return t.sent(),this.credentials.xr(),[2]}})})})},Il.prototype.waitForPendingWrites=function(){var t=this;this.El();var e=new Ja;return this.Vs.Cs(function(){return t.lh.Fa(e)}),e.promise},Il.prototype.listen=function(t,e,n){var i=this;this.El();var r=new Xh(n),o=new Qu(t,r,e);return this.Vs.Cs(function(){return i.Rl.listen(o)}),function(){r.Fc(),i.Vs.Cs(function(){return i.Rl.ah(o)})}},Il.prototype.Pl=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),function(n,o,s){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){switch(t.label){case 0:return r=new Ja,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.ir(s)];case 1:return(e=t.sent())instanceof Qs?r.resolve(e):e instanceof $s?r.resolve(null):r.reject(new $i(Qi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=pu(n,"Failed to get document '"+s+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})}(this.Vs,this.ko,e))]}})})},Il.prototype.Vl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),e=this.Vs,n=this.Rl,i=a,r=u,o=new Ja,s=Nl(e,n,oa(i.path),{includeMetadataChanges:!0,Ja:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new $i(Qi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new $i(Qi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Il.prototype.pl=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),function(n,u,h){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return a=new Ja,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u.cr(h,!0)];case 1:return e=t.sent(),n=new Wu(h,e._r),i=n.Kh(e.documents),r=n.Jh(i,!1),a.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=pu(o,"Failed to execute query '"+h+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})}(this.Vs,this.ko,e))]}})})},Il.prototype.yl=function(a,u){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.El(),[4,this.ml.promise];case 1:return[2,(t.sent(),e=this.Vs,n=this.Rl,i=a,r=u,o=new Ja,s=Nl(e,n,i,{includeMetadataChanges:!0,Ja:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new $i(Qi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Il.prototype.write=function(t){var e=this;this.El();var n=new Ja;return this.Vs.Cs(function(){return e.lh.write(t,n)}),n.promise},Il.prototype.s=function(){return this.ic.s},Il.prototype.Qa=function(t){var e=this;this.El();var n=new Xh(t);return this.Vs.Cs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Rl.Qa(n)]})})}),function(){n.Fc(),e.Vs.Cs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.Rl.ja(n)]})})})}},Object.defineProperty(Il.prototype,"gl",{get:function(){return this.Vs.Ms},enumerable:!1,configurable:!0}),Il.prototype.transaction=function(t){var e=this;this.El();var n=new Ja;return this.Vs.Cs(function(){return new bl(e.Vs,e.xo,t,n).run(),Promise.resolve()}),n.promise},Il);function Il(t,e){this.credentials=t,this.Vs=e,this.clientId=Ui.t(),this.ml=new Ja}function Tl(t,e,n,i){this.Vs=t,this.xo=e,this.updateFunction=n,this.gs=i,this._l=5,this.Os=new Za(this.Vs,"transaction_retry")}function Al(t){this.xo=t,this.il=new Map,this.mutations=[],this.rl=!1,this.ol=null,this.hl=new Set}function Nl(t,e,n,i,r){var o=new Xh(r),s=new Qu(n,o,i);return t.Cs(function(){return e.listen(s)}),function(){o.Fc(),t.Cs(function(){return e.ah(s)})}}var _l,Rl,Ol=(Kl.prototype.Sl=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Cl(t.timestampValue);case 4:return this.Dl(t);case 5:return t.stringValue;case 6:return new bc(To(t.bytesValue));case 7:return this.Fl(t.referenceValue);case 8:return this.$l(t.geoPointValue);case 9:return this.Nl(t.arrayValue);case 10:return this.kl(t.mapValue);default:throw Vi()}},Kl.prototype.kl=function(t){var n=this,i={};return zi(t.fields||{},function(t,e){i[t]=n.Sl(e)}),i},Kl.prototype.$l=function(t){return new Gc(Io(t.latitude),Io(t.longitude))},Kl.prototype.Nl=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sl(t)})},Kl.prototype.Dl=function(t){switch(this.vl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.Sl(e);case"estimate":return this.Cl(fo(t));default:return null}},Kl.prototype.Cl=function(t){var e=Eo(t),n=new Ji(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Kl.prototype.Fl=function(t){var e=er.N(t);Ci(Yo(e));var n=new ji(e.get(1),e.get(3)),i=new rr(e.p(5));return n.isEqual(this.s)||ki("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.bl(i)},Kl),Sl=du.oi,Dl=(Hl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Hl),kl=(Object.defineProperty(zl.prototype,"Gl",{get:function(){return this.zl||(this.zl=new rl(this.Gc,this.jl.ignoreUndefinedProperties)),this.zl},enumerable:!1,configurable:!0}),zl.prototype.settings=function(t){Jh("Firestore.settings",arguments,1),ec("Firestore.settings","object",1,t);var e=new Dl(t);if(this.Ul&&!this.jl.isEqual(e))throw new $i(Qi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.jl=e).credentials&&(this.Ql=function(t){if(!t)return new Cu;switch(t.type){case"gapi":var e=t.Kl;return Ci(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new xu(e,t.Br||"0");case"provider":return t.Kl;default:throw new $i(Qi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},zl.prototype.enableNetwork=function(){return this.Ml(),this.Ul.enableNetwork()},zl.prototype.disableNetwork=function(){return this.Ml(),this.Ul.disableNetwork()},zl.prototype.enablePersistence=function(t){var e,n;if(this.Ul)throw new $i(Qi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&ki("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new $i(Qi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hl(this.xl,this.Ll,{Vc:!0,cacheSizeBytes:this.jl.cacheSizeBytes,synchronizeTabs:i,Yl:r})},zl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Ul&&!this.Ul.gl)throw new $i(Qi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ja,[2,(this.ql.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.xl.clearPersistence(this.Gc,this.Wl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},zl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(zl.prototype,"Xl",{get:function(){return this.Ml(),this.Ul.gl},enumerable:!1,configurable:!0}),zl.prototype.waitForPendingWrites=function(){return this.Ml(),this.Ul.waitForPendingWrites()},zl.prototype.onSnapshotsInSync=function(t){if(this.Ml(),Yh(t))return this.Ul.Qa(t);ec("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Ul.Qa(e)},zl.prototype.Ml=function(){return this.Ul||this.Hl(new zh,new Hh,{Vc:!1}),this.Ul},zl.prototype.Jl=function(){return new Fi(this.Gc,this.Wl,this.jl.host,this.jl.ssl,this.jl.forceLongPolling)},zl.prototype.Hl=function(t,e,n){var i=this.Jl();return this.Ul=new El(this.Ql,this.ql),this.Ul.start(i,t,e,n)},zl.Bl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $i(Qi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $i(Qi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ji(n)},Object.defineProperty(zl.prototype,"app",{get:function(){if(!this.Ol)throw new $i(Qi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Ol},enumerable:!1,configurable:!0}),zl.prototype.collection=function(t){return Jh("Firestore.collection",arguments,1),ec("Firestore.collection","non-empty string",1,t),this.Ml(),new tf(er.N(t),this,null)},zl.prototype.doc=function(t){return Jh("Firestore.doc",arguments,1),ec("Firestore.doc","non-empty string",1,t),this.Ml(),Vl.Zl(er.N(t),this,null)},zl.prototype.collectionGroup=function(t){if(Jh("Firestore.collectionGroup",arguments,1),ec("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $i(Qi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ml(),new Jl((e=t,new ia(er.k(),e)),this,null);var e},zl.prototype.runTransaction=function(e){var n=this;return Jh("Firestore.runTransaction",arguments,1),ec("Firestore.runTransaction","function",1,e),this.Ml().transaction(function(t){return e(new Pl(n,t))})},zl.prototype.batch=function(){return this.Ml(),new Ll(this)},Object.defineProperty(zl,"logLevel",{get:function(){switch(Si()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),zl.setLogLevel=function(t){Jh("Firestore.setLogLevel",arguments,1),sc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Oi.setLogLevel(t)},zl.prototype.t_=function(){return this.jl.timestampsInSnapshots},zl),Pl=(Bl.prototype.get=function(t){var n=this;Jh("Transaction.get",arguments,1);var i=uf("Transaction.get",t,this.e_);return this.n_.al([i.zc]).then(function(t){if(!t||1!==t.length)return Vi();var e=t[0];if(e instanceof $s)return new Ul(n.e_,i.zc,null,!1,!1,i.Kc);if(e instanceof Qs)return new Ul(n.e_,i.zc,e,!1,!1,i.Kc);throw Vi()})},Bl.prototype.set=function(t,e,n){tc("Transaction.set",arguments,2,3);var i=uf("Transaction.set",t,this.e_);n=of("Transaction.set",n);var r=hf(i.Kc,e,n),o=al(this.e_.Gl,"Transaction.set",i.zc,r,null!==i.Kc,n);return this.n_.set(i.zc,o),this},Bl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Ic?(Zh("Transaction.update",arguments,3),i=uf("Transaction.update",t,this.e_),hl(this.e_.Gl,"Transaction.update",i.zc,e,n,o)):(Jh("Transaction.update",arguments,2),i=uf("Transaction.update",t,this.e_),ul(this.e_.Gl,"Transaction.update",i.zc,e)),this.n_.update(i.zc,r),this},Bl.prototype.delete=function(t){Jh("Transaction.delete",arguments,1);var e=uf("Transaction.delete",t,this.e_);return this.n_.delete(e.zc),this},Bl),Ll=(Gl.prototype.set=function(t,e,n){tc("WriteBatch.set",arguments,2,3),this.r_();var i=uf("WriteBatch.set",t,this.e_);n=of("WriteBatch.set",n);var r=hf(i.Kc,e,n),o=al(this.e_.Gl,"WriteBatch.set",i.zc,r,null!==i.Kc,n);return this.s_=this.s_.concat(o.Hc(i.zc,gs.je())),this},Gl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.r_(),r="string"==typeof e||e instanceof Ic?(Zh("WriteBatch.update",arguments,3),i=uf("WriteBatch.update",t,this.e_),hl(this.e_.Gl,"WriteBatch.update",i.zc,e,n,o)):(Jh("WriteBatch.update",arguments,2),i=uf("WriteBatch.update",t,this.e_),ul(this.e_.Gl,"WriteBatch.update",i.zc,e)),this.s_=this.s_.concat(r.Hc(i.zc,gs.exists(!0))),this},Gl.prototype.delete=function(t){Jh("WriteBatch.delete",arguments,1),this.r_();var e=uf("WriteBatch.delete",t,this.e_);return this.s_=this.s_.concat(new xs(e.zc,gs.je())),this},Gl.prototype.commit=function(){return this.r_(),this.i_=!0,0<this.s_.length?this.e_.Ml().write(this.s_):Promise.resolve()},Gl.prototype.r_=function(){if(this.i_)throw new $i(Qi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Gl),Vl=(n(jl,Rl=zc),jl.Zl=function(t,e,n){if(t.length%2!=0)throw new $i(Qi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new jl(new rr(t),e,n)},Object.defineProperty(jl.prototype,"id",{get:function(){return this.zc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"parent",{get:function(){return new tf(this.zc.path.g(),this.firestore,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"path",{get:function(){return this.zc.path.$()},enumerable:!1,configurable:!0}),jl.prototype.collection=function(t){if(Jh("DocumentReference.collection",arguments,1),ec("DocumentReference.collection","non-empty string",1,t),!t)throw new $i(Qi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=er.N(t);return new tf(this.zc.path.child(e),this.firestore,null)},jl.prototype.isEqual=function(t){if(!(t instanceof jl))throw fc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.zc.isEqual(t.zc)&&this.Kc===t.Kc},jl.prototype.set=function(t,e){tc("DocumentReference.set",arguments,1,2),e=of("DocumentReference.set",e);var n=hf(this.Kc,t,e),i=al(this.firestore.Gl,"DocumentReference.set",this.zc,n,null!==this.Kc,e);return this.Ul.write(i.Hc(this.zc,gs.je()))},jl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Ic?(Zh("DocumentReference.update",arguments,2),hl(this.firestore.Gl,"DocumentReference.update",this.zc,t,e,i)):(Jh("DocumentReference.update",arguments,1),ul(this.firestore.Gl,"DocumentReference.update",this.zc,t)),this.Ul.write(n.Hc(this.zc,gs.exists(!0)))},jl.prototype.delete=function(){return Jh("DocumentReference.delete",arguments,0),this.Ul.write([new xs(this.zc,gs.je())])},jl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];tc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof r[a]||Yh(r[a])||(lc("DocumentReference.onSnapshot",s=r[a],["includeMetadataChanges"]),rc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};Yh(r[a])?(u=r[a],r[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),r[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),r[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(ec("DocumentReference.onSnapshot","function",a,r[a]),nc("DocumentReference.onSnapshot","function",a+1,r[a+1]),nc("DocumentReference.onSnapshot","function",a+2,r[a+2]));var c={next:function(t){r[a]&&r[a](i.o_(t))},error:r[a+1],complete:r[a+2]};return this.Ul.listen(oa(this.zc.path),h,c)},jl.prototype.get=function(t){var e=this;tc("DocumentReference.get",arguments,0,1),af("DocumentReference.get",t);var n=this.firestore.Ml();return t&&"cache"===t.source?n.Pl(this.zc).then(function(t){return new Ul(e.firestore,e.zc,t,!0,t instanceof Qs&&t.Ge,e.Kc)}):n.Vl(this.zc,t).then(function(t){return e.o_(t)})},jl.prototype.withConverter=function(t){return new jl(this.zc,this.firestore,t)},jl.prototype.o_=function(t){var e=t.docs.get(this.zc);return new Ul(this.firestore,this.zc,e,t.fromCache,t.hasPendingWrites,this.Kc)},jl),Cl=(Fl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Fl),Ul=(ql.prototype.data=function(t){var e=this;if(tc("DocumentSnapshot.data",arguments,0,1),t=sf("DocumentSnapshot.data",t),this.h_){if(this.Kc){var n=new Ml(this.e_,this.zc,this.h_,this.a_,this.u_,null);return this.Kc.fromFirestore(n,t)}return new Ol(this.e_.Gc,this.e_.t_(),t.serverTimestamps||"none",function(t){return new Vl(t,e.e_,null)}).Sl(this.h_.Ze())}},ql.prototype.get=function(t,e){var n=this;if(tc("DocumentSnapshot.get",arguments,1,2),e=sf("DocumentSnapshot.get",e),this.h_){var i=this.h_.data().field(yl("DocumentSnapshot.get",t,this.zc));if(null!==i)return new Ol(this.e_.Gc,this.e_.t_(),e.serverTimestamps||"none",function(t){return new Vl(t,n.e_,n.Kc)}).Sl(i)}},Object.defineProperty(ql.prototype,"id",{get:function(){return this.zc.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"ref",{get:function(){return new Vl(this.zc,this.e_,this.Kc)},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"exists",{get:function(){return null!==this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"metadata",{get:function(){return new Cl(this.u_,this.a_)},enumerable:!1,configurable:!0}),ql.prototype.isEqual=function(t){if(!(t instanceof ql))throw fc("isEqual","DocumentSnapshot",1,t);return this.e_===t.e_&&this.a_===t.a_&&this.zc.isEqual(t.zc)&&(null===this.h_?null===t.h_:this.h_.isEqual(t.h_))&&this.Kc===t.Kc},ql),Ml=(n(xl,_l=Ul),xl.prototype.data=function(t){return _l.prototype.data.call(this,t)},xl);function xl(){return null!==_l&&_l.apply(this,arguments)||this}function ql(t,e,n,i,r,o){this.e_=t,this.zc=e,this.h_=n,this.a_=i,this.u_=r,this.Kc=o}function Fl(t,e){this.hasPendingWrites=t,this.fromCache=e}function jl(t,e,n){var i=this;return(i=Rl.call(this,e.Gc,t,n)||this).zc=t,i.firestore=e,i.Kc=n,i.Ul=i.firestore.Ml(),i}function Gl(t){this.e_=t,this.s_=[],this.i_=!1}function Bl(t,e){this.e_=t,this.n_=e}function zl(t,e,n,i){var r=this;if(void 0===n&&(n=new zh),void 0===i&&(i=new Hh),this.xl=n,this.Ll=i,this.Ol=null,this.ql=new cu,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ml(),[4,this.Ul.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Ol=o,this.Gc=zl.Bl(o),this.Wl=o.name,this.Ql=new Uu(e)}else{var s=t;if(!s.projectId)throw new $i(Qi.INVALID_ARGUMENT,"Must provide projectId");this.Gc=new ji(s.projectId,s.database),this.Wl="[DEFAULT]",this.Ql=new Cu}this.jl=new Dl({})}function Hl(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new $i(Qi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ic("settings","non-empty string","host",t.host),this.host=t.host,rc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(lc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),rc("settings","object","credentials",t.credentials),this.credentials=t.credentials,rc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),rc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?ki("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&ki("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,rc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=du.ai;else{if(t.cacheSizeBytes!==Sl&&t.cacheSizeBytes<du.hi)throw new $i(Qi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+du.hi);this.cacheSizeBytes=t.cacheSizeBytes}rc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Kl(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.vl=n,this.bl=i}function Wl(t,e,n){if("string"==typeof n){if(""===n)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!sa(e)&&-1!==n.indexOf("/"))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(er.N(n));if(!rr.W(i))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return Ao(t,new rr(i))}if(n instanceof zc)return Ao(t,n.zc);throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+hc(n)+".")}function Yl(t,e){if(!Array.isArray(t)||0===t.length)throw new $i(Qi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $i(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new $i(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $i(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Xl(t,e,n){if(!n.isEqual(e))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ql(t){if(t.an()&&0===t.tn.length)throw new $i(Qi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var $l,Jl=(rf.prototype.where=function(t,e,n){Jh("Query.where",arguments,3),cc("Query.where",3,n);var i,r,o=sc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=yl("Query.where",t),a=function(t,e,n,i,r,o,s){var a;if(r.O()){if("array-contains"===o||"array-contains-any"===o)throw new $i(Qi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){Yl(s,o);for(var u=[],h=0,c=s;h<c.length;h++){var l=c[h];u.push(Wl(i,t,l))}a={arrayValue:{values:u}}}else a=Wl(i,t,s)}else"in"!==o&&"array-contains-any"!==o||Yl(s,o),a=cl(n,e,s,"in"===o);var f=ma.create(r,o,a);return function(t,e){var n=["array-contains","array-contains-any"],i=["in","array-contains-any"],r=0<=n.indexOf(e.op),o=0<=i.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&Xl(0,e.field,a)}else if(o||r){var u=null;if(o&&(u=t._n(i)),null===u&&r&&(u=t._n(n)),null!==u)throw u===e.op?new $i(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $i(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}(t,f),f}(this.c_,"Query.where",this.firestore.Gl,this.firestore.Gc,s,o,n);return new rf((i=this.c_,r=i.filters.concat([a]),new ia(i.path,i.collectionGroup,i.tn.slice(),r,i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.Kc)},rf.prototype.orderBy=function(t,e){var n;if(tc("Query.orderBy",arguments,1,2),nc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $i(Qi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=yl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o,s=new qa(e,n);return r=s,null!==(i=t).un()||null!==(o=i.cn())&&Xl(0,o,r.field),s}(this.c_,o,n);return new rf((i=this.c_,r=i.tn.concat([s]),new ia(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.Kc)},rf.prototype.limit=function(t){return Jh("Query.limit",arguments,1),ec("Query.limit","number",1,t),pc("Query.limit",1,t),new rf(ha(this.c_,t,"F"),this.firestore,this.Kc)},rf.prototype.limitToLast=function(t){return Jh("Query.limitToLast",arguments,1),ec("Query.limitToLast","number",1,t),pc("Query.limitToLast",1,t),new rf(ha(this.c_,t,"L"),this.firestore,this.Kc)},rf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Zh("Query.startAt",arguments,1);var i=this.l_("Query.startAt",t,e,!0);return new rf(ca(this.c_,i),this.firestore,this.Kc)},rf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Zh("Query.startAfter",arguments,1);var i=this.l_("Query.startAfter",t,e,!1);return new rf(ca(this.c_,i),this.firestore,this.Kc)},rf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Zh("Query.endBefore",arguments,1);var i=this.l_("Query.endBefore",t,e,!0);return new rf(la(this.c_,i),this.firestore,this.Kc)},rf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Zh("Query.endAt",arguments,1);var i=this.l_("Query.endAt",t,e,!1);return new rf(la(this.c_,i),this.firestore,this.Kc)},rf.prototype.isEqual=function(t){if(!(t instanceof rf))throw fc("isEqual","Query",1,t);return this.firestore===t.firestore&&fa(this.c_,t.c_)&&this.Kc===t.Kc},rf.prototype.withConverter=function(t){return new rf(this.c_,this.firestore,t)},rf.prototype.l_=function(c,t,e,n){if(cc(c,1,t),t instanceof Ul)return Jh(c,r([t],e),1),function(t,e,n,i){if(!n)throw new $i(Qi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=aa(t);o<s.length;o++){var a=s[o];if(a.field.O())r.push(Ao(e,n.key));else{var u=n.field(a.field);if(lo(u))throw new $i(Qi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.$();throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Da(r,i)}(this.c_,this.firestore.Gc,t.h_,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.tn;if(r.length>s.length)throw new $i(Qi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<r.length;u++){var h=r[u];if(s[u].field.O()){if("string"!=typeof h)throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!sa(t)&&-1!==h.indexOf("/"))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(er.N(h));if(!rr.W(c))throw new $i(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new rr(c);a.push(Ao(e,l))}else{var f=cl(n,i,h);a.push(f)}}return new Da(a,o)}(this.c_,this.firestore.Gc,this.firestore.Gl,c,i,n)},rf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];tc("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof r[u]||Yh(r[u])||(lc("Query.onSnapshot",a=r[u],["includeMetadataChanges"]),rc("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),Yh(r[u])?(s=r[u],r[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(ec("Query.onSnapshot","function",u,r[u]),nc("Query.onSnapshot","function",u+1,r[u+1]),nc("Query.onSnapshot","function",u+2,r[u+2]));var h={next:function(t){r[u]&&r[u](new Zl(i.firestore,i.c_,t,i.Kc))},error:r[u+1],complete:r[u+2]};return Ql(this.c_),this.firestore.Ml().listen(this.c_,a,h)},rf.prototype.get=function(t){var e=this;tc("Query.get",arguments,0,1),af("Query.get",t),Ql(this.c_);var n=this.firestore.Ml();return(t&&"cache"===t.source?n.pl(this.c_):n.yl(this.c_,t)).then(function(t){return new Zl(e.firestore,e.c_,t,e.Kc)})},rf),Zl=(Object.defineProperty(nf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"empty",{get:function(){return this.f_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"size",{get:function(){return this.f_.docs.size},enumerable:!1,configurable:!0}),nf.prototype.forEach=function(e,n){var i=this;tc("QuerySnapshot.forEach",arguments,1,2),ec("QuerySnapshot.forEach","function",1,e),this.f_.docs.forEach(function(t){e.call(n,i.T_(t,i.metadata.fromCache,i.f_.qt.has(t.key)))})},Object.defineProperty(nf.prototype,"query",{get:function(){return new Jl(this.__,this.e_,this.Kc)},enumerable:!1,configurable:!0}),nf.prototype.docChanges=function(t){t&&(lc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),rc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.f_.Ut)throw new $i(Qi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.d_&&this.w_===e||(this.d_=function(r,e,o){if(r.Ot._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Ot;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vi()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.f_,e,this.T_.bind(this)),this.w_=e),this.d_},nf.prototype.isEqual=function(t){if(!(t instanceof nf))throw fc("isEqual","QuerySnapshot",1,t);return this.e_===t.e_&&fa(this.__,t.__)&&this.f_.isEqual(t.f_)&&this.Kc===t.Kc},nf.prototype.T_=function(t,e,n){return new Ml(this.e_,t.key,t,e,n,this.Kc)},nf),tf=(n(ef,$l=Jl),Object.defineProperty(ef.prototype,"id",{get:function(){return this.c_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"parent",{get:function(){var t=this.c_.path.g();return t._()?null:new Vl(new rr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"path",{get:function(){return this.c_.path.$()},enumerable:!1,configurable:!0}),ef.prototype.doc=function(t){tc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ui.t()),ec("CollectionReference.doc","non-empty string",1,t);var e=er.N(t);return Vl.Zl(this.c_.path.child(e),this.firestore,this.Kc)},ef.prototype.add=function(t){Jh("CollectionReference.add",arguments,1),ec("CollectionReference.add","object",1,this.Kc?this.Kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},ef.prototype.withConverter=function(t){return new ef(this.m_,this.firestore,t)},ef);function ef(t,e,n){var i=this;if(((i=$l.call(this,oa(t),e,n)||this).m_=t).length%2!=1)throw new $i(Qi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return i}function nf(t,e,n,i){this.e_=t,this.__=e,this.f_=n,this.Kc=i,this.d_=null,this.w_=null,this.metadata=new Cl(n.hasPendingWrites,n.fromCache)}function rf(t,e,n){this.c_=t,this.firestore=e,this.Kc=n}function of(t,e){if(void 0===e)return{merge:!1};if(lc(t,e,["merge","mergeFields"]),rc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+hc(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new $i(Qi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+hc(n[r]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Ic}),void 0!==e.mergeFields&&void 0!==e.merge)throw new $i(Qi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function sf(t,e){return void 0===e?{}:(lc(t,e,["serverTimestamps"]),oc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function af(t,e){nc(t,"object",1,e),e&&(lc(t,e,["source"]),oc(t,0,"source",e.source,["default","server","cache"]))}function uf(t,e,n){if(e instanceof zc){if(e.firestore!==n)throw new $i(Qi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw fc(t,"DocumentReference",1,e)}function hf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var cf,lf={Firestore:kl,GeoPoint:Gc,Timestamp:Ji,Blob:bc,Transaction:Pl,WriteBatch:Ll,DocumentReference:Vl,DocumentSnapshot:Ul,Query:Jl,QueryDocumentSnapshot:Ml,QuerySnapshot:Zl,CollectionReference:tf,FieldPath:Ic,FieldValue:Fc,setLogLevel:kl.setLogLevel,CACHE_SIZE_UNLIMITED:Sl};(cf=ff).INTERNAL.registerComponent(new Ni("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new kl(e,n,new zh,new Hh);var e,n},"PUBLIC").setServiceProps(Object.assign({},lf))),cf.registerVersion("@firebase/firestore","1.16.3-20207421553")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
