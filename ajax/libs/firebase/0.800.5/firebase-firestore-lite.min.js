!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var s="FirebaseError",r=function(t){function e(n,r){var o=t.call(this,r)||this;return o.code=n,o.name=s,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,i.prototype.create),o}return function(t,e){function s(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}(e,t),e}(Error),i=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var s=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?function(t,e){return t.replace(u,function(t,n){var s=e[n];return null!=s?String(s):"<"+n+"?>"})}(o,s):"Error",c=this.serviceName+": "+a+" ("+i+").",l=new r(i,c),h=0,f=Object.keys(s);h<f.length;h++){var d=f[h];"_"!==d.slice(-1)&&(d in l&&console.warn('Overwriting FirebaseError base field "'+d+'" can cause unexpected behavior.'),l[d]=s[d])}return l},t}();var o,a,u=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,r++)s[r]=i[o];return s}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(a||(a={}));var h={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},f=a.INFO,d=((o={})[a.DEBUG]="log",o[a.VERBOSE]="log",o[a.INFO]="info",o[a.WARN]="warn",o[a.ERROR]="error",o),p=function(t,e){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];if(!(e<t.logLevel)){var r=(new Date).toISOString(),i=d[e];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[i].apply(console,l(["["+r+"]  "+t.name+":"],n))}},m=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=p,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?h[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.DEBUG],t)),this._logHandler.apply(this,l([this,a.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.VERBOSE],t)),this._logHandler.apply(this,l([this,a.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.INFO],t)),this._logHandler.apply(this,l([this,a.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.WARN],t)),this._logHandler.apply(this,l([this,a.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,a.ERROR],t)),this._logHandler.apply(this,l([this,a.ERROR],t))},t}();const g="ok",w="cancelled",y="unknown",v="invalid-argument",b="deadline-exceeded",E="not-found",A="already-exists",N="permission-denied",I="unauthenticated",T="resource-exhausted",V="failed-precondition",_="aborted",S="out-of-range",q="unimplemented",O="internal",D="unavailable",L="data-loss";class R extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}const P=new m("@firebase/firestore");function x(t,...e){if(P.logLevel<=a.DEBUG){const n=e.map($);P.debug("Firestore (7.19.1): "+t,...n)}}function F(t,...e){if(P.logLevel<=a.ERROR){const n=e.map($);P.error("Firestore (7.19.1): "+t,...n)}}function $(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function U(t="Unexpected state"){const e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw F(e),new Error(e)}function C(t,e){t||U()}function j(t,e){return t}function k(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class G{static t(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=k(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<e&&(n+=t.charAt(s[r]%t.length))}return n}}function B(t,e){return t<e?-1:t>e?1:0}function M(t,e,n){return t.length===e.length&&t.every((t,s)=>n(t,e[s]))}class W{constructor(t,e,n,s,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=s,this.forceLongPolling=r}}class H{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get i(){return"(default)"===this.database}isEqual(t){return t instanceof H&&t.projectId===this.projectId&&t.database===this.database}o(t){return B(this.projectId,t.projectId)||B(this.database,t.database)}}class z{constructor(t){this.uid=t}u(){return null!=this.uid}h(){return this.u()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}z.UNAUTHENTICATED=new z(null),z.l=new z("google-credentials-uid"),z._=new z("first-party-uid");class Q{constructor(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}}class X{constructor(t){this.p=null,this.currentUser=z.UNAUTHENTICATED,this.I=!1,this.A=0,this.T=null,this.forceRefresh=!1,this.p=(()=>{this.A++,this.currentUser=this.P(),this.I=!0,this.T&&this.T(this.currentUser)}),this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.p):(this.p(null),t.get().then(t=>{this.auth=t,this.p&&this.auth.addAuthTokenListener(this.p)},()=>{}))}getToken(){const t=this.A,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.A!==t?(x("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(C("string"==typeof e.accessToken),new Q(e.accessToken,this.currentUser)):null):Promise.resolve(null)}R(){this.forceRefresh=!0}V(t){this.T=t,this.I&&t(this.currentUser)}g(){this.auth&&this.auth.removeAuthTokenListener(this.p),this.p=null,this.T=null}P(){const t=this.auth&&this.auth.getUid();return C(null===t||"string"==typeof t),new z(t)}}function K(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new R(v,`Type does not match the expected instance. Did you pass '${e.name}' from a different Firestore SDK?`):new R(v,`Expected type '${e.name}', but was '${t.constructor.name}'`);return t}class Y{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new R(v,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new R(v,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new R(v,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new R(v,"Timestamp seconds out of range: "+t)}static now(){return Y.fromMillis(Date.now())}static fromDate(t){return Y.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new Y(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}v(t){return this.seconds===t.seconds?B(this.nanoseconds,t.nanoseconds):B(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class J{constructor(t){this.timestamp=t}static N(t){return new J(t)}static min(){return new J(new Y(0,0))}o(t){return this.timestamp.v(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}$(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}F(){return this.timestamp}}class Z{constructor(t,e,n){void 0===e?e=0:e>t.length&&U(),void 0===n?n=t.length-e:n>t.length-e&&U(),this.segments=t,this.offset=e,this.D=n}get length(){return this.D}isEqual(t){return 0===Z.q(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Z?t.forEach(t=>{e.push(t)}):e.push(t),this.S(e)}limit(){return this.offset+this.length}O(t){return t=void 0===t?1:t,this.S(this.segments,this.offset+t,this.length-t)}C(){return this.S(this.segments,this.offset,this.length-1)}L(){return this.segments[this.offset]}U(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}M(){return 0===this.length}j(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}B(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}k(){return this.segments.slice(this.offset,this.limit())}static q(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const n=t.get(s),r=e.get(s);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class tt extends Z{S(t,e,n){return new tt(t,e,n)}G(){return this.k().join("/")}toString(){return this.G()}static W(t){if(t.indexOf("//")>=0)throw new R(v,`Invalid path (${t}). Paths must not contain // in them.`);const e=t.split("/").filter(t=>t.length>0);return new tt(e)}static Y(){return new tt([])}}const et=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nt extends Z{S(t,e,n){return new nt(t,e,n)}static H(t){return et.test(t)}G(){return this.k().map(t=>(t=t.replace("\\","\\\\").replace("`","\\`"),nt.H(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.G()}K(){return 1===this.length&&"__name__"===this.get(0)}static J(){return new nt(["__name__"])}static Z(t){const e=[];let n="",s=0;const r=()=>{if(0===n.length)throw new R(v,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let i=!1;for(;s<t.length;){const e=t[s];if("\\"===e){if(s+1===t.length)throw new R(v,"Path has trailing escape character: "+t);const e=t[s+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new R(v,"Path has invalid escape sequence: "+t);n+=e,s+=2}else"`"===e?(i=!i,s++):"."!==e||i?(n+=e,s++):(r(),s++)}if(r(),i)throw new R(v,"Unterminated ` in path: "+t);return new nt(e)}static Y(){return new nt([])}}class st{constructor(t){this.path=t}static X(t){return new st(tt.W(t))}static tt(t){return new st(tt.W(t).O(5))}nt(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===tt.q(this.path,t.path)}toString(){return this.path.toString()}static q(t,e){return tt.q(t.path,e.path)}static et(t){return t.length%2==0}static rt(t){return new st(new tt(t.slice()))}}function rt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function it(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class ot{constructor(t){this.st=t}static fromBase64String(t){const e=atob(t);return new ot(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ot(e)}toBase64(){return t=this.st,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.st)}it(){return 2*this.st.length}o(t){return B(this.st,t.st)}isEqual(t){return this.st===t.st}}function at(t){return null==t}function ut(t){return-0===t&&1/t==-1/0}function ct(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lt(t){const e=wt(t.mapValue.fields.__local_write_time__.timestampValue);return new Y(e.seconds,e.nanos)}ot.ot=new ot("");const ht=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ft(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ct(t)?4:10:U()}function dt(t,e){const n=ft(t);if(n!==ft(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return lt(t).isEqual(lt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=wt(t.timestampValue),s=wt(e.timestampValue);return n.seconds===s.seconds&&n.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return vt(t.bytesValue).isEqual(vt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return yt(t.geoPointValue.latitude)===yt(e.geoPointValue.latitude)&&yt(t.geoPointValue.longitude)===yt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yt(t.integerValue)===yt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=yt(t.doubleValue),s=yt(e.doubleValue);return n===s?ut(n)===ut(s):isNaN(n)&&isNaN(s)}return!1}(t,e);case 9:return M(t.arrayValue.values||[],e.arrayValue.values||[],dt);case 10:return function(t,e){const n=t.mapValue.fields||{},s=e.mapValue.fields||{};if(rt(n)!==rt(s))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===s[t]||!dt(n[t],s[t])))return!1;return!0}(t,e);default:return U()}}function pt(t,e){return void 0!==(t.values||[]).find(t=>dt(t,e))}function mt(t,e){const n=ft(t),s=ft(e);if(n!==s)return B(n,s);switch(n){case 0:return 0;case 1:return B(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=yt(t.integerValue||t.doubleValue),s=yt(e.integerValue||e.doubleValue);return n<s?-1:n>s?1:n===s?0:isNaN(n)?isNaN(s)?0:-1:1}(t,e);case 3:return gt(t.timestampValue,e.timestampValue);case 4:return gt(lt(t),lt(e));case 5:return B(t.stringValue,e.stringValue);case 6:return function(t,e){const n=vt(t),s=vt(e);return n.o(s)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),s=e.split("/");for(let t=0;t<n.length&&t<s.length;t++){const e=B(n[t],s[t]);if(0!==e)return e}return B(n.length,s.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=B(yt(t.latitude),yt(e.latitude));return 0!==n?n:B(yt(t.longitude),yt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],s=e.values||[];for(let t=0;t<n.length&&t<s.length;++t){const e=mt(n[t],s[t]);if(e)return e}return B(n.length,s.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},s=Object.keys(n),r=e.fields||{},i=Object.keys(r);s.sort(),i.sort();for(let t=0;t<s.length&&t<i.length;++t){const e=B(s[t],i[t]);if(0!==e)return e;const o=mt(n[s[t]],r[i[t]]);if(0!==o)return o}return B(s.length,i.length)}(t.mapValue,e.mapValue);default:throw U()}}function gt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return B(t,e);const n=wt(t),s=wt(e),r=B(n.seconds,s.seconds);return 0!==r?r:B(n.nanos,s.nanos)}function wt(t){if(C(!!t),"string"==typeof t){let e=0;const n=ht.exec(t);if(C(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vt(t){return"string"==typeof t?ot.fromBase64String(t):ot.fromUint8Array(t)}function bt(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.G()}`}}function Et(t){return!!t&&"arrayValue"in t}function At(t){return!!t&&"nullValue"in t}function Nt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function It(t){return!!t&&"mapValue"in t}class Tt{constructor(t,e=null,n=[],s=[],r=null,i=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=i,this.endAt=o,this.ut=null}}function Vt(t,e=null,n=[],s=[],r=null,i=null,o=null){return new Tt(t,e,n,s,r,i,o)}class _t{constructor(t,e=null,n=[],s=[],r=null,i="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.ct=n,this.filters=s,this.limit=r,this.at=i,this.startAt=o,this.endAt=a,this.ht=null,this.lt=null,this.startAt,this.endAt}}function St(t){return!at(t.limit)&&"L"===t.at}function qt(t){return t.ct.length>0?t.ct[0].field:null}function Ot(t){for(const e of t.filters)if(e.ft())return e.field;return null}function Dt(t){return null!==t.collectionGroup}function Lt(t){const e=K(t,_t);if(null===e.ht){e.ht=[];const t=Ot(e),n=qt(e);if(null!==t&&null===n)t.K()||e.ht.push(new Wt(t)),e.ht.push(new Wt(nt.J(),"asc"));else{let t=!1;for(const n of e.ct)e.ht.push(n),n.field.K()&&(t=!0);if(!t){const t=e.ct.length>0?e.ct[e.ct.length-1].dir:"asc";e.ht.push(new Wt(nt.J(),t))}}}return e.ht}function Rt(t){const e=K(t,_t);if(!e.lt)if("F"===e.at)e.lt=Vt(e.path,e.collectionGroup,Lt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Lt(e)){const e="desc"===n.dir?"asc":"desc";t.push(new Wt(n.field,e))}const n=e.endAt?new Bt(e.endAt.position,!e.endAt.before):null,s=e.startAt?new Bt(e.startAt.position,!e.startAt.before):null;e.lt=Vt(e.path,e.collectionGroup,t,e.filters,e.limit,n,s)}return e.lt}class Pt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){if(t.K())return"in"===e||"not-in"===e?this.dt(t,e,n):new xt(t,e,n);if(At(n)){if("=="!==e&&"!="!==e)throw new R(v,"Invalid query. Null supports only equality comparisons.");return new Pt(t,e,n)}if(Nt(n)){if("=="!==e&&"!="!==e)throw new R(v,"Invalid query. NaN supports only equality comparisons.");return new Pt(t,e,n)}return"array-contains"===e?new Ct(t,n):"in"===e?new jt(t,n):"not-in"===e?new kt(t,n):"array-contains-any"===e?new Gt(t,n):new Pt(t,e,n)}static dt(t,e,n){return"in"===e?new Ft(t,n):new $t(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this._t(mt(e,this.value)):null!==e&&ft(this.value)===ft(e)&&this._t(mt(e,this.value))}_t(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return U()}}ft(){return["<","<=",">",">=","!="].indexOf(this.op)>=0}}class xt extends Pt{constructor(t,e,n){super(t,e,n),this.key=st.tt(n.referenceValue)}matches(t){const e=st.q(t.key,this.key);return this._t(e)}}class Ft extends Pt{constructor(t,e){super(t,"in",e),this.keys=Ut("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class $t extends Pt{constructor(t,e){super(t,"not-in",e),this.keys=Ut("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ut(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>st.tt(t.referenceValue))}class Ct extends Pt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return Et(e)&&pt(e.arrayValue,this.value)}}class jt extends Pt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&pt(this.value.arrayValue,e)}}class kt extends Pt{constructor(t,e){super(t,"not-in",e)}matches(t){const e=t.field(this.field);return null!==e&&!pt(this.value.arrayValue,e)}}class Gt extends Pt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!Et(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>pt(this.value.arrayValue,t))}}class Bt{constructor(t,e){this.position=t,this.before=e}}function Mt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!dt(t.position[n],e.position[n]))return!1;return!0}class Wt{constructor(t,e="asc"){this.field=t,this.dir=e}}function Ht(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var zt,Qt;function Xt(t){if(void 0===t)return F("RPC_ERROR","HTTP error has no status"),y;switch(t){case 200:return g;case 400:return V;case 401:return I;case 403:return N;case 404:return E;case 409:return _;case 416:return S;case 429:return T;case 499:return w;case 500:return y;case 501:return q;case 503:return D;case 504:return b;default:return t>=200&&t<300?g:t>=400&&t<500?V:t>=500&&t<600?O:y}}(Qt=zt||(zt={}))[Qt.OK=0]="OK",Qt[Qt.CANCELLED=1]="CANCELLED",Qt[Qt.UNKNOWN=2]="UNKNOWN",Qt[Qt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qt[Qt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qt[Qt.NOT_FOUND=5]="NOT_FOUND",Qt[Qt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qt[Qt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qt[Qt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qt[Qt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qt[Qt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qt[Qt.ABORTED=10]="ABORTED",Qt[Qt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qt[Qt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qt[Qt.INTERNAL=13]="INTERNAL",Qt[Qt.UNAVAILABLE=14]="UNAVAILABLE",Qt[Qt.DATA_LOSS=15]="DATA_LOSS";const Kt={asc:"ASCENDING",desc:"DESCENDING"},Yt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Jt{constructor(t,e){this.s=t,this.wt=e}}function Zt(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ut(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.wt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ut(e)?"-0":e}}(t,e)}function te(t,e){return t.wt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ee(t){return C(!!t),J.N(function(t){const e=wt(t);return new Y(e.seconds,e.nanos)}(t))}function ne(t,e){return function(t){return new tt(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).G()}function se(t,e){return ne(t.s,e.path)}function re(t,e){const n=function(t){const e=tt.W(t);return C(fe(e)),e}(e);return C(n.get(1)===t.s.projectId),C(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new st((C((s=n).length>4&&"documents"===s.get(4)),s.O(5)));var s}function ie(t,e){return ne(t.s,e)}function oe(t){return new tt(["projects",t.s.projectId,"databases",t.s.database]).G()}function ae(t,e,n){return{name:se(t,e),fields:n.proto.mapValue.fields}}function ue(t,e){let n;if(e instanceof Ae)n={update:ae(t,e.key,e.value)};else if(e instanceof Te)n={delete:se(t,e.key)};else if(e instanceof Ne)n={update:ae(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.G())),{fieldPaths:e}}(e.pt)};else if(e instanceof Ie)n={transform:{document:se(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof pe)return{fieldPath:e.field.G(),setToServerValue:"REQUEST_TIME"};if(n instanceof me)return{fieldPath:e.field.G(),appendMissingElements:{values:n.elements}};if(n instanceof ge)return{fieldPath:e.field.G(),removeAllFromArray:{values:n.elements}};if(n instanceof we)return{fieldPath:e.field.G(),increment:n.yt};throw U()})(0,t))}};else{if(!(e instanceof Ve))return U();n={verify:se(t,e.key)}}return e.It.Et||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return te(t,e.F())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:U()}(t,e.It)),n}function ce(t,e){const n={structuredQuery:{}},s=e.path;null!==e.collectionGroup?(n.parent=ie(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ie(t,s.C()),n.structuredQuery.from=[{collectionId:s.U()}]);const r=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(Nt(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NAN"}};if(At(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Nt(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NOT_NAN"}};if(At(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:he(t.field),op:function(t){return Yt[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:he(t.field),direction:function(t){return Kt[t]}(t.dir)}})(t))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(t,e){return t.wt||at(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=le(e.startAt)),e.endAt&&(n.structuredQuery.endAt=le(e.endAt)),n}function le(t){return{before:t.before,values:t.position}}function he(t){return{fieldPath:t.G()}}function fe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class de{constructor(){this.At=void 0}}class pe extends de{}class me extends de{constructor(t){super(),this.elements=t}}class ge extends de{constructor(t){super(),this.elements=t}}class we extends de{constructor(t,e){super(),this.serializer=t,this.yt=e}}class ye{constructor(t){this.fields=t,t.sort(nt.q)}Tt(t){for(const e of this.fields)if(e.j(t))return!0;return!1}isEqual(t){return M(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class ve{constructor(t,e){this.field=t,this.transform=e}}class be{constructor(t,e){this.updateTime=t,this.exists=e}static Pt(){return new be}static exists(t){return new be(void 0,t)}static updateTime(t){return new be(t)}get Et(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Ee{}class Ae extends Ee{constructor(t,e,n){super(),this.key=t,this.value=e,this.It=n,this.type=0}}class Ne extends Ee{constructor(t,e,n,s){super(),this.key=t,this.data=e,this.pt=n,this.It=s,this.type=1}}class Ie extends Ee{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.It=be.exists(!0)}}class Te extends Ee{constructor(t,e){super(),this.key=t,this.It=e,this.type=3}}class Ve extends Ee{constructor(t,e){super(),this.key=t,this.It=e,this.type=4}}class _e{constructor(t){this.proto=t}static empty(){return new _e({mapValue:{}})}field(t){if(t.M())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!It(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null}}isEqual(t){return dt(this.proto,t.proto)}}class Se{constructor(t=_e.empty()){this.Rt=t,this.Vt=new Map}set(t,e){return this.gt(t,e),this}delete(t){return this.gt(t,null),this}gt(t,e){let n=this.Vt;for(let e=0;e<t.length-1;++e){const s=t.get(e);let r=n.get(s);r instanceof Map?n=r:r&&10===ft(r)?(r=new Map(Object.entries(r.mapValue.fields||{})),n.set(s,r),n=r):(r=new Map,n.set(s,r),n=r)}n.set(t.U(),e)}bt(){const t=this.vt(nt.Y(),this.Vt);return null!=t?new _e(t):this.Rt}vt(t,e){let n=!1;const s=this.Rt.field(t),r=It(s)?Object.assign({},s.mapValue.fields):{};return e.forEach((e,s)=>{if(e instanceof Map){const i=this.vt(t.child(s),e);null!=i&&(r[s]=i,n=!0)}else null!==e?(r[s]=e,n=!0):r.hasOwnProperty(s)&&(delete r[s],n=!0)}),n?{mapValue:{fields:r}}:null}}class qe{constructor(t,e){this.key=t,this.version=e}}class Oe extends qe{constructor(t,e,n,s){super(t,e),this.Nt=n,this.$t=!!s.$t,this.hasCommittedMutations=!!s.hasCommittedMutations}field(t){return this.Nt.field(t)}data(){return this.Nt}Ft(){return this.Nt.proto}isEqual(t){return t instanceof Oe&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.$t===t.$t&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Nt.isEqual(t.Nt)}toString(){return`Document(${this.key}, ${this.version}, ${this.Nt.toString()}, {hasLocalMutations: ${this.$t}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.$t||this.hasCommittedMutations}}class De extends qe{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof De&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Le{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class Re{constructor(t,e,n=1e3,s=1.5,r=6e4){this.Dt=t,this.qt=e,this.xt=n,this.St=s,this.Ot=r,this.Ct=0,this.Lt=null,this.Ut=Date.now(),this.reset()}reset(){this.Ct=0}Mt(){this.Ct=this.Ot}jt(t){this.cancel();const e=Math.floor(this.Ct+this.Bt()),n=Math.max(0,Date.now()-this.Ut),s=Math.max(0,e-n);s>0&&x("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ct} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Lt=this.Dt.kt(this.qt,s,()=>(this.Ut=Date.now(),t())),this.Ct*=this.St,this.Ct<this.xt&&(this.Ct=this.xt),this.Ct>this.Ot&&(this.Ct=this.Ot)}Qt(){null!==this.Lt&&(this.Lt.Gt(),this.Lt=null)}cancel(){null!==this.Lt&&(this.Lt.cancel(),this.Lt=null)}Bt(){return(Math.random()-.5)*this.Ct}}function Pe(){return"undefined"!=typeof document?document:null}class xe{constructor(t,e,n,s,r){this.Wt=t,this.qt=e,this.Yt=n,this.op=s,this.zt=r,this.Ht=new Le,this.then=this.Ht.promise.then.bind(this.Ht.promise),this.Ht.promise.catch(t=>{})}static Kt(t,e,n,s,r){const i=Date.now()+n,o=new xe(t,e,i,s,r);return o.start(n),o}start(t){this.Jt=setTimeout(()=>this.Zt(),t)}Gt(){return this.Zt()}cancel(t){null!==this.Jt&&(this.clearTimeout(),this.Ht.reject(new R(w,"Operation cancelled"+(t?": "+t:""))))}Zt(){this.Wt.Xt(()=>null!==this.Jt?(this.clearTimeout(),this.op().then(t=>this.Ht.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.Jt&&(this.zt(this),clearTimeout(this.Jt),this.Jt=null)}}class Fe{constructor(){this.tn=Promise.resolve(),this.nn=[],this.en=!1,this.rn=[],this.sn=null,this.on=!1,this.un=[],this.cn=new Re(this,"async_queue_retry"),this.an=(()=>{const t=Pe();t&&x("AsyncQueue","Visibility state changed to  ",t.visibilityState),this.cn.Qt()});const t=Pe();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.an)}get hn(){return this.en}Xt(t){this.enqueue(t)}ln(t){this.fn(),this.dn(t)}_n(){if(!this.en){this.en=!0;const t=Pe();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.an)}}enqueue(t){return this.fn(),this.en?new Promise(t=>{}):this.dn(t)}wn(t){this.nn.push(t),this.Xt(()=>this.mn())}async mn(){if(0!==this.nn.length){try{await this.nn[0](),this.nn.shift(),this.cn.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;x("AsyncQueue","Operation failed with retryable error: "+t)}this.nn.length>0&&this.cn.jt(()=>this.mn())}}dn(t){const e=this.tn.then(()=>(this.on=!0,t().catch(t=>{throw this.sn=t,this.on=!1,F("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.on=!1,t))));return this.tn=e,e}kt(t,e,n){this.fn(),this.un.indexOf(t)>-1&&(e=0);const s=xe.Kt(this,t,e,n,t=>this.pn(t));return this.rn.push(s),s}fn(){this.sn&&U()}yn(){}async En(){let t;do{t=this.tn,await t}while(t!==this.tn)}In(t){for(const e of this.rn)if(e.qt===t)return!0;return!1}An(t){return this.En().then(()=>{this.rn.sort((t,e)=>t.Yt-e.Yt);for(const e of this.rn)if(e.Gt(),"all"!==t&&e.qt===t)break;return this.En()})}Tn(t){this.un.push(t)}pn(t){const e=this.rn.indexOf(t);this.rn.splice(e,1)}}class $e extends class{}{constructor(t,e,n){super(),this.credentials=t,this.Pn=e,this.serializer=n,this.Rn=!1}Vn(){if(this.Rn)throw new R(V,"The client has already been terminated.")}gn(t,e,n){return this.Vn(),this.credentials.getToken().then(s=>this.Pn.gn(t,e,n,s)).catch(t=>{throw t.code===I&&this.credentials.R(),t})}bn(t,e,n){return this.Vn(),this.credentials.getToken().then(s=>this.Pn.bn(t,e,n,s)).catch(t=>{throw t.code===I&&this.credentials.R(),t})}terminate(){this.Rn=!1}}async function Ue(t,e){const n=j(t),s=oe(n.serializer)+"/documents",r={writes:e.map(t=>ue(n.serializer,t))};await n.gn("Commit",s,r)}async function Ce(t,e){const n=j(t),s=oe(n.serializer)+"/documents",r={documents:e.map(t=>se(n.serializer,t))},i=await n.bn("BatchGetDocuments",s,r),o=new Map;i.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){C(!!e.found),e.found.name,e.found.updateTime;const n=re(t,e.found.name),s=ee(e.found.updateTime),r=new _e({mapValue:{fields:e.found.fields}});return new Oe(n,s,r,{})}(t,e):"missing"in e?function(t,e){C(!!e.missing),C(!!e.readTime);const n=re(t,e.missing),s=ee(e.readTime);return new De(n,s)}(t,e):U()}(n.serializer,t);o.set(e.key.toString(),e)});const a=[];return e.forEach(t=>{const e=o.get(t.toString());C(!!e),a.push(e)}),a}const je={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class ke extends class{constructor(t){this.vn=t,this.s=t.s;const e=t.ssl?"https":"http";this.Nn=e+"://"+t.host,this.$n="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}gn(t,e,n,s){const r=this.Fn(t,e);x("RestConnection","Sending: ",r,n);const i={};return this.Dn(i,s),this.qn(t,r,i,n).then(t=>(x("RestConnection","Received: ",t),t),e=>{throw function(t,...e){if(P.logLevel<=a.WARN){const t=e.map($);P.warn("Firestore (7.19.1): RestConnection",...t)}}(0,t+" failed with error: ",e,"url: ",r,"request:",n),e})}bn(t,e,n,s){return this.gn(t,e,n,s)}Dn(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(const n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])}Fn(t,e){const n=je[t];return`${this.Nn}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.xn=e}Sn(t,e){throw new Error("Not supported by FetchConnection")}async qn(t,e,n,s){const r=JSON.stringify(s);let i;try{i=await this.xn(e,{method:"POST",headers:n,body:r})}catch(t){throw new R(Xt(t.status),"Request failed with error: "+t.statusText)}if(!i.ok)throw new R(Xt(i.status),"Request failed with error: "+i.statusText);return i.json()}}function Ge(t){return new Jt(t,!0)}const Be=new Map;function Me(t){var e,n;if(t.On)throw new R(V,"The client has already been terminated.");if(!Be.has(t)){x("ComponentProvider","Initializing Datastore");const s=t.Cn(),r=new W(t.Ln,t.Un,null!==(e=s.host)&&void 0!==e?e:"firestore.googleapis.com",null===(n=s.ssl)||void 0===n||n,!1),i=new ke(r,fetch.bind(null)),o=Ge(r.s),a=function(t,e,n){return new $e(t,i,o)}(t.Mn);Be.set(t,a)}return Be.get(t)}class We{constructor(t,e){this.app=t,this.Un="(lite)",this.jn=!1,this.INTERNAL={delete:()=>this._delete()},this.Ln=We.Bn(t),this.Mn=new X(e)}get kn(){return this.jn}get On(){return void 0!==this.Qn}Gn(t){if(this.jn)throw new R(V,"Firestore has already been started and its settings can no longer be changed. initializeFirestore() cannot be called after calling getFirestore().");this.Wn=t}Cn(){return this.Wn||(this.Wn={}),this.jn=!0,this.Wn}static Bn(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new R(v,'"projectId" not provided in firebase.initializeApp.');return new H(t.options.projectId)}_delete(){return this.Qn||(this.Qn=this.Yn()),this.Qn}Yn(){return function(t){const e=Be.get(t);e&&(x("ComponentProvider","Removing Datastore"),Be.delete(t),e.terminate())}(this),Promise.resolve()}}function He(t,e,n){if(e.length!==n)throw new R(v,`Function ${t}() requires `+en(n,"argument")+", but was called with "+en(e.length,"argument")+".")}function ze(t,e,n){if(e.length<n)throw new R(v,`Function ${t}() requires at least `+en(n,"argument")+", but was called with "+en(e.length,"argument")+".")}function Qe(t,e,n,s){!function(t,e,n,s){let r=!1;if(!(r="object"===e?Ye(s):"non-empty string"===e?"string"==typeof s&&""!==s:typeof s===e)){const r=Je(s);throw new R(v,`Function ${t}() requires its ${n} to be of type ${e}, but it was: ${r}`)}}(t,e,tn(n)+" argument",s)}function Xe(t){if(!st.et(t))throw new R(v,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ke(t){if(st.et(t))throw new R(v,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ye(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Je(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":U()}function Ze(t,e,n){if(n<=0)throw new R(v,`Function ${t}() requires its ${tn(e)} argument to be a positive number, but it was: ${n}.`)}function tn(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function en(t,e){return`${t} ${e}`+(1===t?"":"s")}class nn{constructor(t){!function(t,e,n,s){if(!(e instanceof Array)||e.length<1)throw new R(v,"Function FieldPath() requires its fieldNames argument to be an array with at least "+en(1,"element")+".")}(0,t);for(let e=0;e<t.length;++e)if(Qe("FieldPath","string",e,t[e]),0===t[e].length)throw new R(v,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.zn=new nt(t)}}class sn extends nn{constructor(...t){super(t)}static documentId(){return new sn(nt.J().G())}isEqual(t){if(!(t instanceof sn))throw function(t,e,n,s){const r=Je(s);return new R(v,`Function isEqual() requires its ${tn(1)} argument to be a FieldPath, but it was: ${r}`)}(0,0,0,t);return this.zn.isEqual(t.zn)}}const rn=new RegExp("[~\\*/\\[\\]]");class on{constructor(){this.Hn=this}}class an extends on{constructor(t){super(),this.Kn=t}Jn(t){if(2!==t.Zn)throw 1===t.Zn?t.Xn(this.Kn+"() can only appear at the top level of your update data"):t.Xn(this.Kn+"() cannot be used with set() unless you pass {merge:true}");return t.pt.push(t.path),null}isEqual(t){return t instanceof an}}function un(t,e,n){return new bn({Zn:3,te:e.settings.te,methodName:t.Kn,ne:n},e.s,e.serializer,e.ignoreUndefinedProperties)}class cn extends on{constructor(t){super(),this.Kn=t}Jn(t){return new ve(t.path,new pe)}isEqual(t){return t instanceof cn}}class ln extends on{constructor(t,e){super(),this.Kn=t,this.ee=e}Jn(t){const e=un(this,t,!0),n=this.ee.map(t=>Vn(t,e)),s=new me(n);return new ve(t.path,s)}isEqual(t){return this===t}}class hn extends on{constructor(t,e){super(),this.Kn=t,this.ee=e}Jn(t){const e=un(this,t,!0),n=this.ee.map(t=>Vn(t,e)),s=new ge(n);return new ve(t.path,s)}isEqual(t){return this===t}}class fn extends on{constructor(t,e){super(),this.Kn=t,this.re=e}Jn(t){const e=new we(t.serializer,Zt(t.serializer,this.re));return new ve(t.path,e)}isEqual(t){return this===t}}class dn{constructor(t,e){if(He("GeoPoint",arguments,2),Qe("GeoPoint","number",1,t),Qe("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new R(v,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new R(v,"Longitude must be a number between -180 and 180, but was: "+e);this.se=t,this.ie=e}get latitude(){return this.se}get longitude(){return this.ie}isEqual(t){return this.se===t.se&&this.ie===t.ie}toJSON(){return{latitude:this.se,longitude:this.ie}}v(t){return B(this.se,t.se)||B(this.ie,t.ie)}}class pn{constructor(t){this.oe=t}static fromBase64String(t){try{return new pn(ot.fromBase64String(t))}catch(t){throw new R(v,"Failed to construct Bytes from Base64 string: "+t)}}static fromUint8Array(t){return new pn(ot.fromUint8Array(t))}toBase64(){return this.oe.toBase64()}toUint8Array(){return this.oe.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.oe.isEqual(t.oe)}}const mn=/^__.*__$/;class gn{constructor(t,e,n){this.Ln=t,this.ue=e,this.ce=n}}class wn{constructor(t,e,n){this.data=t,this.pt=e,this.fieldTransforms=n}ae(t,e){const n=[];return null!==this.pt?n.push(new Ne(t,this.data,this.pt,e)):n.push(new Ae(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Ie(t,this.fieldTransforms)),n}}class yn{constructor(t,e,n){this.data=t,this.pt=e,this.fieldTransforms=n}ae(t,e){const n=[new Ne(t,this.data,this.pt,e)];return this.fieldTransforms.length>0&&n.push(new Ie(t,this.fieldTransforms)),n}}function vn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}class bn{constructor(t,e,n,s,r,i){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=s,void 0===r&&this.he(),this.fieldTransforms=r||[],this.pt=i||[]}get path(){return this.settings.path}get Zn(){return this.settings.Zn}le(t){return new bn(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.pt)}fe(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.le({path:n,ne:!1});return s.de(t),s}_e(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.le({path:n,ne:!1});return s.he(),s}we(t){return this.le({path:void 0,ne:!0})}Xn(t){return Ln(t,this.settings.methodName,this.settings.me||!1,this.path,this.settings.te)}contains(t){return void 0!==this.pt.find(e=>t.j(e))||void 0!==this.fieldTransforms.find(e=>t.j(e.field))}he(){if(this.path)for(let t=0;t<this.path.length;t++)this.de(this.path.get(t))}de(t){if(0===t.length)throw this.Xn("Document fields must not be empty");if(vn(this.Zn)&&mn.test(t))throw this.Xn('Document fields cannot begin and end with "__"')}}class En{constructor(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ge(t)}pe(t,e,n,s=!1){return new bn({Zn:t,methodName:e,te:n,path:nt.Y(),ne:!1,me:s},this.s,this.serializer,this.ignoreUndefinedProperties)}}function An(t,e,n,s,r,i={}){const o=t.pe(i.merge||i.mergeFields?2:0,e,n,r);qn("Data must be an object, but it was:",o,s);const a=_n(s,o);let u,c;if(i.merge)u=new ye(o.pt),c=o.fieldTransforms;else if(i.mergeFields){const t=[];for(const s of i.mergeFields){let r;if(s instanceof nn)r=s.zn;else{if("string"!=typeof s)throw U();r=Dn(e,s,n)}if(!o.contains(r))throw new R(v,`Field '${r}' is specified in your field mask but missing from your input data.`);Rn(t,r)||t.push(r)}u=new ye(t),c=o.fieldTransforms.filter(t=>u.Tt(t.field))}else u=null,c=o.fieldTransforms;return new wn(new _e(a),u,c)}function Nn(t,e,n,s){const r=t.pe(1,e,n);qn("Data must be an object, but it was:",r,s);const i=[],o=new Se;it(s,(t,s)=>{const a=Dn(e,t,n),u=r._e(a);if(s instanceof on&&s.Hn instanceof an)i.push(a);else{const t=Vn(s,u);null!=t&&(i.push(a),o.set(a,t))}});const a=new ye(i);return new yn(o.bt(),a,r.fieldTransforms)}function In(t,e,n,s,r,i){const o=t.pe(1,e,n),a=[On(e,s,n)],u=[r];if(i.length%2!=0)throw new R(v,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<i.length;t+=2)a.push(On(e,i[t])),u.push(i[t+1]);const c=[],l=new Se;for(let t=a.length-1;t>=0;--t)if(!Rn(c,a[t])){const e=a[t],n=u[t],s=o._e(e);if(n instanceof on&&n.Hn instanceof an)c.push(e);else{const t=Vn(n,s);null!=t&&(c.push(e),l.set(e,t))}}const h=new ye(c);return new yn(l.bt(),h,o.fieldTransforms)}function Tn(t,e,n,s=!1){return Vn(n,t.pe(s?4:3,e))}function Vn(t,e){if(Sn(t))return qn("Unsupported field value:",e,t),_n(t,e);if(t instanceof on)return function(t,e){if(!vn(e.Zn))throw e.Xn(t.Kn+"() can only be used with update() and set()");if(!e.path)throw e.Xn(t.Kn+"() is not currently supported inside arrays");const n=t.Jn(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.pt.push(e.path),t instanceof Array){if(e.settings.ne&&4!==e.Zn)throw e.Xn("Nested arrays are not supported");return function(t,e){const n=[];let s=0;for(const r of t){let t=Vn(r,e.we(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Y.fromDate(t);return{timestampValue:te(e.serializer,n)}}if(t instanceof Y){const n=new Y(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:te(e.serializer,n)}}if(t instanceof dn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof pn)return{bytesValue:function(t,e){return t.wt?e.toBase64():e.toUint8Array()}(e.serializer,t.oe)};if(t instanceof gn){const n=e.s,s=t.Ln;if(!s.isEqual(n))throw e.Xn(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ne(t.Ln||e.s,t.ue.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Xn("Unsupported field value: "+Je(t))}(t,e)}function _n(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.pt.push(e.path):it(t,(t,s)=>{const r=Vn(s,e.fe(t));null!=r&&(n[t]=r)}),{mapValue:{fields:n}}}function Sn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Y||t instanceof dn||t instanceof pn||t instanceof gn||t instanceof on)}function qn(t,e,n){if(!Sn(n)||!Ye(n)){const s=Je(n);throw"an object"===s?e.Xn(t+" a custom object"):e.Xn(t+" "+s)}}function On(t,e,n){if(e instanceof nn)return e.zn;if("string"==typeof e)return Dn(t,e);throw Ln("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Dn(t,e,n){try{return function(t){if(t.search(rn)>=0)throw new R(v,`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`);try{return new sn(...t.split("."))}catch(e){throw new R(v,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`)}}(e).zn}catch(e){throw Ln((s=e)instanceof Error?s.message:s.toString(),t,!1,void 0,n)}var s}function Ln(t,e,n,s,r){const i=s&&!s.M(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)");let u="";return(i||o)&&(u+=" (found",i&&(u+=" in field "+s),o&&(u+=" in document "+r),u+=")"),new R(v,(a+=". ")+t+u)}function Rn(t,e){return t.some(t=>t.isEqual(e))}class Pn extends nn{constructor(...t){super(t)}isEqual(t){const e=K(t,Pn);return this.zn.isEqual(e.zn)}}class xn{constructor(t,e,n,s,r){this.s=t,this.timestampsInSnapshots=e,this.ye=n,this.Ee=s,this.Ie=r}Ae(t){switch(ft(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yt(t.integerValue||t.doubleValue);case 3:return this.Te(t.timestampValue);case 4:return this.Pe(t);case 5:return t.stringValue;case 6:return this.Ie(vt(t.bytesValue));case 7:return this.Re(t.referenceValue);case 8:return this.Ve(t.geoPointValue);case 9:return this.ge(t.arrayValue);case 10:return this.be(t.mapValue);default:throw U()}}be(t){const e={};return it(t.fields||{},(t,n)=>{e[t]=this.Ae(n)}),e}Ve(t){return new dn(yt(t.latitude),yt(t.longitude))}ge(t){return(t.values||[]).map(t=>this.Ae(t))}Pe(t){switch(this.ye){case"previous":const e=function t(e){const n=e.mapValue.fields.__previous_value__;return ct(n)?t(n):n}(t);return null==e?null:this.Ae(e);case"estimate":return this.Te(lt(t));default:return null}}Te(t){const e=wt(t),n=new Y(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()}Re(t){const e=tt.W(t);C(fe(e));const n=new H(e.get(1),e.get(3)),s=new st(e.O(5));return n.isEqual(this.s)||F(`Document ${s} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${this.s.projectId}/${this.s.database}) instead.`),this.Ee(s)}}class Fn{constructor(t,e,n,s){this.ve=t,this.ue=e,this.Ne=n,this.ce=s}get id(){return this.ue.path.U()}get ref(){return new Hn(this.ve,this.ce,this.ue.path)}exists(){return null!==this.Ne}data(){if(this.Ne){if(this.ce){const t=new $n(this.ve,this.ue,this.Ne,null);return this.ce.fromFirestore(t)}return new xn(this.ve.Ln,!0,"none",t=>new Hn(this.ve,null,t.path),t=>new pn(t)).Ae(this.Ne.Ft())}}get(t){if(this.Ne){const e=this.Ne.data().field(Cn("DocumentSnapshot.get",t));if(null!==e)return new xn(this.ve.Ln,!0,"none",t=>new Hn(this.ve,this.ce,t.path),t=>new pn(t)).Ae(e)}}}class $n extends Fn{data(){return super.data()}}class Un{constructor(t,e){this.query=t,this.$e=e}get docs(){return[...this.$e]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.$e.forEach(t,e)}}function Cn(t,e){return"string"==typeof e?Dn(t,e):K(e,Pn).zn}class jn{constructor(t){this.Fe=t,this.De=new Map,this.mutations=[],this.qe=!1,this.xe=null,this.Se=new Set}async Oe(t){if(this.Ce(),this.mutations.length>0)throw new R(v,"Firestore transactions require all reads to be executed before all writes.");const e=await Ce(this.Fe,t);return e.forEach(t=>{t instanceof De||t instanceof Oe?this.Le(t):U()}),e}set(t,e){this.write(e.ae(t,this.It(t))),this.Se.add(t.toString())}update(t,e){try{this.write(e.ae(t,this.Ue(t)))}catch(t){this.xe=t}this.Se.add(t.toString())}delete(t){this.write([new Te(t,this.It(t))]),this.Se.add(t.toString())}async commit(){if(this.Ce(),this.xe)throw this.xe;const t=this.De;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=st.X(e);this.mutations.push(new Ve(n,this.It(n)))}),await Ue(this.Fe,this.mutations),this.qe=!0}Le(t){let e;if(t instanceof Oe)e=t.version;else{if(!(t instanceof De))throw U();e=J.min()}const n=this.De.get(t.key.toString());if(n){if(!e.isEqual(n))throw new R(_,"Document version changed between two reads.")}else this.De.set(t.key.toString(),e)}It(t){const e=this.De.get(t.toString());return!this.Se.has(t.toString())&&e?be.updateTime(e):be.Pt()}Ue(t){const e=this.De.get(t.toString());if(!this.Se.has(t.toString())&&e){if(e.isEqual(J.min()))throw new R(v,"Can't update a document that doesn't exist.");return be.updateTime(e)}return be.exists(!0)}write(t){this.Ce(),this.mutations=this.mutations.concat(t)}Ce(){}}class kn{constructor(t,e,n,s){this.Wt=t,this.Fe=e,this.updateFunction=n,this.Ht=s,this.Me=5,this.cn=new Re(this.Wt,"transaction_retry")}run(){this.je()}je(){this.cn.jt(async()=>{const t=new jn(this.Fe),e=this.Be(t);e&&e.then(e=>{this.Wt.Xt(()=>t.commit().then(()=>{this.Ht.resolve(e)}).catch(t=>{this.ke(t)}))}).catch(t=>{this.ke(t)})})}Be(t){try{const e=this.updateFunction(t);return!at(e)&&e.catch&&e.then?e:(this.Ht.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ht.reject(t),null}}ke(t){this.Me>0&&this.Qe(t)?(this.Me-=1,this.Wt.Xt(()=>(this.je(),Promise.resolve()))):this.Ht.reject(t)}Qe(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case g:return U();case w:case y:case b:case T:case O:case D:case I:return!1;case v:case E:case A:case N:case V:case _:case S:case q:case L:return!0;default:return U()}}()}return!1}}function Gn(t,e,n){if("string"==typeof n){if(""===n)throw new R(v,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dt(e)&&-1!==n.indexOf("/"))throw new R(v,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(tt.W(n));if(!st.et(s))throw new R(v,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return bt(t,new st(s))}if(n instanceof gn)return bt(t,n.ue);throw new R(v,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Je(n)+".")}function Bn(t,e){if(!Array.isArray(t)||0===t.length)throw new R(v,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new R(v,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`);if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new R(v,`Invalid Query. '${e.toString()}' filters cannot contain 'null' in the value array.`);if(t.filter(t=>Number.isNaN(t)).length>0)throw new R(v,`Invalid Query. '${e.toString()}' filters cannot contain 'NaN' in the value array.`)}}function Mn(t,e,n){if(!n.isEqual(e))throw new R(v,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function Wn(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Hn extends gn{constructor(t,e,n){super(t.Ln,new st(n),e),this.firestore=t,this.converter=e,this.Ge=n,this.type="document"}get id(){return this.Ge.U()}get path(){return this.Ge.G()}get parent(){return new es(this.firestore,this.ce,this.ue.path.C())}collection(t){is("DocumentReference.collection","path",t);const e=tt.W(this.path).child(tt.W(t));return Ke(e),new es(this.firestore,null,e)}withConverter(t){return new Hn(this.firestore,t,this.Ge)}}class zn{constructor(t,e,n){this.firestore=t,this.converter=e,this.We=n,this.type="query"}withConverter(t){return new zn(this.firestore,t,this.We)}}class Qn{}class Xn extends Qn{constructor(t,e,n){super(),this.Ye=t,this.ze=e,this.He=n,this.type="where"}apply(t){const e=rs(t.firestore),n=function(t,e,n,s,r,i,o){let a;if(r.K()){if("array-contains"===i||"array-contains-any"===i)throw new R(v,`Invalid Query. You can't perform '${i}' queries on FieldPath.documentId().`);if("in"===i||"not-in"===i){Bn(o,i);const e=[];for(const n of o)e.push(Gn(s,t,n));a={arrayValue:{values:e}}}else a=Gn(s,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Bn(o,i),a=Tn(n,e,o,"in"===i||"not-in"===i);const u=Pt.create(r,i,a);return function(t,e){if(e.ft()){const n=Ot(t);if(null!==n&&!n.isEqual(e.field))throw new R(v,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const s=qt(t);null!==s&&Mn(0,e.field,s)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new R(v,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new R(v,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,u),u}(t.We,"where",e,t.firestore.Ln,this.Ye,this.ze,this.He);return new zn(t.firestore,t.converter,function(t,e){const n=t.filters.concat([e]);return new _t(t.path,t.collectionGroup,t.ct.slice(),n,t.limit,t.at,t.startAt,t.endAt)}(t.We,n))}}class Kn extends Qn{constructor(t,e){super(),this.Ye=t,this.Ke=e,this.type="orderBy"}apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new R(v,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new R(v,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new Wt(e,n);return function(t,e){if(null===qt(t)){const n=Ot(t);null!==n&&Mn(0,n,e.field)}}(t,s),s}(t.We,this.Ye,this.Ke);return new zn(t.firestore,t.converter,function(t,e){const n=t.ct.concat([e]);return new _t(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.at,t.startAt,t.endAt)}(t.We,e))}}class Yn extends Qn{constructor(t,e,n){super(),this.type=t,this.Je=e,this.Ze=n}apply(t){return new zn(t.firestore,t.converter,function(t,e,n){return new _t(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.We,this.Je,this.Ze))}}class Jn extends Qn{constructor(t,e,n){super(),this.type=t,this.Xe=e,this.tr=n}apply(t){const e=ts(t,this.type,this.Xe,this.tr);return new zn(t.firestore,t.converter,function(t,e){return new _t(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.at,e,t.endAt)}(t.We,e))}}class Zn extends Qn{constructor(t,e,n){super(),this.type=t,this.Xe=e,this.tr=n}apply(t){const e=ts(t,this.type,this.Xe,this.tr);return new zn(t.firestore,t.converter,function(t,e){return new _t(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.at,t.startAt,e)}(t.We,e))}}function ts(t,e,n,s){if(n[0]instanceof Fn)return He(e,n,1),function(t,e,n,s,r){if(!s)throw new R(E,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const i=[];for(const n of Lt(t))if(n.field.K())i.push(bt(e,s.key));else{const t=s.field(n.field);if(ct(t))throw new R(v,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.G();throw new R(v,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}i.push(t)}return new Bt(i,r)}(t.We,t.firestore.Ln,e,n[0].Ne,s);{const r=rs(t.firestore);return function(t,e,n,s,r,i){const o=t.ct;if(r.length>o.length)throw new R(v,`Too many arguments provided to ${s}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let i=0;i<r.length;i++){const u=r[i];if(o[i].field.K()){if("string"!=typeof u)throw new R(v,`Invalid query. Expected a string for document ID in ${s}(), but got a ${typeof u}`);if(!Dt(t)&&-1!==u.indexOf("/"))throw new R(v,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${s}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(tt.W(u));if(!st.et(n))throw new R(v,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${s}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new st(n);a.push(bt(e,r))}else{const t=Tn(n,s,u);a.push(t)}}return new Bt(a,i)}(t.We,t.firestore.Ln,r,e,n,s)}}class es extends zn{constructor(t,e,n){super(t,e,new _t(n)),this.firestore=t,this.Ge=n,this.type="collection"}get id(){return this.We.path.U()}get path(){return this.We.path.G()}get parent(){const t=this.Ge.C();return t.M()?null:new Hn(this.firestore,null,t)}doc(t){0===arguments.length&&(t=G.t()),is("CollectionReference.doc","path",t);const e=this.Ge.child(tt.W(t));return Xe(e),new Hn(this.firestore,this.converter,e)}withConverter(t){return new es(this.firestore,t,this.Ge)}}function ns(t,e){if(1===arguments.length&&(e=G.t()),is("doc","path",e),t instanceof We){const n=tt.W(e);return Xe(n),new Hn(t,null,n)}{if(!(t instanceof Hn||t instanceof es))throw new R(v,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t.Ge.child(tt.W(e));return Xe(n),new Hn(t.firestore,t instanceof es?t.converter:null,n)}}function ss(t,e){return t instanceof zn&&e instanceof zn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ht(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!dt(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mt(t.startAt,e.startAt)&&Mt(t.endAt,e.endAt)}(Rt(t),Rt(e))&&t.at===e.at}(t.We,e.We)&&t.converter===e.converter}function rs(t){const e=t.Cn(),n=Ge(t.Ln);return new En(t.Ln,!!e.ignoreUndefinedProperties,n)}function is(t,e,n){if(!n)throw new R(v,`Function ${t}() cannot be called with an empty ${e}.`)}class os extends on{}class as extends os{constructor(t){super(),this.Hn=t,this.Kn=t.Kn}Jn(t){return this.Hn.Jn(t)}isEqual(t){return t instanceof as&&this.Hn.isEqual(t.Hn)}}class us{constructor(t,e){this.ve=t,this.nr=e,this.er=[],this.rr=!1,this.sr=rs(t)}set(t,e,n){this.ir();const s=cs(t,this.ve),r=Wn(s.ce,e,n),i=An(this.sr,"WriteBatch.set",s.ue,r,null!==s.ce,n);return this.er=this.er.concat(i.ae(s.ue,be.Pt())),this}update(t,e,n,...s){this.ir();const r=cs(t,this.ve);let i;return i="string"==typeof e||e instanceof Pn?In(this.sr,"WriteBatch.update",r.ue,e,n,s):Nn(this.sr,"WriteBatch.update",r.ue,e),this.er=this.er.concat(i.ae(r.ue,be.exists(!0))),this}delete(t){this.ir();const e=cs(t,this.ve);return this.er=this.er.concat(new Te(e.ue,be.Pt())),this}commit(){return this.ir(),this.rr=!0,this.er.length>0?this.nr(this.er):Promise.resolve()}ir(){if(this.rr)throw new R(V,"A write batch can no longer be used after commit() has been called.")}}function cs(t,e){if(t.firestore!==e)throw new R(v,"Provided document reference is from a different Firestore instance.");return K(t,Hn)}class ls{constructor(t,e){this.ve=t,this.or=e,this.sr=rs(t)}get(t){const e=cs(t,this.ve);return this.or.Oe([e.ue]).then(t=>{if(!t||1!==t.length)return U();const n=t[0];if(n instanceof De)return new Fn(this.ve,e.ue,null,e.ce);if(n instanceof Oe)return new Fn(this.ve,n.key,n,e.ce);throw U()})}set(t,e,n){const s=cs(t,this.ve),r=Wn(s.ce,e,n),i=An(this.sr,"Transaction.set",s.ue,r,null!==s.ce,n);return this.or.set(s.ue,i),this}update(t,e,n,...s){const r=cs(t,this.ve);let i;return i="string"==typeof e||e instanceof Pn?In(this.sr,"Transaction.update",r.ue,e,n,s):Nn(this.sr,"Transaction.update",r.ue,e),this.or.update(r.ue,i),this}delete(t){const e=cs(t,this.ve);return this.or.delete(e.ue),this}}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new We(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.800","node"),t.Bytes=pn,t.CollectionReference=es,t.DocumentReference=Hn,t.DocumentSnapshot=Fn,t.FieldPath=Pn,t.FieldValue=os,t.FirebaseFirestore=We,t.GeoPoint=dn,t.Query=zn,t.QueryConstraint=Qn,t.QueryDocumentSnapshot=$n,t.QuerySnapshot=Un,t.Timestamp=Y,t.Transaction=ls,t.WriteBatch=us,t.addDoc=function(t,e){const n=K(t,es),s=ns(n),r=Wn(n.converter,e),i=An(rs(n.firestore),"addDoc",s.ue,r,null!==s.ce,{});return Ue(Me(n.firestore),i.ae(s.ue,be.exists(!1))).then(()=>s)},t.arrayRemove=function(...t){return ze("arrayRemove()",arguments,1),new as(new hn("arrayRemove",t))},t.arrayUnion=function(...t){return ze("arrayUnion()",arguments,1),new as(new ln("arrayUnion",t))},t.collection=function(t,e){if(is("collection","path",e),t instanceof We){const n=tt.W(e);return Ke(n),new es(t,null,n)}{if(!(t instanceof Hn||t instanceof es))throw new R(v,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=tt.W(t.path).child(tt.W(e));return Ke(n),new es(t.firestore,null,n)}},t.collectionGroup=function(t,e){const n=K(t,We);if(is("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new R(v,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new zn(n,null,function(t){return new _t(tt.Y(),t)}(e))},t.deleteDoc=function(t){const e=K(t,Hn);return Ue(Me(e.firestore),[new Te(e.ue,be.Pt())])},t.deleteField=function(){return new as(new an("deleteField"))},t.doc=ns,t.documentId=function(){return new Pn("__name__")},t.endAt=function(...t){return new Zn("endAt",t,!1)},t.endBefore=function(...t){return new Zn("endBefore",t,!0)},t.getDoc=function(t){const e=K(t,Hn);return Ce(Me(e.firestore),[e.ue]).then(t=>{C(1===t.length);const n=t[0];return new Fn(e.firestore,e.ue,n instanceof Oe?n:null,e.ce)})},t.getDocs=function(t){const e=K(t,zn);return function(t){if(St(t)&&0===t.ct.length)throw new R(q,"limitToLast() queries require specifying at least one orderBy() clause")}(e.We),async function(t,e){const n=j(t),s=ce(n.serializer,Rt(e));return(await n.bn("RunQuery",s.parent,{structuredQuery:s.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const s=re(t,e.name),r=ee(e.updateTime),i=new _e({mapValue:{fields:e.fields}});return new Oe(s,r,i,{hasCommittedMutations:!1})})(n.serializer,t.document))}(Me(e.firestore),e.We).then(n=>{const s=n.map(t=>new $n(e.firestore,t.key,t,e.converter));return St(e.We)&&s.reverse(),new Un(t,s)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new as(new fn("increment",t))},t.initializeFirestore=function(t,n){const s=e._getProvider(t,"firestore/lite").getImmediate();return s.Gn(n),s},t.limit=function(t){return Ze("limit",1,t),new Yn("limit",t,"F")},t.limitToLast=function(t){return Ze("limitToLast",1,t),new Yn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,s=Cn("orderBy",t);return new Kn(s,n)},t.query=function(t,...e){let n=K(t,zn);for(const t of e)n=t.apply(n);return n},t.queryEqual=ss,t.refEqual=function(t,e){return(t instanceof Hn||t instanceof es)&&(e instanceof Hn||e instanceof es)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter},t.runTransaction=function(t,e){const n=K(t,We),s=Me(n),r=new Le;return new kn(new Fe,s,t=>e(new ls(n,t)),r).run(),r.promise},t.serverTimestamp=function(){return new as(new cn("serverTimestamp"))},t.setDoc=function(t,e,n){const s=K(t,Hn),r=Wn(s.ce,e,n),i=An(rs(s.firestore),"setDoc",s.ue,r,null!==s.ce,n);return Ue(Me(s.firestore),i.ae(s.ue,be.Pt()))},t.setLogLevel=function(t){P.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof Fn&&n instanceof Fn?e.ve===n.ve&&e.ue.isEqual(n.ue)&&(null===e.Ne?null===n.Ne:e.Ne.isEqual(n.Ne))&&e.ce===n.ce:e instanceof Un&&n instanceof Un&&ss(e.query,n.query)&&M(e.docs,n.docs,t)},t.startAfter=function(...t){return new Jn("startAfter",t,!1)},t.startAt=function(...t){return new Jn("startAt",t,!0)},t.terminate=function(t){return e._removeServiceInstance(t.app,"firestore/lite"),K(t,We)._delete()},t.updateDoc=function(t,e,n,...s){const r=K(t,Hn),i=rs(r.firestore);let o;return o="string"==typeof e||e instanceof Pn?In(i,"updateDoc",r.ue,e,n,s):Nn(i,"updateDoc",r.ue,e),Ue(Me(r.firestore),o.ae(r.ue,be.exists(!0)))},t.where=function(t,e,n){const s=e,r=Cn("where",t);return new Xn(r,s,n)},t.writeBatch=function(t){const e=K(t,We),n=Me(e);return new us(e,t=>Ue(n,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}});