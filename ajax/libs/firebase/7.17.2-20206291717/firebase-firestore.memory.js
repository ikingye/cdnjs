!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(lf){"use strict";try{(function(){lf=lf&&Object.prototype.hasOwnProperty.call(lf,"default")?lf.default:lf;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function y(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},a=p.INFO,u=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,f="FirebaseError",m=(n(w,l=Error),w);function w(t,e){var n=l.call(this,e)||this;return n.code=t,n.name=f,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={},D=_||self;function S(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),C=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:U).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function B(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,k)&&t[k]||(t[k]=++C))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var K=D.navigator;if(K){var J=K.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=S;var it,ot,st=Y(H,"Opera"),at=Y(H,"Trident")||Y(H,"MSIE"),ut=Y(H,"Edge"),ht=ut||at,ct=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),lt=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ft(){var t=D.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=H,ct?/rv:([^\);]+)(\)|;)/.exec(ot):ut?/Edge\/([\d\.]+)/.exec(ot):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):lt?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),at){var yt=ft();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(a){return t=a,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var mt=D.document&&at?ft()||(parseInt(it,10)||void 0):void 0,wt=!at||9<=Number(mt),bt=at&&!gt("9"),Et=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},B(Tt,It);var At={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Rt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function Dt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Dt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Rt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),kt={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[Nt]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Nt]?t.va(e,n,P(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!wt)return null;var a,u,h=Bt(t);if(h||(t[Pt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=wt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Bt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Dt(t)))}function Mt(t){return t in kt?kt[t]:kt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(wt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function Bt(t){return(t=t[Pt])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==O(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Gt(){j.call(this),this.c=new St(this),(this.J=this).C=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Ot(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}B(Gt,j),Gt.prototype[Nt]=!0,(N=Gt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=qt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Lt(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=D.JSON.stringify;function Xt(){this.b=this.a=null}var Ht,Qt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new $t},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Kt(t,e){var n;Ht||(n=D.Promise.resolve(void 0),Ht=function(){n.then(te)}),Jt||(Ht(),Jt=!0),Zt.add(t,e)}Xt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),Zt=new Xt;function te(){for(var t,e,n;n=e=void 0,n=null,(e=Zt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||D,this.f=M(this.Ya,this),this.g=F()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==O(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}B(ee,Gt),(N=ee.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},N.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie,oe,se,ae=(T(oe=he,se=ie=j),oe.prototype=null===se?Object.create(se):(ue.prototype=se.prototype,new ue),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){ie.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ue(){this.constructor=oe}function he(t,e,n){var r=ie.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ce(t){j.call(this),this.b=t,this.a={}}B(ce,j);var le=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function de(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.S.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},de.prototype.info=function(){};var ve=null;function ge(){return ve=ve||new Gt}function me(t){It.call(this,"serverreachability",t)}function we(t){var e=ge();e.dispatchEvent(new me(e))}function be(t){It.call(this,"statevent",t)}function Ee(t){var e=ge();e.dispatchEvent(new be(e))}function Ie(t){It.call(this,"timingevent",t)}function Te(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}B(me,It),B(be,It),B(Ie,It);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Re(t){var e;return(e=t.a)||(e=t.a={}),e}function De(){}_e.prototype.a=null;var Se,Oe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Le(){It.call(this,"d")}function Pe(){It.call(this,"c")}function ke(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ce(this),this.P=Ve,t=ht?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}B(Le,It),B(Pe,It),B(ke,_e),Se=new ke;var Ve=45e3,Ue={},Me={};function xe(t,e,n){t.H=1,t.i=sn(Ze(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),je(t),t.l=Ze(t.i);var s,a,u,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),wn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),we(1),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function Be(t,e,n){for(var r,i,o,s,a=!0;!t.A&&t.D<n.length;){var u=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(u==Me){4==e&&(t.h=4,Ee(14),a=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ue){t.h=4,Ee(15),ye(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}ye(t.c,t.f,u,null),Xe(t,u)}4==e&&0==n.length&&(t.h=1,Ee(16),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ir(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),ze(t))}function je(t){t.U=F()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(M(t.Ua,t),e)}function Ge(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ar(t.g,t)}function We(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),pe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Xe(t,e){try{var n,r,i,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;sr(p),Yn(p)}rr(p),Ee(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(M(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||sr(p),!X(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(Y(a,"spdy")||Y(a,"quic")||Y(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Rn(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,on(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=lr(o,o.C?o.ga:null,o.fa),c.C?(Dn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Ge(l),je(l)),o.a=c):nr(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}we(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)$e(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Ce.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||we(8==n||r<=0?3:2),Ge(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,y=i,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Ee(12),We(this),ze(this);break t}ye(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Xe(this,u)}this.I?(Be(this,e,o),ht&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,o,null),Xe(this,o)),4==e&&We(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Ee(12)):(this.h=0,Ee(13)),We(this),ze(this)}}}catch(t){}var h,c,l,f,p,d,y},N.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),Be(this,t,e),this.b&&4!=t&&je(this)))},N.cancel=function(){this.A=!0,We(this)},N.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(we(3),Ee(17)),We(this),this.h=2,ze(this)):qe(this,this.U-n)},(N=Qe.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Ye(this),this.a.concat()},N.get=function(t,e){return $e(this.b,t)?this.b[t]:e},N.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,tn(this,t.f),this.j=t.j,en(this,t.c),nn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),rn(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,tn(this,n[1]||"",!0),this.j=an(n[2]||""),en(this,n[3]||"",!0),nn(this,n[4]),this.g=an(n[5]||"",!0),rn(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function Ze(t){return new Je(t)}function tn(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function en(t,e,n){t.c=n?an(e,!0):e}function nn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function rn(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(vn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),wn(this,n,t))},r)),r.f=i):(n||(e=un(e,pn)),t.b=new yn(e,t.a))}function on(t,e,n){t.b.set(e,n)}function sn(t){return on(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,dn)),t.join("")};var cn=/[#\/\?@]/g,ln=/[#\?:]/g,fn=/[#\?]/g,pn=/[#\?@]/g,dn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function vn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){vn(t),e=bn(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$e((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function mn(t,e){return vn(t),e=bn(t,e),$e(t.a.b,e)}function wn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),W(n)),t.b+=n.length)}function bn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function In(t){this.g=t||Tn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=yn.prototype).add=function(t,e){vn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){vn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){vn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){vn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=z(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return vn(this),this.c=null,mn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Rn(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Ln(){this.a=new On}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}In.prototype.cancel=function(){var e,t;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var kn=D.JSON.parse;function Cn(t){Gt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}B(Cn,Gt);var Vn="",Un=/^https?$/i,Mn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Bn(t),qn(t)}function Bn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Un.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<zn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Bn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):on(t,e,n))}function Xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Hn(t){this.pa=0,this.g=[],this.c=new de,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Xn("baseRetryDelayMs",5e3,t),this.Ma=Xn("retryDelaySeedMs",1e4,t),this.Ja=Xn("forwardChannelMaxRetries",2,t),this.ma=Xn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new Ln,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;$n(t),3==t.v&&(e=t.R++,on(n=Ze(t.B),"SID",t.J),on(n,"RID",e),on(n,"TYPE","terminate"),tr(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=sn(Ze(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=F(),je(e)),cr(t)}function Yn(t){t.a&&(ir(t),t.a.cancel(),t.a=null)}function $n(t){Yn(t),t.j&&(D.clearTimeout(t.j),t.j=null),sr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){An(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Zn(t,e){var n=e?e.f:t.R++,r=Ze(t.B);on(r,"SID",t.J),on(r,"RID",n),on(r,"AID",t.P),tr(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=er(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Rn(t.b,n),xe(n,r,e)}function tr(t,n){t.f&&He({},function(t,e){on(n,e,t)})}function er(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r,e){var i=e||"";try{He(t,function(t,e){var n=t;P(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function nr(t){t.a||t.j||(t.U=1,Kt(t.Aa,t),t.o=0)}function rr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(M(t.Aa,t),ur(t,t.o)),t.o++,1)}function ir(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function or(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ze(t.la);on(e,"RID","rpc"),on(e,"SID",t.J),on(e,"CI",t.H?"0":"1"),on(e,"AID",t.P),tr(t,e),on(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=sn(Ze(e)),n.j=null,n.I=!0,Fe(n,t)}function sr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function ar(t,e){var n,r=null;if(t.a==e){sr(t),ir(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,Dn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=ge()).dispatchEvent(new Ie(i)),Jn(t)):nr(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(M(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&rr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||tn(n,"https"),sn(n)),i=n.toString(),o=r,a=new de,D.Image?((s=new Image).onload=x(Pn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=x(Pn,a,s,"TestLoadImage: error",!1,o),s.onabort=x(Pn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(Pn,a,s,"TestLoadImage: timeout",!1,o),D.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(2),t.v=0,t.f&&t.f.ra(e),cr(t),$n(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof Je?Ze(r):new Je(r,void 0);return""!=c.c?(e&&en(c,e+"."+c.c),nn(c,c.h)):(i=D.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new Je(null,void 0),o&&tn(h,o),s&&en(h,s),a&&nn(h,a),u&&(h.g=u),c=h),t.W&&Z(t.W,function(t,e){on(c,e,t)}),e=t.A,n=t.na,e&&n&&on(c,e,n),on(c,"VER",t.ha),tr(t,c),c}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function pr(){}function dr(){if(at&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Gt.call(this),this.a=new Hn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new mr(this)}function vr(t){Le.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Pe.call(this),this.status=1}function mr(t){this.a=t}(N=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Re(this.H):Re(Se),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&He(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=q(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,at&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},N.xa=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Cn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},N.Ta=function(){jn(this)},N.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Hn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=er(this,n,e),on(i=Ze(this.B),"RID",t),on(i,"CVER",22),this.A&&on(i,"X-HTTP-Session-Id",this.A),tr(this,i),this.i&&r&&Wn(i,this.i,r),Rn(this.b,n),this.Ga&&on(i,"TYPE","init"),this.da?(on(i,"$req",e),on(i,"SID","null"),n.V=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?Zn(this,t):0==this.g.length||An(this.b)||Zn(this))},N.Aa=function(){var t;this.j=null,or(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),or(this))},N.Ra=function(){null!=this.m&&(this.m=null,Yn(this),rr(this),Ee(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ee(2)):(this.c.info("Failed to ping google.com"),Ee(1))},(N=pr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},dr.prototype.a=function(t,e){return new yr(t,e)},B(yr,Gt),(N=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=lr(t,null,t.fa),Jn(t)},N.close=function(){Qn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Wt(t),Kn(this.a,e)):Kn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,yr.S.G.call(this)},B(vr,Le),B(gr,Pe),B(mr,pr),mr.prototype.ta=function(){this.a.dispatchEvent("a")},mr.prototype.sa=function(t){this.a.dispatchEvent(new vr(t))},mr.prototype.ra=function(t){this.a.dispatchEvent(new gr)},mr.prototype.qa=function(){this.a.dispatchEvent("b")},dr.prototype.createWebChannel=dr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ne.COMPLETE="complete",(De.EventType=Oe).OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var wr={createWebChannelTransport:function(){return new dr},ErrorCode:Ae,EventType:Ne,WebChannel:De,XhrIo:Cn},br=wr.createWebChannelTransport,Er=wr.ErrorCode,Ir=wr.EventType,Tr=wr.WebChannel,Ar=wr.XhrIo,Nr=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Rr="7.17.2-20206291717",Dr=new h("@firebase/firestore");function Sr(){return Dr.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=p.DEBUG&&(e=n.map(Pr),Dr.debug.apply(Dr,v(["Firestore ("+Rr+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=p.ERROR&&(e=n.map(Pr),Dr.error.apply(Dr,v(["Firestore ("+Rr+"): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Rr+") INTERNAL ASSERTION FAILED: "+t;throw Lr(e),new Error(e)}function Cr(t){t||kr()}var Vr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function Mr(t,e){return t<e?-1:e<t?1:0}function xr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Fr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Br=(Object.defineProperty(jr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),jr.prototype.isEqual=function(t){return t instanceof jr&&t.projectId===this.projectId&&t.database===this.database},jr.prototype.o=function(t){return Mr(this.projectId,t.projectId)||Mr(this.database,t.database)},jr);function jr(t,e){this.projectId=t,this.database=e||"(default)"}function qr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wr,Xr,Hr,Qr=(li.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.u(s,t))return a}},li.prototype.has=function(t){return void 0!==this.get(t)},li.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},li.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},li.prototype.forEach=function(a){Gr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},li.prototype._=function(){return zr(this.l)},li),Yr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$r=(n(ci,Hr=Error),ci),Kr=(hi.now=function(){return hi.fromMillis(Date.now())},hi.fromDate=function(t){return hi.fromMillis(t.getTime())},hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new hi(e,1e6*(t-1e3*e))},hi.prototype.toDate=function(){return new Date(this.toMillis())},hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hi.prototype.T=function(t){return this.seconds===t.seconds?Mr(this.nanoseconds,t.nanoseconds):Mr(this.seconds,t.seconds)},hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hi),Jr=(ui.m=function(t){return new ui(t)},ui.min=function(){return new ui(new Kr(0,0))},ui.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ui.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ui.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ui.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ui.prototype.R=function(){return this.timestamp},ui),Zr=(Object.defineProperty(ai.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),ai.prototype.isEqual=function(t){return 0===ai.P(this,t)},ai.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ai?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ai.prototype.limit=function(){return this.offset+this.length},ai.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ai.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ai.prototype.v=function(){return this.segments[this.offset]},ai.prototype.S=function(){return this.get(this.length-1)},ai.prototype.get=function(t){return this.segments[this.offset+t]},ai.prototype._=function(){return 0===this.length},ai.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ai.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ai.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ai.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ai),ti=(n(si,Xr=Zr),si.prototype.V=function(t,e,n){return new si(t,e,n)},si.prototype.$=function(){return this.F().join("/")},si.prototype.toString=function(){return this.$()},si.N=function(t){if(0<=t.indexOf("//"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new si(t.split("/").filter(function(t){return 0<t.length}))},si.k=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Wr=Zr),oi.prototype.V=function(t,e,n){return new oi(t,e,n)},oi.O=function(t){return ei.test(t)},oi.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.O(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.$()},oi.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},oi.M=function(){return new oi(["__name__"])},oi.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new $r(Yr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new $r(Yr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.k=function(){return new oi([])},oi),ri=(ii.U=function(t){return new ii(ti.N(t).p(5))},ii.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.P(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.P=function(t,e){return ti.P(t.path,e.path)},ii.W=function(t){return t.length%2==0},ii.j=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Wr&&Wr.apply(this,arguments)||this}function si(){return null!==Xr&&Xr.apply(this,arguments)||this}function ai(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.A=n}function ui(t){this.timestamp=t}function hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $r(Yr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ci(t,e){var n=this;return(n=Hr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function li(t,e){this.h=t,this.u=e,this.l={}}function fi(t){return null==t}function pi(t){return-0===t&&1/t==-1/0}var di=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function yi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new di(t,e,n,r,i,o,s)}function vi(t){var e,n=t;return null===n.G&&(e=n.path.$(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.$()+e.op.toString()+wo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),fi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Va(n.startAt)),n.endAt&&(e+="|ub:",e+=Va(n.endAt)),n.G=e),n.G}function gi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],!(o instanceof ga&&s instanceof ga&&o.op===s.op&&o.field.isEqual(s.field)&&yo(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ma(t.startAt,e.startAt)&&Ma(t.endAt,e.endAt)}function mi(t){return ri.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wi=(bi.fromBase64String=function(t){return new bi(atob(t))},bi.fromUint8Array=function(t){return new bi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},bi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},bi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},bi.prototype.H=function(){return 2*this.K.length},bi.prototype.o=function(t){return Mr(this.K,t.K)},bi.prototype.isEqual=function(t){return this.K===t.K},bi);function bi(t){this.K=t}wi.Y=new wi("");function Ei(t){this.count=t}var Ii,Ti,Ai=(Ni.prototype.Z=function(t){return new Ni(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ni.prototype.tt=function(t,e){return new Ni(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ni.prototype.et=function(t){return new Ni(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ni);function Ni(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=wi.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function _i(t){switch(t){case Yr.OK:return kr(),0;case Yr.CANCELLED:case Yr.UNKNOWN:case Yr.DEADLINE_EXCEEDED:case Yr.RESOURCE_EXHAUSTED:case Yr.INTERNAL:case Yr.UNAVAILABLE:case Yr.UNAUTHENTICATED:return;case Yr.INVALID_ARGUMENT:case Yr.NOT_FOUND:case Yr.ALREADY_EXISTS:case Yr.PERMISSION_DENIED:case Yr.FAILED_PRECONDITION:case Yr.ABORTED:case Yr.OUT_OF_RANGE:case Yr.UNIMPLEMENTED:case Yr.DATA_LOSS:return 1;default:return kr(),0}}function Ri(t){if(void 0===t)return Lr("GRPC error has no .code"),Yr.UNKNOWN;switch(t){case Ii.OK:return Yr.OK;case Ii.CANCELLED:return Yr.CANCELLED;case Ii.UNKNOWN:return Yr.UNKNOWN;case Ii.DEADLINE_EXCEEDED:return Yr.DEADLINE_EXCEEDED;case Ii.RESOURCE_EXHAUSTED:return Yr.RESOURCE_EXHAUSTED;case Ii.INTERNAL:return Yr.INTERNAL;case Ii.UNAVAILABLE:return Yr.UNAVAILABLE;case Ii.UNAUTHENTICATED:return Yr.UNAUTHENTICATED;case Ii.INVALID_ARGUMENT:return Yr.INVALID_ARGUMENT;case Ii.NOT_FOUND:return Yr.NOT_FOUND;case Ii.ALREADY_EXISTS:return Yr.ALREADY_EXISTS;case Ii.PERMISSION_DENIED:return Yr.PERMISSION_DENIED;case Ii.FAILED_PRECONDITION:return Yr.FAILED_PRECONDITION;case Ii.ABORTED:return Yr.ABORTED;case Ii.OUT_OF_RANGE:return Yr.OUT_OF_RANGE;case Ii.UNIMPLEMENTED:return Yr.UNIMPLEMENTED;case Ii.DATA_LOSS:return Yr.DATA_LOSS;default:return kr()}}(Ti=Ii=Ii||{})[Ti.OK=0]="OK",Ti[Ti.CANCELLED=1]="CANCELLED",Ti[Ti.UNKNOWN=2]="UNKNOWN",Ti[Ti.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ti[Ti.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ti[Ti.NOT_FOUND=5]="NOT_FOUND",Ti[Ti.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ti[Ti.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ti[Ti.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ti[Ti.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ti[Ti.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ti[Ti.ABORTED=10]="ABORTED",Ti[Ti.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ti[Ti.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ti[Ti.INTERNAL=13]="INTERNAL",Ti[Ti.UNAVAILABLE=14]="UNAVAILABLE",Ti[Ti.DATA_LOSS=15]="DATA_LOSS";var Di=(ki.prototype.nt=function(t,e){return new ki(this.P,this.root.nt(t,e,this.P).copy(null,null,Oi.st,null,null))},ki.prototype.remove=function(t){return new ki(this.P,this.root.remove(t,this.P).copy(null,null,Oi.st,null,null))},ki.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ki.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ki.prototype._=function(){return this.root._()},Object.defineProperty(ki.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ki.prototype.it=function(){return this.root.it()},ki.prototype.rt=function(){return this.root.rt()},ki.prototype.ot=function(t){return this.root.ot(t)},ki.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},ki.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ki.prototype.ht=function(t){return this.root.ht(t)},ki.prototype.at=function(){return new Si(this.root,null,this.P,!1)},ki.prototype.ut=function(t){return new Si(this.root,t,this.P,!1)},ki.prototype.ct=function(){return new Si(this.root,null,this.P,!0)},ki.prototype.lt=function(t){return new Si(this.root,t,this.P,!0)},ki),Si=(Pi.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Pi.prototype.wt=function(){return 0<this.ft.length},Pi.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Pi),Oi=(Li.prototype.copy=function(t,e,n,r,i){return new Li(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Li.prototype._=function(){return!1},Li.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Li.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Li.prototype.min=function(){return this.left._()?this:this.left.min()},Li.prototype.it=function(){return this.min().key},Li.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Li.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Li.prototype.It=function(){if(this.left._())return Li.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Li.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.At()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.Pt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Li.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Li.prototype.Rt=function(){return this.color},Li.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Li.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Li.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Li.prototype.pt=function(){var t=this.copy(null,null,Li.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Li.prototype.Pt=function(){var t=this.copy(null,null,Li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Li.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Li.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Li.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw kr();if(this.right.Rt())throw kr();var t=this.left.vt();if(t!==this.right.vt())throw kr();return t+(this.Rt()?0:1)},Li);function Li(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Li.RED,this.left=null!=r?r:Li.EMPTY,this.right=null!=i?i:Li.EMPTY,this.size=this.left.size+1+this.right.size}function Pi(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function ki(t,e){this.P=t,this.root=e||Oi.EMPTY}function Ci(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.st=!1,Oi.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.nt=function(t,e,n){return new Oi(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype._=function(){return!0},Ci.prototype.ot=function(t){return!1},Ci.prototype.ht=function(t){return!1},Ci.prototype.it=function(){return null},Ci.prototype.rt=function(){return null},Ci.prototype.Rt=function(){return!1},Ci.prototype.gt=function(){return!0},Ci.prototype.vt=function(){return 0},new Ci);var Vi=(Fi.prototype.has=function(t){return null!==this.data.get(t)},Fi.prototype.first=function(){return this.data.it()},Fi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Fi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fi.prototype.indexOf=function(t){return this.data.indexOf(t)},Fi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Fi.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Fi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Fi.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Fi.prototype.at=function(){return new Ui(this.data.at())},Fi.prototype.ut=function(t){return new Ui(this.data.ut(t))},Fi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Fi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fi.prototype._=function(){return this.data._()},Fi.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fi.prototype.isEqual=function(t){if(!(t instanceof Fi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Fi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fi.prototype.copy=function(t){var e=new Fi(this.P);return e.data=t,e},Fi),Ui=(xi.prototype.dt=function(){return this.Ft.dt().key},xi.prototype.wt=function(){return this.Ft.wt()},xi),Mi=new Di(ri.P);function xi(t){this.Ft=t}function Fi(t){this.P=t,this.data=new Di(this.P)}var Bi=new Di(ri.P);var ji=new Di(ri.P),qi=new Vi(ri.P);function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=qi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var zi=new Vi(Mr);function Wi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Xi(t,e){this.targetId=t,this.ee=e}function Hi(t,e,n,r){void 0===n&&(n=wi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Qi=(ao.kt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.$t.get(t)},ao.prototype.get=function(t){return this.$t.get(t)},ao.prototype.first=function(){return this.Nt.it()},ao.prototype.last=function(){return this.Nt.rt()},ao.prototype._=function(){return this.Nt._()},ao.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.$t=t,n.Nt=e,n},ao),Yi=(so.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):kr()},so.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},so),$i=(oo.Bt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new oo(t,e,Qi.kt(e),i,n,r,!0,!1)},Object.defineProperty(oo.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),oo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&la(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},oo),Ki=(io.zt=function(t,e){var n=new Map;return n.set(t,Ji.Kt(t,e)),new io(Jr.min(),n,zi,Mi,Gi())},io),Ji=(ro.Kt=function(t,e){return new ro(wi.Y,e,Gi(),Gi(),Gi())},ro),Zi=(Object.defineProperty(no.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),no.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},no.prototype.ce=function(){var n=Gi(),r=Gi(),i=Gi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Ji(this.ie,this.re,n,r,i)},no.prototype.le=function(){this.oe=!1,this.se=ho()},no.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},no.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},no.prototype.de=function(){this.ne+=1},no.prototype.we=function(){--this.ne},no.prototype.Te=function(){this.oe=!0,this.re=!0},no),to=(eo.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Ys?this.Ve(r,t.te):t.te instanceof $s&&this.pe(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.pe(s,t.key,t.te)}},eo.prototype.ye=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:kr()}})},eo.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},eo.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.De(r);o&&(mi(e=o.target)?0===i?(n=new ri(e.path),this.pe(r,n,new $s(n,Jr.min()))):Cr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Ae=this.Ae.add(r)))},eo.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.De(e);r&&(t.Ht&&mi(r.target)&&(n=new ri(r.target.path),null!==o.Ie.get(n)||o.Ne(e,n)||o.pe(e,n,new $s(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=Gi();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new Ki(i,s,this.Ae,this.Ie,r);return this.Ie=Mi,this.Re=uo(),this.Ae=new Vi(Mr),t},eo.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.Ne(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},eo.prototype.pe=function(t,e,n){var r;this.be(t)&&(r=this.ve(t),this.Ne(t,e)?r._e(e,1):r.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},eo.prototype.removeTarget=function(t){this.me.delete(t)},eo.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},eo.prototype.de=function(t){this.ve(t).de()},eo.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Zi,this.me.set(t,e)),e},eo.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Vi(Mr),this.Re=this.Re.nt(t,e)),e},eo.prototype.be=function(t){var e=null!==this.De(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},eo.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},eo.prototype.Se=function(e){var n=this;this.me.set(e,new Zi),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},eo.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},eo);function eo(t){this.Ee=t,this.me=new Map,this.Ie=Mi,this.Re=uo(),this.Ae=new Vi(Mr)}function no(){this.ne=0,this.se=ho(),this.ie=wi.Y,this.re=!1,this.oe=!0}function ro(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function io(t,e,n,r,i){this.J=t,this.Wt=e,this.Qt=n,this.jt=r,this.Gt=i}function oo(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Ut=a}function so(){this.xt=new Di(ri.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ri.P(t.key,e.key)}:function(t,e){return ri.P(t.key,e.key)},this.$t=Bi,this.Nt=new Di(this.P)}function uo(){return new Di(ri.P)}function ho(){return new Di(ri.P)}function co(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=bo(t.mapValue.fields.__local_write_time__.timestampValue);return new Kr(e.seconds,e.nanos)}var fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?co(t)?4:10:kr()}function yo(r,i){var t,e,n,o=po(r);if(o!==po(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=bo(r.timestampValue),n=bo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Io(r.bytesValue).isEqual(Io(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Eo((t=r).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Eo(t.doubleValue),r=Eo(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return xr(r.arrayValue.values||[],i.arrayValue.values||[],yo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(qr(t)!==qr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!yo(t[n],e[n])))return!1;return!0}();default:return kr()}}function vo(t,e){return void 0!==(t.values||[]).find(function(t){return yo(t,e)})}function go(t,e){var n,r,i,o,s,a,u,h,c,l,f=po(t),p=po(e);if(f!==p)return Mr(f,p);switch(f){case 0:return 0;case 1:return Mr(t.booleanValue,e.booleanValue);case 2:return h=e,c=Eo(t.integerValue||t.doubleValue),l=Eo(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return mo(t.timestampValue,e.timestampValue);case 4:return mo(lo(t),lo(e));case 5:return Mr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Io(o),u=Io(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Mr(n[i],r[i]);if(0!==o)return o}return Mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Mr(Eo(n.latitude),Eo(r.latitude)))?i:Mr(Eo(n.longitude),Eo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=go(n[i],r[i]);if(o)return o}return Mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Mr(r[s],o[s]);if(0!==a)return a;var u=go(n[r[s]],i[o[s]]);if(0!==u)return u}return Mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mr(t,e);var n=bo(t),r=bo(e),i=Mr(n.seconds,r.seconds);return 0!==i?i:Mr(n.nanos,r.nanos)}function wo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=bo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Io(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ri.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e,n}(t)}function bo(t){if(Cr(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e,n=0,r=fo.exec(t);Cr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Io(t){return"string"==typeof t?wi.fromBase64String(t):wi.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function Ao(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function _o(t){return t&&"nullValue"in t}function Ro(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var So={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Le=e};function Po(t){return{integerValue:""+t}}function ko(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Po(e):ko(t,e);var n}function Vo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Uo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Mo(t){return Cr(!!t),Jr.m((e=bo(t),new Kr(e.seconds,e.nanos)));var e}function xo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function Fo(t,e){return xo(t.s,e.path)}function Bo(t,e){var n,r,i=(Cr(Ho(r=ti.N(e))),r);return Cr(i.get(1)===t.s.projectId),Cr(!i.get(3)&&!t.s.database||i.get(3)===t.s.database),new ri((Cr(4<(n=i).length&&"documents"===n.get(4)),n.p(5)))}function jo(t,e){return xo(t.s,e)}function qo(t){return new ti(["projects",t.s.projectId,"databases",t.s.database]).$()}function Go(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,r,i,o,s,a;if(e instanceof _s)n={update:Go(t,e.key,e.value)};else if(e instanceof Ms)n={delete:Fo(t,e.key)};else if(e instanceof Rs)n={update:Go(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Ps)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof Zo)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof is)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.$(),increment:e.qe};throw kr()})}};else{if(!(e instanceof xs))return kr();n={verify:Fo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:(s=t,a=o.updateTime,Vo(s,a.R()))}:void 0!==o.exists?{exists:o.exists}:kr()),n}function Wo(t){return{before:t.before,values:t.position}}function Xo(t){return{fieldPath:t.$()}}function Ho(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Qo(){this.We=void 0}function Yo(t,e){return t instanceof us?Ao(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var $o,Ko,Jo=(n(es,Ko=Qo),es),Zo=(n(ts,$o=Qo),ts);function ts(t){var e=this;return(e=$o.call(this)||this).elements=t,e}function es(){return null!==Ko&&Ko.apply(this,arguments)||this}function ns(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return yo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var rs,is=(n(os,rs=Qo),os);function os(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function ss(t,e){for(var n=ls(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!yo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var as,us=(n(hs,as=Qo),hs);function hs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.qe=e,n}function cs(t){return Eo(t.integerValue||t.doubleValue)}function ls(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fs(t,e){this.field=t,this.transform=e}var ps=(ds.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ds.prototype.isEqual=function(t){return xr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ds);function ds(t){(this.fields=t).sort(ni.P)}function ys(t,e){this.version=t,this.transformResults=e}var vs=(gs.je=function(){return new gs},gs.exists=function(t){return new gs(void 0,t)},gs.updateTime=function(t){return new gs(t)},Object.defineProperty(gs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),gs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},gs);function gs(t,e){this.updateTime=t,this.exists=e}function ms(t,e){return void 0!==t.updateTime?e instanceof Ys&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ys}function ws(){}function bs(t,e,n){return t instanceof _s?new Ys(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Rs?function(t,e,n){if(!ms(t.Be,e))return new Ks(t.key,n.version);var r=Os(t,e);return new Ys(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ps?function(t,e,n){if(Cr(null!=n.transformResults),!ms(t.Be,e))return new Ks(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Ys&&(c=e.field(u.field)),r.push((i=h,o=c,s=n[a],i instanceof Zo?ns(i,o):i instanceof is?ss(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Cs(t,r.data(),i);return new Ys(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new $s(t.key,n.version,{hasCommittedMutations:!0})}function Es(t,e,n,r){return t instanceof _s?function(t,e){if(!ms(t.Be,e))return e;var n=Ts(e);return new Ys(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Rs?function(t,e){if(!ms(t.Be,e))return e;var n=Ts(e),r=Os(t,e);return new Ys(t.key,n,r,{Ge:!0})}(t,e):t instanceof Ps?function(t,e,n,r){if(!ms(t.Be,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],y=d.transform,v=null;n instanceof Ys&&(v=n.field(d.field)),null===v&&r instanceof Ys&&(v=r.field(d.field)),l.push((o=v,s=e,c=h=u=a=void 0,(i=y)instanceof Jo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof Zo?ns(i,o):i instanceof is?ss(i,o):(u=Yo(a=i,o),h=cs(u)+cs(a.qe),Ao(u)&&Ao(a.qe)?Po(h):ko(a.serializer,h))))}return l}(t.fieldTransforms,n,e,r),s=Cs(t,i.data(),o);return new Ys(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,ms((i=t).Be,o)?new $s(i.key,Jr.min()):o);var i,o}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||xr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Zo&&o instanceof Zo||i instanceof is&&o instanceof is?xr(i.elements,o.elements,yo):i instanceof us&&o instanceof us?yo(i.qe,o.qe):i instanceof Jo&&o instanceof Jo);var n,r,i,o}))}function Ts(t){return t instanceof Ys?t.version:Jr.min()}var As,Ns,_s=(n(Ss,Ns=ws),Ss),Rs=(n(Ds,As=ws),Ds);function Ds(t,e,n,r){var i=this;return(i=As.call(this)||this).key=t,i.data=e,i.Me=n,i.Be=r,i.type=1,i}function Ss(t,e,n){var r=this;return(r=Ns.call(this)||this).key=t,r.value=e,r.Be=n,r.type=0,r}function Os(t,e){return n=t,r=e instanceof Ys?e.data():Fs.empty(),i=new Bs(r),n.Me.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Ls,Ps=(n(ks,Ls=ws),ks);function ks(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=vs.exists(!0),n}function Cs(t,e,n){for(var r=new Bs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Vs,Us,Ms=(n(zs,Us=ws),zs),xs=(n(Gs,Vs=ws),Gs),Fs=(qs.empty=function(){return new qs({mapValue:{}})},qs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},qs.prototype.isEqual=function(t){return yo(this.proto,t.proto)},qs),Bs=(js.prototype.set=function(t,e){return this.Ye(t,e),this},js.prototype.delete=function(t){return this.Ye(t,null),this},js.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===po(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},js.prototype.ze=function(){var t=this.Xe(ni.k(),this.He);return null!=t?new Fs(t):this.Ke},js.prototype.Xe=function(r,t){var i=this,o=!1,e=this.Ke.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},js);function js(t){void 0===t&&(t=Fs.empty()),this.Ke=t,this.He=new Map}function qs(t){this.proto=t}function Gs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.Be=e,n.type=4,n}function zs(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.Be=e,n.type=3,n}function Ws(t,e){this.key=t,this.version=e}var Xs,Hs,Qs,Ys=(n(ta,Qs=Ws),ta.prototype.field=function(t){return this.Je.field(t)},ta.prototype.data=function(){return this.Je},ta.prototype.Ze=function(){return this.Je.proto},ta.prototype.isEqual=function(t){return t instanceof ta&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},ta.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ta.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),ta),$s=(n(Zs,Hs=Ws),Zs.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs),Ks=(n(Js,Xs=Ws),Js.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js);function Js(){return null!==Xs&&Xs.apply(this,arguments)||this}function Zs(t,e,n){var r=this;return(r=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function ta(t,e,n,r){var i=this;return(i=Qs.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function ea(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $r(Yr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $r(Yr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var na=(ra.prototype.rn=function(t){return new ra(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},ra.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},ra.prototype.hn=function(){return!fi(this.limit)&&"F"===this.en},ra.prototype.an=function(){return!fi(this.limit)&&"L"===this.en},ra.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},ra.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},ra.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},ra);function ra(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function ia(t){return new na(t)}function oa(t){return null!==t.collectionGroup}function sa(t){var e=ea(t,na);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.L()||e.nn.push(new xa(n)),e.nn.push(new xa(ni.M(),"asc"));else{for(var i,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.L()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new xa(ni.M(),i)))}}return e.nn}function aa(t){var e=ea(t,na);if(!e.sn)if("F"===e.en)e.sn=yi(e.path,e.collectionGroup,sa(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=sa(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new xa(o.field,s))}var a=e.endAt?new Sa(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Sa(e.startAt.position,!e.startAt.before):null;e.sn=yi(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function ua(t,e,n){return new na(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ha(t,e){return new na(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function ca(t,e){return new na(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function la(t,e){return gi(aa(t),aa(e))&&t.en===e.en}function fa(t){return vi(aa(t))+"|lt:"+t.en}function pa(t){return"Query(target="+(e=aa(t),n=e.path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+wo(e.value);var e}).join(", ")+"]"),fi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Va(e.startAt)),e.endAt&&(n+=", endAt: "+Va(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function da(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.B(r.collectionGroup)&&r.path.C(o):ri.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ua(e.startAt,sa(e),n))&&(!e.endAt||!Ua(e.endAt,sa(e),n)));var e,n,r,o}function ya(a){return function(t,e){for(var n=!1,r=0,i=sa(a);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.L()?ri.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?go(n,r):kr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var va,ga=(n(ma,va=function(){}),ma.create=function(t,e,n){if(t.L())return"in"===e?new Na(t,n):new Aa(t,e,n);if(_o(n)){if("=="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ma(t,e,n)}if(Ro(n)){if("=="!==e)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ma(t,e,n)}return"array-contains"===e?new _a(t,n):"in"===e?new Ra(t,n):"array-contains-any"===e?new Da(t,n):new ma(t,e,n)},ma.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&po(this.value)===po(e)&&this.fn(go(e,this.value))},ma.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},ma.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},ma);function ma(t,e,n){var r=this;return(r=va.call(this)||this).field=t,r.op=e,r.value=n,r}var wa,ba,Ea,Ia,Ta,Aa=(n(Ca,Ta=ga),Ca.prototype.matches=function(t){var e=ri.P(t.key,this.key);return this.fn(e)},Ca),Na=(n(ka,Ia=ga),ka.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ka),_a=(n(Pa,Ea=ga),Pa.prototype.matches=function(t){var e=t.field(this.field);return No(e)&&vo(e.arrayValue,this.value)},Pa),Ra=(n(La,ba=ga),La.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&vo(this.value.arrayValue,e)},La),Da=(n(Oa,wa=ga),Oa.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!No(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return vo(e.value.arrayValue,t)})},Oa),Sa=function(t,e){this.position=t,this.before=e};function Oa(t,e){return wa.call(this,t,"array-contains-any",e)||this}function La(t,e){return ba.call(this,t,"in",e)||this}function Pa(t,e){return Ea.call(this,t,"array-contains",e)||this}function ka(t,e){var n=this;return(n=Ia.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ri.U(t.referenceValue)}),n}function Ca(t,e,n){var r=this;return(r=Ta.call(this,t,e,n)||this).key=ri.U(n.referenceValue),r}function Va(t){return(t.before?"b":"a")+":"+t.position.map(wo).join(",")}function Ua(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.L()?ri.P(ri.U(s.referenceValue),n.key):go(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ma(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!yo(t.position[n],e.position[n]))return!1;return!0}var xa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Fa=($a.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=bs(o,e,r[i]))}return e},$a.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Es(i,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Es(u,e,o,this.dn))}return e},$a.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},$a.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gi())},$a.prototype.isEqual=function(t){return this.batchId===t.batchId&&xr(this.mutations,t.mutations,Is)&&xr(this.baseMutations,t.baseMutations,Is)},$a),Ba=(Ya.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=ji,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Ya(t,e,n,r)},Ya),ja=(Qa.prototype.catch=function(t){return this.next(void 0,t)},Qa.prototype.next=function(r,i){var o=this;return this.pn&&kr(),this.pn=!0,this.Vn?this.error?this.yn(i,this.error):this.gn(r,this.result):new Qa(function(e,n){o.An=function(t){o.gn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},Qa.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Qa.prototype.bn=function(t){try{var e=t();return e instanceof Qa?e:Qa.resolve(e)}catch(t){return Qa.reject(t)}},Qa.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):Qa.resolve(e)},Qa.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):Qa.reject(e)},Qa.resolve=function(n){return new Qa(function(t,e){t(n)})},Qa.reject=function(n){return new Qa(function(t,e){e(n)})},Qa.Sn=function(t){return new Qa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Qa.Cn=function(t){for(var n=Qa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Qa.resolve(t):e()})}(r[e]);return n},Qa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},Qa),qa=(Ha.prototype.Nn=function(e,n){var r=this;return this.Fn.kn(e,n).next(function(t){return r.xn(e,n,t)})},Ha.prototype.xn=function(t,r,i){return this.Dn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},Ha.prototype.Ln=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},Ha.prototype.Mn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.qn(e,t)})},Ha.prototype.qn=function(r,i){var o=this;return this.Fn.Un(r,i).next(function(t){var e=o.Ln(r,i,t),n=Mi;return e.forEach(function(t,e){e=e||new $s(t,Jr.min()),n=n.nt(t,e)}),n})},Ha.prototype.Bn=function(t,e,n){return r=e,ri.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wn(t,e.path):oa(e)?this.Qn(t,e,n):this.jn(t,e,n);var r},Ha.prototype.Wn=function(t,e){return this.Nn(t,new ri(e)).next(function(t){var e=Bi;return t instanceof Ys&&(e=e.nt(t.key,t)),e})},Ha.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,a=Bi;return this.$n.Gn(n,s).next(function(t){return ja.forEach(t,function(t){var e=r.rn(t.child(s));return o.jn(n,e,i).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Ha.prototype.jn=function(e,n,t){var c,l,r=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,r.Fn.zn(e,n)}).next(function(t){return l=t,r.Kn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=Es(s,u,u,r.dn);c=h instanceof Ys?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){da(n,e)||(c=c.remove(t))}),c})},Ha.prototype.Kn=function(t,e,n){for(var r=Gi(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Rs&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.Dn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ys&&(h=h.nt(t,e))}),h})},Ha),Ga=(Xa.Xn=function(t,e){for(var n=Gi(),r=Gi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Xa(t,e.fromCache,n,r)},Xa),za=(Wa.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Wa.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},Wa);function Wa(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function Xa(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=r}function Ha(t,e,n){this.Dn=t,this.Fn=e,this.$n=n}function Qa(t){var e=this;this.An=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Ya(t,e,n,r){this.batch=t,this.In=e,this.Tn=n,this.Rn=r}function $a(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}za.ns=-1;function Ka(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ja=(ou.prototype.reset=function(){this.us=0},ou.prototype._s=function(){this.us=this.as},ou.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),r=Math.max(0,Date.now()-this.ls),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.cs=this.ss.ws(this.rs,i,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},ou.prototype.Ts=function(){null!==this.cs&&(this.cs.Es(),this.cs=null)},ou.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},ou.prototype.ds=function(){return(Math.random()-.5)*this.us},ou),Za=(iu.prototype.Is=function(t,e){return this.ms.add(e),ja.resolve()},iu.prototype.Gn=function(t,e){return ja.resolve(this.ms.getEntries(e))},iu),tu=(ru.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Vi(ti.P),i=!r.has(n);return this.index[e]=r.add(n),i},ru.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},ru.prototype.getEntries=function(t){return(this.index[t]||new Vi(ti.P)).F()},ru),eu=(nu.prototype.next=function(){return this.Rs+=2,this.Rs},nu.As=function(){return new nu(0)},nu.Ps=function(){return new nu(-1)},nu);function nu(t){this.Rs=t}function ru(){this.index={}}function iu(){this.ms=new tu}function ou(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=r,this.as=i,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function su(t){return"IndexedDbTransactionError"===t.name}function au(){return"undefined"!=typeof window?window:null}var uu=(lu.vs=function(t,e,n,r,i){var o=new lu(t,e,Date.now()+n,r,i);return o.start(n),o},lu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},lu.prototype.Es=function(){return this.Ss()},lu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new $r(Yr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},lu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},lu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},lu),hu=(Object.defineProperty(cu.prototype,"qs",{get:function(){return this.$s},enumerable:!1,configurable:!0}),cu.prototype.Cs=function(t){this.enqueue(t)},cu.prototype.Us=function(t){this.Bs(),this.Ws(t)},cu.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},cu.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.$s?[3,2]:(this.$s=!0,(e=au())&&e.removeEventListener("visibilitychange",this.Ms),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},cu.prototype.enqueue=function(t){return this.Bs(),this.$s?new Promise(function(t){}):this.Ws(t)},cu.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.zs()})},cu.prototype.zs=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Ls.reset(),[3,4];case 3:if(!su(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Ls.fs(function(){return n.zs()}),t.label=5;case 5:return[2]}})})},cu.prototype.Ws=function(t){var r=this,e=this.Ds.then(function(){return r.xs=!0,t().catch(function(t){throw r.ks=t,r.xs=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xs=!1,t})});return this.Ds=e},cu.prototype.ws=function(t,e,n){var r=this;this.Bs(),-1<this.Os.indexOf(t)&&(e=0);var i=uu.vs(this,t,e,n,function(t){return r.Ks(t)});return this.Ns.push(i),i},cu.prototype.Bs=function(){this.ks&&kr()},cu.prototype.Hs=function(){},cu.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},cu.prototype.Xs=function(t){for(var e=0,n=this.Ns;e<n.length;e++)if(n[e].rs===t)return!0;return!1},cu.prototype.Js=function(r){var i=this;return this.Ys().then(function(){i.Ns.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=i.Ns;t<e.length;t++){var n=e[t];if(n.Es(),"all"!==r&&n.rs===r)break}return i.Ys()})},cu.prototype.Zs=function(t){this.Os.push(t)},cu.prototype.Ks=function(t){var e=this.Ns.indexOf(t);this.Ns.splice(e,1)},cu);function cu(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.$s=!1,this.Ns=[],this.ks=null,this.xs=!1,this.Os=[],this.Ls=new Ja(this,"async_queue_retry"),this.Ms=function(){return t.Ls.Ts()};var e=au();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ms)}function lu(t,e,n,r,i){this.Vs=t,this.rs=e,this.ps=n,this.op=r,this.ys=i,this.gs=new Ka,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function fu(t,e){if(Lr("AsyncQueue",e+": "+t),su(t))return new $r(Yr.UNAVAILABLE,e+": "+t);throw t}var pu=(du.si=function(t){return new du(t,du.ii,du.ri)},du);function du(t,e,n){this.ti=t,this.ei=e,this.ni=n}pu.oi=-1,pu.hi=1048576,pu.ai=41943040,pu.ii=10,pu.ri=1e3,pu.ui=new pu(pu.ai,pu.ii,pu.ri),pu.ci=new pu(pu.oi,0,0);var yu=(vu.prototype.Vi=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ri,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Fn.pi(v).next(function(t){return g=t,e=r.persistence.wi(i),m=new qa(r.Ti,e,r.persistence.Ai()),e.pi(v)}).next(function(t){for(var e=[],n=[],r=Gi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Mn(v,r).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ri=m,this.li.Pi(this.Ri),n)]}})})},vu.prototype.bi=function(h){var c,l=this,f=Kr.now(),t=h.reduce(function(t,e){return t.add(e.key)},Gi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ri.Mn(u,t).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof Ps?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ys?t.field(i.field):void 0,s=Yo(i.transform,o||null);null!=s&&(e=null==e?(new Bs).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Rs(o.key,s,function a(t){var u=[];return Gr(t.fields||{},function(t,e){var n=new ni([t]);if(Do(e)){var r=a(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new ps(u)}(s.proto.mapValue),vs.exists(!0)))}return l.Fn.Si(u,f,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Ci:e}})},vu.prototype.Di=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ti.Fi({$i:!0});return i.Ni(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Fn.ki(t)}).next(function(){return i.Ri.Mn(t,e)})})},vu.prototype.xi=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Fn.Oi(e,t).next(function(t){return Cr(null!==t),n=t.keys(),r.Fn.Li(e,t)}).next(function(){return r.Fn.ki(e)}).next(function(){return r.Ri.Mn(e,n)})})},vu.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.Mi(t)})},vu.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mi.qi(t)})},vu.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ti.Fi({$i:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.mi.Bi(o,t.Jt,e).next(function(){return h.mi.Wi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Qi),l=l.nt(e,r),vu.ji(i,r,t)&&s.push(h.mi.Gi(o,r))))});var t,a=Mi,n=Gi();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.jt.forEach(function(t,e){var n=r.get(t);e instanceof $s&&e.version.isEqual(Jr.min())?(i.zi(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.Ki(e,c),a=a.nt(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),c.isEqual(Jr.min())||(t=h.mi.qi(o).next(function(t){return h.mi.Xi(o,o.Qi,c)}),s.push(t)),ja.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ri.qn(o,a)})}).then(function(t){return h._i=l,t})},vu.ji=function(t,e,n){return Cr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},vu.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ja.forEach(c,function(e){return ja.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return ja.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!su(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},vu.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},vu.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ri.Nn(t,e)})},vu.prototype.rr=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.mi.or(e,r).next(function(t){return t?(n=t,ja.resolve(n)):i.mi.hr(e).next(function(t){return n=new Ai(r,t,0,e.Qi),i.mi.ar(e,n).next(function(){return n})})})}).then(function(t){var e=i._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i._i=i._i.nt(t.targetId,t),i.fi.set(r,t.targetId)),t})},vu.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?ja.resolve(this._i.get(n)):this.mi.or(t,e)},vu.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,r,i=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!su(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},vu.prototype.cr=function(t,n){var r=this,i=Jr.min(),o=Gi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.or(e,aa(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.mi.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.li.Bn(e,t,n?i:Jr.min(),n?o:Gi())}).next(function(t){return{documents:t,_r:o}})})},vu.prototype.Ni=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=ja.resolve();return n.forEach(function(r){a=a.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Cr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.Ki(e,i.In)})}),a.next(function(){return e.Fn.Li(t,s)})},vu.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},vu);function vu(t,e,n){this.persistence=t,this.li=e,this._i=new Di(Mr),this.fi=new Qr(vi,gi),this.di=Jr.min(),this.Fn=t.wi(n),this.Ti=t.Ei(),this.mi=t.Ii(),this.Ri=new qa(this.Ti,this.Fn,this.persistence.Ai()),this.li.Pi(this.Ri)}function gu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Yr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}yu.Ji=3e8;var mu=(Eu.prototype._=function(){return this.Tr._()},Eu.prototype.tr=function(t,e){var n=new wu(t,e);this.Tr=this.Tr.add(n),this.mr=this.mr.add(n)},Eu.prototype.Rr=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},Eu.prototype.er=function(t,e){this.Ar(new wu(t,e))},Eu.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},Eu.prototype.Vr=function(t){var e=this,n=new ri(new ti([])),r=new wu(n,t),i=new wu(n,t+1),o=[];return this.mr.bt([r,i],function(t){e.Ar(t),o.push(t.key)}),o},Eu.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Ar(t)})},Eu.prototype.Ar=function(t){this.Tr=this.Tr.delete(t),this.mr=this.mr.delete(t)},Eu.prototype.yr=function(t){var e=new ri(new ti([])),n=new wu(e,t),r=new wu(e,t+1),i=Gi();return this.mr.bt([n,r],function(t){i=i.add(t.key)}),i},Eu.prototype.gr=function(t){var e=new wu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},Eu),wu=(bu.Er=function(t,e){return ri.P(t.key,e.key)||Mr(t.vr,e.vr)},bu.Ir=function(t,e){return Mr(t.vr,e.vr)||ri.P(t.key,e.key)},bu);function bu(t,e){this.key=t,this.vr=e}function Eu(){this.Tr=new Vi(wu.Er),this.mr=new Vi(wu.Ir)}function Iu(t,e){if(0!==e.length)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Bu(e.length,"argument")+".")}function Tu(t,e,n){if(e.length!==n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires "+Bu(n,"argument")+", but was called with "+Bu(e.length,"argument")+".")}function Au(t,e,n){if(e.length<n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Bu(n,"argument")+", but was called with "+Bu(e.length,"argument")+".")}function Nu(t,e,n,r){if(e.length<n||e.length>r)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Bu(e.length,"argument")+".")}function _u(t,e,n,r){Pu(t,e,Fu(n)+" argument",r)}function Ru(t,e,n,r){void 0!==r&&_u(t,e,n,r)}function Du(t,e,n,r){Pu(t,e,n+" option",r)}function Su(t,e,n,r){void 0!==r&&Du(t,e,n,r)}function Ou(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Cu(s))}var a=Cu(n);throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Lu(t,e,n,r){if(!e.some(function(t){return t===r}))throw new $r(Yr.INVALID_ARGUMENT,"Invalid value "+Cu(r)+" provided to function "+t+"() for its "+Fu(n)+" argument. Acceptable values: "+e.join(", "));return r}function Pu(t,e,n,r){if(!("object"===e?ku(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Cu(r);throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function ku(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Cu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Vu(t,e,n){if(void 0===n)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Fu(e)+" argument, but it was undefined.")}function Uu(n,t,r){Gr(t,function(t,e){if(r.indexOf(t)<0)throw new $r(Yr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Mu(t,e,n,r){var i=Cu(r);return new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Fu(n)+" argument to be a "+e+", but it was: "+i)}function xu(t,e,n){if(n<=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Fu(e)+" argument to be a positive number, but it was: "+n+".")}function Fu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Bu(t,e){return t+" "+e+(1===t?"":"s")}function ju(){if("undefined"==typeof Uint8Array)throw new $r(Yr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qu(){if("undefined"==typeof atob)throw new $r(Yr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Gu,zu,Wu=(Zu.fromBase64String=function(t){Tu("Blob.fromBase64String",arguments,1),_u("Blob.fromBase64String","string",1,t),qu();try{return new Zu(wi.fromBase64String(t))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Zu.fromUint8Array=function(t){if(Tu("Blob.fromUint8Array",arguments,1),ju(),!(t instanceof Uint8Array))throw Mu("Blob.fromUint8Array","Uint8Array",1,t);return new Zu(wi.fromUint8Array(t))},Zu.prototype.toBase64=function(){return Tu("Blob.toBase64",arguments,0),qu(),this.br.toBase64()},Zu.prototype.toUint8Array=function(){return Tu("Blob.toUint8Array",arguments,0),ju(),this.br.toUint8Array()},Zu.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Zu.prototype.isEqual=function(t){return this.br.isEqual(t.br)},Zu),Xu=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $r(Yr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(_u("FieldPath","string",e,t[e]),0===t[e].length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Sr=new ni(t)},Hu=(n(Ju,zu=Xu),Ju.documentId=function(){return new Ju(ni.M().$())},Ju.prototype.isEqual=function(t){if(!(t instanceof Ju))throw Mu("isEqual","FieldPath",1,t);return this.Sr.isEqual(t.Sr)},Ju),Qu=new RegExp("[~\\*/\\[\\]]"),Yu=function(){this.Cr=this},$u=(n(Ku,Gu=Yu),Ku.prototype.Fr=function(t){if(2!==t.$r)throw 1===t.$r?t.Nr(this.Dr+"() can only appear at the top level of your update data"):t.Nr(this.Dr+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},Ku.prototype.isEqual=function(t){return t instanceof Ku},Ku);function Ku(t){var e=this;return(e=Gu.call(this)||this).Dr=t,e}function Ju(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return zu.call(this,t)||this}function Zu(t){qu(),this.br=t}function th(t,e,n){return new Sh({$r:3,kr:e.settings.kr,methodName:t.Dr,xr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var eh,nh,rh,ih,oh,sh,ah=(n(bh,sh=Yu),bh.prototype.Fr=function(t){return new fs(t.path,new Jo)},bh.prototype.isEqual=function(t){return t instanceof bh},bh),uh=(n(wh,oh=Yu),wh.prototype.Fr=function(t){var e=th(this,t,!0),n=this.Or.map(function(t){return Mh(t,e)}),r=new Zo(n);return new fs(t.path,r)},wh.prototype.isEqual=function(t){return this===t},wh),hh=(n(mh,ih=Yu),mh.prototype.Fr=function(t){var e=th(this,t,!0),n=this.Or.map(function(t){return Mh(t,e)}),r=new is(n);return new fs(t.path,r)},mh.prototype.isEqual=function(t){return this===t},mh),ch=(n(gh,rh=Yu),gh.prototype.Fr=function(t){var e=new us(t.serializer,Co(t.serializer,this.Lr));return new fs(t.path,e)},gh.prototype.isEqual=function(t){return this===t},gh),lh=(n(vh,nh=Yu),vh.delete=function(){return Iu("FieldValue.delete",arguments),new fh(new $u("FieldValue.delete"))},vh.serverTimestamp=function(){return Iu("FieldValue.serverTimestamp",arguments),new fh(new ah("FieldValue.serverTimestamp"))},vh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Au("FieldValue.arrayUnion",arguments,1),new fh(new uh("FieldValue.arrayUnion",t))},vh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Au("FieldValue.arrayRemove",arguments,1),new fh(new hh("FieldValue.arrayRemove",t))},vh.increment=function(t){return _u("FieldValue.increment","number",1,t),Tu("FieldValue.increment",arguments,1),new fh(new ch("FieldValue.increment",t))},vh),fh=(n(yh,eh=lh),yh.prototype.Fr=function(t){return this.Cr.Fr(t)},yh.prototype.isEqual=function(t){return t instanceof yh&&this.Cr.isEqual(t.Cr)},yh),ph=(Object.defineProperty(dh.prototype,"latitude",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Object.defineProperty(dh.prototype,"longitude",{get:function(){return this.qr},enumerable:!1,configurable:!0}),dh.prototype.isEqual=function(t){return this.Mr===t.Mr&&this.qr===t.qr},dh.prototype.T=function(t){return Mr(this.Mr,t.Mr)||Mr(this.qr,t.qr)},dh);function dh(t,e){if(Tu("GeoPoint",arguments,2),_u("GeoPoint","number",1,t),_u("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $r(Yr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $r(Yr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Mr=t,this.qr=e}function yh(t){var e=this;return(e=eh.call(this)||this).Cr=t,e.Dr=t.Dr,e}function vh(){return nh.call(this)||this}function gh(t,e){var n=this;return(n=rh.call(this)||this).Dr=t,n.Lr=e,n}function mh(t,e){var n=this;return(n=ih.call(this)||this).Dr=t,n.Or=e,n}function wh(t,e){var n=this;return(n=oh.call(this)||this).Dr=t,n.Or=e,n}function bh(t){var e=this;return(e=sh.call(this)||this).Dr=t,e}function Eh(t){return new Lo(t,!0)}var Ih=/^__.*__$/,Th=function(t,e,n){this.Ur=t,this.Br=e,this.Wr=n},Ah=(Rh.prototype.Qr=function(t,e){var n=[];return null!==this.Me?n.push(new Rs(t,this.data,this.Me,e)):n.push(new _s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},Rh),Nh=(_h.prototype.Qr=function(t,e){var n=[new Rs(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new Ps(t,this.fieldTransforms)),n},_h);function _h(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Rh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Dh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Sh=(Object.defineProperty(Ph.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ph.prototype,"$r",{get:function(){return this.settings.$r},enumerable:!1,configurable:!0}),Ph.prototype.Gr=function(t){return new Ph(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},Ph.prototype.zr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.Kr(t),r},Ph.prototype.Hr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.jr(),r},Ph.prototype.Yr=function(t){return this.Gr({path:void 0,xr:!0})},Ph.prototype.Nr=function(t){return Gh(t,this.settings.methodName,this.settings.Xr||!1,this.path,this.settings.kr)},Ph.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},Ph.prototype.jr=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Kr(this.path.get(t))},Ph.prototype.Kr=function(t){if(0===t.length)throw this.Nr("Document fields must not be empty");if(Dh(this.$r)&&Ih.test(t))throw this.Nr('Document fields cannot begin and end with "__"')},Ph),Oh=(Lh.prototype.Jr=function(t,e,n,r){return void 0===r&&(r=!1),new Sh({$r:t,methodName:e,kr:n,path:ni.k(),xr:!1,Xr:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Lh);function Lh(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Eh(t)}function Ph(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.jr(),this.fieldTransforms=i||[],this.Me=o||[]}function kh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Jr(o.merge||o.mergeFields?2:0,e,n,i);Bh("Data must be an object, but it was:",s,r);var a,u,h=xh(r,s);if(o.merge)a=new ps(s.Me),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Xu)d=p.Sr;else{if("string"!=typeof p)throw kr();d=qh(e,p,n)}if(!s.contains(d))throw new $r(Yr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");zh(c,d)||c.push(d)}a=new ps(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Ah(new Fs(h),a,u)}function Ch(t,o,s,e){var a=t.Jr(1,o,s);Bh("Data must be an object, but it was:",a,e);var u=[],h=new Bs;Gr(e,function(t,e){var n,r=qh(o,t,s),i=a.Hr(r);e instanceof Yu&&e.Cr instanceof $u?u.push(r):null!=(n=Mh(e,i))&&(u.push(r),h.set(r,n))});var n=new ps(u);return new Nh(h.ze(),n,a.fieldTransforms)}function Vh(t,e,n,r,i,o){var s=t.Jr(1,e,n),a=[jh(e,r,n)],u=[i];if(o.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(jh(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new Bs,v=a.length-1;0<=v;--v){zh(d,a[v])||(c=a[v],l=u[v],f=s.Hr(c),l instanceof Yu&&l.Cr instanceof $u?d.push(c):null!=(p=Mh(l,f))&&(d.push(c),y.set(c,p)))}var g=new ps(d);return new Nh(y.ze(),g,s.fieldTransforms)}function Uh(t,e,n,r){return void 0===r&&(r=!1),Mh(n,t.Jr(r?4:3,e))}function Mh(s,t){if(Fh(s))return Bh("Unsupported field value:",t,s),xh(s,t);if(s instanceof Yu)return function(t,e){if(!Dh(e.$r))throw e.Nr(t.Dr+"() can only be used with update() and set()");if(!e.path)throw e.Nr(t.Dr+"() is not currently supported inside arrays");var n=t.Fr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.xr&&4!==t.$r)throw t.Nr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Mh(i[r],t.Yr(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Kr.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Kr){var r=new Kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof ph)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wu)return{bytesValue:Uo(e.serializer,t)};if(t instanceof Th){var i=e.s,o=t.Ur;if(!o.isEqual(i))throw e.Nr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:xo(t.Ur||e.s,t.Br.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nr("Unsupported field value: "+Cu(t))}(s,t)}function xh(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Me.push(r.path):Gr(t,function(t,e){var n=Mh(e,r.zr(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Fh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Kr||t instanceof ph||t instanceof Wu||t instanceof Th||t instanceof Yu)}function Bh(t,e,n){if(!Fh(n)||!ku(n)){var r=Cu(n);throw"an object"===r?e.Nr(t+" a custom object"):e.Nr(t+" "+r)}}function jh(t,e,n){if(e instanceof Xu)return e.Sr;if("string"==typeof e)return qh(t,e);throw Gh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function qh(t,e,n){try{return function(e){if(0<=e.search(Qu))throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Hu.bind.apply(Hu,v([void 0],e.split("."))))}catch(t){throw new $r(Yr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Sr}catch(e){throw Gh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Gh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new $r(Yr.INVALID_ARGUMENT,(a+=". ")+t+u)}function zh(t,e){return t.some(function(t){return t.isEqual(e)})}var Wh=(Xh.prototype.Zr=function(){return null!=this.uid},Xh.prototype.to=function(){return this.Zr()?"uid:"+this.uid:"anonymous-user"},Xh.prototype.isEqual=function(t){return t.uid===this.uid},Xh);function Xh(t){this.uid=t}Wh.UNAUTHENTICATED=new Wh(null),Wh.eo=new Wh("google-credentials-uid"),Wh.no=new Wh("first-party-uid");function Hh(t,e){this.user=e,this.type="OAuth",this.so={},this.so.Authorization="Bearer "+t}function Qh(t){this.key=t}function Yh(t){this.key=t}function $h(t,e,n){this.query=t,this.targetId=e,this.view=n}function Kh(t){this.key=t,this.ja=!1}function Jh(){this.pu=void 0,this.listeners=[]}var Zh,tc,ec,nc,rc=(zc.prototype.getToken=function(){return Promise.resolve(null)},zc.prototype.ro=function(){},zc.prototype.oo=function(t){(this.io=t)(Wh.UNAUTHENTICATED)},zc.prototype.ho=function(){this.io=null},zc),ic=(Gc.prototype.getToken=function(){var e=this,n=this.co,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.co!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Hh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Gc.prototype.ro=function(){this.forceRefresh=!0},Gc.prototype.oo=function(t){this.io=t,this.uo&&t(this.currentUser)},Gc.prototype.ho=function(){this.auth&&this.auth.removeAuthTokenListener(this.ao),this.ao=null,this.io=null},Gc.prototype.lo=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Wh(t)},Gc),oc=(Object.defineProperty(qc.prototype,"so",{get:function(){var t={"X-Goog-AuthUser":this.fo},e=this._o.auth.do([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),qc),sc=(jc.prototype.getToken=function(){return Promise.resolve(new oc(this._o,this.fo))},jc.prototype.oo=function(t){t(Wh.no)},jc.prototype.ho=function(){},jc.prototype.ro=function(){},jc),ac=(Bc.prototype.Ro=function(){return 1===this.state||2===this.state||4===this.state},Bc.prototype.Ao=function(){return 2===this.state},Bc.prototype.start=function(){3!==this.state?this.auth():this.Po()},Bc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Bc.prototype.Vo=function(){this.state=0,this.Ls.reset()},Bc.prototype.po=function(){var t=this;this.Ao()&&null===this.Io&&(this.Io=this.ss.ws(this.wo,6e4,function(){return t.yo()}))},Bc.prototype.vo=function(t){this.bo(),this.stream.send(t)},Bc.prototype.yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ao()?[2,this.close(0)]:[2]})})},Bc.prototype.bo=function(){this.Io&&(this.Io.cancel(),this.Io=null)},Bc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.bo(),this.Ls.cancel(),this.mo++,3!==e?this.Ls.reset():n&&n.code===Yr.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Ls._s()):n&&n.code===Yr.UNAUTHENTICATED&&this.Eo.ro(),null!==this.stream&&(this.So(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Co(n)];case 1:return t.sent(),[2]}})})},Bc.prototype.So=function(){},Bc.prototype.auth=function(){var n=this;this.state=1;var t=this.Do(this.mo),e=this.mo;this.Eo.getToken().then(function(t){n.mo===e&&n.Fo(t)},function(e){t(function(){var t=new $r(Yr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.$o(t)})})},Bc.prototype.Fo=function(t){var e=this,n=this.Do(this.mo);this.stream=this.No(t),this.stream.ko(function(){n(function(){return e.state=2,e.listener.ko()})}),this.stream.Co(function(t){n(function(){return e.$o(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Bc.prototype.Po=function(){var t=this;this.state=4,this.Ls.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Bc.prototype.$o=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Bc.prototype.Do=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.mo===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Bc),uc=(n(Fc,ec=ac),Fc.prototype.No=function(t){return this.To.xo("Listen",t)},Fc.prototype.onMessage=function(t){this.Ls.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:kr(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Le?(Cr(void 0===i||"string"==typeof i),wi.fromBase64String(i||"")):(Cr(void 0===i||i instanceof Uint8Array),wi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?Yr.UNKNOWN:Ri(n.code),new $r(r,n.message||"")),l=new Hi(s,a,u,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=Bo(t,f.document.name),d=Mo(f.document.updateTime),y=new Fs({mapValue:{fields:f.document.fields}}),v=new Ys(p,d,y,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new Wi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=Bo(t,w.document),E=w.readTime?Mo(w.readTime):Jr.min(),I=new $s(b,E),T=w.removedTargetIds||[];l=new Wi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=Bo(t,A.document),_=A.removedTargetIds||[];l=new Wi([],_,N,null)}else{if(!("filter"in e))return kr();e.filter;var R=e.filter;R.targetId;var D=R.count||0,S=new Ei(D),O=R.targetId;l=new Xi(O,S)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Jr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Jr.min():Mo(e.readTime)}(t);return this.listener.Oo(e,n)},Fc.prototype.Lo=function(t){var e,n,r,i,o={};o.database=qo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=mi(i)?{documents:{documents:[jo(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=jo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=jo(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof ga?function(t){if("=="===t.op){if(Ro(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NAN"}};if(_o(t.value))return{unaryFilter:{field:Xo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Xo(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e}(t):kr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Xo((e=t).field),direction:(n=e.dir,So[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Le||fi(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Wo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Uo(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.vo(o)},Fc.prototype.Mo=function(t){var e={};e.database=qo(this.serializer),e.removeTarget=t,this.vo(e)},Fc),hc=(n(xc,tc=ac),Object.defineProperty(xc.prototype,"Uo",{get:function(){return this.qo},enumerable:!1,configurable:!0}),xc.prototype.start=function(){this.qo=!1,this.lastStreamToken=void 0,tc.prototype.start.call(this)},xc.prototype.So=function(){this.qo&&this.Bo([])},xc.prototype.No=function(t){return this.To.xo("Write",t)},xc.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.qo){this.Ls.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Cr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(Jr.min())&&(n=Mo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new ys(n,r)}(t,i)})):[]),n=Mo(t.commitTime);return this.listener.Wo(n,e)}var r,i;return Cr(!t.writeResults||0===t.writeResults.length),this.qo=!0,this.listener.Qo()},xc.prototype.jo=function(){var t={};t.database=qo(this.serializer),this.vo(t)},xc.prototype.Bo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.vo(n)},xc),cc=(n(Mc,Zh=function(){}),Mc.prototype.zo=function(){if(this.Go)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},Mc.prototype.start=function(t){this.To=t},Mc.prototype.Ko=function(e,n){var r=this;return this.zo(),this.credentials.getToken().then(function(t){return r.To.Ko(e,n,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&r.credentials.ro(),t})},Mc.prototype.Ho=function(e,n){var r=this;return this.zo(),this.credentials.getToken().then(function(t){return r.To.Ho(e,n,t)}).catch(function(t){throw t.code===Yr.UNAUTHENTICATED&&r.credentials.ro(),t})},Mc.prototype.Yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Go=!1,[2]})})},Mc),lc=(Uc.prototype.nh=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.sh(),0<this.mutations.length)throw new $r(Yr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return d(this,void 0,void 0,function(){var i,e,n,o,r;return y(this,function(t){switch(t.label){case 0:return e={database:qo((i=s).serializer),documents:a.map(function(t){return Fo(i.serializer,t)})},[4,i.Ho("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),r=Mo(e.found.updateTime),i=new Fs({mapValue:{fields:e.found.fields}});return new Ys(n,r,i,{})}(e,n):"missing"in n?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);var n=Bo(t,e.missing),r=Mo(e.readTime);return new $s(n,r)}(e,n):kr());o.set(r.key.toString(),r)}),r=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Cr(!!e),r.push(e)}),r)]}})})}(this.Xo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof $s||t instanceof Ys?n.ih(t):kr()}),e)]}})})},Uc.prototype.set=function(t,e){this.write(e.Qr(t,this.Be(t))),this.eh.add(t)},Uc.prototype.update=function(t,e){try{this.write(e.Qr(t,this.rh(t)))}catch(t){this.th=t}this.eh.add(t)},Uc.prototype.delete=function(t){this.write([new Ms(t,this.Be(t))]),this.eh.add(t)},Uc.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:if(this.sh(),this.th)throw this.th;return e=this.Jo,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ri(ti.N(e));r.mutations.push(new xs(n,r.Be(n)))}),[4,function(r,i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return n={database:qo((e=r).serializer),writes:i.map(function(t){return zo(e.serializer,t)})},[4,e.Ko("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Xo,this.mutations)];case 1:return t.sent(),this.Zo=!0,[2]}})})},Uc.prototype.ih=function(t){var e;if(t instanceof Ys)e=t.version;else{if(!(t instanceof $s))throw kr();e=Jr.min()}var n=this.Jo.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $r(Yr.ABORTED,"Document version changed between two reads.")}else this.Jo.set(t.key.toString(),e)},Uc.prototype.Be=function(t){var e=this.Jo.get(t.toString());return!this.eh.has(t)&&e?vs.updateTime(e):vs.je()},Uc.prototype.rh=function(t){var e=this.Jo.get(t.toString());if(this.eh.has(t)||!e)return vs.exists(!0);if(e.isEqual(Jr.min()))throw new $r(Yr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)},Uc.prototype.write=function(t){this.sh(),this.mutations=this.mutations.concat(t)},Uc.prototype.sh=function(){},Uc),fc=(Vc.prototype.lh=function(){var t=this;0===this.hh&&(this._h("Unknown"),this.ah=this.Vs.ws("online_state_timeout",1e4,function(){return t.ah=null,t.fh("Backend didn't respond within 10 seconds."),t._h("Offline"),Promise.resolve()}))},Vc.prototype.dh=function(t){"Online"===this.state?this._h("Unknown"):(this.hh++,1<=this.hh&&(this.wh(),this.fh("Connection failed 1 times. Most recent error: "+t.toString()),this._h("Offline")))},Vc.prototype.set=function(t){this.wh(),this.hh=0,"Online"===t&&(this.uh=!1),this._h(t)},Vc.prototype._h=function(t){t!==this.state&&(this.state=t,this.oh(t))},Vc.prototype.fh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.uh?(Lr(e),this.uh=!1):Or("OnlineStateTracker",e)},Vc.prototype.wh=function(){null!==this.ah&&(this.ah.cancel(),this.ah=null)},Vc),pc=(Cc.prototype.start=function(){return this.enableNetwork()},Cc.prototype.enableNetwork=function(){return this.Rh.delete(0),this.Nh()},Cc.prototype.Nh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vh()?(this.kh()?this.xh():this.yh.set("Unknown"),[4,this.Oh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rh.add(0),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Offline"),[2]}})})},Cc.prototype.Lh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Ch.stop()];case 1:return t.sent(),[4,this.gh.stop()];case 2:return t.sent(),0<this.Eh.length&&(Or("RemoteStore","Stopping write stream with "+this.Eh.length+" pending writes"),this.Eh=[]),this.Mh(),[2]}})})},Cc.prototype.qh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Or("RemoteStore","RemoteStore shutting down."),this.Rh.add(5),[4,this.Lh()];case 1:return t.sent(),this.Ah.qh(),this.yh.set("Unknown"),[2]}})})},Cc.prototype.listen=function(t){this.mh.has(t.targetId)||(this.mh.set(t.targetId,t),this.kh()?this.xh():this.gh.Ao()&&this.Uh(t))},Cc.prototype.Bh=function(t){this.mh.delete(t),this.gh.Ao()&&this.Wh(t),0===this.mh.size&&(this.gh.Ao()?this.gh.po():this.Vh()&&this.yh.set("Unknown"))},Cc.prototype.Oe=function(t){return this.mh.get(t)||null},Cc.prototype.xe=function(t){return this.Qh.xe(t)},Cc.prototype.Uh=function(t){this.Ih.de(t.targetId),this.gh.Lo(t)},Cc.prototype.Wh=function(t){this.Ih.de(t),this.gh.Mo(t)},Cc.prototype.xh=function(){this.Ih=new to(this),this.gh.start(),this.yh.lh()},Cc.prototype.kh=function(){return this.Vh()&&!this.gh.Ro()&&0<this.mh.size},Cc.prototype.Vh=function(){return 0===this.Rh.size},Cc.prototype.Mh=function(){this.Ih=null},Cc.prototype.vh=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.mh.forEach(function(t,e){n.Uh(t)}),[2]})})},Cc.prototype.bh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Mh(),this.kh()?(this.yh.dh(e),this.xh()):this.yh.set("Unknown"),[2]})})},Cc.prototype.Sh=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.yh.set("Online"),!(i instanceof Hi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.jh(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Gh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Wi?this.Ih.Pe(i):i instanceof Xi?this.Ih.Ce(i):this.Ih.ye(i),o.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Th.qi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.zh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Gh(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Cc.prototype.Gh=function(n,r){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!su(n))throw n;return this.Rh.add(1),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Offline"),r=r||function(){return e.Th.qi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Rh.delete(1),[4,this.Nh()];case 2:return t.sent(),[2]}})})}),[2]}})})},Cc.prototype.Kh=function(e){var n=this;return e().catch(function(t){return n.Gh(t,e)})},Cc.prototype.zh=function(r){var i=this,t=this.Ih.$e(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.mh.get(e))&&i.mh.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.mh.get(t);n&&(i.mh.set(t,n.tt(wi.Y,n.J)),i.Wh(t),e=new Ai(n.target,t,1,n.sequenceNumber),i.Uh(e))}),this.Qh.Ui(t)},Cc.prototype.jh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.mh.has(i)?[4,this.Qh.Hh(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.mh.delete(i),this.Ih.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Cc.prototype.Oh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=0<this.Eh.length?this.Eh[this.Eh.length-1].batchId:-1,t.label=1;case 1:if(!this.Yh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.Th.nr(e)];case 3:return null===(n=t.sent())?(0===this.Eh.length&&this.Ch.po(),[3,7]):(e=n.batchId,this.Xh(n),[3,6]);case 4:return r=t.sent(),[4,this.Gh(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Jh()&&this.Zh(),[2]}})})},Cc.prototype.Yh=function(){return this.Vh()&&this.Eh.length<10},Cc.prototype.ta=function(){return this.Eh.length},Cc.prototype.Xh=function(t){this.Eh.push(t),this.Ch.Ao()&&this.Ch.Uo&&this.Ch.Bo(t.mutations)},Cc.prototype.Jh=function(){return this.Vh()&&!this.Ch.Ro()&&0<this.Eh.length},Cc.prototype.Zh=function(){this.Ch.start()},Cc.prototype.Dh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ch.jo(),[2]})})},Cc.prototype.$h=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){for(e=0,n=this.Eh;e<n.length;e++)r=n[e],this.Ch.Bo(r.mutations);return[2]})})},Cc.prototype.Wo=function(i,o){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Eh.shift(),n=Ba.from(e,i,o),[4,this.Kh(function(){return r.Qh.ea(n)})];case 1:return t.sent(),[4,this.Oh()];case 2:return t.sent(),[2]}})})},Cc.prototype.Fh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Ch.Uo?[4,this.na(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Jh()&&this.Zh(),[2]}})})},Cc.prototype.na=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return _i(n=i.code)&&n!==Yr.ABORTED?(e=this.Eh.shift(),this.Ch.Vo(),[4,this.Kh(function(){return r.Qh.sa(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Oh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Cc.prototype.ia=function(){return new lc(this.Xo)},Cc.prototype.ph=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rh.add(4),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Unknown"),this.Ch.Vo(),this.gh.Vo(),this.Rh.delete(4),[4,this.Nh()];case 2:return t.sent(),[2]}})})},Cc.prototype.ra=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Or("RemoteStore","RemoteStore received new credentials"),this.Rh.add(3),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Unknown"),[4,this.Qh.ra(e)];case 2:return t.sent(),this.Rh.delete(3),[4,this.Nh()];case 3:return t.sent(),[2]}})})},Cc.prototype.oa=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Rh.delete(2),[4,this.Nh()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Rh.add(2),[4,this.Lh()]);case 3:t.sent(),this.yh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Cc),dc=(kc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},kc.prototype.aa=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},kc.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},kc),yc=(Pc.prototype._a=function(t){},Pc.prototype.fa=function(t,e,n){},Pc.prototype.da=function(t){return this.ca.ha(t),this.la[t]||"not-current"},Pc.prototype.wa=function(t,e,n){this.la[t]=e},Pc.prototype.Ta=function(t){this.ca.aa(t)},Pc.prototype.Ea=function(t){return this.ca.activeTargetIds.has(t)},Pc.prototype.ma=function(t){delete this.la[t]},Pc.prototype.Ia=function(){return this.ca.activeTargetIds},Pc.prototype.Ra=function(t){return this.ca.activeTargetIds.has(t)},Pc.prototype.start=function(){return this.ca=new dc,Promise.resolve()},Pc.prototype.Vi=function(t,e,n){},Pc.prototype.Aa=function(t){},Pc.prototype.qh=function(){},Pc.prototype.es=function(t){},Pc),vc=(Object.defineProperty(Lc.prototype,"va",{get:function(){return this.Pa},enumerable:!1,configurable:!0}),Lc.prototype.ba=function(t,e){var a=this,u=e?e.Sa:new Yi,h=e?e.ga:this.ga,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof Ys?e:null)&&(da(a.query,r)?r:null),i=!!n&&a.Mt.has(n.key),o=!!r&&(r.Ge||a.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.Ca(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.ya(r,p)||d&&a.ya(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ga:l,Sa:u,Da:f,Mt:c}},Lc.prototype.Ca=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Lc.prototype.Fa=function(t,e,n){var o=this,r=this.ga;this.ga=t.ga,this.Mt=t.Mt;var i=t.Sa.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ya(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.$a(n);var s=e?this.Na():[],a=0===this.pa.size&&this.Ht?1:0,u=a!==this.Va;return this.Va=a,0!==i.length||u?{snapshot:new $i(this.query,t.ga,r,i,t.Mt,0==a,u,!1),ka:s}:{ka:s}},Lc.prototype.xa=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Fa({ga:this.ga,Sa:new Yi,Mt:this.Mt,Da:!1},!1)):{ka:[]}},Lc.prototype.Oa=function(t){return!this.Pa.has(t)&&!!this.ga.has(t)&&!this.ga.get(t).Ge},Lc.prototype.$a=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Pa=e.Pa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Pa=e.Pa.delete(t)}),this.Ht=t.Ht)},Lc.prototype.Na=function(){var e=this;if(!this.Ht)return[];var n=this.pa;this.pa=Gi(),this.ga.forEach(function(t){e.Oa(t.key)&&(e.pa=e.pa.add(t.key))});var r=[];return n.forEach(function(t){e.pa.has(t)||r.push(new Yh(t))}),this.pa.forEach(function(t){n.has(t)||r.push(new Qh(t))}),r},Lc.prototype.La=function(t){this.Pa=t._r,this.pa=Gi();var e=this.ba(t.documents);return this.Fa(e,!0)},Lc.prototype.Ma=function(){return $i.Bt(this.query,this.ga,this.Mt,0===this.Va)},Lc),gc=(Oc.prototype.run=function(){this.Ua()},Oc.prototype.Ua=function(){var t=this;this.Ls.fs(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new lc(this.Xo),(n=this.Ba(e))&&n.then(function(t){r.Vs.Cs(function(){return e.commit().then(function(){r.gs.resolve(t)}).catch(function(t){r.Wa(t)})})}).catch(function(t){r.Wa(t)}),[2]})})})},Oc.prototype.Ba=function(t){try{var e=this.updateFunction(t);return!fi(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},Oc.prototype.Wa=function(t){var e=this;0<this.qa&&this.Qa(t)?(--this.qa,this.Vs.Cs(function(){return e.Ua(),Promise.resolve()})):this.gs.reject(t)},Oc.prototype.Qa=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!_i(e)},Oc),mc=(Object.defineProperty(Sc.prototype,"ou",{get:function(){return!0===this.ru},enumerable:!1,configurable:!0}),Sc.prototype.subscribe=function(t){this.Ha=t},Sc.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.hu("listen()"),(r=this.Ya.get(s))?(e=r.targetId,this.za.da(e),n=r.view.Ma(),[3,4]):[3,1];case 1:return[4,this.Th.rr(aa(s))];case 2:return i=t.sent(),o=this.za.da(i.targetId),e=i.targetId,[4,this.au(s,e,"current"===o)];case 3:n=t.sent(),this.ou&&this.Ga.listen(i),t.label=4;case 4:return[2,n]}})})},Sc.prototype.au=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.Th.cr(a,!0)];case 1:return e=t.sent(),n=new vc(a,e._r),r=n.ba(e.documents),i=Ji.Kt(u,h&&"Offline"!==this.onlineState),o=n.Fa(r,this.ou,i),this.uu(u,o.ka),s=new $h(a,u,n),[2,(this.Ya.set(a,s),this.Xa.has(u)?this.Xa.get(u).push(a):this.Xa.set(u,[a]),o.snapshot)]}})})},Sc.prototype.Bh=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.hu("unlisten()"),e=this.Ya.get(i),1<(n=this.Xa.get(e.targetId)).length?[2,(this.Xa.set(e.targetId,n.filter(function(t){return!la(t,i)})),void this.Ya.delete(i))]:this.ou?(this.za.Ta(e.targetId),this.za.Ra(e.targetId)?[3,2]:[4,this.Th.ur(e.targetId,!1).then(function(){r.za.ma(e.targetId),r.Ga.Bh(e.targetId),r.cu(e.targetId)}).catch(gu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.cu(e.targetId),[4,this.Th.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Sc.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.hu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Th.bi(i)];case 2:return e=t.sent(),this.za._a(e.batchId),this.lu(e.batchId,o),[4,this._u(e.Ci)];case 3:return t.sent(),[4,this.Ga.Oh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=fu(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Sc.prototype.runTransaction=function(t,e,n){new gc(t,this.Xo,e,n).run()},Sc.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.hu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.tu.get(e);n&&(Cr(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.ja=!0:0<t.Xt.size?Cr(n.ja):0<t.Jt.size&&(Cr(n.ja),n.ja=!1))}),[4,this._u(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sc.prototype.xa=function(r,t){var i;(this.ou&&0===t||!this.ou&&1===t)&&(this.hu("applyOnlineStateChange()"),i=[],this.Ya.forEach(function(t,e){var n=e.view.xa(r);n.snapshot&&i.push(n.snapshot)}),this.Ha.fu(r),this.Ha.Oo(i),this.onlineState=r,this.ou&&this.za.Aa(r))},Sc.prototype.Hh=function(a,u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.hu("rejectListens()"),this.za.wa(a,"rejected",u),e=this.tu.get(a),(n=e&&e.key)?(r=(r=new Di(ri.P)).nt(n,new $s(n,Jr.min())),i=Gi().add(n),o=new Ki(Jr.min(),new Map,new Vi(Mr),r,i),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.Za=this.Za.remove(n),this.tu.delete(a),this.du(),[3,4];case 2:return[4,this.Th.ur(a,!1).then(function(){return s.cu(a,u)}).catch(gu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Sc.prototype.ea=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.hu("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.Di(r)];case 2:return n=t.sent(),this.wu(e,null),this.Tu(e),this.za.fa(e,"acknowledged"),[4,this._u(n)];case 3:return t.sent(),[3,6];case 4:return[4,gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sc.prototype.sa=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.hu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.xi(n)];case 2:return e=t.sent(),this.wu(n,r),this.Tu(n),this.za.fa(n,"rejected",r),[4,this._u(e)];case 3:return t.sent(),[3,6];case 4:return[4,gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sc.prototype.Eu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.Ga.Vh()||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Th.Mi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.su.get(e)||[]).push(o),this.su.set(e,n),[3,4]);case 3:return r=t.sent(),i=fu(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Sc.prototype.Tu=function(t){(this.su.get(t)||[]).forEach(function(t){t.resolve()}),this.su.delete(t)},Sc.prototype.mu=function(e){this.su.forEach(function(t){t.forEach(function(t){t.reject(new $r(Yr.CANCELLED,e))})}),this.su.clear()},Sc.prototype.lu=function(t,e){var n=this.nu[this.currentUser.to()];n=(n=n||new Di(Mr)).nt(t,e),this.nu[this.currentUser.to()]=n},Sc.prototype.wu=function(t,e){var n,r=this.nu[this.currentUser.to()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.nu[this.currentUser.to()]=r)},Sc.prototype.cu=function(t,e){var n=this;void 0===e&&(e=null),this.za.Ta(t);for(var r=0,i=this.Xa.get(t);r<i.length;r++){var o=i[r];this.Ya.delete(o),e&&this.Ha.Iu(o,e)}this.Xa.delete(t),this.ou&&this.eu.Vr(t).forEach(function(t){n.eu.gr(t)||n.Ru(t)})},Sc.prototype.Ru=function(t){var e=this.Za.get(t);null!==e&&(this.Ga.Bh(e),this.Za=this.Za.remove(t),this.tu.delete(e),this.du())},Sc.prototype.uu=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Qh?(this.eu.tr(i.key,t),this.Au(i)):i instanceof Yh?(Or("SyncEngine","Document no longer in limbo: "+i.key),this.eu.er(i.key,t),this.eu.gr(i.key)||this.Ru(i.key)):kr()}},Sc.prototype.Au=function(t){var e=t.key;this.Za.get(e)||(Or("SyncEngine","New document in limbo: "+e),this.Ja.push(e),this.du())},Sc.prototype.du=function(){for(;0<this.Ja.length&&this.Za.size<this.Ka;){var t=this.Ja.shift(),e=this.iu.next();this.tu.set(e,new Kh(t)),this.Za=this.Za.nt(t,e),this.Ga.listen(new Ai(aa(ia(t.path)),e,2,za.ns))}},Sc.prototype.Pu=function(){return this.Za},Sc.prototype.Vu=function(){return this.Ja},Sc.prototype._u=function(r,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ya.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.ba(r);return n.Da?a.Th.cr(i.query,!1).then(function(t){var e=t.documents;return i.view.ba(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(i.targetId),r=i.view.Fa(t,a.ou,n);a.uu(i.targetId,r.ka),r.snapshot&&(a.ou&&a.za.wa(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Ga.Xn(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Ha.Oo(o),[4,this.Th.Zi(s)];case 2:return t.sent(),[2]}})})},Sc.prototype.hu=function(t){},Sc.prototype.ra=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Or("SyncEngine","User change. New user:",n.to()),[4,this.Th.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.mu("'waitForPendingWrites' promise is rejected due to a user change."),this.za.Vi(n,e.gi,e.vi),[4,this._u(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Sc.prototype.xe=function(t){var e=this.tu.get(t);if(e&&e.ja)return Gi().add(e.key);var n=Gi(),r=this.Xa.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],a=this.Ya.get(s),n=n.Dt(a.view.va);return n},Sc),wc=(Dc.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(r=this.yu.get(e))||(n=!0,r=new Jh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Qh.listen(e)];case 2:return i.pu=t.sent(),[3,4];case 3:return o=t.sent(),s=fu(o,"Initialization of query '"+pa(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.yu.set(e,r),r.listeners.push(a),a.xa(this.onlineState),r.pu&&a.vu(r.pu)&&this.bu(),[2]}})})},Dc.prototype.Bh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.yu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.yu.delete(e),this.Qh.Bh(e))]:[2]})})},Dc.prototype.Oo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.yu.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].vu(i)&&(e=!0);s.pu=i}}e&&this.bu()},Dc.prototype.Iu=function(t,e){var n=this.yu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.yu.delete(t)},Dc.prototype.fu=function(i){this.onlineState=i;var o=!1;this.yu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xa(i)&&(o=!0)}),o&&this.bu()},Dc.prototype.Su=function(t){this.gu.add(t),t.next()},Dc.prototype.Cu=function(t){this.gu.delete(t)},Dc.prototype.bu=function(){this.gu.forEach(function(t){t.next()})},Dc),bc=(Rc.prototype.vu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Fu?this.Nu(t)&&(this.Du.next(t),o=!0):this.ku(t,this.onlineState)&&(this.xu(t),o=!0),this.$u=t,o},Rc.prototype.onError=function(t){this.Du.error(t)},Rc.prototype.xa=function(t){this.onlineState=t;var e=!1;return this.$u&&!this.Fu&&this.ku(this.$u,t)&&(this.xu(this.$u),e=!0),e},Rc.prototype.ku=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ou&&n||t.docs._()&&"Offline"!==e)},Rc.prototype.Nu=function(t){if(0<t.docChanges.length)return!0;var e=this.$u&&this.$u.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Rc.prototype.xu=function(t){t=$i.Bt(t.query,t.docs,t.Mt,t.fromCache),this.Fu=!0,this.Du.next(t)},Rc),Ec=(_c.prototype.Pi=function(t){this.Lu=t},_c.prototype.Bn=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Jr.min())?this.Mu(e,r):this.Lu.Mn(e,o).next(function(t){var n=s.qu(r,t);return(r.hn()||r.an())&&s.Da(r.en,n,o,i)?s.Mu(e,r):(Sr()<=p.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pa(r)),s.Lu.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},_c.prototype.qu=function(n,t){var r=new Vi(ya(n));return t.forEach(function(t,e){e instanceof Ys&&da(n,e)&&(r=r.add(e))}),r},_c.prototype.Da=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},_c.prototype.Mu=function(t,e){return Sr()<=p.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",pa(e)),this.Lu.Bn(t,e,Jr.min())},_c),Ic=(Nc.prototype.Wu=function(t){return ja.resolve(0===this.Fn.length)},Nc.prototype.Si=function(t,e,n,r){var i=this.Uu;this.Uu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Fa(i,e,n,r);this.Fn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Bu=this.Bu.add(new wu(u.key,i)),this.$n.Is(t,u.key.path.g())}return ja.resolve(o)},Nc.prototype.Oi=function(t,e){return ja.resolve(this.Qu(e))},Nc.prototype.sr=function(t,e){var n=e+1,r=this.ju(n),i=r<0?0:r;return ja.resolve(this.Fn.length>i?this.Fn[i]:null)},Nc.prototype.Mi=function(){return ja.resolve(0===this.Fn.length?-1:this.Uu-1)},Nc.prototype.pi=function(t){return ja.resolve(this.Fn.slice())},Nc.prototype.kn=function(t,e){var n=this,r=new wu(e,0),i=new wu(e,Number.POSITIVE_INFINITY),o=[];return this.Bu.bt([r,i],function(t){var e=n.Qu(t.vr);o.push(e)}),ja.resolve(o)},Nc.prototype.Un=function(t,e){var r=this,i=new Vi(Mr);return e.forEach(function(t){var e=new wu(t,0),n=new wu(t,Number.POSITIVE_INFINITY);r.Bu.bt([e,n],function(t){i=i.add(t.vr)})}),ja.resolve(this.Gu(i))},Nc.prototype.zn=function(t,e){var n=e.path,r=n.length+1,i=n;ri.W(i)||(i=i.child(""));var o=new wu(new ri(i),0),s=new Vi(Mr);return this.Bu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.vr)),!0)},o),ja.resolve(this.Gu(s))},Nc.prototype.Gu=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Qu(t);null!==e&&r.push(e)}),r},Nc.prototype.Li=function(n,r){var i=this;Cr(0===this.zu(r.batchId,"removed")),this.Fn.shift();var o=this.Bu;return ja.forEach(r.mutations,function(t){var e=new wu(t.key,r.batchId);return o=o.delete(e),i.Yi.Ku(n,t.key)}).next(function(){i.Bu=o})},Nc.prototype.Hu=function(t){},Nc.prototype.gr=function(t,e){var n=new wu(e,0),r=this.Bu.Ct(n);return ja.resolve(e.isEqual(r&&r.key))},Nc.prototype.ki=function(t){return this.Fn.length,ja.resolve()},Nc.prototype.zu=function(t,e){return this.ju(t)},Nc.prototype.ju=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},Nc.prototype.Qu=function(t){var e=this.ju(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},Nc),Tc=(Ac.prototype.Ki=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Yu(e);return this.docs=this.docs.nt(r,{Xu:e,size:s,readTime:n}),this.size+=s-o,this.$n.Is(t,r.path.g())},Ac.prototype.zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ac.prototype.On=function(t,e){var n=this.docs.get(e);return ja.resolve(n?n.Xu:null)},Ac.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Xu:null)}),ja.resolve(r)},Ac.prototype.Bn=function(t,e,n){for(var r=Bi,i=new ri(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u.Xu,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Ys&&da(e,h)&&(r=r.nt(h.key,h))}return ja.resolve(r)},Ac.prototype.Ju=function(t,e){return ja.forEach(this.docs,function(t){return e(t)})},Ac.prototype.Fi=function(t){return new Ac.Zu(this)},Ac.prototype.tc=function(t){return ja.resolve(this.size)},Ac);function Ac(t,e){this.$n=t,this.Yu=e,this.docs=new Di(ri.P),this.size=0}function Nc(t,e){this.$n=t,this.Yi=e,this.Fn=[],this.Uu=1,this.Bu=new Vi(wu.Er)}function _c(){}function Rc(t,e,n){this.query=t,this.Du=e,this.Fu=!1,this.$u=null,this.onlineState="Unknown",this.options=n||{}}function Dc(t){this.Qh=t,this.yu=new Qr(fa,la),this.onlineState="Unknown",this.gu=new Set,this.Qh.subscribe(this)}function Sc(t,e,n,r,i,o){this.Th=t,this.Ga=e,this.Xo=n,this.za=r,this.currentUser=i,this.Ka=o,this.Ha=null,this.Ya=new Qr(fa,la),this.Xa=new Map,this.Ja=[],this.Za=new Di(ri.P),this.tu=new Map,this.eu=new mu,this.nu={},this.su=new Map,this.iu=eu.Ps(),this.onlineState="Unknown",this.ru=void 0}function Oc(t,e,n,r){this.Vs=t,this.Xo=e,this.updateFunction=n,this.gs=r,this.qa=5,this.Ls=new Ja(this.Vs,"transaction_retry")}function Lc(t,e){this.query=t,this.Pa=e,this.Va=null,this.Ht=!1,this.pa=Gi(),this.Mt=Gi(),this.ya=ya(t),this.ga=new Qi(this.ya)}function Pc(){this.ca=new dc,this.la={},this.oh=null,this.Jn=null}function kc(){this.activeTargetIds=zi}function Cc(t,e,n,r,i){var o,s,a,u,h,c,l,f,p=this;this.Th=t,this.Xo=e,this.Vs=n,this.Eh=[],this.mh=new Map,this.Ih=null,this.Rh=new Set,this.Ah=i,this.Ah.Ph(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vh()?(Or("RemoteStore","Restarting streams for network reachability change."),[4,this.ph()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.yh=new fc(n,r),this.gh=(h=this.Xo,c=n,l={ko:this.vh.bind(this),Co:this.bh.bind(this),Oo:this.Sh.bind(this)},(f=h).zo(),new uc(c,f.To,f.credentials,f.serializer,l)),this.Ch=(o=this.Xo,s=n,a={ko:this.Dh.bind(this),Co:this.Fh.bind(this),Qo:this.$h.bind(this),Wo:this.Wo.bind(this)},(u=o).zo(),new hc(s,u.To,u.credentials,u.serializer,a))}function Vc(t,e){this.Vs=t,this.oh=e,this.state="Unknown",this.hh=0,this.ah=null,this.uh=!0}function Uc(t){this.Xo=t,this.Jo=new Map,this.mutations=[],this.Zo=!1,this.th=null,this.eh=new Set}function Mc(t,e){var n=this;return(n=Zh.call(this)||this).credentials=t,n.serializer=e,n.Go=!1,n}function xc(t,e,n,r,i){var o=this;return(o=tc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.qo=!1,o}function Fc(t,e,n,r,i){var o=this;return(o=ec.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Bc(t,e,n,r,i,o){this.ss=t,this.wo=n,this.To=r,this.Eo=i,this.listener=o,this.state=0,this.mo=0,this.Io=null,this.stream=null,this.Ls=new Ja(t,e)}function jc(t,e){this._o=t,this.fo=e}function qc(t,e){this._o=t,this.fo=e,this.type="FirstParty",this.user=Wh.no}function Gc(t){var e=this;this.ao=null,this.currentUser=Wh.UNAUTHENTICATED,this.uo=!1,this.co=0,this.io=null,this.forceRefresh=!1,this.ao=function(){e.co++,e.currentUser=e.lo(),e.uo=!0,e.io&&e.io(e.currentUser)},this.co=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ao):(this.ao(null),t.get().then(function(t){e.auth=t,e.ao&&e.auth.addAuthTokenListener(e.ao)},function(){}))}function zc(){this.io=null}function Wc(t){var e=this;return(e=nc.call(this)||this).oc=t,e}function Xc(){this.Ci=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ec=!1}Tc.Zu=(Object.defineProperty(Xc.prototype,"readTime",{get:function(){return this.nc},set:function(t){this.nc=t},enumerable:!1,configurable:!0}),Xc.prototype.Ki=function(t,e){this.sc(),this.readTime=e,this.Ci.set(t.key,t)},Xc.prototype.zi=function(t,e){this.sc(),e&&(this.readTime=e),this.Ci.set(t,null)},Xc.prototype.On=function(t,e){this.sc();var n=this.Ci.get(e);return void 0!==n?ja.resolve(n):this.ic(t,e)},Xc.prototype.getEntries=function(t,e){return this.rc(t,e)},Xc.prototype.apply=function(t){return this.sc(),this.ec=!0,this.Fa(t)},Xc.prototype.sc=function(){},n(Wc,nc=Xc),Wc.prototype.Fa=function(n){var r=this,i=[];return this.Ci.forEach(function(t,e){e?i.push(r.oc.Ki(n,e,r.readTime)):r.oc.zi(t)}),ja.Sn(i)},Wc.prototype.ic=function(t,e){return this.oc.On(t,e)},Wc.prototype.rc=function(t,e){return this.oc.getEntries(t,e)},Wc);var Hc,Qc=(bl.prototype.ge=function(t,n){return this.hc.forEach(function(t,e){return n(e)}),ja.resolve()},bl.prototype.qi=function(t){return ja.resolve(this.lastRemoteSnapshotVersion)},bl.prototype.lc=function(t){return ja.resolve(this.ac)},bl.prototype.hr=function(t){return this.highestTargetId=this.cc.next(),ja.resolve(this.highestTargetId)},bl.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ac&&(this.ac=e),ja.resolve()},bl.prototype._c=function(t){this.hc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cc=new eu(e),this.highestTargetId=e),t.sequenceNumber>this.ac&&(this.ac=t.sequenceNumber)},bl.prototype.ar=function(t,e){return this._c(e),this.targetCount+=1,ja.resolve()},bl.prototype.Gi=function(t,e){return this._c(e),ja.resolve()},bl.prototype.fc=function(t,e){return this.hc.delete(e.target),this.uc.Vr(e.targetId),--this.targetCount,ja.resolve()},bl.prototype.dc=function(n,r,i){var o=this,s=0,a=[];return this.hc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hc.delete(t),a.push(o.wc(n,e.targetId)),s++)}),ja.Sn(a).next(function(){return s})},bl.prototype.Tc=function(t){return ja.resolve(this.targetCount)},bl.prototype.or=function(t,e){var n=this.hc.get(e)||null;return ja.resolve(n)},bl.prototype.Wi=function(t,e,n){return this.uc.Rr(e,n),ja.resolve()},bl.prototype.Bi=function(e,t,n){this.uc.Pr(t,n);var r=this.persistence.Yi,i=[];return r&&t.forEach(function(t){i.push(r.Ku(e,t))}),ja.Sn(i)},bl.prototype.wc=function(t,e){return this.uc.Vr(e),ja.resolve()},bl.prototype.lr=function(t,e){var n=this.uc.yr(e);return ja.resolve(n)},bl.prototype.gr=function(t,e){return ja.resolve(this.uc.gr(e))},bl),Yc=(wl.prototype.start=function(){return Promise.resolve()},wl.prototype.qh=function(){return this.Ic=!1,Promise.resolve()},Object.defineProperty(wl.prototype,"Ac",{get:function(){return this.Ic},enumerable:!1,configurable:!0}),wl.prototype.Pc=function(){},wl.prototype.Vc=function(){},wl.prototype.Ai=function(){return this.$n},wl.prototype.wi=function(t){var e=this.Ec[t.to()];return e||(e=new Ic(this.$n,this.Yi),this.Ec[t.to()]=e),e},wl.prototype.Ii=function(){return this.mi},wl.prototype.Ei=function(){return this.Dn},wl.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new $c(this.mc.next());return this.Yi.pc(),n(i).next(function(t){return r.Yi.yc(i).next(function(){return t})}).vn().then(function(t){return i.gc(),t})},wl.prototype.vc=function(e,n){return ja.Cn(Object.values(this.Ec).map(function(t){return function(){return t.gr(e,n)}}))},wl),$c=(ml.prototype.Sc=function(t){this.bc.push(t)},ml.prototype.gc=function(){this.bc.forEach(function(t){return t()})},n(gl,Hc=ml),gl),Kc=(vl.Fc=function(t){return new vl(t)},Object.defineProperty(vl.prototype,"$c",{get:function(){if(this.Dc)return this.Dc;throw kr()},enumerable:!1,configurable:!0}),vl.prototype.tr=function(t,e,n){return this.Cc.tr(n,e),this.$c.delete(n),ja.resolve()},vl.prototype.er=function(t,e,n){return this.Cc.er(n,e),this.$c.add(n),ja.resolve()},vl.prototype.Ku=function(t,e){return this.$c.add(e),ja.resolve()},vl.prototype.removeTarget=function(t,e){var n=this;this.Cc.Vr(e.targetId).forEach(function(t){return n.$c.add(t)});var r=this.persistence.Ii();return r.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.$c.add(t)})}).next(function(){return r.fc(t,e)})},vl.prototype.pc=function(){this.Dc=new Set},vl.prototype.yc=function(t){var n=this,r=this.persistence.Ei().Fi();return ja.forEach(this.$c,function(e){return n.Nc(t,e).next(function(t){t||r.zi(e)})}).next(function(){return n.Dc=null,r.apply(t)})},vl.prototype.Hi=function(t,e){var n=this;return this.Nc(t,e).next(function(t){t?n.$c.delete(e):n.$c.add(e)})},vl.prototype.Rc=function(t){return 0},vl.prototype.Nc=function(t,e){var n=this;return ja.Cn([function(){return ja.resolve(n.Cc.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.vc(t,e)}])},vl),Jc=(yl.prototype.ko=function(t){this.Oc=t},yl.prototype.Co=function(t){this.Lc=t},yl.prototype.onMessage=function(t){this.Mc=t},yl.prototype.close=function(){this.xc()},yl.prototype.send=function(t){this.kc(t)},yl.prototype.qc=function(){this.Oc()},yl.prototype.Uc=function(t){this.Lc(t)},yl.prototype.Bc=function(t){this.Mc(t)},yl),Zc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},tl=(dl.prototype.Qc=function(t,e){if(e)for(var n in e.so)e.so.hasOwnProperty(n)&&(t[n]=e.so[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2-20206291717"},dl.prototype.Ko=function(u,r,i){var h=this,c=this.jc(u);return new Promise(function(o,s){var a=new Ar;a.listenOnce(Ir.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Er.NO_ERROR:var t=a.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:Or("Connection",'RPC "'+u+'" timed out'),s(new $r(Yr.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=a.getStatus();Or("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Yr).indexOf(i)?i:Yr.UNKNOWN,s(new $r(n,e.message))):s(new $r(Yr.UNKNOWN,"Server responded with status "+a.getStatus())):(Or("Connection",'RPC "'+u+'" failed'),s(new $r(Yr.UNAVAILABLE,"Connection failed.")));break;default:kr()}}finally{Or("Connection",'RPC "'+u+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Or("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Qc(n,i),a.send(c,"POST",e,n,15)})},dl.prototype.Ho=function(t,e,n){return this.Ko(t,e,n)},dl.prototype.xo=function(t,e){var n,r,i=[this.Wc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=br(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Qc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Or("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Jc({kc:function(t){l?Or("Connection","Not sending because WebChannel is closed:",t):(c||(Or("Connection","Opening WebChannel transport."),h.open(),c=!0),Or("Connection","WebChannel sending:",t),h.send(t))},xc:function(){return h.close()}});return u(Tr.EventType.OPEN,function(){l||Or("Connection","WebChannel transport opened.")}),u(Tr.EventType.CLOSE,function(){l||(l=!0,Or("Connection","WebChannel transport closed"),f.Uc())}),u(Tr.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=p.WARN&&(e=n.map(Pr),Dr.warn.apply(Dr,v(["Firestore ("+Rr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.Uc(new $r(Yr.UNAVAILABLE,"The operation could not be completed")))}),u(Tr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Cr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Or("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ii[i];if(void 0!==t)return Ri(t)}(),s=r.message,void 0===o&&(o=Yr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.Uc(new $r(o,s)),h.close()):(Or("Connection","WebChannel received:",n),f.Bc(n)))}),setTimeout(function(){f.qc()},0),f},dl.prototype.jc=function(t){var e=Zc[t];return this.Wc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},dl),el=(pl.prototype.Ph=function(t){this.Yc.push(t)},pl.prototype.qh=function(){window.removeEventListener("online",this.Gc),window.removeEventListener("offline",this.Kc)},pl.prototype.Xc=function(){window.addEventListener("online",this.Gc),window.addEventListener("offline",this.Kc)},pl.prototype.zc=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Yc;t<e.length;t++)(0,e[t])(0)},pl.prototype.Hc=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Yc;t<e.length;t++)(0,e[t])(1)},pl.Jc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},pl),nl=(fl.prototype.Ph=function(t){},fl.prototype.qh=function(){},fl),rl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",il=(ll.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.za=this.Zc(e),this.persistence=this.tl(e),[4,this.persistence.start()];case 1:return t.sent(),this.el=this.nl(e),this.Th=this.sl(e),[2]}})})},ll.prototype.nl=function(t){return null},ll.prototype.sl=function(t){return e=this.persistence,n=new Ec,r=t.il,new yu(e,n,r);var e,n,r},ll.prototype.tl=function(t){if(t.ol.rl)throw new $r(Yr.FAILED_PRECONDITION,rl);return new Yc(Kc.Fc)},ll.prototype.Zc=function(t){return new yc},ll.prototype.clearPersistence=function(t,e){throw new $r(Yr.FAILED_PRECONDITION,rl)},ll),ol=(cl.prototype.initialize=function(r,i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.Th?[2]:(this.Th=r.Th,this.za=r.za,this.Xo=this.hl(i),[4,this.al(i)]);case 1:return e=t.sent(),this.Xo.start(e),this.Ga=this.ul(i),this.Qh=this.cl(i),this.ll=this._l(i),this.za.oh=function(t){return n.Qh.xa(t,1)},this.Ga.Qh=this.Qh,[4,this.Ga.start()];case 2:return t.sent(),[4,this.Ga.oa(this.Qh.ou)];case 3:return t.sent(),[2]}})})},cl.prototype.al=function(t){return e=t.fl,Promise.resolve(new tl(e));var e},cl.prototype._l=function(t){return new wc(this.Qh)},cl.prototype.hl=function(t){var e,n=Eh(t.fl.s);return e=t.credentials,new cc(e,n)},cl.prototype.ul=function(t){var e=this;return new pc(this.Th,this.Xo,t.Vs,function(t){return e.Qh.xa(t,0)},new(el.Jc()?el:nl))},cl.prototype.cl=function(t){return e=this.Th,n=this.Ga,r=this.Xo,i=this.za,o=t.il,s=t.Ka,a=!t.ol.rl||!t.ol.synchronizeTabs,u=new mc(e,n,r,i,o,s),a&&(u.ru=!0),u;var e,n,r,i,o,s,a,u},cl),sl=(hl.prototype.start=function(t,e,n,r){var i=this;this.dl(),this.fl=t;var o=new Ka,s=new Ka,a=!1;return this.credentials.oo(function(t){return a?void i.Vs.Gs(function(){return i.Ga.ra(t)}):(a=!0,Or("FirestoreClient","Initializing. user=",t.uid),i.wl(e,n,r,t,s).then(o.resolve,o.reject))}),this.Vs.Cs(function(){return o.promise}),s.promise},hl.prototype.enableNetwork=function(){var t=this;return this.dl(),this.Vs.enqueue(function(){return t.persistence.Vc(!0),t.Ga.enableNetwork()})},hl.prototype.wl=function(i,o,s,a,u){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Vs:this.Vs,fl:this.fl,clientId:this.clientId,credentials:this.credentials,il:a,Ka:100,ol:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.za=i.za,this.Th=i.Th,this.el=i.el,this.Ga=o.Ga,this.Qh=o.Qh,this.Tl=o.ll,this.persistence.Pc(function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.El(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.wl(new il,new ol,{rl:!1},a,u))];case 4:return[2]}})})},hl.prototype.El=function(t){return"FirebaseError"===t.name?t.code===Yr.FAILED_PRECONDITION||t.code===Yr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},hl.prototype.dl=function(){if(this.Vs.qs)throw new $r(Yr.FAILED_PRECONDITION,"The client has already been terminated.")},hl.prototype.disableNetwork=function(){var t=this;return this.dl(),this.Vs.enqueue(function(){return t.persistence.Vc(!1),t.Ga.disableNetwork()})},hl.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.el&&this.el.stop(),[4,this.Ga.qh()];case 1:return t.sent(),[4,this.za.qh()];case 2:return t.sent(),[4,this.persistence.qh()];case 3:return t.sent(),this.credentials.ho(),[2]}})})})},hl.prototype.waitForPendingWrites=function(){var t=this;this.dl();var e=new Ka;return this.Vs.Cs(function(){return t.Qh.Eu(e)}),e.promise},hl.prototype.listen=function(t,e,n){var r=this;this.dl();var i=new bc(t,e,n);return this.Vs.Cs(function(){return r.Tl.listen(i)}),i},hl.prototype.Bh=function(t){var e=this;this.ml||this.Vs.Cs(function(){return e.Tl.Bh(t)})},hl.prototype.Il=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.dl(),i=new Ka,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Th.ir(o)];case 1:return(e=t.sent())instanceof Ys?i.resolve(e):e instanceof $s?i.resolve(null):i.reject(new $r(Yr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=fu(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},hl.prototype.Rl=function(u){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return this.dl(),a=new Ka,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Th.cr(u,!0)];case 1:return e=t.sent(),n=new vc(u,e._r),r=n.ba(e.documents),i=n.Fa(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=fu(o,"Failed to execute query '"+u+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})},hl.prototype.write=function(t){var e=this;this.dl();var n=new Ka;return this.Vs.Cs(function(){return e.Qh.write(t,n)}),n.promise},hl.prototype.s=function(){return this.fl.s},hl.prototype.Su=function(t){var e=this;this.dl(),this.Vs.Cs(function(){return e.Tl.Su(t),Promise.resolve()})},hl.prototype.Cu=function(t){var e=this;this.ml||this.Vs.Cs(function(){return e.Tl.Cu(t),Promise.resolve()})},Object.defineProperty(hl.prototype,"ml",{get:function(){return this.Vs.qs},enumerable:!1,configurable:!0}),hl.prototype.transaction=function(t){var e=this;this.dl();var n=new Ka;return this.Vs.Cs(function(){return e.Qh.runTransaction(e.Vs,t,n),Promise.resolve()}),n.promise},hl),al=(ul.prototype.next=function(t){this.Al(this.observer.next,t)},ul.prototype.error=function(t){this.Al(this.observer.error,t)},ul.prototype.Pl=function(){this.muted=!0},ul.prototype.Al=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ul);function ul(t){this.observer=t,this.muted=!1}function hl(t,e){this.credentials=t,this.Vs=e,this.clientId=Vr.t()}function cl(){}function ll(){}function fl(){}function pl(){var t=this;this.Gc=function(){return t.zc()},this.Kc=function(){return t.Hc()},this.Yc=[],this.Xc()}function dl(t){this.s=t.s;var e=t.ssl?"https":"http";this.Wc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function yl(t){this.kc=t.kc,this.xc=t.xc}function vl(t){this.persistence=t,this.Cc=new mu,this.Dc=null}function gl(t){var e=this;return(e=Hc.call(this)||this).Qi=t,e}function ml(){this.bc=[]}function wl(t){var e=this;this.Ec={},this.mc=new za(0),this.Ic=!1,this.Ic=!0,this.Yi=t(this),this.mi=new Qc(this),this.$n=new Za,this.Dn=new Tc(this.$n,function(t){return e.Yi.Rc(t)})}function bl(t){this.persistence=t,this.hc=new Qr(vi,gi),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this.ac=0,this.uc=new mu,this.targetCount=0,this.cc=eu.As()}function El(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Il=(Dl.prototype.yl=function(t){switch(po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.gl(t.timestampValue);case 4:return this.vl(t);case 5:return t.stringValue;case 6:return new Wu(Io(t.bytesValue));case 7:return this.bl(t.referenceValue);case 8:return this.Sl(t.geoPointValue);case 9:return this.Cl(t.arrayValue);case 10:return this.Dl(t.mapValue);default:throw kr()}},Dl.prototype.Dl=function(t){var n=this,r={};return Gr(t.fields||{},function(t,e){r[t]=n.yl(e)}),r},Dl.prototype.Sl=function(t){return new ph(Eo(t.latitude),Eo(t.longitude))},Dl.prototype.Cl=function(t){var e=this;return(t.values||[]).map(function(t){return e.yl(t)})},Dl.prototype.vl=function(t){switch(this.Vl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return co(n)?t(n):n}(t);return null==e?null:this.yl(e);case"estimate":return this.gl(lo(t));default:return null}},Dl.prototype.gl=function(t){var e=bo(t),n=new Kr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Dl.prototype.bl=function(t){var e=ti.N(t);Cr(Ho(e));var n=new Br(e.get(1),e.get(3)),r=new ri(e.p(5));return n.isEqual(this.s)||Lr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.pl(r)},Dl),Tl=pu.oi,Al=(Rl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Rl),Nl=(Object.defineProperty(_l.prototype,"Bl",{get:function(){return this.Wl||(this.Wl=new Oh(this.Ur,this.Ul.ignoreUndefinedProperties)),this.Wl},enumerable:!1,configurable:!0}),_l.prototype.settings=function(t){Tu("Firestore.settings",arguments,1),_u("Firestore.settings","object",1,t);var e=new Al(t);if(this.Ol&&!this.Ul.isEqual(e))throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ul=e).credentials&&(this.ql=function(t){if(!t)return new rc;switch(t.type){case"gapi":var e=t.Ql;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new sc(e,t.fo||"0");case"provider":return t.Ql;default:throw new $r(Yr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},_l.prototype.enableNetwork=function(){return this.xl(),this.Ol.enableNetwork()},_l.prototype.disableNetwork=function(){return this.xl(),this.Ol.disableNetwork()},_l.prototype.enablePersistence=function(t){var e,n;if(this.Ol)throw new $r(Yr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Lr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new $r(Yr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.jl(this.Fl,this.$l,{rl:!0,cacheSizeBytes:this.Ul.cacheSizeBytes,synchronizeTabs:r,Gl:i})},_l.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Ol&&!this.Ol.ml)throw new $r(Yr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ka,[2,(this.kl.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Fl.clearPersistence(this.Ur,this.Ml)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},_l.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(_l.prototype,"zl",{get:function(){return this.xl(),this.Ol.ml},enumerable:!1,configurable:!0}),_l.prototype.waitForPendingWrites=function(){return this.xl(),this.Ol.waitForPendingWrites()},_l.prototype.onSnapshotsInSync=function(t){if(this.xl(),El(t))return Sl(this.Ol,t);_u("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Sl(this.Ol,e)},_l.prototype.xl=function(){return this.Ol||this.jl(new il,new ol,{rl:!1}),this.Ol},_l.prototype.Kl=function(){return new Fr(this.Ur,this.Ml,this.Ul.host,this.Ul.ssl,this.Ul.forceLongPolling)},_l.prototype.jl=function(t,e,n){var r=this.Kl();return this.Ol=new sl(this.ql,this.kl),this.Ol.start(r,t,e,n)},_l.Ll=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $r(Yr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $r(Yr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Br(n)},Object.defineProperty(_l.prototype,"app",{get:function(){if(!this.Nl)throw new $r(Yr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nl},enumerable:!1,configurable:!0}),_l.prototype.collection=function(t){return Tu("Firestore.collection",arguments,1),_u("Firestore.collection","non-empty string",1,t),this.xl(),new tf(ti.N(t),this,null)},_l.prototype.doc=function(t){return Tu("Firestore.doc",arguments,1),_u("Firestore.doc","non-empty string",1,t),this.xl(),kl.Hl(ti.N(t),this,null)},_l.prototype.collectionGroup=function(t){if(Tu("Firestore.collectionGroup",arguments,1),_u("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.xl(),new Yl((e=t,new na(ti.k(),e)),this,null);var e},_l.prototype.runTransaction=function(e){var n=this;return Tu("Firestore.runTransaction",arguments,1),_u("Firestore.runTransaction","function",1,e),this.xl().transaction(function(t){return e(new Ll(n,t))})},_l.prototype.batch=function(){return this.xl(),new Pl(this)},Object.defineProperty(_l,"logLevel",{get:function(){switch(Sr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),_l.setLogLevel=function(t){Tu("Firestore.setLogLevel",arguments,1),Lu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Dr.setLogLevel(t)},_l.prototype.Yl=function(){return this.Ul.timestampsInSnapshots},_l);function _l(t,e,n,r){var i=this;if(void 0===n&&(n=new il),void 0===r&&(r=new ol),this.Fl=n,this.$l=r,this.Nl=null,this.kl=new hu,this.INTERNAL={delete:function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.xl(),[4,this.Ol.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Nl=o,this.Ur=_l.Ll(o),this.Ml=o.name,this.ql=new ic(e)}else{var s=t;if(!s.projectId)throw new $r(Yr.INVALID_ARGUMENT,"Must provide projectId");this.Ur=new Br(s.projectId,s.database),this.Ml="[DEFAULT]",this.ql=new rc}this.Ul=new Al({})}function Rl(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new $r(Yr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Du("settings","non-empty string","host",t.host),this.host=t.host,Su("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Uu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Su("settings","object","credentials",t.credentials),this.credentials=t.credentials,Su("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Su("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Lr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Lr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Su("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=pu.ai;else{if(t.cacheSizeBytes!==Tl&&t.cacheSizeBytes<pu.hi)throw new $r(Yr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+pu.hi);this.cacheSizeBytes=t.cacheSizeBytes}Su("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Dl(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Vl=n,this.pl=r}function Sl(t,e){var n=new al({next:function(){e.next&&e.next()},error:function(t){throw kr()}});return t.Su(n),function(){n.Pl(),t.Cu(n)}}var Ol,Ll=(Ul.prototype.get=function(t){var n=this;Tu("Transaction.get",arguments,1);var r=af("Transaction.get",t,this.Xl);return this.Jl.nh([r.Br]).then(function(t){if(!t||1!==t.length)return kr();var e=t[0];if(e instanceof $s)return new Bl(n.Xl,r.Br,null,!1,!1,r.Wr);if(e instanceof Ys)return new Bl(n.Xl,r.Br,e,!1,!1,r.Wr);throw kr()})},Ul.prototype.set=function(t,e,n){Nu("Transaction.set",arguments,2,3);var r=af("Transaction.set",t,this.Xl);n=rf("Transaction.set",n);var i=uf(r.Wr,e,n),o=kh(this.Xl.Bl,"Transaction.set",r.Br,i,null!==r.Wr,n);return this.Jl.set(r.Br,o),this},Ul.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Hu?(Au("Transaction.update",arguments,3),r=af("Transaction.update",t,this.Xl),Vh(this.Xl.Bl,"Transaction.update",r.Br,e,n,o)):(Tu("Transaction.update",arguments,2),r=af("Transaction.update",t,this.Xl),Ch(this.Xl.Bl,"Transaction.update",r.Br,e)),this.Jl.update(r.Br,i),this},Ul.prototype.delete=function(t){Tu("Transaction.delete",arguments,1);var e=af("Transaction.delete",t,this.Xl);return this.Jl.delete(e.Br),this},Ul),Pl=(Vl.prototype.set=function(t,e,n){Nu("WriteBatch.set",arguments,2,3),this.e_();var r=af("WriteBatch.set",t,this.Xl);n=rf("WriteBatch.set",n);var i=uf(r.Wr,e,n),o=kh(this.Xl.Bl,"WriteBatch.set",r.Br,i,null!==r.Wr,n);return this.Zl=this.Zl.concat(o.Qr(r.Br,vs.je())),this},Vl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.e_(),i="string"==typeof e||e instanceof Hu?(Au("WriteBatch.update",arguments,3),r=af("WriteBatch.update",t,this.Xl),Vh(this.Xl.Bl,"WriteBatch.update",r.Br,e,n,o)):(Tu("WriteBatch.update",arguments,2),r=af("WriteBatch.update",t,this.Xl),Ch(this.Xl.Bl,"WriteBatch.update",r.Br,e)),this.Zl=this.Zl.concat(i.Qr(r.Br,vs.exists(!0))),this},Vl.prototype.delete=function(t){Tu("WriteBatch.delete",arguments,1),this.e_();var e=af("WriteBatch.delete",t,this.Xl);return this.Zl=this.Zl.concat(new Ms(e.Br,vs.je())),this},Vl.prototype.commit=function(){return this.e_(),this.t_=!0,0<this.Zl.length?this.Xl.xl().write(this.Zl):Promise.resolve()},Vl.prototype.e_=function(){if(this.t_)throw new $r(Yr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Vl),kl=(n(Cl,Ol=Th),Cl.Hl=function(t,e,n){if(t.length%2!=0)throw new $r(Yr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new Cl(new ri(t),e,n)},Object.defineProperty(Cl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Cl.prototype,"parent",{get:function(){return new tf(this.Br.path.g(),this.firestore,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Cl.prototype,"path",{get:function(){return this.Br.path.$()},enumerable:!1,configurable:!0}),Cl.prototype.collection=function(t){if(Tu("DocumentReference.collection",arguments,1),_u("DocumentReference.collection","non-empty string",1,t),!t)throw new $r(Yr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ti.N(t);return new tf(this.Br.path.child(e),this.firestore,null)},Cl.prototype.isEqual=function(t){if(!(t instanceof Cl))throw Mu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Br.isEqual(t.Br)&&this.Wr===t.Wr},Cl.prototype.set=function(t,e){Nu("DocumentReference.set",arguments,1,2),e=rf("DocumentReference.set",e);var n=uf(this.Wr,t,e),r=kh(this.firestore.Bl,"DocumentReference.set",this.Br,n,null!==this.Wr,e);return this.Ol.write(r.Qr(this.Br,vs.je()))},Cl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Hu?(Au("DocumentReference.update",arguments,2),Vh(this.firestore.Bl,"DocumentReference.update",this.Br,t,e,r)):(Tu("DocumentReference.update",arguments,1),Ch(this.firestore.Bl,"DocumentReference.update",this.Br,t)),this.Ol.write(n.Qr(this.Br,vs.exists(!0)))},Cl.prototype.delete=function(){return Tu("DocumentReference.delete",arguments,0),this.Ol.write([new Ms(this.Br,vs.je())])},Cl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Nu("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||El(i[a])||(Uu("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),Su("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};El(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(_u("DocumentReference.onSnapshot","function",a,i[a]),Ru("DocumentReference.onSnapshot","function",a+1,i[a+1]),Ru("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.n_(t))},error:i[a+1],complete:i[a+2]};return Ml(this.Ol,this.Br,h,c)},Cl.prototype.get=function(t){var e,n,r,i,o,s=this;return Nu("DocumentReference.get",arguments,0,1),sf("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.xl().Il(this.Br).then(function(t){return new Bl(s.firestore,s.Br,t,!0,t instanceof Ys&&t.Ge,s.Wr)}):(e=this.Ol,n=this.Br,r=t,i=new Ka,o=Ml(e,n,{includeMetadataChanges:!0,Ou:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new $r(Yr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new $r(Yr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.n_(t)}))},Cl.prototype.withConverter=function(t){return new Cl(this.Br,this.firestore,t)},Cl.prototype.n_=function(t){var e=t.docs.get(this.Br);return new Bl(this.firestore,this.Br,e,t.fromCache,t.hasPendingWrites,this.Wr)},Cl);function Cl(t,e,n){var r=this;return(r=Ol.call(this,e.Ur,t,n)||this).Br=t,r.firestore=e,r.Wr=n,r.Ol=r.firestore.xl(),r}function Vl(t){this.Xl=t,this.Zl=[],this.t_=!1}function Ul(t,e){this.Xl=t,this.Jl=e}function Ml(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new al({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(ia(e.path),o,n);return function(){o.Pl(),t.Bh(s)}}var xl,Fl=(zl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},zl),Bl=(Gl.prototype.data=function(t){var e=this;if(Nu("DocumentSnapshot.data",arguments,0,1),t=of("DocumentSnapshot.data",t),this.s_){if(this.Wr){var n=new jl(this.Xl,this.Br,this.s_,this.i_,this.r_,null);return this.Wr.fromFirestore(n,t)}return new Il(this.Xl.Ur,this.Xl.Yl(),t.serverTimestamps||"none",function(t){return new kl(t,e.Xl,null)}).yl(this.s_.Ze())}},Gl.prototype.get=function(t,e){var n=this;if(Nu("DocumentSnapshot.get",arguments,1,2),e=of("DocumentSnapshot.get",e),this.s_){var r=this.s_.data().field(jh("DocumentSnapshot.get",t,this.Br));if(null!==r)return new Il(this.Xl.Ur,this.Xl.Yl(),e.serverTimestamps||"none",function(t){return new kl(t,n.Xl,n.Wr)}).yl(r)}},Object.defineProperty(Gl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Gl.prototype,"ref",{get:function(){return new kl(this.Br,this.Xl,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Gl.prototype,"exists",{get:function(){return null!==this.s_},enumerable:!1,configurable:!0}),Object.defineProperty(Gl.prototype,"metadata",{get:function(){return new Fl(this.r_,this.i_)},enumerable:!1,configurable:!0}),Gl.prototype.isEqual=function(t){if(!(t instanceof Gl))throw Mu("isEqual","DocumentSnapshot",1,t);return this.Xl===t.Xl&&this.i_===t.i_&&this.Br.isEqual(t.Br)&&(null===this.s_?null===t.s_:this.s_.isEqual(t.s_))&&this.Wr===t.Wr},Gl),jl=(n(ql,xl=Bl),ql.prototype.data=function(t){return xl.prototype.data.call(this,t)},ql);function ql(){return null!==xl&&xl.apply(this,arguments)||this}function Gl(t,e,n,r,i,o){this.Xl=t,this.Br=e,this.s_=n,this.i_=r,this.r_=i,this.Wr=o}function zl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Wl(t,e,n){if("string"==typeof n){if(""===n)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!oa(e)&&-1!==n.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ti.N(n));if(!ri.W(r))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return To(t,new ri(r))}if(n instanceof Th)return To(t,n.Br);throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Cu(n)+".")}function Xl(t,e){if(!Array.isArray(t)||0===t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Hl(t,e,n){if(!n.isEqual(e))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ql(t){if(t.an()&&0===t.tn.length)throw new $r(Yr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yl=($l.prototype.where=function(t,e,n){Tu("Query.where",arguments,3),Vu("Query.where",3,n);var r,i,o=Lu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=jh("Query.where",t),a=function(t,e,n,r,i,o,s){var a;if(i.L()){if("array-contains"===o||"array-contains-any"===o)throw new $r(Yr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){Xl(s,o);for(var u=[],h=0,c=s;h<c.length;h++){var l=c[h];u.push(Wl(r,t,l))}a={arrayValue:{values:u}}}else a=Wl(r,t,s)}else"in"!==o&&"array-contains-any"!==o||Xl(s,o),a=Uh(n,e,s,"in"===o);var f=ga.create(i,o,a);return function(t,e){if(e instanceof ga){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&Hl(0,e.field,a)}else if(o||i){var u=null;if(o&&(u=t._n(r)),null===u&&i&&(u=t._n(n)),null!==u)throw u===e.op?new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $r(Yr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}}(t,f),f}(this.o_,"Query.where",this.firestore.Bl,this.firestore.Ur,s,o,n);return new $l((r=this.o_,i=r.filters.concat([a]),new na(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},$l.prototype.orderBy=function(t,e){var n;if(Nu("Query.orderBy",arguments,1,2),Ru("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $r(Yr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=jh("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new xa(e,n);return i=s,null!==(r=t).un()||null!==(o=r.cn())&&Hl(0,o,i.field),s}(this.o_,o,n);return new $l((r=this.o_,i=r.tn.concat([s]),new na(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},$l.prototype.limit=function(t){return Tu("Query.limit",arguments,1),_u("Query.limit","number",1,t),xu("Query.limit",1,t),new $l(ua(this.o_,t,"F"),this.firestore,this.Wr)},$l.prototype.limitToLast=function(t){return Tu("Query.limitToLast",arguments,1),_u("Query.limitToLast","number",1,t),xu("Query.limitToLast",1,t),new $l(ua(this.o_,t,"L"),this.firestore,this.Wr)},$l.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Au("Query.startAt",arguments,1);var r=this.h_("Query.startAt",t,e,!0);return new $l(ha(this.o_,r),this.firestore,this.Wr)},$l.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Au("Query.startAfter",arguments,1);var r=this.h_("Query.startAfter",t,e,!1);return new $l(ha(this.o_,r),this.firestore,this.Wr)},$l.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Au("Query.endBefore",arguments,1);var r=this.h_("Query.endBefore",t,e,!0);return new $l(ca(this.o_,r),this.firestore,this.Wr)},$l.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Au("Query.endAt",arguments,1);var r=this.h_("Query.endAt",t,e,!1);return new $l(ca(this.o_,r),this.firestore,this.Wr)},$l.prototype.isEqual=function(t){if(!(t instanceof $l))throw Mu("isEqual","Query",1,t);return this.firestore===t.firestore&&la(this.o_,t.o_)&&this.Wr===t.Wr},$l.prototype.withConverter=function(t){return new $l(this.o_,this.firestore,t)},$l.prototype.h_=function(c,t,e,n){if(Vu(c,1,t),t instanceof Bl)return Tu(c,v([t],e),1),function(t,e,n,r){if(!n)throw new $r(Yr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=sa(t);o<s.length;o++){var a=s[o];if(a.field.L())i.push(To(e,n.key));else{var u=n.field(a.field);if(co(u))throw new $r(Yr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.$();throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new Sa(i,r)}(this.o_,this.firestore.Ur,t.s_,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new $r(Yr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.L()){if("string"!=typeof h)throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!oa(t)&&-1!==h.indexOf("/"))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ti.N(h));if(!ri.W(c))throw new $r(Yr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ri(c);a.push(To(e,l))}else{var f=Uh(n,r,h);a.push(f)}}return new Sa(a,o)}(this.o_,this.firestore.Ur,this.firestore.Bl,c,r,n)},$l.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Nu("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||El(i[u])||(Uu("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),Su("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),El(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(_u("Query.onSnapshot","function",u,i[u]),Ru("Query.onSnapshot","function",u+1,i[u+1]),Ru("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new Zl(r.firestore,r.o_,t,r.Wr))},error:i[u+1],complete:i[u+2]};return Ql(this.o_),Kl(this.firestore.xl(),this.o_,a,h)},$l.prototype.get=function(t){var e=this;Nu("Query.get",arguments,0,1),sf("Query.get",t),Ql(this.o_);var n,r,i,o,s,a=this.firestore.xl();return(t&&"cache"===t.source?a.Rl(this.o_):(n=a,r=this.o_,i=t,o=new Ka,s=Kl(n,r,{includeMetadataChanges:!0,Ou:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new $r(Yr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Zl(e.firestore,e.o_,t,e.Wr)})},$l);function $l(t,e,n){this.o_=t,this.firestore=e,this.Wr=n}function Kl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new al({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Pl(),t.Bh(s)}}var Jl,Zl=(Object.defineProperty(nf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"empty",{get:function(){return this.u_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"size",{get:function(){return this.u_.docs.size},enumerable:!1,configurable:!0}),nf.prototype.forEach=function(e,n){var r=this;Nu("QuerySnapshot.forEach",arguments,1,2),_u("QuerySnapshot.forEach","function",1,e),this.u_.docs.forEach(function(t){e.call(n,r.__(t,r.metadata.fromCache,r.u_.Mt.has(t.key)))})},Object.defineProperty(nf.prototype,"query",{get:function(){return new Yl(this.a_,this.Xl,this.Wr)},enumerable:!1,configurable:!0}),nf.prototype.docChanges=function(t){t&&(Uu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Su("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.u_.Ut)throw new $r(Yr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.c_&&this.l_===e||(this.c_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.u_,e,this.__.bind(this)),this.l_=e),this.c_},nf.prototype.isEqual=function(t){if(!(t instanceof nf))throw Mu("isEqual","QuerySnapshot",1,t);return this.Xl===t.Xl&&la(this.a_,t.a_)&&this.u_.isEqual(t.u_)&&this.Wr===t.Wr},nf.prototype.__=function(t,e,n){return new jl(this.Xl,t.key,t,e,n,this.Wr)},nf),tf=(n(ef,Jl=Yl),Object.defineProperty(ef.prototype,"id",{get:function(){return this.o_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"parent",{get:function(){var t=this.o_.path.g();return t._()?null:new kl(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"path",{get:function(){return this.o_.path.$()},enumerable:!1,configurable:!0}),ef.prototype.doc=function(t){Nu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Vr.t()),_u("CollectionReference.doc","non-empty string",1,t);var e=ti.N(t);return kl.Hl(this.o_.path.child(e),this.firestore,this.Wr)},ef.prototype.add=function(t){Tu("CollectionReference.add",arguments,1),_u("CollectionReference.add","object",1,this.Wr?this.Wr.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},ef.prototype.withConverter=function(t){return new ef(this.f_,this.firestore,t)},ef);function ef(t,e,n){var r=this;if(((r=Jl.call(this,ia(t),e,n)||this).f_=t).length%2!=1)throw new $r(Yr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function nf(t,e,n,r){this.Xl=t,this.a_=e,this.u_=n,this.Wr=r,this.c_=null,this.l_=null,this.metadata=new Fl(n.hasPendingWrites,n.fromCache)}function rf(t,e){if(void 0===e)return{merge:!1};if(Uu(t,e,["merge","mergeFields"]),Su(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Cu(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new $r(Yr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Cu(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Hu}),void 0!==e.mergeFields&&void 0!==e.merge)throw new $r(Yr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function of(t,e){return void 0===e?{}:(Uu(t,e,["serverTimestamps"]),Ou(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function sf(t,e){Ru(t,"object",1,e),e&&(Uu(t,e,["source"]),Ou(t,0,"source",e.source,["default","server","cache"]))}function af(t,e,n){if(e instanceof Th){if(e.firestore!==n)throw new $r(Yr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Mu(t,"DocumentReference",1,e)}function uf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var hf,cf={Firestore:Nl,GeoPoint:ph,Timestamp:Kr,Blob:Wu,Transaction:Ll,WriteBatch:Pl,DocumentReference:kl,DocumentSnapshot:Bl,Query:Yl,QueryDocumentSnapshot:jl,QuerySnapshot:Zl,CollectionReference:tf,FieldPath:Hu,FieldValue:lh,setLogLevel:Nl.setLogLevel,CACHE_SIZE_UNLIMITED:Tl};(hf=lf).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Nl(e,n,new il,new ol);var e,n},"PUBLIC").setServiceProps(Object.assign({},cf))),hf.registerVersion("@firebase/firestore","1.16.3-20206291717")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
