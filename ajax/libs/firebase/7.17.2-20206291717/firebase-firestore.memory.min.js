!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(hf){"use strict";try{(function(){hf=hf&&Object.prototype.hasOwnProperty.call(hf,"default")?hf.default:hf;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function y(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},a=p.INFO,u=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,f="FirebaseError",m=(n(w,l=Error),w);function w(t,e){var n=l.call(this,e)||this;return n.code=t,n.name=f,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R=_||self;function D(){}function S(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=S(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),k=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:V).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++k))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var $=R.navigator;if($){var K=$.userAgent;if(K){X=K;break t}}X=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it,ot=Q(X,"Opera"),st=Q(X,"Trident")||Q(X,"MSIE"),at=Q(X,"Edge"),ut=at||st,ht=Q(X,"Gecko")&&!(Q(X.toLowerCase(),"webkit")&&!Q(X,"Edge"))&&!(Q(X,"Trident")||Q(X,"MSIE"))&&!Q(X,"Edge"),ct=Q(X.toLowerCase(),"webkit")&&!Q(X,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var ft="",pt=(it=X,ht?/rv:([^\);]+)(\)|;)/.exec(it):at?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(ft=pt?pt[1]:""),st){var dt=lt();if(null!=dt&&dt>parseFloat(ft)){rt=String(dt);break t}}rt=ft}var yt={};function vt(a){return t=a,e=function(){for(var t=0,e=H(String(rt)).split("."),n=H(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=R.document&&st&&(lt()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",D,e),R.removeEventListener("test",D,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},F(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Nt,this.Y=this.Z=!1}function Rt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Pt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[At]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[At]?t.va(e,n,L(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!mt)return null;var a,u,h=Ft(t);if(h||(t[Lt]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=xt,r=u=mt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(St(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Rt(t)))}function Ut(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function xt(t,e){if(t.Y)return!0;if(mt)return Mt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}function Ft(t){return(t=t[Lt])instanceof Dt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==S(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function qt(){B.call(this),this.c=new Dt(this),(this.J=this).C=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&St(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}F(qt,B),qt.prototype[At]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=jt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=R.JSON.stringify;function Wt(){this.b=this.a=null}var Xt,Ht=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Yt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function $t(t,e){var n;Xt||(n=R.Promise.resolve(void 0),Xt=function(){n.then(Zt)}),Kt||(Xt(),Kt=!0),Jt.add(t,e)}Wt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Wt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Kt=!1}function te(t,e){qt.call(this),this.b=t||1,this.a=e||R,this.f=U(this.Ya,this),this.g=x()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==S(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}F(te,qt),(N=te.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ue,oe=re=B),ie.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){re.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=ie}function ue(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){B.call(this),this.b=t,this.a={}}F(he,B);var ce=[];function le(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new qt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=S(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}F(ge,Et),F(we,Et),F(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ne(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Re(){}Ne.prototype.a=null;var De,Se={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){Et.call(this,"d")}function Le(){Et.call(this,"c")}function Pe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Ce,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Oe,Et),F(Le,Et),F(Pe,Ne),De=new Pe;var Ce=45e3,Ve={},Ue={};function Me(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=x(),Be(t),t.l=Je(t.i);var s,a,u,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,a=!0;!t.A&&t.D<n.length;){var u=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ue:(o=Number(i.substring(o,s)),isNaN(o)?Ve:(s+=1)+o>i.length?Ue:(i=i.substr(s,o),r.D=s+o,i)));if(u==Ue){4==e&&(t.h=4,be(),a=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}de(t.c,t.f,u,null),We(t,u)}4==e&&0==n.length&&(t.h=1,be(),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Ge(t))}function Be(t){t.U=x()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function qe(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n,r,i,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Nn(p.b,t)))if(p.I=t.N,!t.C&&Nn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Qn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ur(p,11)}else if(!t.C&&p.a!=t||or(p),!W(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(Q(a,"spdy")||Q(a,"quic")||Q(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(_n(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=x()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Rn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(qe(l),Be(l)),o.a=c):er(o),0<p.g.length&&Kn(p)):"stop"!=y[0]&&"close"!=y[0]||ur(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ur(p,7):Hn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=ke.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||me(),qe(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,u=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=r,u.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.h=3,be(),ze(this),Ge(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,a)}this.I?(Fe(this,e,i),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),We(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,Be(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Ge(this)}}}catch(t){}var u,h,c,l,f,p,d},N.Va=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Fe(this,t,e),this.b&&4!=t&&Be(this)))},N.cancel=function(){this.A=!0,ze(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Ge(this)):je(this,this.U-n)},(N=He.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},N.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new Ke(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(a){a.a||(a.a=new He,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function vn(t,e){yn(t),e=wn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Ye(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=G(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Rn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function On(){this.a=new Sn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Pn=R.JSON.parse;function kn(t){qt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}F(kn,qt);var Cn="",Vn=/^https?$/i,Un=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),jn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Bn(t){if(t.b&&(!t.s[1]||4!=Gn(t)||2!=t.X()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Gn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Fn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Wn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Wn("baseRetryDelayMs",5e3,t),this.Ma=Wn("retryDelaySeedMs",1e4,t),this.Ja=Wn("forwardChannelMaxRetries",2,t),this.ma=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Hn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.i.toString(),"")),!n&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=x(),Be(e)),hr(t)}function Qn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Yn(t){Qn(t),t.j&&(R.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&Kn(t)}function Kn(t){Tn(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,r=Je(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Me(n,r,e)}function Zn(t,n){t.f&&Xe({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Xe(t,function(t,e){var n=t;L(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ar(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new ke(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,xe(n,t)}function or(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!Nn(t.b,e))return;r=e.s,Rn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ee(i)),Kn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ar(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function ar(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=U(t.Xa,t),n||(n=new Ke("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ze(n,"https"),on(n)),i=n.toString(),o=r,a=new pe,R.Image?((s=new Image).onload=M(Ln,a,s,"TestLoadImage: loaded",!0,o),s.onerror=M(Ln,a,s,"TestLoadImage: error",!1,o),s.onabort=M(Ln,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(Ln,a,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Yn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof Ke?Je(r):new Ke(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=R.location).protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new Ke(null,void 0),o&&Ze(h,o),s&&tn(h,s),a&&en(h,a),u&&(h.g=u),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Ka)).F=t.C,e}function fr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){qt.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){Le.call(this),this.status=1}function gr(t){this.a=t}(N=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(De),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new He(this.headers);r&&Xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=j(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Bn(this):this.Ta())},N.Ta=function(){Bn(this)},N.X=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Xn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=Je(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&zn(i,this.i,r),_n(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Me(n,i,null)):Me(n,i,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},N.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),ir(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),nr(this),be())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(N=fr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},F(dr,qt),(N=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),Kn(t)},N.close=function(){Hn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=zt(t),$n(this.a,e)):$n(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,dr.S.G.call(this)},F(yr,Oe),F(vr,Le),F(gr,fr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ae.COMPLETE="complete",(Re.EventType=Se).OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",qt.prototype.listen=qt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Qa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.X,kn.prototype.getResponseJson=kn.prototype.Na,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ae,WebChannel:Re,XhrIo:kn},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Er=mr.EventType,Ir=mr.WebChannel,Tr=mr.XhrIo,Ar=(Nr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Nr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Nr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Nr);function Nr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _r="7.17.2-20206291717",Rr=new h("@firebase/firestore");function Dr(){return Rr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=p.DEBUG&&(e=n.map(Lr),Rr.debug.apply(Rr,v(["Firestore ("+_r+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=p.ERROR&&(e=n.map(Lr),Rr.error.apply(Rr,v(["Firestore ("+_r+"): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t;throw Or(e),new Error(e)}function kr(t){t||Pr()}var Cr=(Vr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Vr);function Vr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function xr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Fr=(Object.defineProperty(Br.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Br.prototype.isEqual=function(t){return t instanceof Br&&t.projectId===this.projectId&&t.database===this.database},Br.prototype.o=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},Br);function Br(t,e){this.projectId=t,this.database=e||"(default)"}function jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var zr,Wr,Xr,Hr=(ci.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.u(s,t))return a}},ci.prototype.has=function(t){return void 0!==this.get(t)},ci.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ci.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ci.prototype.forEach=function(a){qr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},ci.prototype._=function(){return Gr(this.l)},ci),Qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(hi,Xr=Error),hi),$r=(ui.now=function(){return ui.fromMillis(Date.now())},ui.fromDate=function(t){return ui.fromMillis(t.getTime())},ui.fromMillis=function(t){var e=Math.floor(t/1e3);return new ui(e,1e6*(t-1e3*e))},ui.prototype.toDate=function(){return new Date(this.toMillis())},ui.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ui.prototype.T=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},ui.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ui.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ui.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ui),Kr=(ai.m=function(t){return new ai(t)},ai.min=function(){return new ai(new $r(0,0))},ai.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.R=function(){return this.timestamp},ai),Jr=(Object.defineProperty(si.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),si.prototype.isEqual=function(t){return 0===si.P(this,t)},si.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof si?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},si.prototype.limit=function(){return this.offset+this.length},si.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},si.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},si.prototype.v=function(){return this.segments[this.offset]},si.prototype.S=function(){return this.get(this.length-1)},si.prototype.get=function(t){return this.segments[this.offset+t]},si.prototype._=function(){return 0===this.length},si.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},si.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},si.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},si.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},si.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},si),Zr=(n(oi,Wr=Jr),oi.prototype.V=function(t,e,n){return new oi(t,e,n)},oi.prototype.$=function(){return this.F().join("/")},oi.prototype.toString=function(){return this.$()},oi.N=function(t){if(0<=t.indexOf("//"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new oi(t.split("/").filter(function(t){return 0<t.length}))},oi.k=function(){return new oi([])},oi),ti=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ei=(n(ii,zr=Jr),ii.prototype.V=function(t,e,n){return new ii(t,e,n)},ii.O=function(t){return ti.test(t)},ii.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ii.O(t)||(t="`"+t+"`"),t}).join(".")},ii.prototype.toString=function(){return this.$()},ii.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ii.M=function(){return new ii(["__name__"])},ii.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Yr(Qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(Qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ii(e)},ii.k=function(){return new ii([])},ii),ni=(ri.U=function(t){return new ri(Zr.N(t).p(5))},ri.prototype.B=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ri.prototype.isEqual=function(t){return null!==t&&0===Zr.P(this.path,t.path)},ri.prototype.toString=function(){return this.path.toString()},ri.P=function(t,e){return Zr.P(t.path,e.path)},ri.W=function(t){return t.length%2==0},ri.j=function(t){return new ri(new Zr(t.slice()))},ri);function ri(t){this.path=t}function ii(){return null!==zr&&zr.apply(this,arguments)||this}function oi(){return null!==Wr&&Wr.apply(this,arguments)||this}function si(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.A=n}function ai(t){this.timestamp=t}function ui(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hi(t,e){var n=this;return(n=Xr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ci(t,e){this.h=t,this.u=e,this.l={}}function li(t){return null==t}function fi(t){return-0===t&&1/t==-1/0}var pi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function di(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new pi(t,e,n,r,i,o,s)}function yi(t){var e,n=t;return null===n.G&&(e=n.path.$(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.$()+e.op.toString()+mo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),li(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=ka(n.startAt)),n.endAt&&(e+="|ub:",e+=ka(n.endAt)),n.G=e),n.G}function vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],!(o instanceof ya&&s instanceof ya&&o.op===s.op&&o.field.isEqual(s.field)&&po(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Va(t.startAt,e.startAt)&&Va(t.endAt,e.endAt)}function gi(t){return ni.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mi=(wi.fromBase64String=function(t){return new wi(atob(t))},wi.fromUint8Array=function(t){return new wi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wi.prototype.toBase64=function(){return t=this.K,btoa(t);var t},wi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},wi.prototype.H=function(){return 2*this.K.length},wi.prototype.o=function(t){return Ur(this.K,t.K)},wi.prototype.isEqual=function(t){return this.K===t.K},wi);function wi(t){this.K=t}function bi(t){this.count=t}mi.Y=new mi("");var Ei,Ii,Ti=(Ai.prototype.Z=function(t){return new Ai(this.target,this.targetId,this.X,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.tt=function(t,e){return new Ai(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.et=function(t){return new Ai(this.target,this.targetId,this.X,this.sequenceNumber,this.J,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=Kr.min()),void 0===o&&(o=Kr.min()),void 0===s&&(s=mi.Y),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case Qr.OK:return Pr(),0;case Qr.CANCELLED:case Qr.UNKNOWN:case Qr.DEADLINE_EXCEEDED:case Qr.RESOURCE_EXHAUSTED:case Qr.INTERNAL:case Qr.UNAVAILABLE:case Qr.UNAUTHENTICATED:return;case Qr.INVALID_ARGUMENT:case Qr.NOT_FOUND:case Qr.ALREADY_EXISTS:case Qr.PERMISSION_DENIED:case Qr.FAILED_PRECONDITION:case Qr.ABORTED:case Qr.OUT_OF_RANGE:case Qr.UNIMPLEMENTED:case Qr.DATA_LOSS:return 1;default:return Pr(),0}}function _i(t){if(void 0===t)return Or("GRPC error has no .code"),Qr.UNKNOWN;switch(t){case Ei.OK:return Qr.OK;case Ei.CANCELLED:return Qr.CANCELLED;case Ei.UNKNOWN:return Qr.UNKNOWN;case Ei.DEADLINE_EXCEEDED:return Qr.DEADLINE_EXCEEDED;case Ei.RESOURCE_EXHAUSTED:return Qr.RESOURCE_EXHAUSTED;case Ei.INTERNAL:return Qr.INTERNAL;case Ei.UNAVAILABLE:return Qr.UNAVAILABLE;case Ei.UNAUTHENTICATED:return Qr.UNAUTHENTICATED;case Ei.INVALID_ARGUMENT:return Qr.INVALID_ARGUMENT;case Ei.NOT_FOUND:return Qr.NOT_FOUND;case Ei.ALREADY_EXISTS:return Qr.ALREADY_EXISTS;case Ei.PERMISSION_DENIED:return Qr.PERMISSION_DENIED;case Ei.FAILED_PRECONDITION:return Qr.FAILED_PRECONDITION;case Ei.ABORTED:return Qr.ABORTED;case Ei.OUT_OF_RANGE:return Qr.OUT_OF_RANGE;case Ei.UNIMPLEMENTED:return Qr.UNIMPLEMENTED;case Ei.DATA_LOSS:return Qr.DATA_LOSS;default:return Pr()}}(Ii=Ei=Ei||{})[Ii.OK=0]="OK",Ii[Ii.CANCELLED=1]="CANCELLED",Ii[Ii.UNKNOWN=2]="UNKNOWN",Ii[Ii.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ii[Ii.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ii[Ii.NOT_FOUND=5]="NOT_FOUND",Ii[Ii.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ii[Ii.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ii[Ii.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ii[Ii.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ii[Ii.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ii[Ii.ABORTED=10]="ABORTED",Ii[Ii.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ii[Ii.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ii[Ii.INTERNAL=13]="INTERNAL",Ii[Ii.UNAVAILABLE=14]="UNAVAILABLE",Ii[Ii.DATA_LOSS=15]="DATA_LOSS";var Ri=(Pi.prototype.nt=function(t,e){return new Pi(this.P,this.root.nt(t,e,this.P).copy(null,null,Si.st,null,null))},Pi.prototype.remove=function(t){return new Pi(this.P,this.root.remove(t,this.P).copy(null,null,Si.st,null,null))},Pi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pi.prototype._=function(){return this.root._()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pi.prototype.it=function(){return this.root.it()},Pi.prototype.rt=function(){return this.root.rt()},Pi.prototype.ot=function(t){return this.root.ot(t)},Pi.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Pi.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pi.prototype.ht=function(t){return this.root.ht(t)},Pi.prototype.at=function(){return new Di(this.root,null,this.P,!1)},Pi.prototype.ut=function(t){return new Di(this.root,t,this.P,!1)},Pi.prototype.ct=function(){return new Di(this.root,null,this.P,!0)},Pi.prototype.lt=function(t){return new Di(this.root,t,this.P,!0)},Pi),Di=(Li.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Li.prototype.wt=function(){return 0<this.ft.length},Li.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Li),Si=(Oi.prototype.copy=function(t,e,n,r,i){return new Oi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Oi.prototype._=function(){return!1},Oi.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Oi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Oi.prototype.min=function(){return this.left._()?this:this.left.min()},Oi.prototype.it=function(){return this.min().key},Oi.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Oi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Oi.prototype.It=function(){if(this.left._())return Oi.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.At()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Oi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.At()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.Pt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Oi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Oi.prototype.Rt=function(){return this.color},Oi.prototype.Et=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.pt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.Pt()),t.left.Rt()&&t.right.Rt()&&(t=t.yt()),t},Oi.prototype.At=function(){var t=this.yt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).pt()).yt()),t},Oi.prototype.Vt=function(){var t=this.yt();return t.left.left.Rt()&&(t=(t=t.Pt()).yt()),t},Oi.prototype.pt=function(){var t=this.copy(null,null,Oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Oi.prototype.Pt=function(){var t=this.copy(null,null,Oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Oi.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Oi.prototype.gt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Oi.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Pr();if(this.right.Rt())throw Pr();var t=this.left.vt();if(t!==this.right.vt())throw Pr();return t+(this.Rt()?0:1)},Oi);function Oi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Oi.RED,this.left=null!=r?r:Oi.EMPTY,this.right=null!=i?i:Oi.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Pi(t,e){this.P=t,this.root=e||Si.EMPTY}function ki(){this.size=0}Si.EMPTY=null,Si.RED=!0,Si.st=!1,Si.EMPTY=(Object.defineProperty(ki.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(ki.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),ki.prototype.copy=function(t,e,n,r,i){return this},ki.prototype.nt=function(t,e,n){return new Si(t,e)},ki.prototype.remove=function(t,e){return this},ki.prototype._=function(){return!0},ki.prototype.ot=function(t){return!1},ki.prototype.ht=function(t){return!1},ki.prototype.it=function(){return null},ki.prototype.rt=function(){return null},ki.prototype.Rt=function(){return!1},ki.prototype.gt=function(){return!0},ki.prototype.vt=function(){return 0},new ki);var Ci=(xi.prototype.has=function(t){return null!==this.data.get(t)},xi.prototype.first=function(){return this.data.it()},xi.prototype.last=function(){return this.data.rt()},Object.defineProperty(xi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),xi.prototype.indexOf=function(t){return this.data.indexOf(t)},xi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},xi.prototype.bt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},xi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},xi.prototype.Ct=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},xi.prototype.at=function(){return new Vi(this.data.at())},xi.prototype.ut=function(t){return new Vi(this.data.ut(t))},xi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},xi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},xi.prototype._=function(){return this.data._()},xi.prototype.Dt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},xi.prototype.isEqual=function(t){if(!(t instanceof xi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},xi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},xi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},xi.prototype.copy=function(t){var e=new xi(this.P);return e.data=t,e},xi),Vi=(Mi.prototype.dt=function(){return this.Ft.dt().key},Mi.prototype.wt=function(){return this.Ft.wt()},Mi),Ui=new Ri(ni.P);function Mi(t){this.Ft=t}function xi(t){this.P=t,this.data=new Ri(this.P)}var Fi=new Ri(ni.P),Bi=new Ri(ni.P),ji=new Ci(ni.P);function qi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ji,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Gi=new Ci(Ur);function zi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Wi(t,e){this.targetId=t,this.ee=e}function Xi(t,e,n,r){void 0===n&&(n=mi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Hi=(so.kt=function(t){return new so(t.P)},so.prototype.has=function(t){return null!=this.$t.get(t)},so.prototype.get=function(t){return this.$t.get(t)},so.prototype.first=function(){return this.Nt.it()},so.prototype.last=function(){return this.Nt.rt()},so.prototype._=function(){return this.Nt._()},so.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(so.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),so.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},so.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},so.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},so.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},so.prototype.copy=function(t,e){var n=new so;return n.P=this.P,n.$t=t,n.Nt=e,n},so),Qi=(oo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Pr()},oo.prototype.Ot=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},oo),Yi=(io.Bt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new io(t,e,Hi.kt(e),i,n,r,!0,!1)},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return!this.Mt._()},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Mt.isEqual(t.Mt)&&ha(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},io),$i=(ro.zt=function(t,e){var n=new Map;return n.set(t,Ki.Kt(t,e)),new ro(Kr.min(),n,Gi,Ui,qi())},ro),Ki=(no.Kt=function(t,e){return new no(mi.Y,e,qi(),qi(),qi())},no),Ji=(Object.defineProperty(eo.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),eo.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},eo.prototype.ce=function(){var n=qi(),r=qi(),i=qi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new Ki(this.ie,this.re,n,r,i)},eo.prototype.le=function(){this.oe=!1,this.se=uo()},eo.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},eo.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},eo.prototype.de=function(){this.ne+=1},eo.prototype.we=function(){--this.ne},eo.prototype.Te=function(){this.oe=!0,this.re=!0},eo),Zi=(to.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof Hs?this.Ve(r,t.te):t.te instanceof Qs&&this.pe(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.pe(s,t.key,t.te)}},to.prototype.ye=function(n){var r=this;this.ge(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.be(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.be(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.be(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Pr()}})},to.prototype.ge=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.be(e)&&n(e)})},to.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.De(r);o&&(gi(e=o.target)?0===i?(n=new ni(e.path),this.pe(r,n,new Qs(n,Kr.min()))):kr(1===i):this.Fe(r)!==i&&(this.Se(r),this.Ae=this.Ae.add(r)))},to.prototype.$e=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.De(e);r&&(t.Ht&&gi(r.target)&&(n=new ni(r.target.path),null!==o.Ie.get(n)||o.Ne(e,n)||o.pe(e,n,new Qs(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=qi();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.De(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new $i(i,s,this.Ae,this.Ie,r);return this.Ie=Ui,this.Re=ao(),this.Ae=new Ci(Ur),t},to.prototype.Ve=function(t,e){var n;this.be(t)&&(n=this.Ne(t,e.key)?2:0,this.ve(t)._e(e.key,n),this.Ie=this.Ie.nt(e.key,e),this.Re=this.Re.nt(e.key,this.ke(e.key).add(t)))},to.prototype.pe=function(t,e,n){var r;this.be(t)&&(r=this.ve(t),this.Ne(t,e)?r._e(e,1):r.fe(e),this.Re=this.Re.nt(e,this.ke(e).delete(t)),n&&(this.Ie=this.Ie.nt(e,n)))},to.prototype.removeTarget=function(t){this.me.delete(t)},to.prototype.Fe=function(t){var e=this.ve(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Jt.size},to.prototype.de=function(t){this.ve(t).de()},to.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new Ji,this.me.set(t,e)),e},to.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Ci(Ur),this.Re=this.Re.nt(t,e)),e},to.prototype.be=function(t){var e=null!==this.De(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},to.prototype.De=function(t){var e=this.me.get(t);return e&&e.he?null:this.Ee.Oe(t)},to.prototype.Se=function(e){var n=this;this.me.set(e,new Ji),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},to.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},to);function to(t){this.Ee=t,this.me=new Map,this.Ie=Ui,this.Re=ao(),this.Ae=new Ci(Ur)}function eo(){this.ne=0,this.se=uo(),this.ie=mi.Y,this.re=!1,this.oe=!0}function no(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Xt=r,this.Jt=i}function ro(t,e,n,r,i){this.J=t,this.Wt=e,this.Qt=n,this.jt=r,this.Gt=i}function io(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Mt=i,this.fromCache=o,this.qt=s,this.Ut=a}function oo(){this.xt=new Ri(ni.P)}function so(n){this.P=n?function(t,e){return n(t,e)||ni.P(t.key,e.key)}:function(t,e){return ni.P(t.key,e.key)},this.$t=Fi,this.Nt=new Ri(this.P)}function ao(){return new Ri(ni.P)}function uo(){return new Ri(ni.P)}function ho(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function co(t){var e=wo(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Pr()}function po(r,i){var t,e,n,o=fo(r);if(o!==fo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return co(r).isEqual(co(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=wo(r.timestampValue),n=wo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Eo(r.bytesValue).isEqual(Eo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,bo((t=r).geoPointValue.latitude)===bo(e.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bo(t.integerValue)===bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=bo(t.doubleValue),r=bo(e.doubleValue);return n===r?fi(n)===fi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],po);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(jr(t)!==jr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!po(t[n],e[n])))return!1;return!0}();default:return Pr()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,r,i,o,s,a,u,h,c,l,f=fo(t),p=fo(e);if(f!==p)return Ur(f,p);switch(f){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return h=e,(c=bo(t.integerValue||t.doubleValue))<(l=bo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Eo(o),u=Eo(s),a.o(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ur(bo(n.latitude),bo(r.latitude)))?i:Ur(bo(n.longitude),bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ur(r[s],o[s]);if(0!==a)return a;var u=vo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=wo(t),r=wo(e),i=Ur(n.seconds,r.seconds);return 0!==i?i:Ur(n.nanos,r.nanos)}function mo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=wo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Eo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ni.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Pr();var t,e,n}(t)}function wo(t){if(kr(!!t),"string"!=typeof t)return{seconds:bo(t.seconds),nanos:bo(t.nanos)};var e,n=0,r=lo.exec(t);kr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function Io(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function To(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ro(t){return t&&"mapValue"in t}var Do={asc:"ASCENDING",desc:"DESCENDING"},So={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oo=function(t,e){this.s=t,this.Le=e};function Lo(t){return{integerValue:""+t}}function Po(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fi(e)?"-0":e}}function ko(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!fi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Lo(e):Po(t,e);var n}function Co(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Uo(t){return kr(!!t),Kr.m((e=wo(t),new $r(e.seconds,e.nanos)));var e}function Mo(t,e){return new Zr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function xo(t,e){return Mo(t.s,e.path)}function Fo(t,e){var n,r,i=(kr(Xo(r=Zr.N(e))),r);return kr(i.get(1)===t.s.projectId),kr(!i.get(3)&&!t.s.database||i.get(3)===t.s.database),new ni((kr(4<(n=i).length&&"documents"===n.get(4)),n.p(5)))}function Bo(t,e){return Mo(t.s,e)}function jo(t){return new Zr(["projects",t.s.projectId,"databases",t.s.database]).$()}function qo(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Go(t,e){var n,r,i,o;if(e instanceof As)n={update:qo(t,e.key,e.value)};else if(e instanceof Vs)n={delete:xo(t,e.key)};else if(e instanceof Ns)n={update:qo(t,e.key,e.data),updateMask:(r=e.Me,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Os)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ko)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof rs)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.$(),increment:e.qe};throw Pr()})}};else{if(!(e instanceof Us))return Pr();n={verify:xo(t,e.key)}}return e.Be.Ue||(n.currentDocument=void 0!==(o=e.Be).updateTime?{updateTime:Co(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Pr()),n}function zo(t){return{before:t.before,values:t.position}}function Wo(t){return{fieldPath:t.$()}}function Xo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ho(){this.We=void 0}function Qo(t,e){return t instanceof as?To(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Yo,$o,Ko=(n(ts,$o=Ho),ts),Jo=(n(Zo,Yo=Ho),Zo);function Zo(t){var e=this;return(e=Yo.call(this)||this).elements=t,e}function ts(){return null!==$o&&$o.apply(this,arguments)||this}function es(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ns,rs=(n(is,ns=Ho),is);function is(t){var e=this;return(e=ns.call(this)||this).elements=t,e}function os(t,e){for(var n=cs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!po(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ss,as=(n(us,ss=Ho),us);function us(t,e){var n=this;return(n=ss.call(this)||this).serializer=t,n.qe=e,n}function hs(t){return bo(t.integerValue||t.doubleValue)}function cs(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ls(t,e){this.field=t,this.transform=e}var fs=(ps.prototype.Qe=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ps.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ps);function ps(t){(this.fields=t).sort(ei.P)}function ds(t,e){this.version=t,this.transformResults=e}var ys=(vs.je=function(){return new vs},vs.exists=function(t){return new vs(void 0,t)},vs.updateTime=function(t){return new vs(t)},Object.defineProperty(vs.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),vs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},vs);function vs(t,e){this.updateTime=t,this.exists=e}function gs(t,e){return void 0!==t.updateTime?e instanceof Hs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Hs}function ms(){}function ws(t,e,n,r){return t instanceof As?function(t,e){if(!gs(t.Be,e))return e;var n=Es(e);return new Hs(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Ns?function(t,e){if(!gs(t.Be,e))return e;var n=Es(e),r=Ds(t,e);return new Hs(t.key,n,r,{Ge:!0})}(t,e):t instanceof Os?function(t,e,n,r){if(!gs(t.Be,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Hs&&(y=n.field(p.field)),null===y&&r instanceof Hs&&(y=r.field(p.field)),c.push((o=y,h=u=a=s=void 0,(i=d)instanceof Ko?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof Jo?es(i,o):i instanceof rs?os(i,o):(u=hs(a=Qo(s=i,o))+hs(s.qe),To(a)&&To(s.qe)?Lo(u):Po(s.serializer,u))))}return c}(t.fieldTransforms,n,e,r),s=Ps(t,i.data(),o);return new Hs(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,gs((i=t).Be,o)?new Qs(i.key,Kr.min()):o);var i,o}function bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Be.isEqual(e.Be)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Me.isEqual(e.Me):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Jo&&o instanceof Jo||i instanceof rs&&o instanceof rs?Mr(i.elements,o.elements,po):i instanceof as&&o instanceof as?po(i.qe,o.qe):i instanceof Ko&&o instanceof Ko);var n,r,i,o}))}function Es(t){return t instanceof Hs?t.version:Kr.min()}var Is,Ts,As=(n(Rs,Ts=ms),Rs),Ns=(n(_s,Is=ms),_s);function _s(t,e,n,r){var i=this;return(i=Is.call(this)||this).key=t,i.data=e,i.Me=n,i.Be=r,i.type=1,i}function Rs(t,e,n){var r=this;return(r=Ts.call(this)||this).key=t,r.value=e,r.Be=n,r.type=0,r}function Ds(t,e){return n=t,r=e instanceof Hs?e.data():Ms.empty(),i=new xs(r),n.Me.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Ss,Os=(n(Ls,Ss=ms),Ls);function Ls(t,e){var n=this;return(n=Ss.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Be=ys.exists(!0),n}function Ps(t,e,n){for(var r=new xs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var ks,Cs,Vs=(n(qs,Cs=ms),qs),Us=(n(js,ks=ms),js),Ms=(Bs.empty=function(){return new Bs({mapValue:{}})},Bs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ro(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Bs.prototype.isEqual=function(t){return po(this.proto,t.proto)},Bs),xs=(Fs.prototype.set=function(t,e){return this.Ye(t,e),this},Fs.prototype.delete=function(t){return this.Ye(t,null),this},Fs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Fs.prototype.ze=function(){var t=this.Xe(ei.k(),this.He);return null!=t?new Ms(t):this.Ke},Fs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.Ke.field(r),s=Ro(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=Ms.empty()),this.Ke=t,this.He=new Map}function Bs(t){this.proto=t}function js(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.Be=e,n.type=4,n}function qs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.Be=e,n.type=3,n}function Gs(t,e){this.key=t,this.version=e}var zs,Ws,Xs,Hs=(n(Js,Xs=Gs),Js.prototype.field=function(t){return this.Je.field(t)},Js.prototype.data=function(){return this.Je},Js.prototype.Ze=function(){return this.Je.proto},Js.prototype.isEqual=function(t){return t instanceof Js&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Je.isEqual(t.Je)},Js.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Je.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js),Qs=(n(Ks,Ws=Gs),Ks.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ks.prototype.isEqual=function(t){return t instanceof Ks&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ks),Ys=(n($s,zs=Gs),$s.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty($s.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(t){return t instanceof $s&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$s);function $s(){return null!==zs&&zs.apply(this,arguments)||this}function Ks(t,e,n){var r=this;return(r=Ws.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Js(t,e,n,r){var i=this;return(i=Xs.call(this,t,e)||this).Je=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Zs(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yr(Qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yr(Qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ta=(ea.prototype.rn=function(t){return new ea(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},ea.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.L())},ea.prototype.hn=function(){return!li(this.limit)&&"F"===this.en},ea.prototype.an=function(){return!li(this.limit)&&"L"===this.en},ea.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},ea.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},ea.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},ea);function ea(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=a,this.nn=null,this.sn=null,this.startAt,this.endAt}function na(t){return new ta(t)}function ra(t){return null!==t.collectionGroup}function ia(t){var e=Zs(t,ta);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.L()||e.nn.push(new Ua(n)),e.nn.push(new Ua(ei.M(),"asc"));else{for(var i,o=!1,s=0,a=e.tn;s<a.length;s++){var u=a[s];e.nn.push(u),u.field.L()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Ua(ei.M(),i)))}}return e.nn}function oa(t){var e=Zs(t,ta);if(!e.sn)if("F"===e.en)e.sn=di(e.path,e.collectionGroup,ia(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ia(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ua(o.field,s))}var a=e.endAt?new Ra(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ra(e.startAt.position,!e.startAt.before):null;e.sn=di(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.sn}function sa(t,e,n){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function aa(t,e){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function ua(t,e){return new ta(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function ha(t,e){return vi(oa(t),oa(e))&&t.en===e.en}function ca(t){return yi(oa(t))+"|lt:"+t.en}function la(t){return"Query(target="+(n=(e=oa(t)).path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+mo(e.value);var e}).join(", ")+"]"),li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ka(e.startAt)),e.endAt&&(n+=", endAt: "+ka(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function fa(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.B(r.collectionGroup)&&r.path.C(o):ni.W(r.path)?r.path.isEqual(o):r.path.D(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ca(e.startAt,ia(e),n))&&(!e.endAt||!Ca(e.endAt,ia(e),n)));var e,n,r,o}function pa(a){return function(t,e){for(var n=!1,r=0,i=ia(a);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,a=t.field.L()?ni.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?vo(o,s):Pr());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var da,ya=(n(va,da=function(){}),va.create=function(t,e,n){if(t.L())return"in"===e?new Ta(t,n):new Ia(t,e,n);if(No(n)){if("=="!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new va(t,e,n)}if(_o(n)){if("=="!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new va(t,e,n)}return"array-contains"===e?new Aa(t,n):"in"===e?new Na(t,n):"array-contains-any"===e?new _a(t,n):new va(t,e,n)},va.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&fo(this.value)===fo(e)&&this.fn(vo(e,this.value))},va.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},va.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},va);function va(t,e,n){var r=this;return(r=da.call(this)||this).field=t,r.op=e,r.value=n,r}var ga,ma,wa,ba,Ea,Ia=(n(Pa,Ea=ya),Pa.prototype.matches=function(t){var e=ni.P(t.key,this.key);return this.fn(e)},Pa),Ta=(n(La,ba=ya),La.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},La),Aa=(n(Oa,wa=ya),Oa.prototype.matches=function(t){var e=t.field(this.field);return Ao(e)&&yo(e.arrayValue,this.value)},Oa),Na=(n(Sa,ma=ya),Sa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value.arrayValue,e)},Sa),_a=(n(Da,ga=ya),Da.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ao(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},Da),Ra=function(t,e){this.position=t,this.before=e};function Da(t,e){return ga.call(this,t,"array-contains-any",e)||this}function Sa(t,e){return ma.call(this,t,"in",e)||this}function Oa(t,e){return wa.call(this,t,"array-contains",e)||this}function La(t,e){var n=this;return(n=ba.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ni.U(t.referenceValue)}),n}function Pa(t,e,n){var r=this;return(r=Ea.call(this,t,e,n)||this).key=ni.U(n.referenceValue),r}function ka(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}function Ca(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.L()?ni.P(ni.U(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Va(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var Ua=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Ma=(Qa.prototype.wn=function(t,e,n){for(var r,i,o,s=n.Tn,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(r=u,i=e,o=s[a],e=r instanceof As?new Hs(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ns?function(t,e,n){if(!gs(t.Be,e))return new Ys(t.key,n.version);var r=Ds(t,e);return new Hs(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Os?function(t,e,n){if(kr(null!=n.transformResults),!gs(t.Be,e))return new Ys(t.key,n.version);var r=e,i=function(t,e,n){var r=[];kr(t.length===n.length);for(var i,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Hs&&(c=e.field(u.field)),r.push((i=h,o=c,s=n[a],i instanceof Jo?es(i,o):i instanceof rs?os(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ps(t,r.data(),i);return new Hs(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Qs(r.key,o.version,{hasCommittedMutations:!0}))}return e},Qa.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ws(i,e,e,this.dn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=ws(u,e,o,this.dn))}return e},Qa.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},Qa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},qi())},Qa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,bs)&&Mr(this.baseMutations,t.baseMutations,bs)},Qa),xa=(Ha.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new Ha(t,e,n,r)},Ha),Fa=(Xa.prototype.catch=function(t){return this.next(void 0,t)},Xa.prototype.next=function(r,i){var o=this;return this.pn&&Pr(),this.pn=!0,this.Vn?this.error?this.yn(i,this.error):this.gn(r,this.result):new Xa(function(e,n){o.An=function(t){o.gn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},Xa.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Xa.prototype.bn=function(t){try{var e=t();return e instanceof Xa?e:Xa.resolve(e)}catch(t){return Xa.reject(t)}},Xa.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):Xa.resolve(e)},Xa.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):Xa.reject(e)},Xa.resolve=function(n){return new Xa(function(t,e){t(n)})},Xa.reject=function(n){return new Xa(function(t,e){e(n)})},Xa.Sn=function(t){return new Xa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Xa.Cn=function(t){for(var n=Xa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Xa.resolve(t):e()})}(r[e]);return n},Xa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},Xa),Ba=(Wa.prototype.Nn=function(e,n){var r=this;return this.Fn.kn(e,n).next(function(t){return r.xn(e,n,t)})},Wa.prototype.xn=function(t,r,i){return this.Dn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},Wa.prototype.Ln=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},Wa.prototype.Mn=function(e,t){var n=this;return this.Dn.getEntries(e,t).next(function(t){return n.qn(e,t)})},Wa.prototype.qn=function(r,i){var o=this;return this.Fn.Un(r,i).next(function(t){var e=o.Ln(r,i,t),n=Ui;return e.forEach(function(t,e){e=e||new Qs(t,Kr.min()),n=n.nt(t,e)}),n})},Wa.prototype.Bn=function(t,e,n){return r=e,ni.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Wn(t,e.path):ra(e)?this.Qn(t,e,n):this.jn(t,e,n);var r},Wa.prototype.Wn=function(t,e){return this.Nn(t,new ni(e)).next(function(t){var e=Fi;return t instanceof Hs&&(e=e.nt(t.key,t)),e})},Wa.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,a=Fi;return this.$n.Gn(n,s).next(function(t){return Fa.forEach(t,function(t){var e=r.rn(t.child(s));return o.jn(n,e,i).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Wa.prototype.jn=function(e,n,t){var c,l,r=this;return this.Dn.Bn(e,n,t).next(function(t){return c=t,r.Fn.zn(e,n)}).next(function(t){return l=t,r.Kn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=ws(s,u,u,r.dn);c=h instanceof Hs?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){fa(n,e)||(c=c.remove(t))}),c})},Wa.prototype.Kn=function(t,e,n){for(var r=qi(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Ns&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.Dn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Hs&&(h=h.nt(t,e))}),h})},Wa),ja=(za.Xn=function(t,e){for(var n=qi(),r=qi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new za(t,e.fromCache,n,r)},za),qa=(Ga.prototype.Zn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ga.prototype.next=function(){var t=++this.previousValue;return this.ts&&this.ts(t),t},Ga);function Ga(t,e){var n=this;this.previousValue=t,e&&(e.Jn=function(t){return n.Zn(t)},this.ts=function(t){return e.es(t)})}function za(t,e,n,r){this.targetId=t,this.fromCache=e,this.Hn=n,this.Yn=r}function Wa(t,e,n){this.Dn=t,this.Fn=e,this.$n=n}function Xa(t){var e=this;this.An=null,this.Pn=null,this.result=void 0,this.error=void 0,this.Vn=!1,this.pn=!1,t(function(t){e.Vn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Vn=!0,e.error=t,e.Pn&&e.Pn(t)})}function Ha(t,e,n,r){this.batch=t,this.In=e,this.Tn=n,this.Rn=r}function Qa(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}function Ya(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}qa.ns=-1;var $a=(ru.prototype.reset=function(){this.us=0},ru.prototype._s=function(){this.us=this.as},ru.prototype.fs=function(t){var e=this;this.cancel();var n=Math.floor(this.us+this.ds()),r=Math.max(0,Date.now()-this.ls),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.us+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.cs=this.ss.ws(this.rs,i,function(){return e.ls=Date.now(),t()}),this.us*=this.hs,this.us<this.os&&(this.us=this.os),this.us>this.as&&(this.us=this.as)},ru.prototype.Ts=function(){null!==this.cs&&(this.cs.Es(),this.cs=null)},ru.prototype.cancel=function(){null!==this.cs&&(this.cs.cancel(),this.cs=null)},ru.prototype.ds=function(){return(Math.random()-.5)*this.us},ru),Ka=(nu.prototype.Is=function(t,e){return this.ms.add(e),Fa.resolve()},nu.prototype.Gn=function(t,e){return Fa.resolve(this.ms.getEntries(e))},nu),Ja=(eu.prototype.add=function(t){var e=t.S(),n=t.g(),r=this.index[e]||new Ci(Zr.P),i=!r.has(n);return this.index[e]=r.add(n),i},eu.prototype.has=function(t){var e=t.S(),n=t.g(),r=this.index[e];return r&&r.has(n)},eu.prototype.getEntries=function(t){return(this.index[t]||new Ci(Zr.P)).F()},eu),Za=(tu.prototype.next=function(){return this.Rs+=2,this.Rs},tu.As=function(){return new tu(0)},tu.Ps=function(){return new tu(-1)},tu);function tu(t){this.Rs=t}function eu(){this.index={}}function nu(){this.ms=new Ja}function ru(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ss=t,this.rs=e,this.os=n,this.hs=r,this.as=i,this.us=0,this.cs=null,this.ls=Date.now(),this.reset()}function iu(t){return"IndexedDbTransactionError"===t.name}function ou(){return"undefined"!=typeof window?window:null}var su=(hu.vs=function(t,e,n,r,i){var o=new hu(t,e,Date.now()+n,r,i);return o.start(n),o},hu.prototype.start=function(t){var e=this;this.bs=setTimeout(function(){return e.Ss()},t)},hu.prototype.Es=function(){return this.Ss()},hu.prototype.cancel=function(t){null!==this.bs&&(this.clearTimeout(),this.gs.reject(new Yr(Qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},hu.prototype.Ss=function(){var e=this;this.Vs.Cs(function(){return null!==e.bs?(e.clearTimeout(),e.op().then(function(t){return e.gs.resolve(t)})):Promise.resolve()})},hu.prototype.clearTimeout=function(){null!==this.bs&&(this.ys(this),clearTimeout(this.bs),this.bs=null)},hu),au=(Object.defineProperty(uu.prototype,"qs",{get:function(){return this.$s},enumerable:!1,configurable:!0}),uu.prototype.Cs=function(t){this.enqueue(t)},uu.prototype.Us=function(t){this.Bs(),this.Ws(t)},uu.prototype.Qs=function(t){return this.Bs(),this.Ws(t)},uu.prototype.js=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Bs(),this.$s?[3,2]:(this.$s=!0,(e=ou())&&e.removeEventListener("visibilitychange",this.Ms),[4,this.Qs(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},uu.prototype.enqueue=function(t){return this.Bs(),this.$s?new Promise(function(t){}):this.Ws(t)},uu.prototype.Gs=function(t){var e=this;this.Fs.push(t),this.Cs(function(){return e.zs()})},uu.prototype.zs=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Fs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Fs[0]()];case 2:return t.sent(),this.Fs.shift(),this.Ls.reset(),[3,4];case 3:if(!iu(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Fs.length&&this.Ls.fs(function(){return n.zs()}),t.label=5;case 5:return[2]}})})},uu.prototype.Ws=function(t){var r=this,e=this.Ds.then(function(){return r.xs=!0,t().catch(function(t){throw r.ks=t,r.xs=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.xs=!1,t})});return this.Ds=e},uu.prototype.ws=function(t,e,n){var r=this;this.Bs(),-1<this.Os.indexOf(t)&&(e=0);var i=su.vs(this,t,e,n,function(t){return r.Ks(t)});return this.Ns.push(i),i},uu.prototype.Bs=function(){this.ks&&Pr()},uu.prototype.Hs=function(){},uu.prototype.Ys=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ds)return[3,0];t.label=3;case 3:return[2]}})})},uu.prototype.Xs=function(t){for(var e=0,n=this.Ns;e<n.length;e++)if(n[e].rs===t)return!0;return!1},uu.prototype.Js=function(r){var i=this;return this.Ys().then(function(){i.Ns.sort(function(t,e){return t.ps-e.ps});for(var t=0,e=i.Ns;t<e.length;t++){var n=e[t];if(n.Es(),"all"!==r&&n.rs===r)break}return i.Ys()})},uu.prototype.Zs=function(t){this.Os.push(t)},uu.prototype.Ks=function(t){var e=this.Ns.indexOf(t);this.Ns.splice(e,1)},uu);function uu(){var t=this;this.Ds=Promise.resolve(),this.Fs=[],this.$s=!1,this.Ns=[],this.ks=null,this.xs=!1,this.Os=[],this.Ls=new $a(this,"async_queue_retry"),this.Ms=function(){return t.Ls.Ts()};var e=ou();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ms)}function hu(t,e,n,r,i){this.Vs=t,this.rs=e,this.ps=n,this.op=r,this.ys=i,this.gs=new Ya,this.then=this.gs.promise.then.bind(this.gs.promise),this.gs.promise.catch(function(t){})}function cu(t,e){if(Or("AsyncQueue",e+": "+t),iu(t))return new Yr(Qr.UNAVAILABLE,e+": "+t);throw t}var lu=(fu.si=function(t){return new fu(t,fu.ii,fu.ri)},fu);function fu(t,e,n){this.ti=t,this.ei=e,this.ni=n}lu.oi=-1,lu.hi=1048576,lu.ai=41943040,lu.ii=10,lu.ri=1e3,lu.ui=new lu(lu.ai,lu.ii,lu.ri),lu.ci=new lu(lu.oi,0,0);var pu=(du.prototype.Vi=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Fn,m=this.Ri,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Fn.pi(v).next(function(t){return g=t,e=r.persistence.wi(i),m=new Ba(r.Ti,e,r.persistence.Ai()),e.pi(v)}).next(function(t){for(var e=[],n=[],r=qi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Mn(v,r).next(function(t){return{yi:t,gi:e,vi:n}})})})];case 1:return n=t.sent(),[2,(this.Fn=e,this.Ri=m,this.li.Pi(this.Ri),n)]}})})},du.prototype.bi=function(h){var c,l=this,f=$r.now(),t=h.reduce(function(t,e){return t.add(e.key)},qi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.Ri.Mn(u,t).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof Os?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Hs?t.field(i.field):void 0,s=Qo(i.transform,o||null);null!=s&&(e=null==e?(new xs).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Ns(o.key,s,function a(t){var u=[];return qr(t.fields||{},function(t,e){var n=new ei([t]);if(Ro(e)){var r=a(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new fs(u)}(s.proto.mapValue),ys.exists(!0)))}return l.Fn.Si(u,f,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Ci:e}})},du.prototype.Di=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ti.Fi({$i:!0});return i.Ni(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Fn.ki(t)}).next(function(){return i.Ri.Mn(t,e)})})},du.prototype.xi=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Fn.Oi(e,t).next(function(t){return kr(null!==t),n=t.keys(),r.Fn.Li(e,t)}).next(function(){return r.Fn.ki(e)}).next(function(){return r.Ri.Mn(e,n)})})},du.prototype.Mi=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fn.Mi(t)})},du.prototype.qi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mi.qi(t)})},du.prototype.Ui=function(u){var h=this,c=u.J,l=this._i;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ti.Fi({$i:!0});l=h._i;var s=[];u.Wt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.mi.Bi(o,t.Jt,e).next(function(){return h.mi.Wi(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Qi),l=l.nt(e,r),du.ji(i,r,t)&&s.push(h.mi.Gi(o,r))))});var t,a=Ui,n=qi();return u.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.jt.forEach(function(t,e){var n=r.get(t);e instanceof Qs&&e.version.isEqual(Kr.min())?(i.zi(t,c),a=a.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.Ki(e,c),a=a.nt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Gt.has(t)&&s.push(h.persistence.Yi.Hi(o,t))})})),c.isEqual(Kr.min())||(t=h.mi.qi(o).next(function(t){return h.mi.Xi(o,o.Qi,c)}),s.push(t)),Fa.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ri.qn(o,a)})}).then(function(t){return h._i=l,t})},du.ji=function(t,e,n){return kr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.J.I()-t.J.I()>=this.Ji||0<n.Yt.size+n.Xt.size+n.Jt.size},du.prototype.Zi=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Fa.forEach(c,function(e){return Fa.forEach(e.Hn,function(t){return h.persistence.Yi.tr(n,e.targetId,t)}).next(function(){return Fa.forEach(e.Yn,function(t){return h.persistence.Yi.er(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!iu(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this._i.get(o),a=s.J,u=s.et(a),this._i=this._i.nt(o,u));return[2]}})})},du.prototype.nr=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fn.sr(t,e)})},du.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ri.Nn(t,e)})},du.prototype.rr=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.mi.or(e,r).next(function(t){return t?(n=t,Fa.resolve(n)):i.mi.hr(e).next(function(t){return n=new Ti(r,t,0,e.Qi),i.mi.ar(e,n).next(function(){return n})})})}).then(function(t){var e=i._i.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i._i=i._i.nt(t.targetId,t),i.fi.set(r,t.targetId)),t})},du.prototype.or=function(t,e){var n=this.fi.get(e);return void 0!==n?Fa.resolve(this._i.get(n)):this.mi.or(t,e)},du.prototype.ur=function(o,s){return d(this,void 0,void 0,function(){var e,n,r,i=this;return y(this,function(t){switch(t.label){case 0:e=this._i.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.Yi.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!iu(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this._i=this._i.remove(o),this.fi.delete(e.target),[2]}})})},du.prototype.cr=function(t,n){var r=this,i=Kr.min(),o=qi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.or(e,oa(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.mi.lr(e,t.targetId).next(function(t){o=t})}).next(function(){return r.li.Bn(e,t,n?i:Kr.min(),n?o:qi())}).next(function(t){return{documents:t,_r:o}})})},du.prototype.Ni=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=Fa.resolve();return n.forEach(function(r){a=a.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);kr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.Ki(e,i.In)})}),a.next(function(){return e.Fn.Li(t,s)})},du.prototype.dr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.wr(t,n._i)})},du);function du(t,e,n){this.persistence=t,this.li=e,this._i=new Ri(Ur),this.fi=new Hr(yi,vi),this.di=Kr.min(),this.Fn=t.wi(n),this.Ti=t.Ei(),this.mi=t.Ii(),this.Ri=new Ba(this.Ti,this.Fn,this.persistence.Ai()),this.li.Pi(this.Ri)}function yu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Qr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}pu.Ji=3e8;var vu=(wu.prototype._=function(){return this.Tr._()},wu.prototype.tr=function(t,e){var n=new gu(t,e);this.Tr=this.Tr.add(n),this.mr=this.mr.add(n)},wu.prototype.Rr=function(t,e){var n=this;t.forEach(function(t){return n.tr(t,e)})},wu.prototype.er=function(t,e){this.Ar(new gu(t,e))},wu.prototype.Pr=function(t,e){var n=this;t.forEach(function(t){return n.er(t,e)})},wu.prototype.Vr=function(t){var e=this,n=new ni(new Zr([])),r=new gu(n,t),i=new gu(n,t+1),o=[];return this.mr.bt([r,i],function(t){e.Ar(t),o.push(t.key)}),o},wu.prototype.pr=function(){var e=this;this.Tr.forEach(function(t){return e.Ar(t)})},wu.prototype.Ar=function(t){this.Tr=this.Tr.delete(t),this.mr=this.mr.delete(t)},wu.prototype.yr=function(t){var e=new ni(new Zr([])),n=new gu(e,t),r=new gu(e,t+1),i=qi();return this.mr.bt([n,r],function(t){i=i.add(t.key)}),i},wu.prototype.gr=function(t){var e=new gu(t,0),n=this.Tr.Ct(e);return null!==n&&t.isEqual(n.key)},wu),gu=(mu.Er=function(t,e){return ni.P(t.key,e.key)||Ur(t.vr,e.vr)},mu.Ir=function(t,e){return Ur(t.vr,e.vr)||ni.P(t.key,e.key)},mu);function mu(t,e){this.key=t,this.vr=e}function wu(){this.Tr=new Ci(gu.Er),this.mr=new Ci(gu.Ir)}function bu(t,e){if(0!==e.length)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+xu(e.length,"argument")+".")}function Eu(t,e,n){if(e.length!==n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires "+xu(n,"argument")+", but was called with "+xu(e.length,"argument")+".")}function Iu(t,e,n){if(e.length<n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+xu(n,"argument")+", but was called with "+xu(e.length,"argument")+".")}function Tu(t,e,n,r){if(e.length<n||e.length>r)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+xu(e.length,"argument")+".")}function Au(t,e,n,r){Ou(t,e,Mu(n)+" argument",r)}function Nu(t,e,n,r){void 0!==r&&Au(t,e,n,r)}function _u(t,e,n,r){Ou(t,e,n+" option",r)}function Ru(t,e,n,r){void 0!==r&&_u(t,e,n,r)}function Du(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Pu(s))}var a=Pu(n);throw new Yr(Qr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Su(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid value "+Pu(r)+" provided to function "+t+"() for its "+Mu(n)+" argument. Acceptable values: "+e.join(", "));return r}function Ou(t,e,n,r){if(!("object"===e?Lu(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Pu(r);throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Lu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Pu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ku(t,e,n){if(void 0===n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Mu(e)+" argument, but it was undefined.")}function Cu(n,t,r){qr(t,function(t,e){if(r.indexOf(t)<0)throw new Yr(Qr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Vu(t,e,n,r){var i=Pu(r);return new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Mu(n)+" argument to be a "+e+", but it was: "+i)}function Uu(t,e,n){if(n<=0)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Mu(e)+" argument to be a positive number, but it was: "+n+".")}function Mu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function xu(t,e){return t+" "+e+(1===t?"":"s")}function Fu(){if("undefined"==typeof Uint8Array)throw new Yr(Qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Bu(){if("undefined"==typeof atob)throw new Yr(Qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ju,qu,Gu=(Ku.fromBase64String=function(t){Eu("Blob.fromBase64String",arguments,1),Au("Blob.fromBase64String","string",1,t),Bu();try{return new Ku(mi.fromBase64String(t))}catch(t){throw new Yr(Qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ku.fromUint8Array=function(t){if(Eu("Blob.fromUint8Array",arguments,1),Fu(),!(t instanceof Uint8Array))throw Vu("Blob.fromUint8Array","Uint8Array",1,t);return new Ku(mi.fromUint8Array(t))},Ku.prototype.toBase64=function(){return Eu("Blob.toBase64",arguments,0),Bu(),this.br.toBase64()},Ku.prototype.toUint8Array=function(){return Eu("Blob.toUint8Array",arguments,0),Fu(),this.br.toUint8Array()},Ku.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ku.prototype.isEqual=function(t){return this.br.isEqual(t.br)},Ku),zu=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yr(Qr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Au("FieldPath","string",e,t[e]),0===t[e].length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Sr=new ei(t)},Wu=(n($u,qu=zu),$u.documentId=function(){return new $u(ei.M().$())},$u.prototype.isEqual=function(t){if(!(t instanceof $u))throw Vu("isEqual","FieldPath",1,t);return this.Sr.isEqual(t.Sr)},$u),Xu=new RegExp("[~\\*/\\[\\]]"),Hu=function(){this.Cr=this},Qu=(n(Yu,ju=Hu),Yu.prototype.Fr=function(t){if(2!==t.$r)throw 1===t.$r?t.Nr(this.Dr+"() can only appear at the top level of your update data"):t.Nr(this.Dr+"() cannot be used with set() unless you pass {merge:true}");return t.Me.push(t.path),null},Yu.prototype.isEqual=function(t){return t instanceof Yu},Yu);function Yu(t){var e=this;return(e=ju.call(this)||this).Dr=t,e}function $u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qu.call(this,t)||this}function Ku(t){Bu(),this.br=t}function Ju(t,e,n){return new Rh({$r:3,kr:e.settings.kr,methodName:t.Dr,xr:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Zu,th,eh,nh,rh,ih,oh=(n(mh,ih=Hu),mh.prototype.Fr=function(t){return new ls(t.path,new Ko)},mh.prototype.isEqual=function(t){return t instanceof mh},mh),sh=(n(gh,rh=Hu),gh.prototype.Fr=function(t){var e=Ju(this,t,!0),n=this.Or.map(function(t){return Vh(t,e)}),r=new Jo(n);return new ls(t.path,r)},gh.prototype.isEqual=function(t){return this===t},gh),ah=(n(vh,nh=Hu),vh.prototype.Fr=function(t){var e=Ju(this,t,!0),n=this.Or.map(function(t){return Vh(t,e)}),r=new rs(n);return new ls(t.path,r)},vh.prototype.isEqual=function(t){return this===t},vh),uh=(n(yh,eh=Hu),yh.prototype.Fr=function(t){var e=new as(t.serializer,ko(t.serializer,this.Lr));return new ls(t.path,e)},yh.prototype.isEqual=function(t){return this===t},yh),hh=(n(dh,th=Hu),dh.delete=function(){return bu("FieldValue.delete",arguments),new ch(new Qu("FieldValue.delete"))},dh.serverTimestamp=function(){return bu("FieldValue.serverTimestamp",arguments),new ch(new oh("FieldValue.serverTimestamp"))},dh.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Iu("FieldValue.arrayUnion",arguments,1),new ch(new sh("FieldValue.arrayUnion",t))},dh.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Iu("FieldValue.arrayRemove",arguments,1),new ch(new ah("FieldValue.arrayRemove",t))},dh.increment=function(t){return Au("FieldValue.increment","number",1,t),Eu("FieldValue.increment",arguments,1),new ch(new uh("FieldValue.increment",t))},dh),ch=(n(ph,Zu=hh),ph.prototype.Fr=function(t){return this.Cr.Fr(t)},ph.prototype.isEqual=function(t){return t instanceof ph&&this.Cr.isEqual(t.Cr)},ph),lh=(Object.defineProperty(fh.prototype,"latitude",{get:function(){return this.Mr},enumerable:!1,configurable:!0}),Object.defineProperty(fh.prototype,"longitude",{get:function(){return this.qr},enumerable:!1,configurable:!0}),fh.prototype.isEqual=function(t){return this.Mr===t.Mr&&this.qr===t.qr},fh.prototype.T=function(t){return Ur(this.Mr,t.Mr)||Ur(this.qr,t.qr)},fh);function fh(t,e){if(Eu("GeoPoint",arguments,2),Au("GeoPoint","number",1,t),Au("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yr(Qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(Qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Mr=t,this.qr=e}function ph(t){var e=this;return(e=Zu.call(this)||this).Cr=t,e.Dr=t.Dr,e}function dh(){return th.call(this)||this}function yh(t,e){var n=this;return(n=eh.call(this)||this).Dr=t,n.Lr=e,n}function vh(t,e){var n=this;return(n=nh.call(this)||this).Dr=t,n.Or=e,n}function gh(t,e){var n=this;return(n=rh.call(this)||this).Dr=t,n.Or=e,n}function mh(t){var e=this;return(e=ih.call(this)||this).Dr=t,e}function wh(t){return new Oo(t,!0)}var bh=/^__.*__$/,Eh=function(t,e,n){this.Ur=t,this.Br=e,this.Wr=n},Ih=(Nh.prototype.Qr=function(t,e){var n=[];return null!==this.Me?n.push(new Ns(t,this.data,this.Me,e)):n.push(new As(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Os(t,this.fieldTransforms)),n},Nh),Th=(Ah.prototype.Qr=function(t,e){var n=[new Ns(t,this.data,this.Me,e)];return 0<this.fieldTransforms.length&&n.push(new Os(t,this.fieldTransforms)),n},Ah);function Ah(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function Nh(t,e,n){this.data=t,this.Me=e,this.fieldTransforms=n}function _h(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Rh=(Object.defineProperty(Oh.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Oh.prototype,"$r",{get:function(){return this.settings.$r},enumerable:!1,configurable:!0}),Oh.prototype.Gr=function(t){return new Oh(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Me)},Oh.prototype.zr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.Kr(t),r},Oh.prototype.Hr=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Gr({path:n,xr:!1});return r.jr(),r},Oh.prototype.Yr=function(t){return this.Gr({path:void 0,xr:!0})},Oh.prototype.Nr=function(t){return jh(t,this.settings.methodName,this.settings.Xr||!1,this.path,this.settings.kr)},Oh.prototype.contains=function(e){return void 0!==this.Me.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},Oh.prototype.jr=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Kr(this.path.get(t))},Oh.prototype.Kr=function(t){if(0===t.length)throw this.Nr("Document fields must not be empty");if(_h(this.$r)&&bh.test(t))throw this.Nr('Document fields cannot begin and end with "__"')},Oh),Dh=(Sh.prototype.Jr=function(t,e,n,r){return void 0===r&&(r=!1),new Rh({$r:t,methodName:e,kr:n,path:ei.k(),xr:!1,Xr:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Sh);function Sh(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||wh(t)}function Oh(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.jr(),this.fieldTransforms=i||[],this.Me=o||[]}function Lh(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Jr(o.merge||o.mergeFields?2:0,e,n,i);xh("Data must be an object, but it was:",s,r);var a,u,h=Uh(r,s);if(o.merge)a=new fs(s.Me),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof zu)d=p.Sr;else{if("string"!=typeof p)throw Pr();d=Bh(e,p,n)}if(!s.contains(d))throw new Yr(Qr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");qh(c,d)||c.push(d)}a=new fs(c),u=s.fieldTransforms.filter(function(t){return a.Qe(t.field)})}else a=null,u=s.fieldTransforms;return new Ih(new Ms(h),a,u)}function Ph(t,o,s,e){var a=t.Jr(1,o,s);xh("Data must be an object, but it was:",a,e);var u=[],h=new xs;qr(e,function(t,e){var n,r=Bh(o,t,s),i=a.Hr(r);e instanceof Hu&&e.Cr instanceof Qu?u.push(r):null!=(n=Vh(e,i))&&(u.push(r),h.set(r,n))});var n=new fs(u);return new Th(h.ze(),n,a.fieldTransforms)}function kh(t,e,n,r,i,o){var s=t.Jr(1,e,n),a=[Fh(e,r,n)],u=[i];if(o.length%2!=0)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(Fh(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],y=new xs,v=a.length-1;0<=v;--v)qh(d,a[v])||(c=a[v],l=u[v],f=s.Hr(c),l instanceof Hu&&l.Cr instanceof Qu?d.push(c):null!=(p=Vh(l,f))&&(d.push(c),y.set(c,p)));var g=new fs(d);return new Th(y.ze(),g,s.fieldTransforms)}function Ch(t,e,n,r){return void 0===r&&(r=!1),Vh(n,t.Jr(r?4:3,e))}function Vh(s,t){if(Mh(s))return xh("Unsupported field value:",t,s),Uh(s,t);if(s instanceof Hu)return function(t,e){if(!_h(e.$r))throw e.Nr(t.Dr+"() can only be used with update() and set()");if(!e.path)throw e.Nr(t.Dr+"() is not currently supported inside arrays");var n=t.Fr(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Me.push(t.path),s instanceof Array){if(t.settings.xr&&4!==t.$r)throw t.Nr("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Vh(i[r],t.Yr(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ko(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Co(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Co(e.serializer,r)}}if(t instanceof lh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gu)return{bytesValue:Vo(e.serializer,t)};if(t instanceof Eh){var i=e.s,o=t.Ur;if(!o.isEqual(i))throw e.Nr("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Mo(t.Ur||e.s,t.Br.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Nr("Unsupported field value: "+Pu(t))}(s,t)}function Uh(t,r){var i={};return Gr(t)?r.path&&0<r.path.length&&r.Me.push(r.path):qr(t,function(t,e){var n=Vh(e,r.zr(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Mh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof lh||t instanceof Gu||t instanceof Eh||t instanceof Hu)}function xh(t,e,n){if(!Mh(n)||!Lu(n)){var r=Pu(n);throw"an object"===r?e.Nr(t+" a custom object"):e.Nr(t+" "+r)}}function Fh(t,e,n){if(e instanceof zu)return e.Sr;if("string"==typeof e)return Bh(t,e);throw jh("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Bh(t,e,n){try{return function(e){if(0<=e.search(Xu))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Wu.bind.apply(Wu,v([void 0],e.split("."))))}catch(t){throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Sr}catch(e){throw jh(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function jh(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Yr(Qr.INVALID_ARGUMENT,(a+=". ")+t+u)}function qh(t,e){return t.some(function(t){return t.isEqual(e)})}var Gh=(zh.prototype.Zr=function(){return null!=this.uid},zh.prototype.to=function(){return this.Zr()?"uid:"+this.uid:"anonymous-user"},zh.prototype.isEqual=function(t){return t.uid===this.uid},zh);function zh(t){this.uid=t}function Wh(t,e){this.user=e,this.type="OAuth",this.so={},this.so.Authorization="Bearer "+t}function Xh(t){this.key=t}function Hh(t){this.key=t}function Qh(t,e,n){this.query=t,this.targetId=e,this.view=n}function Yh(t){this.key=t,this.ja=!1}function $h(){this.pu=void 0,this.listeners=[]}Gh.UNAUTHENTICATED=new Gh(null),Gh.eo=new Gh("google-credentials-uid"),Gh.no=new Gh("first-party-uid");var Kh,Jh,Zh,tc,ec=(qc.prototype.getToken=function(){return Promise.resolve(null)},qc.prototype.ro=function(){},qc.prototype.oo=function(t){(this.io=t)(Gh.UNAUTHENTICATED)},qc.prototype.ho=function(){this.io=null},qc),nc=(jc.prototype.getToken=function(){var e=this,n=this.co,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.co!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Wh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},jc.prototype.ro=function(){this.forceRefresh=!0},jc.prototype.oo=function(t){this.io=t,this.uo&&t(this.currentUser)},jc.prototype.ho=function(){this.auth&&this.auth.removeAuthTokenListener(this.ao),this.ao=null,this.io=null},jc.prototype.lo=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new Gh(t)},jc),rc=(Object.defineProperty(Bc.prototype,"so",{get:function(){var t={"X-Goog-AuthUser":this.fo},e=this._o.auth.do([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Bc),ic=(Fc.prototype.getToken=function(){return Promise.resolve(new rc(this._o,this.fo))},Fc.prototype.oo=function(t){t(Gh.no)},Fc.prototype.ho=function(){},Fc.prototype.ro=function(){},Fc),oc=(xc.prototype.Ro=function(){return 1===this.state||2===this.state||4===this.state},xc.prototype.Ao=function(){return 2===this.state},xc.prototype.start=function(){3!==this.state?this.auth():this.Po()},xc.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},xc.prototype.Vo=function(){this.state=0,this.Ls.reset()},xc.prototype.po=function(){var t=this;this.Ao()&&null===this.Io&&(this.Io=this.ss.ws(this.wo,6e4,function(){return t.yo()}))},xc.prototype.vo=function(t){this.bo(),this.stream.send(t)},xc.prototype.yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ao()?[2,this.close(0)]:[2]})})},xc.prototype.bo=function(){this.Io&&(this.Io.cancel(),this.Io=null)},xc.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.bo(),this.Ls.cancel(),this.mo++,3!==e?this.Ls.reset():n&&n.code===Qr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Ls._s()):n&&n.code===Qr.UNAUTHENTICATED&&this.Eo.ro(),null!==this.stream&&(this.So(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Co(n)];case 1:return t.sent(),[2]}})})},xc.prototype.So=function(){},xc.prototype.auth=function(){var n=this;this.state=1;var t=this.Do(this.mo),e=this.mo;this.Eo.getToken().then(function(t){n.mo===e&&n.Fo(t)},function(e){t(function(){var t=new Yr(Qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.$o(t)})})},xc.prototype.Fo=function(t){var e=this,n=this.Do(this.mo);this.stream=this.No(t),this.stream.ko(function(){n(function(){return e.state=2,e.listener.ko()})}),this.stream.Co(function(t){n(function(){return e.$o(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},xc.prototype.Po=function(){var t=this;this.state=4,this.Ls.fs(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},xc.prototype.$o=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},xc.prototype.Do=function(e){var n=this;return function(t){n.ss.Cs(function(){return n.mo===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},xc),sc=(n(Mc,Zh=oc),Mc.prototype.No=function(t){return this.To.xo("Listen",t)},Mc.prototype.onMessage=function(t){this.Ls.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Le?(kr(void 0===i||"string"==typeof i),mi.fromBase64String(i||"")):(kr(void 0===i||i instanceof Uint8Array),mi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Xi(s,a,u,h&&(r=void 0===(n=h).code?Qr.UNKNOWN:_i(n.code),new Yr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Fo(t,l.document.name),p=Uo(l.document.updateTime),d=new Ms({mapValue:{fields:l.document.fields}}),y=new Hs(f,p,d,{}),c=new zi(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Fo(t,v.document),m=v.readTime?Uo(v.readTime):Kr.min(),w=new Qs(g,m);c=new zi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Fo(t,b.document);c=new zi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Pr();e.filter;var I=e.filter;I.targetId;var T=new bi(I.count||0);c=new Wi(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Kr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Kr.min():Uo(e.readTime)}(t);return this.listener.Oo(e,n)},Mc.prototype.Lo=function(t){var e,n,r,i,o={};o.database=jo(this.serializer),o.addTarget=(e=this.serializer,(r=gi(i=(n=t).target)?{documents:{documents:[Bo(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.g()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof ya?function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Wo(t.field),op:(e=t.op,So[e]),value:t.value}};var e}(t):Pr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Wo((e=t).field),direction:(n=e.dir,Do[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Le||li(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=zo(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Vo(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.vo(o)},Mc.prototype.Mo=function(t){var e={};e.database=jo(this.serializer),e.removeTarget=t,this.vo(e)},Mc),ac=(n(Uc,Jh=oc),Object.defineProperty(Uc.prototype,"Uo",{get:function(){return this.qo},enumerable:!1,configurable:!0}),Uc.prototype.start=function(){this.qo=!1,this.lastStreamToken=void 0,Jh.prototype.start.call(this)},Uc.prototype.So=function(){this.qo&&this.Bo([])},Uc.prototype.No=function(t){return this.To.xo("Write",t)},Uc.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.qo){this.Ls.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(kr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual(Kr.min())&&(n=Uo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new ds(n,r)}(t,i)})):[]),n=Uo(t.commitTime);return this.listener.Wo(n,e)}var r,i;return kr(!t.writeResults||0===t.writeResults.length),this.qo=!0,this.listener.Qo()},Uc.prototype.jo=function(){var t={};t.database=jo(this.serializer),this.vo(t)},Uc.prototype.Bo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Go(e.serializer,t)})};this.vo(n)},Uc),uc=(n(Vc,Kh=function(){}),Vc.prototype.zo=function(){if(this.Go)throw new Yr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},Vc.prototype.start=function(t){this.To=t},Vc.prototype.Ko=function(e,n){var r=this;return this.zo(),this.credentials.getToken().then(function(t){return r.To.Ko(e,n,t)}).catch(function(t){throw t.code===Qr.UNAUTHENTICATED&&r.credentials.ro(),t})},Vc.prototype.Ho=function(e,n){var r=this;return this.zo(),this.credentials.getToken().then(function(t){return r.To.Ho(e,n,t)}).catch(function(t){throw t.code===Qr.UNAUTHENTICATED&&r.credentials.ro(),t})},Vc.prototype.Yo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Go=!1,[2]})})},Vc),hc=(Cc.prototype.nh=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.sh(),0<this.mutations.length)throw new Yr(Qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return d(this,void 0,void 0,function(){var i,e,n,o,r;return y(this,function(t){switch(t.label){case 0:return e={database:jo((i=s).serializer),documents:a.map(function(t){return xo(i.serializer,t)})},[4,i.Ho("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=Fo(t,e.found.name),r=Uo(e.found.updateTime),i=new Ms({mapValue:{fields:e.found.fields}});return new Hs(n,r,i,{})}(e,n):"missing"in n?function(t,e){kr(!!e.missing),kr(!!e.readTime);var n=Fo(t,e.missing),r=Uo(e.readTime);return new Qs(n,r)}(e,n):Pr());o.set(r.key.toString(),r)}),r=[],[2,(a.forEach(function(t){var e=o.get(t.toString());kr(!!e),r.push(e)}),r)]}})})}(this.Xo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Qs||t instanceof Hs?n.ih(t):Pr()}),e)]}})})},Cc.prototype.set=function(t,e){this.write(e.Qr(t,this.Be(t))),this.eh.add(t)},Cc.prototype.update=function(t,e){try{this.write(e.Qr(t,this.rh(t)))}catch(t){this.th=t}this.eh.add(t)},Cc.prototype.delete=function(t){this.write([new Vs(t,this.Be(t))]),this.eh.add(t)},Cc.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:if(this.sh(),this.th)throw this.th;return e=this.Jo,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ni(Zr.N(e));r.mutations.push(new Us(n,r.Be(n)))}),[4,function(r,i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return n={database:jo((e=r).serializer),writes:i.map(function(t){return Go(e.serializer,t)})},[4,e.Ko("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Xo,this.mutations)];case 1:return t.sent(),this.Zo=!0,[2]}})})},Cc.prototype.ih=function(t){var e;if(t instanceof Hs)e=t.version;else{if(!(t instanceof Qs))throw Pr();e=Kr.min()}var n=this.Jo.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Qr.ABORTED,"Document version changed between two reads.")}else this.Jo.set(t.key.toString(),e)},Cc.prototype.Be=function(t){var e=this.Jo.get(t.toString());return!this.eh.has(t)&&e?ys.updateTime(e):ys.je()},Cc.prototype.rh=function(t){var e=this.Jo.get(t.toString());if(this.eh.has(t)||!e)return ys.exists(!0);if(e.isEqual(Kr.min()))throw new Yr(Qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ys.updateTime(e)},Cc.prototype.write=function(t){this.sh(),this.mutations=this.mutations.concat(t)},Cc.prototype.sh=function(){},Cc),cc=(kc.prototype.lh=function(){var t=this;0===this.hh&&(this._h("Unknown"),this.ah=this.Vs.ws("online_state_timeout",1e4,function(){return t.ah=null,t.fh("Backend didn't respond within 10 seconds."),t._h("Offline"),Promise.resolve()}))},kc.prototype.dh=function(t){"Online"===this.state?this._h("Unknown"):(this.hh++,1<=this.hh&&(this.wh(),this.fh("Connection failed 1 times. Most recent error: "+t.toString()),this._h("Offline")))},kc.prototype.set=function(t){this.wh(),this.hh=0,"Online"===t&&(this.uh=!1),this._h(t)},kc.prototype._h=function(t){t!==this.state&&(this.state=t,this.oh(t))},kc.prototype.fh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.uh?(Or(e),this.uh=!1):Sr("OnlineStateTracker",e)},kc.prototype.wh=function(){null!==this.ah&&(this.ah.cancel(),this.ah=null)},kc),lc=(Pc.prototype.start=function(){return this.enableNetwork()},Pc.prototype.enableNetwork=function(){return this.Rh.delete(0),this.Nh()},Pc.prototype.Nh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vh()?(this.kh()?this.xh():this.yh.set("Unknown"),[4,this.Oh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Pc.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rh.add(0),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Offline"),[2]}})})},Pc.prototype.Lh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Ch.stop()];case 1:return t.sent(),[4,this.gh.stop()];case 2:return t.sent(),0<this.Eh.length&&(Sr("RemoteStore","Stopping write stream with "+this.Eh.length+" pending writes"),this.Eh=[]),this.Mh(),[2]}})})},Pc.prototype.qh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","RemoteStore shutting down."),this.Rh.add(5),[4,this.Lh()];case 1:return t.sent(),this.Ah.qh(),this.yh.set("Unknown"),[2]}})})},Pc.prototype.listen=function(t){this.mh.has(t.targetId)||(this.mh.set(t.targetId,t),this.kh()?this.xh():this.gh.Ao()&&this.Uh(t))},Pc.prototype.Bh=function(t){this.mh.delete(t),this.gh.Ao()&&this.Wh(t),0===this.mh.size&&(this.gh.Ao()?this.gh.po():this.Vh()&&this.yh.set("Unknown"))},Pc.prototype.Oe=function(t){return this.mh.get(t)||null},Pc.prototype.xe=function(t){return this.Qh.xe(t)},Pc.prototype.Uh=function(t){this.Ih.de(t.targetId),this.gh.Lo(t)},Pc.prototype.Wh=function(t){this.Ih.de(t),this.gh.Mo(t)},Pc.prototype.xh=function(){this.Ih=new Zi(this),this.gh.start(),this.yh.lh()},Pc.prototype.kh=function(){return this.Vh()&&!this.gh.Ro()&&0<this.mh.size},Pc.prototype.Vh=function(){return 0===this.Rh.size},Pc.prototype.Mh=function(){this.Ih=null},Pc.prototype.vh=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.mh.forEach(function(t,e){n.Uh(t)}),[2]})})},Pc.prototype.bh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Mh(),this.kh()?(this.yh.dh(e),this.xh()):this.yh.set("Unknown"),[2]})})},Pc.prototype.Sh=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.yh.set("Online"),!(i instanceof Xi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.jh(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Gh(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof zi?this.Ih.Pe(i):i instanceof Wi?this.Ih.Ce(i):this.Ih.ye(i),o.isEqual(Kr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Th.qi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.zh(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Gh(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Pc.prototype.Gh=function(n,r){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!iu(n))throw n;return this.Rh.add(1),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Offline"),r=r||function(){return e.Th.qi()},this.Vs.Gs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Rh.delete(1),[4,this.Nh()];case 2:return t.sent(),[2]}})})}),[2]}})})},Pc.prototype.Kh=function(e){var n=this;return e().catch(function(t){return n.Gh(t,e)})},Pc.prototype.zh=function(r){var i=this,t=this.Ih.$e(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.mh.get(e))&&i.mh.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.mh.get(t);n&&(i.mh.set(t,n.tt(mi.Y,n.J)),i.Wh(t),e=new Ti(n.target,t,1,n.sequenceNumber),i.Uh(e))}),this.Qh.Ui(t)},Pc.prototype.jh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.mh.has(i)?[4,this.Qh.Hh(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.mh.delete(i),this.Ih.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Pc.prototype.Oh=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=0<this.Eh.length?this.Eh[this.Eh.length-1].batchId:-1,t.label=1;case 1:if(!this.Yh())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.Th.nr(e)];case 3:return null===(n=t.sent())?(0===this.Eh.length&&this.Ch.po(),[3,7]):(e=n.batchId,this.Xh(n),[3,6]);case 4:return r=t.sent(),[4,this.Gh(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Jh()&&this.Zh(),[2]}})})},Pc.prototype.Yh=function(){return this.Vh()&&this.Eh.length<10},Pc.prototype.ta=function(){return this.Eh.length},Pc.prototype.Xh=function(t){this.Eh.push(t),this.Ch.Ao()&&this.Ch.Uo&&this.Ch.Bo(t.mutations)},Pc.prototype.Jh=function(){return this.Vh()&&!this.Ch.Ro()&&0<this.Eh.length},Pc.prototype.Zh=function(){this.Ch.start()},Pc.prototype.Dh=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Ch.jo(),[2]})})},Pc.prototype.$h=function(){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){for(e=0,n=this.Eh;e<n.length;e++)r=n[e],this.Ch.Bo(r.mutations);return[2]})})},Pc.prototype.Wo=function(i,o){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Eh.shift(),n=xa.from(e,i,o),[4,this.Kh(function(){return r.Qh.ea(n)})];case 1:return t.sent(),[4,this.Oh()];case 2:return t.sent(),[2]}})})},Pc.prototype.Fh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.Ch.Uo?[4,this.na(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Jh()&&this.Zh(),[2]}})})},Pc.prototype.na=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==Qr.ABORTED?(e=this.Eh.shift(),this.Ch.Vo(),[4,this.Kh(function(){return r.Qh.sa(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Oh()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Pc.prototype.ia=function(){return new hc(this.Xo)},Pc.prototype.ph=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rh.add(4),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Unknown"),this.Ch.Vo(),this.gh.Vo(),this.Rh.delete(4),[4,this.Nh()];case 2:return t.sent(),[2]}})})},Pc.prototype.ra=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vs.Hs(),Sr("RemoteStore","RemoteStore received new credentials"),this.Rh.add(3),[4,this.Lh()];case 1:return t.sent(),this.yh.set("Unknown"),[4,this.Qh.ra(e)];case 2:return t.sent(),this.Rh.delete(3),[4,this.Nh()];case 3:return t.sent(),[2]}})})},Pc.prototype.oa=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.Rh.delete(2),[4,this.Nh()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Rh.add(2),[4,this.Lh()]);case 3:t.sent(),this.yh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Pc),fc=(Lc.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Lc.prototype.aa=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Lc.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Lc),pc=(Oc.prototype._a=function(t){},Oc.prototype.fa=function(t,e,n){},Oc.prototype.da=function(t){return this.ca.ha(t),this.la[t]||"not-current"},Oc.prototype.wa=function(t,e,n){this.la[t]=e},Oc.prototype.Ta=function(t){this.ca.aa(t)},Oc.prototype.Ea=function(t){return this.ca.activeTargetIds.has(t)},Oc.prototype.ma=function(t){delete this.la[t]},Oc.prototype.Ia=function(){return this.ca.activeTargetIds},Oc.prototype.Ra=function(t){return this.ca.activeTargetIds.has(t)},Oc.prototype.start=function(){return this.ca=new fc,Promise.resolve()},Oc.prototype.Vi=function(t,e,n){},Oc.prototype.Aa=function(t){},Oc.prototype.qh=function(){},Oc.prototype.es=function(t){},Oc),dc=(Object.defineProperty(Sc.prototype,"va",{get:function(){return this.Pa},enumerable:!1,configurable:!0}),Sc.prototype.ba=function(t,e){var a=this,u=e?e.Sa:new Qi,h=e?e.ga:this.ga,c=e?e.Mt:this.Mt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof Hs?e:null)&&(fa(a.query,r)?r:null),i=!!n&&a.Mt.has(n.key),o=!!r&&(r.Ge||a.Mt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.Ca(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.ya(r,p)||d&&a.ya(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ga:l,Sa:u,Da:f,Mt:c}},Sc.prototype.Ca=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Sc.prototype.Fa=function(t,e,n){var o=this,r=this.ga;this.ga=t.ga,this.Mt=t.Mt;var i=t.Sa.Ot();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ya(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.$a(n);var s=e?this.Na():[],a=0===this.pa.size&&this.Ht?1:0,u=a!==this.Va;return this.Va=a,0!==i.length||u?{snapshot:new Yi(this.query,t.ga,r,i,t.Mt,0==a,u,!1),ka:s}:{ka:s}},Sc.prototype.xa=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Fa({ga:this.ga,Sa:new Qi,Mt:this.Mt,Da:!1},!1)):{ka:[]}},Sc.prototype.Oa=function(t){return!this.Pa.has(t)&&!!this.ga.has(t)&&!this.ga.get(t).Ge},Sc.prototype.$a=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Pa=e.Pa.add(t)}),t.Xt.forEach(function(t){}),t.Jt.forEach(function(t){return e.Pa=e.Pa.delete(t)}),this.Ht=t.Ht)},Sc.prototype.Na=function(){var e=this;if(!this.Ht)return[];var n=this.pa;this.pa=qi(),this.ga.forEach(function(t){e.Oa(t.key)&&(e.pa=e.pa.add(t.key))});var r=[];return n.forEach(function(t){e.pa.has(t)||r.push(new Hh(t))}),this.pa.forEach(function(t){n.has(t)||r.push(new Xh(t))}),r},Sc.prototype.La=function(t){this.Pa=t._r,this.pa=qi();var e=this.ba(t.documents);return this.Fa(e,!0)},Sc.prototype.Ma=function(){return Yi.Bt(this.query,this.ga,this.Mt,0===this.Va)},Sc),yc=(Dc.prototype.run=function(){this.Ua()},Dc.prototype.Ua=function(){var t=this;this.Ls.fs(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new hc(this.Xo),(n=this.Ba(e))&&n.then(function(t){r.Vs.Cs(function(){return e.commit().then(function(){r.gs.resolve(t)}).catch(function(t){r.Wa(t)})})}).catch(function(t){r.Wa(t)}),[2]})})})},Dc.prototype.Ba=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.gs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gs.reject(t),null}},Dc.prototype.Wa=function(t){var e=this;0<this.qa&&this.Qa(t)?(--this.qa,this.Vs.Cs(function(){return e.Ua(),Promise.resolve()})):this.gs.reject(t)},Dc.prototype.Qa=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ni(e)},Dc),vc=(Object.defineProperty(Rc.prototype,"ou",{get:function(){return!0===this.ru},enumerable:!1,configurable:!0}),Rc.prototype.subscribe=function(t){this.Ha=t},Rc.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.hu("listen()"),(r=this.Ya.get(s))?(e=r.targetId,this.za.da(e),n=r.view.Ma(),[3,4]):[3,1];case 1:return[4,this.Th.rr(oa(s))];case 2:return i=t.sent(),o=this.za.da(i.targetId),e=i.targetId,[4,this.au(s,e,"current"===o)];case 3:n=t.sent(),this.ou&&this.Ga.listen(i),t.label=4;case 4:return[2,n]}})})},Rc.prototype.au=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.Th.cr(a,!0)];case 1:return e=t.sent(),n=new dc(a,e._r),r=n.ba(e.documents),i=Ki.Kt(u,h&&"Offline"!==this.onlineState),o=n.Fa(r,this.ou,i),this.uu(u,o.ka),s=new Qh(a,u,n),[2,(this.Ya.set(a,s),this.Xa.has(u)?this.Xa.get(u).push(a):this.Xa.set(u,[a]),o.snapshot)]}})})},Rc.prototype.Bh=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.hu("unlisten()"),e=this.Ya.get(i),1<(n=this.Xa.get(e.targetId)).length?[2,(this.Xa.set(e.targetId,n.filter(function(t){return!ha(t,i)})),void this.Ya.delete(i))]:this.ou?(this.za.Ta(e.targetId),this.za.Ra(e.targetId)?[3,2]:[4,this.Th.ur(e.targetId,!1).then(function(){r.za.ma(e.targetId),r.Ga.Bh(e.targetId),r.cu(e.targetId)}).catch(yu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.cu(e.targetId),[4,this.Th.ur(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Rc.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.hu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Th.bi(i)];case 2:return e=t.sent(),this.za._a(e.batchId),this.lu(e.batchId,o),[4,this._u(e.Ci)];case 3:return t.sent(),[4,this.Ga.Oh()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=cu(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Rc.prototype.runTransaction=function(t,e,n){new yc(t,this.Xo,e,n).run()},Rc.prototype.Ui=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.hu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.Ui(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.tu.get(e);n&&(kr(t.Yt.size+t.Xt.size+t.Jt.size<=1),0<t.Yt.size?n.ja=!0:0<t.Xt.size?kr(n.ja):0<t.Jt.size&&(kr(n.ja),n.ja=!1))}),[4,this._u(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Rc.prototype.xa=function(r,t){var i;(this.ou&&0===t||!this.ou&&1===t)&&(this.hu("applyOnlineStateChange()"),i=[],this.Ya.forEach(function(t,e){var n=e.view.xa(r);n.snapshot&&i.push(n.snapshot)}),this.Ha.fu(r),this.Ha.Oo(i),this.onlineState=r,this.ou&&this.za.Aa(r))},Rc.prototype.Hh=function(a,u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.hu("rejectListens()"),this.za.wa(a,"rejected",u),e=this.tu.get(a),(n=e&&e.key)?(r=(r=new Ri(ni.P)).nt(n,new Qs(n,Kr.min())),i=qi().add(n),o=new $i(Kr.min(),new Map,new Ci(Ur),r,i),[4,this.Ui(o)]):[3,2];case 1:return t.sent(),this.Za=this.Za.remove(n),this.tu.delete(a),this.du(),[3,4];case 2:return[4,this.Th.ur(a,!1).then(function(){return s.cu(a,u)}).catch(yu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Rc.prototype.ea=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.hu("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.Di(r)];case 2:return n=t.sent(),this.wu(e,null),this.Tu(e),this.za.fa(e,"acknowledged"),[4,this._u(n)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Rc.prototype.sa=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.hu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Th.xi(n)];case 2:return e=t.sent(),this.wu(n,r),this.Tu(n),this.za.fa(n,"rejected",r),[4,this._u(e)];case 3:return t.sent(),[3,6];case 4:return[4,yu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Rc.prototype.Eu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.Ga.Vh()||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Th.Mi()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.su.get(e)||[]).push(o),this.su.set(e,n),[3,4]);case 3:return r=t.sent(),i=cu(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Rc.prototype.Tu=function(t){(this.su.get(t)||[]).forEach(function(t){t.resolve()}),this.su.delete(t)},Rc.prototype.mu=function(e){this.su.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Qr.CANCELLED,e))})}),this.su.clear()},Rc.prototype.lu=function(t,e){var n=(n=(n=this.nu[this.currentUser.to()])||new Ri(Ur)).nt(t,e);this.nu[this.currentUser.to()]=n},Rc.prototype.wu=function(t,e){var n,r=this.nu[this.currentUser.to()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.nu[this.currentUser.to()]=r)},Rc.prototype.cu=function(t,e){var n=this;void 0===e&&(e=null),this.za.Ta(t);for(var r=0,i=this.Xa.get(t);r<i.length;r++){var o=i[r];this.Ya.delete(o),e&&this.Ha.Iu(o,e)}this.Xa.delete(t),this.ou&&this.eu.Vr(t).forEach(function(t){n.eu.gr(t)||n.Ru(t)})},Rc.prototype.Ru=function(t){var e=this.Za.get(t);null!==e&&(this.Ga.Bh(e),this.Za=this.Za.remove(t),this.tu.delete(e),this.du())},Rc.prototype.uu=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Xh?(this.eu.tr(i.key,t),this.Au(i)):i instanceof Hh?(Sr("SyncEngine","Document no longer in limbo: "+i.key),this.eu.er(i.key,t),this.eu.gr(i.key)||this.Ru(i.key)):Pr()}},Rc.prototype.Au=function(t){var e=t.key;this.Za.get(e)||(Sr("SyncEngine","New document in limbo: "+e),this.Ja.push(e),this.du())},Rc.prototype.du=function(){for(;0<this.Ja.length&&this.Za.size<this.Ka;){var t=this.Ja.shift(),e=this.iu.next();this.tu.set(e,new Yh(t)),this.Za=this.Za.nt(t,e),this.Ga.listen(new Ti(oa(na(t.path)),e,2,qa.ns))}},Rc.prototype.Pu=function(){return this.Za},Rc.prototype.Vu=function(){return this.Ja},Rc.prototype._u=function(r,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ya.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.ba(r);return n.Da?a.Th.cr(i.query,!1).then(function(t){var e=t.documents;return i.view.ba(e,n)}):n}).then(function(t){var e,n=u&&u.Wt.get(i.targetId),r=i.view.Fa(t,a.ou,n);a.uu(i.targetId,r.ka),r.snapshot&&(a.ou&&a.za.wa(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ja.Xn(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Ha.Oo(o),[4,this.Th.Zi(s)];case 2:return t.sent(),[2]}})})},Rc.prototype.hu=function(t){},Rc.prototype.ra=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Sr("SyncEngine","User change. New user:",n.to()),[4,this.Th.Vi(n)]);case 1:return e=t.sent(),this.currentUser=n,this.mu("'waitForPendingWrites' promise is rejected due to a user change."),this.za.Vi(n,e.gi,e.vi),[4,this._u(e.yi)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Rc.prototype.xe=function(t){var e=this.tu.get(t);if(e&&e.ja)return qi().add(e.key);var n=qi(),r=this.Xa.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],a=this.Ya.get(s),n=n.Dt(a.view.va);return n},Rc),gc=(_c.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(r=this.yu.get(e))||(n=!0,r=new $h),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Qh.listen(e)];case 2:return i.pu=t.sent(),[3,4];case 3:return o=t.sent(),s=cu(o,"Initialization of query '"+la(a.query)+"' failed"),[2,void a.onError(s)];case 4:return this.yu.set(e,r),r.listeners.push(a),a.xa(this.onlineState),r.pu&&a.vu(r.pu)&&this.bu(),[2]}})})},_c.prototype.Bh=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.yu.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.yu.delete(e),this.Qh.Bh(e))]:[2]})})},_c.prototype.Oo=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.yu.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].vu(i)&&(e=!0);s.pu=i}}e&&this.bu()},_c.prototype.Iu=function(t,e){var n=this.yu.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.yu.delete(t)},_c.prototype.fu=function(i){this.onlineState=i;var o=!1;this.yu.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xa(i)&&(o=!0)}),o&&this.bu()},_c.prototype.Su=function(t){this.gu.add(t),t.next()},_c.prototype.Cu=function(t){this.gu.delete(t)},_c.prototype.bu=function(){this.gu.forEach(function(t){t.next()})},_c),mc=(Nc.prototype.vu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Yi(t.query,t.docs,t.Lt,e,t.Mt,t.fromCache,t.qt,!0)}var o=!1;return this.Fu?this.Nu(t)&&(this.Du.next(t),o=!0):this.ku(t,this.onlineState)&&(this.xu(t),o=!0),this.$u=t,o},Nc.prototype.onError=function(t){this.Du.error(t)},Nc.prototype.xa=function(t){this.onlineState=t;var e=!1;return this.$u&&!this.Fu&&this.ku(this.$u,t)&&(this.xu(this.$u),e=!0),e},Nc.prototype.ku=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ou&&n||t.docs._()&&"Offline"!==e)},Nc.prototype.Nu=function(t){if(0<t.docChanges.length)return!0;var e=this.$u&&this.$u.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Nc.prototype.xu=function(t){t=Yi.Bt(t.query,t.docs,t.Mt,t.fromCache),this.Fu=!0,this.Du.next(t)},Nc),wc=(Ac.prototype.Pi=function(t){this.Lu=t},Ac.prototype.Bn=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Kr.min())?this.Mu(e,r):this.Lu.Mn(e,o).next(function(t){var n=s.qu(r,t);return(r.hn()||r.an())&&s.Da(r.en,n,o,i)?s.Mu(e,r):(Dr()<=p.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),la(r)),s.Lu.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Ac.prototype.qu=function(n,t){var r=new Ci(pa(n));return t.forEach(function(t,e){e instanceof Hs&&fa(n,e)&&(r=r.add(e))}),r},Ac.prototype.Da=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Ac.prototype.Mu=function(t,e){return Dr()<=p.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",la(e)),this.Lu.Bn(t,e,Kr.min())},Ac),bc=(Tc.prototype.Wu=function(t){return Fa.resolve(0===this.Fn.length)},Tc.prototype.Si=function(t,e,n,r){var i=this.Uu;this.Uu++,0<this.Fn.length&&this.Fn[this.Fn.length-1];var o=new Ma(i,e,n,r);this.Fn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Bu=this.Bu.add(new gu(u.key,i)),this.$n.Is(t,u.key.path.g())}return Fa.resolve(o)},Tc.prototype.Oi=function(t,e){return Fa.resolve(this.Qu(e))},Tc.prototype.sr=function(t,e){var n=e+1,r=this.ju(n),i=r<0?0:r;return Fa.resolve(this.Fn.length>i?this.Fn[i]:null)},Tc.prototype.Mi=function(){return Fa.resolve(0===this.Fn.length?-1:this.Uu-1)},Tc.prototype.pi=function(t){return Fa.resolve(this.Fn.slice())},Tc.prototype.kn=function(t,e){var n=this,r=new gu(e,0),i=new gu(e,Number.POSITIVE_INFINITY),o=[];return this.Bu.bt([r,i],function(t){var e=n.Qu(t.vr);o.push(e)}),Fa.resolve(o)},Tc.prototype.Un=function(t,e){var r=this,i=new Ci(Ur);return e.forEach(function(t){var e=new gu(t,0),n=new gu(t,Number.POSITIVE_INFINITY);r.Bu.bt([e,n],function(t){i=i.add(t.vr)})}),Fa.resolve(this.Gu(i))},Tc.prototype.zn=function(t,e){var n=e.path,r=n.length+1,i=n;ni.W(i)||(i=i.child(""));var o=new gu(new ni(i),0),s=new Ci(Ur);return this.Bu.St(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===r&&(s=s.add(t.vr)),!0)},o),Fa.resolve(this.Gu(s))},Tc.prototype.Gu=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Qu(t);null!==e&&r.push(e)}),r},Tc.prototype.Li=function(n,r){var i=this;kr(0===this.zu(r.batchId,"removed")),this.Fn.shift();var o=this.Bu;return Fa.forEach(r.mutations,function(t){var e=new gu(t.key,r.batchId);return o=o.delete(e),i.Yi.Ku(n,t.key)}).next(function(){i.Bu=o})},Tc.prototype.Hu=function(t){},Tc.prototype.gr=function(t,e){var n=new gu(e,0),r=this.Bu.Ct(n);return Fa.resolve(e.isEqual(r&&r.key))},Tc.prototype.ki=function(t){return this.Fn.length,Fa.resolve()},Tc.prototype.zu=function(t,e){return this.ju(t)},Tc.prototype.ju=function(t){return 0===this.Fn.length?0:t-this.Fn[0].batchId},Tc.prototype.Qu=function(t){var e=this.ju(t);return e<0||e>=this.Fn.length?null:this.Fn[e]},Tc),Ec=(Ic.prototype.Ki=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Yu(e);return this.docs=this.docs.nt(r,{Xu:e,size:s,readTime:n}),this.size+=s-o,this.$n.Is(t,r.path.g())},Ic.prototype.zi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ic.prototype.On=function(t,e){var n=this.docs.get(e);return Fa.resolve(n?n.Xu:null)},Ic.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Xu:null)}),Fa.resolve(r)},Ic.prototype.Bn=function(t,e,n){for(var r=Fi,i=new ni(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),a=s.key,u=s.value,h=u.Xu,c=u.readTime;if(!e.path.C(a.path))break;c.o(n)<=0||h instanceof Hs&&fa(e,h)&&(r=r.nt(h.key,h))}return Fa.resolve(r)},Ic.prototype.Ju=function(t,e){return Fa.forEach(this.docs,function(t){return e(t)})},Ic.prototype.Fi=function(t){return new Ic.Zu(this)},Ic.prototype.tc=function(t){return Fa.resolve(this.size)},Ic);function Ic(t,e){this.$n=t,this.Yu=e,this.docs=new Ri(ni.P),this.size=0}function Tc(t,e){this.$n=t,this.Yi=e,this.Fn=[],this.Uu=1,this.Bu=new Ci(gu.Er)}function Ac(){}function Nc(t,e,n){this.query=t,this.Du=e,this.Fu=!1,this.$u=null,this.onlineState="Unknown",this.options=n||{}}function _c(t){this.Qh=t,this.yu=new Hr(ca,ha),this.onlineState="Unknown",this.gu=new Set,this.Qh.subscribe(this)}function Rc(t,e,n,r,i,o){this.Th=t,this.Ga=e,this.Xo=n,this.za=r,this.currentUser=i,this.Ka=o,this.Ha=null,this.Ya=new Hr(ca,ha),this.Xa=new Map,this.Ja=[],this.Za=new Ri(ni.P),this.tu=new Map,this.eu=new vu,this.nu={},this.su=new Map,this.iu=Za.Ps(),this.onlineState="Unknown",this.ru=void 0}function Dc(t,e,n,r){this.Vs=t,this.Xo=e,this.updateFunction=n,this.gs=r,this.qa=5,this.Ls=new $a(this.Vs,"transaction_retry")}function Sc(t,e){this.query=t,this.Pa=e,this.Va=null,this.Ht=!1,this.pa=qi(),this.Mt=qi(),this.ya=pa(t),this.ga=new Hi(this.ya)}function Oc(){this.ca=new fc,this.la={},this.oh=null,this.Jn=null}function Lc(){this.activeTargetIds=Gi}function Pc(t,e,n,r,i){var o,s,a,u,h,c,l,f,p=this;this.Th=t,this.Xo=e,this.Vs=n,this.Eh=[],this.mh=new Map,this.Ih=null,this.Rh=new Set,this.Ah=i,this.Ah.Ph(function(t){n.Cs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Vh()?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,this.ph()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.yh=new cc(n,r),this.gh=(h=this.Xo,c=n,l={ko:this.vh.bind(this),Co:this.bh.bind(this),Oo:this.Sh.bind(this)},(f=h).zo(),new sc(c,f.To,f.credentials,f.serializer,l)),this.Ch=(o=this.Xo,s=n,a={ko:this.Dh.bind(this),Co:this.Fh.bind(this),Qo:this.$h.bind(this),Wo:this.Wo.bind(this)},(u=o).zo(),new ac(s,u.To,u.credentials,u.serializer,a))}function kc(t,e){this.Vs=t,this.oh=e,this.state="Unknown",this.hh=0,this.ah=null,this.uh=!0}function Cc(t){this.Xo=t,this.Jo=new Map,this.mutations=[],this.Zo=!1,this.th=null,this.eh=new Set}function Vc(t,e){var n=this;return(n=Kh.call(this)||this).credentials=t,n.serializer=e,n.Go=!1,n}function Uc(t,e,n,r,i){var o=this;return(o=Jh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.qo=!1,o}function Mc(t,e,n,r,i){var o=this;return(o=Zh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function xc(t,e,n,r,i,o){this.ss=t,this.wo=n,this.To=r,this.Eo=i,this.listener=o,this.state=0,this.mo=0,this.Io=null,this.stream=null,this.Ls=new $a(t,e)}function Fc(t,e){this._o=t,this.fo=e}function Bc(t,e){this._o=t,this.fo=e,this.type="FirstParty",this.user=Gh.no}function jc(t){var e=this;this.ao=null,this.currentUser=Gh.UNAUTHENTICATED,this.uo=!1,this.co=0,this.io=null,this.forceRefresh=!1,this.ao=function(){e.co++,e.currentUser=e.lo(),e.uo=!0,e.io&&e.io(e.currentUser)},this.co=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.ao):(this.ao(null),t.get().then(function(t){e.auth=t,e.ao&&e.auth.addAuthTokenListener(e.ao)},function(){}))}function qc(){this.io=null}function Gc(t){var e=this;return(e=tc.call(this)||this).oc=t,e}function zc(){this.Ci=new Hr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ec=!1}Ec.Zu=(Object.defineProperty(zc.prototype,"readTime",{get:function(){return this.nc},set:function(t){this.nc=t},enumerable:!1,configurable:!0}),zc.prototype.Ki=function(t,e){this.sc(),this.readTime=e,this.Ci.set(t.key,t)},zc.prototype.zi=function(t,e){this.sc(),e&&(this.readTime=e),this.Ci.set(t,null)},zc.prototype.On=function(t,e){this.sc();var n=this.Ci.get(e);return void 0!==n?Fa.resolve(n):this.ic(t,e)},zc.prototype.getEntries=function(t,e){return this.rc(t,e)},zc.prototype.apply=function(t){return this.sc(),this.ec=!0,this.Fa(t)},zc.prototype.sc=function(){},n(Gc,tc=zc),Gc.prototype.Fa=function(n){var r=this,i=[];return this.Ci.forEach(function(t,e){e?i.push(r.oc.Ki(n,e,r.readTime)):r.oc.zi(t)}),Fa.Sn(i)},Gc.prototype.ic=function(t,e){return this.oc.On(t,e)},Gc.prototype.rc=function(t,e){return this.oc.getEntries(t,e)},Gc);var Wc,Xc=(ml.prototype.ge=function(t,n){return this.hc.forEach(function(t,e){return n(e)}),Fa.resolve()},ml.prototype.qi=function(t){return Fa.resolve(this.lastRemoteSnapshotVersion)},ml.prototype.lc=function(t){return Fa.resolve(this.ac)},ml.prototype.hr=function(t){return this.highestTargetId=this.cc.next(),Fa.resolve(this.highestTargetId)},ml.prototype.Xi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ac&&(this.ac=e),Fa.resolve()},ml.prototype._c=function(t){this.hc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.cc=new Za(e),this.highestTargetId=e),t.sequenceNumber>this.ac&&(this.ac=t.sequenceNumber)},ml.prototype.ar=function(t,e){return this._c(e),this.targetCount+=1,Fa.resolve()},ml.prototype.Gi=function(t,e){return this._c(e),Fa.resolve()},ml.prototype.fc=function(t,e){return this.hc.delete(e.target),this.uc.Vr(e.targetId),--this.targetCount,Fa.resolve()},ml.prototype.dc=function(n,r,i){var o=this,s=0,a=[];return this.hc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hc.delete(t),a.push(o.wc(n,e.targetId)),s++)}),Fa.Sn(a).next(function(){return s})},ml.prototype.Tc=function(t){return Fa.resolve(this.targetCount)},ml.prototype.or=function(t,e){var n=this.hc.get(e)||null;return Fa.resolve(n)},ml.prototype.Wi=function(t,e,n){return this.uc.Rr(e,n),Fa.resolve()},ml.prototype.Bi=function(e,t,n){this.uc.Pr(t,n);var r=this.persistence.Yi,i=[];return r&&t.forEach(function(t){i.push(r.Ku(e,t))}),Fa.Sn(i)},ml.prototype.wc=function(t,e){return this.uc.Vr(e),Fa.resolve()},ml.prototype.lr=function(t,e){var n=this.uc.yr(e);return Fa.resolve(n)},ml.prototype.gr=function(t,e){return Fa.resolve(this.uc.gr(e))},ml),Hc=(gl.prototype.start=function(){return Promise.resolve()},gl.prototype.qh=function(){return this.Ic=!1,Promise.resolve()},Object.defineProperty(gl.prototype,"Ac",{get:function(){return this.Ic},enumerable:!1,configurable:!0}),gl.prototype.Pc=function(){},gl.prototype.Vc=function(){},gl.prototype.Ai=function(){return this.$n},gl.prototype.wi=function(t){var e=this.Ec[t.to()];return e||(e=new bc(this.$n,this.Yi),this.Ec[t.to()]=e),e},gl.prototype.Ii=function(){return this.mi},gl.prototype.Ei=function(){return this.Dn},gl.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Qc(this.mc.next());return this.Yi.pc(),n(i).next(function(t){return r.Yi.yc(i).next(function(){return t})}).vn().then(function(t){return i.gc(),t})},gl.prototype.vc=function(e,n){return Fa.Cn(Object.values(this.Ec).map(function(t){return function(){return t.gr(e,n)}}))},gl),Qc=(vl.prototype.Sc=function(t){this.bc.push(t)},vl.prototype.gc=function(){this.bc.forEach(function(t){return t()})},n(yl,Wc=vl),yl),Yc=(dl.Fc=function(t){return new dl(t)},Object.defineProperty(dl.prototype,"$c",{get:function(){if(this.Dc)return this.Dc;throw Pr()},enumerable:!1,configurable:!0}),dl.prototype.tr=function(t,e,n){return this.Cc.tr(n,e),this.$c.delete(n),Fa.resolve()},dl.prototype.er=function(t,e,n){return this.Cc.er(n,e),this.$c.add(n),Fa.resolve()},dl.prototype.Ku=function(t,e){return this.$c.add(e),Fa.resolve()},dl.prototype.removeTarget=function(t,e){var n=this;this.Cc.Vr(e.targetId).forEach(function(t){return n.$c.add(t)});var r=this.persistence.Ii();return r.lr(t,e.targetId).next(function(t){t.forEach(function(t){return n.$c.add(t)})}).next(function(){return r.fc(t,e)})},dl.prototype.pc=function(){this.Dc=new Set},dl.prototype.yc=function(t){var n=this,r=this.persistence.Ei().Fi();return Fa.forEach(this.$c,function(e){return n.Nc(t,e).next(function(t){t||r.zi(e)})}).next(function(){return n.Dc=null,r.apply(t)})},dl.prototype.Hi=function(t,e){var n=this;return this.Nc(t,e).next(function(t){t?n.$c.delete(e):n.$c.add(e)})},dl.prototype.Rc=function(t){return 0},dl.prototype.Nc=function(t,e){var n=this;return Fa.Cn([function(){return Fa.resolve(n.Cc.gr(e))},function(){return n.persistence.Ii().gr(t,e)},function(){return n.persistence.vc(t,e)}])},dl),$c=(pl.prototype.ko=function(t){this.Oc=t},pl.prototype.Co=function(t){this.Lc=t},pl.prototype.onMessage=function(t){this.Mc=t},pl.prototype.close=function(){this.xc()},pl.prototype.send=function(t){this.kc(t)},pl.prototype.qc=function(){this.Oc()},pl.prototype.Uc=function(t){this.Lc(t)},pl.prototype.Bc=function(t){this.Mc(t)},pl),Kc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Jc=(fl.prototype.Qc=function(t,e){if(e)for(var n in e.so)e.so.hasOwnProperty(n)&&(t[n]=e.so[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2-20206291717"},fl.prototype.Ko=function(u,r,i){var h=this,c=this.jc(u);return new Promise(function(o,s){var a=new Tr;a.listenOnce(Er.COMPLETE,function(){try{switch(a.getLastErrorCode()){case br.NO_ERROR:var t=a.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:Sr("Connection",'RPC "'+u+'" timed out'),s(new Yr(Qr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=a.getStatus();Sr("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Qr).indexOf(i)?i:Qr.UNKNOWN,s(new Yr(n,e.message))):s(new Yr(Qr.UNKNOWN,"Server responded with status "+a.getStatus())):(Sr("Connection",'RPC "'+u+'" failed'),s(new Yr(Qr.UNAVAILABLE,"Connection failed.")));break;default:Pr()}}finally{Sr("Connection",'RPC "'+u+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Sr("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Qc(n,i),a.send(c,"POST",e,n,15)})},fl.prototype.Ho=function(t,e,n){return this.Ko(t,e,n)},fl.prototype.xo=function(t,e){var n,r,i=[this.Wc,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Qc(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Sr("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new $c({kc:function(t){l?Sr("Connection","Not sending because WebChannel is closed:",t):(c||(Sr("Connection","Opening WebChannel transport."),h.open(),c=!0),Sr("Connection","WebChannel sending:",t),h.send(t))},xc:function(){return h.close()}});return u(Ir.EventType.OPEN,function(){l||Sr("Connection","WebChannel transport opened.")}),u(Ir.EventType.CLOSE,function(){l||(l=!0,Sr("Connection","WebChannel transport closed"),f.Uc())}),u(Ir.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=p.WARN&&(e=n.map(Lr),Rr.warn.apply(Rr,v(["Firestore ("+_r+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.Uc(new Yr(Qr.UNAVAILABLE,"The operation could not be completed")))}),u(Ir.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(kr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Sr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ei[i];if(void 0!==t)return _i(t)}(),s=r.message,void 0===o&&(o=Qr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.Uc(new Yr(o,s)),h.close()):(Sr("Connection","WebChannel received:",n),f.Bc(n)))}),setTimeout(function(){f.qc()},0),f},fl.prototype.jc=function(t){var e=Kc[t];return this.Wc+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},fl),Zc=(ll.prototype.Ph=function(t){this.Yc.push(t)},ll.prototype.qh=function(){window.removeEventListener("online",this.Gc),window.removeEventListener("offline",this.Kc)},ll.prototype.Xc=function(){window.addEventListener("online",this.Gc),window.addEventListener("offline",this.Kc)},ll.prototype.zc=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Yc;t<e.length;t++)(0,e[t])(0)},ll.prototype.Hc=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Yc;t<e.length;t++)(0,e[t])(1)},ll.Jc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ll),tl=(cl.prototype.Ph=function(t){},cl.prototype.qh=function(){},cl),el="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",nl=(hl.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.za=this.Zc(e),this.persistence=this.tl(e),[4,this.persistence.start()];case 1:return t.sent(),this.el=this.nl(e),this.Th=this.sl(e),[2]}})})},hl.prototype.nl=function(t){return null},hl.prototype.sl=function(t){return e=this.persistence,n=new wc,r=t.il,new pu(e,n,r);var e,n,r},hl.prototype.tl=function(t){if(t.ol.rl)throw new Yr(Qr.FAILED_PRECONDITION,el);return new Hc(Yc.Fc)},hl.prototype.Zc=function(t){return new pc},hl.prototype.clearPersistence=function(t,e){throw new Yr(Qr.FAILED_PRECONDITION,el)},hl),rl=(ul.prototype.initialize=function(r,i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return this.Th?[2]:(this.Th=r.Th,this.za=r.za,this.Xo=this.hl(i),[4,this.al(i)]);case 1:return e=t.sent(),this.Xo.start(e),this.Ga=this.ul(i),this.Qh=this.cl(i),this.ll=this._l(i),this.za.oh=function(t){return n.Qh.xa(t,1)},this.Ga.Qh=this.Qh,[4,this.Ga.start()];case 2:return t.sent(),[4,this.Ga.oa(this.Qh.ou)];case 3:return t.sent(),[2]}})})},ul.prototype.al=function(t){return e=t.fl,Promise.resolve(new Jc(e));var e},ul.prototype._l=function(t){return new gc(this.Qh)},ul.prototype.hl=function(t){var e=wh(t.fl.s),n=t.credentials;return new uc(n,e)},ul.prototype.ul=function(t){var e=this;return new lc(this.Th,this.Xo,t.Vs,function(t){return e.Qh.xa(t,0)},new(Zc.Jc()?Zc:tl))},ul.prototype.cl=function(t){return e=this.Th,n=this.Ga,r=this.Xo,i=this.za,o=t.il,s=t.Ka,a=!t.ol.rl||!t.ol.synchronizeTabs,u=new vc(e,n,r,i,o,s),a&&(u.ru=!0),u;var e,n,r,i,o,s,a,u},ul),il=(al.prototype.start=function(t,e,n,r){var i=this;this.dl(),this.fl=t;var o=new Ya,s=new Ya,a=!1;return this.credentials.oo(function(t){return a?void i.Vs.Gs(function(){return i.Ga.ra(t)}):(a=!0,Sr("FirestoreClient","Initializing. user=",t.uid),i.wl(e,n,r,t,s).then(o.resolve,o.reject))}),this.Vs.Cs(function(){return o.promise}),s.promise},al.prototype.enableNetwork=function(){var t=this;return this.dl(),this.Vs.enqueue(function(){return t.persistence.Vc(!0),t.Ga.enableNetwork()})},al.prototype.wl=function(i,o,s,a,u){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Vs:this.Vs,fl:this.fl,clientId:this.clientId,credentials:this.credentials,il:a,Ka:100,ol:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.za=i.za,this.Th=i.Th,this.el=i.el,this.Ga=o.Ga,this.Qh=o.Qh,this.Tl=o.ll,this.persistence.Pc(function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.El(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.wl(new nl,new rl,{rl:!1},a,u))];case 4:return[2]}})})},al.prototype.El=function(t){return"FirebaseError"===t.name?t.code===Qr.FAILED_PRECONDITION||t.code===Qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},al.prototype.dl=function(){if(this.Vs.qs)throw new Yr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},al.prototype.disableNetwork=function(){var t=this;return this.dl(),this.Vs.enqueue(function(){return t.persistence.Vc(!1),t.Ga.disableNetwork()})},al.prototype.terminate=function(){var t=this;return this.Vs.js(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.el&&this.el.stop(),[4,this.Ga.qh()];case 1:return t.sent(),[4,this.za.qh()];case 2:return t.sent(),[4,this.persistence.qh()];case 3:return t.sent(),this.credentials.ho(),[2]}})})})},al.prototype.waitForPendingWrites=function(){var t=this;this.dl();var e=new Ya;return this.Vs.Cs(function(){return t.Qh.Eu(e)}),e.promise},al.prototype.listen=function(t,e,n){var r=this;this.dl();var i=new mc(t,e,n);return this.Vs.Cs(function(){return r.Tl.listen(i)}),i},al.prototype.Bh=function(t){var e=this;this.ml||this.Vs.Cs(function(){return e.Tl.Bh(t)})},al.prototype.Il=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.dl(),i=new Ya,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Th.ir(o)];case 1:return(e=t.sent())instanceof Hs?i.resolve(e):e instanceof Qs?i.resolve(null):i.reject(new Yr(Qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=cu(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},al.prototype.Rl=function(u){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return this.dl(),a=new Ya,[4,this.Vs.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Th.cr(u,!0)];case 1:return e=t.sent(),n=new dc(u,e._r),r=n.ba(e.documents),i=n.Fa(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=cu(o,"Failed to execute query '"+u+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})},al.prototype.write=function(t){var e=this;this.dl();var n=new Ya;return this.Vs.Cs(function(){return e.Qh.write(t,n)}),n.promise},al.prototype.s=function(){return this.fl.s},al.prototype.Su=function(t){var e=this;this.dl(),this.Vs.Cs(function(){return e.Tl.Su(t),Promise.resolve()})},al.prototype.Cu=function(t){var e=this;this.ml||this.Vs.Cs(function(){return e.Tl.Cu(t),Promise.resolve()})},Object.defineProperty(al.prototype,"ml",{get:function(){return this.Vs.qs},enumerable:!1,configurable:!0}),al.prototype.transaction=function(t){var e=this;this.dl();var n=new Ya;return this.Vs.Cs(function(){return e.Qh.runTransaction(e.Vs,t,n),Promise.resolve()}),n.promise},al),ol=(sl.prototype.next=function(t){this.Al(this.observer.next,t)},sl.prototype.error=function(t){this.Al(this.observer.error,t)},sl.prototype.Pl=function(){this.muted=!0},sl.prototype.Al=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},sl);function sl(t){this.observer=t,this.muted=!1}function al(t,e){this.credentials=t,this.Vs=e,this.clientId=Cr.t()}function ul(){}function hl(){}function cl(){}function ll(){var t=this;this.Gc=function(){return t.zc()},this.Kc=function(){return t.Hc()},this.Yc=[],this.Xc()}function fl(t){this.s=t.s;var e=t.ssl?"https":"http";this.Wc=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function pl(t){this.kc=t.kc,this.xc=t.xc}function dl(t){this.persistence=t,this.Cc=new vu,this.Dc=null}function yl(t){var e=this;return(e=Wc.call(this)||this).Qi=t,e}function vl(){this.bc=[]}function gl(t){var e=this;this.Ec={},this.mc=new qa(0),this.Ic=!1,this.Ic=!0,this.Yi=t(this),this.mi=new Xc(this),this.$n=new Ka,this.Dn=new Ec(this.$n,function(t){return e.Yi.Rc(t)})}function ml(t){this.persistence=t,this.hc=new Hr(yi,vi),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.ac=0,this.uc=new vu,this.targetCount=0,this.cc=Za.As()}function wl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var bl=(_l.prototype.yl=function(t){switch(fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.gl(t.timestampValue);case 4:return this.vl(t);case 5:return t.stringValue;case 6:return new Gu(Eo(t.bytesValue));case 7:return this.bl(t.referenceValue);case 8:return this.Sl(t.geoPointValue);case 9:return this.Cl(t.arrayValue);case 10:return this.Dl(t.mapValue);default:throw Pr()}},_l.prototype.Dl=function(t){var n=this,r={};return qr(t.fields||{},function(t,e){r[t]=n.yl(e)}),r},_l.prototype.Sl=function(t){return new lh(bo(t.latitude),bo(t.longitude))},_l.prototype.Cl=function(t){var e=this;return(t.values||[]).map(function(t){return e.yl(t)})},_l.prototype.vl=function(t){switch(this.Vl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ho(n)?t(n):n}(t);return null==e?null:this.yl(e);case"estimate":return this.gl(co(t));default:return null}},_l.prototype.gl=function(t){var e=wo(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},_l.prototype.bl=function(t){var e=Zr.N(t);kr(Xo(e));var n=new Fr(e.get(1),e.get(3)),r=new ni(e.p(5));return n.isEqual(this.s)||Or("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.pl(r)},_l),El=lu.oi,Il=(Nl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Nl),Tl=(Object.defineProperty(Al.prototype,"Bl",{get:function(){return this.Wl||(this.Wl=new Dh(this.Ur,this.Ul.ignoreUndefinedProperties)),this.Wl},enumerable:!1,configurable:!0}),Al.prototype.settings=function(t){Eu("Firestore.settings",arguments,1),Au("Firestore.settings","object",1,t);var e=new Il(t);if(this.Ol&&!this.Ul.isEqual(e))throw new Yr(Qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ul=e).credentials&&(this.ql=function(t){if(!t)return new ec;switch(t.type){case"gapi":var e=t.Ql;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ic(e,t.fo||"0");case"provider":return t.Ql;default:throw new Yr(Qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Al.prototype.enableNetwork=function(){return this.xl(),this.Ol.enableNetwork()},Al.prototype.disableNetwork=function(){return this.xl(),this.Ol.disableNetwork()},Al.prototype.enablePersistence=function(t){var e,n;if(this.Ol)throw new Yr(Qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Yr(Qr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.jl(this.Fl,this.$l,{rl:!0,cacheSizeBytes:this.Ul.cacheSizeBytes,synchronizeTabs:r,Gl:i})},Al.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.Ol&&!this.Ol.ml)throw new Yr(Qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ya,[2,(this.kl.Us(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Fl.clearPersistence(this.Ur,this.Ml)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Al.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Al.prototype,"zl",{get:function(){return this.xl(),this.Ol.ml},enumerable:!1,configurable:!0}),Al.prototype.waitForPendingWrites=function(){return this.xl(),this.Ol.waitForPendingWrites()},Al.prototype.onSnapshotsInSync=function(t){if(this.xl(),wl(t))return Rl(this.Ol,t);Au("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Rl(this.Ol,e)},Al.prototype.xl=function(){return this.Ol||this.jl(new nl,new rl,{rl:!1}),this.Ol},Al.prototype.Kl=function(){return new xr(this.Ur,this.Ml,this.Ul.host,this.Ul.ssl,this.Ul.forceLongPolling)},Al.prototype.jl=function(t,e,n){var r=this.Kl();return this.Ol=new il(this.ql,this.kl),this.Ol.start(r,t,e,n)},Al.Ll=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yr(Qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yr(Qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Fr(n)},Object.defineProperty(Al.prototype,"app",{get:function(){if(!this.Nl)throw new Yr(Qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Nl},enumerable:!1,configurable:!0}),Al.prototype.collection=function(t){return Eu("Firestore.collection",arguments,1),Au("Firestore.collection","non-empty string",1,t),this.xl(),new Jl(Zr.N(t),this,null)},Al.prototype.doc=function(t){return Eu("Firestore.doc",arguments,1),Au("Firestore.doc","non-empty string",1,t),this.xl(),Ll.Hl(Zr.N(t),this,null)},Al.prototype.collectionGroup=function(t){if(Eu("Firestore.collectionGroup",arguments,1),Au("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.xl(),new Hl((e=t,new ta(Zr.k(),e)),this,null);var e},Al.prototype.runTransaction=function(e){var n=this;return Eu("Firestore.runTransaction",arguments,1),Au("Firestore.runTransaction","function",1,e),this.xl().transaction(function(t){return e(new Sl(n,t))})},Al.prototype.batch=function(){return this.xl(),new Ol(this)},Object.defineProperty(Al,"logLevel",{get:function(){switch(Dr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Al.setLogLevel=function(t){Eu("Firestore.setLogLevel",arguments,1),Su("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},Al.prototype.Yl=function(){return this.Ul.timestampsInSnapshots},Al);function Al(t,e,n,r){var i=this;if(void 0===n&&(n=new nl),void 0===r&&(r=new rl),this.Fl=n,this.$l=r,this.Nl=null,this.kl=new au,this.INTERNAL={delete:function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.xl(),[4,this.Ol.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Nl=o,this.Ur=Al.Ll(o),this.Ml=o.name,this.ql=new nc(e)}else{var s=t;if(!s.projectId)throw new Yr(Qr.INVALID_ARGUMENT,"Must provide projectId");this.Ur=new Fr(s.projectId,s.database),this.Ml="[DEFAULT]",this.ql=new ec}this.Ul=new Il({})}function Nl(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else _u("settings","non-empty string","host",t.host),this.host=t.host,Ru("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Cu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Ru("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ru("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Ru("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Ru("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=lu.ai;else{if(t.cacheSizeBytes!==El&&t.cacheSizeBytes<lu.hi)throw new Yr(Qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+lu.hi);this.cacheSizeBytes=t.cacheSizeBytes}Ru("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function _l(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Vl=n,this.pl=r}function Rl(t,e){var n=new ol({next:function(){e.next&&e.next()},error:function(t){throw Pr()}});return t.Su(n),function(){n.Pl(),t.Cu(n)}}var Dl,Sl=(Cl.prototype.get=function(t){var n=this;Eu("Transaction.get",arguments,1);var r=of("Transaction.get",t,this.Xl);return this.Jl.nh([r.Br]).then(function(t){if(!t||1!==t.length)return Pr();var e=t[0];if(e instanceof Qs)return new xl(n.Xl,r.Br,null,!1,!1,r.Wr);if(e instanceof Hs)return new xl(n.Xl,r.Br,e,!1,!1,r.Wr);throw Pr()})},Cl.prototype.set=function(t,e,n){Tu("Transaction.set",arguments,2,3);var r=of("Transaction.set",t,this.Xl);n=ef("Transaction.set",n);var i=sf(r.Wr,e,n),o=Lh(this.Xl.Bl,"Transaction.set",r.Br,i,null!==r.Wr,n);return this.Jl.set(r.Br,o),this},Cl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Wu?(Iu("Transaction.update",arguments,3),r=of("Transaction.update",t,this.Xl),kh(this.Xl.Bl,"Transaction.update",r.Br,e,n,o)):(Eu("Transaction.update",arguments,2),r=of("Transaction.update",t,this.Xl),Ph(this.Xl.Bl,"Transaction.update",r.Br,e)),this.Jl.update(r.Br,i),this},Cl.prototype.delete=function(t){Eu("Transaction.delete",arguments,1);var e=of("Transaction.delete",t,this.Xl);return this.Jl.delete(e.Br),this},Cl),Ol=(kl.prototype.set=function(t,e,n){Tu("WriteBatch.set",arguments,2,3),this.e_();var r=of("WriteBatch.set",t,this.Xl);n=ef("WriteBatch.set",n);var i=sf(r.Wr,e,n),o=Lh(this.Xl.Bl,"WriteBatch.set",r.Br,i,null!==r.Wr,n);return this.Zl=this.Zl.concat(o.Qr(r.Br,ys.je())),this},kl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.e_(),i="string"==typeof e||e instanceof Wu?(Iu("WriteBatch.update",arguments,3),r=of("WriteBatch.update",t,this.Xl),kh(this.Xl.Bl,"WriteBatch.update",r.Br,e,n,o)):(Eu("WriteBatch.update",arguments,2),r=of("WriteBatch.update",t,this.Xl),Ph(this.Xl.Bl,"WriteBatch.update",r.Br,e)),this.Zl=this.Zl.concat(i.Qr(r.Br,ys.exists(!0))),this},kl.prototype.delete=function(t){Eu("WriteBatch.delete",arguments,1),this.e_();var e=of("WriteBatch.delete",t,this.Xl);return this.Zl=this.Zl.concat(new Vs(e.Br,ys.je())),this},kl.prototype.commit=function(){return this.e_(),this.t_=!0,0<this.Zl.length?this.Xl.xl().write(this.Zl):Promise.resolve()},kl.prototype.e_=function(){if(this.t_)throw new Yr(Qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},kl),Ll=(n(Pl,Dl=Eh),Pl.Hl=function(t,e,n){if(t.length%2!=0)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new Pl(new ni(t),e,n)},Object.defineProperty(Pl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"parent",{get:function(){return new Jl(this.Br.path.g(),this.firestore,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"path",{get:function(){return this.Br.path.$()},enumerable:!1,configurable:!0}),Pl.prototype.collection=function(t){if(Eu("DocumentReference.collection",arguments,1),Au("DocumentReference.collection","non-empty string",1,t),!t)throw new Yr(Qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Zr.N(t);return new Jl(this.Br.path.child(e),this.firestore,null)},Pl.prototype.isEqual=function(t){if(!(t instanceof Pl))throw Vu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Br.isEqual(t.Br)&&this.Wr===t.Wr},Pl.prototype.set=function(t,e){Tu("DocumentReference.set",arguments,1,2),e=ef("DocumentReference.set",e);var n=sf(this.Wr,t,e),r=Lh(this.firestore.Bl,"DocumentReference.set",this.Br,n,null!==this.Wr,e);return this.Ol.write(r.Qr(this.Br,ys.je()))},Pl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Wu?(Iu("DocumentReference.update",arguments,2),kh(this.firestore.Bl,"DocumentReference.update",this.Br,t,e,r)):(Eu("DocumentReference.update",arguments,1),Ph(this.firestore.Bl,"DocumentReference.update",this.Br,t)),this.Ol.write(n.Qr(this.Br,ys.exists(!0)))},Pl.prototype.delete=function(){return Eu("DocumentReference.delete",arguments,0),this.Ol.write([new Vs(this.Br,ys.je())])},Pl.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Tu("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||wl(i[a])||(Cu("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),Ru("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};wl(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(Au("DocumentReference.onSnapshot","function",a,i[a]),Nu("DocumentReference.onSnapshot","function",a+1,i[a+1]),Nu("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.n_(t))},error:i[a+1],complete:i[a+2]};return Vl(this.Ol,this.Br,h,c)},Pl.prototype.get=function(t){var e,n,r,i,o,s=this;return Tu("DocumentReference.get",arguments,0,1),rf("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.xl().Il(this.Br).then(function(t){return new xl(s.firestore,s.Br,t,!0,t instanceof Hs&&t.Ge,s.Wr)}):(e=this.Ol,n=this.Br,r=t,i=new Ya,o=Vl(e,n,{includeMetadataChanges:!0,Ou:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Yr(Qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Yr(Qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.n_(t)}))},Pl.prototype.withConverter=function(t){return new Pl(this.Br,this.firestore,t)},Pl.prototype.n_=function(t){var e=t.docs.get(this.Br);return new xl(this.firestore,this.Br,e,t.fromCache,t.hasPendingWrites,this.Wr)},Pl);function Pl(t,e,n){var r=this;return(r=Dl.call(this,e.Ur,t,n)||this).Br=t,r.firestore=e,r.Wr=n,r.Ol=r.firestore.xl(),r}function kl(t){this.Xl=t,this.Zl=[],this.t_=!1}function Cl(t,e){this.Xl=t,this.Jl=e}function Vl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new ol({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(na(e.path),o,n);return function(){o.Pl(),t.Bh(s)}}var Ul,Ml=(ql.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ql),xl=(jl.prototype.data=function(t){var e=this;if(Tu("DocumentSnapshot.data",arguments,0,1),t=nf("DocumentSnapshot.data",t),this.s_){if(this.Wr){var n=new Fl(this.Xl,this.Br,this.s_,this.i_,this.r_,null);return this.Wr.fromFirestore(n,t)}return new bl(this.Xl.Ur,this.Xl.Yl(),t.serverTimestamps||"none",function(t){return new Ll(t,e.Xl,null)}).yl(this.s_.Ze())}},jl.prototype.get=function(t,e){var n=this;if(Tu("DocumentSnapshot.get",arguments,1,2),e=nf("DocumentSnapshot.get",e),this.s_){var r=this.s_.data().field(Fh("DocumentSnapshot.get",t,this.Br));if(null!==r)return new bl(this.Xl.Ur,this.Xl.Yl(),e.serverTimestamps||"none",function(t){return new Ll(t,n.Xl,n.Wr)}).yl(r)}},Object.defineProperty(jl.prototype,"id",{get:function(){return this.Br.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"ref",{get:function(){return new Ll(this.Br,this.Xl,this.Wr)},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"exists",{get:function(){return null!==this.s_},enumerable:!1,configurable:!0}),Object.defineProperty(jl.prototype,"metadata",{get:function(){return new Ml(this.r_,this.i_)},enumerable:!1,configurable:!0}),jl.prototype.isEqual=function(t){if(!(t instanceof jl))throw Vu("isEqual","DocumentSnapshot",1,t);return this.Xl===t.Xl&&this.i_===t.i_&&this.Br.isEqual(t.Br)&&(null===this.s_?null===t.s_:this.s_.isEqual(t.s_))&&this.Wr===t.Wr},jl),Fl=(n(Bl,Ul=xl),Bl.prototype.data=function(t){return Ul.prototype.data.call(this,t)},Bl);function Bl(){return null!==Ul&&Ul.apply(this,arguments)||this}function jl(t,e,n,r,i,o){this.Xl=t,this.Br=e,this.s_=n,this.i_=r,this.r_=i,this.Wr=o}function ql(t,e){this.hasPendingWrites=t,this.fromCache=e}function Gl(t,e,n){if("string"==typeof n){if(""===n)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ra(e)&&-1!==n.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Zr.N(n));if(!ni.W(r))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Io(t,new ni(r))}if(n instanceof Eh)return Io(t,n.Br);throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pu(n)+".")}function zl(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Wl(t,e,n){if(!n.isEqual(e))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Xl(t){if(t.an()&&0===t.tn.length)throw new Yr(Qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Hl=(Ql.prototype.where=function(t,e,n){Eu("Query.where",arguments,3),ku("Query.where",3,n);var r,i,o=Su("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Fh("Query.where",t),a=function(t,e,n,r,i,o){var s;if(r.L()){if("array-contains"===i||"array-contains-any"===i)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){zl(o,i);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(Gl(n,t,c))}s={arrayValue:{values:a}}}else s=Gl(n,t,o)}else"in"!==i&&"array-contains-any"!==i||zl(o,i),s=Ch(e,"Query.where",o,"in"===i);var l=ya.create(r,i,s);return function(t,e){if(e instanceof ya){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var a=t.un();null!==a&&Wl(0,e.field,a)}else if(o||i){var u=null;if(o&&(u=t._n(r)),null===u&&i&&(u=t._n(n)),null!==u)throw u===e.op?new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+u.toString()+"' filters.")}}}(t,l),l}(this.o_,this.firestore.Bl,this.firestore.Ur,s,o,n);return new Ql((i=(r=this.o_).filters.concat([a]),new ta(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},Ql.prototype.orderBy=function(t,e){var n;if(Tu("Query.orderBy",arguments,1,2),Nu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Fh("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Ua(e,n),s=o;return null!==(r=t).un()||null!==(i=r.cn())&&Wl(0,i,s.field),o}(this.o_,o,n);return new Ql((i=(r=this.o_).tn.concat([s]),new ta(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.Wr)},Ql.prototype.limit=function(t){return Eu("Query.limit",arguments,1),Au("Query.limit","number",1,t),Uu("Query.limit",1,t),new Ql(sa(this.o_,t,"F"),this.firestore,this.Wr)},Ql.prototype.limitToLast=function(t){return Eu("Query.limitToLast",arguments,1),Au("Query.limitToLast","number",1,t),Uu("Query.limitToLast",1,t),new Ql(sa(this.o_,t,"L"),this.firestore,this.Wr)},Ql.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Iu("Query.startAt",arguments,1);var r=this.h_("Query.startAt",t,e,!0);return new Ql(aa(this.o_,r),this.firestore,this.Wr)},Ql.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Iu("Query.startAfter",arguments,1);var r=this.h_("Query.startAfter",t,e,!1);return new Ql(aa(this.o_,r),this.firestore,this.Wr)},Ql.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Iu("Query.endBefore",arguments,1);var r=this.h_("Query.endBefore",t,e,!0);return new Ql(ua(this.o_,r),this.firestore,this.Wr)},Ql.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Iu("Query.endAt",arguments,1);var r=this.h_("Query.endAt",t,e,!1);return new Ql(ua(this.o_,r),this.firestore,this.Wr)},Ql.prototype.isEqual=function(t){if(!(t instanceof Ql))throw Vu("isEqual","Query",1,t);return this.firestore===t.firestore&&ha(this.o_,t.o_)&&this.Wr===t.Wr},Ql.prototype.withConverter=function(t){return new Ql(this.o_,this.firestore,t)},Ql.prototype.h_=function(c,t,e,n){if(ku(c,1,t),t instanceof xl)return Eu(c,v([t],e),1),function(t,e,n,r){if(!n)throw new Yr(Qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=ia(t);o<s.length;o++){var a=s[o];if(a.field.L())i.push(Io(e,n.key));else{var u=n.field(a.field);if(ho(u))throw new Yr(Qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.$();throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new Ra(i,r)}(this.o_,this.firestore.Ur,t.s_,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Yr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.L()){if("string"!=typeof h)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ra(t)&&-1!==h.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Zr.N(h));if(!ni.W(c))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ni(c);a.push(Io(e,l))}else{var f=Ch(n,r,h);a.push(f)}}return new Ra(a,o)}(this.o_,this.firestore.Ur,this.firestore.Bl,c,r,n)},Ql.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Tu("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||wl(i[u])||(Cu("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),Ru("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),wl(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Au("Query.onSnapshot","function",u,i[u]),Nu("Query.onSnapshot","function",u+1,i[u+1]),Nu("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new Kl(r.firestore,r.o_,t,r.Wr))},error:i[u+1],complete:i[u+2]};return Xl(this.o_),Yl(this.firestore.xl(),this.o_,a,h)},Ql.prototype.get=function(t){var e=this;Tu("Query.get",arguments,0,1),rf("Query.get",t),Xl(this.o_);var n,r,i,o,s,a=this.firestore.xl();return(t&&"cache"===t.source?a.Rl(this.o_):(n=a,r=this.o_,i=t,o=new Ya,s=Yl(n,r,{includeMetadataChanges:!0,Ou:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Kl(e.firestore,e.o_,t,e.Wr)})},Ql);function Ql(t,e,n){this.o_=t,this.firestore=e,this.Wr=n}function Yl(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new ol({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Pl(),t.Bh(s)}}var $l,Kl=(Object.defineProperty(tf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(tf.prototype,"empty",{get:function(){return this.u_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(tf.prototype,"size",{get:function(){return this.u_.docs.size},enumerable:!1,configurable:!0}),tf.prototype.forEach=function(e,n){var r=this;Tu("QuerySnapshot.forEach",arguments,1,2),Au("QuerySnapshot.forEach","function",1,e),this.u_.docs.forEach(function(t){e.call(n,r.__(t,r.metadata.fromCache,r.u_.Mt.has(t.key)))})},Object.defineProperty(tf.prototype,"query",{get:function(){return new Hl(this.a_,this.Xl,this.Wr)},enumerable:!1,configurable:!0}),tf.prototype.docChanges=function(t){t&&(Cu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ru("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.u_.Ut)throw new Yr(Qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.c_&&this.l_===e||(this.c_=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Mt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.u_,e,this.__.bind(this)),this.l_=e),this.c_},tf.prototype.isEqual=function(t){if(!(t instanceof tf))throw Vu("isEqual","QuerySnapshot",1,t);return this.Xl===t.Xl&&ha(this.a_,t.a_)&&this.u_.isEqual(t.u_)&&this.Wr===t.Wr},tf.prototype.__=function(t,e,n){return new Fl(this.Xl,t.key,t,e,n,this.Wr)},tf),Jl=(n(Zl,$l=Hl),Object.defineProperty(Zl.prototype,"id",{get:function(){return this.o_.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"parent",{get:function(){var t=this.o_.path.g();return t._()?null:new Ll(new ni(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Zl.prototype,"path",{get:function(){return this.o_.path.$()},enumerable:!1,configurable:!0}),Zl.prototype.doc=function(t){Tu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Cr.t()),Au("CollectionReference.doc","non-empty string",1,t);var e=Zr.N(t);return Ll.Hl(this.o_.path.child(e),this.firestore,this.Wr)},Zl.prototype.add=function(t){Eu("CollectionReference.add",arguments,1),Au("CollectionReference.add","object",1,this.Wr?this.Wr.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Zl.prototype.withConverter=function(t){return new Zl(this.f_,this.firestore,t)},Zl);function Zl(t,e,n){var r=this;if(((r=$l.call(this,na(t),e,n)||this).f_=t).length%2!=1)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function tf(t,e,n,r){this.Xl=t,this.a_=e,this.u_=n,this.Wr=r,this.c_=null,this.l_=null,this.metadata=new Ml(n.hasPendingWrites,n.fromCache)}function ef(t,e){if(void 0===e)return{merge:!1};if(Cu(t,e,["merge","mergeFields"]),Ru(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Pu(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Wu))throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Pu(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function nf(t,e){return void 0===e?{}:(Cu(t,e,["serverTimestamps"]),Du(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function rf(t,e){Nu(t,"object",1,e),e&&(Cu(t,e,["source"]),Du(t,0,"source",e.source,["default","server","cache"]))}function of(t,e,n){if(e instanceof Eh){if(e.firestore!==n)throw new Yr(Qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Vu(t,"DocumentReference",1,e)}function sf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var af,uf={Firestore:Tl,GeoPoint:lh,Timestamp:$r,Blob:Gu,Transaction:Sl,WriteBatch:Ol,DocumentReference:Ll,DocumentSnapshot:xl,Query:Hl,QueryDocumentSnapshot:Fl,QuerySnapshot:Kl,CollectionReference:Jl,FieldPath:Wu,FieldValue:hh,setLogLevel:Tl.setLogLevel,CACHE_SIZE_UNLIMITED:El};(af=hf).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Tl(e,n,new nl,new rl);var e,n},"PUBLIC").setServiceProps(Object.assign({},uf))),af.registerVersion("@firebase/firestore","1.16.3-20206291717")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});