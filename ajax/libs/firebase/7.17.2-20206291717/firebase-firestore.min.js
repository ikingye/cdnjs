!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(_d){"use strict";try{(function(){_d=_d&&Object.prototype.hasOwnProperty.call(_d,"default")?_d.default:_d;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,f="FirebaseError",v=(n(m,l=Error),m);function m(t,e){var n=l.call(this,e)||this;return n.code=t,n.name=f,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=_||self;function k(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),O=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,R)&&this[R]||(this[R]=++O))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var K,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=S.navigator;if(Y){var Z=Y.userAgent;if(Z){K=Z;break t}}K=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=k;var rt,it,ot=Q(K,"Opera"),st=Q(K,"Trident")||Q(K,"MSIE"),ut=Q(K,"Edge"),at=ut||st,ht=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),ct=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function lt(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",pt=(it=K,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(ft=pt?pt[1]:""),st){var dt=lt();if(null!=dt&&dt>parseFloat(ft)){rt=String(dt);break t}}rt=ft}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=H(String(rt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=S.document&&st&&(lt()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",k,e),S.removeEventListener("test",k,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},j(Et,It);var Tt={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Nt,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function kt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Rt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Ft(r),e&&e[At]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[At]?t.va(e,n,P(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=jt(t);if(h||(t[Pt]=h=new kt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):St(t)))}function Vt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(mt)return Mt(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new Et(e,this))}function jt(t){return(t=t[Pt])instanceof kt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==D(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Bt(){q.call(this),this.c=new kt(this),(this.J=this).C=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(Bt,q),Bt.prototype[At]=!0,(N=Bt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Ft(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,et(t=new It(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=S.JSON.stringify;function Wt(){this.b=this.a=null}var Kt,Ht=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Xt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then(Jt)}),Zt||(Kt(),Zt=!0),$t.add(t,e)}Wt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Wt;function Jt(){for(var t,e,n;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function te(t,e){Bt.call(this),this.b=t||1,this.a=e||S,this.f=V(this.Ya,this),this.g=U()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==D(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(te,Bt),(N=te.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=U()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},N.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=q),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){q.call(this),this.b=t,this.a={}}j(he,q);var ce=[];function le(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Bt}function ge(t){It.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){It.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ie(t){It.call(this,"timingevent",t)}function Ee(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(ge,It),j(we,It),j(Ie,It);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ne(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}Ne.prototype.a=null;var ke,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function xe(){It.call(this,"d")}function Pe(){It.call(this,"c")}function Re(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Le,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(xe,It),j(Pe,It),j(Re,Ne),ke=new Re;var Le=45e3,Ce={},Ve={};function Me(t,e,n){t.H=1,t.i=on($e(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=U(),qe(t),t.l=$e(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ve:(o=Number(i.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>i.length?Ve:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ve){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),We(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Ge(t))}function qe(t){t.U=U()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(V(t.Ua,t),e)}function Be(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n,r,i,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Nn(p.b,t)))if(p.I=t.N,!t.C&&Nn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Qn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ee(V(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ar(p,11)}else if(!t.C&&p.a!=t||or(p),!W(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(_n(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=U()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Sn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Be(l),qe(l)),o.a=c):er(o),0<p.g.length&&Zn(p)):"stop"!=y[0]&&"close"!=y[0]||ar(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ar(p,7):Hn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Be(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Ge(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,u)}this.I?(je(this,e,i),at&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),We(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,qe(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Ge(this)}}}catch(t){}var a,h,c,l,f,p,d},N.Va=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),je(this,t,e),this.b&&4!=t&&qe(this)))},N.cancel=function(){this.A=!0,ze(this)},N.Ua=function(){this.o=null;var t,e,n=U();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Ge(this)):Fe(this,this.U-n)},(N=He.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ze?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function $e(t){return new Ze(t)}function Je(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=un(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?ln:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new He,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Xe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function In(t){this.g=t||En,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=G(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var En=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function kn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(){}function xn(){this.a=new Dn}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}In.prototype.cancel=function(){var t,e;if(this.c=kn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Rn=S.JSON.parse;function On(t){Bt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}j(On,Bt);var Ln="",Cn=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Fn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&(!t.s[1]||4!=Gn(t)||2!=t.X()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Wn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Wn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Wn("baseRetryDelayMs",5e3,t),this.Ma=Wn("retryDelaySeedMs",1e4,t),this.Ja=Wn("forwardChannelMaxRetries",2,t),this.ma=Wn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new In(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Hn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,rn(n=$e(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Jn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=on($e(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=U(),qe(e)),hr(t)}function Qn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Xn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&Zn(t)}function Zn(t){Tn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Jn(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Me(n,r,e)}function Jn(t,n){t.f&&Ke({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ke(t,function(t,e){var n=t;P(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ee(V(t.Aa,t),ur(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Jn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on($e(e)),n.j=null,n.I=!0,Ue(n,t)}function or(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!Nn(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=U()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ie(i)),Zn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ee(V(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ar(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=V(t.Xa,t),n||(n=new Ze("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(n,"https"),on(n)),i=n.toString(),o=r,u=new pe,S.Image?((s=new Image).onload=M(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=M(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=M(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(Pn,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Xn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==kn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Ze?$e(r):new Ze(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=S.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Ze(null,void 0),o&&Je(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&$(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Jn(t,c),c}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function fr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Bt.call(this),this.a=new Kn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){Pe.call(this),this.status=1}function gr(t){this.a=t}(N=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(ke),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new He(this.headers);r&&Ke(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),On.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ta())},N.Ta=function(){qn(this)},N.X=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Kn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=$e(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&zn(i,this.i,r),_n(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Me(n,i,null)):Me(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||Tn(this.b)||$n(this))},N.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(V(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),ir(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),nr(this),be())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(N=fr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},j(dr,Bt),(N=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),Zn(t)},N.close=function(){Hn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,dr.S.G.call(this)},j(yr,xe),j(vr,Pe),j(gr,fr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ae.COMPLETE="complete",(Se.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ae,WebChannel:Se,XhrIo:On},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Ir=mr.EventType,Er=mr.WebChannel,Tr=mr.XhrIo,Ar=(Nr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Nr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Nr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Nr);function Nr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _r="7.17.2-20206291717",Sr=new h("@firebase/firestore");function kr(){return Sr.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=p.DEBUG&&(e=n.map(Pr),Sr.debug.apply(Sr,d(["Firestore ("+_r+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=p.ERROR&&(e=n.map(Pr),Sr.error.apply(Sr,d(["Firestore ("+_r+"): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Or(t){t||Rr()}var Lr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Mr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ur(t){return t+"\0"}function jr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var qr=(Object.defineProperty(Fr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fr.prototype.isEqual=function(t){return t instanceof Fr&&t.projectId===this.projectId&&t.database===this.database},Fr.prototype.o=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Fr);function Fr(t,e){this.projectId=t,this.database=e||"(default)"}function Br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wr,Kr,Hr,Qr=(li.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},li.prototype.has=function(t){return void 0!==this.get(t)},li.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},li.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},li.prototype.forEach=function(u){Gr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},li.prototype._=function(){return zr(this.l)},li),Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(ci,Hr=Error),ci),Zr=(hi.now=function(){return hi.fromMillis(Date.now())},hi.fromDate=function(t){return hi.fromMillis(t.getTime())},hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new hi(e,1e6*(t-1e3*e))},hi.prototype.toDate=function(){return new Date(this.toMillis())},hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hi.prototype.T=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hi),$r=(ai.I=function(t){return new ai(t)},ai.min=function(){return new ai(new Zr(0,0))},ai.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.A=function(){return this.timestamp},ai),Jr=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.P(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ui.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ui.prototype.v=function(){return this.segments[this.offset]},ui.prototype.S=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype._=function(){return 0===this.length},ui.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ui.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Kr=Jr),si.prototype.g=function(t,e,n){return new si(t,e,n)},si.prototype.N=function(){return this.F().join("/")},si.prototype.toString=function(){return this.N()},si.k=function(t){if(0<=t.indexOf("//"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new si(t.split("/").filter(function(t){return 0<t.length}))},si.$=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Wr=Jr),oi.prototype.g=function(t,e,n){return new oi(t,e,n)},oi.M=function(t){return ei.test(t)},oi.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.M(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.N()},oi.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},oi.L=function(){return new oi(["__name__"])},oi.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.$=function(){return new oi([])},oi),ri=(ii.B=function(t){return new ii(ti.k(t).V(5))},ii.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.P(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.P=function(t,e){return ti.P(t.path,e.path)},ii.W=function(t){return t.length%2==0},ii.j=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Wr&&Wr.apply(this,arguments)||this}function si(){return null!==Kr&&Kr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.R=n}function ai(t){this.timestamp=t}function hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ci(t,e){var n=this;return(n=Hr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function li(t,e){this.h=t,this.u=e,this.l={}}function fi(t){return null==t}function pi(t){return-0===t&&1/t==-1/0}function di(t){return"number"==typeof t&&Number.isInteger(t)&&!pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yi(t,e,n,r,i,o,s)}function gi(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),fi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=zu(n.startAt)),n.endAt&&(e+="|ub:",e+=zu(n.endAt)),n.K=e),n.K}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],!(o instanceof _u&&s instanceof _u&&o.op===s.op&&o.field.isEqual(s.field)&&vo(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ku(t.startAt,e.startAt)&&Ku(t.endAt,e.endAt)}function wi(t){return ri.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=(Ii.fromBase64String=function(t){return new Ii(atob(t))},Ii.fromUint8Array=function(t){return new Ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ii.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ii.prototype.H=function(){return 2*this.G.length},Ii.prototype.o=function(t){return Vr(this.G,t.G)},Ii.prototype.isEqual=function(t){return this.G===t.G},Ii);function Ii(t){this.G=t}function Ei(t){this.count=t}bi.Y=new bi("");var Ti,Ai,Ni=(_i.prototype.Z=function(t){return new _i(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_i.prototype.tt=function(t,e){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_i.prototype.et=function(t){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},_i);function _i(t,e,n,r,i,o,s){void 0===i&&(i=$r.min()),void 0===o&&(o=$r.min()),void 0===s&&(s=bi.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Xr.OK:return Rr(),0;case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return 1;default:return Rr(),0}}function ki(t){if(void 0===t)return xr("GRPC error has no .code"),Xr.UNKNOWN;switch(t){case Ti.OK:return Xr.OK;case Ti.CANCELLED:return Xr.CANCELLED;case Ti.UNKNOWN:return Xr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Xr.INTERNAL;case Ti.UNAVAILABLE:return Xr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Xr.NOT_FOUND;case Ti.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case Ti.ABORTED:return Xr.ABORTED;case Ti.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case Ti.DATA_LOSS:return Xr.DATA_LOSS;default:return Rr()}}(Ai=Ti=Ti||{})[Ai.OK=0]="OK",Ai[Ai.CANCELLED=1]="CANCELLED",Ai[Ai.UNKNOWN=2]="UNKNOWN",Ai[Ai.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ai[Ai.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ai[Ai.NOT_FOUND=5]="NOT_FOUND",Ai[Ai.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ai[Ai.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ai[Ai.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ai[Ai.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ai[Ai.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ai[Ai.ABORTED=10]="ABORTED",Ai[Ai.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ai[Ai.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ai[Ai.INTERNAL=13]="INTERNAL",Ai[Ai.UNAVAILABLE=14]="UNAVAILABLE",Ai[Ai.DATA_LOSS=15]="DATA_LOSS";var Di=(Li.prototype.nt=function(t,e){return new Li(this.P,this.root.nt(t,e,this.P).copy(null,null,Pi.st,null,null))},Li.prototype.remove=function(t){return new Li(this.P,this.root.remove(t,this.P).copy(null,null,Pi.st,null,null))},Li.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Li.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Li.prototype._=function(){return this.root._()},Object.defineProperty(Li.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Li.prototype.it=function(){return this.root.it()},Li.prototype.rt=function(){return this.root.rt()},Li.prototype.ot=function(t){return this.root.ot(t)},Li.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Li.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Li.prototype.ht=function(t){return this.root.ht(t)},Li.prototype.at=function(){return new xi(this.root,null,this.P,!1)},Li.prototype.ut=function(t){return new xi(this.root,t,this.P,!1)},Li.prototype.ct=function(){return new xi(this.root,null,this.P,!0)},Li.prototype.lt=function(t){return new xi(this.root,t,this.P,!0)},Li),xi=(Oi.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Oi.prototype.wt=function(){return 0<this.ft.length},Oi.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Oi),Pi=(Ri.prototype.copy=function(t,e,n,r,i){return new Ri(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ri.prototype._=function(){return!1},Ri.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ri.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ri.prototype.min=function(){return this.left._()?this:this.left.min()},Ri.prototype.it=function(){return this.min().key},Ri.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ri.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Ri.prototype.It=function(){if(this.left._())return Ri.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Ri.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return Ri.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ri.prototype.At=function(){return this.color},Ri.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Ri.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},Ri.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Ri.prototype.Vt=function(){var t=this.copy(null,null,Ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ri.prototype.Pt=function(){var t=this.copy(null,null,Ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ri.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ri.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ri.prototype.bt=function(){if(this.At()&&this.left.At())throw Rr();if(this.right.At())throw Rr();var t=this.left.bt();if(t!==this.right.bt())throw Rr();return t+(this.At()?0:1)},Ri);function Ri(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ri.RED,this.left=null!=r?r:Ri.EMPTY,this.right=null!=i?i:Ri.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Li(t,e){this.P=t,this.root=e||Pi.EMPTY}function Ci(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.st=!1,Pi.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.nt=function(t,e,n){return new Pi(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype._=function(){return!0},Ci.prototype.ot=function(t){return!1},Ci.prototype.ht=function(t){return!1},Ci.prototype.it=function(){return null},Ci.prototype.rt=function(){return null},Ci.prototype.At=function(){return!1},Ci.prototype.pt=function(){return!0},Ci.prototype.bt=function(){return 0},new Ci);var Vi=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.it()},qi.prototype.last=function(){return this.data.rt()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},qi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},qi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},qi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},qi.prototype.at=function(){return new Mi(this.data.at())},qi.prototype.ut=function(t){return new Mi(this.data.ut(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype._=function(){return this.data._()},qi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},qi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.P);return e.data=t,e},qi),Mi=(ji.prototype.dt=function(){return this.Ft.dt().key},ji.prototype.wt=function(){return this.Ft.wt()},ji),Ui=new Di(ri.P);function ji(t){this.Ft=t}function qi(t){this.P=t,this.data=new Di(this.P)}var Fi=new Di(ri.P),Bi=new Di(ri.P),Gi=new Vi(ri.P);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Wi=new Vi(Vr);function Ki(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Hi(t,e){this.targetId=t,this.ee=e}function Qi(t,e,n,r){void 0===n&&(n=bi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Xi=(ao.$t=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.Nt.get(t)},ao.prototype.get=function(t){return this.Nt.get(t)},ao.prototype.first=function(){return this.kt.it()},ao.prototype.last=function(){return this.kt.rt()},ao.prototype._=function(){return this.kt._()},ao.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Nt.nt(t.key,t),e.kt.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Nt.remove(t),this.kt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.Nt=t,n.kt=e,n},ao),Yi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Rr()},uo.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},uo),Zi=(so.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Xi.$t(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),$i=(oo.Gt=function(t,e){var n=new Map;return n.set(t,Ji.zt(t,e)),new oo($r.min(),n,Wi,Ui,zi())},oo),Ji=(io.zt=function(t,e){return new io(bi.Y,e,zi(),zi(),zi())},io),to=(Object.defineProperty(ro.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},ro.prototype.ce=function(){var n=zi(),r=zi(),i=zi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Ji(this.ie,this.re,n,r,i)},ro.prototype.le=function(){this.oe=!1,this.se=co()},ro.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},ro.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},ro.prototype.de=function(){this.ne+=1},ro.prototype.we=function(){--this.ne},ro.prototype.Te=function(){this.oe=!0,this.re=!0},ro),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof ru?this.ge(r,t.te):t.te instanceof iu&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},no.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Rr()}})},no.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},no.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(wi(e=o.target)?0===i?(n=new ri(e.path),this.Ve(r,n,new iu(n,$r.min()))):Or(1===i):this.Fe(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},no.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&wi(r.target)&&(n=new ri(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.Ve(e,n,new iu(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=zi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new $i(i,s,this.Re,this.me,r);return this.me=Ui,this.Ae=ho(),this.Re=new Vi(Vr),t},no.prototype.ge=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.$e(e.key).add(t)))},no.prototype.Ve=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.$e(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},no.prototype.removeTarget=function(t){this.Ie.delete(t)},no.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},no.prototype.de=function(t){this.be(t).de()},no.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new to,this.Ie.set(t,e)),e},no.prototype.$e=function(t){var e=this.Ae.get(t);return e||(e=new Vi(Vr),this.Ae=this.Ae.nt(t,e)),e},no.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},no.prototype.Se=function(e){var n=this;this.Ie.set(e,new to),this.Ee.xe(e).forEach(function(t){n.Ve(e,t,null)})},no.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},no);function no(t){this.Ee=t,this.Ie=new Map,this.me=Ui,this.Ae=ho(),this.Re=new Vi(Vr)}function ro(){this.ne=0,this.se=co(),this.ie=bi.Y,this.re=!1,this.oe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function oo(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function uo(){this.xt=new Di(ri.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ri.P(t.key,e.key)}:function(t,e){return ri.P(t.key,e.key)},this.Nt=Fi,this.kt=new Di(this.P)}function ho(){return new Di(ri.P)}function co(){return new Di(ri.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fo(t){var e=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new Zr(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Rr()}function vo(r,i){var t,e,n,o=yo(r);if(o!==yo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return fo(r).isEqual(fo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),n=Io(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,To(r.bytesValue).isEqual(To(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Eo((t=r).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Eo(t.doubleValue),r=Eo(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Mr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Br(t)!==Br(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return Rr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,u,a,h,c,l,f=yo(t),p=yo(e);if(f!==p)return Vr(f,p);switch(f){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Eo(t.integerValue||t.doubleValue))<(l=Eo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Vr(Eo(n.latitude),Eo(r.latitude)))?i:Vr(Eo(n.longitude),Eo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;var a=mo(n[r[s]],i[o[s]]);if(0!==a)return a}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Io(t),r=Io(e),i=Vr(n.seconds,r.seconds);return 0!==i?i:Vr(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Io(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?To(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ri.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Rr();var t,e,n}(t)}function Io(t){if(Or(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e,n=0,r=po.exec(t);Or(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function No(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var xo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ro=function(t,e){this.s=t,this.Oe=e};function Oo(t){return{integerValue:""+t}}function Lo(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Co(t,e){return di(e)?Oo(e):Lo(t,e)}function Vo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Uo(t){return Or(!!t),$r.I((e=Io(t),new Zr(e.seconds,e.nanos)));var e}function jo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function qo(t){var e=ti.k(t);return Or(ns(e)),e}function Fo(t,e){return jo(t.s,e.path)}function Bo(t,e){var n=qo(e);return Or(n.get(1)===t.s.projectId),Or(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ri(Ko(n))}function Go(t,e){return jo(t.s,e)}function zo(t){var e=qo(t);return 4===e.length?ti.$():Ko(e)}function Wo(t){return new ti(["projects",t.s.projectId,"databases",t.s.database]).N()}function Ko(t){return Or(4<t.length&&"documents"===t.get(4)),t.V(5)}function Ho(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Qo(t,e){var n,r,i,o;if(e instanceof Ls)n={update:Ho(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Fo(t,e.key)};else if(e instanceof Cs)n={update:Ho(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof qs)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.N(),increment:e.qe};throw Rr()})}};else{if(!(e instanceof Ks))return Rr();n={verify:Fo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Vo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Rr()),n}function Xo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ns.updateTime(Uo(n.updateTime)):void 0!==n.exists?Ns.exists(n.exists):Ns.We():Ns.We();if(t.update){t.update.name;var o=Bo(e,t.update.name),s=new Hs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Is(r.map(function(t){return ni.q(t)})));return new Cs(o,s,u,i)}return new Ls(o,s,i)}if(t.delete){var a=Bo(e,t.delete);return new Ws(a,i)}if(t.transform){var h=Bo(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Or("REQUEST_TIME"===e.setToServerValue),i=new us):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new as(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ps(r)):"increment"in e?i=new gs(t,e.increment):Rr();var o=ni.q(e.fieldPath);return new Es(o,i)}(e,t)});return Or(!0===i.exists),new qs(h,c)}if(t.verify){var l=Bo(e,t.verify);return new Ks(l,i)}return Rr()}function Yo(t,e){return{documents:[Go(t,e.path)]}}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Go(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof _u?function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,Po[e]),value:t.value}};var e}(t):Rr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((e=t).field),direction:(n=e.dir,xo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||fi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}function $o(t){return{before:t.before,values:t.position}}function Jo(t){var e=!!t.before,n=t.values||[];return new Uu(n,e)}function ts(t){return{fieldPath:t.N()}}function es(t){return ni.q(t.fieldPath)}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function rs(){this.Qe=void 0}function is(t,e){return t instanceof gs?No(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var os,ss,us=(n(cs,ss=rs),cs),as=(n(hs,os=rs),hs);function hs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function cs(){return null!==ss&&ss.apply(this,arguments)||this}function ls(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var fs,ps=(n(ds,fs=rs),ds);function ds(t){var e=this;return(e=fs.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=rs),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.qe=e,n}function ws(t){return Eo(t.integerValue||t.doubleValue)}function bs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Is=(Ts.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Mr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts),Es=function(t,e){this.field=t,this.transform=e};function Ts(t){(this.fields=t).sort(ni.P)}function As(t,e){this.version=t,this.transformResults=e}var Ns=(_s.We=function(){return new _s},_s.exists=function(t){return new _s(void 0,t)},_s.updateTime=function(t){return new _s(t)},Object.defineProperty(_s.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),_s.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},_s);function _s(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}function ks(){}function Ds(t,e,n,r){return t instanceof Ls?function(t,e){if(!Ss(t.Ue,e))return e;var n=Ps(e);return new ru(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Cs?function(t,e){if(!Ss(t.Ue,e))return e;var n=Ps(e),r=Us(t,e);return new ru(t.key,n,r,{Ke:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Ss(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof ru&&(y=n.field(p.field)),null===y&&r instanceof ru&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof as?ls(i,o):i instanceof ps?ys(i,o):(a=ws(u=is(s=i,o))+ws(s.qe),No(u)&&No(s.qe)?Oo(a):Lo(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Bs(t,i.data(),o);return new ru(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ss((i=t).Ue,o)?new iu(i.key,$r.min()):o);var i,o}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Mr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof as&&o instanceof as||i instanceof ps&&o instanceof ps?Mr(i.elements,o.elements,vo):i instanceof gs&&o instanceof gs?vo(i.qe,o.qe):i instanceof us&&o instanceof us);var n,r,i,o}))}function Ps(t){return t instanceof ru?t.version:$r.min()}var Rs,Os,Ls=(n(Ms,Os=ks),Ms),Cs=(n(Vs,Rs=ks),Vs);function Vs(t,e,n,r){var i=this;return(i=Rs.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Ms(t,e,n){var r=this;return(r=Os.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Us(t,e){return n=t,r=e instanceof ru?e.data():Hs.empty(),i=new Qs(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var js,qs=(n(Fs,js=ks),Fs);function Fs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=Ns.exists(!0),n}function Bs(t,e,n){for(var r=new Qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Gs,zs,Ws=(n($s,zs=ks),$s),Ks=(n(Zs,Gs=ks),Zs),Hs=(Ys.empty=function(){return new Ys({mapValue:{}})},Ys.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Ys.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Ys),Qs=(Xs.prototype.set=function(t,e){return this.Ye(t,e),this},Xs.prototype.delete=function(t){return this.Ye(t,null),this},Xs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Xs.prototype.Ge=function(){var t=this.Je(ni.$(),this.He);return null!=t?new Hs(t):this.ze},Xs.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xs);function Xs(t){void 0===t&&(t=Hs.empty()),this.ze=t,this.He=new Map}function Ys(t){this.proto=t}function Zs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function $s(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Js(t,e){this.key=t,this.version=e}var tu,eu,nu,ru=(n(au,nu=Js),au.prototype.field=function(t){return this.Xe.field(t)},au.prototype.data=function(){return this.Xe},au.prototype.Ze=function(){return this.Xe.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),iu=(n(uu,eu=Js),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),ou=(n(su,tu=Js),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su);function su(){return null!==tu&&tu.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=nu.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yr(Xr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var cu=(lu.prototype.rn=function(t){return new lu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},lu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},lu.prototype.hn=function(){return!fi(this.limit)&&"F"===this.en},lu.prototype.an=function(){return!fi(this.limit)&&"L"===this.en},lu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},lu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},lu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},lu);function lu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function fu(t,e,n,r,i,o,s,u){return new cu(t,e,n,r,i,o,s,u)}function pu(t){return new cu(t)}function du(t){return null!==t.collectionGroup}function yu(t){var e=hu(t,cu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Hu(n)),e.nn.push(new Hu(ni.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new Hu(ni.L(),i)))}}return e.nn}function vu(t){var e=hu(t,cu);if(!e.sn)if("F"===e.en)e.sn=vi(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Hu(o.field,s))}var u=e.endAt?new Uu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Uu(e.startAt.position,!e.startAt.before):null;e.sn=vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function gu(t,e,n){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function wu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function bu(t,e){return mi(vu(t),vu(e))&&t.en===e.en}function Iu(t){return gi(vu(t))+"|lt:"+t.en}function Eu(t){return"Query(target="+(n=(e=vu(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),fi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+zu(e.startAt)),e.endAt&&(n+=", endAt: "+zu(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Tu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ri.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Wu(e.startAt,yu(e),n))&&(!e.endAt||!Wu(e.endAt,yu(e),n)));var e,n,r,o}function Au(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.O()?ri.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):Rr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Nu,_u=(n(Su,Nu=function(){}),Su.create=function(t,e,n){if(t.O())return"in"===e?new Lu(t,n):new Ou(t,e,n);if(So(n)){if("=="!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Su(t,e,n)}if(ko(n)){if("=="!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Su(t,e,n)}return"array-contains"===e?new Cu(t,n):"in"===e?new Vu(t,n):"array-contains-any"===e?new Mu(t,n):new Su(t,e,n)},Su.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.fn(mo(e,this.value))},Su.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},Su.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Su);function Su(t,e,n){var r=this;return(r=Nu.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,Du,xu,Pu,Ru,Ou=(n(Gu,Ru=_u),Gu.prototype.matches=function(t){var e=ri.P(t.key,this.key);return this.fn(e)},Gu),Lu=(n(Bu,Pu=_u),Bu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bu),Cu=(n(Fu,xu=_u),Fu.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},Fu),Vu=(n(qu,Du=_u),qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},qu),Mu=(n(ju,ku=_u),ju.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},ju),Uu=function(t,e){this.position=t,this.before=e};function ju(t,e){return ku.call(this,t,"array-contains-any",e)||this}function qu(t,e){return Du.call(this,t,"in",e)||this}function Fu(t,e){return xu.call(this,t,"array-contains",e)||this}function Bu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ri.B(t.referenceValue)}),n}function Gu(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=ri.B(n.referenceValue),r}function zu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?ri.P(ri.B(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ku(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var Hu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},Qu=(ca.prototype.wn=function(t,e,n){for(var r,i,o,s=n.Tn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Ls?new ru(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Cs?function(t,e,n){if(!Ss(t.Ue,e))return new ou(t.key,n.version);var r=Us(t,e);return new ru(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof qs?function(t,e,n){if(Or(null!=n.transformResults),!Ss(t.Ue,e))return new ou(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Or(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof ru&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof as?ls(i,o):i instanceof ps?ys(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Bs(t,r.data(),i);return new ru(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new iu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ca.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ds(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ds(a,e,o,this.dn))}return e},ca.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ca.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},ca.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mr(this.mutations,t.mutations,xs)&&Mr(this.baseMutations,t.baseMutations,xs)},ca),Xu=(ha.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new ha(t,e,n,r)},ha),Yu=(aa.prototype.catch=function(t){return this.next(void 0,t)},aa.prototype.next=function(r,i){var o=this;return this.Vn&&Rr(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new aa(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},aa.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},aa.prototype.vn=function(t){try{var e=t();return e instanceof aa?e:aa.resolve(e)}catch(t){return aa.reject(t)}},aa.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):aa.resolve(e)},aa.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):aa.reject(e)},aa.resolve=function(n){return new aa(function(t,e){t(n)})},aa.reject=function(n){return new aa(function(t,e){e(n)})},aa.Sn=function(t){return new aa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},aa.Dn=function(t){for(var n=aa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?aa.resolve(t):e()})}(r[e]);return n},aa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},aa),Zu=(Object.defineProperty(ua.prototype,"readTime",{get:function(){return this.Nn},set:function(t){this.Nn=t},enumerable:!1,configurable:!0}),ua.prototype.kn=function(t,e){this.$n(),this.readTime=e,this.Cn.set(t.key,t)},ua.prototype.xn=function(t,e){this.$n(),e&&(this.readTime=e),this.Cn.set(t,null)},ua.prototype.Mn=function(t,e){this.$n();var n=this.Cn.get(e);return void 0!==n?Yu.resolve(n):this.On(t,e)},ua.prototype.getEntries=function(t,e){return this.Ln(t,e)},ua.prototype.apply=function(t){return this.$n(),this.Fn=!0,this.qn(t)},ua.prototype.$n=function(){},ua),$u="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ju=(sa.prototype.Un=function(t){this.Bn.push(t)},sa.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},sa),ta=(oa.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},oa.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},oa.prototype.Yn=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},oa.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},oa.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=Ui;return e.forEach(function(t,e){e=e||new iu(t,$r.min()),n=n.nt(t,e)}),n})},oa.prototype.ts=function(t,e,n){return r=e,ri.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):du(e)?this.ns(t,e,n):this.ss(t,e,n);var r},oa.prototype.es=function(t,e){return this.Gn(t,new ri(e)).next(function(t){var e=Fi;return t instanceof ru&&(e=e.nt(t.key,t)),e})},oa.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.Kn.rs(n,s).next(function(t){return Yu.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},oa.prototype.ss=function(e,n,t){var c,l,r=this;return this.Qn.ts(e,n,t).next(function(t){return c=t,r.jn.os(e,n)}).next(function(t){return l=t,r.hs(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Ds(s,a,a,r.dn);c=h instanceof ru?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Tu(n,e)||(c=c.remove(t))}),c})},oa.prototype.hs=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ru&&(h=h.nt(t,e))}),h})},oa),ea=(ia.cs=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ia(t,e.fromCache,n,r)},ia),na=(ra.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ra.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},ra);function ra(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function ia(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function oa(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function sa(){this.Bn=[]}function ua(){this.Cn=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function aa(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function ha(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function ca(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}function la(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}na.ws=-1;var fa=(pa.prototype.reset=function(){this.Rs=0},pa.prototype.Vs=function(){this.Rs=this.As},pa.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},pa.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},pa.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},pa.prototype.ps=function(){return(Math.random()-.5)*this.Rs},pa);function pa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function da(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ya(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ya(o)}function ya(t){return t+""}function va(t){var e=t.length;if(Or(2<=e),2===e)return Or(""===t.charAt(0)&&""===t.charAt(1)),ti.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Rr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Rr()}o=s+2}return new ti(r)}var ga=(Ea.prototype.Cs=function(t,e){return this.Ds.add(e),Yu.resolve()},Ea.prototype.rs=function(t,e){return Yu.resolve(this.Ds.getEntries(e))},Ea),ma=(Ia.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Vi(ti.P),i=!r.has(n);return this.index[e]=r.add(n),i},Ia.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Ia.prototype.getEntries=function(t){return(this.index[t]||new Vi(ti.P)).F()},Ia),wa=(ba.prototype.Cs=function(t,e){var n=this;if(this.Fs.has(e))return Yu.resolve();var r=e.S(),i=e.p();t.Un(function(){n.Fs.add(e)});var o={collectionId:r,parent:da(i)};return Ta(t).put(o)},ba.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ur(i),""],!1,!0);return Ta(t).Ns(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(va(r.parent))}return o})},ba);function ba(){this.Fs=new ma}function Ia(){this.index={}}function Ea(){this.Ds=new ma}function Ta(t){return $a.ks(t,xh.store)}var Aa=function(t){this.$s=t};function Na(t,e){if(e.document)return n=t.$s,r=e.document,i=!!e.hasCommittedMutations,o=Bo(n,r.name),s=Uo(r.updateTime),u=new Hs({mapValue:{fields:r.fields}}),new ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ri.j(e.noDocument.path),h=xa(e.noDocument.readTime);return new iu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ri.j(e.unknownDocument.path),l=xa(e.unknownDocument.version);return new ou(c,l)}return Rr()}function _a(t,e,n){var r,i,o=Sa(n),s=e.key.path.p().F();if(e instanceof ru){var u={name:Fo(r=t.$s,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Vo(r,i.version.A())},a=e.hasCommittedMutations;return new Nh(null,null,u,a,o,s)}if(e instanceof iu){var h=e.key.path.F(),c=Da(e.version),l=e.hasCommittedMutations;return new Nh(null,new Th(h,c),null,l,o,s)}if(e instanceof ou){var f=e.key.path.F(),p=Da(e.version);return new Nh(new Ah(f,p),null,null,!0,o,s)}return Rr()}function Sa(t){var e=t.A();return[e.seconds,e.nanoseconds]}function ka(t){var e=new Zr(t[0],t[1]);return $r.I(e)}function Da(t){var e=t.A();return new vh(e.seconds,e.nanoseconds)}function xa(t){var e=new Zr(t.seconds,t.nanoseconds);return $r.I(e)}function Pa(e,t){var n=(t.baseMutations||[]).map(function(t){return Xo(e.$s,t)}),r=t.mutations.map(function(t){return Xo(e.$s,t)}),i=Zr.fromMillis(t.localWriteTimeMs);return new Qu(t.batchId,i,n,r)}function Ra(t){var e,n=xa(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?xa(t.lastLimboFreeSnapshotVersion):$r.min(),i=void 0!==t.query.documents?(Or(1===(e=t.query).documents.length),vu(pu(zo(e.documents[0])))):function(t){var e,n=zo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Or(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return _u.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return _u.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}(e)]:void 0!==e.fieldFilter?[(n=e,_u.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Hu(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=fi(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var l=null;r.startAt&&(l=Jo(r.startAt));var f=null;return r.endAt&&(f=Jo(r.endAt)),vu(fu(n,o,u,s,c,"F",l,f))}(t.query);return new Ni(i,t.targetId,0,t.lastListenSequenceNumber,n,r,bi.fromBase64String(t.resumeToken))}function Oa(t,e){var n=Da(e.X),r=Da(e.lastLimboFreeSnapshotVersion),i=(wi(e.target)?Yo:Zo)(t.$s,e.target),o=e.resumeToken.toBase64();return new Sh(e.targetId,gi(e.target),n,o,e.sequenceNumber,r,i)}var La,Ca=(Va.prototype.kn=function(t,e,n){return Ua(t).put(ja(e),n)},Va.prototype.xn=function(t,e){var n=Ua(t),r=ja(e);return n.delete(r)},Va.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.xs(e,t)})},Va.prototype.Mn=function(t,e){var n=this;return Ua(t).get(ja(e)).next(function(t){return n.Ms(t)})},Va.prototype.Os=function(t,e){var n=this;return Ua(t).get(ja(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:qa(t)}:null})},Va.prototype.getEntries=function(t,e){var r=this,i=Ui;return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},Va.prototype.Bs=function(t,e){var r=this,i=Ui,o=new Di(ri.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,qa(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},Va.prototype.qs=function(t,e,i){if(e._())return Yu.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return Ua(t).Qs({range:n},function(t,e,n){for(var r=ri.j(t);s&&ri.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Va.prototype.ts=function(t,i,e){var n,r,o,s=this,u=Fi,a=i.path.length+1,h={};return e.isEqual($r.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=Sa(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Nh.collectionReadTimeIndex),Ua(t).Qs(h,function(t,e,n){var r;t.length===a&&(r=Na(s.serializer,e),i.path.D(r.key.path)?r instanceof ru&&Tu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Va.prototype.Ks=function(t,e){var r=this,i=Ui,o=Sa(e),n=Ua(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:Nh.readTimeIndex,range:s},function(t,e){var n=Na(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:ka(o)}})},Va.prototype.zs=function(t){var e=Ua(t),r=$r.min();return e.Qs({index:Nh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ka(e.readTime)),n.done()}).next(function(){return r})},Va.prototype.Hs=function(t){return new Va.Ys(this,!!t&&t.Js)},Va.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Va.prototype.getMetadata=function(t){return Ma(t).get(_h.key).next(function(t){return Or(!!t),t})},Va.prototype.xs=function(t,e){return Ma(t).put(_h.key,e)},Va.prototype.Ms=function(t){if(t){var e=Na(this.serializer,t);return e instanceof iu&&e.version.isEqual($r.min())?null:e}return null},Va);function Va(t,e){this.serializer=t,this.Kn=e}function Ma(t){return $a.ks(t,_h.store)}function Ua(t){return $a.ks(t,Nh.store)}function ja(t){return t.path.F()}function qa(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}function Fa(t,e){var n=this;return(n=La.call(this)||this).Zs=t,n.Js=e,n.ti=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ca.Ys=(n(Fa,La=Zu),Fa.prototype.qn=function(s){var u=this,a=[],h=0,c=new Vi(function(t,e){return Vr(t.N(),e.N())});return this.Cn.forEach(function(t,e){var n,r,i,o=u.ti.get(t);e?(n=_a(u.Zs.serializer,e,u.readTime),c=c.add(t.path.p()),r=qa(n),h+=r-o,a.push(u.Zs.kn(s,t,n))):(h-=o,u.Js?(i=_a(u.Zs.serializer,new iu(t,$r.min()),u.readTime),a.push(u.Zs.kn(s,t,i))):a.push(u.Zs.xn(s,t)))}),c.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,h)),Yu.Sn(a)},Fa.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},Fa.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},Fa);var Ba=(Wa.prototype.next=function(){return this.ei+=2,this.ei},Wa.ni=function(){return new Wa(0)},Wa.si=function(){return new Wa(-1)},Wa),Ga=(za.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new Ba(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},za.prototype.ai=function(t){return this.oi(t).next(function(t){return $r.I(new Zr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},za.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},za.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},za.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},za.prototype.di=function(t,e){return this._i(t,e)},za.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Ka(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return Or(0<t.targetCount),--t.targetCount,n.hi(e,t)})},za.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Ka(r).Qs(function(t,e){var n=Ra(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return Yu.Sn(a)}).next(function(){return u})},za.prototype.pe=function(t,r){return Ka(t).Qs(function(t,e){var n=Ra(e);r(n)})},za.prototype.oi=function(t){return Ha(t).get(Dh.key).next(function(t){return Or(null!==t),t})},za.prototype.hi=function(t,e){return Ha(t).put(Dh.key,e)},za.prototype._i=function(t,e){return Ka(t).put(Oa(this.serializer,e))},za.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},za.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},za.prototype.mi=function(t,i){var e=gi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Ka(t).Qs({range:n,index:Sh.queryTargetsIndexName},function(t,e,n){var r=Ra(e);mi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},za.prototype.Ai=function(n,t,r){var i=this,o=[],s=Qa(n);return t.forEach(function(t){var e=da(t.path);o.push(s.put(new kh(r,e))),o.push(i.ii.Ri(n,r,t))}),Yu.Sn(o)},za.prototype.Pi=function(n,t,r){var i=this,o=Qa(n);return Yu.forEach(t,function(t){var e=da(t.path);return Yu.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},za.prototype.Ti=function(t,e){var n=Qa(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},za.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Qa(t),o=zi();return r.Qs({range:n,yi:!0},function(t,e,n){var r=va(t[1]),i=new ri(r);o=o.add(i)}).next(function(){return o})},za.prototype.pi=function(t,e){var n=da(e.path),r=IDBKeyRange.bound([n],[Ur(n)],!1,!0),i=0;return Qa(t).Qs({index:kh.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},za.prototype.Me=function(t,e){return Ka(t).get(e).next(function(t){return t?Ra(t):null})},za);function za(t,e){this.ii=t,this.serializer=e}function Wa(t){this.ei=t}function Ka(t){return $a.ks(t,Sh.store)}function Ha(t){return $a.ks(t,Dh.store)}function Qa(t){return $a.ks(t,kh.store)}var Xa,Ya="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Za=(n(th,Xa=Ju),th),$a=(Ja.ks=function(t,e){if(t instanceof Za)return Ch.ks(t.bi,e);throw Rr()},Ja.prototype.start=function(){var e=this;return Ch.Ui(this.Li,dh,new yh(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Ya);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new na(t,e.Si)}).then(function(){e.Fi=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},Ja.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},Ja.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Ja.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Ja.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return nh(e).put(new Rh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(Fh(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},Ja.prototype.tr=function(t){var e=this;return eh(t).get(gh.key).next(function(t){return Yu.resolve(e.rr(t))})},Ja.prototype.or=function(t){return nh(t).delete(this.clientId)},Ja.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.xi,18e5)?[3,2]:(this.xi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ja.ks(t,Rh.store);return r.Ns().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Yu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},Ja.prototype.Gi=function(){var t=this;this.$i=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},Ja.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},Ja.prototype.nr=function(e){var i=this;return this.Di?Yu.resolve(!0):eh(e).get(gh.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new Yr(Xr.FAILED_PRECONDITION,Ya);return!1}}return!(!i.networkEnabled||!i.inForeground)||nh(e).Ns().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Ja.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Fi=!1,this.dr(),this.$i&&(this.$i.cancel(),this.$i=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){Dr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},Ja.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},Ja.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return nh(t).Ns().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Ja.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),Ja.prototype.mr=function(t){return uh.Ar(t,this.serializer,this.Kn,this.ii)},Ja.prototype.Rr=function(){return this.qi},Ja.prototype.Pr=function(){return this.Qn},Ja.prototype.gr=function(){return this.Kn},Ja.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Lh,function(t){return o=new Za(t,i.Ci?i.Ci.next():na.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new Yr(Xr.FAILED_PRECONDITION,$u);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},Ja.prototype.Vr=function(t){var e=this;return eh(t).get(gh.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Xr.FAILED_PRECONDITION,Ya)})},Ja.prototype.ir=function(t){var e=new gh(this.clientId,this.allowTabSynchronization,Date.now());return eh(t).put(gh.key,e)},Ja.Oi=function(){return Ch.Oi()},Ja.prototype.sr=function(t){var e=this,n=eh(t);return n.get(gh.key).next(function(t){return e.rr(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(gh.key)):Yu.resolve()})},Ja.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},Ja.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)},Ja.prototype.wr=function(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)},Ja.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ni=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.Ni))},Ja.prototype.Tr=function(){this.Ni&&(this.window.removeEventListener("unload",this.Ni),this.Ni=null)},Ja.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Ja.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},Ja.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},Ja.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Ja);function Ja(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=h,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.ki=null,this.$i=null,this.xi=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!Ja.Oi())throw new Yr(Xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new rh(this,r),this.Li=e+"main",this.serializer=new Aa(u),this.qi=new Ga(this.ii,this.serializer),this.Kn=new wa,this.Qn=new Ca(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function th(t,e){var n=this;return(n=Xa.call(this)||this).bi=t,n.vi=e,n}function eh(t){return $a.ks(t,gh.store)}function nh(t){return $a.ks(t,Rh.store)}var rh=(ih.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},ih.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},ih.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},ih.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},ih.prototype.Ri=function(t,e,n){return oh(t,n)},ih.prototype.gi=function(t,e,n){return oh(t,n)},ih.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},ih.prototype.Dr=oh,ih.prototype.Cr=function(t,e){return r=e,i=!1,ph(n=t).Fr(function(t){return hh(n,t,r).next(function(t){return t&&(i=!0),Yu.resolve(!t)})}).next(function(){return i});var n,r,i},ih.prototype.Nr=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){var n;t<=i&&(n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.xn(e),Qa(r).delete([0,da(e.path)])})}),u.push(n))}).next(function(){return Yu.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},ih.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},ih.prototype.kr=oh,ih.prototype.Sr=function(t,o){var s,e=Qa(t),u=na.ws;return e.Qs({index:kh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==na.ws&&o(new ri(va(s)),u),u=i,s=r):u=na.ws}).next(function(){u!==na.ws&&o(new ri(va(s)),u)})},ih.prototype.$r=function(t){return this.db.Pr().Xs(t)},ih);function ih(t,e){this.db=t,this.yr=new ac(this,e)}function oh(t,e){return Qa(t).put((n=t.vi,new kh(0,da(e.path),n)));var n}function sh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var uh=(ah.Ar=function(t,e,n,r){return Or(""!==t.uid),new ah(t.Mr()?t.uid:"",e,n,r)},ah.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return lh(t).Qs({index:bh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ah.prototype.Lr=function(d,y,v,g){var m=this,w=fh(d),b=lh(d);return b.add({}).next(function(t){Or("number"==typeof t);for(var e,n,r,i,o,s=new Qu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Qo(e.$s,t)}),o=r.mutations.map(function(t){return Qo(e.$s,t)}),new bh(n,r.batchId,r.dn.toMillis(),i,o)),a=[],h=new Vi(function(t,e){return Vr(t.N(),e.N())}),c=0,l=g;c<l.length;c++){var f=l[c],p=Ih.key(m.userId,f.key.path,t),h=h.add(f.key.path.p());a.push(b.put(u)),a.push(w.put(p,Ih.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Kn.Cs(d,t))}),d.Un(function(){m.xr[t]=s.keys()}),Yu.Sn(a).next(function(){return s})})},ah.prototype.qr=function(t,e){var n=this;return lh(t).get(e).next(function(t){return t?(Or(t.userId===n.userId),Pa(n.serializer,t)):null})},ah.prototype.Br=function(t,n){var r=this;return this.xr[n]?Yu.resolve(this.xr[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.xr[n]=e}return null})},ah.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return lh(t).Qs({index:bh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Or(e.batchId>=i),o=Pa(r.serializer,e)),n.done()}).next(function(){return o})},ah.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return lh(t).Qs({index:bh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ah.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return lh(t).Ns(bh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Pa(e.serializer,t)})})},ah.prototype.zn=function(u,a){var h=this,t=Ih.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return fh(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);if(r===h.userId&&a.path.isEqual(s))return lh(u).get(o).next(function(t){if(!t)throw Rr();Or(t.userId===h.userId),c.push(Pa(h.serializer,t))});n.done()}).next(function(){return c})},ah.prototype.Zn=function(r,t){var a=this,h=new Vi(Vr),i=[];return t.forEach(function(u){var t=Ih.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=fh(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Yu.Sn(i).next(function(){return a.jr(r,h)})},ah.prototype.os=function(t,e){var u=this,a=e.path,h=a.length+1,n=Ih.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Vi(Vr);return fh(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=va(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.jr(t,c)})},ah.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(lh(e).get(t).next(function(t){if(null===t)throw Rr();Or(t.userId===n.userId),r.push(Pa(n.serializer,t))}))}),Yu.Sn(i).next(function(){return r})},ah.prototype.Kr=function(e,n){var r=this;return ch(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),Yu.forEach(t,function(t){return r.ii.Dr(e,t)})})},ah.prototype.Gr=function(t){delete this.xr[t]},ah.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return Yu.resolve();var e=IDBKeyRange.lowerBound(Ih.prefixForUser(o.userId)),i=[];return fh(n).Qs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=va(t[1]),i.push(r)):n.done()}).next(function(){Or(0===i.length)})})},ah.prototype.pi=function(t,e){return hh(t,this.userId,e)},ah.prototype.Hr=function(t){var e=this;return ph(t).get(this.userId).next(function(t){return t||new wh(e.userId,-1,"")})},ah);function ah(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.xr={}}function hh(t,o,e){var n=Ih.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return fh(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ch(t,e,n){var r=t.store(bh.store),i=t.store(Ih.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Or(1===u)}));for(var h=[],c=0,l=n.mutations;c<l.length;c++){var f=l[c],p=Ih.key(e,f.key.path,n.batchId);o.push(i.delete(p)),h.push(f.key)}return Yu.Sn(o).next(function(){return h})}function lh(t){return $a.ks(t,bh.store)}function fh(t){return $a.ks(t,Ih.store)}function ph(t){return $a.ks(t,wh.store)}var dh=10,yh=(mh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Or(t<e&&0<=t&&e<=dh);var o,s=new Bh(r);t<1&&1<=e&&(n.createObjectStore(gh.store),(o=n).createObjectStore(wh.store,{keyPath:wh.keyPath}),o.createObjectStore(bh.store,{keyPath:bh.keyPath,autoIncrement:!0}).createIndex(bh.userMutationsIndex,bh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Ih.store),Ph(n),n.createObjectStore(Nh.store));var u,a=Yu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(kh.store),u.deleteObjectStore(Sh.store),u.deleteObjectStore(Dh.store),Ph(n)),a=a.next(function(){return t=s.store(Dh.store),e=new Dh(0,0,$r.min().A(),0),t.put(Dh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(bh.store).Ns().next(function(t){r.deleteObjectStore(bh.store),r.createObjectStore(bh.store,{keyPath:bh.keyPath,autoIncrement:!0}).createIndex(bh.userMutationsIndex,bh.userMutationsKeyPath,{unique:!0});var e=i.store(bh.store),n=t.map(function(t){return e.put(t)});return Yu.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Rh.store,{keyPath:Rh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(_h.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Nh.store)).createIndex(Nh.readTimeIndex,Nh.readTimeIndexPath,{unique:!1}),t.createIndex(Nh.collectionReadTimeIndex,Nh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},mh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Nh.store).Qs(function(t,e){n+=qa(e)}).next(function(){var t=new _h(n);return e.store(_h.store).put(_h.key,t)})},mh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(wh.store),e=r.store(bh.store);return t.Ns().next(function(t){return Yu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Ns(bh.userMutationsIndex,t).next(function(t){return Yu.forEach(t,function(t){Or(t.userId===n.userId);var e=Pa(i.serializer,t);return ch(r,n.userId,e).next(function(){})})})})})},mh.prototype.ensureSequenceNumbers=function(t){var s=t.store(kh.store),e=t.store(Nh.store);return t.store(Dh.store).get(Dh.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new ti(t),r=[0,da(n)];o.push(s.get(r).next(function(t){return t?Yu.resolve():s.put(new kh(0,da(n),i.highestListenSequenceNumber))}))}).next(function(){return Yu.Sn(o)})})},mh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:da(n)})}}t.createObjectStore(xh.store,{keyPath:xh.keyPath});var i=e.store(xh.store),o=new ma;return e.store(Nh.store).Qs({yi:!0},function(t,e){return r(new ti(t).p())}).next(function(){return e.store(Ih.store).Qs({yi:!0},function(t,e){t[0];var n=t[1];return r((t[2],va(n)).p())})})},mh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Sh.store);return o.Qs(function(t,e){var n=Ra(e),r=Oa(i.serializer,n);return o.put(r)})},mh),vh=function(t,e){this.seconds=t,this.nanoseconds=e},gh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function mh(t){this.serializer=t}gh.store="owner",gh.key="owner";var wh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wh.store="mutationQueues",wh.keyPath="userId";var bh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};bh.store="mutations",bh.keyPath="batchId",bh.userMutationsIndex="userMutationsIndex",bh.userMutationsKeyPath=["userId","batchId"];var Ih=(Eh.prefixForUser=function(t){return[t]},Eh.prefixForPath=function(t,e){return[t,da(e)]},Eh.key=function(t,e,n){return[t,da(e),n]},Eh);function Eh(){}Ih.store="documentMutations",Ih.PLACEHOLDER=new Ih;var Th=function(t,e){this.path=t,this.readTime=e},Ah=function(t,e){this.path=t,this.version=e},Nh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Nh.store="remoteDocuments",Nh.readTimeIndex="readTimeIndex",Nh.readTimeIndexPath="readTime",Nh.collectionReadTimeIndex="collectionReadTimeIndex",Nh.collectionReadTimeIndexPath=["parentPath","readTime"];var _h=function(t){this.byteSize=t};_h.store="remoteDocumentGlobal",_h.key="remoteDocumentGlobalKey";var Sh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sh.store="targets",Sh.keyPath="targetId",Sh.queryTargetsIndexName="queryTargetsIndex",Sh.queryTargetsKeyPath=["canonicalId","targetId"];var kh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};kh.store="targetDocuments",kh.keyPath=["targetId","path"],kh.documentTargetsIndex="documentTargetsIndex",kh.documentTargetsKeyPath=["path","targetId"];var Dh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Dh.key="targetGlobalKey",Dh.store="targetGlobal";var xh=function(t,e){this.collectionId=t,this.parent=e};function Ph(t){t.createObjectStore(kh.store,{keyPath:kh.keyPath}).createIndex(kh.documentTargetsIndex,kh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sh.store,{keyPath:Sh.keyPath}).createIndex(Sh.queryTargetsIndexName,Sh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Dh.store)}xh.store="collectionParents",xh.keyPath=["collectionId","parent"];var Rh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Rh.store="clientMetadata",Rh.keyPath="clientId";var Oh,Lh=d(d(d([wh.store,bh.store,Ih.store,Nh.store,Sh.store,gh.store,Dh.store,kh.store],[Rh.store]),[_h.store]),[xh.store]),Ch=(qh.Ui=function(o,t,s){return Dr("SimpleDb","Opening database:",o),new Yu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new qh(e))},i.onblocked=function(){r(new Yr(Xr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Yr(Xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,dh).next(function(){Dr("SimpleDb","Database upgrade to version "+dh+" complete")})}}).bn()},qh.delete=function(t){return Dr("SimpleDb","Removing database:",t),Kh(window.indexedDB.deleteDatabase(t)).bn()},qh.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(qh.Jr())return!0;var t=y(),e=qh.Yr(t),n=0<e&&e<10,r=qh.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},qh.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},qh.ks=function(t,e){return t.store(e)},qh.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},qh.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},qh.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},qh.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=Bh.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Yu.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Dr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},qh.prototype.close=function(){this.db.close()},qh),Vh=(Object.defineProperty(jh.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(jh.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),jh.prototype.done=function(){this.no=!0},jh.prototype.js=function(t){this.so=t},jh.prototype.delete=function(){return Kh(this.eo.delete())},jh),Mh=(n(Uh,Oh=Yr),Uh);function Uh(t){var e=this;return(e=Oh.call(this,Xr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function jh(t){this.eo=t,this.no=!1,this.so=null}function qh(t){this.db=t,12.2===qh.Yr(y())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Fh(t){return"IndexedDbTransactionError"===t.name}var Bh=(Wh.open=function(t,e,n){return new Wh(t.transaction(n,e))},Object.defineProperty(Wh.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Wh.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Wh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Gh(e)},Wh),Gh=(zh.prototype.put=function(t,e){return Kh(void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},zh.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Kh(this.store.add(t))},zh.prototype.get=function(e){var n=this;return Kh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},zh.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Kh(this.store.delete(t))},zh.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Kh(this.store.count())},zh.prototype.Ns=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},zh.prototype.ho=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},zh.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},zh.prototype.Fr=function(i){var t=this.cursor({});return new Yu(function(n,r){t.onerror=function(t){var e=Qh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},zh.prototype.oo=function(t,s){var u=[];return new Yu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Vh(i),(n=s(i.primaryKey,i.value,e))instanceof Yu&&(r=n.catch(function(t){return e.done(),Yu.reject(t)}),u.push(r)),e.gn?o():null===e.io?i.continue():i.continue(e.io)):o()}}).next(function(){return Yu.Sn(u)})},zh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},zh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},zh);function zh(t){this.store=t}function Wh(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new la,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new Mh(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=Qh(t.target.error);n.ro.reject(new Mh(e))}}function Kh(t){return new Yu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Qh(t.target.error);r(e)}})}var Hh=!1;function Qh(t){var e=Ch.Yr(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Hh||(Hh=!0,setTimeout(function(){throw r},0)),r}}return t}function Xh(){return"undefined"!=typeof window?window:null}var Yh=(Jh._o=function(t,e,n,r,i){var o=new Jh(t,e,Date.now()+n,r,i);return o.start(n),o},Jh.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},Jh.prototype.Ss=function(){return this.do()},Jh.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new Yr(Xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Jh.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},Jh.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},Jh),Zh=(Object.defineProperty($h.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),$h.prototype.Zi=function(t){this.enqueue(t)},$h.prototype.po=function(t){this.bo(),this.vo(t)},$h.prototype.So=function(t){return this.bo(),this.vo(t)},$h.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=Xh())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},$h.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},$h.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!Fh(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},$h.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},$h.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=Yh._o(this,t,e,n,function(t){return r.Fo(t)});return this.Io.push(i),i},$h.prototype.bo=function(){this.mo&&Rr()},$h.prototype.No=function(){},$h.prototype.ko=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},$h.prototype.$o=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},$h.prototype.xo=function(r){var i=this;return this.ko().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.ko()})},$h.prototype.Mo=function(t){this.Ro.push(t)},$h.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},$h);function $h(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new fa(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=Xh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function Jh(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new la,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function tc(t,e){if(xr("AsyncQueue",e+": "+t),Fh(t))return new Yr(Xr.UNAVAILABLE,e+": "+t);throw t}function ec(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Vr(n,i);return 0===s?Vr(r,o):s}var nc=(sc.prototype.qo=function(){return++this.Lo},sc.prototype.Bo=function(t){var e,n=[t,this.qo()];this.buffer.size<this.Oo?this.buffer=this.buffer.add(n):ec(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(sc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),sc),rc={Uo:!1,Wo:0,Qo:0,jo:0},ic=(oc.Ho=function(t){return new oc(t,oc.Yo,oc.Jo)},oc);function oc(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function sc(t){this.Oo=t,this.buffer=new Vi(ec),this.Lo=0}ic.Xo=-1,ic.Zo=1048576,ic.th=41943040,ic.Yo=10,ic.Jo=1e3,ic.eh=new ic(ic.th,ic.Yo,ic.Jo),ic.nh=new ic(ic.Xo,0,0);var uc=(fc.prototype.start=function(t){this.yr.params.Ko!==ic.Xo&&this.rh(t)},fc.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(fc.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),fc.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return Fh(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,dc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},fc),ac=(lc.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},lc.prototype.uh=function(t,e){var n=this;if(0===e)return Yu.resolve(na.ws);var r=new nc(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},lc.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},lc.prototype.Nr=function(t,e){return this.hh.Nr(t,e)},lc.prototype.lh=function(e,n){var r=this;return this.params.Ko===ic.Xo?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),Yu.resolve(rc)):this.$r(e).next(function(t){return t<r.params.Ko?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),rc):r._h(e,n)})},lc.prototype.$r=function(t){return this.hh.$r(t)},lc.prototype._h=function(e,n){var r,i,o,s,u,a,h,c=this,l=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>c.params.zo?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.zo+" from "+t),c.params.zo):t,s=Date.now(),c.uh(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.Nr(e,r)}).next(function(t){return h=Date.now(),kr()<=p.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-l)+"ms"),Yu.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},lc),hc=(cc.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.jn.Qr(v).next(function(t){return g=t,e=r.persistence.mr(i),m=new ta(r.Eh,e,r.persistence.gr()),e.Qr(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Jn(v,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},cc.prototype.Vh=function(h){var c,l=this,f=Zr.now(),t=h.reduce(function(t,e){return t.add(e.key)},zi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ih.Jn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof qs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ru?t.field(i.field):void 0,s=is(i.transform,o||null);null!=s&&(e=null==e?(new Qs).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Cs(o.key,s,function u(t){var a=[];return Gr(t.fields||{},function(t,e){var n=new ni([t]);if(Do(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Is(a)}(s.proto.mapValue),Ns.exists(!0)))}return l.jn.Lr(a,f,n,h)})}).then(function(t){var e=t.In(c);return{batchId:t.batchId,Cn:e}})},cc.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},cc.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return Or(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},cc.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},cc.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},cc.prototype.vh=function(a){var h=this,c=a.X,l=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Eh.Hs({Js:!0});l=h.dh;var s=[];a.Wt.forEach(function(t,e){var n,r,i=l.get(e);i&&(s.push(h.qi.Pi(o,t.Xt,e).next(function(){return h.qi.Ai(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.vi),l=l.nt(e,r),cc.Sh(i,r,t)&&s.push(h.qi.di(o,r))))});var t,u=Ui,n=zi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof iu&&e.version.isEqual($r.min())?(i.xn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.kn(e,c),u=u.nt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.ii.kr(o,t))})})),c.isEqual($r.min())||(t=h.qi.ai(o).next(function(t){return h.qi.ci(o,o.vi,c)}),s.push(t)),Yu.Sn(s).next(function(){return i.apply(o)}).next(function(){return h.Ih.Xn(o,u)})}).then(function(t){return h.dh=l,t})},cc.Sh=function(t,e,n){return Or(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},cc.prototype.Ch=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Yu.forEach(c,function(e){return Yu.forEach(e.as,function(t){return h.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return Yu.forEach(e.us,function(t){return h.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Fh(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},cc.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},cc.prototype.Nh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},cc.prototype.kh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,Yu.resolve(n)):i.qi.ri(e).next(function(t){return n=new Ni(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},cc.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?Yu.resolve(this.dh.get(n)):this.qi.mi(t,e)},cc.prototype.$h=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Fh(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},cc.prototype.xh=function(t,n){var r=this,i=$r.min(),o=zi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,vu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:$r.min(),n?o:zi())}).next(function(t){return{documents:t,Mh:o}})})},cc.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Yu.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);Or(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.kn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},cc.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},cc);function cc(t,e,n){this.persistence=t,this.fh=e,this.dh=new Di(Vr),this.wh=new Qr(gi,mi),this.Th=$r.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new ta(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function lc(t,e){this.hh=t,this.params=e}function fc(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function pc(t,e){var n=t,r=n.qi,i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function dc(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Xr.FAILED_PRECONDITION||e.message!==$u)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}hc.Dh=3e8;var yc=(mc.prototype._=function(){return this.Oh._()},mc.prototype.Ri=function(t,e){var n=new vc(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},mc.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},mc.prototype.gi=function(t,e){this.Wh(new vc(t,e))},mc.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},mc.prototype.jh=function(t){var e=this,n=new ri(new ti([])),r=new vc(n,t),i=new vc(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},mc.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},mc.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},mc.prototype.Gh=function(t){var e=new ri(new ti([])),n=new vc(e,t),r=new vc(e,t+1),i=zi();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},mc.prototype.pi=function(t){var e=new vc(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},mc),vc=(gc.Lh=function(t,e){return ri.P(t.key,e.key)||Vr(t.zh,e.zh)},gc.Bh=function(t,e){return Vr(t.zh,e.zh)||ri.P(t.key,e.key)},gc);function gc(t,e){this.key=t,this.zh=e}function mc(){this.Oh=new Vi(vc.Lh),this.qh=new Vi(vc.Bh)}function wc(t,e){if(0!==e.length)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Mc(e.length,"argument")+".")}function bc(t,e,n){if(e.length!==n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires "+Mc(n,"argument")+", but was called with "+Mc(e.length,"argument")+".")}function Ic(t,e,n){if(e.length<n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Mc(n,"argument")+", but was called with "+Mc(e.length,"argument")+".")}function Ec(t,e,n,r){if(e.length<n||e.length>r)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Mc(e.length,"argument")+".")}function Tc(t,e,n,r){Dc(t,e,Vc(n)+" argument",r)}function Ac(t,e,n,r){void 0!==r&&Tc(t,e,n,r)}function Nc(t,e,n,r){Dc(t,e,n+" option",r)}function _c(t,e,n,r){void 0!==r&&Nc(t,e,n,r)}function Sc(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Pc(s))}var u=Pc(n);throw new Yr(Xr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function kc(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid value "+Pc(r)+" provided to function "+t+"() for its "+Vc(n)+" argument. Acceptable values: "+e.join(", "));return r}function Dc(t,e,n,r){if(!("object"===e?xc(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Pc(r);throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function xc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Pc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Rc(t,e,n){if(void 0===n)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Vc(e)+" argument, but it was undefined.")}function Oc(n,t,r){Gr(t,function(t,e){if(r.indexOf(t)<0)throw new Yr(Xr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Lc(t,e,n,r){var i=Pc(r);return new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Vc(n)+" argument to be a "+e+", but it was: "+i)}function Cc(t,e,n){if(n<=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Vc(e)+" argument to be a positive number, but it was: "+n+".")}function Vc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Mc(t,e){return t+" "+e+(1===t?"":"s")}function Uc(){if("undefined"==typeof Uint8Array)throw new Yr(Xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function jc(){if("undefined"==typeof atob)throw new Yr(Xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var qc,Fc,Bc=(Yc.fromBase64String=function(t){bc("Blob.fromBase64String",arguments,1),Tc("Blob.fromBase64String","string",1,t),jc();try{return new Yc(bi.fromBase64String(t))}catch(t){throw new Yr(Xr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Yc.fromUint8Array=function(t){if(bc("Blob.fromUint8Array",arguments,1),Uc(),!(t instanceof Uint8Array))throw Lc("Blob.fromUint8Array","Uint8Array",1,t);return new Yc(bi.fromUint8Array(t))},Yc.prototype.toBase64=function(){return bc("Blob.toBase64",arguments,0),jc(),this.Hh.toBase64()},Yc.prototype.toUint8Array=function(){return bc("Blob.toUint8Array",arguments,0),Uc(),this.Hh.toUint8Array()},Yc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yc.prototype.isEqual=function(t){return this.Hh.isEqual(t.Hh)},Yc),Gc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yr(Xr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Tc("FieldPath","string",e,t[e]),0===t[e].length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yh=new ni(t)},zc=(n(Xc,Fc=Gc),Xc.documentId=function(){return new Xc(ni.L().N())},Xc.prototype.isEqual=function(t){if(!(t instanceof Xc))throw Lc("isEqual","FieldPath",1,t);return this.Yh.isEqual(t.Yh)},Xc),Wc=new RegExp("[~\\*/\\[\\]]"),Kc=function(){this.Jh=this},Hc=(n(Qc,qc=Kc),Qc.prototype.Zh=function(t){if(2!==t.ta)throw 1===t.ta?t.ea(this.Xh+"() can only appear at the top level of your update data"):t.ea(this.Xh+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Qc.prototype.isEqual=function(t){return t instanceof Qc},Qc);function Qc(t){var e=this;return(e=qc.call(this)||this).Xh=t,e}function Xc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Fc.call(this,t)||this}function Yc(t){jc(),this.Hh=t}function Zc(t,e,n){return new _l({ta:3,na:e.settings.na,methodName:t.Xh,sa:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var $c,Jc,tl,el,nl,rl,il=(n(gl,rl=Kc),gl.prototype.Zh=function(t){return new Es(t.path,new us)},gl.prototype.isEqual=function(t){return t instanceof gl},gl),ol=(n(vl,nl=Kc),vl.prototype.Zh=function(t){var e=Zc(this,t,!0),n=this.ia.map(function(t){return Ll(t,e)}),r=new as(n);return new Es(t.path,r)},vl.prototype.isEqual=function(t){return this===t},vl),sl=(n(yl,el=Kc),yl.prototype.Zh=function(t){var e=Zc(this,t,!0),n=this.ia.map(function(t){return Ll(t,e)}),r=new ps(n);return new Es(t.path,r)},yl.prototype.isEqual=function(t){return this===t},yl),ul=(n(dl,tl=Kc),dl.prototype.Zh=function(t){var e=new gs(t.serializer,Co(t.serializer,this.ra));return new Es(t.path,e)},dl.prototype.isEqual=function(t){return this===t},dl),al=(n(pl,Jc=Kc),pl.delete=function(){return wc("FieldValue.delete",arguments),new hl(new Hc("FieldValue.delete"))},pl.serverTimestamp=function(){return wc("FieldValue.serverTimestamp",arguments),new hl(new il("FieldValue.serverTimestamp"))},pl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ic("FieldValue.arrayUnion",arguments,1),new hl(new ol("FieldValue.arrayUnion",t))},pl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ic("FieldValue.arrayRemove",arguments,1),new hl(new sl("FieldValue.arrayRemove",t))},pl.increment=function(t){return Tc("FieldValue.increment","number",1,t),bc("FieldValue.increment",arguments,1),new hl(new ul("FieldValue.increment",t))},pl),hl=(n(fl,$c=al),fl.prototype.Zh=function(t){return this.Jh.Zh(t)},fl.prototype.isEqual=function(t){return t instanceof fl&&this.Jh.isEqual(t.Jh)},fl),cl=(Object.defineProperty(ll.prototype,"latitude",{get:function(){return this.oa},enumerable:!1,configurable:!0}),Object.defineProperty(ll.prototype,"longitude",{get:function(){return this.ha},enumerable:!1,configurable:!0}),ll.prototype.isEqual=function(t){return this.oa===t.oa&&this.ha===t.ha},ll.prototype.T=function(t){return Vr(this.oa,t.oa)||Vr(this.ha,t.ha)},ll);function ll(t,e){if(bc("GeoPoint",arguments,2),Tc("GeoPoint","number",1,t),Tc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.oa=t,this.ha=e}function fl(t){var e=this;return(e=$c.call(this)||this).Jh=t,e.Xh=t.Xh,e}function pl(){return Jc.call(this)||this}function dl(t,e){var n=this;return(n=tl.call(this)||this).Xh=t,n.ra=e,n}function yl(t,e){var n=this;return(n=el.call(this)||this).Xh=t,n.ia=e,n}function vl(t,e){var n=this;return(n=nl.call(this)||this).Xh=t,n.ia=e,n}function gl(t){var e=this;return(e=rl.call(this)||this).Xh=t,e}function ml(t){return new Ro(t,!0)}var wl=/^__.*__$/,bl=function(t,e,n){this.aa=t,this.ua=e,this.ca=n},Il=(Al.prototype.la=function(t,e){var n=[];return null!==this.Le?n.push(new Cs(t,this.data,this.Le,e)):n.push(new Ls(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},Al),El=(Tl.prototype.la=function(t,e){var n=[new Cs(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},Tl);function Tl(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Al(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Nl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var _l=(Object.defineProperty(Dl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Dl.prototype,"ta",{get:function(){return this.settings.ta},enumerable:!1,configurable:!0}),Dl.prototype.fa=function(t){return new Dl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Dl.prototype.da=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r.wa(t),r},Dl.prototype.Ta=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r._a(),r},Dl.prototype.Ea=function(t){return this.fa({path:void 0,sa:!0})},Dl.prototype.ea=function(t){return ql(t,this.settings.methodName,this.settings.Ia||!1,this.path,this.settings.na)},Dl.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Dl.prototype._a=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},Dl.prototype.wa=function(t){if(0===t.length)throw this.ea("Document fields must not be empty");if(Nl(this.ta)&&wl.test(t))throw this.ea('Document fields cannot begin and end with "__"')},Dl),Sl=(kl.prototype.ma=function(t,e,n,r){return void 0===r&&(r=!1),new _l({ta:t,methodName:e,na:n,path:ni.$(),sa:!1,Ia:r},this.s,this.serializer,this.ignoreUndefinedProperties)},kl);function kl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||ml(t)}function Dl(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this._a(),this.fieldTransforms=i||[],this.Le=o||[]}function xl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ma(o.merge||o.mergeFields?2:0,e,n,i);Ml("Data must be an object, but it was:",s,r);var u,a,h=Cl(r,s);if(o.merge)u=new Is(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Gc)d=p.Yh;else{if("string"!=typeof p)throw Rr();d=jl(e,p,n)}if(!s.contains(d))throw new Yr(Xr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Fl(c,d)||c.push(d)}u=new Is(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new Il(new Hs(h),u,a)}function Pl(t,o,s,e){var u=t.ma(1,o,s);Ml("Data must be an object, but it was:",u,e);var a=[],h=new Qs;Gr(e,function(t,e){var n,r=jl(o,t,s),i=u.Ta(r);e instanceof Kc&&e.Jh instanceof Hc?a.push(r):null!=(n=Ll(e,i))&&(a.push(r),h.set(r,n))});var n=new Is(a);return new El(h.Ge(),n,u.fieldTransforms)}function Rl(t,e,n,r,i,o){var s=t.ma(1,e,n),u=[Ul(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Ul(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new Qs,v=u.length-1;0<=v;--v)Fl(d,u[v])||(c=u[v],l=a[v],f=s.Ta(c),l instanceof Kc&&l.Jh instanceof Hc?d.push(c):null!=(p=Ll(l,f))&&(d.push(c),y.set(c,p)));var g=new Is(d);return new El(y.Ge(),g,s.fieldTransforms)}function Ol(t,e,n,r){return void 0===r&&(r=!1),Ll(n,t.ma(r?4:3,e))}function Ll(s,t){if(Vl(s))return Ml("Unsupported field value:",t,s),Cl(s,t);if(s instanceof Kc)return function(t,e){if(!Nl(e.ta))throw e.ea(t.Xh+"() can only be used with update() and set()");if(!e.path)throw e.ea(t.Xh+"() is not currently supported inside arrays");var n=t.Zh(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.sa&&4!==t.ta)throw t.ea("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Ll(i[r],t.Ea(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zr.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Zr){var r=new Zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,r)}}if(t instanceof cl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Bc)return{bytesValue:Mo(e.serializer,t)};if(t instanceof bl){var i=e.s,o=t.aa;if(!o.isEqual(i))throw e.ea("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:jo(t.aa||e.s,t.ua.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ea("Unsupported field value: "+Pc(t))}(s,t)}function Cl(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Gr(t,function(t,e){var n=Ll(e,r.da(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Vl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zr||t instanceof cl||t instanceof Bc||t instanceof bl||t instanceof Kc)}function Ml(t,e,n){if(!Vl(n)||!xc(n)){var r=Pc(n);throw"an object"===r?e.ea(t+" a custom object"):e.ea(t+" "+r)}}function Ul(t,e,n){if(e instanceof Gc)return e.Yh;if("string"==typeof e)return jl(t,e);throw ql("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function jl(t,e,n){try{return function(e){if(0<=e.search(Wc))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(zc.bind.apply(zc,d([void 0],e.split("."))))}catch(t){throw new Yr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yh}catch(e){throw ql(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function ql(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Yr(Xr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Fl(t,e){return t.some(function(t){return t.isEqual(e)})}var Bl=(Gl.prototype.Mr=function(){return null!=this.uid},Gl.prototype.Aa=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},Gl.prototype.isEqual=function(t){return t.uid===this.uid},Gl);function Gl(t){this.uid=t}function zl(t,e){this.user=e,this.type="OAuth",this.ga={},this.ga.Authorization="Bearer "+t}Bl.UNAUTHENTICATED=new Bl(null),Bl.Ra=new Bl("google-credentials-uid"),Bl.Pa=new Bl("first-party-uid");var Wl,Kl,Hl,Ql=(vf.prototype.getToken=function(){return Promise.resolve(null)},vf.prototype.ya=function(){},vf.prototype.pa=function(t){(this.Va=t)(Bl.UNAUTHENTICATED)},vf.prototype.ba=function(){this.Va=null},vf),Xl=(yf.prototype.getToken=function(){var e=this,n=this.Da,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Da!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Or("string"==typeof t.accessToken),new zl(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},yf.prototype.ya=function(){this.forceRefresh=!0},yf.prototype.pa=function(t){this.Va=t,this.Sa&&t(this.currentUser)},yf.prototype.ba=function(){this.auth&&this.auth.removeAuthTokenListener(this.va),this.va=null,this.Va=null},yf.prototype.Ca=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new Bl(t)},yf),Yl=(Object.defineProperty(df.prototype,"ga",{get:function(){var t={"X-Goog-AuthUser":this.Na},e=this.Fa.auth.ka([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),df),Zl=(pf.prototype.getToken=function(){return Promise.resolve(new Yl(this.Fa,this.Na))},pf.prototype.pa=function(t){t(Bl.Pa)},pf.prototype.ba=function(){},pf.prototype.ya=function(){},pf),$l=(ff.prototype.qa=function(){return 1===this.state||2===this.state||4===this.state},ff.prototype.Ba=function(){return 2===this.state},ff.prototype.start=function(){3!==this.state?this.auth():this.Ua()},ff.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ff.prototype.Wa=function(){this.state=0,this.Po.reset()},ff.prototype.Qa=function(){var t=this;this.Ba()&&null===this.La&&(this.La=this.Ts.bs(this.$a,6e4,function(){return t.ja()}))},ff.prototype.Ka=function(t){this.Ga(),this.stream.send(t)},ff.prototype.ja=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ba()?[2,this.close(0)]:[2]})})},ff.prototype.Ga=function(){this.La&&(this.La.cancel(),this.La=null)},ff.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga(),this.Po.cancel(),this.Oa++,3!==e?this.Po.reset():n&&n.code===Xr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Xr.UNAUTHENTICATED&&this.Ma.ya(),null!==this.stream&&(this.za(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ha(n)];case 1:return t.sent(),[2]}})})},ff.prototype.za=function(){},ff.prototype.auth=function(){var n=this;this.state=1;var t=this.Ya(this.Oa),e=this.Oa;this.Ma.getToken().then(function(t){n.Oa===e&&n.Ja(t)},function(e){t(function(){var t=new Yr(Xr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Xa(t)})})},ff.prototype.Ja=function(t){var e=this,n=this.Ya(this.Oa);this.stream=this.Za(t),this.stream.tu(function(){n(function(){return e.state=2,e.listener.tu()})}),this.stream.Ha(function(t){n(function(){return e.Xa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ff.prototype.Ua=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},ff.prototype.Xa=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ff.prototype.Ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.Oa===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ff),Jl=(n(lf,Hl=$l),lf.prototype.Za=function(t){return this.xa.eu("Listen",t)},lf.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Rr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Or(void 0===i||"string"==typeof i),bi.fromBase64String(i||"")):(Or(void 0===i||i instanceof Uint8Array),bi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Qi(s,u,a,h&&(r=void 0===(n=h).code?Xr.UNKNOWN:ki(n.code),new Yr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Bo(t,l.document.name),p=Uo(l.document.updateTime),d=new Hs({mapValue:{fields:l.document.fields}}),y=new ru(f,p,d,{}),c=new Ki(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Bo(t,v.document),m=v.readTime?Uo(v.readTime):$r.min(),w=new iu(g,m);c=new Ki([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var I=Bo(t,b.document);c=new Ki([],b.removedTargetIds||[],I,null)}else{if(!("filter"in e))return Rr();e.filter;var E=e.filter;E.targetId;var T=new Ei(E.count||0);c=new Hi(E.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return $r.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?$r.min():Uo(e.readTime)}(t);return this.listener.nu(e,n)},lf.prototype.su=function(t){var e,n,r,i,o={};o.database=Wo(this.serializer),o.addTarget=(e=this.serializer,(r=wi(i=(n=t).target)?{documents:Yo(e,i)}:{query:Zo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ka(o)},lf.prototype.iu=function(t){var e={};e.database=Wo(this.serializer),e.removeTarget=t,this.Ka(e)},lf),tf=(n(cf,Kl=$l),Object.defineProperty(cf.prototype,"ou",{get:function(){return this.ru},enumerable:!1,configurable:!0}),cf.prototype.start=function(){this.ru=!1,this.lastStreamToken=void 0,Kl.prototype.start.call(this)},cf.prototype.za=function(){this.ru&&this.hu([])},cf.prototype.Za=function(t){return this.xa.eu("Write",t)},cf.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Or(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual($r.min())&&(n=Uo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=Uo(t.commitTime);return this.listener.au(n,e)}var r,i;return Or(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.uu()},cf.prototype.cu=function(){var t={};t.database=Wo(this.serializer),this.Ka(t)},cf.prototype.hu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qo(e.serializer,t)})};this.Ka(n)},cf),ef=(n(hf,Wl=function(){}),hf.prototype._u=function(){if(this.lu)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},hf.prototype.start=function(t){this.xa=t},hf.prototype.fu=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.fu(e,n,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&r.credentials.ya(),t})},hf.prototype.du=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.du(e,n,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&r.credentials.ya(),t})},hf.prototype.wu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.lu=!1,[2]})})},hf),nf=(af.prototype.Ru=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Pu(),0<this.mutations.length)throw new Yr(Xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return g(this,void 0,void 0,function(){var i,e,n,o,r;return w(this,function(t){switch(t.label){case 0:return e={database:Wo((i=s).serializer),documents:u.map(function(t){return Fo(i.serializer,t)})},[4,i.du("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),r=Uo(e.found.updateTime),i=new Hs({mapValue:{fields:e.found.fields}});return new ru(n,r,i,{})}(e,n):"missing"in n?function(t,e){Or(!!e.missing),Or(!!e.readTime);var n=Bo(t,e.missing),r=Uo(e.readTime);return new iu(n,r)}(e,n):Rr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Or(!!e),r.push(e)}),r)]}})})}(this.Tu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof iu||t instanceof ru?n.gu(t):Rr()}),e)]}})})},af.prototype.set=function(t,e){this.write(e.la(t,this.Ue(t))),this.Au.add(t)},af.prototype.update=function(t,e){try{this.write(e.la(t,this.Vu(t)))}catch(t){this.mu=t}this.Au.add(t)},af.prototype.delete=function(t){this.write([new Ws(t,this.Ue(t))]),this.Au.add(t)},af.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Pu(),this.mu)throw this.mu;return e=this.Eu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ri(ti.k(e));r.mutations.push(new Ks(n,r.Ue(n)))}),[4,function(r,i){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return n={database:Wo((e=r).serializer),writes:i.map(function(t){return Qo(e.serializer,t)})},[4,e.fu("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Tu,this.mutations)];case 1:return t.sent(),this.Iu=!0,[2]}})})},af.prototype.gu=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw Rr();e=$r.min()}var n=this.Eu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Xr.ABORTED,"Document version changed between two reads.")}else this.Eu.set(t.key.toString(),e)},af.prototype.Ue=function(t){var e=this.Eu.get(t.toString());return!this.Au.has(t)&&e?Ns.updateTime(e):Ns.We()},af.prototype.Vu=function(t){var e=this.Eu.get(t.toString());if(this.Au.has(t)||!e)return Ns.exists(!0);if(e.isEqual($r.min()))throw new Yr(Xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ns.updateTime(e)},af.prototype.write=function(t){this.Pu(),this.mutations=this.mutations.concat(t)},af.prototype.Pu=function(){},af),rf=(uf.prototype.Su=function(){var t=this;0===this.pu&&(this.Du("Unknown"),this.bu=this.ao.bs("online_state_timeout",1e4,function(){return t.bu=null,t.Cu("Backend didn't respond within 10 seconds."),t.Du("Offline"),Promise.resolve()}))},uf.prototype.Fu=function(t){"Online"===this.state?this.Du("Unknown"):(this.pu++,1<=this.pu&&(this.Nu(),this.Cu("Connection failed 1 times. Most recent error: "+t.toString()),this.Du("Offline")))},uf.prototype.set=function(t){this.Nu(),this.pu=0,"Online"===t&&(this.vu=!1),this.Du(t)},uf.prototype.Du=function(t){t!==this.state&&(this.state=t,this.yu(t))},uf.prototype.Cu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.vu?(xr(e),this.vu=!1):Dr("OnlineStateTracker",e)},uf.prototype.Nu=function(){null!==this.bu&&(this.bu.cancel(),this.bu=null)},uf),of=(sf.prototype.start=function(){return this.enableNetwork()},sf.prototype.enableNetwork=function(){return this.Ou.delete(0),this.Xu()},sf.prototype.Xu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bu()?(this.Zu()?this.tc():this.Wu.set("Unknown"),[4,this.ec()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sf.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ou.add(0),[4,this.nc()];case 1:return t.sent(),this.Wu.set("Offline"),[2]}})})},sf.prototype.nc=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.zu.stop()];case 1:return t.sent(),[4,this.Qu.stop()];case 2:return t.sent(),0<this.$u.length&&(Dr("RemoteStore","Stopping write stream with "+this.$u.length+" pending writes"),this.$u=[]),this.sc(),[2]}})})},sf.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","RemoteStore shutting down."),this.Ou.add(5),[4,this.nc()];case 1:return t.sent(),this.Lu._r(),this.Wu.set("Unknown"),[2]}})})},sf.prototype.listen=function(t){this.xu.has(t.targetId)||(this.xu.set(t.targetId,t),this.Zu()?this.tc():this.Qu.Ba()&&this.ic(t))},sf.prototype.rc=function(t){this.xu.delete(t),this.Qu.Ba()&&this.oc(t),0===this.xu.size&&(this.Qu.Ba()?this.Qu.Qa():this.Bu()&&this.Wu.set("Unknown"))},sf.prototype.Me=function(t){return this.xu.get(t)||null},sf.prototype.xe=function(t){return this.hc.xe(t)},sf.prototype.ic=function(t){this.Mu.de(t.targetId),this.Qu.su(t)},sf.prototype.oc=function(t){this.Mu.de(t),this.Qu.iu(t)},sf.prototype.tc=function(){this.Mu=new eo(this),this.Qu.start(),this.Wu.Su()},sf.prototype.Zu=function(){return this.Bu()&&!this.Qu.qa()&&0<this.xu.size},sf.prototype.Bu=function(){return 0===this.Ou.size},sf.prototype.sc=function(){this.Mu=null},sf.prototype.ju=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.xu.forEach(function(t,e){n.ic(t)}),[2]})})},sf.prototype.Ku=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.sc(),this.Zu()?(this.Wu.Fu(e),this.tc()):this.Wu.set("Unknown"),[2]})})},sf.prototype.Gu=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Wu.set("Online"),!(i instanceof Qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.ac(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.uc(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Ki?this.Mu.Pe(i):i instanceof Hi?this.Mu.De(i):this.Mu.ye(i),o.isEqual($r.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.ku.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.cc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.uc(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},sf.prototype.uc=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Fh(n))throw n;return this.Ou.add(1),[4,this.nc()];case 1:return t.sent(),this.Wu.set("Offline"),r=r||function(){return e.ku.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Ou.delete(1),[4,this.Xu()];case 2:return t.sent(),[2]}})})}),[2]}})})},sf.prototype.lc=function(e){var n=this;return e().catch(function(t){return n.uc(t,e)})},sf.prototype.cc=function(r){var i=this,t=this.Mu.Ne(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.xu.get(e))&&i.xu.set(e,n.tt(t.resumeToken,r))}),t.Qt.forEach(function(t){var e,n=i.xu.get(t);n&&(i.xu.set(t,n.tt(bi.Y,n.X)),i.oc(t),e=new Ni(n.target,t,1,n.sequenceNumber),i.ic(e))}),this.hc.vh(t)},sf.prototype.ac=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.xu.has(i)?[4,this.hc._c(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.xu.delete(i),this.Mu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},sf.prototype.ec=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.$u.length?this.$u[this.$u.length-1].batchId:-1,t.label=1;case 1:if(!this.fc())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.ku.Fh(e)];case 3:return null===(n=t.sent())?(0===this.$u.length&&this.zu.Qa(),[3,7]):(e=n.batchId,this.dc(n),[3,6]);case 4:return r=t.sent(),[4,this.uc(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.wc()&&this.Tc(),[2]}})})},sf.prototype.fc=function(){return this.Bu()&&this.$u.length<10},sf.prototype.Ec=function(){return this.$u.length},sf.prototype.dc=function(t){this.$u.push(t),this.zu.Ba()&&this.zu.ou&&this.zu.hu(t.mutations)},sf.prototype.wc=function(){return this.Bu()&&!this.zu.qa()&&0<this.$u.length},sf.prototype.Tc=function(){this.zu.start()},sf.prototype.Hu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.zu.cu(),[2]})})},sf.prototype.Ju=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.$u;e<n.length;e++)r=n[e],this.zu.hu(r.mutations);return[2]})})},sf.prototype.au=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.$u.shift(),n=Xu.from(e,i,o),[4,this.lc(function(){return r.hc.Ic(n)})];case 1:return t.sent(),[4,this.ec()];case 2:return t.sent(),[2]}})})},sf.prototype.Yu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.zu.ou?[4,this.mc(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.wc()&&this.Tc(),[2]}})})},sf.prototype.mc=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Xr.ABORTED?(e=this.$u.shift(),this.zu.Wa(),[4,this.lc(function(){return r.hc.Ac(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.ec()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},sf.prototype.Rc=function(){return new nf(this.Tu)},sf.prototype.Uu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ou.add(4),[4,this.nc()];case 1:return t.sent(),this.Wu.set("Unknown"),this.zu.Wa(),this.Qu.Wa(),this.Ou.delete(4),[4,this.Xu()];case 2:return t.sent(),[2]}})})},sf.prototype.Pc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.No(),Dr("RemoteStore","RemoteStore received new credentials"),this.Ou.add(3),[4,this.nc()];case 1:return t.sent(),this.Wu.set("Unknown"),[4,this.hc.Pc(e)];case 2:return t.sent(),this.Ou.delete(3),[4,this.Xu()];case 3:return t.sent(),[2]}})})},sf.prototype.gc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Ou.delete(2),[4,this.Xu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Ou.add(2),[4,this.nc()]);case 3:t.sent(),this.Wu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},sf);function sf(t,e,n,r,i){var o,s,u,a,h,c,l,f,p=this;this.ku=t,this.Tu=e,this.ao=n,this.$u=[],this.xu=new Map,this.Mu=null,this.Ou=new Set,this.Lu=i,this.Lu.qu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bu()?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,this.Uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Wu=new rf(n,r),this.Qu=(h=this.Tu,c=n,l={tu:this.ju.bind(this),Ha:this.Ku.bind(this),nu:this.Gu.bind(this)},(f=h)._u(),new Jl(c,f.xa,f.credentials,f.serializer,l)),this.zu=(o=this.Tu,s=n,u={tu:this.Hu.bind(this),Ha:this.Yu.bind(this),uu:this.Ju.bind(this),au:this.au.bind(this)},(a=o)._u(),new tf(s,a.xa,a.credentials,a.serializer,u))}function uf(t,e){this.ao=t,this.yu=e,this.state="Unknown",this.pu=0,this.bu=null,this.vu=!0}function af(t){this.Tu=t,this.Eu=new Map,this.mutations=[],this.Iu=!1,this.mu=null,this.Au=new Set}function hf(t,e){var n=this;return(n=Wl.call(this)||this).credentials=t,n.serializer=e,n.lu=!1,n}function cf(t,e,n,r,i){var o=this;return(o=Kl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ru=!1,o}function lf(t,e,n,r,i){var o=this;return(o=Hl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function ff(t,e,n,r,i,o){this.Ts=t,this.$a=n,this.xa=r,this.Ma=i,this.listener=o,this.state=0,this.Oa=0,this.La=null,this.stream=null,this.Po=new fa(t,e)}function pf(t,e){this.Fa=t,this.Na=e}function df(t,e){this.Fa=t,this.Na=e,this.type="FirstParty",this.user=Bl.Pa}function yf(t){var e=this;this.va=null,this.currentUser=Bl.UNAUTHENTICATED,this.Sa=!1,this.Da=0,this.Va=null,this.forceRefresh=!1,this.va=function(){e.Da++,e.currentUser=e.Ca(),e.Sa=!0,e.Va&&e.Va(e.currentUser)},this.Da=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.va):(this.va(null),t.get().then(function(t){e.auth=t,e.va&&e.auth.addAuthTokenListener(e.va)},function(){}))}function vf(){this.Va=null}function gf(t,e){return"firestore_clients_"+t+"_"+e}function mf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function wf(t,e){return"firestore_targets_"+t+"_"+e}function bf(t){this.key=t}function If(t){this.key=t}function Ef(t,e,n){this.query=t,this.targetId=e,this.view=n}function Tf(t){this.key=t,this.Ol=!1}var Af=(Gf.Vc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Yr(r.error.code,r.error.message)),i?new Gf(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Gf.prototype.yc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Gf),Nf=(Bf.Vc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Yr(n.error.code,n.error.message)),r?new Bf(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Bf.prototype.yc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Bf),_f=(Ff.Vc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wi,o=0;r&&o<n.activeTargetIds.length;++o)r=di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Ff(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Ff),Sf=(qf.Vc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new qf(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},qf),kf=(jf.prototype.pc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},jf.prototype.bc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},jf.prototype.yc=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},jf),Df=(Uf.Oi=function(t){return!(!t||!t.localStorage)},Uf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,l,f=this;return w(this,function(t){switch(t.label){case 0:return[4,this.hc.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.vc&&(o=this.getItem(gf(this.persistenceKey,i)))&&(s=_f.Vc(i,o))&&(this.Cc=this.Cc.nt(s.clientId,s));for(this.Lc(),(u=this.storage.getItem(this.Oc))&&(a=this.qc(u))&&this.Bc(a),h=0,c=this.Fc;h<c.length;h++)l=c[h],this.Dc(l);return this.Fc=[],this.window.addEventListener("unload",function(){return f._r()}),this.Hi=!0,[2]}})})},Uf.prototype.ds=function(t){this.setItem(this.kc,JSON.stringify(t))},Uf.prototype.Uc=function(){return this.Wc(this.Cc)},Uf.prototype.Qc=function(n){var r=!1;return this.Cc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Uf.prototype.jc=function(t){this.Kc(t,"pending")},Uf.prototype.Gc=function(t,e,n){this.Kc(t,e,n),this.zc(t)},Uf.prototype.Hc=function(t){var e,n,r="not-current";return this.Qc(t)&&(!(e=this.storage.getItem(wf(this.persistenceKey,t)))||(n=Nf.Vc(t,e))&&(r=n.state)),this.Yc.pc(t),this.Lc(),r},Uf.prototype.Jc=function(t){this.Yc.bc(t),this.Lc()},Uf.prototype.Xc=function(t){return this.Yc.activeTargetIds.has(t)},Uf.prototype.Zc=function(t){this.removeItem(wf(this.persistenceKey,t))},Uf.prototype.tl=function(t,e,n){this.el(t,e,n)},Uf.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.zc(t)}),this.currentUser=t,n.forEach(function(t){r.jc(t)})},Uf.prototype.nl=function(t){this.sl(t)},Uf.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.Sc),this.removeItem(this.Nc),this.Hi=!1)},Uf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},Uf.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Uf.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Uf.prototype.Dc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Dr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Nc)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.$c.test(u.key)){if(null==u.newValue)return e=this.il(u.key),[2,this.rl(e,null)];if(n=this.ol(u.key,u.newValue))return[2,this.rl(n.clientId,n)]}else if(this.xc.test(u.key)){if(null!==u.newValue&&(r=this.hl(u.key,u.newValue)))return[2,this.al(r)]}else if(this.Mc.test(u.key)){if(null!==u.newValue&&(i=this.ul(u.key,u.newValue)))return[2,this.cl(i)]}else if(u.key===this.Oc){if(null!==u.newValue&&(o=this.qc(u.newValue)))return[2,this.Bc(o)]}else u.key===this.kc&&(s=function(t){var e=na.ws;if(null!=t)try{var n=JSON.parse(t);Or("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==na.ws&&this.ls(s)}else this.Fc.push(u);return[2]})})})}},Object.defineProperty(Uf.prototype,"Yc",{get:function(){return this.Cc.get(this.vc)},enumerable:!1,configurable:!0}),Uf.prototype.Lc=function(){this.setItem(this.Nc,this.Yc.yc())},Uf.prototype.Kc=function(t,e,n){var r=new Af(this.currentUser,t,e,n),i=mf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.yc())},Uf.prototype.zc=function(t){var e=mf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Uf.prototype.sl=function(t){var e={clientId:this.vc,onlineState:t};this.storage.setItem(this.Oc,JSON.stringify(e))},Uf.prototype.el=function(t,e,n){var r=wf(this.persistenceKey,t),i=new Nf(t,e,n);this.setItem(r,i.yc())},Uf.prototype.il=function(t){var e=this.$c.exec(t);return e?e[1]:null},Uf.prototype.ol=function(t,e){var n=this.il(t);return _f.Vc(n,e)},Uf.prototype.hl=function(t,e){var n=this.xc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Af.Vc(new Bl(i),r,e)},Uf.prototype.ul=function(t,e){var n=this.Mc.exec(t),r=Number(n[1]);return Nf.Vc(r,e)},Uf.prototype.qc=function(t){return Sf.Vc(t)},Uf.prototype.al=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.hc.ll(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Uf.prototype.cl=function(t){return this.hc._l(t.targetId,t.state,t.error)},Uf.prototype.rl=function(t,e){var n=this,r=e?this.Cc.nt(t,e):this.Cc.remove(t),i=this.Wc(this.Cc),o=this.Wc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.hc.fl(s,u).then(function(){n.Cc=r})},Uf.prototype.Bc=function(t){this.Cc.get(t.clientId)&&this.yu(t.onlineState)},Uf.prototype.Wc=function(t){var n=Wi;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},Uf),xf=(Mf.prototype.jc=function(t){},Mf.prototype.Gc=function(t,e,n){},Mf.prototype.Hc=function(t){return this.dl.pc(t),this.wl[t]||"not-current"},Mf.prototype.tl=function(t,e,n){this.wl[t]=e},Mf.prototype.Jc=function(t){this.dl.bc(t)},Mf.prototype.Xc=function(t){return this.dl.activeTargetIds.has(t)},Mf.prototype.Zc=function(t){delete this.wl[t]},Mf.prototype.Uc=function(){return this.dl.activeTargetIds},Mf.prototype.Qc=function(t){return this.dl.activeTargetIds.has(t)},Mf.prototype.start=function(){return this.dl=new kf,Promise.resolve()},Mf.prototype.Ah=function(t,e,n){},Mf.prototype.nl=function(t){},Mf.prototype._r=function(){},Mf.prototype.ds=function(t){},Mf),Pf=(Object.defineProperty(Vf.prototype,"Rl",{get:function(){return this.Tl},enumerable:!1,configurable:!0}),Vf.prototype.Pl=function(t,e){var u=this,a=e?e.gl:new Yi,h=e?e.Al:this.Al,c=e?e.Lt:this.Lt,l=h,f=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof ru?e:null)&&(Tu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Vl(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.ml(r,p)||d&&u.ml(r,d)<0)&&(f=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;l.size>this.query.limit;){var n=this.query.hn()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{Al:l,gl:a,yl:f,Lt:c}},Vf.prototype.Vl=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},Vf.prototype.qn=function(t,e,n){var o=this,r=this.Al;this.Al=t.Al,this.Lt=t.Lt;var i=t.gl.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.ml(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.pl(n);var s=e?this.bl():[],u=0===this.Il.size&&this.Ht?1:0,a=u!==this.El;return this.El=u,0!==i.length||a?{snapshot:new Zi(this.query,t.Al,r,i,t.Lt,0==u,a,!1),vl:s}:{vl:s}},Vf.prototype.Sl=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({Al:this.Al,gl:new Yi,Lt:this.Lt,yl:!1},!1)):{vl:[]}},Vf.prototype.Dl=function(t){return!this.Tl.has(t)&&!!this.Al.has(t)&&!this.Al.get(t).Ke},Vf.prototype.pl=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Tl=e.Tl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Tl=e.Tl.delete(t)}),this.Ht=t.Ht)},Vf.prototype.bl=function(){var e=this;if(!this.Ht)return[];var n=this.Il;this.Il=zi(),this.Al.forEach(function(t){e.Dl(t.key)&&(e.Il=e.Il.add(t.key))});var r=[];return n.forEach(function(t){e.Il.has(t)||r.push(new If(t))}),this.Il.forEach(function(t){n.has(t)||r.push(new bf(t))}),r},Vf.prototype.Cl=function(t){this.Tl=t.Mh,this.Il=zi();var e=this.Pl(t.documents);return this.qn(e,!0)},Vf.prototype.Fl=function(){return Zi.Ut(this.query,this.Al,this.Lt,0===this.El)},Vf),Rf=(Cf.prototype.run=function(){this.kl()},Cf.prototype.kl=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new nf(this.Tu),(n=this.$l(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.xl(t)})})}).catch(function(t){r.xl(t)}),[2]})})})},Cf.prototype.$l=function(t){try{var e=this.updateFunction(t);return!fi(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},Cf.prototype.xl=function(t){var e=this;0<this.Nl&&this.Ml(t)?(--this.Nl,this.ao.Zi(function(){return e.kl(),Promise.resolve()})):this.lo.reject(t)},Cf.prototype.Ml=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Si(e)},Cf),Of=(Object.defineProperty(Lf.prototype,"Zl",{get:function(){return!0===this.Xl},enumerable:!1,configurable:!0}),Lf.prototype.subscribe=function(t){this.Ul=t},Lf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.t_("listen()"),(r=this.Wl.get(s))?(e=r.targetId,this.ql.Hc(e),n=r.view.Fl(),[3,4]):[3,1];case 1:return[4,this.ku.kh(vu(s))];case 2:return i=t.sent(),o=this.ql.Hc(i.targetId),e=i.targetId,[4,this.e_(s,e,"current"===o)];case 3:n=t.sent(),this.Zl&&this.Ll.listen(i),t.label=4;case 4:return[2,n]}})})},Lf.prototype.e_=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.ku.xh(u,!0)];case 1:return e=t.sent(),n=new Pf(u,e.Mh),r=n.Pl(e.documents),i=Ji.zt(a,h&&"Offline"!==this.onlineState),o=n.qn(r,this.Zl,i),this.n_(a,o.vl),s=new Ef(u,a,n),[2,(this.Wl.set(u,s),this.Ql.has(a)?this.Ql.get(a).push(u):this.Ql.set(a,[u]),o.snapshot)]}})})},Lf.prototype.rc=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.t_("unlisten()"),e=this.Wl.get(i),1<(n=this.Ql.get(e.targetId)).length?[2,(this.Ql.set(e.targetId,n.filter(function(t){return!bu(t,i)})),void this.Wl.delete(i))]:this.Zl?(this.ql.Jc(e.targetId),this.ql.Qc(e.targetId)?[3,2]:[4,this.ku.$h(e.targetId,!1).then(function(){r.ql.Zc(e.targetId),r.Ll.rc(e.targetId),r.s_(e.targetId)}).catch(dc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.s_(e.targetId),[4,this.ku.$h(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Lf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.t_("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.ku.Vh(i)];case 2:return e=t.sent(),this.ql.jc(e.batchId),this.i_(e.batchId,o),[4,this.r_(e.Cn)];case 3:return t.sent(),[4,this.Ll.ec()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=tc(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Lf.prototype.runTransaction=function(t,e,n){new Rf(t,this.Tu,e,n).run()},Lf.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.t_("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ku.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Gl.get(e);n&&(Or(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Ol=!0:0<t.Jt.size?Or(n.Ol):0<t.Xt.size&&(Or(n.Ol),n.Ol=!1))}),[4,this.r_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Lf.prototype.Sl=function(r,t){var i;(this.Zl&&0===t||!this.Zl&&1===t)&&(this.t_("applyOnlineStateChange()"),i=[],this.Wl.forEach(function(t,e){var n=e.view.Sl(r);n.snapshot&&i.push(n.snapshot)}),this.Ul.o_(r),this.Ul.nu(i),this.onlineState=r,this.Zl&&this.ql.nl(r))},Lf.prototype._c=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.t_("rejectListens()"),this.ql.tl(u,"rejected",a),e=this.Gl.get(u),(n=e&&e.key)?(r=(r=new Di(ri.P)).nt(n,new iu(n,$r.min())),i=zi().add(n),o=new $i($r.min(),new Map,new Vi(Vr),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.Kl=this.Kl.remove(n),this.Gl.delete(u),this.h_(),[3,4];case 2:return[4,this.ku.$h(u,!1).then(function(){return s.s_(u,a)}).catch(dc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Lf.prototype.Ic=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.t_("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ku.yh(r)];case 2:return n=t.sent(),this.a_(e,null),this.u_(e),this.ql.Gc(e,"acknowledged"),[4,this.r_(n)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Lf.prototype.Ac=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.t_("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.ku.bh(n)];case 2:return e=t.sent(),this.a_(n,r),this.u_(n),this.ql.Gc(n,"rejected",r),[4,this.r_(e)];case 3:return t.sent(),[3,6];case 4:return[4,dc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Lf.prototype.c_=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.Ll.Bu()||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ku.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Yl.get(e)||[]).push(o),this.Yl.set(e,n),[3,4]);case 3:return r=t.sent(),i=tc(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Lf.prototype.u_=function(t){(this.Yl.get(t)||[]).forEach(function(t){t.resolve()}),this.Yl.delete(t)},Lf.prototype.l_=function(e){this.Yl.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Xr.CANCELLED,e))})}),this.Yl.clear()},Lf.prototype.i_=function(t,e){var n=(n=(n=this.Hl[this.currentUser.Aa()])||new Di(Vr)).nt(t,e);this.Hl[this.currentUser.Aa()]=n},Lf.prototype.a_=function(t,e){var n,r=this.Hl[this.currentUser.Aa()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Hl[this.currentUser.Aa()]=r)},Lf.prototype.s_=function(t,e){var n=this;void 0===e&&(e=null),this.ql.Jc(t);for(var r=0,i=this.Ql.get(t);r<i.length;r++){var o=i[r];this.Wl.delete(o),e&&this.Ul.__(o,e)}this.Ql.delete(t),this.Zl&&this.zl.jh(t).forEach(function(t){n.zl.pi(t)||n.f_(t)})},Lf.prototype.f_=function(t){var e=this.Kl.get(t);null!==e&&(this.Ll.rc(e),this.Kl=this.Kl.remove(t),this.Gl.delete(e),this.h_())},Lf.prototype.n_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof bf?(this.zl.Ri(i.key,t),this.d_(i)):i instanceof If?(Dr("SyncEngine","Document no longer in limbo: "+i.key),this.zl.gi(i.key,t),this.zl.pi(i.key)||this.f_(i.key)):Rr()}},Lf.prototype.d_=function(t){var e=t.key;this.Kl.get(e)||(Dr("SyncEngine","New document in limbo: "+e),this.jl.push(e),this.h_())},Lf.prototype.h_=function(){for(;0<this.jl.length&&this.Kl.size<this.Bl;){var t=this.jl.shift(),e=this.Jl.next();this.Gl.set(e,new Tf(t)),this.Kl=this.Kl.nt(t,e),this.Ll.listen(new Ni(vu(pu(t.path)),e,2,na.ws))}},Lf.prototype.w_=function(){return this.Kl},Lf.prototype.T_=function(){return this.jl},Lf.prototype.r_=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wl.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Pl(r);return n.yl?u.ku.xh(i.query,!1).then(function(t){var e=t.documents;return i.view.Pl(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.qn(t,u.Zl,n);u.n_(i.targetId,r.vl),r.snapshot&&(u.Zl&&u.ql.tl(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ea.cs(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Ul.nu(o),[4,this.ku.Ch(s)];case 2:return t.sent(),[2]}})})},Lf.prototype.t_=function(t){},Lf.prototype.Pc=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Dr("SyncEngine","User change. New user:",n.Aa()),[4,this.ku.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.l_("'waitForPendingWrites' promise is rejected due to a user change."),this.ql.Ah(n,e.Ph,e.gh),[4,this.r_(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Lf.prototype.xe=function(t){var e=this.Gl.get(t);if(e&&e.Ol)return zi().add(e.key);var n=zi(),r=this.Ql.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.Wl.get(s),n=n.Ct(u.view.Rl);return n},Lf);function Lf(t,e,n,r,i,o){this.ku=t,this.Ll=e,this.Tu=n,this.ql=r,this.currentUser=i,this.Bl=o,this.Ul=null,this.Wl=new Qr(Iu,bu),this.Ql=new Map,this.jl=[],this.Kl=new Di(ri.P),this.Gl=new Map,this.zl=new yc,this.Hl={},this.Yl=new Map,this.Jl=Ba.si(),this.onlineState="Unknown",this.Xl=void 0}function Cf(t,e,n,r){this.ao=t,this.Tu=e,this.updateFunction=n,this.lo=r,this.Nl=5,this.Po=new fa(this.ao,"transaction_retry")}function Vf(t,e){this.query=t,this.Tl=e,this.El=null,this.Ht=!1,this.Il=zi(),this.Lt=zi(),this.ml=Au(t),this.Al=new Xi(this.ml)}function Mf(){this.dl=new kf,this.wl={},this.yu=null,this.ls=null}function Uf(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.vc=r,this.hc=null,this.yu=null,this.ls=null,this.Sc=this.Dc.bind(this),this.Cc=new Di(Vr),this.Hi=!1,this.Fc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Nc=gf(this.persistenceKey,this.vc),this.kc="firestore_sequence_number_"+this.persistenceKey,this.Cc=this.Cc.nt(this.vc,new kf),this.$c=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.xc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Mc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Oc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Sc)}function jf(){this.activeTargetIds=Wi}function qf(t,e){this.clientId=t,this.onlineState=e}function Ff(t,e){this.clientId=t,this.activeTargetIds=e}function Bf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Gf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function zf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,l,f,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Ql.get(s))&&0!==a.length?[4,e.ku.kh(vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(l=c[h],f=e.Wl.get(l),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).ku.xh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Cl(n),[2,(e.Zl&&e.n_(o.targetId,r.vl),r)]}})})}(e,f)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,pc(e.ku,s)];case 8:return d=t.sent(),[4,e.ku.kh(d)];case 9:return u=t.sent(),[4,e.e_(Wf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Ul.nu(r),n)]}})})}function Wf(t){return fu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Kf(){this.E_=void 0,this.listeners=[]}var Hf,Qf=(rp.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.I_.get(e))||(n=!0,r=new Kf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.hc.listen(e)];case 2:return i.E_=t.sent(),[3,4];case 3:return o=t.sent(),s=tc(o,"Initialization of query '"+Eu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.I_.set(e,r),r.listeners.push(u),u.Sl(this.onlineState),r.E_&&u.A_(r.E_)&&this.R_(),[2]}})})},rp.prototype.rc=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.I_.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.I_.delete(e),this.hc.rc(e))]:[2]})})},rp.prototype.nu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.I_.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].A_(i)&&(e=!0);s.E_=i}}e&&this.R_()},rp.prototype.__=function(t,e){var n=this.I_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.I_.delete(t)},rp.prototype.o_=function(i){this.onlineState=i;var o=!1;this.I_.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Sl(i)&&(o=!0)}),o&&this.R_()},rp.prototype.P_=function(t){this.m_.add(t),t.next()},rp.prototype.g_=function(t){this.m_.delete(t)},rp.prototype.R_=function(){this.m_.forEach(function(t){t.next()})},rp),Xf=(np.prototype.A_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.y_?this.b_(t)&&(this.V_.next(t),o=!0):this.v_(t,this.onlineState)&&(this.S_(t),o=!0),this.p_=t,o},np.prototype.onError=function(t){this.V_.error(t)},np.prototype.Sl=function(t){this.onlineState=t;var e=!1;return this.p_&&!this.y_&&this.v_(this.p_,t)&&(this.S_(this.p_),e=!0),e},np.prototype.v_=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.D_&&n||t.docs._()&&"Offline"!==e)},np.prototype.b_=function(t){if(0<t.docChanges.length)return!0;var e=this.p_&&this.p_.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},np.prototype.S_=function(t){t=Zi.Ut(t.query,t.docs,t.Lt,t.fromCache),this.y_=!0,this.V_.next(t)},np),Yf=(ep.prototype.mh=function(t){this.C_=t},ep.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual($r.min())?this.F_(e,r):this.C_.Jn(e,o).next(function(t){var n=s.N_(r,t);return(r.hn()||r.an())&&s.yl(r.en,n,o,i)?s.F_(e,r):(kr()<=p.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Eu(r)),s.C_.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},ep.prototype.N_=function(n,t){var r=new Vi(Au(n));return t.forEach(function(t,e){e instanceof ru&&Tu(n,e)&&(r=r.add(e))}),r},ep.prototype.yl=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},ep.prototype.F_=function(t,e){return kr()<=p.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Eu(e)),this.C_.ts(t,e,$r.min())},ep),Zf=(tp.prototype.Or=function(t){return Yu.resolve(0===this.jn.length)},tp.prototype.Lr=function(t,e,n,r){var i=this.k_;this.k_++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new Qu(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.x_=this.x_.add(new vc(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return Yu.resolve(o)},tp.prototype.qr=function(t,e){return Yu.resolve(this.M_(e))},tp.prototype.Ur=function(t,e){var n=e+1,r=this.O_(n),i=r<0?0:r;return Yu.resolve(this.jn.length>i?this.jn[i]:null)},tp.prototype.Wr=function(){return Yu.resolve(0===this.jn.length?-1:this.k_-1)},tp.prototype.Qr=function(t){return Yu.resolve(this.jn.slice())},tp.prototype.zn=function(t,e){var n=this,r=new vc(e,0),i=new vc(e,Number.POSITIVE_INFINITY),o=[];return this.x_.vt([r,i],function(t){var e=n.M_(t.zh);o.push(e)}),Yu.resolve(o)},tp.prototype.Zn=function(t,e){var r=this,i=new Vi(Vr);return e.forEach(function(t){var e=new vc(t,0),n=new vc(t,Number.POSITIVE_INFINITY);r.x_.vt([e,n],function(t){i=i.add(t.zh)})}),Yu.resolve(this.L_(i))},tp.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;ri.W(i)||(i=i.child(""));var o=new vc(new ri(i),0),s=new Vi(Vr);return this.x_.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),Yu.resolve(this.L_(s))},tp.prototype.L_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.M_(t);null!==e&&r.push(e)}),r},tp.prototype.Kr=function(n,r){var i=this;Or(0===this.q_(r.batchId,"removed")),this.jn.shift();var o=this.x_;return Yu.forEach(r.mutations,function(t){var e=new vc(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.x_=o})},tp.prototype.Gr=function(t){},tp.prototype.pi=function(t,e){var n=new vc(e,0),r=this.x_.Dt(n);return Yu.resolve(e.isEqual(r&&r.key))},tp.prototype.zr=function(t){return this.jn.length,Yu.resolve()},tp.prototype.q_=function(t,e){return this.O_(t)},tp.prototype.O_=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},tp.prototype.M_=function(t){var e=this.O_(t);return e<0||e>=this.jn.length?null:this.jn[e]},tp),$f=(Jf.prototype.kn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.B_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},Jf.prototype.xn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Jf.prototype.Mn=function(t,e){var n=this.docs.get(e);return Yu.resolve(n?n.Ls:null)},Jf.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),Yu.resolve(r)},Jf.prototype.ts=function(t,e,n){for(var r=Fi,i=new ri(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Ls,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof ru&&Tu(e,h)&&(r=r.nt(h.key,h))}return Yu.resolve(r)},Jf.prototype.U_=function(t,e){return Yu.forEach(this.docs,function(t){return e(t)})},Jf.prototype.Hs=function(t){return new Jf.Ys(this)},Jf.prototype.Xs=function(t){return Yu.resolve(this.size)},Jf);function Jf(t,e){this.Kn=t,this.B_=e,this.docs=new Di(ri.P),this.size=0}function tp(t,e){this.Kn=t,this.ii=e,this.jn=[],this.k_=1,this.x_=new Vi(vc.Lh)}function ep(){}function np(t,e,n){this.query=t,this.V_=e,this.y_=!1,this.p_=null,this.onlineState="Unknown",this.options=n||{}}function rp(t){this.hc=t,this.I_=new Qr(Iu,bu),this.onlineState="Unknown",this.m_=new Set,this.hc.subscribe(this)}function ip(t){var e=this;return(e=Hf.call(this)||this).Zs=t,e}$f.Ys=(n(ip,Hf=Zu),ip.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.kn(n,e,r.readTime)):r.Zs.xn(t)}),Yu.Sn(i)},ip.prototype.On=function(t,e){return this.Zs.Mn(t,e)},ip.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},ip);var op,sp,up,ap=(Vp.prototype.pe=function(t,n){return this.W_.forEach(function(t,e){return n(e)}),Yu.resolve()},Vp.prototype.ai=function(t){return Yu.resolve(this.lastRemoteSnapshotVersion)},Vp.prototype.ui=function(t){return Yu.resolve(this.Q_)},Vp.prototype.ri=function(t){return this.highestTargetId=this.K_.next(),Yu.resolve(this.highestTargetId)},Vp.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Q_&&(this.Q_=e),Yu.resolve()},Vp.prototype._i=function(t){this.W_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.K_=new Ba(e),this.highestTargetId=e),t.sequenceNumber>this.Q_&&(this.Q_=t.sequenceNumber)},Vp.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,Yu.resolve()},Vp.prototype.di=function(t,e){return this._i(e),Yu.resolve()},Vp.prototype.wi=function(t,e){return this.W_.delete(e.target),this.j_.jh(e.targetId),--this.targetCount,Yu.resolve()},Vp.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.W_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.W_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),Yu.Sn(u).next(function(){return s})},Vp.prototype.Ii=function(t){return Yu.resolve(this.targetCount)},Vp.prototype.mi=function(t,e){var n=this.W_.get(e)||null;return Yu.resolve(n)},Vp.prototype.Ai=function(t,e,n){return this.j_.Uh(e,n),Yu.resolve()},Vp.prototype.Pi=function(e,t,n){this.j_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),Yu.Sn(i)},Vp.prototype.Ti=function(t,e){return this.j_.jh(e),Yu.resolve()},Vp.prototype.Vi=function(t,e){var n=this.j_.Gh(e);return Yu.resolve(n)},Vp.prototype.pi=function(t,e){return Yu.resolve(this.j_.pi(e))},Vp),hp=(Cp.prototype.start=function(){return Promise.resolve()},Cp.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(Cp.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),Cp.prototype.Yi=function(){},Cp.prototype.Xi=function(){},Cp.prototype.gr=function(){return this.Kn},Cp.prototype.mr=function(t){var e=this.G_[t.Aa()];return e||(e=new Zf(this.Kn,this.ii),this.G_[t.Aa()]=e),e},Cp.prototype.Rr=function(){return this.qi},Cp.prototype.Pr=function(){return this.Qn},Cp.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new cp(this.Ci.next());return this.ii.H_(),n(i).next(function(t){return r.ii.Y_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},Cp.prototype.J_=function(e,n){return Yu.Dn(Object.values(this.G_).map(function(t){return function(){return t.pi(e,n)}}))},Cp),cp=(n(Lp,up=Ju),Lp),lp=(Op.tf=function(t){return new Op(t)},Object.defineProperty(Op.prototype,"ef",{get:function(){if(this.Z_)return this.Z_;throw Rr()},enumerable:!1,configurable:!0}),Op.prototype.Ri=function(t,e,n){return this.X_.Ri(n,e),this.ef.delete(n),Yu.resolve()},Op.prototype.gi=function(t,e,n){return this.X_.gi(n,e),this.ef.add(n),Yu.resolve()},Op.prototype.Dr=function(t,e){return this.ef.add(e),Yu.resolve()},Op.prototype.removeTarget=function(t,e){var n=this;this.X_.jh(e.targetId).forEach(function(t){return n.ef.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.ef.add(t)})}).next(function(){return r.wi(t,e)})},Op.prototype.H_=function(){this.Z_=new Set},Op.prototype.Y_=function(t){var n=this,r=this.persistence.Pr().Hs();return Yu.forEach(this.ef,function(e){return n.nf(t,e).next(function(t){t||r.xn(e)})}).next(function(){return n.Z_=null,r.apply(t)})},Op.prototype.kr=function(t,e){var n=this;return this.nf(t,e).next(function(t){t?n.ef.delete(e):n.ef.add(e)})},Op.prototype.z_=function(t){return 0},Op.prototype.nf=function(t,e){var n=this;return Yu.Dn([function(){return Yu.resolve(n.X_.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.J_(t,e)}])},Op),fp=(Rp.prototype.tu=function(t){this.rf=t},Rp.prototype.Ha=function(t){this.hf=t},Rp.prototype.onMessage=function(t){this.af=t},Rp.prototype.close=function(){this.if()},Rp.prototype.send=function(t){this.sf(t)},Rp.prototype.uf=function(){this.rf()},Rp.prototype.cf=function(t){this.hf(t)},Rp.prototype.lf=function(t){this.af(t)},Rp),pp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},dp=(Pp.prototype.ff=function(t,e){if(e)for(var n in e.ga)e.ga.hasOwnProperty(n)&&(t[n]=e.ga[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.2-20206291717"},Pp.prototype.fu=function(a,r,i){var h=this,c=this.df(a);return new Promise(function(o,s){var u=new Tr;u.listenOnce(Ir.COMPLETE,function(){try{switch(u.getLastErrorCode()){case br.NO_ERROR:var t=u.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:Dr("Connection",'RPC "'+a+'" timed out'),s(new Yr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=u.getStatus();Dr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Xr).indexOf(i)?i:Xr.UNKNOWN,s(new Yr(n,e.message))):s(new Yr(Xr.UNKNOWN,"Server responded with status "+u.getStatus())):(Dr("Connection",'RPC "'+a+'" failed'),s(new Yr(Xr.UNAVAILABLE,"Connection failed.")));break;default:Rr()}}finally{Dr("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Dr("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.ff(n,i),u.send(c,"POST",e,n,15)})},Pp.prototype.du=function(t,e,n){return this.fu(t,e,n)},Pp.prototype.eu=function(t,e){var n,r,i=[this._f,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ff(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Dr("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new fp({sf:function(t){l?Dr("Connection","Not sending because WebChannel is closed:",t):(c||(Dr("Connection","Opening WebChannel transport."),h.open(),c=!0),Dr("Connection","WebChannel sending:",t),h.send(t))},if:function(){return h.close()}});return a(Er.EventType.OPEN,function(){l||Dr("Connection","WebChannel transport opened.")}),a(Er.EventType.CLOSE,function(){l||(l=!0,Dr("Connection","WebChannel transport closed"),f.cf())}),a(Er.EventType.ERROR,function(t){l||(l=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Sr.logLevel<=p.WARN&&(e=n.map(Pr),Sr.warn.apply(Sr,d(["Firestore ("+_r+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),f.cf(new Yr(Xr.UNAVAILABLE,"The operation could not be completed")))}),a(Er.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Or(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Dr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ti[i];if(void 0!==t)return ki(t)}(),s=r.message,void 0===o&&(o=Xr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.cf(new Yr(o,s)),h.close()):(Dr("Connection","WebChannel received:",n),f.lf(n)))}),setTimeout(function(){f.uf()},0),f},Pp.prototype.df=function(t){var e=pp[t];return this._f+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Pp),yp=(xp.prototype.qu=function(t){this.mf.push(t)},xp.prototype._r=function(){window.removeEventListener("online",this.wf),window.removeEventListener("offline",this.Ef)},xp.prototype.Af=function(){window.addEventListener("online",this.wf),window.addEventListener("offline",this.Ef)},xp.prototype.Tf=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.mf;t<e.length;t++)(0,e[t])(0)},xp.prototype.If=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.mf;t<e.length;t++)(0,e[t])(1)},xp.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},xp),vp=(Dp.prototype.qu=function(t){},Dp.prototype._r=function(){},Dp),gp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",mp=(kp.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ql=this.Rf(e),this.persistence=this.Pf(e),[4,this.persistence.start()];case 1:return t.sent(),this.gf=this.Vf(e),this.ku=this.yf(e),[2]}})})},kp.prototype.Vf=function(t){return null},kp.prototype.yf=function(t){return e=this.persistence,n=new Yf,r=t.pf,new hc(e,n,r);var e,n,r},kp.prototype.Pf=function(t){if(t.vf.bf)throw new Yr(Xr.FAILED_PRECONDITION,gp);return new hp(lp.tf)},kp.prototype.Rf=function(t){return new xf},kp.prototype.clearPersistence=function(t,e){throw new Yr(Xr.FAILED_PRECONDITION,gp)},kp),wp=(n(Sp,sp=mp),Sp.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,sp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Eh,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.ku)];case 2:return t.sent(),[2]}})})},Sp.prototype.Vf=function(t){var e=this.persistence.ii.yr;return new uc(e,t.ao)},Sp.prototype.Pf=function(t){var e=sh(t.Sf.s,t.Sf.persistenceKey),n=ml(t.Sf.s);return new $a(t.vf.synchronizeTabs,e,t.clientId,ic.Ho(t.vf.cacheSizeBytes),t.ao,Xh(),"undefined"!=typeof document?document:null,n,this.ql,t.vf.Di)},Sp.prototype.Rf=function(t){return new xf},Sp.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ch.Oi()?(e=n+"main",[4,Ch.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(sh(t,e))},n(_p,op=Sp),_p.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,op.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.Df.initialize(this,r)];case 2:return t.sent(),e=this.Df.hc,this.ql instanceof Df?(this.ql.hc={ll:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).t_("applyBatchState()"),[4,(e=o.ku,n=a,i=(r=e).jn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Br(e,n).next(function(t){return t?r.Ih.Jn(e,t):Yu.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.Ll.ec()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.a_(a,c||null),o.ku.jn.Gr(a)):Rr(),t.label=4;case 4:return[4,o.r_(s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),_l:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).Xl?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Ql.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.ku,e=r.Eh,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=$i.Gt(u,"current"===a),[4,n.r_(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.ku.$h(u,!0)];case 6:return t.sent(),n.s_(u,h),[3,8];case 7:Rr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),fl:function(l,f,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=l).Xl)return[3,10];e=0,r=f,t.label=1;case 1:return e<r.length?(i=r[e],n.Ql.has(i)?(Dr("SyncEngine","Adding an already active target "+i),[3,5]):[4,pc(n.ku,i)]):[3,6];case 2:return o=t.sent(),[4,n.ku.kh(o)];case 3:return s=t.sent(),[4,n.e_(Wf(o),s.targetId,!1)];case 4:t.sent(),n.Ll.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Ql.has(e)?[4,n.ku.$h(e,!1).then(function(){n.Ll.rc(e),n.s_(e)}).catch(dc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Ir:function(t){return t.ku.persistence.Ir()}.bind(null,e)},[4,this.ql.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,l){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==l||!0===r.Xl?[3,3]:(e=r.ql.Uc(),[4,zf(r,e.F())]);case 1:return i=t.sent(),r.Xl=!0,[4,r.Ll.gc(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Ll.listen(u);return[3,7];case 3:return!1!==l||!1===r.Xl?[3,7]:(a=[],h=Promise.resolve(),r.Ql.forEach(function(t,e){r.ql.Xc(e)?a.push(e):h=h.then(function(){return r.s_(e),r.ku.$h(e,!0)}),r.Ll.rc(e)}),[4,h]);case 4:return t.sent(),[4,zf(r,a)];case 5:return t.sent(),(n=r).Gl.forEach(function(t,e){n.Ll.rc(e)}),n.zl.Kh(),n.Gl=new Map,n.Kl=new Di(ri.P),r.Xl=!1,[4,r.Ll.gc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Df.hc,e)];case 1:return t.sent(),this.gf&&(e&&!this.gf.Hi?this.gf.start(this.ku):e||this.gf.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},_p.prototype.Rf=function(t){if(t.vf.bf&&t.vf.synchronizeTabs){var e=Xh();if(!Df.Oi(e))throw new Yr(Xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=sh(t.Sf.s,t.Sf.persistenceKey);return new Df(e,t.ao,n,t.clientId,t.pf)}return new xf},_p),bp=(Np.prototype.initialize=function(r,i){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.ku?[2]:(this.ku=r.ku,this.ql=r.ql,this.Tu=this.Cf(i),[4,this.Ff(i)]);case 1:return e=t.sent(),this.Tu.start(e),this.Ll=this.Nf(i),this.hc=this.kf(i),this.$f=this.xf(i),this.ql.yu=function(t){return n.hc.Sl(t,1)},this.Ll.hc=this.hc,[4,this.Ll.start()];case 2:return t.sent(),[4,this.Ll.gc(this.hc.Zl)];case 3:return t.sent(),[2]}})})},Np.prototype.Ff=function(t){return e=t.Sf,Promise.resolve(new dp(e));var e},Np.prototype.xf=function(t){return new Qf(this.hc)},Np.prototype.Cf=function(t){var e=ml(t.Sf.s),n=t.credentials;return new ef(n,e)},Np.prototype.Nf=function(t){var e=this;return new of(this.ku,this.Tu,t.ao,function(t){return e.hc.Sl(t,0)},new(yp.Oi()?yp:vp))},Np.prototype.kf=function(t){return e=this.ku,n=this.Ll,r=this.Tu,i=this.ql,o=t.pf,s=t.Bl,u=!t.vf.bf||!t.vf.synchronizeTabs,a=new Of(e,n,r,i,o,s),u&&(a.Xl=!0),a;var e,n,r,i,o,s,u,a},Np),Ip=(Ap.prototype.start=function(t,e,n,r){var i=this;this.Mf(),this.Sf=t;var o=new la,s=new la,u=!1;return this.credentials.pa(function(t){return u?void i.ao.er(function(){return i.Ll.Pc(t)}):(u=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.Of(e,n,r,t,s).then(o.resolve,o.reject))}),this.ao.Zi(function(){return o.promise}),s.promise},Ap.prototype.enableNetwork=function(){var t=this;return this.Mf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.Ll.enableNetwork()})},Ap.prototype.Of=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ao:this.ao,Sf:this.Sf,clientId:this.clientId,credentials:this.credentials,pf:u,Bl:100,vf:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.ql=i.ql,this.ku=i.ku,this.gf=i.gf,this.Ll=o.Ll,this.hc=o.hc,this.Lf=o.$f,this.persistence.Yi(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.qf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Of(new mp,new bp,{bf:!1},u,a))];case 4:return[2]}})})},Ap.prototype.qf=function(t){return"FirebaseError"===t.name?t.code===Xr.FAILED_PRECONDITION||t.code===Xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ap.prototype.Mf=function(){if(this.ao.yo)throw new Yr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Ap.prototype.disableNetwork=function(){var t=this;return this.Mf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.Ll.disableNetwork()})},Ap.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.gf&&this.gf.stop(),[4,this.Ll._r()];case 1:return t.sent(),[4,this.ql._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.ba(),[2]}})})})},Ap.prototype.waitForPendingWrites=function(){var t=this;this.Mf();var e=new la;return this.ao.Zi(function(){return t.hc.c_(e)}),e.promise},Ap.prototype.listen=function(t,e,n){var r=this;this.Mf();var i=new Xf(t,e,n);return this.ao.Zi(function(){return r.Lf.listen(i)}),i},Ap.prototype.rc=function(t){var e=this;this.Bf||this.ao.Zi(function(){return e.Lf.rc(t)})},Ap.prototype.Uf=function(o){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return this.Mf(),i=new la,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.ku.Nh(o)];case 1:return(e=t.sent())instanceof ru?i.resolve(e):e instanceof iu?i.resolve(null):i.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=tc(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Ap.prototype.Wf=function(a){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return this.Mf(),u=new la,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.ku.xh(a,!0)];case 1:return e=t.sent(),n=new Pf(a,e.Mh),r=n.Pl(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=tc(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Ap.prototype.write=function(t){var e=this;this.Mf();var n=new la;return this.ao.Zi(function(){return e.hc.write(t,n)}),n.promise},Ap.prototype.s=function(){return this.Sf.s},Ap.prototype.P_=function(t){var e=this;this.Mf(),this.ao.Zi(function(){return e.Lf.P_(t),Promise.resolve()})},Ap.prototype.g_=function(t){var e=this;this.Bf||this.ao.Zi(function(){return e.Lf.g_(t),Promise.resolve()})},Object.defineProperty(Ap.prototype,"Bf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Ap.prototype.transaction=function(t){var e=this;this.Mf();var n=new la;return this.ao.Zi(function(){return e.hc.runTransaction(e.ao,t,n),Promise.resolve()}),n.promise},Ap),Ep=(Tp.prototype.next=function(t){this.Qf(this.observer.next,t)},Tp.prototype.error=function(t){this.Qf(this.observer.error,t)},Tp.prototype.jf=function(){this.muted=!0},Tp.prototype.Qf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Tp);function Tp(t){this.observer=t,this.muted=!1}function Ap(t,e){this.credentials=t,this.ao=e,this.clientId=Lr.t()}function Np(){}function _p(t){var e=this;return(e=op.call(this)||this).Df=t,e}function Sp(){return null!==sp&&sp.apply(this,arguments)||this}function kp(){}function Dp(){}function xp(){var t=this;this.wf=function(){return t.Tf()},this.Ef=function(){return t.If()},this.mf=[],this.Af()}function Pp(t){this.s=t.s;var e=t.ssl?"https":"http";this._f=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function Rp(t){this.sf=t.sf,this.if=t.if}function Op(t){this.persistence=t,this.X_=new yc,this.Z_=null}function Lp(t){var e=this;return(e=up.call(this)||this).vi=t,e}function Cp(t){var e=this;this.G_={},this.Ci=new na(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new ap(this),this.Kn=new ga,this.Qn=new $f(this.Kn,function(t){return e.ii.z_(t)})}function Vp(t){this.persistence=t,this.W_=new Qr(gi,mi),this.lastRemoteSnapshotVersion=$r.min(),this.highestTargetId=0,this.Q_=0,this.j_=new yc,this.targetCount=0,this.K_=Ba.ni()}function Mp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Up=(zp.prototype.zf=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Hf(t.timestampValue);case 4:return this.Yf(t);case 5:return t.stringValue;case 6:return new Bc(To(t.bytesValue));case 7:return this.Jf(t.referenceValue);case 8:return this.Xf(t.geoPointValue);case 9:return this.Zf(t.arrayValue);case 10:return this.td(t.mapValue);default:throw Rr()}},zp.prototype.td=function(t){var n=this,r={};return Gr(t.fields||{},function(t,e){r[t]=n.zf(e)}),r},zp.prototype.Xf=function(t){return new cl(Eo(t.latitude),Eo(t.longitude))},zp.prototype.Zf=function(t){var e=this;return(t.values||[]).map(function(t){return e.zf(t)})},zp.prototype.Yf=function(t){switch(this.Kf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.zf(e);case"estimate":return this.Hf(fo(t));default:return null}},zp.prototype.Hf=function(t){var e=Io(t),n=new Zr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},zp.prototype.Jf=function(t){var e=ti.k(t);Or(ns(e));var n=new qr(e.get(1),e.get(3)),r=new ri(e.V(5));return n.isEqual(this.s)||xr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Gf(r)},zp),jp=ic.Xo,qp=(Gp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Gp),Fp=(Object.defineProperty(Bp.prototype,"fd",{get:function(){return this.dd||(this.dd=new Sl(this.aa,this._d.ignoreUndefinedProperties)),this.dd},enumerable:!1,configurable:!0}),Bp.prototype.settings=function(t){bc("Firestore.settings",arguments,1),Tc("Firestore.settings","object",1,t);var e=new qp(t);if(this.hd&&!this._d.isEqual(e))throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._d=e).credentials&&(this.ld=function(t){if(!t)return new Ql;switch(t.type){case"gapi":var e=t.wd;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zl(e,t.Na||"0");case"provider":return t.wd;default:throw new Yr(Xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Bp.prototype.enableNetwork=function(){return this.od(),this.hd.enableNetwork()},Bp.prototype.disableNetwork=function(){return this.od(),this.hd.disableNetwork()},Bp.prototype.enablePersistence=function(t){var e,n;if(this.hd)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Yr(Xr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Td(this.ed,this.nd,{bf:!0,cacheSizeBytes:this._d.cacheSizeBytes,synchronizeTabs:r,Di:i})},Bp.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.hd&&!this.hd.Bf)throw new Yr(Xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new la,[2,(this.rd.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.ed.clearPersistence(this.aa,this.ud)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Bp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Bp.prototype,"Ed",{get:function(){return this.od(),this.hd.Bf},enumerable:!1,configurable:!0}),Bp.prototype.waitForPendingWrites=function(){return this.od(),this.hd.waitForPendingWrites()},Bp.prototype.onSnapshotsInSync=function(t){if(this.od(),Mp(t))return Wp(this.hd,t);Tc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return Wp(this.hd,e)},Bp.prototype.od=function(){return this.hd||this.Td(new mp,new bp,{bf:!1}),this.hd},Bp.prototype.Id=function(){return new jr(this.aa,this.ud,this._d.host,this._d.ssl,this._d.forceLongPolling)},Bp.prototype.Td=function(t,e,n){var r=this.Id();return this.hd=new Ip(this.ld,this.rd),this.hd.start(r,t,e,n)},Bp.ad=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yr(Xr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qr(n)},Object.defineProperty(Bp.prototype,"app",{get:function(){if(!this.sd)throw new Yr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.sd},enumerable:!1,configurable:!0}),Bp.prototype.collection=function(t){return bc("Firestore.collection",arguments,1),Tc("Firestore.collection","non-empty string",1,t),this.od(),new vd(ti.k(t),this,null)},Bp.prototype.doc=function(t){return bc("Firestore.doc",arguments,1),Tc("Firestore.doc","non-empty string",1,t),this.od(),Xp.md(ti.k(t),this,null)},Bp.prototype.collectionGroup=function(t){if(bc("Firestore.collectionGroup",arguments,1),Tc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.od(),new ld((e=t,new cu(ti.$(),e)),this,null);var e},Bp.prototype.runTransaction=function(e){var n=this;return bc("Firestore.runTransaction",arguments,1),Tc("Firestore.runTransaction","function",1,e),this.od().transaction(function(t){return e(new Hp(n,t))})},Bp.prototype.batch=function(){return this.od(),new Qp(this)},Object.defineProperty(Bp,"logLevel",{get:function(){switch(kr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Bp.setLogLevel=function(t){bc("Firestore.setLogLevel",arguments,1),kc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Sr.setLogLevel(t)},Bp.prototype.Ad=function(){return this._d.timestampsInSnapshots},Bp);function Bp(t,e,n,r){var i=this;if(void 0===n&&(n=new mp),void 0===r&&(r=new bp),this.ed=n,this.nd=r,this.sd=null,this.rd=new Zh,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.od(),[4,this.hd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.sd=o,this.aa=Bp.ad(o),this.ud=o.name,this.ld=new Xl(e)}else{var s=t;if(!s.projectId)throw new Yr(Xr.INVALID_ARGUMENT,"Must provide projectId");this.aa=new qr(s.projectId,s.database),this.ud="[DEFAULT]",this.ld=new Ql}this._d=new qp({})}function Gp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Nc("settings","non-empty string","host",t.host),this.host=t.host,_c("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Oc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),_c("settings","object","credentials",t.credentials),this.credentials=t.credentials,_c("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),_c("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,_c("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ic.th;else{if(t.cacheSizeBytes!==jp&&t.cacheSizeBytes<ic.Zo)throw new Yr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ic.Zo);this.cacheSizeBytes=t.cacheSizeBytes}_c("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function zp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Kf=n,this.Gf=r}function Wp(t,e){var n=new Ep({next:function(){e.next&&e.next()},error:function(t){throw Rr()}});return t.P_(n),function(){n.jf(),t.g_(n)}}var Kp,Hp=($p.prototype.get=function(t){var n=this;bc("Transaction.get",arguments,1);var r=Ed("Transaction.get",t,this.Rd);return this.Pd.Ru([r.ua]).then(function(t){if(!t||1!==t.length)return Rr();var e=t[0];if(e instanceof iu)return new nd(n.Rd,r.ua,null,!1,!1,r.ca);if(e instanceof ru)return new nd(n.Rd,r.ua,e,!1,!1,r.ca);throw Rr()})},$p.prototype.set=function(t,e,n){Ec("Transaction.set",arguments,2,3);var r=Ed("Transaction.set",t,this.Rd);n=wd("Transaction.set",n);var i=Td(r.ca,e,n),o=xl(this.Rd.fd,"Transaction.set",r.ua,i,null!==r.ca,n);return this.Pd.set(r.ua,o),this},$p.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof zc?(Ic("Transaction.update",arguments,3),r=Ed("Transaction.update",t,this.Rd),Rl(this.Rd.fd,"Transaction.update",r.ua,e,n,o)):(bc("Transaction.update",arguments,2),r=Ed("Transaction.update",t,this.Rd),Pl(this.Rd.fd,"Transaction.update",r.ua,e)),this.Pd.update(r.ua,i),this},$p.prototype.delete=function(t){bc("Transaction.delete",arguments,1);var e=Ed("Transaction.delete",t,this.Rd);return this.Pd.delete(e.ua),this},$p),Qp=(Zp.prototype.set=function(t,e,n){Ec("WriteBatch.set",arguments,2,3),this.yd();var r=Ed("WriteBatch.set",t,this.Rd);n=wd("WriteBatch.set",n);var i=Td(r.ca,e,n),o=xl(this.Rd.fd,"WriteBatch.set",r.ua,i,null!==r.ca,n);return this.gd=this.gd.concat(o.la(r.ua,Ns.We())),this},Zp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.yd(),i="string"==typeof e||e instanceof zc?(Ic("WriteBatch.update",arguments,3),r=Ed("WriteBatch.update",t,this.Rd),Rl(this.Rd.fd,"WriteBatch.update",r.ua,e,n,o)):(bc("WriteBatch.update",arguments,2),r=Ed("WriteBatch.update",t,this.Rd),Pl(this.Rd.fd,"WriteBatch.update",r.ua,e)),this.gd=this.gd.concat(i.la(r.ua,Ns.exists(!0))),this},Zp.prototype.delete=function(t){bc("WriteBatch.delete",arguments,1),this.yd();var e=Ed("WriteBatch.delete",t,this.Rd);return this.gd=this.gd.concat(new Ws(e.ua,Ns.We())),this},Zp.prototype.commit=function(){return this.yd(),this.Vd=!0,0<this.gd.length?this.Rd.od().write(this.gd):Promise.resolve()},Zp.prototype.yd=function(){if(this.Vd)throw new Yr(Xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Zp),Xp=(n(Yp,Kp=bl),Yp.md=function(t,e,n){if(t.length%2!=0)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Yp(new ri(t),e,n)},Object.defineProperty(Yp.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"parent",{get:function(){return new vd(this.ua.path.p(),this.firestore,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"path",{get:function(){return this.ua.path.N()},enumerable:!1,configurable:!0}),Yp.prototype.collection=function(t){if(bc("DocumentReference.collection",arguments,1),Tc("DocumentReference.collection","non-empty string",1,t),!t)throw new Yr(Xr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ti.k(t);return new vd(this.ua.path.child(e),this.firestore,null)},Yp.prototype.isEqual=function(t){if(!(t instanceof Yp))throw Lc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ua.isEqual(t.ua)&&this.ca===t.ca},Yp.prototype.set=function(t,e){Ec("DocumentReference.set",arguments,1,2),e=wd("DocumentReference.set",e);var n=Td(this.ca,t,e),r=xl(this.firestore.fd,"DocumentReference.set",this.ua,n,null!==this.ca,e);return this.hd.write(r.la(this.ua,Ns.We()))},Yp.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof zc?(Ic("DocumentReference.update",arguments,2),Rl(this.firestore.fd,"DocumentReference.update",this.ua,t,e,r)):(bc("DocumentReference.update",arguments,1),Pl(this.firestore.fd,"DocumentReference.update",this.ua,t)),this.hd.write(n.la(this.ua,Ns.exists(!0)))},Yp.prototype.delete=function(){return bc("DocumentReference.delete",arguments,0),this.hd.write([new Ws(this.ua,Ns.We())])},Yp.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ec("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Mp(i[u])||(Oc("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),_c("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};Mp(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Tc("DocumentReference.onSnapshot","function",u,i[u]),Ac("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ac("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.pd(t))},error:i[u+1],complete:i[u+2]};return Jp(this.hd,this.ua,h,c)},Yp.prototype.get=function(t){var e,n,r,i,o,s=this;return Ec("DocumentReference.get",arguments,0,1),Id("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.od().Uf(this.ua).then(function(t){return new nd(s.firestore,s.ua,t,!0,t instanceof ru&&t.Ke,s.ca)}):(e=this.hd,n=this.ua,r=t,i=new la,o=Jp(e,n,{includeMetadataChanges:!0,D_:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Yr(Xr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Yr(Xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.pd(t)}))},Yp.prototype.withConverter=function(t){return new Yp(this.ua,this.firestore,t)},Yp.prototype.pd=function(t){var e=t.docs.get(this.ua);return new nd(this.firestore,this.ua,e,t.fromCache,t.hasPendingWrites,this.ca)},Yp);function Yp(t,e,n){var r=this;return(r=Kp.call(this,e.aa,t,n)||this).ua=t,r.firestore=e,r.ca=n,r.hd=r.firestore.od(),r}function Zp(t){this.Rd=t,this.gd=[],this.Vd=!1}function $p(t,e){this.Rd=t,this.Pd=e}function Jp(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ep({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(pu(e.path),o,n);return function(){o.jf(),t.rc(s)}}var td,ed=(sd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},sd),nd=(od.prototype.data=function(t){var e=this;if(Ec("DocumentSnapshot.data",arguments,0,1),t=bd("DocumentSnapshot.data",t),this.bd){if(this.ca){var n=new rd(this.Rd,this.ua,this.bd,this.vd,this.Sd,null);return this.ca.fromFirestore(n,t)}return new Up(this.Rd.aa,this.Rd.Ad(),t.serverTimestamps||"none",function(t){return new Xp(t,e.Rd,null)}).zf(this.bd.Ze())}},od.prototype.get=function(t,e){var n=this;if(Ec("DocumentSnapshot.get",arguments,1,2),e=bd("DocumentSnapshot.get",e),this.bd){var r=this.bd.data().field(Ul("DocumentSnapshot.get",t,this.ua));if(null!==r)return new Up(this.Rd.aa,this.Rd.Ad(),e.serverTimestamps||"none",function(t){return new Xp(t,n.Rd,n.ca)}).zf(r)}},Object.defineProperty(od.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"ref",{get:function(){return new Xp(this.ua,this.Rd,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"exists",{get:function(){return null!==this.bd},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"metadata",{get:function(){return new ed(this.Sd,this.vd)},enumerable:!1,configurable:!0}),od.prototype.isEqual=function(t){if(!(t instanceof od))throw Lc("isEqual","DocumentSnapshot",1,t);return this.Rd===t.Rd&&this.vd===t.vd&&this.ua.isEqual(t.ua)&&(null===this.bd?null===t.bd:this.bd.isEqual(t.bd))&&this.ca===t.ca},od),rd=(n(id,td=nd),id.prototype.data=function(t){return td.prototype.data.call(this,t)},id);function id(){return null!==td&&td.apply(this,arguments)||this}function od(t,e,n,r,i,o){this.Rd=t,this.ua=e,this.bd=n,this.vd=r,this.Sd=i,this.ca=o}function sd(t,e){this.hasPendingWrites=t,this.fromCache=e}function ud(t,e,n){if("string"==typeof n){if(""===n)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ti.k(n));if(!ri.W(r))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new ri(r))}if(n instanceof bl)return Ao(t,n.ua);throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Pc(n)+".")}function ad(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function hd(t,e,n){if(!n.isEqual(e))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function cd(t){if(t.an()&&0===t.tn.length)throw new Yr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ld=(fd.prototype.where=function(t,e,n){bc("Query.where",arguments,3),Rc("Query.where",3,n);var r,i,o=kc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),s=Ul("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.O()){if("array-contains"===i||"array-contains-any"===i)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){ad(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(ud(n,t,c))}s={arrayValue:{values:u}}}else s=ud(n,t,o)}else"in"!==i&&"array-contains-any"!==i||ad(o,i),s=Ol(e,"Query.where",o,"in"===i);var l=_u.create(r,i,s);return function(t,e){if(e instanceof _u){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&hd(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}}(t,l),l}(this.Dd,this.firestore.fd,this.firestore.aa,s,o,n);return new fd((i=(r=this.Dd).filters.concat([u]),new cu(r.path,r.collectionGroup,r.tn.slice(),i,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},fd.prototype.orderBy=function(t,e){var n;if(Ec("Query.orderBy",arguments,1,2),Ac("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(Xr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Ul("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Hu(e,n),s=o;return null!==(r=t).un()||null!==(i=r.cn())&&hd(0,i,s.field),o}(this.Dd,o,n);return new fd((i=(r=this.Dd).tn.concat([s]),new cu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},fd.prototype.limit=function(t){return bc("Query.limit",arguments,1),Tc("Query.limit","number",1,t),Cc("Query.limit",1,t),new fd(gu(this.Dd,t,"F"),this.firestore,this.ca)},fd.prototype.limitToLast=function(t){return bc("Query.limitToLast",arguments,1),Tc("Query.limitToLast","number",1,t),Cc("Query.limitToLast",1,t),new fd(gu(this.Dd,t,"L"),this.firestore,this.ca)},fd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ic("Query.startAt",arguments,1);var r=this.Cd("Query.startAt",t,e,!0);return new fd(mu(this.Dd,r),this.firestore,this.ca)},fd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ic("Query.startAfter",arguments,1);var r=this.Cd("Query.startAfter",t,e,!1);return new fd(mu(this.Dd,r),this.firestore,this.ca)},fd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ic("Query.endBefore",arguments,1);var r=this.Cd("Query.endBefore",t,e,!0);return new fd(wu(this.Dd,r),this.firestore,this.ca)},fd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ic("Query.endAt",arguments,1);var r=this.Cd("Query.endAt",t,e,!1);return new fd(wu(this.Dd,r),this.firestore,this.ca)},fd.prototype.isEqual=function(t){if(!(t instanceof fd))throw Lc("isEqual","Query",1,t);return this.firestore===t.firestore&&bu(this.Dd,t.Dd)&&this.ca===t.ca},fd.prototype.withConverter=function(t){return new fd(this.Dd,this.firestore,t)},fd.prototype.Cd=function(c,t,e,n){if(Rc(c,1,t),t instanceof nd)return bc(c,d([t],e),1),function(t,e,n,r){if(!n)throw new Yr(Xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new Yr(Xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Uu(i,r)}(this.Dd,this.firestore.aa,t.bd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Yr(Xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!du(t)&&-1!==h.indexOf("/"))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ti.k(h));if(!ri.W(c))throw new Yr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new ri(c);u.push(Ao(e,l))}else{var f=Ol(n,r,h);u.push(f)}}return new Uu(u,o)}(this.Dd,this.firestore.aa,this.firestore.fd,c,r,n)},fd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ec("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Mp(i[a])||(Oc("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),_c("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Mp(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Tc("Query.onSnapshot","function",a,i[a]),Ac("Query.onSnapshot","function",a+1,i[a+1]),Ac("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new yd(r.firestore,r.Dd,t,r.ca))},error:i[a+1],complete:i[a+2]};return cd(this.Dd),pd(this.firestore.od(),this.Dd,u,h)},fd.prototype.get=function(t){var e=this;Ec("Query.get",arguments,0,1),Id("Query.get",t),cd(this.Dd);var n,r,i,o,s,u=this.firestore.od();return(t&&"cache"===t.source?u.Wf(this.Dd):(n=u,r=this.Dd,i=t,o=new la,s=pd(n,r,{includeMetadataChanges:!0,D_:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new yd(e.firestore,e.Dd,t,e.ca)})},fd);function fd(t,e,n){this.Dd=t,this.firestore=e,this.ca=n}function pd(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ep({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.jf(),t.rc(s)}}var dd,yd=(Object.defineProperty(md.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(md.prototype,"empty",{get:function(){return this.Nd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(md.prototype,"size",{get:function(){return this.Nd.docs.size},enumerable:!1,configurable:!0}),md.prototype.forEach=function(e,n){var r=this;Ec("QuerySnapshot.forEach",arguments,1,2),Tc("QuerySnapshot.forEach","function",1,e),this.Nd.docs.forEach(function(t){e.call(n,r.xd(t,r.metadata.fromCache,r.Nd.Lt.has(t.key)))})},Object.defineProperty(md.prototype,"query",{get:function(){return new ld(this.Fd,this.Rd,this.ca)},enumerable:!1,configurable:!0}),md.prototype.docChanges=function(t){t&&(Oc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),_c("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Nd.Bt)throw new Yr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kd&&this.$d===e||(this.kd=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Nd,e,this.xd.bind(this)),this.$d=e),this.kd},md.prototype.isEqual=function(t){if(!(t instanceof md))throw Lc("isEqual","QuerySnapshot",1,t);return this.Rd===t.Rd&&bu(this.Fd,t.Fd)&&this.Nd.isEqual(t.Nd)&&this.ca===t.ca},md.prototype.xd=function(t,e,n){return new rd(this.Rd,t.key,t,e,n,this.ca)},md),vd=(n(gd,dd=ld),Object.defineProperty(gd.prototype,"id",{get:function(){return this.Dd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"parent",{get:function(){var t=this.Dd.path.p();return t._()?null:new Xp(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"path",{get:function(){return this.Dd.path.N()},enumerable:!1,configurable:!0}),gd.prototype.doc=function(t){Ec("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Lr.t()),Tc("CollectionReference.doc","non-empty string",1,t);var e=ti.k(t);return Xp.md(this.Dd.path.child(e),this.firestore,this.ca)},gd.prototype.add=function(t){bc("CollectionReference.add",arguments,1),Tc("CollectionReference.add","object",1,this.ca?this.ca.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},gd.prototype.withConverter=function(t){return new gd(this.Md,this.firestore,t)},gd);function gd(t,e,n){var r=this;if(((r=dd.call(this,pu(t),e,n)||this).Md=t).length%2!=1)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function md(t,e,n,r){this.Rd=t,this.Fd=e,this.Nd=n,this.ca=r,this.kd=null,this.$d=null,this.metadata=new ed(n.hasPendingWrites,n.fromCache)}function wd(t,e){if(void 0===e)return{merge:!1};if(Oc(t,e,["merge","mergeFields"]),_c(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Pc(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof zc))throw new Yr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Pc(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function bd(t,e){return void 0===e?{}:(Oc(t,e,["serverTimestamps"]),Sc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Id(t,e){Ac(t,"object",1,e),e&&(Oc(t,e,["source"]),Sc(t,0,"source",e.source,["default","server","cache"]))}function Ed(t,e,n){if(e instanceof bl){if(e.firestore!==n)throw new Yr(Xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Lc(t,"DocumentReference",1,e)}function Td(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ad,Nd={Firestore:Fp,GeoPoint:cl,Timestamp:Zr,Blob:Bc,Transaction:Hp,WriteBatch:Qp,DocumentReference:Xp,DocumentSnapshot:nd,Query:ld,QueryDocumentSnapshot:rd,QuerySnapshot:yd,CollectionReference:vd,FieldPath:zc,FieldValue:al,setLogLevel:Fp.setLogLevel,CACHE_SIZE_UNLIMITED:jp};(Ad=_d).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new bp,i=new wp(r),new Fp(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Nd))),Ad.registerVersion("@firebase/firestore","1.16.3-20206291717")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});