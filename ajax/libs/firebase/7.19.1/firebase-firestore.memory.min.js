!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ef){"use strict";try{(function(){var t,u,e,n,i=(n=Ef)&&"object"==typeof n&&"default"in n?n:{default:n},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function h(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},l=u.INFO,f=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),p=(Object.defineProperty(v.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),v.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(v.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),v.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},v.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},v.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},v.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},v.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},v);function v(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,w="FirebaseError",b=(o(E,m=Error),E);function E(t,e){var n=m.call(this,e)||this;return n.code=t,n.name=w,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(A.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(T,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new b(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},A);function A(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var k,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=S||self;function O(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var V="closure_uid_"+(1e9*Math.random()>>>0),C=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function q(t,e,n){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,V)&&this[V]||(this[V]=++C))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var X,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var Z=_.navigator;if(Z){var J=Z.userAgent;if(J){X=J;break t}}X=""}function tt(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function rt(t){return rt[" "](t),t}rt[" "]=O;var ot,st,ut=Y(X,"Opera"),at=Y(X,"Trident")||Y(X,"MSIE"),ht=Y(X,"Edge"),ct=ht||at,lt=Y(X,"Gecko")&&!(Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge"))&&!(Y(X,"Trident")||Y(X,"MSIE"))&&!Y(X,"Edge"),ft=Y(X.toLowerCase(),"webkit")&&!Y(X,"Edge");function pt(){var t=_.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=X,lt?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):ft?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=Q(String(ot)).split("."),n=Q(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=_.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),It=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{rt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},F(Tt,At);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function St(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++kt,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=B(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Vt={};function Ct(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Bt(i),e&&e[Rt]?e.wa(n,i,P(r)?!!r.capture:!!r,o):Ut(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,i,r);return null}return n=Bt(n),t&&t[Rt]?t.va(e,n,P(i)?!!i.capture:!!i,r):Ut(t,e,n,!1,i,r)}function Ut(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=P(r)?!!r.capture:!!r;if(s&&!bt)return null;var u,a,h=Ft(t);if(h||(t[Pt]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)It||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Mt(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Rt]?Lt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ft(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):_t(t)))}function qt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function xt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Mt(t),n.call(i,e)}function jt(t,e){if(t.Y)return!0;if(bt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=_,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function Ft(t){return(t=t[Pt])instanceof Ot?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==L(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function Wt(){G.call(this),this.c=new Ot(this),(this.J=this).C=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Lt(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}F(Wt,G),Wt.prototype[Rt]=!0,(k=Wt.prototype).addEventListener=function(t,e,n,i){Ct(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=P(r)?!!r.capture:!!r,i=Bt(i),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Dt(s=e.a[n],i,r,o))&&(_t(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,i,r,o)),(i=-1<e?n[e]:null)&&Mt(i))}(this,t,e,n,i)},k.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new At(t,n):t instanceof At?t.target=t.target||n:(s=t,it(t=new At(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=zt(o,i,!0,t)&&s;if(s=zt(o=t.a=n,i,!0,t)&&s,s=zt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=zt(o=t.a=e[r],i,!1,t)&&s;return s},k.G=function(){if(Wt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)_t(n[i]);delete e.a[t],e.b--}}this.C=null},k.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},k.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var $t=_.JSON.stringify;function Ht(){this.b=this.a=null}var Xt,Qt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Kt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Zt(t,e){var n;Xt||(n=_.Promise.resolve(void 0),Xt=function(){n.then(ee)}),Jt||(Xt(),Jt=!0),te.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Ht;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){_.setTimeout(function(){throw t},0)}(t)}var i=Qt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Jt=!1}function ne(t,e){Wt.call(this),this.b=t||1,this.a=e||_,this.f=q(this.Ya,this),this.g=j()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==L(t))n&&(t=q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=q(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}F(ne,Wt),(k=ne.prototype).aa=!1,k.M=null,k.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},k.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},k.G=function(){ne.S.G.call(this),ie(this),delete this.a};var oe,se,ue,ae=(N(se=ce,ue=oe=G),se.prototype=null===ue?Object.create(ue):(he.prototype=ue.prototype,new he),ce.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ce.prototype.G=function(){oe.prototype.G.call(this),this.a&&(_.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ce);function he(){this.constructor=se}function ce(t,e,n){var i=oe.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function le(t){G.call(this),this.b=t,this.a={}}F(le,G);var fe=[];function pe(t,e,n,i){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var r=0;r<n.length;r++){var o=Ct(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ye(){this.a=!0}function ve(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return $t(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}le.prototype.G=function(){le.S.G.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var ge=null;function me(){return ge=ge||new Wt}function we(t){At.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){At.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Ae(t){At.call(this,"timingevent",t)}function Te(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}F(we,At),F(Ee,At),F(Ae,At);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Re={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function ke(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}ke.prototype.a=null;var Oe,Le={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function De(){At.call(this,"d")}function Pe(){At.call(this,"c")}function Ve(){}function Ce(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new le(this),this.P=Ue,t=ct?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(De,At),F(Pe,At),F(Ve,ke),Oe=new Ve;var Ue=45e3,Me={},qe={};function xe(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Ge(t),t.l=tn(t.i);var s,u,a,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),bn(n.b,"t",i),t.D=0,t.a=pi(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(q(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Fe(t,e,n){for(var i,r,o,s,u=!0;!t.A&&t.D<n.length;){var a=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?qe:(o=Number(r.substring(o,s)),isNaN(o)?Me:(s+=1)+o>r.length?qe:(r=r.substr(s,o),i.D=s+o,r)));if(a==qe){4==e&&(t.h=4,Ie(),u=!1),ve(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,Ie(),ve(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ve(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,Ie(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),oi(e),e.F=!0)):(ve(t.c,t.f,n,"[Invalid Chunked Response]"),$e(t),ze(t))}function Ge(t){t.U=j()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(q(t.Ua,t),e)}function We(t){t.o&&(_.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ai(t.g,t)}function $e(t){We(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,i,r,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||kn(p.b,t)))if(p.I=t.N,!t.C&&kn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ui(p),Yn(p)}ri(p),Ie()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(q(p.Ra,p),6e3));if(Rn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ci(p,11)}else if(!t.C&&p.a!=t||ui(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Y(u,"spdy")||Y(u,"quic")||Y(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Sn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,sn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fi(o,o.C?o.ga:null,o.fa),c.C?(_n(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(We(l),Ge(l)),o.a=c):ii(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||ci(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ci(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);be()}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)W(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ke(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Ke(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(k=Ce.prototype).setTimeout=function(t){this.P=t},k.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},k.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ct&&!this.a.$())){this.A||4!=e||7==n||be(),We(this);var i=this.a.X();this.N=i;var r=this.a.$();if(this.b=200==i,a=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=i,a.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ie(),$e(this),ze(this);break t}ve(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,u)}this.I?(Fe(this,e,r),ct&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ve(this.c,this.f,r,null),He(this,r)),4==e&&$e(this),this.b&&!this.A&&(4==e?ai(this.g,this):(this.b=!1,Ge(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),$e(this),ze(this)}}}catch(t){}var a,h,c,l,f,p,d},k.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(We(this),Fe(this,t,e),this.b&&4!=t&&Ge(this)))},k.cancel=function(){this.A=!0,$e(this)},k.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),$e(this),this.h=2,ze(this)):Be(this,this.U-n)},(k=Qe.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},k.L=function(){return Ye(this),this.a.concat()},k.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},k.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},k.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new vn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Ze))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new vn(null,this.a))}function tn(t){return new Je(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var i,r;e instanceof vn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(gn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},i)),i.f=r):(n||(e=hn(e,dn)),t.b=new vn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,yn)),t.join("")};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Qe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=En(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function wn(t,e){return gn(t),e=En(t,e),Ke(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),$(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function An(t){this.g=t||Tn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ia&&_.ia.ya&&_.ia.ya()&&_.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(k=vn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},k.forEach=function(n,i){gn(this),this.a.forEach(function(t,e){W(t,function(t){n.call(i,t,e,this)},this)},this)},k.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},k.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=z(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},k.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},k.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},k.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function Rn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Sn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return $(t.c);var i=t.c;try{for(var r=R(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Ln(){}function Dn(){this.a=new Ln}function Pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}An.prototype.cancel=function(){var t,e;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Vn=_.JSON.parse;function Cn(t){Wt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}F(Cn,Wt);var Un="",Mn=/^https?$/i,qn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),Bn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Ze)[1]||null)&&_.self&&_.self.location&&(r=(i=_.self.location.protocol).substr(0,i.length-1)),n=!Mn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<zn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Fn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Wn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function $n(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",tt(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new An(t&&t.concurrentRequestLimit),this.ka=new Dn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),ei(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.i.toString(),"")),!n&&_.Image&&((new Image).src=e.i,n=!0),n||(e.a=pi(e.g,null),e.a.ba(e.i)),e.u=j(),Ge(e)),li(t)}function Yn(t){t.a&&(oi(t),t.a.cancel(),t.a=null)}function Kn(t){Yn(t),t.j&&(_.clearTimeout(t.j),t.j=null),ui(t),t.b.cancel(),t.h&&("number"==typeof t.h&&_.clearTimeout(t.h),t.h=null)}function Zn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Nn(t.b)||t.h||(t.h=!0,Zt(t.Ba,t),t.u=0)}function ti(t,e){var n=e?e.f:t.R++,i=tn(t.B);sn(i,"SID",t.J),sn(i,"RID",n),sn(i,"AID",t.P),ei(t,i),t.i&&t.l&&$n(i,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ni(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Sn(t.b,n),xe(n,i,e)}function ei(t,n){t.f&&Xe({},function(t,e){sn(n,e,t)})}function ni(t,e,n){n=Math.min(t.g.length,n);var i=t.f?q(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i){var r="req"+h+"_"||"";try{Xe(t,function(t,e){var n=t;P(t)&&(n=$t(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ii(t){t.a||t.j||(t.U=1,Zt(t.Aa,t),t.o=0)}function ri(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(q(t.Aa,t),hi(t,t.o)),t.o++,1)}function oi(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function si(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),ei(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&$n(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,je(n,t)}function ui(t){null!=t.m&&(_.clearTimeout(t.m),t.m=null)}function ai(t,e){var n,i=null;if(t.a==e){ui(t),oi(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;i=e.s,_n(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)1==r?(i=e.j?e.j.length:0,e=j()-e.u,n=t.u,(r=me()).dispatchEvent(new Ae(r)),Jn(t)):ii(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Rn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(q(t.Ba,t,e),hi(t,t.u)),t.u++,1}}(t,e)||2==r&&ri(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ci(t,5);break;case 4:ci(t,10);break;case 3:ci(t,6);break;default:ci(t,2)}}function hi(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ci(t,e){var n,i,r,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=q(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||en(n,"https"),un(n)),r=n.toString(),o=i,u=new ye,_.Image?((s=new Image).onload=x(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=x(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=x(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(Pn,u,s,"TestLoadImage: timeout",!1,o),_.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),li(t),Kn(t)}function li(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,$(t.g),t.g.length=0),t.f.qa())}function fi(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Je?tn(i):new Je(i,void 0);return""!=c.c?(e&&nn(c,e+"."+c.c),rn(c,c.h)):(o=(r=_.location).protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Je(null,void 0),o&&en(h,o),s&&nn(h,s),u&&rn(h,u),a&&(h.g=a),c=h),t.W&&tt(t.W,function(t,e){sn(c,e,t)}),e=t.A,n=t.na,e&&n&&sn(c,e,n),sn(c,"VER",t.ha),ei(t,c),c}function pi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function di(){}function yi(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function vi(t,e){Wt.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wi(this)}function gi(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mi(){Pe.call(this),this.status=1}function wi(t){this.a=t}(k=Cn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(Oe),this.a.onreadystatechange=q(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var r,o=new Qe(this.headers);i&&Xe(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=xn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=_.FormData&&t instanceof _.FormData,0<=B(qn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=(r=this.a,at&&mt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=q(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},k.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},k.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},k.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},k.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},k.Ta=function(){Gn(this)},k.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},k.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},k.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Vn(e)}},k.ua=function(){return this.h},k.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(k=Xn.prototype).ha=8,k.v=1,k.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),i=this.l;if(this.O&&(i?it(i=et(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ni(this,n,e),sn(r=tn(this.B),"RID",t),sn(r,"CVER",22),this.A&&sn(r,"X-HTTP-Session-Id",this.A),ei(this,r),this.i&&i&&$n(r,this.i,i),Sn(this.b,n),this.Ga&&sn(r,"TYPE","init"),this.da?(sn(r,"$req",e),sn(r,"SID","null"),n.V=!0,xe(n,r,null)):xe(n,r,e),this.v=2}}else 3==this.v&&(t?ti(this,t):0==this.g.length||Nn(this.b)||ti(this))},k.Aa=function(){var t;this.j=null,si(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(q(this.Sa,this),t))},k.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),si(this))},k.Ra=function(){null!=this.m&&(this.m=null,Yn(this),ri(this),Ie())},k.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(k=di.prototype).ta=function(){},k.sa=function(){},k.ra=function(){},k.qa=function(){},k.Ha=function(){},yi.prototype.a=function(t,e){return new vi(t,e)},F(vi,Wt),(k=vi.prototype).addEventListener=function(t,e,n,i){vi.S.addEventListener.call(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){vi.S.removeEventListener.call(this,t,e,n,i)},k.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=fi(t,null,t.fa),Jn(t)},k.close=function(){Qn(this.a)},k.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Zn(this.a,e)):this.g?((e={}).__data__=$t(t),Zn(this.a,e)):Zn(this.a,t)},k.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,vi.S.G.call(this)},F(gi,De),F(mi,Pe),F(wi,di),wi.prototype.ta=function(){this.a.dispatchEvent("a")},wi.prototype.sa=function(t){this.a.dispatchEvent(new gi(t))},wi.prototype.ra=function(t){this.a.dispatchEvent(new mi)},wi.prototype.qa=function(){this.a.dispatchEvent("b")},yi.prototype.createWebChannel=yi.prototype.a,vi.prototype.send=vi.prototype.Pa,vi.prototype.open=vi.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Re.COMPLETE="complete",(_e.EventType=Le).OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",Wt.prototype.listen=Wt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var bi={createWebChannelTransport:function(){return new yi},ErrorCode:Ne,EventType:Re,WebChannel:_e,XhrIo:Cn},Ei=bi.createWebChannelTransport,Ii=bi.ErrorCode,Ai=bi.EventType,Ti=bi.WebChannel,Ni=bi.XhrIo,Ri=(ki.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},ki.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},ki.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ki);function ki(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Si=new p("@firebase/firestore");function _i(){return Si.logLevel}function Oi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Si.logLevel<=u.DEBUG&&(e=n.map(Pi),Si.debug.apply(Si,s(["Firestore (7.19.1): "+t],e)))}function Li(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Si.logLevel<=u.ERROR&&(e=n.map(Pi),Si.error.apply(Si,s(["Firestore (7.19.1): "+t],e)))}function Di(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Si.logLevel<=u.WARN&&(e=n.map(Pi),Si.warn.apply(Si,s(["Firestore (7.19.1): "+t],e)))}function Pi(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw Li(e),new Error(e)}function Ci(t){t||Vi()}var Ui=(Mi.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Mi);function Mi(){}function qi(t,e){return t<e?-1:e<t?1:0}function xi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function ji(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Fi=(Object.defineProperty(Gi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gi.prototype.isEqual=function(t){return t instanceof Gi&&t.projectId===this.projectId&&t.database===this.database},Gi.prototype.o=function(t){return qi(this.projectId,t.projectId)||qi(this.database,t.database)},Gi);function Gi(t,e){this.projectId=t,this.database=e||"(default)"}function Bi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $i,Hi,Xi,Qi=(fr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},fr.prototype.has=function(t){return void 0!==this.get(t)},fr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},fr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},fr.prototype.forEach=function(u){Wi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},fr.prototype._=function(){return zi(this.l)},fr),Yi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ki=(o(lr,Xi=Error),lr),Zi=(cr.now=function(){return cr.fromMillis(Date.now())},cr.fromDate=function(t){return cr.fromMillis(t.getTime())},cr.fromMillis=function(t){var e=Math.floor(t/1e3);return new cr(e,1e6*(t-1e3*e))},cr.prototype.toDate=function(){return new Date(this.toMillis())},cr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},cr.prototype.m=function(t){return this.seconds===t.seconds?qi(this.nanoseconds,t.nanoseconds):qi(this.seconds,t.seconds)},cr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},cr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},cr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},cr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},cr),Ji=(hr.T=function(t){return new hr(t)},hr.min=function(){return new hr(new Zi(0,0))},hr.prototype.o=function(t){return this.timestamp.m(t.timestamp)},hr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},hr.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},hr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},hr.prototype.R=function(){return this.timestamp},hr),tr=(Object.defineProperty(ar.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),ar.prototype.isEqual=function(t){return 0===ar.P(this,t)},ar.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ar?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ar.prototype.limit=function(){return this.offset+this.length},ar.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ar.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},ar.prototype.v=function(){return this.segments[this.offset]},ar.prototype.S=function(){return this.get(this.length-1)},ar.prototype.get=function(t){return this.segments[this.offset+t]},ar.prototype._=function(){return 0===this.length},ar.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ar.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ar.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ar.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ar.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ar),er=(o(ur,Hi=tr),ur.prototype.V=function(t,e,n){return new ur(t,e,n)},ur.prototype.N=function(){return this.F().join("/")},ur.prototype.toString=function(){return this.N()},ur.$=function(t){if(0<=t.indexOf("//"))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ur(t.split("/").filter(function(t){return 0<t.length}))},ur.k=function(){return new ur([])},ur),nr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ir=(o(sr,$i=tr),sr.prototype.V=function(t,e,n){return new sr(t,e,n)},sr.O=function(t){return nr.test(t)},sr.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.O(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.N()},sr.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},sr.M=function(){return new sr(["__name__"])},sr.q=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ki(Yi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ki(Yi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Ki(Yi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr.k=function(){return new sr([])},sr),rr=(or.U=function(t){return new or(er.$(t))},or.B=function(t){return new or(er.$(t).p(5))},or.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},or.prototype.isEqual=function(t){return null!==t&&0===er.P(this.path,t.path)},or.prototype.toString=function(){return this.path.toString()},or.P=function(t,e){return er.P(t.path,e.path)},or.j=function(t){return t.length%2==0},or.G=function(t){return new or(new er(t.slice()))},or);function or(t){this.path=t}function sr(){return null!==$i&&$i.apply(this,arguments)||this}function ur(){return null!==Hi&&Hi.apply(this,arguments)||this}function ar(t,e,n){void 0===e?e=0:e>t.length&&Vi(),void 0===n?n=t.length-e:n>t.length-e&&Vi(),this.segments=t,this.offset=e,this.A=n}function hr(t){this.timestamp=t}function cr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ki(Yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ki(Yi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ki(Yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ki(Yi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function lr(t,e){var n=this;return(n=Xi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function fr(t,e){this.h=t,this.u=e,this.l={}}function pr(t){return null==t}function dr(t){return-0===t&&1/t==-1/0}var yr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.K=null};function vr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new yr(t,e,n,i,r,o,s)}function gr(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),pr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Gu(n.startAt)),n.endAt&&(e+="|ub:",e+=Gu(n.endAt)),n.K=e),n.K}function mr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Wu(t.startAt,e.startAt)&&Wu(t.endAt,e.endAt)}function wr(t){return rr.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var br=(Er.fromBase64String=function(t){return new Er(atob(t))},Er.fromUint8Array=function(t){return new Er(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Er.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Er.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Er.prototype.Y=function(){return 2*this.H.length},Er.prototype.o=function(t){return qi(this.H,t.H)},Er.prototype.isEqual=function(t){return this.H===t.H},Er);function Er(t){this.H=t}function Ir(t){this.count=t}br.J=new br("");var Ar,Tr,Nr=(Rr.prototype.tt=function(t){return new Rr(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Rr.prototype.et=function(t,e){return new Rr(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Rr.prototype.nt=function(t){return new Rr(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Rr);function Rr(t,e,n,i,r,o,s){void 0===r&&(r=Ji.min()),void 0===o&&(o=Ji.min()),void 0===s&&(s=br.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.Z=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function kr(t){switch(t){case Yi.OK:return Vi(),0;case Yi.CANCELLED:case Yi.UNKNOWN:case Yi.DEADLINE_EXCEEDED:case Yi.RESOURCE_EXHAUSTED:case Yi.INTERNAL:case Yi.UNAVAILABLE:case Yi.UNAUTHENTICATED:return;case Yi.INVALID_ARGUMENT:case Yi.NOT_FOUND:case Yi.ALREADY_EXISTS:case Yi.PERMISSION_DENIED:case Yi.FAILED_PRECONDITION:case Yi.ABORTED:case Yi.OUT_OF_RANGE:case Yi.UNIMPLEMENTED:case Yi.DATA_LOSS:return 1;default:return Vi(),0}}function Sr(t){if(void 0===t)return Li("GRPC error has no .code"),Yi.UNKNOWN;switch(t){case Ar.OK:return Yi.OK;case Ar.CANCELLED:return Yi.CANCELLED;case Ar.UNKNOWN:return Yi.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return Yi.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return Yi.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return Yi.INTERNAL;case Ar.UNAVAILABLE:return Yi.UNAVAILABLE;case Ar.UNAUTHENTICATED:return Yi.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return Yi.INVALID_ARGUMENT;case Ar.NOT_FOUND:return Yi.NOT_FOUND;case Ar.ALREADY_EXISTS:return Yi.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return Yi.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return Yi.FAILED_PRECONDITION;case Ar.ABORTED:return Yi.ABORTED;case Ar.OUT_OF_RANGE:return Yi.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return Yi.UNIMPLEMENTED;case Ar.DATA_LOSS:return Yi.DATA_LOSS;default:return Vi()}}(Tr=Ar=Ar||{})[Tr.OK=0]="OK",Tr[Tr.CANCELLED=1]="CANCELLED",Tr[Tr.UNKNOWN=2]="UNKNOWN",Tr[Tr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tr[Tr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tr[Tr.NOT_FOUND=5]="NOT_FOUND",Tr[Tr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tr[Tr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tr[Tr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tr[Tr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tr[Tr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tr[Tr.ABORTED=10]="ABORTED",Tr[Tr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tr[Tr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tr[Tr.INTERNAL=13]="INTERNAL",Tr[Tr.UNAVAILABLE=14]="UNAVAILABLE",Tr[Tr.DATA_LOSS=15]="DATA_LOSS";var _r=(Vr.prototype.st=function(t,e){return new Vr(this.P,this.root.st(t,e,this.P).copy(null,null,Lr.it,null,null))},Vr.prototype.remove=function(t){return new Vr(this.P,this.root.remove(t,this.P).copy(null,null,Lr.it,null,null))},Vr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vr.prototype._=function(){return this.root._()},Object.defineProperty(Vr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vr.prototype.rt=function(){return this.root.rt()},Vr.prototype.ot=function(){return this.root.ot()},Vr.prototype.ht=function(t){return this.root.ht(t)},Vr.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Vr.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vr.prototype.at=function(t){return this.root.at(t)},Vr.prototype.ut=function(){return new Or(this.root,null,this.P,!1)},Vr.prototype.ct=function(t){return new Or(this.root,t,this.P,!1)},Vr.prototype.lt=function(){return new Or(this.root,null,this.P,!0)},Vr.prototype._t=function(t){return new Or(this.root,t,this.P,!0)},Vr),Or=(Pr.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Pr.prototype.Tt=function(){return 0<this.dt.length},Pr.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Pr),Lr=(Dr.prototype.copy=function(t,e,n,i,r){return new Dr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Dr.prototype._=function(){return!1},Dr.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Dr.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Dr.prototype.min=function(){return this.left._()?this:this.left.min()},Dr.prototype.rt=function(){return this.min().key},Dr.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Dr.prototype.st=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.st(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.st(t,e,n))).It()},Dr.prototype.Rt=function(){if(this.left._())return Dr.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.Rt(),null)).It()},Dr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.At()&&(i=i.Vt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.yt()),0===e(t,i.key)){if(i.right._())return Dr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Rt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.It()},Dr.prototype.At=function(){return this.color},Dr.prototype.It=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Vt()),t.left.At()&&t.right.At()&&(t=t.gt()),t},Dr.prototype.Pt=function(){var t=this.gt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).pt()).gt()),t},Dr.prototype.yt=function(){var t=this.gt();return t.left.left.At()&&(t=(t=t.Vt()).gt()),t},Dr.prototype.pt=function(){var t=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Dr.prototype.Vt=function(){var t=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Dr.prototype.gt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Dr.prototype.vt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Dr.prototype.bt=function(){if(this.At()&&this.left.At())throw Vi();if(this.right.At())throw Vi();var t=this.left.bt();if(t!==this.right.bt())throw Vi();return t+(this.At()?0:1)},Dr);function Dr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Dr.RED,this.left=null!=i?i:Dr.EMPTY,this.right=null!=r?r:Dr.EMPTY,this.size=this.left.size+1+this.right.size}function Pr(t,e,n,i){this.ft=i,this.dt=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.ft?t.left:t.right;else{if(0===r){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Vr(t,e){this.P=t,this.root=e||Lr.EMPTY}function Cr(){this.size=0}Lr.EMPTY=null,Lr.RED=!0,Lr.it=!1,Lr.EMPTY=(Object.defineProperty(Cr.prototype,"key",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"value",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"color",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"left",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(Cr.prototype,"right",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Cr.prototype.copy=function(t,e,n,i,r){return this},Cr.prototype.st=function(t,e,n){return new Lr(t,e)},Cr.prototype.remove=function(t,e){return this},Cr.prototype._=function(){return!0},Cr.prototype.ht=function(t){return!1},Cr.prototype.at=function(t){return!1},Cr.prototype.rt=function(){return null},Cr.prototype.ot=function(){return null},Cr.prototype.At=function(){return!1},Cr.prototype.vt=function(){return!0},Cr.prototype.bt=function(){return 0},new Cr);var Ur=(jr.prototype.has=function(t){return null!==this.data.get(t)},jr.prototype.first=function(){return this.data.rt()},jr.prototype.last=function(){return this.data.ot()},Object.defineProperty(jr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),jr.prototype.indexOf=function(t){return this.data.indexOf(t)},jr.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},jr.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var i=n.wt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},jr.prototype.Ct=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},jr.prototype.Dt=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},jr.prototype.ut=function(){return new Mr(this.data.ut())},jr.prototype.ct=function(t){return new Mr(this.data.ct(t))},jr.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},jr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},jr.prototype._=function(){return this.data._()},jr.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},jr.prototype.isEqual=function(t){if(!(t instanceof jr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(0!==this.P(i,r))return!1}return!0},jr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},jr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},jr.prototype.copy=function(t){var e=new jr(this.P);return e.data=t,e},jr),Mr=(xr.prototype.wt=function(){return this.Nt.wt().key},xr.prototype.Tt=function(){return this.Nt.Tt()},xr),qr=new _r(rr.P);function xr(t){this.Nt=t}function jr(t){this.P=t,this.data=new _r(this.P)}var Fr=new _r(rr.P),Gr=new _r(rr.P),Br=new Ur(rr.P);function Wr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Br,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var zr=new Ur(qi);function $r(t,e,n,i){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=i}function Hr(t,e){this.targetId=t,this.ne=e}function Xr(t,e,n,i){void 0===n&&(n=br.J),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Qr=(ao.Ot=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.$t.get(t)},ao.prototype.get=function(t){return this.$t.get(t)},ao.prototype.first=function(){return this.kt.rt()},ao.prototype.last=function(){return this.kt.ot()},ao.prototype._=function(){return this.kt._()},ao.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.kt.ht(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.st(t.key,t),e.kt.st(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.kt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.ut(),n=t.kt.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(!i.isEqual(r))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.$t=t,n.kt=e,n},ao),Yr=(uo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.st(e,t):3===t.type&&1!==n.type?this.xt=this.xt.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):Vi()},uo.prototype.Lt=function(){var n=[];return this.xt.ht(function(t,e){n.push(e)}),n},uo),Kr=(so.Wt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new so(t,e,Qr.Ot(e),r,n,i,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ut===t.Ut&&this.qt.isEqual(t.qt)&&lu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Mt.isEqual(t.Mt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},so),Zr=(oo.zt=function(t,e){var n=new Map;return n.set(t,Jr.Ht(t,e)),new oo(Ji.min(),n,zr,qr,Wr())},oo),Jr=(ro.Ht=function(t,e){return new ro(br.J,e,Wr(),Wr(),Wr())},ro),to=(Object.defineProperty(io.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),io.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},io.prototype.le=function(){var n=Wr(),i=Wr(),r=Wr();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Vi()}}),new Jr(this.re,this.oe,n,i,r)},io.prototype._e=function(){this.he=!1,this.ie=co()},io.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},io.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},io.prototype.we=function(){this.se+=1},io.prototype.me=function(){--this.se},io.prototype.Te=function(){this.he=!0,this.oe=!0},io),eo=(no.prototype.Ve=function(t){for(var e=0,n=t.te;e<n.length;e++){var i=n[e];t.ee instanceof Qs?this.ye(i,t.ee):t.ee instanceof Ys&&this.pe(i,t.key,t.ee)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.ee)}},no.prototype.ge=function(n){var i=this;this.ve(n,function(t){var e=i.be(t);switch(n.state){case 0:i.Se(t)&&e.ce(n.resumeToken);break;case 1:e.me(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.me(),e.ae||i.removeTarget(t);break;case 3:i.Se(t)&&(e.Te(),e.ce(n.resumeToken));break;case 4:i.Se(t)&&(i.Ce(t),e.ce(n.resumeToken));break;default:Vi()}})},no.prototype.ve=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){i.Se(e)&&n(e)})},no.prototype.De=function(t){var e,n,i=t.targetId,r=t.ne.count,o=this.Fe(i);o&&(wr(e=o.target)?0===r?(n=new rr(e.path),this.pe(i,n,new Ys(n,Ji.min()))):Ci(1===r):this.Ne(i)!==r&&(this.Ce(i),this.Pe=this.Pe.add(i)))},no.prototype.$e=function(r){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,i=o.Fe(e);i&&(t.Yt&&wr(i.target)&&(n=new rr(i.target.path),null!==o.Re.get(n)||o.ke(e,n)||o.pe(e,n,new Ys(n,r))),t.ue&&(s.set(e,t.le()),t._e()))});var i=Wr();this.Ae.forEach(function(t,e){var n=!0;e.Ct(function(t){var e=o.Fe(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Zr(r,s,this.Pe,this.Re,i);return this.Re=qr,this.Ae=ho(),this.Pe=new Ur(qi),t},no.prototype.ye=function(t,e){var n;this.Se(t)&&(n=this.ke(t,e.key)?2:0,this.be(t).fe(e.key,n),this.Re=this.Re.st(e.key,e),this.Ae=this.Ae.st(e.key,this.Oe(e.key).add(t)))},no.prototype.pe=function(t,e,n){var i;this.Se(t)&&(i=this.be(t),this.ke(t,e)?i.fe(e,1):i.de(e),this.Ae=this.Ae.st(e,this.Oe(e).delete(t)),n&&(this.Re=this.Re.st(e,n)))},no.prototype.removeTarget=function(t){this.Ie.delete(t)},no.prototype.Ne=function(t){var e=this.be(t).le();return this.Ee.xe(t).size+e.Jt.size-e.Zt.size},no.prototype.we=function(t){this.be(t).we()},no.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new to,this.Ie.set(t,e)),e},no.prototype.Oe=function(t){var e=this.Ae.get(t);return e||(e=new Ur(qi),this.Ae=this.Ae.st(t,e)),e},no.prototype.Se=function(t){var e=null!==this.Fe(t);return e||Oi("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Fe=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.Ee.Le(t)},no.prototype.Ce=function(e){var n=this;this.Ie.set(e,new to),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},no.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},no);function no(t){this.Ee=t,this.Ie=new Map,this.Re=qr,this.Ae=ho(),this.Pe=new Ur(qi)}function io(){this.se=0,this.ie=co(),this.re=br.J,this.oe=!1,this.he=!0}function ro(t,e,n,i,r){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=i,this.Zt=r}function oo(t,e,n,i,r){this.Z=t,this.Qt=e,this.jt=n,this.Gt=i,this.Kt=r}function so(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Mt=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Ut=s,this.Bt=u}function uo(){this.xt=new _r(rr.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||rr.P(t.key,e.key)}:function(t,e){return rr.P(t.key,e.key)},this.$t=Fr,this.kt=new _r(this.P)}function ho(){return new _r(rr.P)}function co(){return new _r(rr.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new Zi(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Vi()}function vo(i,r){var t,e,n,o=yo(i);if(o!==yo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return fo(i).isEqual(fo(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Eo(i.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,Ao(i.bytesValue).isEqual(Ao(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Io((t=i).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),i=Io(e.doubleValue);return n===i?dr(n)===dr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return xi(i.arrayValue.values||[],r.arrayValue.values||[],vo);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Bi(t)!==Bi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return Vi()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,i,r,o,s,u,a,h,c,l,f=yo(t),p=yo(e);if(f!==p)return qi(f,p);switch(f){case 0:return 0;case 1:return qi(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Io(t.integerValue||t.doubleValue))<(l=Io(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(fo(t),fo(e));case 5:return qi(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=qi(n[r],i[r]);if(0!==o)return o}return qi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=qi(Io(n.latitude),Io(i.latitude)))?r:qi(Io(n.longitude),Io(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=mo(n[r],i[r]);if(o)return o}return qi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=qi(i[s],o[s]);if(0!==u)return u;var a=mo(n[i[s]],r[o[s]]);if(0!==a)return a}return qi(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Vi()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return qi(t,e);var n=Eo(t),i=Eo(e),r=qi(n.seconds,i.seconds);return 0!==r?r:qi(n.nanos,i.nanos)}function bo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Eo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Ao(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,rr.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Vi();var t,e,n}(t)}function Eo(t){if(Ci(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e,n=0,i=po.exec(t);Ci(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?br.fromBase64String(t):br.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function No(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _o(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Do=function(t,e){this.s=t,this.Me=e};function Po(t){return{integerValue:""+t}}function Vo(t,e){if(t.Me){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dr(e)?"-0":e}}function Co(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!dr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Po(e):Vo(t,e);var n}function Uo(t,e){return t.Me?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Me?e.toBase64():e.toUint8Array()}function qo(t){return Ci(!!t),Ji.T((e=Eo(t),new Zi(e.seconds,e.nanos)));var e}function xo(t,e){return new er(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function jo(t,e){return xo(t.s,e.path)}function Fo(t,e){var n,i,r=(Ci(Xo(i=er.$(e))),i);return Ci(r.get(1)===t.s.projectId),Ci(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new rr((Ci(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Go(t,e){return xo(t.s,e)}function Bo(t){return new er(["projects",t.s.projectId,"databases",t.s.database]).N()}function Wo(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function zo(t,e){var n,i,r,o;if(e instanceof Rs)n={update:Wo(t,e.key,e.value)};else if(e instanceof Ms)n={delete:jo(t,e.key)};else if(e instanceof ks)n={update:Wo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Ds)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Jo)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof ts)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof os)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof hs)return{fieldPath:t.field.N(),increment:e.Ue};throw Vi()})}};else{if(!(e instanceof qs))return Vi();n={verify:jo(t,e.key)}}return e.We.Be||(n.currentDocument=void 0!==(o=e.We).updateTime?{updateTime:Uo(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Vi()),n}function $o(t){return{before:t.before,values:t.position}}function Ho(t){return{fieldPath:t.N()}}function Xo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Qo(){this.Qe=void 0}function Yo(t,e){return t instanceof hs?No(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Ko,Zo,Jo=(o(ns,Zo=Qo),ns),ts=(o(es,Ko=Qo),es);function es(t){var e=this;return(e=Ko.call(this)||this).elements=t,e}function ns(){return null!==Zo&&Zo.apply(this,arguments)||this}function is(t,e){for(var n=fs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var rs,os=(o(ss,rs=Qo),ss);function ss(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function us(t,e){for(var n=fs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(r[i]);return{arrayValue:{values:n}}}var as,hs=(o(cs,as=Qo),cs);function cs(t,e){var n=this;return(n=as.call(this)||this).serializer=t,n.Ue=e,n}function ls(t){return Io(t.integerValue||t.doubleValue)}function fs(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ps(t,e){this.field=t,this.transform=e}var ds=(ys.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ys.prototype.isEqual=function(t){return xi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ys);function ys(t){(this.fields=t).sort(ir.P)}function vs(t,e){this.version=t,this.transformResults=e}var gs=(ms.Ge=function(){return new ms},ms.exists=function(t){return new ms(void 0,t)},ms.updateTime=function(t){return new ms(t)},Object.defineProperty(ms.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ms.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ms);function ms(t,e){this.updateTime=t,this.exists=e}function ws(t,e){return void 0!==t.updateTime?e instanceof Qs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Qs}function bs(){}function Es(t,e,n,i){return t instanceof Rs?function(t,e){if(!ws(t.We,e))return e;var n=As(e);return new Qs(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof ks?function(t,e){if(!ws(t.We,e))return e;var n=As(e),i=Os(t,e);return new Qs(t.key,n,i,{Ke:!0})}(t,e):t instanceof Ds?function(t,e,n,i){if(!ws(t.We,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Qs&&(y=n.field(p.field)),null===y&&i instanceof Qs&&(y=i.field(p.field)),c.push((o=y,h=a=u=s=void 0,(r=d)instanceof Jo?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):r instanceof ts?is(r,o):r instanceof os?us(r,o):(a=ls(u=Yo(s=r,o))+ls(s.Ue),No(u)&&No(s.Ue)?Po(a):Vo(s.serializer,a))))}return c}(t.fieldTransforms,n,e,i),s=Vs(t,r.data(),o);return new Qs(t.key,r.version,s,{Ke:!0})}(t,e,i,n):(o=e,ws((r=t).We,o)?new Ys(r.key,Ji.min()):o);var r,o}function Is(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.We.isEqual(e.We)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||xi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof ts&&o instanceof ts||r instanceof os&&o instanceof os?xi(r.elements,o.elements,vo):r instanceof hs&&o instanceof hs?vo(r.Ue,o.Ue):r instanceof Jo&&o instanceof Jo);var n,i,r,o}))}function As(t){return t instanceof Qs?t.version:Ji.min()}var Ts,Ns,Rs=(o(_s,Ns=bs),_s),ks=(o(Ss,Ts=bs),Ss);function Ss(t,e,n,i){var r=this;return(r=Ts.call(this)||this).key=t,r.data=e,r.qe=n,r.We=i,r.type=1,r}function _s(t,e,n){var i=this;return(i=Ns.call(this)||this).key=t,i.value=e,i.We=n,i.type=0,i}function Os(t,e){return n=t,i=e instanceof Qs?e.data():xs.empty(),r=new js(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Ls,Ds=(o(Ps,Ls=bs),Ps);function Ps(t,e){var n=this;return(n=Ls.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.We=gs.exists(!0),n}function Vs(t,e,n){for(var i=new js(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Cs,Us,Ms=(o(Ws,Us=bs),Ws),qs=(o(Bs,Cs=bs),Bs),xs=(Gs.empty=function(){return new Gs({mapValue:{}})},Gs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!_o(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Gs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Gs),js=(Fs.prototype.set=function(t,e){return this.Je(t,e),this},Fs.prototype.delete=function(t){return this.Je(t,null),this},Fs.prototype.Je=function(t,e){for(var n=this.Ye,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},Fs.prototype.ze=function(){var t=this.Xe(ir.k(),this.Ye);return null!=t?new xs(t):this.He},Fs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.He.field(i),s=_o(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Fs);function Fs(t){void 0===t&&(t=xs.empty()),this.He=t,this.Ye=new Map}function Gs(t){this.proto=t}function Bs(t,e){var n=this;return(n=Cs.call(this)||this).key=t,n.We=e,n.type=4,n}function Ws(t,e){var n=this;return(n=Us.call(this)||this).key=t,n.We=e,n.type=3,n}function zs(t,e){this.key=t,this.version=e}var $s,Hs,Xs,Qs=(o(tu,Xs=zs),tu.prototype.field=function(t){return this.Ze.field(t)},tu.prototype.data=function(){return this.Ze},tu.prototype.tn=function(){return this.Ze.proto},tu.prototype.isEqual=function(t){return t instanceof tu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},tu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),tu),Ys=(o(Js,Hs=zs),Js.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js.prototype.isEqual=function(t){return t instanceof Js&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Js),Ks=(o(Zs,$s=zs),Zs.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zs.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Zs.prototype.isEqual=function(t){return t instanceof Zs&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zs);function Zs(){return null!==$s&&$s.apply(this,arguments)||this}function Js(t,e,n){var i=this;return(i=Hs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function tu(t,e,n,i){var r=this;return(r=Xs.call(this,t,e)||this).Ze=n,r.Ke=!!i.Ke,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function eu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Ki(Yi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Ki(Yi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var nu=(iu.prototype.on=function(t){return new iu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},iu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.L())},iu.prototype.an=function(){return!pr(this.limit)&&"F"===this.nn},iu.prototype.un=function(){return!pr(this.limit)&&"L"===this.nn},iu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},iu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},iu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},iu);function iu(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=i,this.limit=r,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function ru(t){return new nu(t)}function ou(t){return null!==t.collectionGroup}function su(t){var e=eu(t,nu);if(null===e.sn){e.sn=[];var n=e.ln(),i=e.cn();if(null!==n&&null===i)n.L()||e.sn.push(new zu(n)),e.sn.push(new zu(ir.M(),"asc"));else{for(var r,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.L()&&(o=!0)}o||(r=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new zu(ir.M(),r)))}}return e.sn}function uu(t){var e=eu(t,nu);if(!e.rn)if("F"===e.nn)e.rn=vr(e.path,e.collectionGroup,su(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=su(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new zu(o.field,s))}var u=e.endAt?new Mu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Mu(e.startAt.position,!e.startAt.before):null;e.rn=vr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function au(t,e,n){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hu(t,e){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function cu(t,e){return new nu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function lu(t,e){return mr(uu(t),uu(e))&&t.nn===e.nn}function fu(t){return gr(uu(t))+"|lt:"+t.nn}function pu(t){return"Query(target="+(n=(e=uu(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),pr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Gu(e.startAt)),e.endAt&&(n+=", endAt: "+Gu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function du(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.W(i.collectionGroup)&&i.path.C(o):rr.j(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.en;e<n.length;e++){var i=n[e];if(!i.field.L()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Bu(e.startAt,su(e),n))&&(!e.endAt||!Bu(e.endAt,su(e),n)));var e,n,i,o}function yu(u){return function(t,e){for(var n=!1,i=0,r=su(u);i<r.length;i++){var o=r[i],s=function(t,e,n){var i,r,o,s,u=t.field.L()?rr.P(e.key,n.key):(i=t.field,r=n,o=e.field(i),s=r.field(i),null!==o&&null!==s?mo(o,s):Vi());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Vi()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var vu,gu=(o(mu,vu=function(){}),mu.create=function(t,e,n){if(t.L())return"in"===e||"not-in"===e?this.dn(t,e,n):new Iu(t,e,n);if(ko(n)){if("=="!==e&&"!="!==e)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new mu(t,e,n)}if(So(n)){if("=="!==e&&"!="!==e)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new mu(t,e,n)}return"array-contains"===e?new Pu(t,n):"in"===e?new Vu(t,n):"not-in"===e?new Cu(t,n):"array-contains-any"===e?new Uu(t,n):new mu(t,e,n)},mu.dn=function(t,e,n){return new("in"===e?Au:Tu)(t,n)},mu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(mo(e,this.value)):null!==e&&yo(this.value)===yo(e)&&this.wn(mo(e,this.value))},mu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vi()}},mu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},mu);function mu(t,e,n){var i=this;return(i=vu.call(this)||this).field=t,i.op=e,i.value=n,i}var wu,bu,Eu,Iu=(o(ku,Eu=gu),ku.prototype.matches=function(t){var e=rr.P(t.key,this.key);return this.wn(e)},ku),Au=(o(Ru,bu=gu),Ru.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ru),Tu=(o(Nu,wu=gu),Nu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Nu);function Nu(t,e){var n=this;return(n=wu.call(this,t,"not-in",e)||this).keys=Su(0,e),n}function Ru(t,e){var n=this;return(n=bu.call(this,t,"in",e)||this).keys=Su(0,e),n}function ku(t,e,n){var i=this;return(i=Eu.call(this,t,e,n)||this).key=rr.B(n.referenceValue),i}function Su(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return rr.B(t.referenceValue)})}var _u,Ou,Lu,Du,Pu=(o(Fu,Du=gu),Fu.prototype.matches=function(t){var e=t.field(this.field);return Ro(e)&&go(e.arrayValue,this.value)},Fu),Vu=(o(ju,Lu=gu),ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},ju),Cu=(o(xu,Ou=gu),xu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!go(this.value.arrayValue,e)},xu),Uu=(o(qu,_u=gu),qu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ro(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},qu),Mu=function(t,e){this.position=t,this.before=e};function qu(t,e){return _u.call(this,t,"array-contains-any",e)||this}function xu(t,e){return Ou.call(this,t,"not-in",e)||this}function ju(t,e){return Lu.call(this,t,"in",e)||this}function Fu(t,e){return Du.call(this,t,"array-contains",e)||this}function Gu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Bu(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.L()?rr.P(rr.B(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Wu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var zu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},$u=(ia.prototype.Tn=function(t,e,n){for(var i,r,o,s=n.En,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(i=a,r=e,o=s[u],e=i instanceof Rs?new Qs(i.key,o.version,i.value,{hasCommittedMutations:!0}):i instanceof ks?function(t,e,n){if(!ws(t.We,e))return new Ks(t.key,n.version);var i=Os(t,e);return new Qs(t.key,n.version,i,{hasCommittedMutations:!0})}(i,r,o):i instanceof Ds?function(t,e,n){if(Ci(null!=n.transformResults),!ws(t.We,e))return new Ks(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Ci(t.length===n.length);for(var r,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Qs&&(c=e.field(a.field)),i.push((r=h,o=c,s=n[u],r instanceof ts?is(r,o):r instanceof os?us(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Vs(t,i.data(),r);return new Qs(t.key,o,s,{hasCommittedMutations:!0})}(i,r,o):new Ys(i.key,o.version,{hasCommittedMutations:!0}))}return e},ia.prototype.In=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=Es(r,e,e,this.mn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Es(a,e,o,this.mn))}return e},ia.prototype.Rn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.In(t.key,n.get(t.key));e&&(r=r.st(t.key,e))}),r},ia.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wr())},ia.prototype.isEqual=function(t){return this.batchId===t.batchId&&xi(this.mutations,t.mutations,Is)&&xi(this.baseMutations,t.baseMutations,Is)},ia),Hu=(na.from=function(t,e,n){Ci(t.mutations.length===n.length);for(var i=Gr,r=t.mutations,o=0;o<r.length;o++)i=i.st(r[o].key,n[o].version);return new na(t,e,n,i)},na),Xu=(ea.prototype.catch=function(t){return this.next(void 0,t)},ea.prototype.next=function(i,r){var o=this;return this.gn&&Vi(),this.gn=!0,this.pn?this.error?this.vn(r,this.error):this.bn(i,this.result):new ea(function(e,n){o.Vn=function(t){o.bn(i,t).next(e,n)},o.yn=function(t){o.vn(r,t).next(e,n)}})},ea.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ea.prototype.Cn=function(t){try{var e=t();return e instanceof ea?e:ea.resolve(e)}catch(t){return ea.reject(t)}},ea.prototype.bn=function(t,e){return t?this.Cn(function(){return t(e)}):ea.resolve(e)},ea.prototype.vn=function(t,e){return t?this.Cn(function(){return t(e)}):ea.reject(e)},ea.resolve=function(n){return new ea(function(t,e){t(n)})},ea.reject=function(n){return new ea(function(t,e){e(n)})},ea.Dn=function(t){return new ea(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},ea.Fn=function(t){for(var n=ea.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?ea.resolve(t):e()})}(i[e]);return n},ea.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Dn(r)},ea),Qu=(ta.prototype.On=function(e,n){var i=this;return this.$n.xn(e,n).next(function(t){return i.Ln(e,n,t)})},ta.prototype.Ln=function(t,i,r){return this.Nn.Mn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].In(i,t);return t})},ta.prototype.qn=function(t,e,r){var o=qr;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].In(t,e);o=o.st(t,e)}),o},ta.prototype.Un=function(e,t){var n=this;return this.Nn.getEntries(e,t).next(function(t){return n.Bn(e,t)})},ta.prototype.Bn=function(i,r){var o=this;return this.$n.Wn(i,r).next(function(t){var e=o.qn(i,r,t),n=qr;return e.forEach(function(t,e){e=e||new Ys(t,Ji.min()),n=n.st(t,e)}),n})},ta.prototype.Qn=function(t,e,n){return i=e,rr.j(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.jn(t,e.path):ou(e)?this.Gn(t,e,n):this.Kn(t,e,n);var i},ta.prototype.jn=function(t,e){return this.On(t,new rr(e)).next(function(t){var e=Fr;return t instanceof Qs&&(e=e.st(t.key,t)),e})},ta.prototype.Gn=function(n,i,r){var o=this,s=i.collectionGroup,u=Fr;return this.kn.zn(n,s).next(function(t){return Xu.forEach(t,function(t){var e=i.on(t.child(s));return o.Kn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ta.prototype.Kn=function(e,n,t){var c,l,i=this;return this.Nn.Qn(e,n,t).next(function(t){return c=t,i.$n.Hn(e,n)}).next(function(t){return l=t,i.Yn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=Es(s,a,a,i.mn);c=h instanceof Qs?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){du(n,e)||(c=c.remove(t))}),c})},ta.prototype.Yn=function(t,e,n){for(var i=Wr(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Nn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Qs&&(h=h.st(t,e))}),h})},ta),Yu=(Ju.Zn=function(t,e){for(var n=Wr(),i=Wr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Ju(t,e.fromCache,n,i)},Ju),Ku=(Zu.prototype.es=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Zu.prototype.next=function(){var t=++this.previousValue;return this.ns&&this.ns(t),t},Zu);function Zu(t,e){var n=this;this.previousValue=t,e&&(e.ts=function(t){return n.es(t)},this.ns=function(t){return e.ss(t)})}function Ju(t,e,n,i){this.targetId=t,this.fromCache=e,this.Jn=n,this.Xn=i}function ta(t,e,n){this.Nn=t,this.$n=e,this.kn=n}function ea(t){var e=this;this.Vn=null,this.yn=null,this.result=void 0,this.error=void 0,this.pn=!1,this.gn=!1,t(function(t){e.pn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.pn=!0,e.error=t,e.yn&&e.yn(t)})}function na(t,e,n,i){this.batch=t,this.An=e,this.En=n,this.Pn=i}function ia(t,e,n,i){this.batchId=t,this.mn=e,this.baseMutations=n,this.mutations=i}function ra(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Ku.rs=-1;var oa=(sa.prototype.reset=function(){this.ls=0},sa.prototype.ds=function(){this.ls=this.cs},sa.prototype.ws=function(t){var e=this;this.cancel();var n=Math.floor(this.ls+this.ms()),i=Math.max(0,Date.now()-this.fs),r=Math.max(0,n-i);0<r&&Oi("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.ls+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this._s=this.os.Ts(this.hs,r,function(){return e.fs=Date.now(),t()}),this.ls*=this.us,this.ls<this.as&&(this.ls=this.as),this.ls>this.cs&&(this.ls=this.cs)},sa.prototype.Es=function(){null!==this._s&&(this._s.Is(),this._s=null)},sa.prototype.cancel=function(){null!==this._s&&(this._s.cancel(),this._s=null)},sa.prototype.ms=function(){return(Math.random()-.5)*this.ls},sa);function sa(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.os=t,this.hs=e,this.as=n,this.us=i,this.cs=r,this.ls=0,this._s=null,this.fs=Date.now(),this.reset()}function ua(t){return"IndexedDbTransactionError"===t.name}function aa(){return"undefined"!=typeof document?document:null}var ha=(fa.ys=function(t,e,n,i,r){var o=new fa(t,e,Date.now()+n,i,r);return o.start(n),o},fa.prototype.start=function(t){var e=this;this.ps=setTimeout(function(){return e.gs()},t)},fa.prototype.Is=function(){return this.gs()},fa.prototype.cancel=function(t){null!==this.ps&&(this.clearTimeout(),this.Vs.reject(new Ki(Yi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},fa.prototype.gs=function(){var e=this;this.Rs.vs(function(){return null!==e.ps?(e.clearTimeout(),e.op().then(function(t){return e.Vs.resolve(t)})):Promise.resolve()})},fa.prototype.clearTimeout=function(){null!==this.ps&&(this.Ps(this),clearTimeout(this.ps),this.ps=null)},fa),ca=(Object.defineProperty(la.prototype,"xs",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),la.prototype.vs=function(t){this.enqueue(t)},la.prototype.Ls=function(t){this.Ms(),this.qs(t)},la.prototype.Us=function(){var t;this.Cs||(this.Cs=!0,(t=aa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Os))},la.prototype.enqueue=function(t){return this.Ms(),this.Cs?new Promise(function(t){}):this.qs(t)},la.prototype.Bs=function(t){var e=this;this.Ss.push(t),this.vs(function(){return e.Ws()})},la.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Ss.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ss[0]()];case 2:return t.sent(),this.Ss.shift(),this.ks.reset(),[3,4];case 3:if(!ua(e=t.sent()))throw e;return Oi("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ss.length&&this.ks.ws(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},la.prototype.qs=function(t){var i=this,e=this.bs.then(function(){return i.Ns=!0,t().catch(function(t){throw i.Fs=t,i.Ns=!1,Li("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Ns=!1,t})});return this.bs=e},la.prototype.Ts=function(t,e,n){var i=this;this.Ms(),-1<this.$s.indexOf(t)&&(e=0);var r=ha.ys(this,t,e,n,function(t){return i.Qs(t)});return this.Ds.push(r),r},la.prototype.Ms=function(){this.Fs&&Vi()},la.prototype.js=function(){},la.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.bs];case 1:t.sent(),t.label=2;case 2:if(e!==this.bs)return[3,0];t.label=3;case 3:return[2]}})})},la.prototype.Ks=function(t){for(var e=0,n=this.Ds;e<n.length;e++)if(n[e].hs===t)return!0;return!1},la.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Ds.sort(function(t,e){return t.As-e.As});for(var t=0,e=r.Ds;t<e.length;t++){var n=e[t];if(n.Is(),"all"!==i&&n.hs===i)break}return r.Gs()})},la.prototype.Hs=function(t){this.$s.push(t)},la.prototype.Qs=function(t){var e=this.Ds.indexOf(t);this.Ds.splice(e,1)},la);function la(){var e=this;this.bs=Promise.resolve(),this.Ss=[],this.Cs=!1,this.Ds=[],this.Fs=null,this.Ns=!1,this.$s=[],this.ks=new oa(this,"async_queue_retry"),this.Os=function(){var t=aa();t&&Oi("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ks.Es()};var t=aa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Os)}function fa(t,e,n,i,r){this.Rs=t,this.hs=e,this.As=n,this.op=i,this.Ps=r,this.Vs=new ra,this.then=this.Vs.promise.then.bind(this.Vs.promise),this.Vs.promise.catch(function(t){})}function pa(t,e){if(Li("AsyncQueue",e+": "+t),ua(t))return new Ki(Yi.UNAVAILABLE,e+": "+t);throw t}var da=(ya.Zs=function(t){return new ya(t,ya.ti,ya.ei)},ya);function ya(t,e,n){this.Ys=t,this.Js=e,this.Xs=n}da.ni=-1,da.si=1048576,da.ii=41943040,da.ti=10,da.ei=1e3,da.ri=new da(da.ii,da.ti,da.ei),da.oi=new da(da.ni,0,0);var va=(Aa.prototype.ai=function(t,e){return this.hi.add(e),Xu.resolve()},Aa.prototype.zn=function(t,e){return Xu.resolve(this.hi.getEntries(e))},Aa),ga=(Ia.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Ur(er.P),r=!i.has(n);return this.index[e]=i.add(n),r},Ia.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Ia.prototype.getEntries=function(t){return(this.index[t]||new Ur(er.P)).F()},Ia),ma=(Ea.prototype.next=function(){return this.ui+=2,this.ui},Ea.ci=function(){return new Ea(0)},Ea.li=function(){return new Ea(-1)},Ea),wa=(ba.prototype.yi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pi(t,n.fi)})},ba);function ba(t,e,n){this.persistence=t,this._i=e,this.fi=new _r(qi),this.di=new Qi(gr,mr),this.wi=Ji.min(),this.$n=t.mi(n),this.Ti=t.Ei(),this.Ii=t.Ri(),this.Ai=new Qu(this.Ti,this.$n,this.persistence.Pi()),this._i.Vi(this.Ai)}function Ea(t){this.ui=t}function Ia(){this.index={}}function Aa(){this.hi=new ga}function Ta(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Di(t)})}function Na(o,s,u){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:n=(e=o).fi.get(s),i=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",i,function(t){return e.persistence.Li.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ua(r=t.sent()))throw r;return Oi("LocalStore","Failed to update sequence numbers for target "+s+": "+r),[3,5];case 5:return e.fi=e.fi.remove(s),e.di.delete(n.target),[2]}})})}function Ra(t,s,u){var a=t,h=Ji.min(),c=Wr();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,i=uu(s),(void 0!==(o=(r=t).di.get(i))?Xu.resolve(r.fi.get(o)):r.Ii.Ui(n,i)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Ii.Bi(e,t.targetId).next(function(t){c=t})}).next(function(){return a._i.Qn(e,s,u?h:Ji.min(),u?c:Wr())}).next(function(t){return{documents:t,Wi:c}});var t,n,i,r,o})}function ka(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Yi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Oi("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Sa=(Pa.prototype._=function(){return this.Qi._()},Pa.prototype.zi=function(t,e){var n=new _a(t,e);this.Qi=this.Qi.add(n),this.Gi=this.Gi.add(n)},Pa.prototype.Hi=function(t,e){var n=this;t.forEach(function(t){return n.zi(t,e)})},Pa.prototype.Yi=function(t,e){this.Ji(new _a(t,e))},Pa.prototype.Xi=function(t,e){var n=this;t.forEach(function(t){return n.Yi(t,e)})},Pa.prototype.Zi=function(t){var e=this,n=new rr(new er([])),i=new _a(n,t),r=new _a(n,t+1),o=[];return this.Gi.St([i,r],function(t){e.Ji(t),o.push(t.key)}),o},Pa.prototype.tr=function(){var e=this;this.Qi.forEach(function(t){return e.Ji(t)})},Pa.prototype.Ji=function(t){this.Qi=this.Qi.delete(t),this.Gi=this.Gi.delete(t)},Pa.prototype.er=function(t){var e=new rr(new er([])),n=new _a(e,t),i=new _a(e,t+1),r=Wr();return this.Gi.St([n,i],function(t){r=r.add(t.key)}),r},Pa.prototype.nr=function(t){var e=new _a(t,0),n=this.Qi.Dt(e);return null!==n&&t.isEqual(n.key)},Pa),_a=(Da.ji=function(t,e){return rr.P(t.key,e.key)||qi(t.sr,e.sr)},Da.Ki=function(t,e){return qi(t.sr,e.sr)||rr.P(t.key,e.key)},Da),Oa=(La.prototype.ir=function(){return null!=this.uid},La.prototype.rr=function(){return this.ir()?"uid:"+this.uid:"anonymous-user"},La.prototype.isEqual=function(t){return t.uid===this.uid},La);function La(t){this.uid=t}function Da(t,e){this.key=t,this.sr=e}function Pa(){this.Qi=new Ur(_a.ji),this.Gi=new Ur(_a.Ki)}function Va(t,e){this.user=e,this.type="OAuth",this.ar={},this.ar.Authorization="Bearer "+t}function Ca(t){this.key=t}function Ua(t){this.key=t}function Ma(t,e,n){this.query=t,this.targetId=e,this.view=n}function qa(t){this.key=t,this.Lh=!1}function xa(){this.va=void 0,this.listeners=[]}Oa.UNAUTHENTICATED=new Oa(null),Oa.or=new Oa("google-credentials-uid"),Oa.hr=new Oa("first-party-uid");var ja,Fa,Ga,Ba,Wa=(kh.prototype.getToken=function(){return Promise.resolve(null)},kh.prototype.cr=function(){},kh.prototype.lr=function(t){(this.ur=t)(Oa.UNAUTHENTICATED)},kh.prototype._r=function(){this.ur=null},kh),za=(Rh.prototype.getToken=function(){var e=this,n=this.mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.mr!==n?(Oi("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ci("string"==typeof t.accessToken),new Va(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Rh.prototype.cr=function(){this.forceRefresh=!0},Rh.prototype.lr=function(t){this.ur=t,this.wr&&t(this.currentUser)},Rh.prototype._r=function(){this.auth&&this.auth.removeAuthTokenListener(this.dr),this.dr=null,this.ur=null},Rh.prototype.Tr=function(){var t=this.auth&&this.auth.getUid();return Ci(null===t||"string"==typeof t),new Oa(t)},Rh),$a=(Object.defineProperty(Nh.prototype,"ar",{get:function(){var t={"X-Goog-AuthUser":this.Ir},e=this.Er.auth.Rr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Nh),Ha=(Th.prototype.getToken=function(){return Promise.resolve(new $a(this.Er,this.Ir))},Th.prototype.lr=function(t){t(Oa.hr)},Th.prototype._r=function(){},Th.prototype.cr=function(){},Th),Xa=(Ah.prototype.gr=function(){return 1===this.state||2===this.state||4===this.state},Ah.prototype.vr=function(){return 2===this.state},Ah.prototype.start=function(){3!==this.state?this.auth():this.br()},Ah.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ah.prototype.Sr=function(){this.state=0,this.ks.reset()},Ah.prototype.Cr=function(){var t=this;this.vr()&&null===this.pr&&(this.pr=this.os.Ts(this.Ar,6e4,function(){return t.Dr()}))},Ah.prototype.Fr=function(t){this.Nr(),this.stream.send(t)},Ah.prototype.Dr=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.vr()?[2,this.close(0)]:[2]})})},Ah.prototype.Nr=function(){this.pr&&(this.pr.cancel(),this.pr=null)},Ah.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Nr(),this.ks.cancel(),this.yr++,3!==e?this.ks.reset():n&&n.code===Yi.RESOURCE_EXHAUSTED?(Li(n.toString()),Li("Using maximum backoff delay to prevent overloading the backend."),this.ks.ds()):n&&n.code===Yi.UNAUTHENTICATED&&this.Vr.cr(),null!==this.stream&&(this.$r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.kr(n)];case 1:return t.sent(),[2]}})})},Ah.prototype.$r=function(){},Ah.prototype.auth=function(){var n=this;this.state=1;var t=this.Or(this.yr),e=this.yr;this.Vr.getToken().then(function(t){n.yr===e&&n.xr(t)},function(e){t(function(){var t=new Ki(Yi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Lr(t)})})},Ah.prototype.xr=function(t){var e=this,n=this.Or(this.yr);this.stream=this.Mr(t),this.stream.qr(function(){n(function(){return e.state=2,e.listener.qr()})}),this.stream.kr(function(t){n(function(){return e.Lr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ah.prototype.br=function(){var t=this;this.state=4,this.ks.ws(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Ah.prototype.Lr=function(t){return Oi("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ah.prototype.Or=function(e){var n=this;return function(t){n.os.vs(function(){return n.yr===e?t():(Oi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ah),Qa=(o(Ih,Ga=Xa),Ih.prototype.Mr=function(t){return this.Pr.Ur("Listen",t)},Ih.prototype.onMessage=function(t){this.ks.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Vi(),u=e.targetChange.targetIds||[],a=(r=e.targetChange.resumeToken,t.Me?(Ci(void 0===r||"string"==typeof r),br.fromBase64String(r||"")):(Ci(void 0===r||r instanceof Uint8Array),br.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=new Xr(s,u,a,h&&(i=void 0===(n=h).code?Yi.UNKNOWN:Sr(n.code),new Ki(i,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=Fo(t,l.document.name),p=qo(l.document.updateTime),d=new xs({mapValue:{fields:l.document.fields}}),y=new Qs(f,p,d,{}),c=new $r(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Fo(t,v.document),m=v.readTime?qo(v.readTime):Ji.min(),w=new Ys(g,m);c=new $r([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Fo(t,b.document);c=new $r([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Vi();e.filter;var I=e.filter;I.targetId;var A=new Ir(I.count||0);c=new Hr(I.targetId,A)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ji.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ji.min():qo(e.readTime)}(t);return this.listener.Br(e,n)},Ih.prototype.Wr=function(t){var e,n,i,r,o={};o.database=Bo(this.serializer),o.addTarget=(e=this.serializer,(i=wr(r=(n=t).target)?{documents:{documents:[Go(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Go(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Go(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Ho((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Me||pr(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.Y()&&(i.resumeToken=Mo(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vi()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Fr(o)},Ih.prototype.Qr=function(t){var e={};e.database=Bo(this.serializer),e.removeTarget=t,this.Fr(e)},Ih),Ya=(o(Eh,Fa=Xa),Object.defineProperty(Eh.prototype,"Gr",{get:function(){return this.jr},enumerable:!1,configurable:!0}),Eh.prototype.start=function(){this.jr=!1,this.lastStreamToken=void 0,Fa.prototype.start.call(this)},Eh.prototype.$r=function(){this.jr&&this.Kr([])},Eh.prototype.Mr=function(t){return this.Pr.Ur("Write",t)},Eh.prototype.onMessage=function(t){if(Ci(!!t.streamToken),this.lastStreamToken=t.streamToken,this.jr){this.ks.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Ci(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?qo(t.updateTime):qo(e);n.isEqual(Ji.min())&&(n=qo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new vs(n,i)}(t,r)})):[]),n=qo(t.commitTime);return this.listener.zr(n,e)}var i,r;return Ci(!t.writeResults||0===t.writeResults.length),this.jr=!0,this.listener.Hr()},Eh.prototype.Yr=function(){var t={};t.database=Bo(this.serializer),this.Fr(t)},Eh.prototype.Kr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return zo(e.serializer,t)})};this.Fr(n)},Eh),Ka=(o(bh,ja=function(){}),bh.prototype.Xr=function(){if(this.Jr)throw new Ki(Yi.FAILED_PRECONDITION,"The client has already been terminated.")},bh.prototype.Zr=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.Zr(e,n,i,t)}).catch(function(t){throw t.code===Yi.UNAUTHENTICATED&&r.credentials.cr(),t})},bh.prototype.to=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.to(e,n,i,t)}).catch(function(t){throw t.code===Yi.UNAUTHENTICATED&&r.credentials.cr(),t})},bh.prototype.terminate=function(){this.Jr=!1},bh),Za=(wh.prototype.ro=function(){var t=this;0===this.no&&(this.oo("Unknown"),this.so=this.Rs.Ts("online_state_timeout",1e4,function(){return t.so=null,t.ho("Backend didn't respond within 10 seconds."),t.oo("Offline"),Promise.resolve()}))},wh.prototype.ao=function(t){"Online"===this.state?this.oo("Unknown"):(this.no++,1<=this.no&&(this.uo(),this.ho("Connection failed 1 times. Most recent error: "+t.toString()),this.oo("Offline")))},wh.prototype.set=function(t){this.uo(),this.no=0,"Online"===t&&(this.io=!1),this.oo(t)},wh.prototype.oo=function(t){t!==this.state&&(this.state=t,this.eo(t))},wh.prototype.ho=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.io?(Li(e),this.io=!1):Oi("OnlineStateTracker",e)},wh.prototype.uo=function(){null!==this.so&&(this.so.cancel(),this.so=null)},wh),Ja=(mh.prototype.start=function(){return this.enableNetwork()},mh.prototype.enableNetwork=function(){return this.wo.delete(0),this.Co()},mh.prototype.Co=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(this.Do()?this.Fo():this.Ro.set("Unknown"),[4,this.No()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},mh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(0),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),[2]}})})},mh.prototype.$o=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.po.stop()];case 1:return t.sent(),[4,this.Ao.stop()];case 2:return t.sent(),0<this._o.length&&(Oi("RemoteStore","Stopping write stream with "+this._o.length+" pending writes"),this._o=[]),this.ko(),[2]}})})},mh.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Oi("RemoteStore","RemoteStore shutting down."),this.wo.add(5),[4,this.$o()];case 1:return t.sent(),this.mo.Oo(),this.Ro.set("Unknown"),[2]}})})},mh.prototype.listen=function(t){this.fo.has(t.targetId)||(this.fo.set(t.targetId,t),this.Do()?this.Fo():this.Ao.vr()&&this.xo(t))},mh.prototype.Lo=function(t){this.fo.delete(t),this.Ao.vr()&&this.Mo(t),0===this.fo.size&&(this.Ao.vr()?this.Ao.Cr():this.Eo()&&this.Ro.set("Unknown"))},mh.prototype.Le=function(t){return this.fo.get(t)||null},mh.prototype.xe=function(t){return this.qo.xe(t)},mh.prototype.xo=function(t){this.do.we(t.targetId),this.Ao.Wr(t)},mh.prototype.Mo=function(t){this.do.we(t),this.Ao.Qr(t)},mh.prototype.Fo=function(){this.do=new eo(this),this.Ao.start(),this.Ro.ro()},mh.prototype.Do=function(){return this.Eo()&&!this.Ao.gr()&&0<this.fo.size},mh.prototype.Eo=function(){return 0===this.wo.size},mh.prototype.ko=function(){this.do=null},mh.prototype.Po=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fo.forEach(function(t,e){n.xo(t)}),[2]})})},mh.prototype.Vo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ko(),this.Do()?(this.Ro.ao(e),this.Fo()):this.Ro.set("Unknown"),[2]})})},mh.prototype.yo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.Ro.set("Online"),!(r instanceof Xr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Uo(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Oi("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Bo(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof $r?this.do.Ve(r):r instanceof Hr?this.do.De(r):this.do.ge(r),o.isEqual(Ji.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ta(this.co)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Wo(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Oi("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Bo(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},mh.prototype.Bo=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ua(n))throw n;return this.wo.add(1),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),i=i||function(){return Ta(e.co)},this.Rs.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Oi("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.wo.delete(1),[4,this.Co()];case 2:return t.sent(),[2]}})})}),[2]}})})},mh.prototype.Qo=function(e){var n=this;return e().catch(function(t){return n.Bo(t,e)})},mh.prototype.Wo=function(i){var r=this,t=this.do.$e(i);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=r.fo.get(e))&&r.fo.set(e,n.et(t.resumeToken,i))}),t.jt.forEach(function(t){var e,n=r.fo.get(t);n&&(r.fo.set(t,n.et(br.J,n.Z)),r.Mo(t),e=new Nr(n.target,t,1,n.sequenceNumber),r.xo(e))}),this.qo.jo(t)},mh.prototype.Uo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.fo.has(r)?[4,this.qo.Go(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.fo.delete(r),this.do.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},mh.prototype.No=function(){return d(this,void 0,void 0,function(){var r,o,s;return y(this,function(t){switch(t.label){case 0:r=0<this._o.length?this._o[this._o.length-1].batchId:-1,t.label=1;case 1:if(!this.Ko())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.co,n=r,(i=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),i.$n.qi(t,n)}))];case 3:return null===(o=t.sent())?(0===this._o.length&&this.po.Cr(),[3,7]):(r=o.batchId,this.zo(o),[3,6]);case 4:return s=t.sent(),[4,this.Bo(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ho()&&this.Yo(),[2]}var e,n,i})})},mh.prototype.Ko=function(){return this.Eo()&&this._o.length<10},mh.prototype.Jo=function(){return this._o.length},mh.prototype.zo=function(t){this._o.push(t),this.po.vr()&&this.po.Gr&&this.po.Kr(t.mutations)},mh.prototype.Ho=function(){return this.Eo()&&!this.po.gr()&&0<this._o.length},mh.prototype.Yo=function(){this.po.start()},mh.prototype.vo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.po.Yr(),[2]})})},mh.prototype.So=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this._o;e<n.length;e++)i=n[e],this.po.Kr(i.mutations);return[2]})})},mh.prototype.zr=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this._o.shift(),n=Hu.from(e,r,o),[4,this.Qo(function(){return i.qo.Xo(n)})];case 1:return t.sent(),[4,this.No()];case 2:return t.sent(),[2]}})})},mh.prototype.bo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.po.Gr?[4,this.Zo(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ho()&&this.Yo(),[2]}})})},mh.prototype.Zo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return kr(n=r.code)&&n!==Yi.ABORTED?(e=this._o.shift(),this.po.Sr(),[4,this.Qo(function(){return i.qo.th(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.No()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},mh.prototype.Io=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(4),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),this.po.Sr(),this.Ao.Sr(),this.wo.delete(4),[4,this.Co()];case 2:return t.sent(),[2]}})})},mh.prototype.eh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rs.js(),Oi("RemoteStore","RemoteStore received new credentials"),this.wo.add(3),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),[4,this.qo.eh(e)];case 2:return t.sent(),this.wo.delete(3),[4,this.Co()];case 3:return t.sent(),[2]}})})},mh.prototype.nh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.wo.delete(2),[4,this.Co()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.wo.add(2),[4,this.$o()]);case 3:t.sent(),this.Ro.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},mh),th=(gh.prototype.sh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},gh.prototype.ih=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},gh.prototype.rh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},gh),eh=(vh.prototype.ah=function(t){},vh.prototype.uh=function(t,e,n){},vh.prototype.lh=function(t){return this.oh.sh(t),this.hh[t]||"not-current"},vh.prototype._h=function(t,e,n){this.hh[t]=e},vh.prototype.fh=function(t){this.oh.ih(t)},vh.prototype.dh=function(t){return this.oh.activeTargetIds.has(t)},vh.prototype.wh=function(t){delete this.hh[t]},vh.prototype.mh=function(){return this.oh.activeTargetIds},vh.prototype.Th=function(t){return this.oh.activeTargetIds.has(t)},vh.prototype.start=function(){return this.oh=new th,Promise.resolve()},vh.prototype.Eh=function(t,e,n){},vh.prototype.Ih=function(t){},vh.prototype.Oo=function(){},vh.prototype.ss=function(t){},vh),nh=(Object.defineProperty(yh.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),yh.prototype.gh=function(t,e){var u=this,a=e?e.vh:new Yr,h=e?e.yh:this.yh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.un()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),i=(i=e instanceof Qs?e:null)&&(du(u.query,i)?i:null),r=!!n&&u.qt.has(n.key),o=!!i&&(i.Ke||u.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.bh(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.Vh(i,p)||d&&u.Vh(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.an()||this.query.un())for(;l.size>this.query.limit;){var n=this.query.an()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{yh:l,vh:a,Sh:f,qt:c}},yh.prototype.bh=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},yh.prototype.Ch=function(t,e,n){var o=this,i=this.yh;this.yh=t.yh,this.qt=t.qt;var r=t.vh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.Vh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vi()}}var i,r}),this.Dh(n);var s=e?this.Fh():[],u=0===this.Ph.size&&this.Yt?1:0,a=u!==this.Ah;return this.Ah=u,0!==r.length||a?{snapshot:new Kr(this.query,t.yh,i,r,t.qt,0==u,a,!1),Nh:s}:{Nh:s}},yh.prototype.$h=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Ch({yh:this.yh,vh:new Yr,qt:this.qt,Sh:!1},!1)):{Nh:[]}},yh.prototype.kh=function(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).Ke},yh.prototype.Dh=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.Rh=e.Rh.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.Rh=e.Rh.delete(t)}),this.Yt=t.Yt)},yh.prototype.Fh=function(){var e=this;if(!this.Yt)return[];var n=this.Ph;this.Ph=Wr(),this.yh.forEach(function(t){e.kh(t.key)&&(e.Ph=e.Ph.add(t.key))});var i=[];return n.forEach(function(t){e.Ph.has(t)||i.push(new Ua(t))}),this.Ph.forEach(function(t){n.has(t)||i.push(new Ca(t))}),i},yh.prototype.Oh=function(t){this.Rh=t.Wi,this.Ph=Wr();var e=this.gh(t.documents);return this.Ch(e,!0)},yh.prototype.xh=function(){return Kr.Wt(this.query,this.yh,this.qt,0===this.Ah)},yh),ih=(Object.defineProperty(dh.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),dh.prototype.subscribe=function(t){this.Bh=t},dh.prototype.listen=function(h){return d(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return this.ta("listen()"),(s=this.Wh.get(h))?(n=s.targetId,this.qh.lh(n),o=s.view.xh(),[3,4]):[3,1];case 1:return[4,(e=this.co,i=uu(h),(r=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.Ui(e,i).next(function(t){return t?(n=t,Xu.resolve(n)):r.Ii.ea(e).next(function(t){return n=new Nr(i,t,0,e.$i),r.Ii.na(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(r.fi=r.fi.st(t.targetId,t),r.di.set(i,t.targetId)),t}))];case 2:return u=t.sent(),a=this.qh.lh(u.targetId),n=u.targetId,[4,this.sa(h,n,"current"===a)];case 3:o=t.sent(),this.Zh&&this.Mh.listen(u),t.label=4;case 4:return[2,o]}var e,i,r})})},dh.prototype.sa=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,Ra(this.co,u,!0)];case 1:return e=t.sent(),n=new nh(u,e.Wi),i=n.gh(e.documents),r=Jr.Ht(a,h&&"Offline"!==this.onlineState),o=n.Ch(i,this.Zh,r),this.ia(a,o.Nh),s=new Ma(u,a,n),[2,(this.Wh.set(u,s),this.Qh.has(a)?this.Qh.get(a).push(u):this.Qh.set(a,[u]),o.snapshot)]}})})},dh.prototype.Lo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ta("unlisten()"),e=this.Wh.get(r),1<(n=this.Qh.get(e.targetId)).length?[2,(this.Qh.set(e.targetId,n.filter(function(t){return!lu(t,r)})),void this.Wh.delete(r))]:this.Zh?(this.qh.fh(e.targetId),this.qh.Th(e.targetId)?[3,2]:[4,Na(this.co,e.targetId,!1).then(function(){i.qh.wh(e.targetId),i.Mh.Lo(e.targetId),i.ra(e.targetId)}).catch(ka)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ra(e.targetId),[4,Na(this.co,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},dh.prototype.write=function(s,u){return d(this,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:this.ta("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.co,h=s,l=e,f=Zi.now(),n=h.reduce(function(t,e){return t.add(e.key)},Wr()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ai.Un(a,n).next(function(t){c=t;for(var u,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(u=o,e=c.get(o.key),u instanceof Ds?function(t){for(var e=null,n=0,i=u.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Qs?t.field(r.field):void 0,s=Yo(r.transform,o||null);null!=s&&(e=null==e?(new js).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new ks(o.key,s,function u(t){var a=[];return Wi(t.fields||{},function(t,e){var n=new ir([t]);if(_o(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new ds(a)}(s.proto.mapValue),gs.exists(!0)))}return l.$n.oa(a,f,n,h)})}).then(function(t){var e=t.Rn(c);return{batchId:t.batchId,ha:e}}))];case 2:return i=t.sent(),this.qh.ah(i.batchId),this.aa(i.batchId,u),[4,this.ua(i.ha)];case 3:return t.sent(),[4,this.Mh.No()];case 4:return t.sent(),[3,6];case 5:return r=t.sent(),o=pa(r,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,l,f,n})})},dh.prototype.jo=function(r){return d(this,void 0,void 0,function(){var n,i=this;return y(this,function(t){switch(t.label){case 0:this.ta("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=e,l=(s=r).Z,f=c.fi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var r=c.Ti.gi({vi:!0});f=c.fi;var h=[];s.Qt.forEach(function(t,e){var n,i,r,o,s,u=f.get(e);u&&(h.push(c.Ii.Fi(a,t.Zt,e).next(function(){return c.Ii.Ni(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(i=u.et(n,l).tt(a.$i),f=f.st(e,i),r=u,s=t,Ci(0<(o=i).resumeToken.Y()),(0===r.resumeToken.Y()||3e8<=o.Z.I()-r.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.Ii.ki(a,i))))});var t,o=qr,n=Wr();return s.Gt.forEach(function(t,e){n=n.add(t)}),h.push(r.getEntries(a,n).next(function(i){s.Gt.forEach(function(t,e){var n=i.get(t);e instanceof Ys&&e.version.isEqual(Ji.min())?(r.Oi(t,l),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.bi(e,l),o=o.st(t,e)):Oi("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Kt.has(t)&&h.push(c.persistence.Li.xi(a,t))})})),l.isEqual(Ji.min())||(t=c.Ii.Di(a).next(function(t){return c.Ii.Mi(a,a.$i,l)}),h.push(t)),Xu.Dn(h).next(function(){return r.apply(a)}).next(function(){return c.Ai.Bn(a,o)})}).then(function(t){return c.fi=f,t}))];case 2:return n=t.sent(),r.Qt.forEach(function(t,e){var n=i.Kh.get(e);n&&(Ci(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.Lh=!0:0<t.Xt.size?Ci(n.Lh):0<t.Zt.size&&(Ci(n.Lh),n.Lh=!1))}),[4,this.ua(n,r)];case 3:return t.sent(),[3,6];case 4:return[4,ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,l,f})})},dh.prototype.$h=function(i,t){var r;(this.Zh&&0===t||!this.Zh&&1===t)&&(this.ta("applyOnlineStateChange()"),r=[],this.Wh.forEach(function(t,e){var n=e.view.$h(i);n.snapshot&&r.push(n.snapshot)}),this.Bh.ca(i),this.Bh.Br(r),this.onlineState=i,this.Zh&&this.qh.Ih(i))},dh.prototype.Go=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ta("rejectListens()"),this.qh._h(u,"rejected",a),e=this.Kh.get(u),(n=e&&e.key)?(i=(i=new _r(rr.P)).st(n,new Ys(n,Ji.min())),r=Wr().add(n),o=new Zr(Ji.min(),new Map,new Ur(qi),i,r),[4,this.jo(o)]):[3,2];case 1:return t.sent(),this.Gh=this.Gh.remove(n),this.Kh.delete(u),this.la(),[3,4];case 2:return[4,Na(this.co,u,!1).then(function(){return s.ra(u,a)}).catch(ka)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},dh.prototype.Xo=function(r){return d(this,void 0,void 0,function(){var n,i;return y(this,function(t){switch(t.label){case 0:this.ta("applySuccessfulWrite()"),n=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=r,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ti.gi({vi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Xu.resolve();return a.forEach(function(i){h=h.next(function(){return s.Mn(o,i)}).next(function(t){var e=t,n=r.Pn.get(i);Ci(null!==n),(!e||e.version.o(n)<0)&&(e=u.Tn(i,e,r))&&s.bi(e,r.An)})}),h.next(function(){return i.$n.Si(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.$n.Ci(t)}).next(function(){return l.Ai.Un(t,e)})}))];case 2:return i=t.sent(),this._a(n,null),this.fa(n),this.qh.uh(n,"acknowledged"),[4,this.ua(i)];case 3:return t.sent(),[3,6];case 4:return[4,ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})},dh.prototype.th=function(o,s){return d(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:this.ta("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,i=o,(r=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.$n.da(e,i).next(function(t){return Ci(null!==t),n=t.keys(),r.$n.Si(e,t)}).next(function(){return r.$n.Ci(e)}).next(function(){return r.Ai.Un(e,n)})}))];case 2:return n=t.sent(),this._a(o,s),this.fa(o),this.qh.uh(o,"rejected",s),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,ka(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,i,r})})},dh.prototype.wa=function(u){return d(this,void 0,void 0,function(){var i,r,o,s;return y(this,function(t){switch(t.label){case 0:this.Mh.Eo()||Oi("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.co,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.$n.ma(t)}))];case 2:return-1===(i=t.sent())?[2,void u.resolve()]:((r=this.Yh.get(i)||[]).push(u),this.Yh.set(i,r),[3,4]);case 3:return o=t.sent(),s=pa(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},dh.prototype.fa=function(t){(this.Yh.get(t)||[]).forEach(function(t){t.resolve()}),this.Yh.delete(t)},dh.prototype.Ta=function(e){this.Yh.forEach(function(t){t.forEach(function(t){t.reject(new Ki(Yi.CANCELLED,e))})}),this.Yh.clear()},dh.prototype.aa=function(t,e){var n=(n=(n=this.Hh[this.currentUser.rr()])||new _r(qi)).st(t,e);this.Hh[this.currentUser.rr()]=n},dh.prototype._a=function(t,e){var n,i=this.Hh[this.currentUser.rr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Hh[this.currentUser.rr()]=i)},dh.prototype.ra=function(t,e){var n=this;void 0===e&&(e=null),this.qh.fh(t);for(var i=0,r=this.Qh.get(t);i<r.length;i++){var o=r[i];this.Wh.delete(o),e&&this.Bh.Ea(o,e)}this.Qh.delete(t),this.Zh&&this.zh.Zi(t).forEach(function(t){n.zh.nr(t)||n.Ia(t)})},dh.prototype.Ia=function(t){var e=this.Gh.get(t);null!==e&&(this.Mh.Lo(e),this.Gh=this.Gh.remove(t),this.Kh.delete(e),this.la())},dh.prototype.ia=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Ca?(this.zh.zi(r.key,t),this.Ra(r)):r instanceof Ua?(Oi("SyncEngine","Document no longer in limbo: "+r.key),this.zh.Yi(r.key,t),this.zh.nr(r.key)||this.Ia(r.key)):Vi()}},dh.prototype.Ra=function(t){var e=t.key;this.Gh.get(e)||(Oi("SyncEngine","New document in limbo: "+e),this.jh.push(e),this.la())},dh.prototype.la=function(){for(;0<this.jh.length&&this.Gh.size<this.Uh;){var t=this.jh.shift(),e=this.Jh.next();this.Kh.set(e,new qa(t)),this.Gh=this.Gh.st(t,e),this.Mh.listen(new Nr(uu(ru(t.path)),e,2,Ku.rs))}},dh.prototype.Aa=function(){return this.Gh},dh.prototype.Pa=function(){return this.jh},dh.prototype.ua=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wh.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.gh(i);return n.Sh?Ra(u.co,r.query,!1).then(function(t){var e=t.documents;return r.view.gh(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(r.targetId),i=r.view.Ch(t,u.Zh,n);u.ia(r.targetId,i.Nh),i.snapshot&&(u.Zh&&u.qh._h(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Yu.Zn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bh.Br(o),[4,function(c,l){return d(this,void 0,void 0,function(){var i,e,n,r,o,s,u,a,h;return y(this,function(t){switch(t.label){case 0:i=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Xu.forEach(l,function(e){return Xu.forEach(e.Jn,function(t){return i.persistence.Li.zi(n,e.targetId,t)}).next(function(){return Xu.forEach(e.Xn,function(t){return i.persistence.Li.Yi(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ua(e=t.sent()))throw e;return Oi("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,r=l;n<r.length;n++)o=r[n],s=o.targetId,o.fromCache||(u=i.fi.get(s),a=u.Z,h=u.nt(a),i.fi=i.fi.st(s,h));return[2]}})})}(this.co,s)];case 2:return t.sent(),[2]}})})},dh.prototype.ta=function(t){},dh.prototype.eh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Oi("SyncEngine","User change. New user:",n.rr()),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,m,i;return y(this,function(t){switch(t.label){case 0:return n=(e=r).$n,m=e.Ai,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.$n.Va(v).next(function(t){return g=t,n=e.persistence.mi(o),m=new Qu(e.Ti,n,e.persistence.Pi()),n.Va(v)}).next(function(t){for(var e=[],n=[],i=Wr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Un(v,i).next(function(t){return{ya:t,pa:e,ga:n}})})})];case 1:return i=t.sent(),[2,(e.$n=n,e.Ai=m,e._i.Vi(e.Ai),i)]}})})}(this.co,n)]);case 1:return e=t.sent(),this.currentUser=n,this.Ta("'waitForPendingWrites' promise is rejected due to a user change."),this.qh.Eh(n,e.pa,e.ga),[4,this.ua(e.ya)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},dh.prototype.xe=function(t){var e=this.Kh.get(t);if(e&&e.Lh)return Wr().add(e.key);var n=Wr(),i=this.Qh.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Wh.get(s),n=n.Ft(u.view.ph);return n},dh),rh=(ph.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.ba.get(e))||(n=!0,i=new xa),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.qo.listen(e)];case 2:return r.va=t.sent(),[3,4];case 3:return o=t.sent(),s=pa(o,"Initialization of query '"+pu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.ba.set(e,i),i.listeners.push(u),u.$h(this.onlineState),i.va&&u.Ca(i.va)&&this.Da(),[2]}})})},ph.prototype.Lo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.ba.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.ba.delete(e),this.qo.Lo(e))]:[2]})})},ph.prototype.Br=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.ba.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ca(r)&&(e=!0);s.va=r}}e&&this.Da()},ph.prototype.Ea=function(t,e){var n=this.ba.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.ba.delete(t)},ph.prototype.ca=function(r){this.onlineState=r;var o=!1;this.ba.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].$h(r)&&(o=!0)}),o&&this.Da()},ph.prototype.Fa=function(t){this.Sa.add(t),t.next()},ph.prototype.Na=function(t){this.Sa.delete(t)},ph.prototype.Da=function(){this.Sa.forEach(function(t){t.next()})},ph),oh=(fh.prototype.Ca=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Kr(t.query,t.docs,t.Mt,e,t.qt,t.fromCache,t.Ut,!0)}var o=!1;return this.ka?this.xa(t)&&(this.$a.next(t),o=!0):this.La(t,this.onlineState)&&(this.Ma(t),o=!0),this.Oa=t,o},fh.prototype.onError=function(t){this.$a.error(t)},fh.prototype.$h=function(t){this.onlineState=t;var e=!1;return this.Oa&&!this.ka&&this.La(this.Oa,t)&&(this.Ma(this.Oa),e=!0),e},fh.prototype.La=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qa&&n||t.docs._()&&"Offline"!==e)},fh.prototype.xa=function(t){if(0<t.docChanges.length)return!0;var e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ut&&!e)&&!0===this.options.includeMetadataChanges},fh.prototype.Ma=function(t){t=Kr.Wt(t.query,t.docs,t.qt,t.fromCache),this.ka=!0,this.$a.next(t)},fh),sh=(lh.prototype.Vi=function(t){this.Ua=t},lh.prototype.Qn=function(e,i,r,o){var s=this;return i.hn()||r.isEqual(Ji.min())?this.Ba(e,i):this.Ua.Un(e,o).next(function(t){var n=s.Wa(i,t);return(i.an()||i.un())&&s.Sh(i.nn,n,o,r)?s.Ba(e,i):(_i()<=u.DEBUG&&Oi("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pu(i)),s.Ua.Qn(e,i,r).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},lh.prototype.Wa=function(n,t){var i=new Ur(yu(n));return t.forEach(function(t,e){e instanceof Qs&&du(n,e)&&(i=i.add(e))}),i},lh.prototype.Sh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},lh.prototype.Ba=function(t,e){return _i()<=u.DEBUG&&Oi("IndexFreeQueryEngine","Using full collection scan to execute query:",pu(e)),this.Ua.Qn(t,e,Ji.min())},lh),uh=(ch.prototype.Ga=function(t){return Xu.resolve(0===this.$n.length)},ch.prototype.oa=function(t,e,n,i){var r=this.Qa;this.Qa++,0<this.$n.length&&this.$n[this.$n.length-1];var o=new $u(r,e,n,i);this.$n.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.ja=this.ja.add(new _a(a.key,r)),this.kn.ai(t,a.key.path.g())}return Xu.resolve(o)},ch.prototype.da=function(t,e){return Xu.resolve(this.Ka(e))},ch.prototype.qi=function(t,e){var n=e+1,i=this.za(n),r=i<0?0:i;return Xu.resolve(this.$n.length>r?this.$n[r]:null)},ch.prototype.ma=function(){return Xu.resolve(0===this.$n.length?-1:this.Qa-1)},ch.prototype.Va=function(t){return Xu.resolve(this.$n.slice())},ch.prototype.xn=function(t,e){var n=this,i=new _a(e,0),r=new _a(e,Number.POSITIVE_INFINITY),o=[];return this.ja.St([i,r],function(t){var e=n.Ka(t.sr);o.push(e)}),Xu.resolve(o)},ch.prototype.Wn=function(t,e){var i=this,r=new Ur(qi);return e.forEach(function(t){var e=new _a(t,0),n=new _a(t,Number.POSITIVE_INFINITY);i.ja.St([e,n],function(t){r=r.add(t.sr)})}),Xu.resolve(this.Ha(r))},ch.prototype.Hn=function(t,e){var n=e.path,i=n.length+1,r=n;rr.j(r)||(r=r.child(""));var o=new _a(new rr(r),0),s=new Ur(qi);return this.ja.Ct(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.sr)),!0)},o),Xu.resolve(this.Ha(s))},ch.prototype.Ha=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ka(t);null!==e&&i.push(e)}),i},ch.prototype.Si=function(n,i){var r=this;Ci(0===this.Ya(i.batchId,"removed")),this.$n.shift();var o=this.ja;return Xu.forEach(i.mutations,function(t){var e=new _a(t.key,i.batchId);return o=o.delete(e),r.Li.Ja(n,t.key)}).next(function(){r.ja=o})},ch.prototype.Xa=function(t){},ch.prototype.nr=function(t,e){var n=new _a(e,0),i=this.ja.Dt(n);return Xu.resolve(e.isEqual(i&&i.key))},ch.prototype.Ci=function(t){return this.$n.length,Xu.resolve()},ch.prototype.Ya=function(t,e){return this.za(t)},ch.prototype.za=function(t){return 0===this.$n.length?0:t-this.$n[0].batchId},ch.prototype.Ka=function(t){var e=this.za(t);return e<0||e>=this.$n.length?null:this.$n[e]},ch),ah=(hh.prototype.bi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Za(e);return this.docs=this.docs.st(i,{tu:e,size:s,readTime:n}),this.size+=s-o,this.kn.ai(t,i.path.g())},hh.prototype.Oi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},hh.prototype.Mn=function(t,e){var n=this.docs.get(e);return Xu.resolve(n?n.tu:null)},hh.prototype.getEntries=function(t,e){var n=this,i=qr;return e.forEach(function(t){var e=n.docs.get(t);i=i.st(t,e?e.tu:null)}),Xu.resolve(i)},hh.prototype.Qn=function(t,e,n){for(var i=Fr,r=new rr(e.path.child("")),o=this.docs.ct(r);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.tu,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Qs&&du(e,h)&&(i=i.st(h.key,h))}return Xu.resolve(i)},hh.prototype.eu=function(t,e){return Xu.forEach(this.docs,function(t){return e(t)})},hh.prototype.gi=function(t){return new hh.nu(this)},hh.prototype.su=function(t){return Xu.resolve(this.size)},hh);function hh(t,e){this.kn=t,this.Za=e,this.docs=new _r(rr.P),this.size=0}function ch(t,e){this.kn=t,this.Li=e,this.$n=[],this.Qa=1,this.ja=new Ur(_a.ji)}function lh(){}function fh(t,e,n){this.query=t,this.$a=e,this.ka=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}function ph(t){this.qo=t,this.ba=new Qi(fu,lu),this.onlineState="Unknown",this.Sa=new Set,this.qo.subscribe(this)}function dh(t,e,n,i,r,o){this.co=t,this.Mh=e,this.lo=n,this.qh=i,this.currentUser=r,this.Uh=o,this.Bh=null,this.Wh=new Qi(fu,lu),this.Qh=new Map,this.jh=[],this.Gh=new _r(rr.P),this.Kh=new Map,this.zh=new Sa,this.Hh={},this.Yh=new Map,this.Jh=ma.li(),this.onlineState="Unknown",this.Xh=void 0}function yh(t,e){this.query=t,this.Rh=e,this.Ah=null,this.Yt=!1,this.Ph=Wr(),this.qt=Wr(),this.Vh=yu(t),this.yh=new Qr(this.Vh)}function vh(){this.oh=new th,this.hh={},this.eo=null,this.ts=null}function gh(){this.activeTargetIds=zr}function mh(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.co=t,this.lo=e,this.Rs=n,this._o=[],this.fo=new Map,this.do=null,this.wo=new Set,this.mo=r,this.mo.To(function(t){n.vs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(Oi("RemoteStore","Restarting streams for network reachability change."),[4,this.Io()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ro=new Za(n,i),this.Ao=(h=this.lo,c=n,l={qr:this.Po.bind(this),kr:this.Vo.bind(this),Br:this.yo.bind(this)},(f=h).Xr(),new Qa(c,f.Pr,f.credentials,f.serializer,l)),this.po=(o=this.lo,s=n,u={qr:this.vo.bind(this),kr:this.bo.bind(this),Hr:this.So.bind(this),zr:this.zr.bind(this)},(a=o).Xr(),new Ya(s,a.Pr,a.credentials,a.serializer,u))}function wh(t,e){this.Rs=t,this.eo=e,this.state="Unknown",this.no=0,this.so=null,this.io=!0}function bh(t,e,n){var i=this;return(i=ja.call(this)||this).credentials=t,i.Pr=e,i.serializer=n,i.Jr=!1,i}function Eh(t,e,n,i,r){var o=this;return(o=Fa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.jr=!1,o}function Ih(t,e,n,i,r){var o=this;return(o=Ga.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Ah(t,e,n,i,r,o){this.os=t,this.Ar=n,this.Pr=i,this.Vr=r,this.listener=o,this.state=0,this.yr=0,this.pr=null,this.stream=null,this.ks=new oa(t,e)}function Th(t,e){this.Er=t,this.Ir=e}function Nh(t,e){this.Er=t,this.Ir=e,this.type="FirstParty",this.user=Oa.hr}function Rh(t){var e=this;this.dr=null,this.currentUser=Oa.UNAUTHENTICATED,this.wr=!1,this.mr=0,this.ur=null,this.forceRefresh=!1,this.dr=function(){e.mr++,e.currentUser=e.Tr(),e.wr=!0,e.ur&&e.ur(e.currentUser)},this.mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.dr):(this.dr(null),t.get().then(function(t){e.auth=t,e.dr&&e.auth.addAuthTokenListener(e.dr)},function(){}))}function kh(){this.ur=null}function Sh(t){var e=this;return(e=Ba.call(this)||this).uu=t,e}function _h(){this.ha=new Qi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.iu=!1}ah.nu=(Object.defineProperty(_h.prototype,"readTime",{get:function(){return this.ru},set:function(t){this.ru=t},enumerable:!1,configurable:!0}),_h.prototype.bi=function(t,e){this.ou(),this.readTime=e,this.ha.set(t.key,t)},_h.prototype.Oi=function(t,e){this.ou(),e&&(this.readTime=e),this.ha.set(t,null)},_h.prototype.Mn=function(t,e){this.ou();var n=this.ha.get(e);return void 0!==n?Xu.resolve(n):this.hu(t,e)},_h.prototype.getEntries=function(t,e){return this.au(t,e)},_h.prototype.apply=function(t){return this.ou(),this.iu=!0,this.Ch(t)},_h.prototype.ou=function(){},o(Sh,Ba=_h),Sh.prototype.Ch=function(n){var i=this,r=[];return this.ha.forEach(function(t,e){e?r.push(i.uu.bi(n,e,i.readTime)):i.uu.Oi(t)}),Xu.Dn(r)},Sh.prototype.hu=function(t,e){return this.uu.Mn(t,e)},Sh.prototype.au=function(t,e){return this.uu.getEntries(t,e)},Sh);var Oh,Lh,Dh=(Yh.prototype.ve=function(t,n){return this.cu.forEach(function(t,e){return n(e)}),Xu.resolve()},Yh.prototype.Di=function(t){return Xu.resolve(this.lastRemoteSnapshotVersion)},Yh.prototype.du=function(t){return Xu.resolve(this.lu)},Yh.prototype.ea=function(t){return this.highestTargetId=this.fu.next(),Xu.resolve(this.highestTargetId)},Yh.prototype.Mi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lu&&(this.lu=e),Xu.resolve()},Yh.prototype.wu=function(t){this.cu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fu=new ma(e),this.highestTargetId=e),t.sequenceNumber>this.lu&&(this.lu=t.sequenceNumber)},Yh.prototype.na=function(t,e){return this.wu(e),this.targetCount+=1,Xu.resolve()},Yh.prototype.ki=function(t,e){return this.wu(e),Xu.resolve()},Yh.prototype.mu=function(t,e){return this.cu.delete(e.target),this._u.Zi(e.targetId),--this.targetCount,Xu.resolve()},Yh.prototype.Tu=function(n,i,r){var o=this,s=0,u=[];return this.cu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.cu.delete(t),u.push(o.Eu(n,e.targetId)),s++)}),Xu.Dn(u).next(function(){return s})},Yh.prototype.Iu=function(t){return Xu.resolve(this.targetCount)},Yh.prototype.Ui=function(t,e){var n=this.cu.get(e)||null;return Xu.resolve(n)},Yh.prototype.Ni=function(t,e,n){return this._u.Hi(e,n),Xu.resolve()},Yh.prototype.Fi=function(e,t,n){this._u.Xi(t,n);var i=this.persistence.Li,r=[];return i&&t.forEach(function(t){r.push(i.Ja(e,t))}),Xu.Dn(r)},Yh.prototype.Eu=function(t,e){return this._u.Zi(e),Xu.resolve()},Yh.prototype.Bi=function(t,e){var n=this._u.er(e);return Xu.resolve(n)},Yh.prototype.nr=function(t,e){return Xu.resolve(this._u.nr(e))},Yh),Ph=(Qh.prototype.start=function(){return Promise.resolve()},Qh.prototype.Oo=function(){return this.Pu=!1,Promise.resolve()},Object.defineProperty(Qh.prototype,"yu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),Qh.prototype.pu=function(){},Qh.prototype.gu=function(){},Qh.prototype.Pi=function(){return this.kn},Qh.prototype.mi=function(t){var e=this.Ru[t.rr()];return e||(e=new uh(this.kn,this.Li),this.Ru[t.rr()]=e),e},Qh.prototype.Ri=function(){return this.Ii},Qh.prototype.Ei=function(){return this.Nn},Qh.prototype.runTransaction=function(t,e,n){var i=this;Oi("MemoryPersistence","Starting transaction:",t);var r=new Vh(this.Au.next());return this.Li.vu(),n(r).next(function(t){return i.Li.bu(r).next(function(){return t})}).Sn().then(function(t){return r.Su(),t})},Qh.prototype.Cu=function(e,n){return Xu.Fn(Object.values(this.Ru).map(function(t){return function(){return t.nr(e,n)}}))},Qh),Vh=(Xh.prototype.Fu=function(t){this.Du.push(t)},Xh.prototype.Su=function(){this.Du.forEach(function(t){return t()})},o(Hh,Lh=Xh),Hh),Ch=($h.ku=function(t){return new $h(t)},Object.defineProperty($h.prototype,"Ou",{get:function(){if(this.$u)return this.$u;throw Vi()},enumerable:!1,configurable:!0}),$h.prototype.zi=function(t,e,n){return this.Nu.zi(n,e),this.Ou.delete(n.toString()),Xu.resolve()},$h.prototype.Yi=function(t,e,n){return this.Nu.Yi(n,e),this.Ou.add(n.toString()),Xu.resolve()},$h.prototype.Ja=function(t,e){return this.Ou.add(e.toString()),Xu.resolve()},$h.prototype.removeTarget=function(t,e){var n=this;this.Nu.Zi(e.targetId).forEach(function(t){return n.Ou.add(t.toString())});var i=this.persistence.Ri();return i.Bi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ou.add(t.toString())})}).next(function(){return i.mu(t,e)})},$h.prototype.vu=function(){this.$u=new Set},$h.prototype.bu=function(n){var i=this,r=this.persistence.Ei().gi();return Xu.forEach(this.Ou,function(t){var e=rr.U(t);return i.xu(n,e).next(function(t){t||r.Oi(e)})}).next(function(){return i.$u=null,r.apply(n)})},$h.prototype.xi=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Ou.delete(e.toString()):n.Ou.add(e.toString())})},$h.prototype.Vu=function(t){return 0},$h.prototype.xu=function(t,e){var n=this;return Xu.Fn([function(){return Xu.resolve(n.Nu.nr(e))},function(){return n.persistence.Ri().nr(t,e)},function(){return n.persistence.Cu(t,e)}])},$h),Uh=(zh.prototype.qr=function(t){this.qu=t},zh.prototype.kr=function(t){this.Uu=t},zh.prototype.onMessage=function(t){this.Bu=t},zh.prototype.close=function(){this.Mu()},zh.prototype.send=function(t){this.Lu(t)},zh.prototype.Wu=function(){this.qu()},zh.prototype.Qu=function(t){this.Uu(t)},zh.prototype.ju=function(t){this.Bu(t)},zh),Mh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},qh=(Wh.prototype.Zr=function(e,t,n,i){var r=this.Hu(e,t);Oi("RestConnection","Sending: ",r,n);var o={};return this.Yu(o,i),this.Ju(e,r,o,n).then(function(t){return Oi("RestConnection","Received: ",t),t},function(t){throw Di("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Wh.prototype.to=function(t,e,n,i){return this.Zr(t,e,n,i)},Wh.prototype.Yu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.ar)e.ar.hasOwnProperty(n)&&(t[n]=e.ar[n])},Wh.prototype.Hu=function(t,e){var n=Mh[t];return this.Ku+"/v1/"+e+":"+n},o(Bh,Oh=Wh),Bh.prototype.Ju=function(a,e,n,i){return new Promise(function(o,s){var u=new Ni;u.listenOnce(Ai.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ii.NO_ERROR:var t=u.getResponseJson();Oi("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ii.TIMEOUT:Oi("Connection",'RPC "'+a+'" timed out'),s(new Ki(Yi.DEADLINE_EXCEEDED,"Request time out"));break;case Ii.HTTP_ERROR:var e,n,i=u.getStatus();Oi("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Yi).indexOf(r)?r:Yi.UNKNOWN,s(new Ki(n,e.message))):s(new Ki(Yi.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Ki(Yi.UNAVAILABLE,"Connection failed."));break;default:Vi()}}finally{Oi("Connection",'RPC "'+a+'" completed.')}var r});var t=JSON.stringify(i);u.send(e,"POST",t,n,15)})},Bh.prototype.Ur=function(t,e){var n,i,r=[this.Ku,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ei(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Yu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(i=g()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Oi("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Uh({Lu:function(t){l?Oi("Connection","Not sending because WebChannel is closed:",t):(c||(Oi("Connection","Opening WebChannel transport."),h.open(),c=!0),Oi("Connection","WebChannel sending:",t),h.send(t))},Mu:function(){return h.close()}});return a(Ti.EventType.OPEN,function(){l||Oi("Connection","WebChannel transport opened.")}),a(Ti.EventType.CLOSE,function(){l||(l=!0,Oi("Connection","WebChannel transport closed"),f.Qu())}),a(Ti.EventType.ERROR,function(t){l||(l=!0,Di("Connection","WebChannel transport errored:",t),f.Qu(new Ki(Yi.UNAVAILABLE,"The operation could not be completed")))}),a(Ti.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Ci(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Oi("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Ar[r];if(void 0!==t)return Sr(t)}(),s=i.message,void 0===o&&(o=Yi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Qu(new Ki(o,s)),h.close()):(Oi("Connection","WebChannel received:",n),f.ju(n)))}),setTimeout(function(){f.Wu()},0),f},Bh),xh=(Gh.prototype.To=function(t){this.nc.push(t)},Gh.prototype.Oo=function(){window.removeEventListener("online",this.Xu),window.removeEventListener("offline",this.tc)},Gh.prototype.sc=function(){window.addEventListener("online",this.Xu),window.addEventListener("offline",this.tc)},Gh.prototype.Zu=function(){Oi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(0)},Gh.prototype.ec=function(){Oi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(1)},Gh.ic=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Gh),jh=(Fh.prototype.To=function(t){},Fh.prototype.Oo=function(){},Fh);function Fh(){}function Gh(){var t=this;this.Xu=function(){return t.Zu()},this.tc=function(){return t.ec()},this.nc=[],this.sc()}function Bh(t){var e=this;return(e=Oh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Wh(t){this.Gu=t,this.s=t.s;var e=t.ssl?"https":"http";this.Ku=e+"://"+t.host,this.zu="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function zh(t){this.Lu=t.Lu,this.Mu=t.Mu}function $h(t){this.persistence=t,this.Nu=new Sa,this.$u=null}function Hh(t){var e=this;return(e=Lh.call(this)||this).$i=t,e}function Xh(){this.Du=[]}function Qh(t){var e=this;this.Ru={},this.Au=new Ku(0),this.Pu=!1,this.Pu=!0,this.Li=t(this),this.Ii=new Dh(this),this.kn=new va,this.Nn=new ah(this.kn,function(t){return e.Li.Vu(t)})}function Yh(t){this.persistence=t,this.cu=new Qi(gr,mr),this.lastRemoteSnapshotVersion=Ji.min(),this.highestTargetId=0,this.lu=0,this._u=new Sa,this.targetCount=0,this.fu=ma.ci()}function Kh(t){return new Do(t,!0)}var Zh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Jh=(nc.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.qh=this.rc(e),this.persistence=this.oc(e),[4,this.persistence.start()];case 1:return t.sent(),this.hc=this.ac(e),this.co=this.uc(e),[2]}})})},nc.prototype.ac=function(t){return null},nc.prototype.uc=function(t){return e=this.persistence,n=new sh,i=t.cc,new wa(e,n,i);var e,n,i},nc.prototype.oc=function(t){if(t._c.lc)throw new Ki(Yi.FAILED_PRECONDITION,Zh);return new Ph(Ch.ku)},nc.prototype.rc=function(t){return new eh},nc.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.hc&&this.hc.stop(),[4,this.qh.Oo()];case 1:return t.sent(),[4,this.persistence.Oo()];case 2:return t.sent(),[2]}})})},nc.prototype.clearPersistence=function(t,e){throw new Ki(Yi.FAILED_PRECONDITION,Zh)},nc),tc=(ec.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.co?[3,3]:(this.co=n.co,this.qh=n.qh,this.lo=this.fc(i),this.Mh=this.dc(i),this.qo=this.wc(i),this.mc=this.Tc(i),this.qh.eo=function(t){return e.qo.$h(t,1)},this.Mh.qo=this.qo,[4,this.Mh.start()]);case 1:return t.sent(),[4,this.Mh.nh(this.qo.Zh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ec.prototype.Tc=function(t){return new rh(this.qo)},ec.prototype.fc=function(t){var e,n=Kh(t.Gu.s),i=(e=t.Gu,new qh(e)),r=t.credentials;return new Ka(r,i,n)},ec.prototype.dc=function(t){var e=this;return new Ja(this.co,this.lo,t.Rs,function(t){return e.qo.$h(t,0)},new(xh.ic()?xh:jh))},ec.prototype.wc=function(t){return e=this.co,n=this.Mh,i=this.lo,r=this.qh,o=t.cc,s=t.Uh,u=!t._c.lc||!t._c.synchronizeTabs,a=new ih(e,n,i,r,o,s),u&&(a.Xh=!0),a;var e,n,i,r,o,s,u,a},ec.prototype.terminate=function(){return this.Mh.Oo()},ec);function ec(){}function nc(){}function ic(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var rc=(oc.prototype.next=function(t){this.observer.next&&this.Ec(this.observer.next,t)},oc.prototype.error=function(t){this.observer.error?this.Ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},oc.prototype.Ic=function(){this.muted=!0},oc.prototype.Ec=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},oc);function oc(t){this.observer=t,this.muted=!1}function sc(t,e){if(0!==e.length)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Tc(e.length,"argument")+".")}function uc(t,e,n){if(e.length!==n)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires "+Tc(n,"argument")+", but was called with "+Tc(e.length,"argument")+".")}function ac(t,e,n){if(e.length<n)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Tc(n,"argument")+", but was called with "+Tc(e.length,"argument")+".")}function hc(t,e,n,i){if(e.length<n||e.length>i)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Tc(e.length,"argument")+".")}function cc(t,e,n,i){vc(t,e,Ac(n)+" argument",i)}function lc(t,e,n,i){void 0!==i&&cc(t,e,n,i)}function fc(t,e,n,i){vc(t,e,n+" option",i)}function pc(t,e,n,i){void 0!==i&&fc(t,e,n,i)}function dc(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(mc(s))}var u=mc(n);throw new Ki(Yi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function yc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid value "+mc(i)+" provided to function "+t+"() for its "+Ac(n)+" argument. Acceptable values: "+e.join(", "));return i}function vc(t,e,n,i){if(!("object"===e?gc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=mc(i);throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function gc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function mc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vi();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function wc(t,e,n){if(void 0===n)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ac(e)+" argument, but it was undefined.")}function bc(n,t,i){Wi(t,function(t,e){if(i.indexOf(t)<0)throw new Ki(Yi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Ec(t,e,n,i){var r=mc(i);return new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ac(n)+" argument to be a "+e+", but it was: "+r)}function Ic(t,e,n){if(n<=0)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ac(e)+" argument to be a positive number, but it was: "+n+".")}function Ac(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Tc(t,e){return t+" "+e+(1===t?"":"s")}function Nc(){if("undefined"==typeof Uint8Array)throw new Ki(Yi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Rc(){if("undefined"==typeof atob)throw new Ki(Yi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var kc,Sc,_c=(Mc.fromBase64String=function(t){uc("Blob.fromBase64String",arguments,1),cc("Blob.fromBase64String","string",1,t),Rc();try{return new Mc(br.fromBase64String(t))}catch(t){throw new Ki(Yi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Mc.fromUint8Array=function(t){if(uc("Blob.fromUint8Array",arguments,1),Nc(),!(t instanceof Uint8Array))throw Ec("Blob.fromUint8Array","Uint8Array",1,t);return new Mc(br.fromUint8Array(t))},Mc.prototype.toBase64=function(){return uc("Blob.toBase64",arguments,0),Rc(),this.Rc.toBase64()},Mc.prototype.toUint8Array=function(){return uc("Blob.toUint8Array",arguments,0),Nc(),this.Rc.toUint8Array()},Mc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Mc.prototype.isEqual=function(t){return this.Rc.isEqual(t.Rc)},Mc),Oc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ki(Yi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(cc("FieldPath","string",e,t[e]),0===t[e].length)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ac=new ir(t)},Lc=(o(Uc,Sc=Oc),Uc.documentId=function(){return new Uc(ir.M().N())},Uc.prototype.isEqual=function(t){if(!(t instanceof Uc))throw Ec("isEqual","FieldPath",1,t);return this.Ac.isEqual(t.Ac)},Uc),Dc=new RegExp("[~\\*/\\[\\]]"),Pc=function(){this.Pc=this},Vc=(o(Cc,kc=Pc),Cc.prototype.yc=function(t){if(2!==t.pc)throw 1===t.pc?t.gc(this.Vc+"() can only appear at the top level of your update data"):t.gc(this.Vc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Cc.prototype.isEqual=function(t){return t instanceof Cc},Cc);function Cc(t){var e=this;return(e=kc.call(this)||this).Vc=t,e}function Uc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Sc.call(this,t)||this}function Mc(t){Rc(),this.Rc=t}function qc(t,e,n){return new fl({pc:3,vc:e.settings.vc,methodName:t.Vc,bc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var xc,jc,Fc,Gc,Bc,Wc,zc=(o(cl,Wc=Pc),cl.prototype.yc=function(t){return new ps(t.path,new Jo)},cl.prototype.isEqual=function(t){return t instanceof cl},cl),$c=(o(hl,Bc=Pc),hl.prototype.yc=function(t){var e=qc(this,t,!0),n=this.Sc.map(function(t){return bl(t,e)}),i=new ts(n);return new ps(t.path,i)},hl.prototype.isEqual=function(t){return this===t},hl),Hc=(o(al,Gc=Pc),al.prototype.yc=function(t){var e=qc(this,t,!0),n=this.Sc.map(function(t){return bl(t,e)}),i=new os(n);return new ps(t.path,i)},al.prototype.isEqual=function(t){return this===t},al),Xc=(o(ul,Fc=Pc),ul.prototype.yc=function(t){var e=new hs(t.serializer,Co(t.serializer,this.Cc));return new ps(t.path,e)},ul.prototype.isEqual=function(t){return this===t},ul),Qc=(o(sl,jc=Pc),sl.delete=function(){return sc("FieldValue.delete",arguments),new Yc(new Vc("FieldValue.delete"))},sl.serverTimestamp=function(){return sc("FieldValue.serverTimestamp",arguments),new Yc(new zc("FieldValue.serverTimestamp"))},sl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ac("FieldValue.arrayUnion",arguments,1),new Yc(new $c("FieldValue.arrayUnion",t))},sl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ac("FieldValue.arrayRemove",arguments,1),new Yc(new Hc("FieldValue.arrayRemove",t))},sl.increment=function(t){return cc("FieldValue.increment","number",1,t),uc("FieldValue.increment",arguments,1),new Yc(new Xc("FieldValue.increment",t))},sl),Yc=(o(ol,xc=Qc),ol.prototype.yc=function(t){return this.Pc.yc(t)},ol.prototype.isEqual=function(t){return t instanceof ol&&this.Pc.isEqual(t.Pc)},ol),Kc=(Object.defineProperty(rl.prototype,"latitude",{get:function(){return this.Dc},enumerable:!1,configurable:!0}),Object.defineProperty(rl.prototype,"longitude",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),rl.prototype.isEqual=function(t){return this.Dc===t.Dc&&this.Fc===t.Fc},rl.prototype.toJSON=function(){return{latitude:this.Dc,longitude:this.Fc}},rl.prototype.m=function(t){return qi(this.Dc,t.Dc)||qi(this.Fc,t.Fc)},rl),Zc=/^__.*__$/,Jc=function(t,e,n){this.Nc=t,this.$c=e,this.kc=n},tl=(il.prototype.Oc=function(t,e){var n=[];return null!==this.qe?n.push(new ks(t,this.data,this.qe,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},il),el=(nl.prototype.Oc=function(t,e){var n=[new ks(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Ds(t,this.fieldTransforms)),n},nl);function nl(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function il(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function rl(t,e){if(uc("GeoPoint",arguments,2),cc("GeoPoint","number",1,t),cc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ki(Yi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ki(Yi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Dc=t,this.Fc=e}function ol(t){var e=this;return(e=xc.call(this)||this).Pc=t,e.Vc=t.Vc,e}function sl(){return jc.call(this)||this}function ul(t,e){var n=this;return(n=Fc.call(this)||this).Vc=t,n.Cc=e,n}function al(t,e){var n=this;return(n=Gc.call(this)||this).Vc=t,n.Sc=e,n}function hl(t,e){var n=this;return(n=Bc.call(this)||this).Vc=t,n.Sc=e,n}function cl(t){var e=this;return(e=Wc.call(this)||this).Vc=t,e}function ll(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vi()}}var fl=(Object.defineProperty(yl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(yl.prototype,"pc",{get:function(){return this.settings.pc},enumerable:!1,configurable:!0}),yl.prototype.Lc=function(t){return new yl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},yl.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.qc(t),i},yl.prototype.Uc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.xc(),i},yl.prototype.Bc=function(t){return this.Lc({path:void 0,bc:!0})},yl.prototype.gc=function(t){return Rl(t,this.settings.methodName,this.settings.Wc||!1,this.path,this.settings.vc)},yl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},yl.prototype.xc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qc(this.path.get(t))},yl.prototype.qc=function(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(ll(this.pc)&&Zc.test(t))throw this.gc('Document fields cannot begin and end with "__"')},yl),pl=(dl.prototype.Qc=function(t,e,n,i){return void 0===i&&(i=!1),new fl({pc:t,methodName:e,vc:n,path:ir.k(),bc:!1,Wc:i},this.s,this.serializer,this.ignoreUndefinedProperties)},dl);function dl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Kh(t)}function yl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.qe=o||[]}function vl(t,e,n,i,r,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,r);Al("Data must be an object, but it was:",s,i);var u,a,h=El(i,s);if(o.merge)u=new ds(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Oc)d=p.Ac;else{if("string"!=typeof p)throw Vi();d=Nl(e,p,n)}if(!s.contains(d))throw new Ki(Yi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");kl(c,d)||c.push(d)}u=new ds(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new tl(new xs(h),u,a)}function gl(t,o,s,e){var u=t.Qc(1,o,s);Al("Data must be an object, but it was:",u,e);var a=[],h=new js;Wi(e,function(t,e){var n,i=Nl(o,t,s),r=u.Uc(i);e instanceof Pc&&e.Pc instanceof Vc?a.push(i):null!=(n=bl(e,r))&&(a.push(i),h.set(i,n))});var n=new ds(a);return new el(h.ze(),n,u.fieldTransforms)}function ml(t,e,n,i,r,o){var s=t.Qc(1,e,n),u=[Tl(e,i,n)],a=[r];if(o.length%2!=0)throw new Ki(Yi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Tl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new js,v=u.length-1;0<=v;--v)kl(d,u[v])||(c=u[v],l=a[v],f=s.Uc(c),l instanceof Pc&&l.Pc instanceof Vc?d.push(c):null!=(p=bl(l,f))&&(d.push(c),y.set(c,p)));var g=new ds(d);return new el(y.ze(),g,s.fieldTransforms)}function wl(t,e,n,i){return void 0===i&&(i=!1),bl(n,t.Qc(i?4:3,e))}function bl(s,t){if(Il(s))return Al("Unsupported field value:",t,s),El(s,t);if(s instanceof Pc)return function(t,e){if(!ll(e.pc))throw e.gc(t.Vc+"() can only be used with update() and set()");if(!e.path)throw e.gc(t.Vc+"() is not currently supported inside arrays");var n=t.yc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.bc&&4!==t.pc)throw t.gc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=bl(r[i],t.Bc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zi.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof Zi){var i=new Zi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,i)}}if(t instanceof Kc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof _c)return{bytesValue:Mo(e.serializer,t)};if(t instanceof Jc){var r=e.s,o=t.Nc;if(!o.isEqual(r))throw e.gc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:xo(t.Nc||e.s,t.$c.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.gc("Unsupported field value: "+mc(t))}(s,t)}function El(t,i){var r={};return zi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):Wi(t,function(t,e){var n=bl(e,i.Mc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Il(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zi||t instanceof Kc||t instanceof _c||t instanceof Jc||t instanceof Pc)}function Al(t,e,n){if(!Il(n)||!gc(n)){var i=mc(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function Tl(t,e,n){if(e instanceof Oc)return e.Ac;if("string"==typeof e)return Nl(t,e);throw Rl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Nl(t,e,n){try{return function(e){if(0<=e.search(Dc))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Lc.bind.apply(Lc,s([void 0],e.split("."))))}catch(t){throw new Ki(Yi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ac}catch(e){throw Rl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Rl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+i),s&&(a+=" in document "+r),a+=")"),new Ki(Yi.INVALID_ARGUMENT,(u+=". ")+t+a)}function kl(t,e){return t.some(function(t){return t.isEqual(e)})}var Sl=(Pl.prototype.Hc=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),0<this.mutations.length)throw new Ki(Yi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Bo((r=u).serializer)+"/documents",n={documents:a.map(function(t){return jo(r.serializer,t)})},[4,r.to("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Ci(!!e.found),e.found.name,e.found.updateTime;var n=Fo(t,e.found.name),i=qo(e.found.updateTime),r=new xs({mapValue:{fields:e.found.fields}});return new Qs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Ci(!!e.missing),Ci(!!e.readTime);var n=Fo(t,e.missing),i=qo(e.readTime);return new Ys(n,i)}(e,n):Vi());o.set(i.key.toString(),i)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Ci(!!e),s.push(e)}),s)]}})})}(this.lo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ys||t instanceof Qs?n.Jc(t):Vi()}),e)]}})})},Pl.prototype.set=function(t,e){this.write(e.Oc(t,this.We(t))),this.zc.add(t.toString())},Pl.prototype.update=function(t,e){try{this.write(e.Oc(t,this.Xc(t)))}catch(t){this.Kc=t}this.zc.add(t.toString())},Pl.prototype.delete=function(t){this.write([new Ms(t,this.We(t))]),this.zc.add(t.toString())},Pl.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),this.Kc)throw this.Kc;return e=this.jc,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=rr.U(e);i.mutations.push(new qs(n,i.We(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Bo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return zo(e.serializer,t)})},[4,e.Zr("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.lo,this.mutations)];case 1:return t.sent(),this.Gc=!0,[2]}})})},Pl.prototype.Jc=function(t){var e;if(t instanceof Qs)e=t.version;else{if(!(t instanceof Ys))throw Vi();e=Ji.min()}var n=this.jc.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ki(Yi.ABORTED,"Document version changed between two reads.")}else this.jc.set(t.key.toString(),e)},Pl.prototype.We=function(t){var e=this.jc.get(t.toString());return!this.zc.has(t.toString())&&e?gs.updateTime(e):gs.Ge()},Pl.prototype.Xc=function(t){var e=this.jc.get(t.toString());if(this.zc.has(t.toString())||!e)return gs.exists(!0);if(e.isEqual(Ji.min()))throw new Ki(Yi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gs.updateTime(e)},Pl.prototype.write=function(t){this.Yc(),this.mutations=this.mutations.concat(t)},Pl.prototype.Yc=function(){},Pl),_l=(Dl.prototype.run=function(){this.tl()},Dl.prototype.tl=function(){var t=this;this.ks.ws(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new Sl(this.lo),(n=this.el(e))&&n.then(function(t){i.Rs.vs(function(){return e.commit().then(function(){i.Vs.resolve(t)}).catch(function(t){i.nl(t)})})}).catch(function(t){i.nl(t)}),[2]})})})},Dl.prototype.el=function(t){try{var e=this.updateFunction(t);return!pr(e)&&e.catch&&e.then?e:(this.Vs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vs.reject(t),null}},Dl.prototype.nl=function(t){var e=this;0<this.Zc&&this.sl(t)?(--this.Zc,this.Rs.vs(function(){return e.tl(),Promise.resolve()})):this.Vs.reject(t)},Dl.prototype.sl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!kr(e)},Dl),Ol=(Ll.prototype.start=function(t,e,n,i){var r=this;this.rl(),this.Gu=t;var o=new ra,s=!1;return this.credentials.lr(function(t){return s?void r.Rs.Bs(function(){return r.Mh.eh(t)}):(s=!0,Oi("FirestoreClient","Initializing. user=",t.uid),r.ol(e,n,i,t,o).then(r.il.resolve,r.il.reject))}),this.Rs.vs(function(){return r.il.promise}),o.promise},Ll.prototype.enableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!0),t.Mh.enableNetwork()})},Ll.prototype.ol=function(r,o,s,u,a){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Rs:this.Rs,Gu:this.Gu,clientId:this.clientId,credentials:this.credentials,cc:u,Uh:100,_c:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.qh=r.qh,this.co=r.co,this.hc=r.hc,this.lo=o.lo,this.Mh=o.Mh,this.qo=o.qo,this.hl=o.mc,this.persistence.pu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.ol(new Jh,new tc,{lc:!1},u,a))];case 4:return[2]}})})},Ll.prototype.al=function(t){return"FirebaseError"===t.name?t.code===Yi.FAILED_PRECONDITION||t.code===Yi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ll.prototype.rl=function(){if(this.Rs.xs)throw new Ki(Yi.FAILED_PRECONDITION,"The client has already been terminated.")},Ll.prototype.disableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!1),t.Mh.disableNetwork()})},Ll.prototype.terminate=function(){var t=this;this.Rs.Us();var i=new ra;return this.Rs.Ls(function(){return d(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.hc&&this.hc.stop(),[4,this.Mh.Oo()];case 1:return t.sent(),[4,this.qh.Oo()];case 2:return t.sent(),[4,this.persistence.Oo()];case 3:return t.sent(),this.credentials._r(),i.resolve(),[3,5];case 4:return e=t.sent(),n=pa(e,"Failed to shutdown persistence"),i.reject(n),[3,5];case 5:return[2]}})})}),i.promise},Ll.prototype.waitForPendingWrites=function(){var t=this;this.rl();var e=new ra;return this.Rs.vs(function(){return t.qo.wa(e)}),e.promise},Ll.prototype.listen=function(t,e,n){var i=this;this.rl();var r=new rc(n),o=new oh(t,r,e);return this.Rs.vs(function(){return i.hl.listen(o)}),function(){r.Ic(),i.Rs.vs(function(){return i.hl.Lo(o)})}},Ll.prototype.ul=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,u,a){return d(this,void 0,void 0,function(){var s,e=this;return y(this,function(t){switch(t.label){case 0:return s=new ra,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Ai.On(t,e)}))];case 1:return(i=t.sent())instanceof Qs?s.resolve(i):i instanceof Ys?s.resolve(null):s.reject(new Ki(Yi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),o=pa(r,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.Rs,this.co,e))]}})})},Ll.prototype.cl=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ra,s=Vl(e,n,ru(i.path),{includeMetadataChanges:!0,qa:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Ki(Yi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Ki(Yi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ll.prototype.ll=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,a,h){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return u=new ra,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ra(a,h,!0)];case 1:return e=t.sent(),n=new nh(h,e.Wi),i=n.gh(e.documents),r=n.Ch(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=pa(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.Rs,this.co,e))]}})})},Ll.prototype._l=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ra,s=Vl(e,n,i,{includeMetadataChanges:!0,qa:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Ki(Yi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ll.prototype.write=function(t){var e=this;this.rl();var n=new ra;return this.Rs.vs(function(){return e.qo.write(t,n)}),n.promise},Ll.prototype.s=function(){return this.Gu.s},Ll.prototype.Fa=function(t){var e=this;this.rl();var n=new rc(t);return this.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Fa(n)]})})}),function(){n.Ic(),e.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Na(n)]})})})}},Object.defineProperty(Ll.prototype,"fl",{get:function(){return this.Rs.xs},enumerable:!1,configurable:!0}),Ll.prototype.transaction=function(t){var e=this;this.rl();var n=new ra;return this.Rs.vs(function(){return new _l(e.Rs,e.lo,t,n).run(),Promise.resolve()}),n.promise},Ll);function Ll(t,e){this.credentials=t,this.Rs=e,this.clientId=Ui.t(),this.il=new ra}function Dl(t,e,n,i){this.Rs=t,this.lo=e,this.updateFunction=n,this.Vs=i,this.Zc=5,this.ks=new oa(this.Rs,"transaction_retry")}function Pl(t){this.lo=t,this.jc=new Map,this.mutations=[],this.Gc=!1,this.Kc=null,this.zc=new Set}function Vl(t,e,n,i,r){var o=new rc(r),s=new oh(n,o,i);return t.vs(function(){return e.listen(s)}),function(){o.Ic(),t.vs(function(){return e.Lo(s)})}}var Cl,Ul,Ml=(ef.prototype.ml=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Tl(t.timestampValue);case 4:return this.El(t);case 5:return t.stringValue;case 6:return new _c(Ao(t.bytesValue));case 7:return this.Il(t.referenceValue);case 8:return this.Rl(t.geoPointValue);case 9:return this.Al(t.arrayValue);case 10:return this.Pl(t.mapValue);default:throw Vi()}},ef.prototype.Pl=function(t){var n=this,i={};return Wi(t.fields||{},function(t,e){i[t]=n.ml(e)}),i},ef.prototype.Rl=function(t){return new Kc(Io(t.latitude),Io(t.longitude))},ef.prototype.Al=function(t){var e=this;return(t.values||[]).map(function(t){return e.ml(t)})},ef.prototype.El=function(t){switch(this.dl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.ml(e);case"estimate":return this.Tl(fo(t));default:return null}},ef.prototype.Tl=function(t){var e=Eo(t),n=new Zi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},ef.prototype.Il=function(t){var e=er.$(t);Ci(Xo(e));var n=new Fi(e.get(1),e.get(3)),i=new rr(e.p(5));return n.isEqual(this.s)||Li("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.wl(i)},ef),ql=da.ni,xl=(tf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},tf),jl=(Object.defineProperty(Jl.prototype,"Nl",{get:function(){return this.$l||(this.$l=new pl(this.Nc,this.Fl.ignoreUndefinedProperties)),this.$l},enumerable:!1,configurable:!0}),Jl.prototype.settings=function(t){uc("Firestore.settings",arguments,1),cc("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Fl),t)).merge;var e=new xl(t);if(this.bl&&!this.Fl.isEqual(e))throw new Ki(Yi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Fl=e).credentials&&(this.Dl=function(t){if(!t)return new Wa;switch(t.type){case"gapi":var e=t.kl;return Ci(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ha(e,t.Ir||"0");case"provider":return t.kl;default:throw new Ki(Yi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Jl.prototype.enableNetwork=function(){return this.vl(),this.bl.enableNetwork()},Jl.prototype.disableNetwork=function(){return this.vl(),this.bl.disableNetwork()},Jl.prototype.enablePersistence=function(t){var e,n;if(this.bl)throw new Ki(Yi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Li("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Ki(Yi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ol(this.Vl,this.yl,{lc:!0,cacheSizeBytes:this.Fl.cacheSizeBytes,synchronizeTabs:i,xl:r})},Jl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.bl&&!this.bl.fl)throw new Ki(Yi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ra,[2,(this.gl.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Vl.clearPersistence(this.Nc,this.Cl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Jl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Jl.prototype,"Ll",{get:function(){return this.vl(),this.bl.fl},enumerable:!1,configurable:!0}),Jl.prototype.waitForPendingWrites=function(){return this.vl(),this.bl.waitForPendingWrites()},Jl.prototype.onSnapshotsInSync=function(t){if(this.vl(),ic(t))return this.bl.Fa(t);cc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.bl.Fa(e)},Jl.prototype.vl=function(){return this.bl||this.Ol(new Jh,new tc,{lc:!1}),this.bl},Jl.prototype.Ml=function(){return new ji(this.Nc,this.Cl,this.Fl.host,this.Fl.ssl,this.Fl.experimentalForceLongPolling)},Jl.prototype.Ol=function(t,e,n){var i=this.Ml();return this.bl=new Ol(this.Dl,this.gl),this.bl.start(i,t,e,n)},Jl.Sl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ki(Yi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ki(Yi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Fi(n)},Object.defineProperty(Jl.prototype,"app",{get:function(){if(!this.pl)throw new Ki(Yi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pl},enumerable:!1,configurable:!0}),Jl.prototype.collection=function(t){return uc("Firestore.collection",arguments,1),cc("Firestore.collection","non-empty string",1,t),this.vl(),new cf(er.$(t),this,null)},Jl.prototype.doc=function(t){return uc("Firestore.doc",arguments,1),cc("Firestore.doc","non-empty string",1,t),this.vl(),Bl.ql(er.$(t),this,null)},Jl.prototype.collectionGroup=function(t){if(uc("Firestore.collectionGroup",arguments,1),cc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.vl(),new af((e=t,new nu(er.k(),e)),this,null);var e},Jl.prototype.runTransaction=function(e){var n=this;return uc("Firestore.runTransaction",arguments,1),cc("Firestore.runTransaction","function",1,e),this.vl().transaction(function(t){return e(new Fl(n,t))})},Jl.prototype.batch=function(){return this.vl(),new Gl(this)},Object.defineProperty(Jl,"logLevel",{get:function(){switch(_i()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Jl.setLogLevel=function(t){uc("Firestore.setLogLevel",arguments,1),yc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Si.setLogLevel(t)},Jl.prototype.Ul=function(){return this.Fl.timestampsInSnapshots},Jl.prototype.Bl=function(){return this.Fl},Jl),Fl=(Zl.prototype.get=function(t){var n=this;uc("Transaction.get",arguments,1);var i=gf("Transaction.get",t,this.Wl);return this.Ql.Hc([i.$c]).then(function(t){if(!t||1!==t.length)return Vi();var e=t[0];if(e instanceof Ys)return new zl(n.Wl,i.$c,null,!1,!1,i.kc);if(e instanceof Qs)return new zl(n.Wl,i.$c,e,!1,!1,i.kc);throw Vi()})},Zl.prototype.set=function(t,e,n){hc("Transaction.set",arguments,2,3);var i=gf("Transaction.set",t,this.Wl);n=df("Transaction.set",n);var r=mf(i.kc,e,n),o=vl(this.Wl.Nl,"Transaction.set",i.$c,r,null!==i.kc,n);return this.Ql.set(i.$c,o),this},Zl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Lc?(ac("Transaction.update",arguments,3),i=gf("Transaction.update",t,this.Wl),ml(this.Wl.Nl,"Transaction.update",i.$c,e,n,o)):(uc("Transaction.update",arguments,2),i=gf("Transaction.update",t,this.Wl),gl(this.Wl.Nl,"Transaction.update",i.$c,e)),this.Ql.update(i.$c,r),this},Zl.prototype.delete=function(t){uc("Transaction.delete",arguments,1);var e=gf("Transaction.delete",t,this.Wl);return this.Ql.delete(e.$c),this},Zl),Gl=(Kl.prototype.set=function(t,e,n){hc("WriteBatch.set",arguments,2,3),this.Kl();var i=gf("WriteBatch.set",t,this.Wl);n=df("WriteBatch.set",n);var r=mf(i.kc,e,n),o=vl(this.Wl.Nl,"WriteBatch.set",i.$c,r,null!==i.kc,n);return this.jl=this.jl.concat(o.Oc(i.$c,gs.Ge())),this},Kl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Kl(),r="string"==typeof e||e instanceof Lc?(ac("WriteBatch.update",arguments,3),i=gf("WriteBatch.update",t,this.Wl),ml(this.Wl.Nl,"WriteBatch.update",i.$c,e,n,o)):(uc("WriteBatch.update",arguments,2),i=gf("WriteBatch.update",t,this.Wl),gl(this.Wl.Nl,"WriteBatch.update",i.$c,e)),this.jl=this.jl.concat(r.Oc(i.$c,gs.exists(!0))),this},Kl.prototype.delete=function(t){uc("WriteBatch.delete",arguments,1),this.Kl();var e=gf("WriteBatch.delete",t,this.Wl);return this.jl=this.jl.concat(new Ms(e.$c,gs.Ge())),this},Kl.prototype.commit=function(){return this.Kl(),this.Gl=!0,0<this.jl.length?this.Wl.vl().write(this.jl):Promise.resolve()},Kl.prototype.Kl=function(){if(this.Gl)throw new Ki(Yi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Kl),Bl=(o(Yl,Ul=Jc),Yl.ql=function(t,e,n){if(t.length%2!=0)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Yl(new rr(t),e,n)},Object.defineProperty(Yl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"parent",{get:function(){return new cf(this.$c.path.g(),this.firestore,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Yl.prototype,"path",{get:function(){return this.$c.path.N()},enumerable:!1,configurable:!0}),Yl.prototype.collection=function(t){if(uc("DocumentReference.collection",arguments,1),cc("DocumentReference.collection","non-empty string",1,t),!t)throw new Ki(Yi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=er.$(t);return new cf(this.$c.path.child(e),this.firestore,null)},Yl.prototype.isEqual=function(t){if(!(t instanceof Yl))throw Ec("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$c.isEqual(t.$c)&&this.kc===t.kc},Yl.prototype.set=function(t,e){hc("DocumentReference.set",arguments,1,2),e=df("DocumentReference.set",e);var n=mf(this.kc,t,e),i=vl(this.firestore.Nl,"DocumentReference.set",this.$c,n,null!==this.kc,e);return this.bl.write(i.Oc(this.$c,gs.Ge()))},Yl.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Lc?(ac("DocumentReference.update",arguments,2),ml(this.firestore.Nl,"DocumentReference.update",this.$c,t,e,i)):(uc("DocumentReference.update",arguments,1),gl(this.firestore.Nl,"DocumentReference.update",this.$c,t)),this.bl.write(n.Oc(this.$c,gs.exists(!0)))},Yl.prototype.delete=function(){return uc("DocumentReference.delete",arguments,0),this.bl.write([new Ms(this.$c,gs.Ge())])},Yl.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];hc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof r[u]||ic(r[u])||(bc("DocumentReference.onSnapshot",s=r[u],["includeMetadataChanges"]),pc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};ic(r[u])?(a=r[u],r[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),r[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),r[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(cc("DocumentReference.onSnapshot","function",u,r[u]),lc("DocumentReference.onSnapshot","function",u+1,r[u+1]),lc("DocumentReference.onSnapshot","function",u+2,r[u+2]));var c={next:function(t){r[u]&&r[u](i.zl(t))},error:r[u+1],complete:r[u+2]};return this.bl.listen(ru(this.$c.path),h,c)},Yl.prototype.get=function(t){var e=this;hc("DocumentReference.get",arguments,0,1),vf("DocumentReference.get",t);var n=this.firestore.vl();return t&&"cache"===t.source?n.ul(this.$c).then(function(t){return new zl(e.firestore,e.$c,t,!0,t instanceof Qs&&t.Ke,e.kc)}):n.cl(this.$c,t).then(function(t){return e.zl(t)})},Yl.prototype.withConverter=function(t){return new Yl(this.$c,this.firestore,t)},Yl.prototype.zl=function(t){var e=t.docs.get(this.$c);return new zl(this.firestore,this.$c,e,t.fromCache,t.hasPendingWrites,this.kc)},Yl),Wl=(Ql.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ql),zl=(Xl.prototype.data=function(t){var e=this;if(hc("DocumentSnapshot.data",arguments,0,1),t=yf("DocumentSnapshot.data",t),this.Hl){if(this.kc){var n=new $l(this.Wl,this.$c,this.Hl,this.Yl,this.Jl,null);return this.kc.fromFirestore(n,t)}return new Ml(this.Wl.Nc,this.Wl.Ul(),t.serverTimestamps||"none",function(t){return new Bl(t,e.Wl,null)}).ml(this.Hl.tn())}},Xl.prototype.get=function(t,e){var n=this;if(hc("DocumentSnapshot.get",arguments,1,2),e=yf("DocumentSnapshot.get",e),this.Hl){var i=this.Hl.data().field(Tl("DocumentSnapshot.get",t,this.$c));if(null!==i)return new Ml(this.Wl.Nc,this.Wl.Ul(),e.serverTimestamps||"none",function(t){return new Bl(t,n.Wl,n.kc)}).ml(i)}},Object.defineProperty(Xl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"ref",{get:function(){return new Bl(this.$c,this.Wl,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"exists",{get:function(){return null!==this.Hl},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"metadata",{get:function(){return new Wl(this.Jl,this.Yl)},enumerable:!1,configurable:!0}),Xl.prototype.isEqual=function(t){if(!(t instanceof Xl))throw Ec("isEqual","DocumentSnapshot",1,t);return this.Wl===t.Wl&&this.Yl===t.Yl&&this.$c.isEqual(t.$c)&&(null===this.Hl?null===t.Hl:this.Hl.isEqual(t.Hl))&&this.kc===t.kc},Xl),$l=(o(Hl,Cl=zl),Hl.prototype.data=function(t){return Cl.prototype.data.call(this,t)},Hl);function Hl(){return null!==Cl&&Cl.apply(this,arguments)||this}function Xl(t,e,n,i,r,o){this.Wl=t,this.$c=e,this.Hl=n,this.Yl=i,this.Jl=r,this.kc=o}function Ql(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yl(t,e,n){var i=this;return(i=Ul.call(this,e.Nc,t,n)||this).$c=t,i.firestore=e,i.kc=n,i.bl=i.firestore.vl(),i}function Kl(t){this.Wl=t,this.jl=[],this.Gl=!1}function Zl(t,e){this.Wl=t,this.Ql=e}function Jl(t,e,n,i){var r=this;if(void 0===n&&(n=new Jh),void 0===i&&(i=new tc),this.Vl=n,this.yl=i,this.pl=null,this.gl=new ca,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.vl(),[4,this.bl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.pl=o,this.Nc=Jl.Sl(o),this.Cl=o.name,this.Dl=new za(e)}else{var s=t;if(!s.projectId)throw new Ki(Yi.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new Fi(s.projectId,s.database),this.Cl="[DEFAULT]",this.Dl=new Wa}this.Fl=new xl({})}function tf(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Ki(Yi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else fc("settings","non-empty string","host",t.host),this.host=t.host,pc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(bc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),pc("settings","object","credentials",t.credentials),this.credentials=t.credentials,pc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),pc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Li("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Li("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,pc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=da.ii;else{if(t.cacheSizeBytes!==ql&&t.cacheSizeBytes<da.si)throw new Ki(Yi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+da.si);this.cacheSizeBytes=t.cacheSizeBytes}pc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function ef(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.dl=n,this.wl=i}function nf(t,e,n){if("string"==typeof n){if(""===n)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ou(e)&&-1!==n.indexOf("/"))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(er.$(n));if(!rr.j(i))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return To(t,new rr(i))}if(n instanceof Jc)return To(t,n.$c);throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+mc(n)+".")}function rf(t,e){if(!Array.isArray(t)||0===t.length)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function of(t,e,n){if(!n.isEqual(e))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function sf(t){if(t.un()&&0===t.en.length)throw new Ki(Yi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var uf,af=(pf.prototype.where=function(t,e,n){var i;uc("Query.where",arguments,3),wc("Query.where",3,n),i="not-in"===e||"!="===e?e:yc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=Tl("Query.where",t),u=function(t,e,n,i,r,o){var s;if(i.L()){if("array-contains"===r||"array-contains-any"===r)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r||"not-in"===r){rf(o,r);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(nf(n,t,c))}s={arrayValue:{values:u}}}else s=nf(n,t,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||rf(o,r),s=wl(e,"Query.where",o,"in"===r||"not-in"===r);var l=gu.create(i,r,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.cn();null!==i&&of(0,e.field,i)}var r=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,l),l}(this.Xl,this.firestore.Nl,this.firestore.Nc,s,i,n);return new pf((o=(r=this.Xl).filters.concat([u]),new nu(r.path,r.collectionGroup,r.en.slice(),o,r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.kc)},pf.prototype.orderBy=function(t,e){var n;if(hc("Query.orderBy",arguments,1,2),lc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ki(Yi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=Tl("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o=new zu(e,n),s=o;return null!==(i=t).cn()||null!==(r=i.ln())&&of(0,r,s.field),o}(this.Xl,o,n);return new pf((r=(i=this.Xl).en.concat([s]),new nu(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.kc)},pf.prototype.limit=function(t){return uc("Query.limit",arguments,1),cc("Query.limit","number",1,t),Ic("Query.limit",1,t),new pf(au(this.Xl,t,"F"),this.firestore,this.kc)},pf.prototype.limitToLast=function(t){return uc("Query.limitToLast",arguments,1),cc("Query.limitToLast","number",1,t),Ic("Query.limitToLast",1,t),new pf(au(this.Xl,t,"L"),this.firestore,this.kc)},pf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ac("Query.startAt",arguments,1);var i=this.Zl("Query.startAt",t,e,!0);return new pf(hu(this.Xl,i),this.firestore,this.kc)},pf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ac("Query.startAfter",arguments,1);var i=this.Zl("Query.startAfter",t,e,!1);return new pf(hu(this.Xl,i),this.firestore,this.kc)},pf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ac("Query.endBefore",arguments,1);var i=this.Zl("Query.endBefore",t,e,!0);return new pf(cu(this.Xl,i),this.firestore,this.kc)},pf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ac("Query.endAt",arguments,1);var i=this.Zl("Query.endAt",t,e,!1);return new pf(cu(this.Xl,i),this.firestore,this.kc)},pf.prototype.isEqual=function(t){if(!(t instanceof pf))throw Ec("isEqual","Query",1,t);return this.firestore===t.firestore&&lu(this.Xl,t.Xl)&&this.kc===t.kc},pf.prototype.withConverter=function(t){return new pf(this.Xl,this.firestore,t)},pf.prototype.Zl=function(c,t,e,n){if(wc(c,1,t),t instanceof zl)return uc(c,s([t],e),1),function(t,e,n,i){if(!n)throw new Ki(Yi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=su(t);o<s.length;o++){var u=s[o];if(u.field.L())r.push(To(e,n.key));else{var a=n.field(u.field);if(lo(a))throw new Ki(Yi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Mu(r,i)}(this.Xl,this.firestore.Nc,t.Hl,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.en;if(r.length>s.length)throw new Ki(Yi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<r.length;a++){var h=r[a];if(s[a].field.L()){if("string"!=typeof h)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!ou(t)&&-1!==h.indexOf("/"))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(er.$(h));if(!rr.j(c))throw new Ki(Yi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new rr(c);u.push(To(e,l))}else{var f=wl(n,i,h);u.push(f)}}return new Mu(u,o)}(this.Xl,this.firestore.Nc,this.firestore.Nl,c,i,n)},pf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];hc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof r[a]||ic(r[a])||(bc("Query.onSnapshot",u=r[a],["includeMetadataChanges"]),pc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),ic(r[a])?(s=r[a],r[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(cc("Query.onSnapshot","function",a,r[a]),lc("Query.onSnapshot","function",a+1,r[a+1]),lc("Query.onSnapshot","function",a+2,r[a+2]));var h={next:function(t){r[a]&&r[a](new hf(i.firestore,i.Xl,t,i.kc))},error:r[a+1],complete:r[a+2]};return sf(this.Xl),this.firestore.vl().listen(this.Xl,u,h)},pf.prototype.get=function(t){var e=this;hc("Query.get",arguments,0,1),vf("Query.get",t),sf(this.Xl);var n=this.firestore.vl();return(t&&"cache"===t.source?n.ll(this.Xl):n._l(this.Xl,t)).then(function(t){return new hf(e.firestore,e.Xl,t,e.kc)})},pf),hf=(Object.defineProperty(ff.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"empty",{get:function(){return this.e_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"size",{get:function(){return this.e_.docs.size},enumerable:!1,configurable:!0}),ff.prototype.forEach=function(e,n){var i=this;hc("QuerySnapshot.forEach",arguments,1,2),cc("QuerySnapshot.forEach","function",1,e),this.e_.docs.forEach(function(t){e.call(n,i.i_(t,i.metadata.fromCache,i.e_.qt.has(t.key)))})},Object.defineProperty(ff.prototype,"query",{get:function(){return new af(this.t_,this.Wl,this.kc)},enumerable:!1,configurable:!0}),ff.prototype.docChanges=function(t){t&&(bc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),pc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.e_.Bt)throw new Ki(Yi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.n_&&this.s_===e||(this.n_=function(r,e,o){if(r.Mt._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Mt;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vi()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.e_,e,this.i_.bind(this)),this.s_=e),this.n_},ff.prototype.isEqual=function(t){if(!(t instanceof ff))throw Ec("isEqual","QuerySnapshot",1,t);return this.Wl===t.Wl&&lu(this.t_,t.t_)&&this.e_.isEqual(t.e_)&&this.kc===t.kc},ff.prototype.i_=function(t,e,n){return new $l(this.Wl,t.key,t,e,n,this.kc)},ff),cf=(o(lf,uf=af),Object.defineProperty(lf.prototype,"id",{get:function(){return this.Xl.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"parent",{get:function(){var t=this.Xl.path.g();return t._()?null:new Bl(new rr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"path",{get:function(){return this.Xl.path.N()},enumerable:!1,configurable:!0}),lf.prototype.doc=function(t){hc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ui.t()),cc("CollectionReference.doc","non-empty string",1,t);var e=er.$(t);return Bl.ql(this.Xl.path.child(e),this.firestore,this.kc)},lf.prototype.add=function(t){uc("CollectionReference.add",arguments,1),cc("CollectionReference.add","object",1,this.kc?this.kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},lf.prototype.withConverter=function(t){return new lf(this.r_,this.firestore,t)},lf);function lf(t,e,n){var i=this;if(((i=uf.call(this,ru(t),e,n)||this).r_=t).length%2!=1)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function ff(t,e,n,i){this.Wl=t,this.t_=e,this.e_=n,this.kc=i,this.n_=null,this.s_=null,this.metadata=new Wl(n.hasPendingWrites,n.fromCache)}function pf(t,e,n){this.Xl=t,this.firestore=e,this.kc=n}function df(t,e){if(void 0===e)return{merge:!1};if(bc(t,e,["merge","mergeFields"]),pc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+mc(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof Lc))throw new Ki(Yi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+mc(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ki(Yi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function yf(t,e){return void 0===e?{}:(bc(t,e,["serverTimestamps"]),dc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function vf(t,e){lc(t,"object",1,e),e&&(bc(t,e,["source"]),dc(t,0,"source",e.source,["default","server","cache"]))}function gf(t,e,n){if(e instanceof Jc){if(e.firestore!==n)throw new Ki(Yi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ec(t,"DocumentReference",1,e)}function mf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var wf,bf={Firestore:jl,GeoPoint:Kc,Timestamp:Zi,Blob:_c,Transaction:Fl,WriteBatch:Gl,DocumentReference:Bl,DocumentSnapshot:zl,Query:af,QueryDocumentSnapshot:$l,QuerySnapshot:hf,CollectionReference:cf,FieldPath:Lc,FieldValue:Qc,setLogLevel:jl.setLogLevel,CACHE_SIZE_UNLIMITED:ql};(wf=i.default).INTERNAL.registerComponent(new Ri("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new jl(e,n,new Jh,new tc);var e,n},"PUBLIC").setServiceProps(Object.assign({},bf))),wf.registerVersion("@firebase/firestore","1.16.6")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});