!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Fd){"use strict";try{(function(){var t,l,e,n,r=(n=Fd)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,m="FirebaseError",b=(o(E,v=Error),E);function E(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=m,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(N,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var N=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k=D||self;function R(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),C=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:U).apply(null,arguments)}function F(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++C))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var Y,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var J=k.navigator;if(J){var $=J.userAgent;if($){Y=$;break t}}Y=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e={};for(var n in t)e[n]=t[n];return e}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=R;var ot,st,ut=Q(Y,"Opera"),at=Q(Y,"Trident")||Q(Y,"MSIE"),ct=Q(Y,"Edge"),ht=ct||at,ft=Q(Y,"Gecko")&&!(Q(Y.toLowerCase(),"webkit")&&!Q(Y,"Edge"))&&!(Q(Y,"Trident")||Q(Y,"MSIE"))&&!Q(Y,"Edge"),lt=Q(Y.toLowerCase(),"webkit")&&!Q(Y,"Edge");function pt(){var t=k.document;return t?t.documentMode:void 0}t:{var dt="",yt=(st=Y,ft?/rv:([^\);]+)(\)|;)/.exec(st):ct?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(yt&&(dt=yt?yt[1]:""),at){var vt=pt();if(null!=vt&&vt>parseFloat(dt)){ot=String(vt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=X(String(ot)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=k.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),Et=at&&!mt("9"),It=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",R,e),k.removeEventListener("test",R,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},j(Nt,Tt);var _t={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),St=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Pt={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[At]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[At]?t.va(e,n,O(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!bt)return null;var u,a,c=jt(t);if(c||(t[Ot]=c=new Rt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=qt,r=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Lt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):kt(t)))}function Mt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Ft(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function qt(t,e){if(t.Y)return!0;if(bt)return Ft(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ft(t,e=new Nt(e,this))}function jt(t){return(t=t[Ot])instanceof Rt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==L(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function zt(){G.call(this),this.c=new Rt(this),(this.J=this).C=null}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Lt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(zt,G),zt.prototype[At]=!0,(S=zt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ht(o,r,!0,t)&&s;if(s=Ht(o=t.a=n,r,!0,t)&&s,s=Ht(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ht(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(zt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=k.JSON.stringify;function Kt(){this.b=this.a=null}var Yt,Xt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Zt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function Jt(t,e){var n;Yt||(n=k.Promise.resolve(void 0),Yt=function(){n.then(ee)}),$t||(Yt(),$t=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Kt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Xt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||k,this.f=M(this.Ya,this),this.g=q()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==L(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}j(ne,zt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ue,ae=(_(se=he,ue=oe=G),se.prototype=null===ue?Object.create(ue):(ce.prototype=ue.prototype,new ce),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){oe.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ce(){this.constructor=se}function he(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){G.call(this),this.b=t,this.a={}}j(fe,G);var le=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function ye(){this.a=!0}function ve(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),de(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var ge=null;function me(){return ge=ge||new zt}function we(t){Tt.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){Tt.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Te(t){Tt.call(this,"timingevent",t)}function Ne(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}j(we,Tt),j(Ee,Tt),j(Te,Tt);var _e={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Se.prototype.a=null;var Re,Le={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function xe(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Pe(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=Ve,t=ht?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(xe,Tt),j(Oe,Tt),j(Pe,Se),Re=new Pe;var Ve=45e3,Ue={},Me={};function Fe(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),Ge(t),t.l=tn(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ie(),u=!1),ve(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ue){t.h=4,Ie(),ve(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ve(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Ie(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ve(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),He(t))}function Ge(t){t.U=q()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(M(t.Ua,t),e)}function ze(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function He(t){0==t.g.v||t.A||ar(t.g,t)}function We(t){ze(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ur(p),Qn(p)}ir(p),Ie()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ne(M(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||ur(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Dn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,sn(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=lr(o,o.C?o.ga:null,o.fa),h.C?(kn(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(ze(f),Ge(f)),o.a=h):rr(o),0<p.g.length&&$n(p)):"stop"!=y[0]&&"close"!=y[0]||hr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?hr(p,7):Xn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);be()}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ce.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||be(),ze(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,c=this.m,h=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+c+"\n"+h+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ie(),We(this),He(this);break t}ve(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(je(this,e,i),ht&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ve(this.c,this.f,i,null),Ke(this,i)),4==e&&We(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,Ge(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),We(this),He(this)}}}catch(t){}var a,c,h,f,l,p,d},S.Va=function(){var t,e;this.a&&(t=Hn(this.a),e=this.a.$(),this.D<e.length&&(ze(this),je(this,t,e),this.b&&4!=t&&Ge(this)))},S.cancel=function(){this.A=!0,We(this)},S.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),We(this),this.h=2,He(this)):Be(this,this.U-n)},(S=Xe.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Qe(this),this.a.concat()},S.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},S.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new vn).c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new vn(null,this.a))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof vn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=cn(e,dn)),t.b=new vn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,yn)),t.join("")};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,yn=/#/g;function vn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Xe,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=En(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function wn(t,e){return gn(t),e=En(t,e),Ze(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),W(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||Nn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=vn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=H(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Nn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Ln(){}function xn(){this.a=new Ln}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t,e;if(this.c=Rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Pn=k.JSON.parse;function Cn(t){zt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}j(Cn,zt);var Vn="",Un=/^https?$/i,Mn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Bn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=Hn(t)||2!=t.X()))if(t.l&&4==Hn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Hn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Je)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Un.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){zn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new xn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Xn(t){var e,n;Zn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=q(),Ge(e)),fr(t)}function Qn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function Zn(t){Qn(t),t.j&&(k.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&$n(t)}function $n(t){_n(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Fe(n,r,e)}function er(t,n){t.f&&Ye({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Ye(t,function(t,e){var n=t;O(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ne(M(t.Aa,t),cr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,qe(n,t)}function ur(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ar(t,e){var n,r=null;if(t.a==e){ur(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,(i=me()).dispatchEvent(new Te(i)),$n(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ne(M(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||en(n,"https"),un(n)),i=n.toString(),o=r,u=new ye,k.Image?((s=new Image).onload=F(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=F(On,u,s,"TestLoadImage: error",!1,o),s.onabort=F(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=F(On,u,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),fr(t),Zn(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==Rn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof $e?tn(r):new $e(r,void 0);return""!=h.c?(e&&nn(h,e+"."+h.c),rn(h,h.h)):(o=(i=k.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new $e(null,void 0),o&&en(c,o),s&&nn(c,s),u&&rn(c,u),a&&(c.g=a),h=c),t.W&&tt(t.W,function(t,e){sn(h,e,t)}),e=t.A,n=t.na,e&&n&&sn(h,e,n),sn(h,"VER",t.ha),er(t,h),h}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function dr(){}function yr(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function vr(t,e){zt.call(this),this.a=new Yn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){xe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){Oe.call(this),this.status=1}function wr(t){this.a=t}(S=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(Re),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var i,o=new Xe(this.headers);r&&Ye(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=(i=this.a,at&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},S.Ta=function(){Gn(this)},S.X=function(){try{return 2<Hn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Yn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Wn(i,this.i,r),Dn(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||_n(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ne(M(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Qn(this),ir(this),Ie())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},yr.prototype.a=function(t,e){return new vr(t,e)},j(vr,zt),(S=vr.prototype).addEventListener=function(t,e,n,r){vr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){vr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=lr(t,null,t.fa),$n(t)},S.close=function(){Xn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Wt(t),Jn(this.a,e)):Jn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Xn(this.a),delete this.a,vr.S.G.call(this)},j(gr,xe),j(mr,Oe),j(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},yr.prototype.createWebChannel=yr.prototype.a,vr.prototype.send=vr.prototype.Pa,vr.prototype.open=vr.prototype.Oa,_e.NO_ERROR=0,_e.TIMEOUT=8,_e.HTTP_ERROR=6,Ae.COMPLETE="complete",(ke.EventType=Le).OPEN="a",Le.CLOSE="b",Le.ERROR="c",Le.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var br={createWebChannelTransport:function(){return new yr},ErrorCode:_e,EventType:Ae,WebChannel:ke,XhrIo:Cn},Er=br.createWebChannelTransport,Ir=br.ErrorCode,Tr=br.EventType,Nr=br.WebChannel,_r=br.XhrIo,Ar=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr=new p("@firebase/firestore");function kr(){return Dr.logLevel}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.DEBUG&&(e=n.map(Or),Dr.debug.apply(Dr,s(["Firestore (7.19.1): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.ERROR&&(e=n.map(Or),Dr.error.apply(Dr,s(["Firestore (7.19.1): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=l.WARN&&(e=n.map(Or),Dr.warn.apply(Dr,s(["Firestore (7.19.1): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw Lr(e),new Error(e)}function Cr(t){t||Pr()}var Vr=(Ur.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ur);function Ur(){}function Mr(t,e){return t<e?-1:e<t?1:0}function Fr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function qr(t){return t+"\0"}function jr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Gr=(Object.defineProperty(Br.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Br.prototype.isEqual=function(t){return t instanceof Br&&t.projectId===this.projectId&&t.database===this.database},Br.prototype.o=function(t){return Mr(this.projectId,t.projectId)||Mr(this.database,t.database)},Br);function Br(t,e){this.projectId=t,this.database=e||"(default)"}function zr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Wr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Kr,Yr,Xr,Qr=(pi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},pi.prototype.has=function(t){return void 0!==this.get(t)},pi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},pi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},pi.prototype.forEach=function(u){Hr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},pi.prototype._=function(){return Wr(this.l)},pi),Zr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Jr=(o(li,Xr=Error),li),$r=(fi.now=function(){return fi.fromMillis(Date.now())},fi.fromDate=function(t){return fi.fromMillis(t.getTime())},fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new fi(e,1e6*(t-1e3*e))},fi.prototype.toDate=function(){return new Date(this.toMillis())},fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},fi.prototype.T=function(t){return this.seconds===t.seconds?Mr(this.nanoseconds,t.nanoseconds):Mr(this.seconds,t.seconds)},fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},fi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},fi),ti=(hi.I=function(t){return new hi(t)},hi.min=function(){return new hi(new $r(0,0))},hi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},hi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},hi.prototype.A=function(){return this.timestamp},hi),ei=(Object.defineProperty(ci.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ci.prototype.isEqual=function(t){return 0===ci.P(this,t)},ci.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ci?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ci.prototype.limit=function(){return this.offset+this.length},ci.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ci.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ci.prototype.v=function(){return this.segments[this.offset]},ci.prototype.S=function(){return this.get(this.length-1)},ci.prototype.get=function(t){return this.segments[this.offset+t]},ci.prototype._=function(){return 0===this.length},ci.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ci.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},ci.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ci),ni=(o(ai,Yr=ei),ai.prototype.g=function(t,e,n){return new ai(t,e,n)},ai.prototype.F=function(){return this.N().join("/")},ai.prototype.toString=function(){return this.F()},ai.k=function(t){if(0<=t.indexOf("//"))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ai(t.split("/").filter(function(t){return 0<t.length}))},ai.$=function(){return new ai([])},ai),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=(o(ui,Kr=ei),ui.prototype.g=function(t,e,n){return new ui(t,e,n)},ui.O=function(t){return ri.test(t)},ui.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ui.O(t)||(t="`"+t+"`"),t}).join(".")},ui.prototype.toString=function(){return this.F()},ui.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},ui.L=function(){return new ui(["__name__"])},ui.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Jr(Zr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Jr(Zr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Jr(Zr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ui(e)},ui.$=function(){return new ui([])},ui),oi=(si.B=function(t){return new si(ni.k(t))},si.U=function(t){return new si(ni.k(t).V(5))},si.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},si.prototype.isEqual=function(t){return null!==t&&0===ni.P(this.path,t.path)},si.prototype.toString=function(){return this.path.toString()},si.P=function(t,e){return ni.P(t.path,e.path)},si.j=function(t){return t.length%2==0},si.K=function(t){return new si(new ni(t.slice()))},si);function si(t){this.path=t}function ui(){return null!==Kr&&Kr.apply(this,arguments)||this}function ai(){return null!==Yr&&Yr.apply(this,arguments)||this}function ci(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.R=n}function hi(t){this.timestamp=t}function fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Jr(Zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Jr(Zr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Jr(Zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Jr(Zr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function li(t,e){var n=this;return(n=Xr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function pi(t,e){this.h=t,this.u=e,this.l={}}function di(t){return null==t}function yi(t){return-0===t&&1/t==-1/0}function vi(t){return"number"==typeof t&&Number.isInteger(t)&&!yi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var gi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new gi(t,e,n,r,i,o,s)}function wi(t){var e,n=t;return null===n.G&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+Io(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),di(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=$u(n.startAt)),n.endAt&&(e+="|ub:",e+=$u(n.endAt)),n.G=e),n.G}function bi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!mo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ea(t.startAt,e.startAt)&&ea(t.endAt,e.endAt)}function Ei(t){return oi.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ii=(Ti.fromBase64String=function(t){return new Ti(atob(t))},Ti.fromUint8Array=function(t){return new Ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ti.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ti.prototype.Y=function(){return 2*this.H.length},Ti.prototype.o=function(t){return Mr(this.H,t.H)},Ti.prototype.isEqual=function(t){return this.H===t.H},Ti);function Ti(t){this.H=t}function Ni(t){this.count=t}Ii.J=new Ii("");var _i,Ai,Si=(Di.prototype.tt=function(t){return new Di(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Di.prototype.et=function(t,e){return new Di(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Di.prototype.nt=function(t){return new Di(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Di);function Di(t,e,n,r,i,o,s){void 0===i&&(i=ti.min()),void 0===o&&(o=ti.min()),void 0===s&&(s=Ii.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function ki(t){switch(t){case Zr.OK:return Pr(),0;case Zr.CANCELLED:case Zr.UNKNOWN:case Zr.DEADLINE_EXCEEDED:case Zr.RESOURCE_EXHAUSTED:case Zr.INTERNAL:case Zr.UNAVAILABLE:case Zr.UNAUTHENTICATED:return;case Zr.INVALID_ARGUMENT:case Zr.NOT_FOUND:case Zr.ALREADY_EXISTS:case Zr.PERMISSION_DENIED:case Zr.FAILED_PRECONDITION:case Zr.ABORTED:case Zr.OUT_OF_RANGE:case Zr.UNIMPLEMENTED:case Zr.DATA_LOSS:return 1;default:return Pr(),0}}function Ri(t){if(void 0===t)return Lr("GRPC error has no .code"),Zr.UNKNOWN;switch(t){case _i.OK:return Zr.OK;case _i.CANCELLED:return Zr.CANCELLED;case _i.UNKNOWN:return Zr.UNKNOWN;case _i.DEADLINE_EXCEEDED:return Zr.DEADLINE_EXCEEDED;case _i.RESOURCE_EXHAUSTED:return Zr.RESOURCE_EXHAUSTED;case _i.INTERNAL:return Zr.INTERNAL;case _i.UNAVAILABLE:return Zr.UNAVAILABLE;case _i.UNAUTHENTICATED:return Zr.UNAUTHENTICATED;case _i.INVALID_ARGUMENT:return Zr.INVALID_ARGUMENT;case _i.NOT_FOUND:return Zr.NOT_FOUND;case _i.ALREADY_EXISTS:return Zr.ALREADY_EXISTS;case _i.PERMISSION_DENIED:return Zr.PERMISSION_DENIED;case _i.FAILED_PRECONDITION:return Zr.FAILED_PRECONDITION;case _i.ABORTED:return Zr.ABORTED;case _i.OUT_OF_RANGE:return Zr.OUT_OF_RANGE;case _i.UNIMPLEMENTED:return Zr.UNIMPLEMENTED;case _i.DATA_LOSS:return Zr.DATA_LOSS;default:return Pr()}}(Ai=_i=_i||{})[Ai.OK=0]="OK",Ai[Ai.CANCELLED=1]="CANCELLED",Ai[Ai.UNKNOWN=2]="UNKNOWN",Ai[Ai.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ai[Ai.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ai[Ai.NOT_FOUND=5]="NOT_FOUND",Ai[Ai.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ai[Ai.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ai[Ai.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ai[Ai.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ai[Ai.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ai[Ai.ABORTED=10]="ABORTED",Ai[Ai.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ai[Ai.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ai[Ai.INTERNAL=13]="INTERNAL",Ai[Ai.UNAVAILABLE=14]="UNAVAILABLE",Ai[Ai.DATA_LOSS=15]="DATA_LOSS";var Li=(Vi.prototype.st=function(t,e){return new Vi(this.P,this.root.st(t,e,this.P).copy(null,null,Oi.it,null,null))},Vi.prototype.remove=function(t){return new Vi(this.P,this.root.remove(t,this.P).copy(null,null,Oi.it,null,null))},Vi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Vi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Vi.prototype._=function(){return this.root._()},Object.defineProperty(Vi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Vi.prototype.rt=function(){return this.root.rt()},Vi.prototype.ot=function(){return this.root.ot()},Vi.prototype.ht=function(t){return this.root.ht(t)},Vi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Vi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Vi.prototype.at=function(t){return this.root.at(t)},Vi.prototype.ut=function(){return new xi(this.root,null,this.P,!1)},Vi.prototype.ct=function(t){return new xi(this.root,t,this.P,!1)},Vi.prototype.lt=function(){return new xi(this.root,null,this.P,!0)},Vi.prototype._t=function(t){return new xi(this.root,t,this.P,!0)},Vi),xi=(Ci.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Ci.prototype.Tt=function(){return 0<this.dt.length},Ci.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Ci),Oi=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype._=function(){return!1},Pi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Pi.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Pi.prototype.min=function(){return this.left._()?this:this.left.min()},Pi.prototype.rt=function(){return this.min().key},Pi.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Pi.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},Pi.prototype.At=function(){if(this.left._())return Pi.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.At(),null)).It()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.Pt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.gt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.At())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.It()},Pi.prototype.Rt=function(){return this.color},Pi.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},Pi.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},Pi.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},Pi.prototype.yt=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.gt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Pi.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Pr();if(this.right.Rt())throw Pr();var t=this.left.vt();if(t!==this.right.vt())throw Pr();return t+(this.Rt()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Ci(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Vi(t,e){this.P=t,this.root=e||Oi.EMPTY}function Ui(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.it=!1,Oi.EMPTY=(Object.defineProperty(Ui.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ui.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Ui.prototype.copy=function(t,e,n,r,i){return this},Ui.prototype.st=function(t,e,n){return new Oi(t,e)},Ui.prototype.remove=function(t,e){return this},Ui.prototype._=function(){return!0},Ui.prototype.ht=function(t){return!1},Ui.prototype.at=function(t){return!1},Ui.prototype.rt=function(){return null},Ui.prototype.ot=function(){return null},Ui.prototype.Rt=function(){return!1},Ui.prototype.bt=function(){return!0},Ui.prototype.vt=function(){return 0},new Ui);var Mi=(Gi.prototype.has=function(t){return null!==this.data.get(t)},Gi.prototype.first=function(){return this.data.rt()},Gi.prototype.last=function(){return this.data.ot()},Object.defineProperty(Gi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Gi.prototype.indexOf=function(t){return this.data.indexOf(t)},Gi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Gi.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Gi.prototype.Dt=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},Gi.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},Gi.prototype.ut=function(){return new Fi(this.data.ut())},Gi.prototype.ct=function(t){return new Fi(this.data.ct(t))},Gi.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},Gi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Gi.prototype._=function(){return this.data._()},Gi.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Gi.prototype.isEqual=function(t){if(!(t instanceof Gi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(0!==this.P(r,i))return!1}return!0},Gi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Gi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Gi.prototype.copy=function(t){var e=new Gi(this.P);return e.data=t,e},Gi),Fi=(ji.prototype.wt=function(){return this.Ft.wt().key},ji.prototype.Tt=function(){return this.Ft.Tt()},ji),qi=new Li(oi.P);function ji(t){this.Ft=t}function Gi(t){this.P=t,this.data=new Li(this.P)}var Bi=new Li(oi.P),zi=new Li(oi.P),Hi=new Mi(oi.P);function Wi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Hi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ki=new Mi(Mr);function Yi(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r}function Xi(t,e){this.targetId=t,this.ne=e}function Qi(t,e,n,r){void 0===n&&(n=Ii.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Zi=(ho.xt=function(t){return new ho(t.P)},ho.prototype.has=function(t){return null!=this.kt.get(t)},ho.prototype.get=function(t){return this.kt.get(t)},ho.prototype.first=function(){return this.$t.rt()},ho.prototype.last=function(){return this.$t.ot()},ho.prototype._=function(){return this.$t._()},ho.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.$t.ht(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.ut(),n=t.$t.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(!r.isEqual(i))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.P=this.P,n.kt=t,n.$t=e,n},ho),Ji=(co.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);!n||0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):Pr()},co.prototype.Mt=function(){var n=[];return this.Ot.ht(function(t,e){n.push(e)}),n},co),$i=(ao.Qt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new ao(t,e,Zi.xt(e),i,n,r,!0,!1)},Object.defineProperty(ao.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&Iu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},ao),to=(uo.zt=function(t,e){var n=new Map;return n.set(t,eo.Ht(t,e)),new uo(ti.min(),n,Ki,qi,Wi())},uo),eo=(so.Ht=function(t,e){return new so(Ii.J,e,Wi(),Wi(),Wi())},so),no=(Object.defineProperty(oo.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(oo.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),oo.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},oo.prototype.le=function(){var n=Wi(),r=Wi(),i=Wi();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new eo(this.re,this.oe,n,r,i)},oo.prototype._e=function(){this.he=!1,this.ie=lo()},oo.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},oo.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},oo.prototype.we=function(){this.se+=1},oo.prototype.Te=function(){--this.se},oo.prototype.Ee=function(){this.he=!0,this.oe=!0},oo),ro=(io.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof ou?this.Ve(r,t.ee):t.ee instanceof su&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},io.prototype.pe=function(n){var r=this;this.be(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.Se(t)&&e.ce(n.resumeToken);break;case 1:e.Te(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.Te(),e.ae||r.removeTarget(t);break;case 3:r.Se(t)&&(e.Ee(),e.ce(n.resumeToken));break;case 4:r.Se(t)&&(r.De(t),e.ce(n.resumeToken));break;default:Pr()}})},io.prototype.be=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.Se(e)&&n(e)})},io.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ne.count,o=this.Ne(r);o&&(Ei(e=o.target)?0===i?(n=new oi(e.path),this.ye(r,n,new su(n,ti.min()))):Cr(1===i):this.Fe(r)!==i&&(this.De(r),this.Pe=this.Pe.add(r)))},io.prototype.ke=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.Ne(e);r&&(t.Yt&&Ei(r.target)&&(n=new oi(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ye(e,n,new su(n,i))),t.ue&&(s.set(e,t.le()),t._e()))});var r=Wi();this.Re.forEach(function(t,e){var n=!0;e.Dt(function(t){var e=o.Ne(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new to(i,s,this.Pe,this.Ae,r);return this.Ae=qi,this.Re=fo(),this.Pe=new Mi(Mr),t},io.prototype.Ve=function(t,e){var n;this.Se(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t)))},io.prototype.ye=function(t,e,n){var r;this.Se(t)&&(r=this.ve(t),this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n)))},io.prototype.removeTarget=function(t){this.me.delete(t)},io.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},io.prototype.we=function(t){this.ve(t).we()},io.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new no,this.me.set(t,e)),e},io.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new Mi(Mr),this.Re=this.Re.st(t,e)),e},io.prototype.Se=function(t){var e=null!==this.Ne(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},io.prototype.De=function(e){var n=this;this.me.set(e,new no),this.Ie.Oe(e).forEach(function(t){n.ye(e,t,null)})},io.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},io);function io(t){this.Ie=t,this.me=new Map,this.Ae=qi,this.Re=fo(),this.Pe=new Mi(Mr)}function oo(){this.se=0,this.ie=lo(),this.re=Ii.J,this.oe=!1,this.he=!0}function so(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}function uo(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}function ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}function co(){this.Ot=new Li(oi.P)}function ho(n){this.P=n?function(t,e){return n(t,e)||oi.P(t.key,e.key)}:function(t,e){return oi.P(t.key,e.key)},this.kt=Bi,this.$t=new Li(this.P)}function fo(){return new Li(oi.P)}function lo(){return new Li(oi.P)}function po(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function yo(t){var e=To(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?po(t)?4:10:Pr()}function mo(r,i){var t,e,n,o=go(r);if(o!==go(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yo(r).isEqual(yo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),n=To(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,_o(r.bytesValue).isEqual(_o(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,No((t=r).geoPointValue.latitude)===No(e.geoPointValue.latitude)&&No(t.geoPointValue.longitude)===No(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return No(t.integerValue)===No(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=No(t.doubleValue),r=No(e.doubleValue);return n===r?yi(n)===yi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Fr(r.arrayValue.values||[],i.arrayValue.values||[],mo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(zr(t)!==zr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!mo(t[n],e[n])))return!1;return!0}();default:return Pr()}}function wo(t,e){return void 0!==(t.values||[]).find(function(t){return mo(t,e)})}function bo(t,e){var n,r,i,o,s,u,a,c,h,f,l=go(t),p=go(e);if(l!==p)return Mr(l,p);switch(l){case 0:return 0;case 1:return Mr(t.booleanValue,e.booleanValue);case 2:return c=e,(h=No(t.integerValue||t.doubleValue))<(f=No(c.integerValue||c.doubleValue))?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return Eo(t.timestampValue,e.timestampValue);case 4:return Eo(yo(t),yo(e));case 5:return Mr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=_o(o),a=_o(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Mr(n[i],r[i]);if(0!==o)return o}return Mr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Mr(No(n.latitude),No(r.latitude)))?i:Mr(No(n.longitude),No(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=bo(n[i],r[i]);if(o)return o}return Mr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Mr(r[s],o[s]);if(0!==u)return u;var a=bo(n[r[s]],i[o[s]]);if(0!==a)return a}return Mr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function Eo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Mr(t,e);var n=To(t),r=To(e),i=Mr(n.seconds,r.seconds);return 0!==i?i:Mr(n.nanos,r.nanos)}function Io(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=To(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?_o(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,oi.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Pr();var t,e,n}(t)}function To(t){if(Cr(!!t),"string"!=typeof t)return{seconds:No(t.seconds),nanos:No(t.nanos)};var e,n=0,r=vo.exec(t);Cr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function No(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?Ii.fromBase64String(t):Ii.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function So(t){return t&&"integerValue"in t}function Do(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function Ro(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lo(t){return t&&"mapValue"in t}var xo={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Le=e};function Co(t){return{integerValue:""+t}}function Vo(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yi(e)?"-0":e}}function Uo(t,e){return vi(e)?Co(e):Vo(t,e)}function Mo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function qo(t){return Cr(!!t),ti.I((e=To(t),new $r(e.seconds,e.nanos)));var e}function jo(t,e){return new ni(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function Go(t){var e=ni.k(t);return Cr(is(e)),e}function Bo(t,e){return jo(t.s,e.path)}function zo(t,e){var n=Go(e);return Cr(n.get(1)===t.s.projectId),Cr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new oi(Yo(n))}function Ho(t,e){return jo(t.s,e)}function Wo(t){var e=Go(t);return 4===e.length?ni.$():Yo(e)}function Ko(t){return new ni(["projects",t.s.projectId,"databases",t.s.database]).F()}function Yo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Xo(t,e,n){return{name:Bo(t,e),fields:n.proto.mapValue.fields}}function Qo(t,e){var n,r,i,o;if(e instanceof Vs)n={update:Xo(t,e.key,e.value)};else if(e instanceof Ks)n={delete:Bo(t,e.key)};else if(e instanceof Us)n={update:Xo(t,e.key,e.data),updateMask:(r=e.qe,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof Gs)n={transform:{document:Bo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof cs)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof hs)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof ws)return{fieldPath:t.field.F(),increment:e.Be};throw Pr()})}};else{if(!(e instanceof Ys))return Pr();n={verify:Bo(t,e.key)}}return e.Qe.Ue||(n.currentDocument=void 0!==(o=e.Qe).updateTime?{updateTime:Mo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Pr()),n}function Zo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ss.updateTime(qo(n.updateTime)):void 0!==n.exists?Ss.exists(n.exists):Ss.We():Ss.We();if(t.update){t.update.name;var o=zo(e,t.update.name),s=new Xs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ts(r.map(function(t){return ii.q(t)})));return new Us(o,s,u,i)}return new Vs(o,s,i)}if(t.delete){var a=zo(e,t.delete);return new Ks(a,i)}if(t.transform){var c=zo(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),i=new cs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new hs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ys(r)):"increment"in e?i=new ws(t,e.increment):Pr();var o=ii.q(e.fieldPath);return new Ns(o,i)}(e,t)});return Cr(!0===i.exists),new Gs(c,h)}if(t.verify){var f=zo(e,t.verify);return new Ys(f,i)}return Pr()}function Jo(t,e){return{documents:[Ho(t,e.path)]}}function $o(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ho(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ho(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Ro(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ro(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:ns(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ns(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ns((e=t).field),direction:(n=e.dir,xo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||di(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=ts(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ts(e.endAt)),n}function ts(t){return{before:t.before,values:t.position}}function es(t){var e=!!t.before,n=t.values||[];return new Yu(n,e)}function ns(t){return{fieldPath:t.F()}}function rs(t){return ii.q(t.fieldPath)}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function os(){this.je=void 0}function ss(t,e){return t instanceof ws?So(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var us,as,cs=(o(ls,as=os),ls),hs=(o(fs,us=os),fs);function fs(t){var e=this;return(e=us.call(this)||this).elements=t,e}function ls(){return null!==as&&as.apply(this,arguments)||this}function ps(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return mo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(o(vs,ds=os),vs);function vs(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function gs(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!mo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ms,ws=(o(bs,ms=os),bs);function bs(t,e){var n=this;return(n=ms.call(this)||this).serializer=t,n.Be=e,n}function Es(t){return No(t.integerValue||t.doubleValue)}function Is(t){return Do(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ts=(_s.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},_s.prototype.isEqual=function(t){return Fr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},_s),Ns=function(t,e){this.field=t,this.transform=e};function _s(t){(this.fields=t).sort(ii.P)}function As(t,e){this.version=t,this.transformResults=e}var Ss=(Ds.We=function(){return new Ds},Ds.exists=function(t){return new Ds(void 0,t)},Ds.updateTime=function(t){return new Ds(t)},Object.defineProperty(Ds.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ds.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ds);function Ds(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof ou&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ou}function Rs(){}function Ls(t,e,n,r){return t instanceof Vs?function(t,e){if(!ks(t.Qe,e))return e;var n=Os(e);return new ou(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Us?function(t,e){if(!ks(t.Qe,e))return e;var n=Os(e),r=qs(t,e);return new ou(t.key,n,r,{Ge:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!ks(t.Qe,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof ou&&(y=n.field(p.field)),null===y&&r instanceof ou&&(y=r.field(p.field)),h.push((o=y,c=a=u=s=void 0,(i=d)instanceof cs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof hs?ps(i,o):i instanceof ys?gs(i,o):(a=Es(u=ss(s=i,o))+Es(s.Be),So(u)&&So(s.Be)?Co(a):Vo(s.serializer,a))))}return h}(t.fieldTransforms,n,e,r),s=zs(t,i.data(),o);return new ou(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,ks((i=t).Qe,o)?new su(i.key,ti.min()):o);var i,o}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||Fr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof hs&&o instanceof hs||i instanceof ys&&o instanceof ys?Fr(i.elements,o.elements,mo):i instanceof ws&&o instanceof ws?mo(i.Be,o.Be):i instanceof cs&&o instanceof cs);var n,r,i,o}))}function Os(t){return t instanceof ou?t.version:ti.min()}var Ps,Cs,Vs=(o(Fs,Cs=Rs),Fs),Us=(o(Ms,Ps=Rs),Ms);function Ms(t,e,n,r){var i=this;return(i=Ps.call(this)||this).key=t,i.data=e,i.qe=n,i.Qe=r,i.type=1,i}function Fs(t,e,n){var r=this;return(r=Cs.call(this)||this).key=t,r.value=e,r.Qe=n,r.type=0,r}function qs(t,e){return n=t,r=e instanceof ou?e.data():Xs.empty(),i=new Qs(r),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var js,Gs=(o(Bs,js=Rs),Bs);function Bs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Qe=Ss.exists(!0),n}function zs(t,e,n){for(var r=new Qs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Hs,Ws,Ks=(o(tu,Ws=Rs),tu),Ys=(o($s,Hs=Rs),$s),Xs=(Js.empty=function(){return new Js({mapValue:{}})},Js.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Lo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Js.prototype.isEqual=function(t){return mo(this.proto,t.proto)},Js),Qs=(Zs.prototype.set=function(t,e){return this.Je(t,e),this},Zs.prototype.delete=function(t){return this.Je(t,null),this},Zs.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Zs.prototype.ze=function(){var t=this.Xe(ii.$(),this.Ye);return null!=t?new Xs(t):this.He},Zs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=Lo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Zs);function Zs(t){void 0===t&&(t=Xs.empty()),this.He=t,this.Ye=new Map}function Js(t){this.proto=t}function $s(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Qe=e,n.type=4,n}function tu(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.Qe=e,n.type=3,n}function eu(t,e){this.key=t,this.version=e}var nu,ru,iu,ou=(o(hu,iu=eu),hu.prototype.field=function(t){return this.Ze.field(t)},hu.prototype.data=function(){return this.Ze},hu.prototype.tn=function(){return this.Ze.proto},hu.prototype.isEqual=function(t){return t instanceof hu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},hu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),hu),su=(o(cu,ru=eu),cu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu.prototype.isEqual=function(t){return t instanceof cu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},cu),uu=(o(au,nu=eu),au.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),au.prototype.isEqual=function(t){return t instanceof au&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},au);function au(){return null!==nu&&nu.apply(this,arguments)||this}function cu(t,e,n){var r=this;return(r=ru.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function hu(t,e,n,r){var i=this;return(i=iu.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function fu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Jr(Zr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Jr(Zr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var lu=(pu.prototype.on=function(t){return new pu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},pu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},pu.prototype.an=function(){return!di(this.limit)&&"F"===this.nn},pu.prototype.un=function(){return!di(this.limit)&&"L"===this.nn},pu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},pu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},pu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},pu);function pu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function du(t,e,n,r,i,o,s,u){return new lu(t,e,n,r,i,o,s,u)}function yu(t){return new lu(t)}function vu(t){return null!==t.collectionGroup}function gu(t){var e=fu(t,lu);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new na(n)),e.sn.push(new na(ii.L(),"asc"));else{for(var i,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.M()&&(o=!0)}o||(i=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new na(ii.L(),i)))}}return e.sn}function mu(t){var e=fu(t,lu);if(!e.rn)if("F"===e.nn)e.rn=mi(e.path,e.collectionGroup,gu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=gu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new na(o.field,s))}var u=e.endAt?new Yu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Yu(e.startAt.position,!e.startAt.before):null;e.rn=mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function wu(t,e,n){return new lu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bu(t,e){return new lu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function Eu(t,e){return new lu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function Iu(t,e){return bi(mu(t),mu(e))&&t.nn===e.nn}function Tu(t){return wi(mu(t))+"|lt:"+t.nn}function Nu(t){return"Query(target="+(n=(e=mu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+Io(e.value);var e}).join(", ")+"]"),di(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+$u(e.startAt)),e.endAt&&(n+=", endAt: "+$u(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function _u(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.W(r.collectionGroup)&&r.path.D(o):oi.j(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.M()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||ta(e.startAt,gu(e),n))&&(!e.endAt||!ta(e.endAt,gu(e),n)));var e,n,r,o}function Au(u){return function(t,e){for(var n=!1,r=0,i=gu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.M()?oi.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?bo(o,s):Pr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.M()}return 0}}var Su,Du=(o(ku,Su=function(){}),ku.create=function(t,e,n){if(t.M())return"in"===e||"not-in"===e?this.dn(t,e,n):new Ou(t,e,n);if(ko(n)){if("=="!==e&&"!="!==e)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ku(t,e,n)}if(Ro(n)){if("=="!==e&&"!="!==e)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ku(t,e,n)}return"array-contains"===e?new zu(t,n):"in"===e?new Hu(t,n):"not-in"===e?new Wu(t,n):"array-contains-any"===e?new Ku(t,n):new ku(t,e,n)},ku.dn=function(t,e,n){return new("in"===e?Pu:Cu)(t,n)},ku.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(bo(e,this.value)):null!==e&&go(this.value)===go(e)&&this.wn(bo(e,this.value))},ku.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},ku.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},ku);function ku(t,e,n){var r=this;return(r=Su.call(this)||this).field=t,r.op=e,r.value=n,r}var Ru,Lu,xu,Ou=(o(Mu,xu=Du),Mu.prototype.matches=function(t){var e=oi.P(t.key,this.key);return this.wn(e)},Mu),Pu=(o(Uu,Lu=Du),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Cu=(o(Vu,Ru=Du),Vu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Vu);function Vu(t,e){var n=this;return(n=Ru.call(this,t,"not-in",e)||this).keys=Fu(0,e),n}function Uu(t,e){var n=this;return(n=Lu.call(this,t,"in",e)||this).keys=Fu(0,e),n}function Mu(t,e,n){var r=this;return(r=xu.call(this,t,e,n)||this).key=oi.U(n.referenceValue),r}function Fu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return oi.U(t.referenceValue)})}var qu,ju,Gu,Bu,zu=(o(Ju,Bu=Du),Ju.prototype.matches=function(t){var e=t.field(this.field);return Do(e)&&wo(e.arrayValue,this.value)},Ju),Hu=(o(Zu,Gu=Du),Zu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&wo(this.value.arrayValue,e)},Zu),Wu=(o(Qu,ju=Du),Qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!wo(this.value.arrayValue,e)},Qu),Ku=(o(Xu,qu=Du),Xu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Do(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return wo(e.value.arrayValue,t)})},Xu),Yu=function(t,e){this.position=t,this.before=e};function Xu(t,e){return qu.call(this,t,"array-contains-any",e)||this}function Qu(t,e){return ju.call(this,t,"not-in",e)||this}function Zu(t,e){return Gu.call(this,t,"in",e)||this}function Ju(t,e){return Bu.call(this,t,"array-contains",e)||this}function $u(t){return(t.before?"b":"a")+":"+t.position.map(Io).join(",")}function ta(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.M()?oi.P(oi.U(s.referenceValue),n.key):bo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ea(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!mo(t.position[n],e.position[n]))return!1;return!0}var na=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ra=(wa.prototype.En=function(t,e,n){for(var r,i,o,s=n.In,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Vs?new ou(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Us?function(t,e,n){if(!ks(t.Qe,e))return new uu(t.key,n.version);var r=qs(t,e);return new ou(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof Gs?function(t,e,n){if(Cr(null!=n.transformResults),!ks(t.Qe,e))return new uu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof ou&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof hs?ps(i,o):i instanceof ys?gs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=zs(t,r.data(),i);return new ou(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new su(r.key,o.version,{hasCommittedMutations:!0}))}return e},wa.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ls(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ls(a,e,o,this.Tn))}return e},wa.prototype.An=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.mn(t.key,n.get(t.key));e&&(i=i.st(t.key,e))}),i},wa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Wi())},wa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Fr(this.mutations,t.mutations,xs)&&Fr(this.baseMutations,t.baseMutations,xs)},wa),ia=(ma.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=zi,i=t.mutations,o=0;o<i.length;o++)r=r.st(i[o].key,n[o].version);return new ma(t,e,n,r)},ma),oa=(ga.prototype.catch=function(t){return this.next(void 0,t)},ga.prototype.next=function(r,i){var o=this;return this.pn&&Pr(),this.pn=!0,this.yn?this.error?this.bn(i,this.error):this.vn(r,this.result):new ga(function(e,n){o.gn=function(t){o.vn(r,t).next(e,n)},o.Vn=function(t){o.bn(i,t).next(e,n)}})},ga.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ga.prototype.Dn=function(t){try{var e=t();return e instanceof ga?e:ga.resolve(e)}catch(t){return ga.reject(t)}},ga.prototype.vn=function(t,e){return t?this.Dn(function(){return t(e)}):ga.resolve(e)},ga.prototype.bn=function(t,e){return t?this.Dn(function(){return t(e)}):ga.reject(e)},ga.resolve=function(n){return new ga(function(t,e){t(n)})},ga.reject=function(n){return new ga(function(t,e){e(n)})},ga.Cn=function(t){return new ga(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ga.Nn=function(t){for(var n=ga.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ga.resolve(t):e()})}(r[e]);return n},ga.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Cn(i)},ga),sa=(Object.defineProperty(va.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),va.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},va.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},va.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?oa.resolve(n):this.qn(t,e)},va.prototype.getEntries=function(t,e){return this.Bn(t,e)},va.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},va.prototype.On=function(){},va),ua="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",aa=(ya.prototype.Wn=function(t){this.Qn.push(t)},ya.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},ya),ca=(da.prototype.Hn=function(e,n){var r=this;return this.Gn.Yn(e,n).next(function(t){return r.Jn(e,n,t)})},da.prototype.Jn=function(t,r,i){return this.Kn.Ln(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].mn(r,t);return t})},da.prototype.Xn=function(t,e,i){var o=qi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].mn(t,e);o=o.st(t,e)}),o},da.prototype.Zn=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ts(e,t)})},da.prototype.ts=function(r,i){var o=this;return this.Gn.es(r,i).next(function(t){var e=o.Xn(r,i,t),n=qi;return e.forEach(function(t,e){e=e||new su(t,ti.min()),n=n.st(t,e)}),n})},da.prototype.ns=function(t,e,n){return r=e,oi.j(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ss(t,e.path):vu(e)?this.rs(t,e,n):this.os(t,e,n);var r},da.prototype.ss=function(t,e){return this.Hn(t,new oi(e)).next(function(t){var e=Bi;return t instanceof ou&&(e=e.st(t.key,t)),e})},da.prototype.rs=function(n,r,i){var o=this,s=r.collectionGroup,u=Bi;return this.zn.hs(n,s).next(function(t){return oa.forEach(t,function(t){var e=r.on(t.child(s));return o.os(n,e,i).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},da.prototype.os=function(e,n,t){var h,f,r=this;return this.Kn.ns(e,n,t).next(function(t){return h=t,r.Gn.as(e,n)}).next(function(t){return f=t,r.us(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=Ls(s,a,a,r.Tn);h=c instanceof ou?h.st(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){_u(n,e)||(h=h.remove(t))}),h})},da.prototype.us=function(t,e,n){for(var r=Wi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Us&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ou&&(c=c.st(t,e))}),c})},da),ha=(pa._s=function(t,e){for(var n=Wi(),r=Wi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new pa(t,e.fromCache,n,r)},pa),fa=(la.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},la.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},la);function la(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}function pa(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}function da(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}function ya(){this.Qn=[]}function va(){this.Fn=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}function ga(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function ma(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}function wa(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function ba(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}fa.Es=-1;var Ea,Ia=(ka.prototype.reset=function(){this.gs=0},ka.prototype.ps=function(){this.gs=this.Ps},ka.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);0<i&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},ka.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},ka.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ka.prototype.vs=function(){return(Math.random()-.5)*this.gs},ka),Ta=(Da.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ca(window.indexedDB.deleteDatabase(t)).Sn()},Da.ks=function(){if("undefined"==typeof indexedDB)return!1;if(Da.$s())return!0;var t=y(),e=Da.Fs(t),n=0<e&&e<10,r=Da.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Da.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},Da.Ms=function(t,e){return t.store(e)},Da.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Da.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Da.prototype.Ls=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new _a("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Jr(Zr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new _a(e))},i.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Ns.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Rr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return o.qs(t)}),this.db)]}})})},Da.prototype.Bs=function(e){this.qs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Da.prototype.runTransaction=function(r,c,h){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Ls()];case 2:return a.db=t.sent(),e=La.open(a.db,s?"readonly":"readwrite",c),n=h(e).catch(function(t){return e.abort(t),oa.reject(t)}).Sn(),r={},n.catch(function(){}),[4,e.Us];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Rr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Da.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Da),Na=(Object.defineProperty(Sa.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(Sa.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),Sa.prototype.done=function(){this.Ws=!0},Sa.prototype.Gs=function(t){this.js=t},Sa.prototype.delete=function(){return Ca(this.Qs.delete())},Sa),_a=(o(Aa,Ea=Jr),Aa);function Aa(t){var e=this;return(e=Ea.call(this,Zr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Sa(t){this.Qs=t,this.Ws=!1,this.js=null}function Da(t,e,n){this.name=t,this.version=e,this.Ns=n,12.2===Da.Fs(y())&&Lr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}function Ra(t){return"IndexedDbTransactionError"===t.name}var La=(Pa.open=function(t,e,n){try{return new Pa(t.transaction(n,e))}catch(t){throw new _a(t)}},Object.defineProperty(Pa.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),Pa.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Pa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new xa(e)},Pa),xa=(Oa.prototype.put=function(t,e){return Ca(void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Oa.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ca(this.store.add(t))},Oa.prototype.get=function(e){var n=this;return Ca(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Rr("SimpleDb","GET",n.store.name,e,t),t})},Oa.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ca(this.store.delete(t))},Oa.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ca(this.store.count())},Oa.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},Oa.prototype.Js=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},Oa.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},Oa.prototype.ti=function(i){var t=this.cursor({});return new oa(function(n,r){t.onerror=function(t){var e=Ua(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Oa.prototype.Ys=function(t,s){var u=[];return new oa(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Na(i),(n=s(i.primaryKey,i.value,e))instanceof oa&&(r=n.catch(function(t){return e.done(),oa.reject(t)}),u.push(r)),e.yn?o():null===e.Ks?i.continue():i.continue(e.Ks)):o()}}).next(function(){return oa.Cn(u)})},Oa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Oa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Oa);function Oa(t){this.store=t}function Pa(t){var n=this;this.transaction=t,this.aborted=!1,this.zs=new ba,this.transaction.oncomplete=function(){n.zs.resolve()},this.transaction.onabort=function(){t.error?n.zs.reject(new _a(t.error)):n.zs.resolve()},this.transaction.onerror=function(t){var e=Ua(t.target.error);n.zs.reject(new _a(e))}}function Ca(t){return new oa(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ua(t.target.error);r(e)}})}var Va=!1;function Ua(t){var e=Ta.Fs(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Jr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Va||(Va=!0,setTimeout(function(){throw r},0)),r}}return t}function Ma(){return"undefined"!=typeof window?window:null}function Fa(){return"undefined"!=typeof document?document:null}var qa=(Ba.ri=function(t,e,n,r,i){var o=new Ba(t,e,Date.now()+n,r,i);return o.start(n),o},Ba.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},Ba.prototype.Cs=function(){return this.hi()},Ba.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new Jr(Zr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ba.prototype.hi=function(){var e=this;this.ei.ai(function(){return null!==e.oi?(e.clearTimeout(),e.op().then(function(t){return e.ii.resolve(t)})):Promise.resolve()})},Ba.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},Ba),ja=(Object.defineProperty(Ga.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),Ga.prototype.ai=function(t){this.enqueue(t)},Ga.prototype.mi=function(t){this.Ai(),this.Ri(t)},Ga.prototype.Pi=function(){var t;this.li||(this.li=!0,(t=Fa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei))},Ga.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},Ga.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai(function(){return e.Vi()})},Ga.prototype.Vi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ci.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return t.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Rr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ci.length&&this.Ti.bs(function(){return n.Vi()}),t.label=5;case 5:return[2]}})})},Ga.prototype.Ri=function(t){var r=this,e=this.ui.then(function(){return r.di=!0,t().catch(function(t){throw r.fi=t,r.di=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.di=!1,t})});return this.ui=e},Ga.prototype.Ss=function(t,e,n){var r=this;this.Ai(),-1<this.wi.indexOf(t)&&(e=0);var i=qa.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},Ga.prototype.Ai=function(){this.fi&&Pr()},Ga.prototype.pi=function(){},Ga.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ui];case 1:t.sent(),t.label=2;case 2:if(e!==this.ui)return[3,0];t.label=3;case 3:return[2]}})})},Ga.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},Ga.prototype.Si=function(r){var i=this;return this.bi().then(function(){i._i.sort(function(t,e){return t.ni-e.ni});for(var t=0,e=i._i;t<e.length;t++){var n=e[t];if(n.Cs(),"all"!==r&&n.ms===r)break}return i.bi()})},Ga.prototype.Di=function(t){this.wi.push(t)},Ga.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},Ga);function Ga(){var e=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new Ia(this,"async_queue_retry"),this.Ei=function(){var t=Fa();t&&Rr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ti.Ds()};var t=Fa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ei)}function Ba(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new ba,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}function za(t,e){if(Lr("AsyncQueue",e+": "+t),Ra(t))return new Jr(Zr.UNAVAILABLE,e+": "+t);throw t}function Ha(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Mr(n,i);return 0===s?Mr(r,o):s}var Wa=(Qa.prototype.Fi=function(){return++this.Ni},Qa.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Ha(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Qa.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Qa),Ka={$i:!1,xi:0,Oi:0,Mi:0},Ya=(Xa.Ui=function(t){return new Xa(t,Xa.Qi,Xa.Wi)},Xa);function Xa(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Qa(t){this.Ci=t,this.buffer=new Mi(Ha),this.Ni=0}Ya.ji=-1,Ya.Ki=1048576,Ya.Gi=41943040,Ya.Qi=10,Ya.Wi=1e3,Ya.zi=new Ya(Ya.Gi,Ya.Qi,Ya.Wi),Ya.Hi=new Ya(Ya.ji,0,0);var Za=(tc.prototype.start=function(t){this.Yi.params.Li!==Ya.ji&&this.Zi(t)},tc.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(tc.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),tc.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return Ra(e=t.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Sh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},tc),Ja=($a.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},$a.prototype.rr=function(t,e){var n=this;if(0===e)return oa.resolve(fa.Es);var r=new Wa(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},$a.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},$a.prototype.ar=function(t,e){return this.nr.ar(t,e)},$a.prototype.ur=function(e,n){var r=this;return this.params.Li===Ya.ji?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),oa.resolve(Ka)):this.cr(e).next(function(t){return t<r.params.Li?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Ka):r.lr(e,n)})},$a.prototype.cr=function(t){return this.nr.cr(t)},$a.prototype.lr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>h.params.Bi?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+t),h.params.Bi):t,s=Date.now(),h.rr(e,i)}).next(function(t){return r=t,u=Date.now(),h.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ar(e,r)}).next(function(t){return c=Date.now(),kr()<=l.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),oa.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},$a);function $a(t,e){this.nr=t,this.params=e}function tc(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}function ec(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=nc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return nc(o)}function nc(t){return t+""}function rc(t){var e=t.length;if(Cr(2<=e),2===e)return Cr(""===t.charAt(0)&&""===t.charAt(1)),ni.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new ni(r)}var ic=function(t){this._r=t};function oc(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=zo(n,r.name),s=qo(r.updateTime),u=new Xs({mapValue:{fields:r.fields}}),new ou(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=oi.K(e.noDocument.path),c=hc(e.noDocument.readTime);return new su(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=oi.K(e.unknownDocument.path),f=hc(e.unknownDocument.version);return new uu(h,f)}return Pr()}function sc(t,e,n){var r,i,o=uc(n),s=e.key.path.p().N();if(e instanceof ou){var u={name:Bo(r=t._r,(i=e).key),fields:i.tn().mapValue.fields,updateTime:Mo(r,i.version.A())},a=e.hasCommittedMutations;return new Bc(null,null,u,a,o,s)}if(e instanceof su){var c=e.key.path.N(),h=cc(e.version),f=e.hasCommittedMutations;return new Bc(null,new jc(c,h),null,f,o,s)}if(e instanceof uu){var l=e.key.path.N(),p=cc(e.version);return new Bc(new Gc(l,p),null,null,!0,o,s)}return Pr()}function uc(t){var e=t.A();return[e.seconds,e.nanoseconds]}function ac(t){var e=new $r(t[0],t[1]);return ti.I(e)}function cc(t){var e=t.A();return new xc(e.seconds,e.nanoseconds)}function hc(t){var e=new $r(t.seconds,t.nanoseconds);return ti.I(e)}function fc(e,t){var n=(t.baseMutations||[]).map(function(t){return Zo(e._r,t)}),r=t.mutations.map(function(t){return Zo(e._r,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new ra(t.batchId,i,n,r)}function lc(t){var e,n=hc(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?hc(t.lastLimboFreeSnapshotVersion):ti.min(),i=void 0!==t.query.documents?(Cr(1===(e=t.query).documents.length),mu(yu(Wo(e.documents[0])))):function(t){var e,n=Wo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Cr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rs(t.unaryFilter.field);return Du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rs(t.unaryFilter.field);return Du.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=rs(t.unaryFilter.field);return Du.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=rs(t.unaryFilter.field);return Du.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Du.create(rs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new na(rs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(h=di(c="object"==typeof(a=r.limit)?a.value:a)?null:c);var f=null;r.startAt&&(f=es(r.startAt));var l=null;return r.endAt&&(l=es(r.endAt)),mu(du(n,o,u,s,h,"F",f,l))}(t.query);return new Si(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ii.fromBase64String(t.resumeToken))}function pc(t,e){var n=cc(e.Z),r=cc(e.lastLimboFreeSnapshotVersion),i=(Ei(e.target)?Jo:$o)(t._r,e.target),o=e.resumeToken.toBase64();return new Hc(e.targetId,wi(e.target),n,o,e.sequenceNumber,r,i)}var dc=(yc.Tr=function(t,e,n,r){return Cr(""!==t.uid),new yc(t.Er()?t.uid:"",e,n,r)},yc.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mc(t).Zs({index:Mc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},yc.prototype.mr=function(d,y,v,g){var m=this,w=wc(d),b=mc(d);return b.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new ra(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Qo(e._r,t)}),o=r.mutations.map(function(t){return Qo(e._r,t)}),new Mc(n,r.batchId,r.Tn.toMillis(),i,o)),a=[],c=new Mi(function(t,e){return Mr(t.F(),e.F())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Fc.key(m.userId,l.key.path,t),c=c.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Fc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.zn.Ar(d,t))}),d.Wn(function(){m.wr[t]=s.keys()}),oa.Cn(a).next(function(){return s})})},yc.prototype.Rr=function(t,e){var n=this;return mc(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),fc(n.serializer,t)):null})},yc.prototype.Pr=function(t,n){var r=this;return this.wr[n]?oa.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},yc.prototype.gr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return mc(t).Zs({index:Mc.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=fc(r.serializer,e)),n.done()}).next(function(){return o})},yc.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return mc(t).Zs({index:Mc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},yc.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mc(t).Hs(Mc.userMutationsIndex,n).next(function(t){return t.map(function(t){return fc(e.serializer,t)})})},yc.prototype.Yn=function(u,a){var c=this,t=Fc.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return wc(u).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rc(i);if(r===c.userId&&a.path.isEqual(s))return mc(u).get(o).next(function(t){if(!t)throw Pr();Cr(t.userId===c.userId),h.push(fc(c.serializer,t))});n.done()}).next(function(){return h})},yc.prototype.es=function(r,t){var a=this,c=new Mi(Mr),i=[];return t.forEach(function(u){var t=Fc.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=wc(r).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rc(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),oa.Cn(i).next(function(){return a.pr(r,c)})},yc.prototype.as=function(t,e){var u=this,a=e.path,c=a.length+1,n=Fc.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new Mi(Mr);return wc(t).Zs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rc(i);r===u.userId&&a.D(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.pr(t,h)})},yc.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(mc(e).get(t).next(function(t){if(null===t)throw Pr();Cr(t.userId===n.userId),r.push(fc(n.serializer,t))}))}),oa.Cn(i).next(function(){return r})},yc.prototype.br=function(e,n){var r=this;return gc(e.vr,this.userId,n).next(function(t){return e.Wn(function(){r.Sr(n.batchId)}),oa.forEach(t,function(t){return r.dr.Dr(e,t)})})},yc.prototype.Sr=function(t){delete this.wr[t]},yc.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return oa.resolve();var e=IDBKeyRange.lowerBound(Fc.prefixForUser(o.userId)),i=[];return wc(n).Zs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=rc(t[1]),i.push(r)):n.done()}).next(function(){Cr(0===i.length)})})},yc.prototype.Nr=function(t,e){return vc(t,this.userId,e)},yc.prototype.Fr=function(t){var e=this;return bc(t).get(this.userId).next(function(t){return t||new Uc(e.userId,-1,"")})},yc);function yc(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}function vc(t,o,e){var n=Fc.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return wc(t).Zs({range:r,Xs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function gc(t,e,n){var r=t.store(Mc.store),i=t.store(Fc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Cr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Fc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return oa.Cn(o).next(function(){return c})}function mc(t){return fh.Ms(t,Mc.store)}function wc(t){return fh.Ms(t,Fc.store)}function bc(t){return fh.Ms(t,Uc.store)}var Ec,Ic=(Tc.prototype.xn=function(t,e,n){return _c(t).put(Ac(e),n)},Tc.prototype.Mn=function(t,e){var n=_c(t),r=Ac(e);return n.delete(r)},Tc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Tc.prototype.Ln=function(t,e){var n=this;return _c(t).get(Ac(e)).next(function(t){return n.$r(t)})},Tc.prototype.xr=function(t,e){var n=this;return _c(t).get(Ac(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:Sc(t)}:null})},Tc.prototype.getEntries=function(t,e){var r=this,i=qi;return this.Mr(t,e,function(t,e){var n=r.$r(e);i=i.st(t,n)}).next(function(){return i})},Tc.prototype.Lr=function(t,e){var r=this,i=qi,o=new Li(oi.P);return this.Mr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.st(t,n),o.st(t,Sc(e))):(i=i.st(t,null),o.st(t,0))}).next(function(){return{qr:i,Br:o}})},Tc.prototype.Mr=function(t,e,i){if(e._())return oa.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.ut(),s=o.wt();return _c(t).Zs({range:n},function(t,e,n){for(var r=oi.K(t);s&&oi.P(s,r)<0;)i(s,null),s=o.wt();s&&s.isEqual(r)&&(i(s,e),s=o.Tt()?o.wt():null),s?n.Gs(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Tt()?o.wt():null})},Tc.prototype.ns=function(t,i,e){var n,r,o,s=this,u=Bi,a=i.path.length+1,c={};return e.isEqual(ti.min())?(n=i.path.N(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=uc(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=Bc.collectionReadTimeIndex),_c(t).Zs(c,function(t,e,n){var r;t.length===a&&(r=oc(s.serializer,e),i.path.D(r.key.path)?r instanceof ou&&_u(i,r)&&(u=u.st(r.key,r)):n.done())}).next(function(){return u})},Tc.prototype.Ur=function(t,e){var r=this,i=qi,o=uc(e),n=_c(t),s=IDBKeyRange.lowerBound(o,!0);return n.Zs({index:Bc.readTimeIndex,range:s},function(t,e){var n=oc(r.serializer,e);i=i.st(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:ac(o)}})},Tc.prototype.Wr=function(t){var e=_c(t),r=ti.min();return e.Zs({index:Bc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ac(e.readTime)),n.done()}).next(function(){return r})},Tc.prototype.jr=function(t){return new Tc.Kr(this,!!t&&t.Gr)},Tc.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Tc.prototype.getMetadata=function(t){return Nc(t).get(zc.key).next(function(t){return Cr(!!t),t})},Tc.prototype.kr=function(t,e){return Nc(t).put(zc.key,e)},Tc.prototype.$r=function(t){if(t){var e=oc(this.serializer,t);return e instanceof su&&e.version.isEqual(ti.min())?null:e}return null},Tc);function Tc(t,e){this.serializer=t,this.zn=e}function Nc(t){return fh.Ms(t,zc.store)}function _c(t){return fh.Ms(t,Bc.store)}function Ac(t){return t.path.N()}function Sc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}function Dc(t,e){var n=this;return(n=Ec.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Qr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Ic.Kr=(o(Dc,Ec=sa),Dc.prototype.Un=function(s){var u=this,a=[],c=0,h=new Mi(function(t,e){return Mr(t.F(),e.F())});return this.Fn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=sc(u.Hr.serializer,e,u.readTime),h=h.add(t.path.p()),r=Sc(n),c+=r-o,a.push(u.Hr.xn(s,t,n))):(c-=o,u.Gr?(i=sc(u.Hr.serializer,new su(t,ti.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),h.forEach(function(t){a.push(u.Hr.zn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,c)),oa.Cn(a)},Dc.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},Dc.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},Dc);var kc=(Vc.prototype.Ar=function(t,e){return this.Jr.add(e),oa.resolve()},Vc.prototype.hs=function(t,e){return oa.resolve(this.Jr.getEntries(e))},Vc),Rc=(Cc.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Mi(ni.P),i=!r.has(n);return this.index[e]=r.add(n),i},Cc.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Cc.prototype.getEntries=function(t){return(this.index[t]||new Mi(ni.P)).N()},Cc),Lc=(Pc.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Cr(t<e&&0<=t&&e<=10);var o,s=new La(r);t<1&&1<=e&&(n.createObjectStore(Oc.store),(o=n).createObjectStore(Uc.store,{keyPath:Uc.keyPath}),o.createObjectStore(Mc.store,{keyPath:Mc.keyPath,autoIncrement:!0}).createIndex(Mc.userMutationsIndex,Mc.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Fc.store),Xc(n),n.createObjectStore(Bc.store));var u,a=oa.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Wc.store),u.deleteObjectStore(Hc.store),u.deleteObjectStore(Kc.store),Xc(n)),a=a.next(function(){return t=s.store(Kc.store),e=new Kc(0,0,ti.min().A(),0),t.put(Kc.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Mc.store).Hs().next(function(t){r.deleteObjectStore(Mc.store),r.createObjectStore(Mc.store,{keyPath:Mc.keyPath,autoIncrement:!0}).createIndex(Mc.userMutationsIndex,Mc.userMutationsKeyPath,{unique:!0});var e=i.store(Mc.store),n=t.map(function(t){return e.put(t)});return oa.Cn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Qc.store,{keyPath:Qc.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(zc.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Bc.store)).createIndex(Bc.readTimeIndex,Bc.readTimeIndexPath,{unique:!1}),t.createIndex(Bc.collectionReadTimeIndex,Bc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Pc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Bc.store).Zs(function(t,e){n+=Sc(e)}).next(function(){var t=new zc(n);return e.store(zc.store).put(zc.key,t)})},Pc.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Uc.store),e=r.store(Mc.store);return t.Hs().next(function(t){return oa.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Hs(Mc.userMutationsIndex,t).next(function(t){return oa.forEach(t,function(t){Cr(t.userId===n.userId);var e=fc(i.serializer,t);return gc(r,n.userId,e).next(function(){})})})})})},Pc.prototype.ensureSequenceNumbers=function(t){var s=t.store(Wc.store),e=t.store(Bc.store);return t.store(Kc.store).get(Kc.key).next(function(i){var o=[];return e.Zs(function(t,e){var n=new ni(t),r=[0,ec(n)];o.push(s.get(r).next(function(t){return t?oa.resolve():s.put(new Wc(0,ec(n),i.highestListenSequenceNumber))}))}).next(function(){return oa.Cn(o)})})},Pc.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:ec(n)})}}t.createObjectStore(Yc.store,{keyPath:Yc.keyPath});var i=e.store(Yc.store),o=new Rc;return e.store(Bc.store).Zs({Xs:!0},function(t,e){return r(new ni(t).p())}).next(function(){return e.store(Fc.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1];return r((t[2],rc(n)).p())})})},Pc.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Hc.store);return o.Zs(function(t,e){var n=lc(e),r=pc(i.serializer,n);return o.put(r)})},Pc),xc=function(t,e){this.seconds=t,this.nanoseconds=e},Oc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Pc(t){this.serializer=t}function Cc(){this.index={}}function Vc(){this.Jr=new Rc}Oc.store="owner",Oc.key="owner";var Uc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Uc.store="mutationQueues",Uc.keyPath="userId";var Mc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Mc.store="mutations",Mc.keyPath="batchId",Mc.userMutationsIndex="userMutationsIndex",Mc.userMutationsKeyPath=["userId","batchId"];var Fc=(qc.prefixForUser=function(t){return[t]},qc.prefixForPath=function(t,e){return[t,ec(e)]},qc.key=function(t,e,n){return[t,ec(e),n]},qc);function qc(){}Fc.store="documentMutations",Fc.PLACEHOLDER=new Fc;var jc=function(t,e){this.path=t,this.readTime=e},Gc=function(t,e){this.path=t,this.version=e},Bc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Bc.store="remoteDocuments",Bc.readTimeIndex="readTimeIndex",Bc.readTimeIndexPath="readTime",Bc.collectionReadTimeIndex="collectionReadTimeIndex",Bc.collectionReadTimeIndexPath=["parentPath","readTime"];var zc=function(t){this.byteSize=t};zc.store="remoteDocumentGlobal",zc.key="remoteDocumentGlobalKey";var Hc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Hc.store="targets",Hc.keyPath="targetId",Hc.queryTargetsIndexName="queryTargetsIndex",Hc.queryTargetsKeyPath=["canonicalId","targetId"];var Wc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Wc.store="targetDocuments",Wc.keyPath=["targetId","path"],Wc.documentTargetsIndex="documentTargetsIndex",Wc.documentTargetsKeyPath=["path","targetId"];var Kc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Kc.key="targetGlobalKey",Kc.store="targetGlobal";var Yc=function(t,e){this.collectionId=t,this.parent=e};function Xc(t){t.createObjectStore(Wc.store,{keyPath:Wc.keyPath}).createIndex(Wc.documentTargetsIndex,Wc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Hc.store,{keyPath:Hc.keyPath}).createIndex(Hc.queryTargetsIndexName,Hc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Kc.store)}Yc.store="collectionParents",Yc.keyPath=["collectionId","parent"];var Qc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Qc.store="clientMetadata",Qc.keyPath="clientId";var Zc=s(s(s([Uc.store,Mc.store,Fc.store,Bc.store,Hc.store,Oc.store,Kc.store,Wc.store],[Qc.store]),[zc.store]),[Yc.store]),Jc=($c.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return oa.resolve();var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:ec(i)};return th(t).put(o)},$c.prototype.hs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[qr(i),""],!1,!0);return th(t).Hs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(rc(r.parent))}return o})},$c);function $c(){this.Xr=new Rc}function th(t){return fh.Ms(t,Yc.store)}var eh=(ih.prototype.next=function(){return this.Zr+=2,this.Zr},ih.to=function(){return new ih(0)},ih.eo=function(){return new ih(-1)},ih),nh=(rh.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new eh(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},rh.prototype.ro=function(t){return this.so(t).next(function(t){return ti.I(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},rh.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},rh.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},rh.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},rh.prototype.lo=function(t,e){return this.uo(t,e)},rh.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return oh(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.io(e,t)})},rh.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return oh(r).Zs(function(t,e){var n=lc(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return oa.Cn(a)}).next(function(){return u})},rh.prototype.be=function(t,r){return oh(t).Zs(function(t,e){var n=lc(e);r(n)})},rh.prototype.so=function(t){return sh(t).get(Kc.key).next(function(t){return Cr(null!==t),t})},rh.prototype.io=function(t,e){return sh(t).put(Kc.key,e)},rh.prototype.uo=function(t,e){return oh(t).put(pc(this.serializer,e))},rh.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},rh.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},rh.prototype.wo=function(t,i){var e=wi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return oh(t).Zs({range:n,index:Hc.queryTargetsIndexName},function(t,e,n){var r=lc(e);bi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},rh.prototype.To=function(n,t,r){var i=this,o=[],s=uh(n);return t.forEach(function(t){var e=ec(t.path);o.push(s.put(new Wc(r,e))),o.push(i.dr.Eo(n,r,t))}),oa.Cn(o)},rh.prototype.Io=function(n,t,r){var i=this,o=uh(n);return oa.forEach(t,function(t){var e=ec(t.path);return oa.Cn([o.delete([r,e]),i.dr.mo(n,r,t)])})},rh.prototype.fo=function(t,e){var n=uh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},rh.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=uh(t),o=Wi();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=rc(t[1]),i=new oi(r);o=o.add(i)}).next(function(){return o})},rh.prototype.Nr=function(t,e){var n=ec(e.path),r=IDBKeyRange.bound([n],[qr(n)],!1,!0),i=0;return uh(t).Zs({index:Wc.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},rh.prototype.Me=function(t,e){return oh(t).get(e).next(function(t){return t?lc(t):null})},rh);function rh(t,e){this.dr=t,this.serializer=e}function ih(t){this.Zr=t}function oh(t){return fh.Ms(t,Hc.store)}function sh(t){return fh.Ms(t,Kc.store)}function uh(t){return fh.Ms(t,Wc.store)}var ah,ch="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hh=(o(ph,ah=aa),ph),fh=(lh.Ms=function(t,e){if(t instanceof hh)return Ta.Ms(t.vr,e);throw Pr()},lh.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Jr(Zr.FAILED_PRECONDITION,ch);return e.Oo(),e.Mo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new fa(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},lh.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},lh.prototype.Bo=function(n){var t=this;this.Fo.Bs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},lh.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},lh.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return yh(e).put(new Qc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Is.gi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(Ra(t))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Is.gi(function(){return n.Co(t)}),n.isPrimary=t})},lh.prototype.Qo=function(t){var e=this;return dh(t).get(Oc.key).next(function(t){return oa.resolve(e.Go(t))})},lh.prototype.zo=function(t){return yh(t).delete(this.clientId)},lh.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=lh.Ms(t,Qc.store);return r.Hs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return oa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},lh.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},lh.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},lh.prototype.Wo=function(e){var i=this;return this.Vo?oa.resolve(!0):dh(e).get(Oc.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new Jr(Zr.FAILED_PRECONDITION,ch);return!1}}return!(!i.networkEnabled||!i.inForeground)||yh(e).Hs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},lh.prototype.th=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Oc.store,Qc.store],function(t){var e=new hh(t,fa.Es);return n.jo(e).next(function(){return n.zo(e)})})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},lh.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},lh.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return yh(t).Hs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(lh.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),lh.prototype.oh=function(t){return dc.Tr(t,this.serializer,this.zn,this.dr)},lh.prototype.hh=function(){return this.ko},lh.prototype.ah=function(){return this.Kn},lh.prototype.uh=function(){return this.zn},lh.prototype.runTransaction=function(e,n,r){var i=this;Rr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Zc,function(t){return o=new hh(t,i.yo?i.yo.next():fa.Es),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw Lr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Is.gi(function(){return i.Co(!1)}),new Jr(Zr.FAILED_PRECONDITION,ua);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.jn(),t})},lh.prototype.lh=function(t){var e=this;return dh(t).get(Oc.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Jr(Zr.FAILED_PRECONDITION,ch)})},lh.prototype.Ko=function(t){var e=new Oc(this.clientId,this.allowTabSynchronization,Date.now());return dh(t).put(Oc.key,e)},lh.ks=function(){return Ta.ks()},lh.prototype.jo=function(t){var e=this,n=dh(t);return n.get(Oc.key).next(function(t){return e.Go(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(Oc.key)):oa.resolve()})},lh.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Lr("Detected an update time that is in the future: "+t+" > "+n),1))},lh.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},lh.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},lh.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},lh.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},lh.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Lr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},lh.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){Lr("Failed to set zombie client id.",t)}},lh.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},lh.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},lh);function lh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Is=i,this.window=o,this.document=s,this.Po=a,this.Vo=c,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!lh.ks())throw new Jr(Zr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new vh(this,r),this.No=e+"main",this.serializer=new ic(u),this.Fo=new Ta(this.No,10,new Lc(this.serializer)),this.ko=new nh(this.dr,this.serializer),this.zn=new Jc,this.Kn=new Ic(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===c&&Lr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function ph(t,e){var n=this;return(n=ah.call(this)||this).vr=t,n.Ro=e,n}function dh(t){return fh.Ms(t,Oc.store)}function yh(t){return fh.Ms(t,Qc.store)}var vh=(gh.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},gh.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},gh.prototype.be=function(t,e){return this.db.hh().be(t,e)},gh.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},gh.prototype.Eo=function(t,e,n){return mh(t,n)},gh.prototype.mo=function(t,e,n){return mh(t,n)},gh.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},gh.prototype.Dr=mh,gh.prototype.dh=function(t,e){return r=e,i=!1,bc(n=t).ti(function(t){return vc(n,t,r).next(function(t){return t&&(i=!0),oa.resolve(!t)})}).next(function(){return i});var n,r,i},gh.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.Ln(r,e).next(function(){return s.Mn(e),uh(r).delete([0,ec(e.path)])})}),u.push(n))}).next(function(){return oa.Cn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},gh.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},gh.prototype.wh=mh,gh.prototype.fh=function(t,o){var s,e=uh(t),u=fa.Es;return e.Zs({index:Wc.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==fa.Es&&o(new oi(rc(s)),u),u=i,s=r):u=fa.Es}).next(function(){u!==fa.Es&&o(new oi(rc(s)),u)})},gh.prototype.cr=function(t){return this.db.ah().zr(t)},gh);function gh(t,e){this.db=t,this.Yi=new Ja(this,e)}function mh(t,e){return uh(t).put((n=t.Ro,new Wc(0,ec(e.path),n)));var n}function wh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var bh=(Eh.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},Eh);function Eh(t,e,n){this.persistence=t,this.Th=e,this.Eh=new Li(Mr),this.Ih=new Qr(wi,bi),this.mh=ti.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new ca(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}function Ih(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Th(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,oa.resolve(n)):i.ko.no(e).next(function(t){return n=new Si(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(i.Eh=i.Eh.st(t.targetId,t),i.Ih.set(r,t.targetId)),t})}function Nh(o,s,u){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Eh.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.dr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ra(i=t.sent()))throw i;return Rr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Eh=e.Eh.remove(s),e.Ih.delete(n.target),[2]}})})}function _h(t,s,u){var a=t,c=ti.min(),h=Wi();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=mu(s),(void 0!==(o=(i=t).Ih.get(r))?oa.resolve(i.Eh.get(o)):i.ko.wo(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.ko.Ao(e,t.targetId).next(function(t){h=t})}).next(function(){return a.Th.ns(e,s,u?c:ti.min(),u?h:Wi())}).next(function(t){return{documents:t,gh:h}});var t,n,r,i,o})}function Ah(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Sh(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Zr.FAILED_PRECONDITION||e.message!==ua)throw e;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Dh=(Oh.prototype._=function(){return this.Vh._()},Oh.prototype.Eo=function(t,e){var n=new kh(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},Oh.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Oh.prototype.mo=function(t,e){this.Sh(new kh(t,e))},Oh.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Oh.prototype.Ch=function(t){var e=this,n=new oi(new ni([])),r=new kh(n,t),i=new kh(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},Oh.prototype.Nh=function(){var e=this;this.Vh.forEach(function(t){return e.Sh(t)})},Oh.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},Oh.prototype.Fh=function(t){var e=new oi(new ni([])),n=new kh(e,t),r=new kh(e,t+1),i=Wi();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},Oh.prototype.Nr=function(t){var e=new kh(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},Oh),kh=(xh.yh=function(t,e){return oi.P(t.key,e.key)||Mr(t.kh,e.kh)},xh.bh=function(t,e){return Mr(t.kh,e.kh)||oi.P(t.key,e.key)},xh),Rh=(Lh.prototype.Er=function(){return null!=this.uid},Lh.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},Lh.prototype.isEqual=function(t){return t.uid===this.uid},Lh);function Lh(t){this.uid=t}function xh(t,e){this.key=t,this.kh=e}function Oh(){this.Vh=new Mi(kh.yh),this.ph=new Mi(kh.bh)}function Ph(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}Rh.UNAUTHENTICATED=new Rh(null),Rh.xh=new Rh("google-credentials-uid"),Rh.Oh=new Rh("first-party-uid");var Ch,Vh,Uh,Mh=(rf.prototype.getToken=function(){return Promise.resolve(null)},rf.prototype.qh=function(){},rf.prototype.Bh=function(t){(this.Lh=t)(Rh.UNAUTHENTICATED)},rf.prototype.Uh=function(){this.Lh=null},rf),Fh=(nf.prototype.getToken=function(){var e=this,n=this.jh,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.jh!==n?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Ph(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},nf.prototype.qh=function(){this.forceRefresh=!0},nf.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},nf.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},nf.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Rh(t)},nf),qh=(Object.defineProperty(ef.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),ef),jh=(tf.prototype.getToken=function(){return Promise.resolve(new qh(this.Gh,this.zh))},tf.prototype.Bh=function(t){t(Rh.Oh)},tf.prototype.Uh=function(){},tf.prototype.qh=function(){},tf),Gh=($h.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},$h.prototype.na=function(){return 2===this.state},$h.prototype.start=function(){3!==this.state?this.auth():this.sa()},$h.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.ia=function(){this.state=0,this.Ti.reset()},$h.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,function(){return t.oa()}))},$h.prototype.ha=function(t){this.aa(),this.stream.send(t)},$h.prototype.oa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},$h.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},$h.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==e?this.Ti.reset():n&&n.code===Zr.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):n&&n.code===Zr.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ca(n)];case 1:return t.sent(),[2]}})})},$h.prototype.ua=function(){},$h.prototype.auth=function(){var n=this;this.state=1;var t=this.la(this.Zh),e=this.Zh;this.Xh.getToken().then(function(t){n.Zh===e&&n._a(t)},function(e){t(function(){var t=new Jr(Zr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fa(t)})})},$h.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ca(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$h.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},$h.prototype.fa=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$h.prototype.la=function(e){var n=this;return function(t){n.Is.ai(function(){return n.Zh===e?t():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$h),Bh=(o(Jh,Uh=Gh),Jh.prototype.da=function(t){return this.Jh.Ta("Listen",t)},Jh.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(Cr(void 0===i||"string"==typeof i),Ii.fromBase64String(i||"")):(Cr(void 0===i||i instanceof Uint8Array),Ii.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=new Qi(s,u,a,c&&(r=void 0===(n=c).code?Zr.UNKNOWN:Ri(n.code),new Jr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=zo(t,f.document.name),p=qo(f.document.updateTime),d=new Xs({mapValue:{fields:f.document.fields}}),y=new ou(l,p,d,{}),h=new Yi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=zo(t,v.document),m=v.readTime?qo(v.readTime):ti.min(),w=new su(g,m);h=new Yi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=zo(t,b.document);h=new Yi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Pr();e.filter;var I=e.filter;I.targetId;var T=new Ni(I.count||0);h=new Xi(I.targetId,T)}return h}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ti.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ti.min():qo(e.readTime)}(t);return this.listener.Ea(e,n)},Jh.prototype.Ia=function(t){var e,n,r,i,o={};o.database=Ko(this.serializer),o.addTarget=(e=this.serializer,(r=Ei(i=(n=t).target)?{documents:Jo(e,i)}:{query:$o(e,i)}).targetId=n.targetId,0<n.resumeToken.Y()&&(r.resumeToken=Fo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ha(o)},Jh.prototype.ma=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.ha(e)},Jh),zh=(o(Zh,Vh=Gh),Object.defineProperty(Zh.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),Zh.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,Vh.prototype.start.call(this)},Zh.prototype.ua=function(){this.Aa&&this.Pa([])},Zh.prototype.da=function(t){return this.Jh.Ta("Write",t)},Zh.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Cr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?qo(t.updateTime):qo(e);n.isEqual(ti.min())&&(n=qo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=qo(t.commitTime);return this.listener.ga(n,e)}var r,i;return Cr(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},Zh.prototype.ya=function(){var t={};t.database=Ko(this.serializer),this.ha(t)},Zh.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Qo(e.serializer,t)})};this.ha(n)},Zh),Hh=(o(Qh,Ch=function(){}),Qh.prototype.ba=function(){if(this.pa)throw new Jr(Zr.FAILED_PRECONDITION,"The client has already been terminated.")},Qh.prototype.va=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.va(e,n,r,t)}).catch(function(t){throw t.code===Zr.UNAUTHENTICATED&&i.credentials.qh(),t})},Qh.prototype.Sa=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.Sa(e,n,r,t)}).catch(function(t){throw t.code===Zr.UNAUTHENTICATED&&i.credentials.qh(),t})},Qh.prototype.terminate=function(){this.pa=!1},Qh),Wh=(Xh.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},Xh.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,1<=this.Ca&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},Xh.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},Xh.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},Xh.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(Lr(e),this.Fa=!1):Rr("OnlineStateTracker",e)},Xh.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},Xh),Kh=(Yh.prototype.start=function(){return this.enableNetwork()},Yh.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},Yh.prototype.iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yh.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},Yh.prototype.au=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),0<this.Ba.length&&(Rr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}})})},Yh.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},Yh.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},Yh.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},Yh.prototype.Me=function(t){return this.Ua.get(t)||null},Yh.prototype.Oe=function(t){return this.fu.Oe(t)},Yh.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},Yh.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},Yh.prototype.ou=function(){this.Qa=new ro(this),this.Ya.start(),this.Ha.ka()},Yh.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&0<this.Ua.size},Yh.prototype.Ga=function(){return 0===this.Wa.size},Yh.prototype.uu=function(){this.Qa=null},Yh.prototype.Ja=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.Ua.forEach(function(t,e){n.cu(t)}),[2]})})},Yh.prototype.Xa=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.uu(),this.ru()?(this.Ha.Oa(e),this.ou()):this.Ha.set("Unknown"),[2]})})},Yh.prototype.Za=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Ha.set("Online"),!(i instanceof Qi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.du(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.wu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Yi?this.Qa.ge(i):i instanceof Xi?this.Qa.Ce(i):this.Qa.pe(i),o.isEqual(ti.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ih(this.La)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Tu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.wu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Yh.prototype.wu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Ra(n))throw n;return this.Wa.add(1),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),r=r||function(){return Ih(e.La)},this.ei.gi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Yh.prototype.Eu=function(e){var n=this;return e().catch(function(t){return n.wu(t,e)})},Yh.prototype.Tu=function(r){var i=this,t=this.Qa.ke(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=i.Ua.get(e))&&i.Ua.set(e,n.et(t.resumeToken,r))}),t.jt.forEach(function(t){var e,n=i.Ua.get(t);n&&(i.Ua.set(t,n.et(Ii.J,n.Z)),i._u(t),e=new Si(n.target,t,1,n.sequenceNumber),i.cu(e))}),this.fu.Iu(t)},Yh.prototype.du=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fu.mu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Yh.prototype.hu=function(){return g(this,void 0,void 0,function(){var i,o,s;return w(this,function(t){switch(t.label){case 0:i=0<this.Ba.length?this.Ba[this.Ba.length-1].batchId:-1,t.label=1;case 1:if(!this.Au())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.La,n=i,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Gn.gr(t,n)}))];case 3:return null===(o=t.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(i=o.batchId,this.Ru(o),[3,6]);case 4:return s=t.sent(),[4,this.wu(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}var e,n,r})})},Yh.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},Yh.prototype.Vu=function(){return this.Ba.length},Yh.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},Yh.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&0<this.Ba.length},Yh.prototype.gu=function(){this.tu.start()},Yh.prototype.eu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.tu.ya(),[2]})})},Yh.prototype.su=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Ba;e<n.length;e++)r=n[e],this.tu.Pa(r.mutations);return[2]})})},Yh.prototype.ga=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Ba.shift(),n=ia.from(e,i,o),[4,this.Eu(function(){return r.fu.yu(n)})];case 1:return t.sent(),[4,this.hu()];case 2:return t.sent(),[2]}})})},Yh.prototype.nu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.tu.Ra?[4,this.pu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Pu()&&this.gu(),[2]}})})},Yh.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return ki(n=i.code)&&n!==Zr.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu(function(){return r.fu.bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.hu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Yh.prototype.za=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}})})},Yh.prototype.vu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ei.pi(),Rr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(e)];case 2:return t.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return t.sent(),[2]}})})},Yh.prototype.Su=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:t.sent(),this.Ha.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Yh);function Yh(t,e,n,r,i){var o,s,u,a,c,h,f,l,p=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new Wh(n,r),this.Ya=(c=this.qa,h=n,f={wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)},(l=c).ba(),new Bh(h,l.Jh,l.credentials,l.serializer,f)),this.tu=(o=this.qa,s=n,u={wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)},(a=o).ba(),new zh(s,a.Jh,a.credentials,a.serializer,u))}function Xh(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}function Qh(t,e,n){var r=this;return(r=Ch.call(this)||this).credentials=t,r.Jh=e,r.serializer=n,r.pa=!1,r}function Zh(t,e,n,r,i){var o=this;return(o=Vh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Aa=!1,o}function Jh(t,e,n,r,i){var o=this;return(o=Uh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $h(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new Ia(t,e)}function tf(t,e){this.Gh=t,this.zh=e}function ef(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Rh.Oh}function nf(t){var e=this;this.Qh=null,this.currentUser=Rh.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}function rf(){this.Lh=null}function of(t,e){return"firestore_clients_"+t+"_"+e}function sf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function uf(t,e){return"firestore_targets_"+t+"_"+e}function af(t){this.key=t}function cf(t){this.key=t}function hf(t,e,n){this.query=t,this.targetId=e,this.view=n}function ff(t){this.key=t,this.qc=!1}var lf=(kf.Du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Jr(r.error.code,r.error.message)),i?new kf(t,e,r.state,o):(Lr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},kf.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},kf),pf=(Df.Du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Jr(n.error.code,n.error.message)),r?new Df(t,n.state,i):(Lr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Df.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Df),df=(Sf.Du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki,o=0;r&&o<n.activeTargetIds.length;++o)r=vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Sf(t,i):(Lr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Sf),yf=(Af.Du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Af(e.clientId,e.onlineState):(Lr("SharedClientState","Failed to parse online state: "+t),null)},Af),vf=(_f.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},_f.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},_f.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},_f),gf=(Nf.ks=function(t){return!(!t||!t.localStorage)},Nf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.fu.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.ku&&(o=this.getItem(of(this.persistenceKey,i)))&&(s=df.Du(i,o))&&(this.Ou=this.Ou.st(s.clientId,s));for(this.ju(),(u=this.storage.getItem(this.Wu))&&(a=this.Ku(u))&&this.Gu(a),c=0,h=this.Mu;c<h.length;c++)f=h[c],this.xu(f);return this.Mu=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},Nf.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},Nf.prototype.zu=function(){return this.Hu(this.Ou)},Nf.prototype.Yu=function(n){var r=!1;return this.Ou.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Nf.prototype.Ju=function(t){this.Xu(t,"pending")},Nf.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},Nf.prototype.ec=function(t){var e,n,r="not-current";return this.Yu(t)&&(!(e=this.storage.getItem(uf(this.persistenceKey,t)))||(n=pf.Du(t,e))&&(r=n.state)),this.nc.Nu(t),this.ju(),r},Nf.prototype.sc=function(t){this.nc.Fu(t),this.ju()},Nf.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},Nf.prototype.rc=function(t){this.removeItem(uf(this.persistenceKey,t))},Nf.prototype.oc=function(t,e,n){this.hc(t,e,n)},Nf.prototype.ac=function(t,e,n){var r=this;e.forEach(function(t){r.tc(t)}),this.currentUser=t,n.forEach(function(t){r.Ju(t)})},Nf.prototype.uc=function(t){this.cc(t)},Nf.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},Nf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},Nf.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Nf.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Nf.prototype.xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Rr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Lu)return void Lr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.Bu.test(u.key)){if(null==u.newValue)return e=this.lc(u.key),[2,this._c(e,null)];if(n=this.fc(u.key,u.newValue))return[2,this._c(n.clientId,n)]}else if(this.Uu.test(u.key)){if(null!==u.newValue&&(r=this.dc(u.key,u.newValue)))return[2,this.wc(r)]}else if(this.Qu.test(u.key)){if(null!==u.newValue&&(i=this.Tc(u.key,u.newValue)))return[2,this.Ec(i)]}else if(u.key===this.Wu){if(null!==u.newValue&&(o=this.Ku(u.newValue)))return[2,this.Gu(o)]}else u.key===this.qu&&(s=function(t){var e=fa.Es;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){Lr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==fa.Es&&this.fs(s)}else this.Mu.push(u);return[2]})})})}},Object.defineProperty(Nf.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),Nf.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},Nf.prototype.Xu=function(t,e,n){var r=new lf(this.currentUser,t,e,n),i=sf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},Nf.prototype.tc=function(t){var e=sf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Nf.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},Nf.prototype.hc=function(t,e,n){var r=uf(this.persistenceKey,t),i=new pf(t,e,n);this.setItem(r,i.Cu())},Nf.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},Nf.prototype.fc=function(t,e){var n=this.lc(t);return df.Du(n,e)},Nf.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return lf.Du(new Rh(i),r,e)},Nf.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return pf.Du(r,e)},Nf.prototype.Ku=function(t){return yf.Du(t)},Nf.prototype.wc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fu.Ic(e.batchId,e.state,e.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Nf.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},Nf.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fu.Ac(s,u).then(function(){n.Ou=r})},Nf.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},Nf.prototype.Hu=function(t){var n=Ki;return t.forEach(function(t,e){n=n.Nt(e.activeTargetIds)}),n},Nf),mf=(Tf.prototype.Ju=function(t){},Tf.prototype.Zu=function(t,e,n){},Tf.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},Tf.prototype.oc=function(t,e,n){this.Pc[t]=e},Tf.prototype.sc=function(t){this.Rc.Fu(t)},Tf.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},Tf.prototype.rc=function(t){delete this.Pc[t]},Tf.prototype.zu=function(){return this.Rc.activeTargetIds},Tf.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},Tf.prototype.start=function(){return this.Rc=new vf,Promise.resolve()},Tf.prototype.ac=function(t,e,n){},Tf.prototype.uc=function(t){},Tf.prototype.th=function(){},Tf.prototype.Ts=function(t){},Tf),wf=(Object.defineProperty(If.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),If.prototype.Sc=function(t,e){var u=this,a=e?e.Dc:new Ji,c=e?e.bc:this.bc,h=e?e.qt:this.qt,f=c,l=!1,p=this.query.an()&&c.size===this.query.limit?c.last():null,d=this.query.un()&&c.size===this.query.limit?c.first():null;if(t.ht(function(t,e){var n=c.get(t),r=(r=e instanceof ou?e:null)&&(_u(u.query,r)?r:null),i=!!n&&u.qt.has(n.key),o=!!r&&(r.Ge||u.qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Cc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.pc(r,p)||d&&u.pc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),this.query.an()||this.query.un())for(;f.size>this.query.limit;){var n=this.query.an()?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{bc:f,Dc:a,Nc:l,qt:h}},If.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},If.prototype.Un=function(t,e,n){var o=this,r=this.bc;this.bc=t.bc,this.qt=t.qt;var i=t.Dc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==i.length||a?{snapshot:new $i(this.query,t.bc,r,i,t.qt,0==u,a,!1),$c:s}:{$c:s}},If.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new Ji,qt:this.qt,Nc:!1},!1)):{$c:[]}},If.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},If.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gc=e.gc.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gc=e.gc.delete(t)}),this.Yt=t.Yt)},If.prototype.kc=function(){var e=this;if(!this.Yt)return[];var n=this.yc;this.yc=Wi(),this.bc.forEach(function(t){e.Oc(t.key)&&(e.yc=e.yc.add(t.key))});var r=[];return n.forEach(function(t){e.yc.has(t)||r.push(new cf(t))}),this.yc.forEach(function(t){n.has(t)||r.push(new af(t))}),r},If.prototype.Mc=function(t){this.gc=t.gh,this.yc=Wi();var e=this.Sc(t.documents);return this.Un(e,!0)},If.prototype.Lc=function(){return $i.Qt(this.query,this.bc,this.qt,0===this.Vc)},If),bf=(Object.defineProperty(Ef.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),Ef.prototype.subscribe=function(t){this.Wc=t},Ef.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.nl("listen()"),(r=this.jc.get(s))?(e=r.targetId,this.Uc.ec(e),n=r.view.Lc(),[3,4]):[3,1];case 1:return[4,Th(this.La,mu(s))];case 2:return i=t.sent(),o=this.Uc.ec(i.targetId),e=i.targetId,[4,this.sl(s,e,"current"===o)];case 3:n=t.sent(),this.el&&this.Bc.listen(i),t.label=4;case 4:return[2,n]}})})},Ef.prototype.sl=function(u,a,c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,_h(this.La,u,!0)];case 1:return e=t.sent(),n=new wf(u,e.gh),r=n.Sc(e.documents),i=eo.Ht(a,c&&"Offline"!==this.onlineState),o=n.Un(r,this.el,i),this.il(a,o.$c),s=new hf(u,a,n),[2,(this.jc.set(u,s),this.Kc.has(a)?this.Kc.get(a).push(u):this.Kc.set(a,[u]),o.snapshot)]}})})},Ef.prototype.lu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.nl("unlisten()"),e=this.jc.get(i),1<(n=this.Kc.get(e.targetId)).length?[2,(this.Kc.set(e.targetId,n.filter(function(t){return!Iu(t,i)})),void this.jc.delete(i))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,Nh(this.La,e.targetId,!1).then(function(){r.Uc.rc(e.targetId),r.Bc.lu(e.targetId),r.rl(e.targetId)}).catch(Sh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,Nh(this.La,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Ef.prototype.write=function(s,u){return g(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:this.nl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.La,c=s,f=e,l=$r.now(),n=c.reduce(function(t,e){return t.add(e.key)},Wi()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Zn(a,n).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof Gs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ou?t.field(i.field):void 0,s=ss(i.transform,o||null);null!=s&&(e=null==e?(new Qs).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Us(o.key,s,function u(t){var a=[];return Hr(t.fields||{},function(t,e){var n=new ii([t]);if(Lo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ts(a)}(s.proto.mapValue),Ss.exists(!0)))}return f.Gn.mr(a,l,n,c)})}).then(function(t){var e=t.An(h);return{batchId:t.batchId,Fn:e}}))];case 2:return r=t.sent(),this.Uc.Ju(r.batchId),this.ol(r.batchId,u),[4,this.hl(r.Fn)];case 3:return t.sent(),[4,this.Bc.hu()];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),o=za(i,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,c,h,f,l,n})})},Ef.prototype.Iu=function(i){return g(this,void 0,void 0,function(){var n,r=this;return w(this,function(t){switch(t.label){case 0:this.nl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,h=e,f=(s=i).Z,l=h.Eh,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Ah.jr({Gr:!0});l=h.Eh;var c=[];s.Wt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.ko.Io(a,t.Zt,e).next(function(){return h.ko.To(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(r=u.et(n,f).tt(a.Ro),l=l.st(e,r),i=u,s=t,Cr(0<(o=r).resumeToken.Y()),(0===i.resumeToken.Y()||3e8<=o.Z.m()-i.Z.m()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&c.push(h.ko.lo(a,r))))});var t,o=qi,n=Wi();return s.Kt.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Kt.forEach(function(t,e){var n=r.get(t);e instanceof su&&e.version.isEqual(ti.min())?(i.Mn(t,f),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,f),o=o.st(t,e)):Rr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Gt.has(t)&&c.push(h.persistence.dr.wh(a,t))})})),f.isEqual(ti.min())||(t=h.ko.ro(a).next(function(t){return h.ko.ho(a,a.Ro,f)}),c.push(t)),oa.Cn(c).next(function(){return i.apply(a)}).next(function(){return h.Rh.ts(a,o)})}).then(function(t){return h.Eh=l,t}))];case 2:return n=t.sent(),i.Wt.forEach(function(t,e){var n=r.Hc.get(e);n&&(Cr(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.qc=!0:0<t.Xt.size?Cr(n.qc):0<t.Zt.size&&(Cr(n.qc),n.qc=!1))}),[4,this.hl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,h,f,l})})},Ef.prototype.xc=function(r,t){var i;(this.el&&0===t||!this.el&&1===t)&&(this.nl("applyOnlineStateChange()"),i=[],this.jc.forEach(function(t,e){var n=e.view.xc(r);n.snapshot&&i.push(n.snapshot)}),this.Wc.al(r),this.Wc.Ea(i),this.onlineState=r,this.el&&this.Uc.uc(r))},Ef.prototype.mu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(u,"rejected",a),e=this.Hc.get(u),(n=e&&e.key)?(r=(r=new Li(oi.P)).st(n,new su(n,ti.min())),i=Wi().add(n),o=new to(ti.min(),new Map,new Mi(Mr),r,i),[4,this.Iu(o)]):[3,2];case 1:return t.sent(),this.zc=this.zc.remove(n),this.Hc.delete(u),this.ul(),[3,4];case 2:return[4,Nh(this.La,u,!1).then(function(){return s.rl(u,a)}).catch(Sh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Ef.prototype.yu=function(i){return g(this,void 0,void 0,function(){var n,r;return w(this,function(t){switch(t.label){case 0:this.nl("applySuccessfulWrite()"),n=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,h=i,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=h.batch.keys(),n=f.Ah.jr({Gr:!0}),r=f,o=t,s=n,u=(i=h).batch,a=u.keys(),c=oa.resolve();return a.forEach(function(r){c=c.next(function(){return s.Ln(o,r)}).next(function(t){var e=t,n=i.Pn.get(r);Cr(null!==n),(!e||e.version.o(n)<0)&&(e=u.En(r,e,i))&&s.xn(e,i.Rn)})}),c.next(function(){return r.Gn.br(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Gn.Cr(t)}).next(function(){return f.Rh.Zn(t,e)})}))];case 2:return r=t.sent(),this.cl(n,null),this.ll(n),this.Uc.Zu(n,"acknowledged"),[4,this.hl(r)];case 3:return t.sent(),[3,6];case 4:return[4,Sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})},Ef.prototype.bu=function(o,s){return g(this,void 0,void 0,function(){var n;return w(this,function(t){switch(t.label){case 0:this.nl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,r=o,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Gn.Rr(e,r).next(function(t){return Cr(null!==t),n=t.keys(),i.Gn.br(e,t)}).next(function(){return i.Gn.Cr(e)}).next(function(){return i.Rh.Zn(e,n)})}))];case 2:return n=t.sent(),this.cl(o,s),this.ll(o),this.Uc.Zu(o,"rejected",s),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})},Ef.prototype._l=function(u){return g(this,void 0,void 0,function(){var r,i,o,s;return w(this,function(t){switch(t.label){case 0:this.Bc.Ga()||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.La,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.Gn.Vr(t)}))];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=this.Xc.get(r)||[]).push(u),this.Xc.set(r,i),[3,4]);case 3:return o=t.sent(),s=za(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},Ef.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach(function(t){t.resolve()}),this.Xc.delete(t)},Ef.prototype.fl=function(e){this.Xc.forEach(function(t){t.forEach(function(t){t.reject(new Jr(Zr.CANCELLED,e))})}),this.Xc.clear()},Ef.prototype.ol=function(t,e){var n=(n=(n=this.Jc[this.currentUser.$h()])||new Li(Mr)).st(t,e);this.Jc[this.currentUser.$h()]=n},Ef.prototype.cl=function(t,e){var n,r=this.Jc[this.currentUser.$h()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Jc[this.currentUser.$h()]=r)},Ef.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach(function(t){n.Yc.Nr(t)||n.wl(t)})},Ef.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},Ef.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof af?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof cf?(Rr("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):Pr()}},Ef.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(Rr("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},Ef.prototype.ul=function(){for(;0<this.Gc.length&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new ff(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new Si(mu(yu(t.path)),e,2,fa.Es))}},Ef.prototype.El=function(){return this.zc},Ef.prototype.Il=function(){return this.Gc},Ef.prototype.hl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.jc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Sc(r);return n.Nc?_h(u.La,i.query,!1).then(function(t){var e=t.documents;return i.view.Sc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.Un(t,u.el,n);u.il(i.targetId,r.$c),r.snapshot&&(u.el&&u.Uc.oc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=ha._s(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Wc.Ea(o),[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return oa.forEach(f,function(e){return oa.forEach(e.cs,function(t){return r.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return oa.forEach(e.ls,function(t){return r.persistence.dr.mo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Rr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Eh.get(s),a=u.Z,c=u.nt(a),r.Eh=r.Eh.st(s,c));return[2]}})})}(this.La,s)];case 2:return t.sent(),[2]}})})},Ef.prototype.nl=function(t){},Ef.prototype.vu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Rr("SyncEngine","User change. New user:",n.$h()),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Gn,m=e.Rh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Gn.yr(v).next(function(t){return g=t,n=e.persistence.oh(o),m=new ca(e.Ah,n,e.persistence.uh()),n.yr(v)}).next(function(t){for(var e=[],n=[],r=Wi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zn(v,r).next(function(t){return{ml:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.Gn=n,e.Rh=m,e.Th.Ph(e.Rh),r)]}})})}(this.La,n)]);case 1:return e=t.sent(),this.currentUser=n,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(n,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Ef.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return Wi().add(e.key);var n=Wi(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.jc.get(s),n=n.Nt(u.view.vc);return n},Ef);function Ef(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new Qr(Tu,Iu),this.Kc=new Map,this.Gc=[],this.zc=new Li(oi.P),this.Hc=new Map,this.Yc=new Dh,this.Jc={},this.Xc=new Map,this.Zc=eh.eo(),this.onlineState="Unknown",this.tl=void 0}function If(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=Wi(),this.qt=Wi(),this.pc=Au(t),this.bc=new Zi(this.pc)}function Tf(){this.Rc=new vf,this.Pc={},this.Da=null,this.fs=null}function Nf(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new Li(Mr),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=of(this.persistenceKey,this.ku),this.qu="firestore_sequence_number_"+this.persistenceKey,this.Ou=this.Ou.st(this.ku,new vf),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.$u)}function _f(){this.activeTargetIds=Ki}function Af(t,e){this.clientId=t,this.onlineState=e}function Sf(t,e){this.clientId=t,this.activeTargetIds=e}function Df(t,e,n){this.targetId=t,this.state=e,this.error=n}function kf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Rf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Kc.get(s))&&0!==a.length?[4,Th(e.La,mu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.jc.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,_h((e=i).La,o.query,!0)];case 1:return n=t.sent(),r=o.view.Mc(n),[2,(e.el&&e.il(o.targetId,r.$c),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Ah(e.La,s)];case 8:return d=t.sent(),[4,Th(e.La,d)];case 9:return u=t.sent(),[4,e.sl(Lf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Wc.Ea(r),n)]}})})}function Lf(t){return du(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function xf(){this.Pl=void 0,this.listeners=[]}var Of,Pf=(Bf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new xf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.fu.listen(e)];case 2:return i.Pl=t.sent(),[3,4];case 3:return o=t.sent(),s=za(o,"Initialization of query '"+Nu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(u),u.xc(this.onlineState),r.Pl&&u.yl(r.Pl)&&this.pl(),[2]}})})},Bf.prototype.lu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.gl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]})})},Bf.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},Bf.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},Bf.prototype.al=function(i){this.onlineState=i;var o=!1;this.gl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xc(i)&&(o=!0)}),o&&this.pl()},Bf.prototype.bl=function(t){this.Vl.add(t),t.next()},Bf.prototype.vl=function(t){this.Vl.delete(t)},Bf.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},Bf),Cf=(Gf.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $i(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},Gf.prototype.onError=function(t){this.Sl.error(t)},Gf.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},Gf.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},Gf.prototype.Nl=function(t){if(0<t.docChanges.length)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},Gf.prototype.kl=function(t){t=$i.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},Gf),Vf=(jf.prototype.Ph=function(t){this.xl=t},jf.prototype.ns=function(e,r,i,o){var s=this;return r.hn()||i.isEqual(ti.min())?this.Ol(e,r):this.xl.Zn(e,o).next(function(t){var n=s.Ml(r,t);return(r.an()||r.un())&&s.Nc(r.nn,n,o,i)?s.Ol(e,r):(kr()<=l.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nu(r)),s.xl.ns(e,r,i).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},jf.prototype.Ml=function(n,t){var r=new Mi(Au(n));return t.forEach(function(t,e){e instanceof ou&&_u(n,e)&&(r=r.add(e))}),r},jf.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},jf.prototype.Ol=function(t,e){return kr()<=l.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Nu(e)),this.xl.ns(t,e,ti.min())},jf),Uf=(qf.prototype.Ir=function(t){return oa.resolve(0===this.Gn.length)},qf.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,0<this.Gn.length&&this.Gn[this.Gn.length-1];var o=new ra(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new kh(a.key,i)),this.zn.Ar(t,a.key.path.p())}return oa.resolve(o)},qf.prototype.Rr=function(t,e){return oa.resolve(this.Bl(e))},qf.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return oa.resolve(this.Gn.length>i?this.Gn[i]:null)},qf.prototype.Vr=function(){return oa.resolve(0===this.Gn.length?-1:this.Ll-1)},qf.prototype.yr=function(t){return oa.resolve(this.Gn.slice())},qf.prototype.Yn=function(t,e){var n=this,r=new kh(e,0),i=new kh(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),oa.resolve(o)},qf.prototype.es=function(t,e){var r=this,i=new Mi(Mr);return e.forEach(function(t){var e=new kh(t,0),n=new kh(t,Number.POSITIVE_INFINITY);r.ql.St([e,n],function(t){i=i.add(t.kh)})}),oa.resolve(this.Ql(i))},qf.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;oi.j(i)||(i=i.child(""));var o=new kh(new oi(i),0),s=new Mi(Mr);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),oa.resolve(this.Ql(s))},qf.prototype.Ql=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Bl(t);null!==e&&r.push(e)}),r},qf.prototype.br=function(n,r){var i=this;Cr(0===this.Wl(r.batchId,"removed")),this.Gn.shift();var o=this.ql;return oa.forEach(r.mutations,function(t){var e=new kh(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.ql=o})},qf.prototype.Sr=function(t){},qf.prototype.Nr=function(t,e){var n=new kh(e,0),r=this.ql.Ct(n);return oa.resolve(e.isEqual(r&&r.key))},qf.prototype.Cr=function(t){return this.Gn.length,oa.resolve()},qf.prototype.Wl=function(t,e){return this.Ul(t)},qf.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},qf.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},qf),Mf=(Ff.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},Ff.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ff.prototype.Ln=function(t,e){var n=this.docs.get(e);return oa.resolve(n?n.Or:null)},Ff.prototype.getEntries=function(t,e){var n=this,r=qi;return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),oa.resolve(r)},Ff.prototype.ns=function(t,e,n){for(var r=Bi,i=new oi(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof ou&&_u(e,c)&&(r=r.st(c.key,c))}return oa.resolve(r)},Ff.prototype.Kl=function(t,e){return oa.forEach(this.docs,function(t){return e(t)})},Ff.prototype.jr=function(t){return new Ff.Kr(this)},Ff.prototype.zr=function(t){return oa.resolve(this.size)},Ff);function Ff(t,e){this.zn=t,this.jl=e,this.docs=new Li(oi.P),this.size=0}function qf(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new Mi(kh.yh)}function jf(){}function Gf(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}function Bf(t){this.fu=t,this.gl=new Qr(Tu,Iu),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}function zf(t){var e=this;return(e=Of.call(this)||this).Hr=t,e}Mf.Kr=(o(zf,Of=sa),zf.prototype.Un=function(n){var r=this,i=[];return this.Fn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),oa.Cn(i)},zf.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},zf.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},zf);var Hf,Wf,Kf=(hl.prototype.be=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),oa.resolve()},hl.prototype.ro=function(t){return oa.resolve(this.lastRemoteSnapshotVersion)},hl.prototype.oo=function(t){return oa.resolve(this.zl)},hl.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),oa.resolve(this.highestTargetId)},hl.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),oa.resolve()},hl.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new eh(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},hl.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,oa.resolve()},hl.prototype.lo=function(t,e){return this.uo(e),oa.resolve()},hl.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),--this.targetCount,oa.resolve()},hl.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gl.delete(t),u.push(o.fo(n,e.targetId)),s++)}),oa.Cn(u).next(function(){return s})},hl.prototype.do=function(t){return oa.resolve(this.targetCount)},hl.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return oa.resolve(n)},hl.prototype.To=function(t,e,n){return this.Hl.vh(e,n),oa.resolve()},hl.prototype.Io=function(e,t,n){this.Hl.Dh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),oa.Cn(i)},hl.prototype.fo=function(t,e){return this.Hl.Ch(e),oa.resolve()},hl.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return oa.resolve(n)},hl.prototype.Nr=function(t,e){return oa.resolve(this.Hl.Nr(e))},hl),Yf=(cl.prototype.start=function(){return Promise.resolve()},cl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(cl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),cl.prototype.Bo=function(){},cl.prototype.Uo=function(){},cl.prototype.uh=function(){return this.zn},cl.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new Uf(this.zn,this.dr),this.Jl[t.$h()]=e),e},cl.prototype.hh=function(){return this.ko},cl.prototype.ah=function(){return this.Kn},cl.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new Xf(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},cl.prototype.e_=function(e,n){return oa.Nn(Object.values(this.Jl).map(function(t){return function(){return t.Nr(e,n)}}))},cl),Xf=(o(al,Wf=aa),al),Qf=(ul.i_=function(t){return new ul(t)},Object.defineProperty(ul.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw Pr()},enumerable:!1,configurable:!0}),ul.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),oa.resolve()},ul.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),oa.resolve()},ul.prototype.Dr=function(t,e){return this.r_.add(e.toString()),oa.resolve()},ul.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},ul.prototype.Zl=function(){this.s_=new Set},ul.prototype.t_=function(n){var r=this,i=this.persistence.ah().jr();return oa.forEach(this.r_,function(t){var e=oi.B(t);return r.o_(n,e).next(function(t){t||i.Mn(e)})}).next(function(){return r.s_=null,i.apply(n)})},ul.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},ul.prototype.Xl=function(t){return 0},ul.prototype.o_=function(t,e){var n=this;return oa.Nn([function(){return oa.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},ul),Zf=(sl.prototype.wa=function(t){this.u_=t},sl.prototype.ca=function(t){this.c_=t},sl.prototype.onMessage=function(t){this.l_=t},sl.prototype.close=function(){this.a_()},sl.prototype.send=function(t){this.h_(t)},sl.prototype.__=function(){this.u_()},sl.prototype.f_=function(t){this.c_(t)},sl.prototype.d_=function(t){this.l_(t)},sl),Jf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},$f=(ol.prototype.va=function(e,t,n,r){var i=this.I_(e,t);Rr("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(e,i,o,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},ol.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},ol.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},ol.prototype.I_=function(t,e){var n=Jf[t];return this.T_+"/v1/"+e+":"+n},o(il,Hf=ol),il.prototype.A_=function(a,e,n,r){return new Promise(function(o,s){var u=new _r;u.listenOnce(Tr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ir.NO_ERROR:var t=u.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ir.TIMEOUT:Rr("Connection",'RPC "'+a+'" timed out'),s(new Jr(Zr.DEADLINE_EXCEEDED,"Request time out"));break;case Ir.HTTP_ERROR:var e,n,r=u.getStatus();Rr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Zr).indexOf(i)?i:Zr.UNKNOWN,s(new Jr(n,e.message))):s(new Jr(Zr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Jr(Zr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Rr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},il.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Er(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Rr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new Zf({h_:function(t){f?Rr("Connection","Not sending because WebChannel is closed:",t):(h||(Rr("Connection","Opening WebChannel transport."),c.open(),h=!0),Rr("Connection","WebChannel sending:",t),c.send(t))},a_:function(){return c.close()}});return a(Nr.EventType.OPEN,function(){f||Rr("Connection","WebChannel transport opened.")}),a(Nr.EventType.CLOSE,function(){f||(f=!0,Rr("Connection","WebChannel transport closed"),l.f_())}),a(Nr.EventType.ERROR,function(t){f||(f=!0,xr("Connection","WebChannel transport errored:",t),l.f_(new Jr(Zr.UNAVAILABLE,"The operation could not be completed")))}),a(Nr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Cr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Rr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=_i[i];if(void 0!==t)return Ri(t)}(),s=r.message,void 0===o&&(o=Zr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.f_(new Jr(o,s)),c.close()):(Rr("Connection","WebChannel received:",n),l.d_(n)))}),setTimeout(function(){l.__()},0),l},il),tl=(rl.prototype.Ka=function(t){this.y_.push(t)},rl.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},rl.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},rl.prototype.P_=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},rl.prototype.V_=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},rl.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},rl),el=(nl.prototype.Ka=function(t){},nl.prototype.th=function(){},nl);function nl(){}function rl(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}function il(t){var e=this;return(e=Hf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function ol(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function sl(t){this.h_=t.h_,this.a_=t.a_}function ul(t){this.persistence=t,this.n_=new Dh,this.s_=null}function al(t){var e=this;return(e=Wf.call(this)||this).Ro=t,e}function cl(t){var e=this;this.Jl={},this.yo=new fa(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new Kf(this),this.zn=new kc,this.Kn=new Mf(this.zn,function(t){return e.dr.Xl(t)})}function hl(t){this.persistence=t,this.Gl=new Qr(wi,bi),this.lastRemoteSnapshotVersion=ti.min(),this.highestTargetId=0,this.zl=0,this.Hl=new Dh,this.targetCount=0,this.Yl=eh.to()}function fl(t){return new Po(t,!0)}var ll,pl,dl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",yl=(El.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uc=this.b_(e),this.persistence=this.v_(e),[4,this.persistence.start()];case 1:return t.sent(),this.S_=this.D_(e),this.La=this.C_(e),[2]}})})},El.prototype.D_=function(t){return null},El.prototype.C_=function(t){return e=this.persistence,n=new Vf,r=t.N_,new bh(e,n,r);var e,n,r},El.prototype.v_=function(t){if(t.k_.F_)throw new Jr(Zr.FAILED_PRECONDITION,dl);return new Yf(Qf.i_)},El.prototype.b_=function(t){return new mf},El.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},El.prototype.clearPersistence=function(t,e){throw new Jr(Zr.FAILED_PRECONDITION,dl)},El),vl=(o(bl,pl=yl),bl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,pl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.La)];case 2:return t.sent(),[2]}})})},bl.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new Za(e,t.ei)},bl.prototype.v_=function(t){var e=wh(t.w_.s,t.w_.persistenceKey),n=fl(t.w_.s);return new fh(t.k_.synchronizeTabs,e,t.clientId,Ya.Ui(t.k_.cacheSizeBytes),t.ei,Ma(),Fa(),n,this.Uc,t.k_.Vo)},bl.prototype.b_=function(t){return new mf},bl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ta.ks()?(e=n+"main",[4,Ta.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(wh(t,e))},o(wl,ll=bl),wl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,ll.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.x_.initialize(this,r)];case 2:return t.sent(),e=this.x_.fu,this.Uc instanceof gf?(this.Uc.fu={Ic:function(u,a,c,h){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).nl("applyBatchState()"),[4,(e=o.La,n=a,i=(r=e).Gn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Zn(e,t):oa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,o.Bc.hu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(o.cl(a,h||null),o.La.Gn.Sr(a)):Pr(),t.label=4;case 4:return[4,o.hl(s)];case 5:return t.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),mc:function(s,u,a,c){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).tl?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Kc.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.La,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=to.zt(u,"current"===a),[4,n.hl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,Nh(n.La,u,!0)];case 6:return t.sent(),n.rl(u,c),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),Ac:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=f).tl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Kc.has(i)?(Rr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Ah(n.La,i)]):[3,6];case 2:return o=t.sent(),[4,Th(n.La,o)];case 3:return s=t.sent(),[4,n.sl(Lf(o),s.targetId,!1)];case 4:t.sent(),n.Bc.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Kc.has(e)?[4,Nh(n.La,e,!1).then(function(){n.Bc.lu(e),n.rl(e)}).catch(Sh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.La.persistence.rh()}.bind(null,e)},[4,this.Uc.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return r=h,!0!==f||!0===r.tl?[3,3]:(e=r.Uc.zu(),[4,Rf(r,e.N())]);case 1:return i=t.sent(),r.tl=!0,[4,r.Bc.Su(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Bc.listen(u);return[3,7];case 3:return!1!==f||!1===r.tl?[3,7]:(a=[],c=Promise.resolve(),r.Kc.forEach(function(t,e){r.Uc.ic(e)?a.push(e):c=c.then(function(){return r.rl(e),Nh(r.La,e,!0)}),r.Bc.lu(e)}),[4,c]);case 4:return t.sent(),[4,Rf(r,a)];case 5:return t.sent(),(n=r).Hc.forEach(function(t,e){n.Bc.lu(e)}),n.Yc.Nh(),n.Hc=new Map,n.zc=new Li(oi.P),r.tl=!1,[4,r.Bc.Su(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.x_.fu,e)];case 1:return t.sent(),this.S_&&(e&&!this.S_.tr?this.S_.start(this.La):e||this.S_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},wl.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=Ma();if(!gf.ks(e))throw new Jr(Zr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=wh(t.w_.s,t.w_.persistenceKey);return new gf(e,t.ei,n,t.clientId,t.N_)}return new mf},wl),gl=(ml.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.La?[3,3]:(this.La=n.La,this.Uc=n.Uc,this.qa=this.O_(r),this.Bc=this.M_(r),this.fu=this.L_(r),this.q_=this.B_(r),this.Uc.Da=function(t){return e.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return t.sent(),[4,this.Bc.Su(this.fu.el)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ml.prototype.B_=function(t){return new Pf(this.fu)},ml.prototype.O_=function(t){var e,n=fl(t.w_.s),r=(e=t.w_,new $f(e)),i=t.credentials;return new Hh(i,r,n)},ml.prototype.M_=function(t){var e=this;return new Kh(this.La,this.qa,t.ei,function(t){return e.fu.xc(t,0)},new(tl.ks()?tl:el))},ml.prototype.L_=function(t){return e=this.La,n=this.Bc,r=this.qa,i=this.Uc,o=t.N_,s=t.Qc,u=!t.k_.F_||!t.k_.synchronizeTabs,a=new bf(e,n,r,i,o,s),u&&(a.tl=!0),a;var e,n,r,i,o,s,u,a},ml.prototype.terminate=function(){return this.Bc.th()},ml);function ml(){}function wl(t){var e=this;return(e=ll.call(this)||this).x_=t,e}function bl(){return null!==pl&&pl.apply(this,arguments)||this}function El(){}function Il(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Tl=(Nl.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},Nl.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Nl.prototype.Q_=function(){this.muted=!0},Nl.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Nl);function Nl(t){this.observer=t,this.muted=!1}function _l(t,e){if(0!==e.length)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Bl(e.length,"argument")+".")}function Al(t,e,n){if(e.length!==n)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires "+Bl(n,"argument")+", but was called with "+Bl(e.length,"argument")+".")}function Sl(t,e,n){if(e.length<n)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Bl(n,"argument")+", but was called with "+Bl(e.length,"argument")+".")}function Dl(t,e,n,r){if(e.length<n||e.length>r)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Bl(e.length,"argument")+".")}function kl(t,e,n,r){Cl(t,e,Gl(n)+" argument",r)}function Rl(t,e,n,r){void 0!==r&&kl(t,e,n,r)}function Ll(t,e,n,r){Cl(t,e,n+" option",r)}function xl(t,e,n,r){void 0!==r&&Ll(t,e,n,r)}function Ol(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Ul(s))}var u=Ul(n);throw new Jr(Zr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Pl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid value "+Ul(r)+" provided to function "+t+"() for its "+Gl(n)+" argument. Acceptable values: "+e.join(", "));return r}function Cl(t,e,n,r){if(!("object"===e?Vl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Ul(r);throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Vl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ul(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ml(t,e,n){if(void 0===n)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Gl(e)+" argument, but it was undefined.")}function Fl(n,t,r){Hr(t,function(t,e){if(r.indexOf(t)<0)throw new Jr(Zr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ql(t,e,n,r){var i=Ul(r);return new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gl(n)+" argument to be a "+e+", but it was: "+i)}function jl(t,e,n){if(n<=0)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Gl(e)+" argument to be a positive number, but it was: "+n+".")}function Gl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Bl(t,e){return t+" "+e+(1===t?"":"s")}function zl(){if("undefined"==typeof Uint8Array)throw new Jr(Zr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Hl(){if("undefined"==typeof atob)throw new Jr(Zr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Wl,Kl,Yl=(np.fromBase64String=function(t){Al("Blob.fromBase64String",arguments,1),kl("Blob.fromBase64String","string",1,t),Hl();try{return new np(Ii.fromBase64String(t))}catch(t){throw new Jr(Zr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},np.fromUint8Array=function(t){if(Al("Blob.fromUint8Array",arguments,1),zl(),!(t instanceof Uint8Array))throw ql("Blob.fromUint8Array","Uint8Array",1,t);return new np(Ii.fromUint8Array(t))},np.prototype.toBase64=function(){return Al("Blob.toBase64",arguments,0),Hl(),this.W_.toBase64()},np.prototype.toUint8Array=function(){return Al("Blob.toUint8Array",arguments,0),zl(),this.W_.toUint8Array()},np.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},np.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},np),Xl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Jr(Zr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(kl("FieldPath","string",e,t[e]),0===t[e].length)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new ii(t)},Ql=(o(ep,Kl=Xl),ep.documentId=function(){return new ep(ii.L().F())},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw ql("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},ep),Zl=new RegExp("[~\\*/\\[\\]]"),Jl=function(){this.K_=this},$l=(o(tp,Wl=Jl),tp.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},tp.prototype.isEqual=function(t){return t instanceof tp},tp);function tp(t){var e=this;return(e=Wl.call(this)||this).G_=t,e}function ep(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kl.call(this,t)||this}function np(t){Hl(),this.W_=t}function rp(t,e,n){return new Lp({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var ip,op,sp,up,ap,cp,hp=(o(kp,cp=Jl),kp.prototype.z_=function(t){return new Ns(t.path,new cs)},kp.prototype.isEqual=function(t){return t instanceof kp},kp),fp=(o(Dp,ap=Jl),Dp.prototype.z_=function(t){var e=rp(this,t,!0),n=this.Z_.map(function(t){return Fp(t,e)}),r=new hs(n);return new Ns(t.path,r)},Dp.prototype.isEqual=function(t){return this===t},Dp),lp=(o(Sp,up=Jl),Sp.prototype.z_=function(t){var e=rp(this,t,!0),n=this.Z_.map(function(t){return Fp(t,e)}),r=new ys(n);return new Ns(t.path,r)},Sp.prototype.isEqual=function(t){return this===t},Sp),pp=(o(Ap,sp=Jl),Ap.prototype.z_=function(t){var e=new ws(t.serializer,Uo(t.serializer,this.tf));return new Ns(t.path,e)},Ap.prototype.isEqual=function(t){return this===t},Ap),dp=(o(_p,op=Jl),_p.delete=function(){return _l("FieldValue.delete",arguments),new yp(new $l("FieldValue.delete"))},_p.serverTimestamp=function(){return _l("FieldValue.serverTimestamp",arguments),new yp(new hp("FieldValue.serverTimestamp"))},_p.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Sl("FieldValue.arrayUnion",arguments,1),new yp(new fp("FieldValue.arrayUnion",t))},_p.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Sl("FieldValue.arrayRemove",arguments,1),new yp(new lp("FieldValue.arrayRemove",t))},_p.increment=function(t){return kl("FieldValue.increment","number",1,t),Al("FieldValue.increment",arguments,1),new yp(new pp("FieldValue.increment",t))},_p),yp=(o(Np,ip=dp),Np.prototype.z_=function(t){return this.K_.z_(t)},Np.prototype.isEqual=function(t){return t instanceof Np&&this.K_.isEqual(t.K_)},Np),vp=(Object.defineProperty(Tp.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(Tp.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Tp.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},Tp.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},Tp.prototype.T=function(t){return Mr(this.ef,t.ef)||Mr(this.nf,t.nf)},Tp),gp=/^__.*__$/,mp=function(t,e,n){this.sf=t,this.if=e,this.rf=n},wp=(Ip.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Us(t,this.data,this.qe,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Ip),bp=(Ep.prototype.hf=function(t,e){var n=[new Us(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Ep);function Ep(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Ip(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Tp(t,e){if(Al("GeoPoint",arguments,2),kl("GeoPoint","number",1,t),kl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Jr(Zr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Jr(Zr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}function Np(t){var e=this;return(e=ip.call(this)||this).K_=t,e.G_=t.G_,e}function _p(){return op.call(this)||this}function Ap(t,e){var n=this;return(n=sp.call(this)||this).G_=t,n.tf=e,n}function Sp(t,e){var n=this;return(n=up.call(this)||this).G_=t,n.Z_=e,n}function Dp(t,e){var n=this;return(n=ap.call(this)||this).G_=t,n.Z_=e,n}function kp(t){var e=this;return(e=cp.call(this)||this).G_=t,e}function Rp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Lp=(Object.defineProperty(Pp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Pp.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),Pp.prototype.uf=function(t){return new Pp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},Pp.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},Pp.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},Pp.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},Pp.prototype.Y_=function(t){return Hp(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},Pp.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Pp.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},Pp.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(Rp(this.H_)&&gp.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},Pp),xp=(Op.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new Lp({H_:t,methodName:e,J_:n,path:ii.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Op);function Op(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||fl(t)}function Pp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}function Cp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Gp("Data must be an object, but it was:",s,r);var u,a,c=qp(r,s);if(o.merge)u=new Ts(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Xl)d=p.j_;else{if("string"!=typeof p)throw Pr();d=zp(e,p,n)}if(!s.contains(d))throw new Jr(Zr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Wp(h,d)||h.push(d)}u=new Ts(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new wp(new Xs(c),u,a)}function Vp(t,o,s,e){var u=t.wf(1,o,s);Gp("Data must be an object, but it was:",u,e);var a=[],c=new Qs;Hr(e,function(t,e){var n,r=zp(o,t,s),i=u._f(r);e instanceof Jl&&e.K_ instanceof $l?a.push(r):null!=(n=Fp(e,i))&&(a.push(r),c.set(r,n))});var n=new Ts(a);return new bp(c.ze(),n,u.fieldTransforms)}function Up(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[Bp(e,r,n)],a=[i];if(o.length%2!=0)throw new Jr(Zr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Bp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],y=new Qs,v=u.length-1;0<=v;--v)Wp(d,u[v])||(h=u[v],f=a[v],l=s._f(h),f instanceof Jl&&f.K_ instanceof $l?d.push(h):null!=(p=Fp(f,l))&&(d.push(h),y.set(h,p)));var g=new Ts(d);return new bp(y.ze(),g,s.fieldTransforms)}function Mp(t,e,n,r){return void 0===r&&(r=!1),Fp(n,t.wf(r?4:3,e))}function Fp(s,t){if(jp(s))return Gp("Unsupported field value:",t,s),qp(s,t);if(s instanceof Jl)return function(t,e){if(!Rp(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.X_&&4!==t.H_)throw t.Y_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Fp(i[r],t.ff(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,r)}}if(t instanceof vp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Yl)return{bytesValue:Fo(e.serializer,t)};if(t instanceof mp){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:jo(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+Ul(t))}(s,t)}function qp(t,r){var i={};return Wr(t)?r.path&&0<r.path.length&&r.qe.push(r.path):Hr(t,function(t,e){var n=Fp(e,r.cf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function jp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof vp||t instanceof Yl||t instanceof mp||t instanceof Jl)}function Gp(t,e,n){if(!jp(n)||!Vl(n)){var r=Ul(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function Bp(t,e,n){if(e instanceof Xl)return e.j_;if("string"==typeof e)return zp(t,e);throw Hp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function zp(t,e,n){try{return function(e){if(0<=e.search(Zl))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Ql.bind.apply(Ql,s([void 0],e.split("."))))}catch(t){throw new Jr(Zr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Hp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Hp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Jr(Zr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Wp(t,e){return t.some(function(t){return t.isEqual(e)})}var Kp=(Jp.prototype.Af=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),0<this.mutations.length)throw new Jr(Zr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ko((i=u).serializer)+"/documents",n={documents:a.map(function(t){return Bo(i.serializer,t)})},[4,i.Sa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=zo(t,e.found.name),r=qo(e.found.updateTime),i=new Xs({mapValue:{fields:e.found.fields}});return new ou(n,r,i,{})}(e,n):"missing"in n?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);var n=zo(t,e.missing),r=qo(e.readTime);return new su(n,r)}(e,n):Pr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Cr(!!e),s.push(e)}),s)]}})})}(this.qa,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof su||t instanceof ou?n.Pf(t):Pr()}),e)]}})})},Jp.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},Jp.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},Jp.prototype.delete=function(t){this.write([new Ks(t,this.Qe(t))]),this.mf.add(t.toString())},Jp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),this.If)throw this.If;return e=this.Tf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=oi.B(e);r.mutations.push(new Ys(n,r.Qe(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Qo(e.serializer,t)})},[4,e.va("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return t.sent(),this.Ef=!0,[2]}})})},Jp.prototype.Pf=function(t){var e;if(t instanceof ou)e=t.version;else{if(!(t instanceof su))throw Pr();e=ti.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Jr(Zr.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},Jp.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?Ss.updateTime(e):Ss.We()},Jp.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(this.mf.has(t.toString())||!e)return Ss.exists(!0);if(e.isEqual(ti.min()))throw new Jr(Zr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ss.updateTime(e)},Jp.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},Jp.prototype.Rf=function(){},Jp),Yp=(Zp.prototype.run=function(){this.yf()},Zp.prototype.yf=function(){var t=this;this.Ti.bs(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Kp(this.qa),(n=this.pf(e))&&n.then(function(t){r.ei.ai(function(){return e.commit().then(function(){r.ii.resolve(t)}).catch(function(t){r.bf(t)})})}).catch(function(t){r.bf(t)}),[2]})})})},Zp.prototype.pf=function(t){try{var e=this.updateFunction(t);return!di(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},Zp.prototype.bf=function(t){var e=this;0<this.Vf&&this.vf(t)?(--this.Vf,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},Zp.prototype.vf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!ki(e)},Zp),Xp=(Qp.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new ba,s=!1;return this.credentials.Bh(function(t){return s?void i.ei.gi(function(){return i.Bc.vu(t)}):(s=!0,Rr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject))}),this.ei.ai(function(){return i.Sf.promise}),o.promise},Qp.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()})},Qp.prototype.Cf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:u,Qc:100,k_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Uc=i.Uc,this.La=i.La,this.S_=i.S_,this.qa=o.qa,this.Bc=o.Bc,this.fu=o.fu,this.Nf=o.q_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Ff(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Cf(new yl,new gl,{F_:!1},u,a))];case 4:return[2]}})})},Qp.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===Zr.FAILED_PRECONDITION||t.code===Zr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Qp.prototype.Df=function(){if(this.ei.Ii)throw new Jr(Zr.FAILED_PRECONDITION,"The client has already been terminated.")},Qp.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()})},Qp.prototype.terminate=function(){var t=this;this.ei.Pi();var r=new ba;return this.ei.mi(function(){return g(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return t.sent(),[4,this.Uc.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.Uh(),r.resolve(),[3,5];case 4:return e=t.sent(),n=za(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},Qp.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new ba;return this.ei.ai(function(){return t.fu._l(e)}),e.promise},Qp.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Tl(n),o=new Cf(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lu(o)})}},Qp.prototype.kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,u,a){return g(this,void 0,void 0,function(){var s,e=this;return w(this,function(t){switch(t.label){case 0:return s=new ba,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Rh.Hn(t,e)}))];case 1:return(r=t.sent())instanceof ou?s.resolve(r):r instanceof su?s.resolve(null):s.reject(new Jr(Zr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=za(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.ei,this.La,e))]}})})},Qp.prototype.$f=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new ba,s=$p(e,n,yu(r.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Jr(Zr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Jr(Zr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Qp.prototype.xf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,a,c){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new ba,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,_h(a,c,!0)];case 1:return e=t.sent(),n=new wf(c,e.gh),r=n.Sc(e.documents),i=n.Un(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=za(o,"Failed to execute query '"+c+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ei,this.La,e))]}})})},Qp.prototype.Of=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new ba,s=$p(e,n,r,{includeMetadataChanges:!0,$l:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Jr(Zr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Qp.prototype.write=function(t){var e=this;this.Df();var n=new ba;return this.ei.ai(function(){return e.fu.write(t,n)}),n.promise},Qp.prototype.s=function(){return this.w_.s},Qp.prototype.bl=function(t){var e=this;this.Df();var n=new Tl(t);return this.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(Qp.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),Qp.prototype.transaction=function(t){var e=this;this.Df();var n=new ba;return this.ei.ai(function(){return new Yp(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},Qp);function Qp(t,e){this.credentials=t,this.ei=e,this.clientId=Vr.t(),this.Sf=new ba}function Zp(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new Ia(this.ei,"transaction_retry")}function Jp(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}function $p(t,e,n,r,i){var o=new Tl(i),s=new Cf(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lu(s)})}}var td,ed,nd=(bd.prototype.Bf=function(t){switch(go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return No(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new Yl(_o(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw Pr()}},bd.prototype.Gf=function(t){var n=this,r={};return Hr(t.fields||{},function(t,e){r[t]=n.Bf(e)}),r},bd.prototype.jf=function(t){return new vp(No(t.latitude),No(t.longitude))},bd.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},bd.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return po(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(yo(t));default:return null}},bd.prototype.Uf=function(t){var e=To(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},bd.prototype.Wf=function(t){var e=ni.k(t);Cr(is(e));var n=new Gr(e.get(1),e.get(3)),r=new oi(e.V(5));return n.isEqual(this.s)||Lr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},bd),rd=Ya.ji,id=(wd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},wd),od=(Object.defineProperty(md.prototype,"rd",{get:function(){return this.od||(this.od=new xp(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),md.prototype.settings=function(t){Al("Firestore.settings",arguments,1),kl("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new id(t);if(this.Zf&&!this.sd.isEqual(e))throw new Jr(Zr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.sd=e).credentials&&(this.nd=function(t){if(!t)return new Mh;switch(t.type){case"gapi":var e=t.hd;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new jh(e,t.zh||"0");case"provider":return t.hd;default:throw new Jr(Zr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},md.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},md.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},md.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new Jr(Zr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Lr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Jr(Zr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},md.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.Zf&&!this.Zf.Mf)throw new Jr(Zr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ba,[2,(this.Jf.mi(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},md.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(md.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),md.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},md.prototype.onSnapshotsInSync=function(t){if(this.Xf(),Il(t))return this.Zf.bl(t);kl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},md.prototype.Xf=function(){return this.Zf||this.ad(new yl,new gl,{F_:!1}),this.Zf},md.prototype.ld=function(){return new jr(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},md.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new Xp(this.nd,this.Jf),this.Zf.start(r,t,e,n)},md.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Jr(Zr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Jr(Zr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Gr(n)},Object.defineProperty(md.prototype,"app",{get:function(){if(!this.Yf)throw new Jr(Zr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),md.prototype.collection=function(t){return Al("Firestore.collection",arguments,1),kl("Firestore.collection","non-empty string",1,t),this.Xf(),new Dd(ni.k(t),this,null)},md.prototype.doc=function(t){return Al("Firestore.doc",arguments,1),kl("Firestore.doc","non-empty string",1,t),this.Xf(),ad._d(ni.k(t),this,null)},md.prototype.collectionGroup=function(t){if(Al("Firestore.collectionGroup",arguments,1),kl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Ad((e=t,new lu(ni.$(),e)),this,null);var e},md.prototype.runTransaction=function(e){var n=this;return Al("Firestore.runTransaction",arguments,1),kl("Firestore.runTransaction","function",1,e),this.Xf().transaction(function(t){return e(new sd(n,t))})},md.prototype.batch=function(){return this.Xf(),new ud(this)},Object.defineProperty(md,"logLevel",{get:function(){switch(kr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),md.setLogLevel=function(t){Al("Firestore.setLogLevel",arguments,1),Pl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Dr.setLogLevel(t)},md.prototype.fd=function(){return this.sd.timestampsInSnapshots},md.prototype.dd=function(){return this.sd},md),sd=(gd.prototype.get=function(t){var n=this;Al("Transaction.get",arguments,1);var r=Cd("Transaction.get",t,this.wd);return this.Td.Af([r.if]).then(function(t){if(!t||1!==t.length)return Pr();var e=t[0];if(e instanceof su)return new hd(n.wd,r.if,null,!1,!1,r.rf);if(e instanceof ou)return new hd(n.wd,r.if,e,!1,!1,r.rf);throw Pr()})},gd.prototype.set=function(t,e,n){Dl("Transaction.set",arguments,2,3);var r=Cd("Transaction.set",t,this.wd);n=xd("Transaction.set",n);var i=Vd(r.rf,e,n),o=Cp(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},gd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Ql?(Sl("Transaction.update",arguments,3),r=Cd("Transaction.update",t,this.wd),Up(this.wd.rd,"Transaction.update",r.if,e,n,o)):(Al("Transaction.update",arguments,2),r=Cd("Transaction.update",t,this.wd),Vp(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},gd.prototype.delete=function(t){Al("Transaction.delete",arguments,1);var e=Cd("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},gd),ud=(vd.prototype.set=function(t,e,n){Dl("WriteBatch.set",arguments,2,3),this.md();var r=Cd("WriteBatch.set",t,this.wd);n=xd("WriteBatch.set",n);var i=Vd(r.rf,e,n),o=Cp(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,Ss.We())),this},vd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),i="string"==typeof e||e instanceof Ql?(Sl("WriteBatch.update",arguments,3),r=Cd("WriteBatch.update",t,this.wd),Up(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(Al("WriteBatch.update",arguments,2),r=Cd("WriteBatch.update",t,this.wd),Vp(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,Ss.exists(!0))),this},vd.prototype.delete=function(t){Al("WriteBatch.delete",arguments,1),this.md();var e=Cd("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new Ks(e.if,Ss.We())),this},vd.prototype.commit=function(){return this.md(),this.Id=!0,0<this.Ed.length?this.wd.Xf().write(this.Ed):Promise.resolve()},vd.prototype.md=function(){if(this.Id)throw new Jr(Zr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},vd),ad=(o(yd,ed=mp),yd._d=function(t,e,n){if(t.length%2!=0)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new yd(new oi(t),e,n)},Object.defineProperty(yd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"parent",{get:function(){return new Dd(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),yd.prototype.collection=function(t){if(Al("DocumentReference.collection",arguments,1),kl("DocumentReference.collection","non-empty string",1,t),!t)throw new Jr(Zr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ni.k(t);return new Dd(this.if.path.child(e),this.firestore,null)},yd.prototype.isEqual=function(t){if(!(t instanceof yd))throw ql("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},yd.prototype.set=function(t,e){Dl("DocumentReference.set",arguments,1,2),e=xd("DocumentReference.set",e);var n=Vd(this.rf,t,e),r=Cp(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,Ss.We()))},yd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Ql?(Sl("DocumentReference.update",arguments,2),Up(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Al("DocumentReference.update",arguments,1),Vp(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,Ss.exists(!0)))},yd.prototype.delete=function(){return Al("DocumentReference.delete",arguments,0),this.Zf.write([new Ks(this.if,Ss.We())])},yd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Dl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Il(i[u])||(Fl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),xl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};Il(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(kl("DocumentReference.onSnapshot","function",u,i[u]),Rl("DocumentReference.onSnapshot","function",u+1,i[u+1]),Rl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(yu(this.if.path),c,h)},yd.prototype.get=function(t){var e=this;Dl("DocumentReference.get",arguments,0,1),Pd("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new hd(e.firestore,e.if,t,!0,t instanceof ou&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Ad(t)})},yd.prototype.withConverter=function(t){return new yd(this.if,this.firestore,t)},yd.prototype.Ad=function(t){var e=t.docs.get(this.if);return new hd(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},yd),cd=(dd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},dd),hd=(pd.prototype.data=function(t){var e=this;if(Dl("DocumentSnapshot.data",arguments,0,1),t=Od("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new fd(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new nd(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",function(t){return new ad(t,e.wd,null)}).Bf(this.Rd.tn())}},pd.prototype.get=function(t,e){var n=this;if(Dl("DocumentSnapshot.get",arguments,1,2),e=Od("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(Bp("DocumentSnapshot.get",t,this.if));if(null!==r)return new nd(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",function(t){return new ad(t,n.wd,n.rf)}).Bf(r)}},Object.defineProperty(pd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"ref",{get:function(){return new ad(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return new cd(this.gd,this.Pd)},enumerable:!1,configurable:!0}),pd.prototype.isEqual=function(t){if(!(t instanceof pd))throw ql("isEqual","DocumentSnapshot",1,t);return this.wd===t.wd&&this.Pd===t.Pd&&this.if.isEqual(t.if)&&(null===this.Rd?null===t.Rd:this.Rd.isEqual(t.Rd))&&this.rf===t.rf},pd),fd=(o(ld,td=hd),ld.prototype.data=function(t){return td.prototype.data.call(this,t)},ld);function ld(){return null!==td&&td.apply(this,arguments)||this}function pd(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}function dd(t,e){this.hasPendingWrites=t,this.fromCache=e}function yd(t,e,n){var r=this;return(r=ed.call(this,e.sf,t,n)||this).if=t,r.firestore=e,r.rf=n,r.Zf=r.firestore.Xf(),r}function vd(t){this.wd=t,this.Ed=[],this.Id=!1}function gd(t,e){this.wd=t,this.Td=e}function md(t,e,n,r){var i=this;if(void 0===n&&(n=new yl),void 0===r&&(r=new gl),this.zf=n,this.Hf=r,this.Yf=null,this.Jf=new ja,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Yf=o,this.sf=md.td(o),this.ed=o.name,this.nd=new Fh(e)}else{var s=t;if(!s.projectId)throw new Jr(Zr.INVALID_ARGUMENT,"Must provide projectId");this.sf=new Gr(s.projectId,s.database),this.ed="[DEFAULT]",this.nd=new Mh}this.sd=new id({})}function wd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Jr(Zr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ll("settings","non-empty string","host",t.host),this.host=t.host,xl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Fl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),xl("settings","object","credentials",t.credentials),this.credentials=t.credentials,xl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),xl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Lr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Lr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,xl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ya.Gi;else{if(t.cacheSizeBytes!==rd&&t.cacheSizeBytes<Ya.Ki)throw new Jr(Zr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ya.Ki);this.cacheSizeBytes=t.cacheSizeBytes}xl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function bd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}function Ed(t,e,n){if("string"==typeof n){if(""===n)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!vu(e)&&-1!==n.indexOf("/"))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ni.k(n));if(!oi.j(r))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new oi(r))}if(n instanceof mp)return Ao(t,n.if);throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ul(n)+".")}function Id(t,e){if(!Array.isArray(t)||0===t.length)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Td(t,e,n){if(!n.isEqual(e))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Nd(t){if(t.un()&&0===t.en.length)throw new Jr(Zr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _d,Ad=(Ld.prototype.where=function(t,e,n){var r;Al("Query.where",arguments,3),Ml("Query.where",3,n),r="not-in"===e||"!="===e?e:Pl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Bp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.M()){if("array-contains"===i||"array-contains-any"===i)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Id(o,i);for(var u=[],a=0,c=o;a<c.length;a++){var h=c[a];u.push(Ed(n,t,h))}s={arrayValue:{values:u}}}else s=Ed(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Id(o,i),s=Mp(e,"Query.where",o,"in"===i||"not-in"===i);var f=Du.create(r,i,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&Td(0,e.field,r)}var i=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.Vd,this.firestore.rd,this.firestore.sf,s,r,n);return new Ld((o=(i=this.Vd).filters.concat([u]),new lu(i.path,i.collectionGroup,i.en.slice(),o,i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.rf)},Ld.prototype.orderBy=function(t,e){var n;if(Dl("Query.orderBy",arguments,1,2),Rl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Jr(Zr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Bp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new na(e,n),s=o;return null!==(r=t).cn()||null!==(i=r.ln())&&Td(0,i,s.field),o}(this.Vd,o,n);return new Ld((i=(r=this.Vd).en.concat([s]),new lu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.rf)},Ld.prototype.limit=function(t){return Al("Query.limit",arguments,1),kl("Query.limit","number",1,t),jl("Query.limit",1,t),new Ld(wu(this.Vd,t,"F"),this.firestore,this.rf)},Ld.prototype.limitToLast=function(t){return Al("Query.limitToLast",arguments,1),kl("Query.limitToLast","number",1,t),jl("Query.limitToLast",1,t),new Ld(wu(this.Vd,t,"L"),this.firestore,this.rf)},Ld.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Sl("Query.startAt",arguments,1);var r=this.yd("Query.startAt",t,e,!0);return new Ld(bu(this.Vd,r),this.firestore,this.rf)},Ld.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Sl("Query.startAfter",arguments,1);var r=this.yd("Query.startAfter",t,e,!1);return new Ld(bu(this.Vd,r),this.firestore,this.rf)},Ld.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Sl("Query.endBefore",arguments,1);var r=this.yd("Query.endBefore",t,e,!0);return new Ld(Eu(this.Vd,r),this.firestore,this.rf)},Ld.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Sl("Query.endAt",arguments,1);var r=this.yd("Query.endAt",t,e,!1);return new Ld(Eu(this.Vd,r),this.firestore,this.rf)},Ld.prototype.isEqual=function(t){if(!(t instanceof Ld))throw ql("isEqual","Query",1,t);return this.firestore===t.firestore&&Iu(this.Vd,t.Vd)&&this.rf===t.rf},Ld.prototype.withConverter=function(t){return new Ld(this.Vd,this.firestore,t)},Ld.prototype.yd=function(h,t,e,n){if(Ml(h,1,t),t instanceof hd)return Al(h,s([t],e),1),function(t,e,n,r){if(!n)throw new Jr(Zr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=gu(t);o<s.length;o++){var u=s[o];if(u.field.M())i.push(Ao(e,n.key));else{var a=n.field(u.field);if(po(a))throw new Jr(Zr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.F();throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Yu(i,r)}(this.Vd,this.firestore.sf,t.Rd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new Jr(Zr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!vu(t)&&-1!==c.indexOf("/"))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ni.k(c));if(!oi.j(h))throw new Jr(Zr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new oi(h);u.push(Ao(e,f))}else{var l=Mp(n,r,c);u.push(l)}}return new Yu(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,h,r,n)},Ld.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Dl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Il(i[a])||(Fl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),xl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Il(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(kl("Query.onSnapshot","function",a,i[a]),Rl("Query.onSnapshot","function",a+1,i[a+1]),Rl("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new Sd(r.firestore,r.Vd,t,r.rf))},error:i[a+1],complete:i[a+2]};return Nd(this.Vd),this.firestore.Xf().listen(this.Vd,u,c)},Ld.prototype.get=function(t){var e=this;Dl("Query.get",arguments,0,1),Pd("Query.get",t),Nd(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then(function(t){return new Sd(e.firestore,e.Vd,t,e.rf)})},Ld),Sd=(Object.defineProperty(Rd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),Rd.prototype.forEach=function(e,n){var r=this;Dl("QuerySnapshot.forEach",arguments,1,2),kl("QuerySnapshot.forEach","function",1,e),this.bd.docs.forEach(function(t){e.call(n,r.Dd(t,r.metadata.fromCache,r.bd.qt.has(t.key)))})},Object.defineProperty(Rd.prototype,"query",{get:function(){return new Ad(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),Rd.prototype.docChanges=function(t){t&&(Fl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),xl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new Jr(Zr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},Rd.prototype.isEqual=function(t){if(!(t instanceof Rd))throw ql("isEqual","QuerySnapshot",1,t);return this.wd===t.wd&&Iu(this.pd,t.pd)&&this.bd.isEqual(t.bd)&&this.rf===t.rf},Rd.prototype.Dd=function(t,e,n){return new fd(this.wd,t.key,t,e,n,this.rf)},Rd),Dd=(o(kd,_d=Ad),Object.defineProperty(kd.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new ad(new oi(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(kd.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),kd.prototype.doc=function(t){Dl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Vr.t()),kl("CollectionReference.doc","non-empty string",1,t);var e=ni.k(t);return ad._d(this.Vd.path.child(e),this.firestore,this.rf)},kd.prototype.add=function(t){Al("CollectionReference.add",arguments,1),kl("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},kd.prototype.withConverter=function(t){return new kd(this.Cd,this.firestore,t)},kd);function kd(t,e,n){var r=this;if(((r=_d.call(this,yu(t),e,n)||this).Cd=t).length%2!=1)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Rd(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new cd(n.hasPendingWrites,n.fromCache)}function Ld(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}function xd(t,e){if(void 0===e)return{merge:!1};if(Fl(t,e,["merge","mergeFields"]),xl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ul(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Ql))throw new Jr(Zr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Ul(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Jr(Zr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Od(t,e){return void 0===e?{}:(Fl(t,e,["serverTimestamps"]),Ol(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Pd(t,e){Rl(t,"object",1,e),e&&(Fl(t,e,["source"]),Ol(t,0,"source",e.source,["default","server","cache"]))}function Cd(t,e,n){if(e instanceof mp){if(e.firestore!==n)throw new Jr(Zr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ql(t,"DocumentReference",1,e)}function Vd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ud,Md={Firestore:od,GeoPoint:vp,Timestamp:$r,Blob:Yl,Transaction:sd,WriteBatch:ud,DocumentReference:ad,DocumentSnapshot:hd,Query:Ad,QueryDocumentSnapshot:fd,QuerySnapshot:Sd,CollectionReference:Dd,FieldPath:Ql,FieldValue:dp,setLogLevel:od.setLogLevel,CACHE_SIZE_UNLIMITED:rd};(Ud=r.default).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new gl,i=new vl(r),new od(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Md))),Ud.registerVersion("@firebase/firestore","1.16.6")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});