!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ld){"use strict";try{(function(){Ld=Ld&&Object.prototype.hasOwnProperty.call(Ld,"default")?Ld.default:Ld;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D=_||self;function S(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),L=0;function R(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?R:C).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++L))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var X,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var Y=D.navigator;if(Y){var J=Y.userAgent;if(J){X=J;break t}}X=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=S;var rt,it,ot=W(X,"Opera"),st=W(X,"Trident")||W(X,"MSIE"),ut=W(X,"Edge"),at=ut||st,ht=W(X,"Gecko")&&!(W(X.toLowerCase(),"webkit")&&!W(X,"Edge"))&&!(W(X,"Trident")||W(X,"MSIE"))&&!W(X,"Edge"),ct=W(X.toLowerCase(),"webkit")&&!W(X,"Edge");function ft(){var t=D.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=X,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=H(String(rt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=D.document&&st&&(ft()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},F(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),At=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++At,this.Y=this.Z=!1}function Dt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Dt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Pt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=qt(r),e&&e[Nt]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Nt]?t.va(e,n,O(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=Ft(t);if(h||(t[Ot]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?xt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(xt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Dt(t)))}function Ut(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Mt(t,e){if(t.Y)return!0;if(mt)return Vt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new It(e,this))}function Ft(t){return(t=t[Ot])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==x(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Gt(){j.call(this),this.c=new St(this),(this.J=this).C=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&xt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Gt,j),Gt.prototype[Nt]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=qt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=D.JSON.stringify;function Kt(){this.b=this.a=null}var Xt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Qt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Xt||(n=D.Promise.resolve(void 0),Xt=function(){n.then(Zt)}),Jt||(Xt(),Jt=!0),$t.add(t,e)}Kt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Kt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Jt=!1}function te(t,e){Gt.call(this),this.b=t||1,this.a=e||D,this.f=U(this.Ya,this),this.g=M()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==x(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}F(te,Gt),(A=te.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=j),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){j.call(this),this.b=t,this.a={}}F(he,j);var ce=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),le(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Gt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}F(ge,Et),F(we,Et),F(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ae(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function De(){}Ae.prototype.a=null;var Se,xe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ke(){Et.call(this,"d")}function Oe(){Et.call(this,"c")}function Pe(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Re,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(ke,Et),F(Oe,Et),F(Pe,Ae),Se=new Pe;var Re=45e3,Ce={},Ue={};function Ve(t,e,n){t.H=1,t.i=on($e(e)),t.j=n,t.I=!0,Me(t,null)}function Me(t,e){t.u=M(),je(t),t.l=$e(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ue:(o=Number(i.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>i.length?Ue:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ue){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Be(t))}function je(t){t.U=M()+t.P,qe(t,t.P)}function qe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function Ge(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||An(p.b,t)))if(p.I=t.N,!t.C&&An(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Wn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ar(p,11)}else if(!t.C&&p.a!=t||or(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(W(u,"spdy")||W(u,"quic")||W(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(_n(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=M()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Dn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Ge(f),je(f)),o.a=c):er(o),0<p.g.length&&Jn(p)):"stop"!=y[0]&&"close"!=y[0]||ar(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ar(p,7):Hn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof He)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Le.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Ge(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,h=this.m,c=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Be(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(Fe(this,e,i),at&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),Ke(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,je(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Be(this)}}}catch(t){}var a,h,c,f,l,p,d},A.Va=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),Fe(this,t,e),this.b&&4!=t&&je(this)))},A.cancel=function(){this.A=!0,ze(this)},A.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Be(this)):qe(this,this.U-n)},(A=He.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function $e(t){return new Je(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=un(e,ln)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,fn=/[#\?]/g,ln=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new He,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function gn(t,e){return yn(t),e=wn(t,e),Qe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function kn(){this.a=new xn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},xn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Pn=D.JSON.parse;function Ln(t){Gt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Rn,this.D=this.F=!1}F(Ln,Gt);var Rn="",Cn=/^https?$/i,Un=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),qn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&(!t.s[1]||4!=Bn(t)||2!=t.X()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Fn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Hn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,rn(n=$e(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=on($e(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=M(),je(e)),hr(t)}function Wn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Qn(t){Wn(t),t.j&&(D.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&Jn(t)}function Jn(t){Tn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Ve(n,r,e)}function Zn(t,n){t.f&&Xe({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Xe(t,function(t,e){var n=t;O(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ur(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on($e(e)),n.j=null,n.I=!0,Me(n,t)}function or(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!An(t.b,e))return;r=e.s,Dn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ee(i)),Jn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ar(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=U(t.Xa,t),n||(n=new Je("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ze(n,"https"),on(n)),i=n.toString(),o=r,u=new pe,D.Image?((s=new Image).onload=V(On,u,s,"TestLoadImage: loaded",!0,o),s.onerror=V(On,u,s,"TestLoadImage: error",!1,o),s.onabort=V(On,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=V(On,u,s,"TestLoadImage: timeout",!1,o),D.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Qn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Je?$e(r):new Je(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=D.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Je(null,void 0),o&&Ze(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&$(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function lr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Gt.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){Oe.call(this),this.status=1}function gr(t){this.a=t}(A=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Se),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new He(this.headers);r&&Xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=q(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),Ln.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},A.Ta=function(){jn(this)},A.X=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Xn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=$e(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&zn(i,this.i,r),_n(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||Tn(this.b)||$n(this))},A.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Wn(this),ir(this))},A.Ra=function(){null!=this.m&&(this.m=null,Wn(this),nr(this),be())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(A=lr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},F(dr,Gt),(A=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),Jn(t)},A.close=function(){Hn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,dr.S.G.call(this)},F(yr,ke),F(vr,Oe),F(gr,lr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(De.EventType=xe).OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ne,WebChannel:De,XhrIo:Ln},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Er=mr.EventType,Ir=mr.WebChannel,Tr=mr.XhrIo,Nr=(Ar.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ar.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ar.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ar);function Ar(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _r=new c("@firebase/firestore");function Dr(){return _r.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.DEBUG&&(e=n.map(Or),_r.debug.apply(_r,i(["Firestore (7.18.0): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.ERROR&&(e=n.map(Or),_r.error.apply(_r,i(["Firestore (7.18.0): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=l.WARN&&(e=n.map(Or),_r.warn.apply(_r,i(["Firestore (7.18.0): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.18.0) INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Lr(t){t||Pr()}var Rr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}function Fr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var jr=(Object.defineProperty(qr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),qr.prototype.isEqual=function(t){return t instanceof qr&&t.projectId===this.projectId&&t.database===this.database},qr.prototype.o=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},qr);function qr(t,e){this.projectId=t,this.database=e||"(default)"}function Gr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Kr,Xr,Hr,Wr=(fi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},fi.prototype.has=function(t){return void 0!==this.get(t)},fi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},fi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},fi.prototype.forEach=function(u){Br(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},fi.prototype._=function(){return zr(this.l)},fi),Qr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=(n(ci,Hr=Error),ci),Jr=(hi.now=function(){return hi.fromMillis(Date.now())},hi.fromDate=function(t){return hi.fromMillis(t.getTime())},hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new hi(e,1e6*(t-1e3*e))},hi.prototype.toDate=function(){return new Date(this.toMillis())},hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hi.prototype.T=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hi),$r=(ai.I=function(t){return new ai(t)},ai.min=function(){return new ai(new Jr(0,0))},ai.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.A=function(){return this.timestamp},ai),Zr=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.P(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},ui.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},ui.prototype.v=function(){return this.segments[this.offset]},ui.prototype.S=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype._=function(){return 0===this.length},ui.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},ui.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Xr=Zr),si.prototype.V=function(t,e,n){return new si(t,e,n)},si.prototype.F=function(){return this.N().join("/")},si.prototype.toString=function(){return this.F()},si.k=function(t){if(0<=t.indexOf("//"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new si(t.split("/").filter(function(t){return 0<t.length}))},si.$=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Kr=Zr),oi.prototype.V=function(t,e,n){return new oi(t,e,n)},oi.M=function(t){return ei.test(t)},oi.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.M(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.F()},oi.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},oi.L=function(){return new oi(["__name__"])},oi.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Yr(Qr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Yr(Qr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.$=function(){return new oi([])},oi),ri=(ii.B=function(t){return new ii(ti.k(t).g(5))},ii.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.P(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.P=function(t,e){return ti.P(t.path,e.path)},ii.W=function(t){return t.length%2==0},ii.j=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Kr&&Kr.apply(this,arguments)||this}function si(){return null!==Xr&&Xr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.R=n}function ai(t){this.timestamp=t}function hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Yr(Qr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ci(t,e){var n=this;return(n=Hr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function fi(t,e){this.h=t,this.u=e,this.l={}}function li(t){return null==t}function pi(t){return-0===t&&1/t==-1/0}function di(t){return"number"==typeof t&&Number.isInteger(t)&&!pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yi(t,e,n,r,i,o,s)}function gi(t){var e,n=t;return null===n.K&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),li(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ju(n.startAt)),n.endAt&&(e+="|ub:",e+=Ju(n.endAt)),n.K=e),n.K}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zu(t.startAt,e.startAt)&&Zu(t.endAt,e.endAt)}function wi(t){return ri.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=(Ei.fromBase64String=function(t){return new Ei(atob(t))},Ei.fromUint8Array=function(t){return new Ei(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ei.prototype.toBase64=function(){return t=this.G,btoa(t);var t},Ei.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},Ei.prototype.H=function(){return 2*this.G.length},Ei.prototype.o=function(t){return Ur(this.G,t.G)},Ei.prototype.isEqual=function(t){return this.G===t.G},Ei);function Ei(t){this.G=t}function Ii(t){this.count=t}bi.Y=new bi("");var Ti,Ni,Ai=(_i.prototype.Z=function(t){return new _i(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},_i.prototype.tt=function(t,e){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},_i.prototype.et=function(t){return new _i(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},_i);function _i(t,e,n,r,i,o,s){void 0===i&&(i=$r.min()),void 0===o&&(o=$r.min()),void 0===s&&(s=bi.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Di(t){switch(t){case Qr.OK:return Pr(),0;case Qr.CANCELLED:case Qr.UNKNOWN:case Qr.DEADLINE_EXCEEDED:case Qr.RESOURCE_EXHAUSTED:case Qr.INTERNAL:case Qr.UNAVAILABLE:case Qr.UNAUTHENTICATED:return;case Qr.INVALID_ARGUMENT:case Qr.NOT_FOUND:case Qr.ALREADY_EXISTS:case Qr.PERMISSION_DENIED:case Qr.FAILED_PRECONDITION:case Qr.ABORTED:case Qr.OUT_OF_RANGE:case Qr.UNIMPLEMENTED:case Qr.DATA_LOSS:return 1;default:return Pr(),0}}function Si(t){if(void 0===t)return xr("GRPC error has no .code"),Qr.UNKNOWN;switch(t){case Ti.OK:return Qr.OK;case Ti.CANCELLED:return Qr.CANCELLED;case Ti.UNKNOWN:return Qr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Qr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Qr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Qr.INTERNAL;case Ti.UNAVAILABLE:return Qr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Qr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Qr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Qr.NOT_FOUND;case Ti.ALREADY_EXISTS:return Qr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Qr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Qr.FAILED_PRECONDITION;case Ti.ABORTED:return Qr.ABORTED;case Ti.OUT_OF_RANGE:return Qr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Qr.UNIMPLEMENTED;case Ti.DATA_LOSS:return Qr.DATA_LOSS;default:return Pr()}}(Ni=Ti=Ti||{})[Ni.OK=0]="OK",Ni[Ni.CANCELLED=1]="CANCELLED",Ni[Ni.UNKNOWN=2]="UNKNOWN",Ni[Ni.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ni[Ni.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ni[Ni.NOT_FOUND=5]="NOT_FOUND",Ni[Ni.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ni[Ni.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ni[Ni.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ni[Ni.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ni[Ni.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ni[Ni.ABORTED=10]="ABORTED",Ni[Ni.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ni[Ni.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ni[Ni.INTERNAL=13]="INTERNAL",Ni[Ni.UNAVAILABLE=14]="UNAVAILABLE",Ni[Ni.DATA_LOSS=15]="DATA_LOSS";var xi=(Ri.prototype.nt=function(t,e){return new Ri(this.P,this.root.nt(t,e,this.P).copy(null,null,Oi.st,null,null))},Ri.prototype.remove=function(t){return new Ri(this.P,this.root.remove(t,this.P).copy(null,null,Oi.st,null,null))},Ri.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ri.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ri.prototype._=function(){return this.root._()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ri.prototype.it=function(){return this.root.it()},Ri.prototype.rt=function(){return this.root.rt()},Ri.prototype.ot=function(t){return this.root.ot(t)},Ri.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ri.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ri.prototype.ht=function(t){return this.root.ht(t)},Ri.prototype.at=function(){return new ki(this.root,null,this.P,!1)},Ri.prototype.ut=function(t){return new ki(this.root,t,this.P,!1)},Ri.prototype.ct=function(){return new ki(this.root,null,this.P,!0)},Ri.prototype.lt=function(t){return new ki(this.root,t,this.P,!0)},Ri),ki=(Li.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Li.prototype.wt=function(){return 0<this.ft.length},Li.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Li),Oi=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype._=function(){return!1},Pi.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Pi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Pi.prototype.min=function(){return this.left._()?this:this.left.min()},Pi.prototype.it=function(){return this.min().key},Pi.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Pi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},Pi.prototype.It=function(){if(this.left._())return Pi.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},Pi.prototype.At=function(){return this.color},Pi.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},Pi.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).gt()).yt()),t},Pi.prototype.Vt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},Pi.prototype.gt=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.Pt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Pi.prototype.bt=function(){if(this.At()&&this.left.At())throw Pr();if(this.right.At())throw Pr();var t=this.left.bt();if(t!==this.right.bt())throw Pr();return t+(this.At()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ri(t,e){this.P=t,this.root=e||Oi.EMPTY}function Ci(){this.size=0}Oi.EMPTY=null,Oi.RED=!0,Oi.st=!1,Oi.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.nt=function(t,e,n){return new Oi(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype._=function(){return!0},Ci.prototype.ot=function(t){return!1},Ci.prototype.ht=function(t){return!1},Ci.prototype.it=function(){return null},Ci.prototype.rt=function(){return null},Ci.prototype.At=function(){return!1},Ci.prototype.pt=function(){return!0},Ci.prototype.bt=function(){return 0},new Ci);var Ui=(ji.prototype.has=function(t){return null!==this.data.get(t)},ji.prototype.first=function(){return this.data.it()},ji.prototype.last=function(){return this.data.rt()},Object.defineProperty(ji.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ji.prototype.indexOf=function(t){return this.data.indexOf(t)},ji.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},ji.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},ji.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},ji.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},ji.prototype.at=function(){return new Vi(this.data.at())},ji.prototype.ut=function(t){return new Vi(this.data.ut(t))},ji.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},ji.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ji.prototype._=function(){return this.data._()},ji.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ji.prototype.isEqual=function(t){if(!(t instanceof ji))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},ji.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ji.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ji.prototype.copy=function(t){var e=new ji(this.P);return e.data=t,e},ji),Vi=(Fi.prototype.dt=function(){return this.Nt.dt().key},Fi.prototype.wt=function(){return this.Nt.wt()},Fi),Mi=new xi(ri.P);function Fi(t){this.Nt=t}function ji(t){this.P=t,this.data=new xi(this.P)}var qi=new xi(ri.P),Gi=new xi(ri.P),Bi=new Ui(ri.P);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ki=new Ui(Ur);function Xi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Hi(t,e){this.targetId=t,this.ee=e}function Wi(t,e,n,r){void 0===n&&(n=bi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Qi=(ao.xt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.Ft.get(t)},ao.prototype.get=function(t){return this.Ft.get(t)},ao.prototype.first=function(){return this.kt.it()},ao.prototype.last=function(){return this.kt.rt()},ao.prototype._=function(){return this.kt._()},ao.prototype.indexOf=function(t){var e=this.Ft.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.kt.ot(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ft.nt(t.key,t),e.kt.nt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ft.remove(t),this.kt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.at(),n=t.kt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.Ft=t,n.kt=e,n},ao),Yi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.$t.get(e);!n||0!==t.type&&3===n.type?this.$t=this.$t.nt(e,t):3===t.type&&1!==n.type?this.$t=this.$t.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.$t=this.$t.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.$t=this.$t.remove(e):1===t.type&&2===n.type?this.$t=this.$t.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.$t=this.$t.nt(e,{type:2,doc:t.doc}):Pr()},uo.prototype.Mt=function(){var n=[];return this.$t.ot(function(t,e){n.push(e)}),n},uo),Ji=(so.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Qi.xt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),$i=(oo.Gt=function(t,e){var n=new Map;return n.set(t,Zi.zt(t,e)),new oo($r.min(),n,Ki,Mi,zi())},oo),Zi=(io.zt=function(t,e){return new io(bi.Y,e,zi(),zi(),zi())},io),to=(Object.defineProperty(ro.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},ro.prototype.ce=function(){var n=zi(),r=zi(),i=zi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new Zi(this.ie,this.re,n,r,i)},ro.prototype.le=function(){this.oe=!1,this.se=co()},ro.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},ro.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},ro.prototype.de=function(){this.ne+=1},ro.prototype.we=function(){--this.ne},ro.prototype.Te=function(){this.oe=!0,this.re=!0},ro),eo=(no.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof ru?this.Ve(r,t.te):t.te instanceof iu&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},no.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Pr()}})},no.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},no.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(wi(e=o.target)?0===i?(n=new ri(e.path),this.ge(r,n,new iu(n,$r.min()))):Lr(1===i):this.Ne(r)!==i&&(this.Se(r),this.Re=this.Re.add(r)))},no.prototype.Fe=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&wi(r.target)&&(n=new ri(r.target.path),null!==o.me.get(n)||o.ke(e,n)||o.ge(e,n,new iu(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=zi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new $i(i,s,this.Re,this.me,r);return this.me=Mi,this.Ae=ho(),this.Re=new Ui(Ur),t},no.prototype.Ve=function(t,e){var n;this.ve(t)&&(n=this.ke(t,e.key)?2:0,this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.xe(e.key).add(t)))},no.prototype.ge=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.ke(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.xe(e).delete(t)),n&&(this.me=this.me.nt(e,n)))},no.prototype.removeTarget=function(t){this.Ie.delete(t)},no.prototype.Ne=function(t){var e=this.be(t).ce();return this.Ee.$e(t).size+e.Yt.size-e.Xt.size},no.prototype.de=function(t){this.be(t).de()},no.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new to,this.Ie.set(t,e)),e},no.prototype.xe=function(t){var e=this.Ae.get(t);return e||(e=new Ui(Ur),this.Ae=this.Ae.nt(t,e)),e},no.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},no.prototype.Se=function(e){var n=this;this.Ie.set(e,new to),this.Ee.$e(e).forEach(function(t){n.ge(e,t,null)})},no.prototype.ke=function(t,e){return this.Ee.$e(t).has(e)},no);function no(t){this.Ee=t,this.Ie=new Map,this.me=Mi,this.Ae=ho(),this.Re=new Ui(Ur)}function ro(){this.ne=0,this.se=co(),this.ie=bi.Y,this.re=!1,this.oe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function oo(t,e,n,r,i){this.X=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function uo(){this.$t=new xi(ri.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ri.P(t.key,e.key)}:function(t,e){return ri.P(t.key,e.key)},this.Ft=qi,this.kt=new xi(this.P)}function ho(){return new xi(ri.P)}function co(){return new xi(ri.P)}function fo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new Jr(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:Pr()}function vo(r,i){var t,e,n,o=yo(r);if(o!==yo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Eo(r.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,To(r.bytesValue).isEqual(To(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),r=Io(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Gr(t)!==Gr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return Pr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,u,a,h,c,f,l=yo(t),p=yo(e);if(l!==p)return Ur(l,p);switch(l){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Io(t.integerValue||t.doubleValue))<(f=Io(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ur(Io(n.latitude),Io(r.latitude)))?i:Ur(Io(n.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;var a=mo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Eo(t),r=Eo(e),i=Ur(n.seconds,r.seconds);return 0!==i?i:Ur(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?To(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ri.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Pr();var t,e,n}(t)}function Eo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e,n=0,r=po.exec(t);Lr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function Ao(t){return t&&"integerValue"in t}function _o(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function So(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var ko={asc:"ASCENDING",desc:"DESCENDING"},Oo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Oe=e};function Lo(t){return{integerValue:""+t}}function Ro(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Co(t,e){return di(e)?Lo(e):Ro(t,e)}function Uo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Mo(t){return Lr(!!t),$r.I((e=Eo(t),new Jr(e.seconds,e.nanos)));var e}function Fo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function jo(t){var e=ti.k(t);return Lr(ns(e)),e}function qo(t,e){return Fo(t.s,e.path)}function Go(t,e){var n=jo(e);return Lr(n.get(1)===t.s.projectId),Lr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ri(Xo(n))}function Bo(t,e){return Fo(t.s,e)}function zo(t){var e=jo(t);return 4===e.length?ti.$():Xo(e)}function Ko(t){return new ti(["projects",t.s.projectId,"databases",t.s.database]).F()}function Xo(t){return Lr(4<t.length&&"documents"===t.get(4)),t.g(5)}function Ho(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function Wo(t,e){var n,r,i,o;if(e instanceof Rs)n={update:Ho(t,e.key,e.value)};else if(e instanceof Ks)n={delete:qo(t,e.key)};else if(e instanceof Cs)n={update:Ho(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof js)n={transform:{document:qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.F(),increment:e.qe};throw Pr()})}};else{if(!(e instanceof Xs))return Pr();n={verify:qo(t,e.key)}}return e.Ue.Be||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:Uo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:Pr()),n}function Qo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?As.updateTime(Mo(n.updateTime)):void 0!==n.exists?As.exists(n.exists):As.Qe():As.Qe();if(t.update){t.update.name;var o=Go(e,t.update.name),s=new Hs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Es(r.map(function(t){return ni.q(t)})));return new Cs(o,s,u,i)}return new Rs(o,s,i)}if(t.delete){var a=Go(e,t.delete);return new Ks(a,i)}if(t.transform){var h=Go(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Lr("REQUEST_TIME"===e.setToServerValue),i=new us):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new as(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ps(r)):"increment"in e?i=new gs(t,e.increment):Pr();var o=ni.q(e.fieldPath);return new Is(o,i)}(e,t)});return Lr(!0===i.exists),new js(h,c)}if(t.verify){var f=Go(e,t.verify);return new Xs(f,i)}return Pr()}function Yo(t,e){return{documents:[Bo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NAN"}};if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,Oo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((e=t).field),direction:(n=e.dir,ko[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Oe||li(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}function $o(t){return{before:t.before,values:t.position}}function Zo(t){var e=!!t.before,n=t.values||[];return new Xu(n,e)}function ts(t){return{fieldPath:t.F()}}function es(t){return ni.q(t.fieldPath)}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function rs(){this.We=void 0}function is(t,e){return t instanceof gs?Ao(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var os,ss,us=(n(cs,ss=rs),cs),as=(n(hs,os=rs),hs);function hs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function cs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=rs),ds);function ds(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=rs),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.qe=e,n}function ws(t){return Io(t.integerValue||t.doubleValue)}function bs(t){return _o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=(Ts.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts),Is=function(t,e){this.field=t,this.transform=e};function Ts(t){(this.fields=t).sort(ni.P)}function Ns(t,e){this.version=t,this.transformResults=e}var As=(_s.Qe=function(){return new _s},_s.exists=function(t){return new _s(void 0,t)},_s.updateTime=function(t){return new _s(t)},Object.defineProperty(_s.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),_s.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},_s);function _s(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}function Ss(){}function xs(t,e,n,r){return t instanceof Rs?function(t,e){if(!Ds(t.Ue,e))return e;var n=Os(e);return new ru(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Cs?function(t,e){if(!Ds(t.Ue,e))return e;var n=Os(e),r=Ms(t,e);return new ru(t.key,n,r,{Ke:!0})}(t,e):t instanceof js?function(t,e,n,r){if(!Ds(t.Ue,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof ru&&(y=n.field(p.field)),null===y&&r instanceof ru&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof as?fs(i,o):i instanceof ps?ys(i,o):(a=ws(u=is(s=i,o))+ws(s.qe),Ao(u)&&Ao(s.qe)?Lo(a):Ro(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Gs(t,i.data(),o);return new ru(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ds((i=t).Ue,o)?new iu(i.key,$r.min()):o);var i,o}function ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof as&&o instanceof as||i instanceof ps&&o instanceof ps?Vr(i.elements,o.elements,vo):i instanceof gs&&o instanceof gs?vo(i.qe,o.qe):i instanceof us&&o instanceof us);var n,r,i,o}))}function Os(t){return t instanceof ru?t.version:$r.min()}var Ps,Ls,Rs=(n(Vs,Ls=Ss),Vs),Cs=(n(Us,Ps=Ss),Us);function Us(t,e,n,r){var i=this;return(i=Ps.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function Vs(t,e,n){var r=this;return(r=Ls.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Ms(t,e){return n=t,r=e instanceof ru?e.data():Hs.empty(),i=new Ws(r),n.Le.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Ge();var n,r,i}var Fs,js=(n(qs,Fs=Ss),qs);function qs(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=As.exists(!0),n}function Gs(t,e,n){for(var r=new Ws(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Bs,zs,Ks=(n($s,zs=Ss),$s),Xs=(n(Js,Bs=Ss),Js),Hs=(Ys.empty=function(){return new Ys({mapValue:{}})},Ys.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Ys.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Ys),Ws=(Qs.prototype.set=function(t,e){return this.Ye(t,e),this},Qs.prototype.delete=function(t){return this.Ye(t,null),this},Qs.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Qs.prototype.Ge=function(){var t=this.Je(ni.$(),this.He);return null!=t?new Hs(t):this.ze},Qs.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Je(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qs);function Qs(t){void 0===t&&(t=Hs.empty()),this.ze=t,this.He=new Map}function Ys(t){this.proto=t}function Js(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.Ue=e,n.type=4,n}function $s(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Zs(t,e){this.key=t,this.version=e}var tu,eu,nu,ru=(n(au,nu=Zs),au.prototype.field=function(t){return this.Xe.field(t)},au.prototype.data=function(){return this.Xe},au.prototype.Ze=function(){return this.Xe.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),iu=(n(uu,eu=Zs),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),ou=(n(su,tu=Zs),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su);function su(){return null!==tu&&tu.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=nu.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Yr(Qr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Yr(Qr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var cu=(fu.prototype.rn=function(t){return new fu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},fu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},fu.prototype.hn=function(){return!li(this.limit)&&"F"===this.en},fu.prototype.an=function(){return!li(this.limit)&&"L"===this.en},fu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},fu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},fu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},fu);function fu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function lu(t,e,n,r,i,o,s,u){return new cu(t,e,n,r,i,o,s,u)}function pu(t){return new cu(t)}function du(t){return null!==t.collectionGroup}function yu(t){var e=hu(t,cu);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new ta(n)),e.nn.push(new ta(ni.L(),"asc"));else{for(var i,o=!1,s=0,u=e.tn;s<u.length;s++){var a=u[s];e.nn.push(a),a.field.O()&&(o=!0)}o||(i=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc",e.nn.push(new ta(ni.L(),i)))}}return e.nn}function vu(t){var e=hu(t,cu);if(!e.sn)if("F"===e.en)e.sn=vi(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ta(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.sn=vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function gu(t,e,n){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function wu(t,e){return new cu(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function bu(t,e){return mi(vu(t),vu(e))&&t.en===e.en}function Eu(t){return gi(vu(t))+"|lt:"+t.en}function Iu(t){return"Query(target="+(n=(e=vu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ju(e.startAt)),e.endAt&&(n+=", endAt: "+Ju(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Tu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ri.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||$u(e.startAt,yu(e),n))&&(!e.endAt||!$u(e.endAt,yu(e),n)));var e,n,r,o}function Nu(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.O()?ri.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):Pr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var Au,_u=(n(Du,Au=function(){}),Du.create=function(t,e,n){if(t.O())return"in"===e||"not-in"===e?this.fn(t,e,n):new Ou(t,e,n);if(Do(n)){if("=="!==e&&"!="!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Du(t,e,n)}if(So(n)){if("=="!==e&&"!="!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Du(t,e,n)}return"array-contains"===e?new Gu(t,n):"in"===e?new Bu(t,n):"not-in"===e?new zu(t,n):"array-contains-any"===e?new Ku(t,n):new Du(t,e,n)},Du.fn=function(t,e,n){return new("in"===e?Pu:Lu)(t,n)},Du.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.dn(mo(e,this.value)):null!==e&&yo(this.value)===yo(e)&&this.dn(mo(e,this.value))},Du.prototype.dn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Du.prototype.ln=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Du);function Du(t,e,n){var r=this;return(r=Au.call(this)||this).field=t,r.op=e,r.value=n,r}var Su,xu,ku,Ou=(n(Uu,ku=_u),Uu.prototype.matches=function(t){var e=ri.P(t.key,this.key);return this.dn(e)},Uu),Pu=(n(Cu,xu=_u),Cu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Cu),Lu=(n(Ru,Su=_u),Ru.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ru);function Ru(t,e){var n=this;return(n=Su.call(this,t,"not-in",e)||this).keys=Vu(0,e),n}function Cu(t,e){var n=this;return(n=xu.call(this,t,"in",e)||this).keys=Vu(0,e),n}function Uu(t,e,n){var r=this;return(r=ku.call(this,t,e,n)||this).key=ri.B(n.referenceValue),r}function Vu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ri.B(t.referenceValue)})}var Mu,Fu,ju,qu,Gu=(n(Yu,qu=_u),Yu.prototype.matches=function(t){var e=t.field(this.field);return _o(e)&&go(e.arrayValue,this.value)},Yu),Bu=(n(Qu,ju=_u),Qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},Qu),zu=(n(Wu,Fu=_u),Wu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!go(this.value.arrayValue,e)},Wu),Ku=(n(Hu,Mu=_u),Hu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!_o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Hu),Xu=function(t,e){this.position=t,this.before=e};function Hu(t,e){return Mu.call(this,t,"array-contains-any",e)||this}function Wu(t,e){return Fu.call(this,t,"not-in",e)||this}function Qu(t,e){return ju.call(this,t,"in",e)||this}function Yu(t,e){return qu.call(this,t,"array-contains",e)||this}function Ju(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function $u(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.O()?ri.P(ri.B(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Zu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var ta=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ea=(ga.prototype.Tn=function(t,e,n){for(var r,i,o,s=n.En,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Rs?new ru(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Cs?function(t,e,n){if(!Ds(t.Ue,e))return new ou(t.key,n.version);var r=Ms(t,e);return new ru(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof js?function(t,e,n){if(Lr(null!=n.transformResults),!Ds(t.Ue,e))return new ou(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof ru&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof as?fs(i,o):i instanceof ps?ys(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Gs(t,r.data(),i);return new ru(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new iu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ga.prototype.In=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=xs(i,e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=xs(a,e,o,this.wn))}return e},ga.prototype.mn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.In(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,ks)&&Vr(this.baseMutations,t.baseMutations,ks)},ga),na=(va.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new va(t,e,n,r)},va),ra=(ya.prototype.catch=function(t){return this.next(void 0,t)},ya.prototype.next=function(r,i){var o=this;return this.yn&&Pr(),this.yn=!0,this.gn?this.error?this.pn(i,this.error):this.bn(r,this.result):new ya(function(e,n){o.Pn=function(t){o.bn(r,t).next(e,n)},o.Vn=function(t){o.pn(i,t).next(e,n)}})},ya.prototype.vn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ya.prototype.Sn=function(t){try{var e=t();return e instanceof ya?e:ya.resolve(e)}catch(t){return ya.reject(t)}},ya.prototype.bn=function(t,e){return t?this.Sn(function(){return t(e)}):ya.resolve(e)},ya.prototype.pn=function(t,e){return t?this.Sn(function(){return t(e)}):ya.reject(e)},ya.resolve=function(n){return new ya(function(t,e){t(n)})},ya.reject=function(n){return new ya(function(t,e){e(n)})},ya.Dn=function(t){return new ya(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ya.Cn=function(t){for(var n=ya.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ya.resolve(t):e()})}(r[e]);return n},ya.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Dn(i)},ya),ia=(Object.defineProperty(da.prototype,"readTime",{get:function(){return this.kn},set:function(t){this.kn=t},enumerable:!1,configurable:!0}),da.prototype.xn=function(t,e){this.$n(),this.readTime=e,this.Nn.set(t.key,t)},da.prototype.Mn=function(t,e){this.$n(),e&&(this.readTime=e),this.Nn.set(t,null)},da.prototype.On=function(t,e){this.$n();var n=this.Nn.get(e);return void 0!==n?ra.resolve(n):this.Ln(t,e)},da.prototype.getEntries=function(t,e){return this.qn(t,e)},da.prototype.apply=function(t){return this.$n(),this.Fn=!0,this.Bn(t)},da.prototype.$n=function(){},da),oa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",sa=(pa.prototype.Qn=function(t){this.Un.push(t)},pa.prototype.Wn=function(){this.Un.forEach(function(t){return t()})},pa),ua=(la.prototype.zn=function(e,n){var r=this;return this.Kn.Hn(e,n).next(function(t){return r.Yn(e,n,t)})},la.prototype.Yn=function(t,r,i){return this.jn.On(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].In(r,t);return t})},la.prototype.Jn=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].In(t,e);o=o.nt(t,e)}),o},la.prototype.Xn=function(e,t){var n=this;return this.jn.getEntries(e,t).next(function(t){return n.Zn(e,t)})},la.prototype.Zn=function(r,i){var o=this;return this.Kn.ts(r,i).next(function(t){var e=o.Jn(r,i,t),n=Mi;return e.forEach(function(t,e){e=e||new iu(t,$r.min()),n=n.nt(t,e)}),n})},la.prototype.es=function(t,e,n){return r=e,ri.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):du(e)?this.ss(t,e,n):this.rs(t,e,n);var r},la.prototype.ns=function(t,e){return this.zn(t,new ri(e)).next(function(t){var e=qi;return t instanceof ru&&(e=e.nt(t.key,t)),e})},la.prototype.ss=function(n,r,i){var o=this,s=r.collectionGroup,u=qi;return this.Gn.os(n,s).next(function(t){return ra.forEach(t,function(t){var e=r.rn(t.child(s));return o.rs(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},la.prototype.rs=function(e,n,t){var c,f,r=this;return this.jn.es(e,n,t).next(function(t){return c=t,r.Kn.hs(e,n)}).next(function(t){return f=t,r.as(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=xs(s,a,a,r.wn);c=h instanceof ru?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Tu(n,e)||(c=c.remove(t))}),c})},la.prototype.as=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.jn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ru&&(h=h.nt(t,e))}),h})},la),aa=(fa.ls=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new fa(t,e.fromCache,n,r)},fa),ha=(ca.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ca.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},ca);function ca(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function fa(t,e,n,r){this.targetId=t,this.fromCache=e,this.us=n,this.cs=r}function la(t,e,n){this.jn=t,this.Kn=e,this.Gn=n}function pa(){this.Un=[]}function da(){this.Nn=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function ya(t){var e=this;this.Pn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.yn=!1,t(function(t){e.gn=!0,e.result=t,e.Pn&&e.Pn(t)},function(t){e.gn=!0,e.error=t,e.Vn&&e.Vn(t)})}function va(t,e,n,r){this.batch=t,this.An=e,this.En=n,this.Rn=r}function ga(t,e,n,r){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=r}function ma(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}ha.Ts=-1;var wa,ba=(Da.prototype.reset=function(){this.Ps=0},Da.prototype.ys=function(){this.Ps=this.Rs},Da.prototype.ps=function(t){var e=this;this.cancel();var n=Math.floor(this.Ps+this.bs()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ps+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Es.vs(this.Is,i,function(){return e.gs=Date.now(),t()}),this.Ps*=this.As,this.Ps<this.ms&&(this.Ps=this.ms),this.Ps>this.Rs&&(this.Ps=this.Rs)},Da.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},Da.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},Da.prototype.bs=function(){return(Math.random()-.5)*this.Ps},Da),Ea=(_a.delete=function(t){return Sr("SimpleDb","Removing database:",t),La(window.indexedDB.deleteDatabase(t)).vn()},_a.Fs=function(){if("undefined"==typeof indexedDB)return!1;if(_a.ks())return!0;var t=p(),e=_a.Ns(t),n=0<e&&e<10,r=_a.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},_a.ks=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.$s)},_a.Ms=function(t,e){return t.store(e)},_a.Ns=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},_a.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},_a.prototype.Os=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Ta("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Yr(Qr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Ta(e))},i.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Cs.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Sr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Ls&&(this.db.onversionchange=function(t){return o.Ls(t)}),this.db)]}})})},_a.prototype.qs=function(e){this.Ls=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},_a.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Os()];case 2:return a.db=t.sent(),e=xa.open(a.db,s?"readonly":"readwrite",h),n=c(e).catch(function(t){return e.abort(t),ra.reject(t)}).vn(),r={},n.catch(function(){}),[4,e.Bs];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Sr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},_a.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},_a),Ia=(Object.defineProperty(Aa.prototype,"gn",{get:function(){return this.Qs},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"js",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(Aa.prototype,"cursor",{set:function(t){this.Us=t},enumerable:!1,configurable:!0}),Aa.prototype.done=function(){this.Qs=!0},Aa.prototype.Ks=function(t){this.Ws=t},Aa.prototype.delete=function(){return La(this.Us.delete())},Aa),Ta=(n(Na,wa=Yr),Na);function Na(t){var e=this;return(e=wa.call(this,Qr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Aa(t){this.Us=t,this.Qs=!1,this.Ws=null}function _a(t,e,n){this.name=t,this.version=e,this.Cs=n,12.2===_a.Ns(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Da(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Es=t,this.Is=e,this.ms=n,this.As=r,this.Rs=i,this.Ps=0,this.Vs=null,this.gs=Date.now(),this.reset()}function Sa(t){return"IndexedDbTransactionError"===t.name}var xa=(Pa.open=function(t,e,n){try{return new Pa(t.transaction(n,e))}catch(t){throw new Ta(t)}},Object.defineProperty(Pa.prototype,"Bs",{get:function(){return this.Gs.promise},enumerable:!1,configurable:!0}),Pa.prototype.abort=function(t){t&&this.Gs.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Pa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ka(e)},Pa),ka=(Oa.prototype.put=function(t,e){return La(void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Oa.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),La(this.store.add(t))},Oa.prototype.get=function(e){var n=this;return La(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},Oa.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),La(this.store.delete(t))},Oa.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),La(this.store.count())},Oa.prototype.zs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Hs(n,function(t,e){r.push(e)}).next(function(){return r})},Oa.prototype.Ys=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Js=!1;var r=this.cursor(n);return this.Hs(r,function(t,e,n){return n.delete()})},Oa.prototype.Xs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Hs(r,e)},Oa.prototype.Zs=function(i){var t=this.cursor({});return new ra(function(n,r){t.onerror=function(t){var e=Ca(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Oa.prototype.Hs=function(t,s){var u=[];return new ra(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ia(i),(n=s(i.primaryKey,i.value,e))instanceof ra&&(r=n.catch(function(t){return e.done(),ra.reject(t)}),u.push(r)),e.gn?o():null===e.js?i.continue():i.continue(e.js)):o()}}).next(function(){return ra.Dn(u)})},Oa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Oa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Js?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Oa);function Oa(t){this.store=t}function Pa(t){var n=this;this.transaction=t,this.aborted=!1,this.Gs=new ma,this.transaction.oncomplete=function(){n.Gs.resolve()},this.transaction.onabort=function(){t.error?n.Gs.reject(new Ta(t.error)):n.Gs.resolve()},this.transaction.onerror=function(t){var e=Ca(t.target.error);n.Gs.reject(new Ta(e))}}function La(t){return new ra(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ca(t.target.error);r(e)}})}var Ra=!1;function Ca(t){var e=Ea.Ns(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ra||(Ra=!0,setTimeout(function(){throw r},0)),r}}return t}function Ua(){return"undefined"!=typeof window?window:null}function Va(){return"undefined"!=typeof document?document:null}var Ma=(qa.ii=function(t,e,n,r,i){var o=new qa(t,e,Date.now()+n,r,i);return o.start(n),o},qa.prototype.start=function(t){var e=this;this.ri=setTimeout(function(){return e.oi()},t)},qa.prototype.Ds=function(){return this.oi()},qa.prototype.cancel=function(t){null!==this.ri&&(this.clearTimeout(),this.si.reject(new Yr(Qr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},qa.prototype.oi=function(){var e=this;this.ti.hi(function(){return null!==e.ri?(e.clearTimeout(),e.op().then(function(t){return e.si.resolve(t)})):Promise.resolve()})},qa.prototype.clearTimeout=function(){null!==this.ri&&(this.ni(this),clearTimeout(this.ri),this.ri=null)},qa),Fa=(Object.defineProperty(ja.prototype,"Ei",{get:function(){return this.ci},enumerable:!1,configurable:!0}),ja.prototype.hi=function(t){this.enqueue(t)},ja.prototype.Ii=function(t){this.mi(),this.Ai(t)},ja.prototype.Ri=function(t){return this.mi(),this.Ai(t)},ja.prototype.Pi=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.mi(),this.ci?[3,2]:(this.ci=!0,(e=Va())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ti),[4,this.Ri(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ja.prototype.enqueue=function(t){return this.mi(),this.ci?new Promise(function(t){}):this.Ai(t)},ja.prototype.Vi=function(t){var e=this;this.ui.push(t),this.hi(function(){return e.gi()})},ja.prototype.gi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ui.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ui[0]()];case 2:return t.sent(),this.ui.shift(),this.wi.reset(),[3,4];case 3:if(!Sa(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ui.length&&this.wi.ps(function(){return n.gi()}),t.label=5;case 5:return[2]}})})},ja.prototype.Ai=function(t){var r=this,e=this.ai.then(function(){return r.fi=!0,t().catch(function(t){throw r._i=t,r.fi=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.fi=!1,t})});return this.ai=e},ja.prototype.vs=function(t,e,n){var r=this;this.mi(),-1<this.di.indexOf(t)&&(e=0);var i=Ma.ii(this,t,e,n,function(t){return r.yi(t)});return this.li.push(i),i},ja.prototype.mi=function(){this._i&&Pr()},ja.prototype.pi=function(){},ja.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ai];case 1:t.sent(),t.label=2;case 2:if(e!==this.ai)return[3,0];t.label=3;case 3:return[2]}})})},ja.prototype.vi=function(t){for(var e=0,n=this.li;e<n.length;e++)if(n[e].Is===t)return!0;return!1},ja.prototype.Si=function(r){var i=this;return this.bi().then(function(){i.li.sort(function(t,e){return t.ei-e.ei});for(var t=0,e=i.li;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.Is===r)break}return i.bi()})},ja.prototype.Di=function(t){this.di.push(t)},ja.prototype.yi=function(t){var e=this.li.indexOf(t);this.li.splice(e,1)},ja);function ja(){var e=this;this.ai=Promise.resolve(),this.ui=[],this.ci=!1,this.li=[],this._i=null,this.fi=!1,this.di=[],this.wi=new ba(this,"async_queue_retry"),this.Ti=function(){var t=Va();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.wi.Ss()};var t=Va();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ti)}function qa(t,e,n,r,i){this.ti=t,this.Is=e,this.ei=n,this.op=r,this.ni=i,this.si=new ma,this.then=this.si.promise.then.bind(this.si.promise),this.si.promise.catch(function(t){})}function Ga(t,e){if(xr("AsyncQueue",e+": "+t),Sa(t))return new Yr(Qr.UNAVAILABLE,e+": "+t);throw t}function Ba(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ur(n,i);return 0===s?Ur(r,o):s}var za=(Wa.prototype.Fi=function(){return++this.Ni},Wa.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Ba(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Wa.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Wa),Ka={xi:!1,$i:0,Mi:0,Oi:0},Xa=(Ha.Ui=function(t){return new Ha(t,Ha.Qi,Ha.Wi)},Ha);function Ha(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Wa(t){this.Ci=t,this.buffer=new Ui(Ba),this.Ni=0}Xa.ji=-1,Xa.Ki=1048576,Xa.Gi=41943040,Xa.Qi=10,Xa.Wi=1e3,Xa.zi=new Xa(Xa.Gi,Xa.Qi,Xa.Wi),Xa.Hi=new Xa(Xa.ji,0,0);var Qa=($a.prototype.start=function(t){this.Yi.params.Li!==Xa.ji&&this.Zi(t)},$a.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty($a.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),$a.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ti.vs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return Sa(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ec(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},$a),Ya=(Ja.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},Ja.prototype.rr=function(t,e){var n=this;if(0===e)return ra.resolve(ha.Ts);var r=new za(e);return this.nr.pe(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},Ja.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},Ja.prototype.ar=function(t,e){return this.nr.ar(t,e)},Ja.prototype.ur=function(e,n){var r=this;return this.params.Li===Xa.ji?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),ra.resolve(Ka)):this.cr(e).next(function(t){return t<r.params.Li?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Ka):r.lr(e,n)})},Ja.prototype.cr=function(t){return this.nr.cr(t)},Ja.prototype.lr=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>c.params.Bi?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Bi+" from "+t),c.params.Bi):t,s=Date.now(),c.rr(e,i)}).next(function(t){return r=t,u=Date.now(),c.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.ar(e,r)}).next(function(t){return h=Date.now(),Dr()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),ra.resolve({xi:!0,$i:i,Mi:o,Oi:t})})},Ja);function Ja(t,e){this.nr=t,this.params=e}function $a(t,e){this.Yi=t,this.ti=e,this.Ji=!1,this.Xi=null}function Za(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=th(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return th(o)}function th(t){return t+""}function eh(t){var e=t.length;if(Lr(2<=e),2===e)return Lr(""===t.charAt(0)&&""===t.charAt(1)),ti.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new ti(r)}var nh=function(t){this._r=t};function rh(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Go(n,r.name),s=Mo(r.updateTime),u=new Hs({mapValue:{fields:r.fields}}),new ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ri.j(e.noDocument.path),h=ah(e.noDocument.readTime);return new iu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ri.j(e.unknownDocument.path),f=ah(e.unknownDocument.version);return new ou(c,f)}return Pr()}function ih(t,e,n){var r,i,o=oh(n),s=e.key.path.p().N();if(e instanceof ru){var u={name:qo(r=t._r,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Uo(r,i.version.A())},a=e.hasCommittedMutations;return new qh(null,null,u,a,o,s)}if(e instanceof iu){var h=e.key.path.N(),c=uh(e.version),f=e.hasCommittedMutations;return new qh(null,new Fh(h,c),null,f,o,s)}if(e instanceof ou){var l=e.key.path.N(),p=uh(e.version);return new qh(new jh(l,p),null,null,!0,o,s)}return Pr()}function oh(t){var e=t.A();return[e.seconds,e.nanoseconds]}function sh(t){var e=new Jr(t[0],t[1]);return $r.I(e)}function uh(t){var e=t.A();return new kh(e.seconds,e.nanoseconds)}function ah(t){var e=new Jr(t.seconds,t.nanoseconds);return $r.I(e)}function hh(e,t){var n=(t.baseMutations||[]).map(function(t){return Qo(e._r,t)}),r=t.mutations.map(function(t){return Qo(e._r,t)}),i=Jr.fromMillis(t.localWriteTimeMs);return new ea(t.batchId,i,n,r)}function ch(t){var e,n=ah(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?ah(t.lastLimboFreeSnapshotVersion):$r.min(),i=void 0!==t.query.documents?(Lr(1===(e=t.query).documents.length),vu(pu(zo(e.documents[0])))):function(t){var e,n=zo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Lr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return _u.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return _u.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=es(t.unaryFilter.field);return _u.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=es(t.unaryFilter.field);return _u.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}(e)]:void 0!==e.fieldFilter?[(n=e,_u.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ta(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=li(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=Zo(r.startAt));var l=null;return r.endAt&&(l=Zo(r.endAt)),vu(lu(n,o,u,s,c,"F",f,l))}(t.query);return new Ai(i,t.targetId,0,t.lastListenSequenceNumber,n,r,bi.fromBase64String(t.resumeToken))}function fh(t,e){var n=uh(e.X),r=uh(e.lastLimboFreeSnapshotVersion),i=(wi(e.target)?Yo:Jo)(t._r,e.target),o=e.resumeToken.toBase64();return new Bh(e.targetId,gi(e.target),n,o,e.sequenceNumber,r,i)}var lh=(ph.Tr=function(t,e,n,r){return Lr(""!==t.uid),new ph(t.Er()?t.uid:"",e,n,r)},ph.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).Xs({index:Uh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ph.prototype.mr=function(d,y,v,g){var m=this,w=gh(d),b=vh(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new ea(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Wo(e._r,t)}),o=r.mutations.map(function(t){return Wo(e._r,t)}),new Uh(n,r.batchId,r.wn.toMillis(),i,o)),a=[],h=new Ui(function(t,e){return Ur(t.F(),e.F())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Vh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Vh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.Gn.Ar(d,t))}),d.Qn(function(){m.wr[t]=s.keys()}),ra.Dn(a).next(function(){return s})})},ph.prototype.Rr=function(t,e){var n=this;return vh(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),hh(n.serializer,t)):null})},ph.prototype.Pr=function(t,n){var r=this;return this.wr[n]?ra.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},ph.prototype.Vr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return vh(t).Xs({index:Uh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=hh(r.serializer,e)),n.done()}).next(function(){return o})},ph.prototype.gr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return vh(t).Xs({index:Uh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ph.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).zs(Uh.userMutationsIndex,n).next(function(t){return t.map(function(t){return hh(e.serializer,t)})})},ph.prototype.Hn=function(u,a){var h=this,t=Vh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return gh(u).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);if(r===h.userId&&a.path.isEqual(s))return vh(u).get(o).next(function(t){if(!t)throw Pr();Lr(t.userId===h.userId),c.push(hh(h.serializer,t))});n.done()}).next(function(){return c})},ph.prototype.ts=function(r,t){var a=this,h=new Ui(Ur),i=[];return t.forEach(function(u){var t=Vh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=gh(r).Xs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),ra.Dn(i).next(function(){return a.pr(r,h)})},ph.prototype.hs=function(t,e){var u=this,a=e.path,h=a.length+1,n=Vh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Ui(Ur);return gh(t).Xs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.pr(t,c)})},ph.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(vh(e).get(t).next(function(t){if(null===t)throw Pr();Lr(t.userId===n.userId),r.push(hh(n.serializer,t))}))}),ra.Dn(i).next(function(){return r})},ph.prototype.br=function(e,n){var r=this;return yh(e.vr,this.userId,n).next(function(t){return e.Qn(function(){r.Sr(n.batchId)}),ra.forEach(t,function(t){return r.dr.Dr(e,t)})})},ph.prototype.Sr=function(t){delete this.wr[t]},ph.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return ra.resolve();var e=IDBKeyRange.lowerBound(Vh.prefixForUser(o.userId)),i=[];return gh(n).Xs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=eh(t[1]),i.push(r)):n.done()}).next(function(){Lr(0===i.length)})})},ph.prototype.Nr=function(t,e){return dh(t,this.userId,e)},ph.prototype.Fr=function(t){var e=this;return mh(t).get(this.userId).next(function(t){return t||new Ch(e.userId,-1,"")})},ph);function ph(t,e,n,r){this.userId=t,this.serializer=e,this.Gn=n,this.dr=r,this.wr={}}function dh(t,o,e){var n=Vh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return gh(t).Xs({range:r,Js:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function yh(t,e,n){var r=t.store(Uh.store),i=t.store(Vh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Xs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Lr(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Vh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return ra.Dn(o).next(function(){return h})}function vh(t){return hc.Ms(t,Uh.store)}function gh(t){return hc.Ms(t,Vh.store)}function mh(t){return hc.Ms(t,Ch.store)}var wh,bh=(Eh.prototype.xn=function(t,e,n){return Th(t).put(Nh(e),n)},Eh.prototype.Mn=function(t,e){var n=Th(t),r=Nh(e);return n.delete(r)},Eh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Eh.prototype.On=function(t,e){var n=this;return Th(t).get(Nh(e)).next(function(t){return n.xr(t)})},Eh.prototype.$r=function(t,e){var n=this;return Th(t).get(Nh(e)).next(function(t){var e=n.xr(t);return e?{Mr:e,size:Ah(t)}:null})},Eh.prototype.getEntries=function(t,e){var r=this,i=Mi;return this.Or(t,e,function(t,e){var n=r.xr(e);i=i.nt(t,n)}).next(function(){return i})},Eh.prototype.Lr=function(t,e){var r=this,i=Mi,o=new xi(ri.P);return this.Or(t,e,function(t,e){var n=r.xr(e);o=n?(i=i.nt(t,n),o.nt(t,Ah(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{qr:i,Br:o}})},Eh.prototype.Or=function(t,e,i){if(e._())return ra.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.at(),s=o.dt();return Th(t).Xs({range:n},function(t,e,n){for(var r=ri.j(t);s&&ri.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.Ks(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Eh.prototype.es=function(t,i,e){var n,r,o,s=this,u=qi,a=i.path.length+1,h={};return e.isEqual($r.min())?(n=i.path.N(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=oh(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=qh.collectionReadTimeIndex),Th(t).Xs(h,function(t,e,n){var r;t.length===a&&(r=rh(s.serializer,e),i.path.D(r.key.path)?r instanceof ru&&Tu(i,r)&&(u=u.nt(r.key,r)):n.done())}).next(function(){return u})},Eh.prototype.Ur=function(t,e){var r=this,i=Mi,o=oh(e),n=Th(t),s=IDBKeyRange.lowerBound(o,!0);return n.Xs({index:qh.readTimeIndex,range:s},function(t,e){var n=rh(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:sh(o)}})},Eh.prototype.Wr=function(t){var e=Th(t),r=$r.min();return e.Xs({index:qh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=sh(e.readTime)),n.done()}).next(function(){return r})},Eh.prototype.jr=function(t){return new Eh.Kr(this,!!t&&t.Gr)},Eh.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Eh.prototype.getMetadata=function(t){return Ih(t).get(Gh.key).next(function(t){return Lr(!!t),t})},Eh.prototype.kr=function(t,e){return Ih(t).put(Gh.key,e)},Eh.prototype.xr=function(t){if(t){var e=rh(this.serializer,t);return e instanceof iu&&e.version.isEqual($r.min())?null:e}return null},Eh);function Eh(t,e){this.serializer=t,this.Gn=e}function Ih(t){return hc.Ms(t,Gh.store)}function Th(t){return hc.Ms(t,qh.store)}function Nh(t){return t.path.N()}function Ah(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}function _h(t,e){var n=this;return(n=wh.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}bh.Kr=(n(_h,wh=ia),_h.prototype.Bn=function(s){var u=this,a=[],h=0,c=new Ui(function(t,e){return Ur(t.F(),e.F())});return this.Nn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=ih(u.Hr.serializer,e,u.readTime),c=c.add(t.path.p()),r=Ah(n),h+=r-o,a.push(u.Hr.xn(s,t,n))):(h-=o,u.Gr?(i=ih(u.Hr.serializer,new iu(t,$r.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),c.forEach(function(t){a.push(u.Hr.Gn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,h)),ra.Dn(a)},_h.prototype.Ln=function(t,e){var n=this;return this.Hr.$r(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Mr)})},_h.prototype.qn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},_h);var Dh=(Rh.prototype.Ar=function(t,e){return this.Jr.add(e),ra.resolve()},Rh.prototype.os=function(t,e){return ra.resolve(this.Jr.getEntries(e))},Rh),Sh=(Lh.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Ui(ti.P),i=!r.has(n);return this.index[e]=r.add(n),i},Lh.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Lh.prototype.getEntries=function(t){return(this.index[t]||new Ui(ti.P)).N()},Lh),xh=(Ph.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Lr(t<e&&0<=t&&e<=10);var o,s=new xa(r);t<1&&1<=e&&(n.createObjectStore(Oh.store),(o=n).createObjectStore(Ch.store,{keyPath:Ch.keyPath}),o.createObjectStore(Uh.store,{keyPath:Uh.keyPath,autoIncrement:!0}).createIndex(Uh.userMutationsIndex,Uh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Vh.store),Hh(n),n.createObjectStore(qh.store));var u,a=ra.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(zh.store),u.deleteObjectStore(Bh.store),u.deleteObjectStore(Kh.store),Hh(n)),a=a.next(function(){return t=s.store(Kh.store),e=new Kh(0,0,$r.min().A(),0),t.put(Kh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Uh.store).zs().next(function(t){r.deleteObjectStore(Uh.store),r.createObjectStore(Uh.store,{keyPath:Uh.keyPath,autoIncrement:!0}).createIndex(Uh.userMutationsIndex,Uh.userMutationsKeyPath,{unique:!0});var e=i.store(Uh.store),n=t.map(function(t){return e.put(t)});return ra.Dn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Wh.store,{keyPath:Wh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Gh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(qh.store)).createIndex(qh.readTimeIndex,qh.readTimeIndexPath,{unique:!1}),t.createIndex(qh.collectionReadTimeIndex,qh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Ph.prototype.addDocumentGlobal=function(e){var n=0;return e.store(qh.store).Xs(function(t,e){n+=Ah(e)}).next(function(){var t=new Gh(n);return e.store(Gh.store).put(Gh.key,t)})},Ph.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Ch.store),e=r.store(Uh.store);return t.zs().next(function(t){return ra.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.zs(Uh.userMutationsIndex,t).next(function(t){return ra.forEach(t,function(t){Lr(t.userId===n.userId);var e=hh(i.serializer,t);return yh(r,n.userId,e).next(function(){})})})})})},Ph.prototype.ensureSequenceNumbers=function(t){var s=t.store(zh.store),e=t.store(qh.store);return t.store(Kh.store).get(Kh.key).next(function(i){var o=[];return e.Xs(function(t,e){var n=new ti(t),r=[0,Za(n)];o.push(s.get(r).next(function(t){return t?ra.resolve():s.put(new zh(0,Za(n),i.highestListenSequenceNumber))}))}).next(function(){return ra.Dn(o)})})},Ph.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:Za(n)})}}t.createObjectStore(Xh.store,{keyPath:Xh.keyPath});var i=e.store(Xh.store),o=new Sh;return e.store(qh.store).Xs({Js:!0},function(t,e){return r(new ti(t).p())}).next(function(){return e.store(Vh.store).Xs({Js:!0},function(t,e){t[0];var n=t[1];return r((t[2],eh(n)).p())})})},Ph.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Bh.store);return o.Xs(function(t,e){var n=ch(e),r=fh(i.serializer,n);return o.put(r)})},Ph),kh=function(t,e){this.seconds=t,this.nanoseconds=e},Oh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ph(t){this.serializer=t}function Lh(){this.index={}}function Rh(){this.Jr=new Sh}Oh.store="owner",Oh.key="owner";var Ch=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ch.store="mutationQueues",Ch.keyPath="userId";var Uh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Uh.store="mutations",Uh.keyPath="batchId",Uh.userMutationsIndex="userMutationsIndex",Uh.userMutationsKeyPath=["userId","batchId"];var Vh=(Mh.prefixForUser=function(t){return[t]},Mh.prefixForPath=function(t,e){return[t,Za(e)]},Mh.key=function(t,e,n){return[t,Za(e),n]},Mh);function Mh(){}Vh.store="documentMutations",Vh.PLACEHOLDER=new Vh;var Fh=function(t,e){this.path=t,this.readTime=e},jh=function(t,e){this.path=t,this.version=e},qh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};qh.store="remoteDocuments",qh.readTimeIndex="readTimeIndex",qh.readTimeIndexPath="readTime",qh.collectionReadTimeIndex="collectionReadTimeIndex",qh.collectionReadTimeIndexPath=["parentPath","readTime"];var Gh=function(t){this.byteSize=t};Gh.store="remoteDocumentGlobal",Gh.key="remoteDocumentGlobalKey";var Bh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Bh.store="targets",Bh.keyPath="targetId",Bh.queryTargetsIndexName="queryTargetsIndex",Bh.queryTargetsKeyPath=["canonicalId","targetId"];var zh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};zh.store="targetDocuments",zh.keyPath=["targetId","path"],zh.documentTargetsIndex="documentTargetsIndex",zh.documentTargetsKeyPath=["path","targetId"];var Kh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Kh.key="targetGlobalKey",Kh.store="targetGlobal";var Xh=function(t,e){this.collectionId=t,this.parent=e};function Hh(t){t.createObjectStore(zh.store,{keyPath:zh.keyPath}).createIndex(zh.documentTargetsIndex,zh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Bh.store,{keyPath:Bh.keyPath}).createIndex(Bh.queryTargetsIndexName,Bh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Kh.store)}Xh.store="collectionParents",Xh.keyPath=["collectionId","parent"];var Wh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Wh.store="clientMetadata",Wh.keyPath="clientId";var Qh=i(i(i([Ch.store,Uh.store,Vh.store,qh.store,Bh.store,Oh.store,Kh.store,zh.store],[Wh.store]),[Gh.store]),[Xh.store]),Yh=(Jh.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return ra.resolve();var r=e.S(),i=e.p();t.Qn(function(){n.Xr.add(e)});var o={collectionId:r,parent:Za(i)};return $h(t).put(o)},Jh.prototype.os=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return $h(t).zs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(eh(r.parent))}return o})},Jh);function Jh(){this.Xr=new Sh}function $h(t){return hc.Ms(t,Xh.store)}var Zh=(nc.prototype.next=function(){return this.Zr+=2,this.Zr},nc.to=function(){return new nc(0)},nc.eo=function(){return new nc(-1)},nc),tc=(ec.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new Zh(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},ec.prototype.ro=function(t){return this.so(t).next(function(t){return $r.I(new Jr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ec.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},ec.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},ec.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},ec.prototype.lo=function(t,e){return this.uo(t,e)},ec.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return rc(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.io(e,t)})},ec.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return rc(r).Xs(function(t,e){var n=ch(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return ra.Dn(a)}).next(function(){return u})},ec.prototype.pe=function(t,r){return rc(t).Xs(function(t,e){var n=ch(e);r(n)})},ec.prototype.so=function(t){return ic(t).get(Kh.key).next(function(t){return Lr(null!==t),t})},ec.prototype.io=function(t,e){return ic(t).put(Kh.key,e)},ec.prototype.uo=function(t,e){return rc(t).put(fh(this.serializer,e))},ec.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ec.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},ec.prototype.wo=function(t,i){var e=gi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return rc(t).Xs({range:n,index:Bh.queryTargetsIndexName},function(t,e,n){var r=ch(e);mi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},ec.prototype.To=function(n,t,r){var i=this,o=[],s=oc(n);return t.forEach(function(t){var e=Za(t.path);o.push(s.put(new zh(r,e))),o.push(i.dr.Eo(n,r,t))}),ra.Dn(o)},ec.prototype.Io=function(n,t,r){var i=this,o=oc(n);return ra.forEach(t,function(t){var e=Za(t.path);return ra.Dn([o.delete([r,e]),i.dr.mo(n,r,t)])})},ec.prototype.fo=function(t,e){var n=oc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ec.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=oc(t),o=zi();return r.Xs({range:n,Js:!0},function(t,e,n){var r=eh(t[1]),i=new ri(r);o=o.add(i)}).next(function(){return o})},ec.prototype.Nr=function(t,e){var n=Za(e.path),r=IDBKeyRange.bound([n],[Mr(n)],!1,!0),i=0;return oc(t).Xs({index:zh.documentTargetsIndex,Js:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ec.prototype.Me=function(t,e){return rc(t).get(e).next(function(t){return t?ch(t):null})},ec);function ec(t,e){this.dr=t,this.serializer=e}function nc(t){this.Zr=t}function rc(t){return hc.Ms(t,Bh.store)}function ic(t){return hc.Ms(t,Kh.store)}function oc(t){return hc.Ms(t,zh.store)}var sc,uc="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ac=(n(fc,sc=sa),fc),hc=(cc.Ms=function(t,e){if(t instanceof ac)return Ea.Ms(t.vr,e);throw Pr()},cc.prototype.start=function(){var e=this;return this.$o().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Yr(Qr.FAILED_PRECONDITION,uc);return e.Mo(),e.Oo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new ha(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},cc.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},cc.prototype.Bo=function(n){var t=this;this.Fo.qs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},cc.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Es.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.$o()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},cc.prototype.$o=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return pc(e).put(new Wh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Es.Vi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(Sa(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Es.Vi(function(){return n.Co(t)}),n.isPrimary=t})},cc.prototype.Qo=function(t){var e=this;return lc(t).get(Oh.key).next(function(t){return ra.resolve(e.Go(t))})},cc.prototype.zo=function(t){return pc(t).delete(this.clientId)},cc.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=cc.Ms(t,Wh.store);return r.zs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ra.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.xo)for(n=0,r=e;n<r.length;n++)i=r[n],this.xo.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},cc.prototype.Lo=function(){var t=this;this.So=this.Es.vs("client_metadata_refresh",4e3,function(){return t.$o().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},cc.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},cc.prototype.Wo=function(e){var i=this;return this.Vo?ra.resolve(!0):lc(e).get(Oh.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new Yr(Qr.FAILED_PRECONDITION,uc);return!1}}return!(!i.networkEnabled||!i.inForeground)||pc(e).zs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},cc.prototype.th=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.jo(t).next(function(){return e.zo(t)})}).catch(function(t){Sr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},cc.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},cc.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return pc(t).zs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(cc.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),cc.prototype.oh=function(t){return lh.Tr(t,this.serializer,this.Gn,this.dr)},cc.prototype.hh=function(){return this.ko},cc.prototype.ah=function(){return this.jn},cc.prototype.uh=function(){return this.Gn},cc.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Qh,function(t){return o=new ac(t,i.yo?i.yo.next():ha.Ts),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Es.Vi(function(){return i.Co(!1)}),new Yr(Qr.FAILED_PRECONDITION,oa);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},cc.prototype.lh=function(t){var e=this;return lc(t).get(Oh.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Qr.FAILED_PRECONDITION,uc)})},cc.prototype.Ko=function(t){var e=new Oh(this.clientId,this.allowTabSynchronization,Date.now());return lc(t).put(Oh.key,e)},cc.Fs=function(){return Ea.Fs()},cc.prototype.jo=function(t){var e=this,n=lc(t);return n.get(Oh.key).next(function(t){return e.Go(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(Oh.key)):ra.resolve()})},cc.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},cc.prototype.Mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Es.hi(function(){return t.inForeground="visible"===t.document.visibilityState,t.$o()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},cc.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},cc.prototype.Oo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Es.hi(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},cc.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},cc.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.xo)||void 0===e?void 0:e.getItem(this.Xo(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},cc.prototype.eh=function(){if(this.xo)try{this.xo.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},cc.prototype.ih=function(){if(this.xo)try{this.xo.removeItem(this.Xo(this.clientId))}catch(t){}},cc.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},cc);function cc(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Es=i,this.window=o,this.document=s,this.Po=a,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!cc.Fs())throw new Yr(Qr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new dc(this,r),this.No=e+"main",this.serializer=new nh(u),this.Fo=new Ea(this.No,10,new xh(this.serializer)),this.ko=new tc(this.dr,this.serializer),this.Gn=new Yh,this.jn=new bh(this.serializer,this.Gn),this.window&&this.window.localStorage?this.xo=this.window.localStorage:(this.xo=null,!1===h&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function fc(t,e){var n=this;return(n=sc.call(this)||this).vr=t,n.Ro=e,n}function lc(t){return hc.Ms(t,Oh.store)}function pc(t){return hc.Ms(t,Wh.store)}var dc=(yc.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},yc.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},yc.prototype.pe=function(t,e){return this.db.hh().pe(t,e)},yc.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},yc.prototype.Eo=function(t,e,n){return vc(t,n)},yc.prototype.mo=function(t,e,n){return vc(t,n)},yc.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},yc.prototype.Dr=vc,yc.prototype.dh=function(t,e){return r=e,i=!1,mh(n=t).Zs(function(t){return dh(n,t,r).next(function(t){return t&&(i=!0),ra.resolve(!t)})}).next(function(){return i});var n,r,i},yc.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.On(r,e).next(function(){return s.Mn(e),oc(r).delete([0,Za(e.path)])})}),u.push(n))}).next(function(){return ra.Dn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},yc.prototype.removeTarget=function(t,e){var n=e.Z(t.Ro);return this.db.hh().lo(t,n)},yc.prototype.wh=vc,yc.prototype.fh=function(t,o){var s,e=oc(t),u=ha.Ts;return e.Xs({index:zh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==ha.Ts&&o(new ri(eh(s)),u),u=i,s=r):u=ha.Ts}).next(function(){u!==ha.Ts&&o(new ri(eh(s)),u)})},yc.prototype.cr=function(t){return this.db.ah().zr(t)},yc);function yc(t,e){this.db=t,this.Yi=new Ya(this,e)}function vc(t,e){return oc(t).put((n=t.Ro,new zh(0,Za(e.path),n)));var n}function gc(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var mc=(wc.prototype.Vh=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Kn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Kn.yr(v).next(function(t){return g=t,e=r.persistence.oh(i),m=new ua(r.Ah,e,r.persistence.uh()),e.yr(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xn(v,r).next(function(t){return{gh:t,yh:e,ph:n}})})})];case 1:return n=t.sent(),[2,(this.Kn=e,this.Rh=m,this.Th.Ph(this.Rh),n)]}})})},wc.prototype.bh=function(h){var c,f=this,l=Jr.now(),t=h.reduce(function(t,e){return t.add(e.key)},zi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Xn(a,t).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof js?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ru?t.field(i.field):void 0,s=is(i.transform,o||null);null!=s&&(e=null==e?(new Ws).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(e):null);null!=s&&n.push(new Cs(o.key,s,function u(t){var a=[];return Br(t.fields||{},function(t,e){var n=new ni([t]);if(xo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Es(a)}(s.proto.mapValue),As.exists(!0)))}return f.Kn.mr(a,l,n,h)})}).then(function(t){var e=t.mn(c);return{batchId:t.batchId,Nn:e}})},wc.prototype.vh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Ah.jr({Gr:!0});return i.Sh(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Kn.Cr(t)}).next(function(){return i.Rh.Xn(t,e)})})},wc.prototype.Dh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Kn.Rr(e,t).next(function(t){return Lr(null!==t),n=t.keys(),r.Kn.br(e,t)}).next(function(){return r.Kn.Cr(e)}).next(function(){return r.Rh.Xn(e,n)})})},wc.prototype.gr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Kn.gr(t)})},wc.prototype.ro=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})},wc.prototype.Ch=function(a){var h=this,c=a.X,f=this.Eh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Ah.jr({Gr:!0});f=h.Eh;var s=[];a.Qt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.ko.Io(o,t.Xt,e).next(function(){return h.ko.To(o,t.Yt,e)})),0<(n=t.resumeToken).H()&&(r=i.tt(n,c).Z(o.Ro),f=f.nt(e,r),wc.Nh(i,r,t)&&s.push(h.ko.lo(o,r))))});var t,u=Mi,n=zi();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof iu&&e.version.isEqual($r.min())?(i.Mn(t,c),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,c),u=u.nt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.dr.wh(o,t))})})),c.isEqual($r.min())||(t=h.ko.ro(o).next(function(t){return h.ko.ho(o,o.Ro,c)}),s.push(t)),ra.Dn(s).next(function(){return i.apply(o)}).next(function(){return h.Rh.Zn(o,u)})}).then(function(t){return h.Eh=f,t})},wc.Nh=function(t,e,n){return Lr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Fh||0<n.Yt.size+n.Jt.size+n.Xt.size},wc.prototype.kh=function(c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(c,function(e){return ra.forEach(e.us,function(t){return h.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return ra.forEach(e.cs,function(t){return h.persistence.dr.mo(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Sa(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Eh.get(o),u=s.X,a=s.et(u),this.Eh=this.Eh.nt(o,a));return[2]}})})},wc.prototype.xh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Kn.Vr(t,e)})},wc.prototype.$h=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.zn(t,e)})},wc.prototype.Mh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i.ko.no(e).next(function(t){return n=new Ai(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.Eh=i.Eh.nt(t.targetId,t),i.Ih.set(r,t.targetId)),t})},wc.prototype.wo=function(t,e){var n=this.Ih.get(e);return void 0!==n?ra.resolve(this.Eh.get(n)):this.ko.wo(t,e)},wc.prototype.Oh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.Eh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.dr.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Sa(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.Eh=this.Eh.remove(o),this.Ih.delete(e.target),[2]}})})},wc.prototype.Lh=function(t,n){var r=this,i=$r.min(),o=zi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.wo(e,vu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.ko.Ao(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Th.es(e,t,n?i:$r.min(),n?o:zi())}).next(function(t){return{documents:t,qh:o}})})},wc.prototype.Sh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=ra.resolve();return n.forEach(function(r){u=u.next(function(){return o.On(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Lr(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(r,e,i))&&o.xn(e,i.An)})}),u.next(function(){return e.Kn.br(t,s)})},wc.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},wc);function wc(t,e,n){this.persistence=t,this.Th=e,this.Eh=new xi(Ur),this.Ih=new Wr(gi,mi),this.mh=$r.min(),this.Kn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new ua(this.Ah,this.Kn,this.persistence.uh()),this.Th.Ph(this.Rh)}function bc(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Ec(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Qr.FAILED_PRECONDITION||e.message!==oa)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}mc.Fh=3e8;var Ic=(Dc.prototype._=function(){return this.Bh._()},Dc.prototype.Eo=function(t,e){var n=new Tc(t,e);this.Bh=this.Bh.add(n),this.Qh=this.Qh.add(n)},Dc.prototype.jh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Dc.prototype.mo=function(t,e){this.Kh(new Tc(t,e))},Dc.prototype.Gh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Dc.prototype.zh=function(t){var e=this,n=new ri(new ti([])),r=new Tc(n,t),i=new Tc(n,t+1),o=[];return this.Qh.vt([r,i],function(t){e.Kh(t),o.push(t.key)}),o},Dc.prototype.Hh=function(){var e=this;this.Bh.forEach(function(t){return e.Kh(t)})},Dc.prototype.Kh=function(t){this.Bh=this.Bh.delete(t),this.Qh=this.Qh.delete(t)},Dc.prototype.Yh=function(t){var e=new ri(new ti([])),n=new Tc(e,t),r=new Tc(e,t+1),i=zi();return this.Qh.vt([n,r],function(t){i=i.add(t.key)}),i},Dc.prototype.Nr=function(t){var e=new Tc(t,0),n=this.Bh.Dt(e);return null!==n&&t.isEqual(n.key)},Dc),Tc=(_c.Uh=function(t,e){return ri.P(t.key,e.key)||Ur(t.Jh,e.Jh)},_c.Wh=function(t,e){return Ur(t.Jh,e.Jh)||ri.P(t.key,e.key)},_c),Nc=(Ac.prototype.Er=function(){return null!=this.uid},Ac.prototype.Xh=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},Ac.prototype.isEqual=function(t){return t.uid===this.uid},Ac);function Ac(t){this.uid=t}function _c(t,e){this.key=t,this.Jh=e}function Dc(){this.Bh=new Ui(Tc.Uh),this.Qh=new Ui(Tc.Wh)}function Sc(t,e){this.user=e,this.type="OAuth",this.ea={},this.ea.Authorization="Bearer "+t}Nc.UNAUTHENTICATED=new Nc(null),Nc.Zh=new Nc("google-credentials-uid"),Nc.ta=new Nc("first-party-uid");var xc,kc,Oc,Pc=(Jc.prototype.getToken=function(){return Promise.resolve(null)},Jc.prototype.sa=function(){},Jc.prototype.ia=function(t){(this.na=t)(Nc.UNAUTHENTICATED)},Jc.prototype.ra=function(){this.na=null},Jc),Lc=(Yc.prototype.getToken=function(){var e=this,n=this.aa,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.aa!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new Sc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Yc.prototype.sa=function(){this.forceRefresh=!0},Yc.prototype.ia=function(t){this.na=t,this.ha&&t(this.currentUser)},Yc.prototype.ra=function(){this.auth&&this.auth.removeAuthTokenListener(this.oa),this.oa=null,this.na=null},Yc.prototype.ua=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Nc(t)},Yc),Rc=(Object.defineProperty(Qc.prototype,"ea",{get:function(){var t={"X-Goog-AuthUser":this.la},e=this.ca.auth._a([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Qc),Cc=(Wc.prototype.getToken=function(){return Promise.resolve(new Rc(this.ca,this.la))},Wc.prototype.ia=function(t){t(Nc.ta)},Wc.prototype.ra=function(){},Wc.prototype.sa=function(){},Wc),Uc=(Hc.prototype.Ia=function(){return 1===this.state||2===this.state||4===this.state},Hc.prototype.ma=function(){return 2===this.state},Hc.prototype.start=function(){3!==this.state?this.auth():this.Aa()},Hc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ia()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Hc.prototype.Ra=function(){this.state=0,this.wi.reset()},Hc.prototype.Pa=function(){var t=this;this.ma()&&null===this.Ea&&(this.Ea=this.Es.vs(this.fa,6e4,function(){return t.Va()}))},Hc.prototype.ga=function(t){this.ya(),this.stream.send(t)},Hc.prototype.Va=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.ma()?[2,this.close(0)]:[2]})})},Hc.prototype.ya=function(){this.Ea&&(this.Ea.cancel(),this.Ea=null)},Hc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ya(),this.wi.cancel(),this.Ta++,3!==e?this.wi.reset():n&&n.code===Qr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.wi.ys()):n&&n.code===Qr.UNAUTHENTICATED&&this.wa.sa(),null!==this.stream&&(this.pa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ba(n)];case 1:return t.sent(),[2]}})})},Hc.prototype.pa=function(){},Hc.prototype.auth=function(){var n=this;this.state=1;var t=this.va(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Sa(t)},function(e){t(function(){var t=new Yr(Qr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},Hc.prototype.Sa=function(t){var e=this,n=this.va(this.Ta);this.stream=this.Ca(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.ba(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Hc.prototype.Aa=function(){var t=this;this.state=4,this.wi.ps(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Hc.prototype.Da=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Hc.prototype.va=function(e){var n=this;return function(t){n.Es.hi(function(){return n.Ta===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Hc),Vc=(n(Xc,Oc=Uc),Xc.prototype.Ca=function(t){return this.da.Fa("Listen",t)},Xc.prototype.onMessage=function(t){this.wi.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Pr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Oe?(Lr(void 0===i||"string"==typeof i),bi.fromBase64String(i||"")):(Lr(void 0===i||i instanceof Uint8Array),bi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Wi(s,u,a,h&&(r=void 0===(n=h).code?Qr.UNKNOWN:Si(n.code),new Yr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Go(t,f.document.name),p=Mo(f.document.updateTime),d=new Hs({mapValue:{fields:f.document.fields}}),y=new ru(l,p,d,{}),c=new Xi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Go(t,v.document),m=v.readTime?Mo(v.readTime):$r.min(),w=new iu(g,m);c=new Xi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Go(t,b.document);c=new Xi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Pr();e.filter;var I=e.filter;I.targetId;var T=new Ii(I.count||0);c=new Hi(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return $r.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?$r.min():Mo(e.readTime)}(t);return this.listener.ka(e,n)},Xc.prototype.xa=function(t){var e,n,r,i,o={};o.database=Ko(this.serializer),o.addTarget=(e=this.serializer,(r=wi(i=(n=t).target)?{documents:Yo(e,i)}:{query:Jo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Vo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ga(o)},Xc.prototype.$a=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.ga(e)},Xc),Mc=(n(Kc,kc=Uc),Object.defineProperty(Kc.prototype,"Oa",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),Kc.prototype.start=function(){this.Ma=!1,this.lastStreamToken=void 0,kc.prototype.start.call(this)},Kc.prototype.pa=function(){this.Ma&&this.La([])},Kc.prototype.Ca=function(t){return this.da.Fa("Write",t)},Kc.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Ma){this.wi.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Lr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual($r.min())&&(n=Mo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ns(n,r)}(t,i)})):[]),n=Mo(t.commitTime);return this.listener.qa(n,e)}var r,i;return Lr(!t.writeResults||0===t.writeResults.length),this.Ma=!0,this.listener.Ba()},Kc.prototype.Ua=function(){var t={};t.database=Ko(this.serializer),this.ga(t)},Kc.prototype.La=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Wo(e.serializer,t)})};this.ga(n)},Kc),Fc=(n(zc,xc=function(){}),zc.prototype.Wa=function(){if(this.Qa)throw new Yr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},zc.prototype.ja=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.ja(e,n,r,t)}).catch(function(t){throw t.code===Qr.UNAUTHENTICATED&&i.credentials.sa(),t})},zc.prototype.Ka=function(e,n,r){var i=this;return this.Wa(),this.credentials.getToken().then(function(t){return i.da.Ka(e,n,r,t)}).catch(function(t){throw t.code===Qr.UNAUTHENTICATED&&i.credentials.sa(),t})},zc.prototype.terminate=function(){this.Qa=!1},zc),jc=(Bc.prototype.Ja=function(){var t=this;0===this.za&&(this.Xa("Unknown"),this.Ha=this.ti.vs("online_state_timeout",1e4,function(){return t.Ha=null,t.Za("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Bc.prototype.tu=function(t){"Online"===this.state?this.Xa("Unknown"):(this.za++,1<=this.za&&(this.eu(),this.Za("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Bc.prototype.set=function(t){this.eu(),this.za=0,"Online"===t&&(this.Ya=!1),this.Xa(t)},Bc.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Bc.prototype.Za=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ya?(xr(e),this.Ya=!1):Sr("OnlineStateTracker",e)},Bc.prototype.eu=function(){null!==this.Ha&&(this.Ha.cancel(),this.Ha=null)},Bc),qc=(Gc.prototype.start=function(){return this.enableNetwork()},Gc.prototype.enableNetwork=function(){return this.hu.delete(0),this.Ru()},Gc.prototype.Ru=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(this.Pu()?this.Vu():this._u.set("Unknown"),[4,this.gu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Gc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(0),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),[2]}})})},Gc.prototype.yu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.Eu.stop()];case 1:return t.sent(),[4,this.fu.stop()];case 2:return t.sent(),0<this.iu.length&&(Sr("RemoteStore","Stopping write stream with "+this.iu.length+" pending writes"),this.iu=[]),this.pu(),[2]}})})},Gc.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","RemoteStore shutting down."),this.hu.add(5),[4,this.yu()];case 1:return t.sent(),this.au.th(),this._u.set("Unknown"),[2]}})})},Gc.prototype.listen=function(t){this.ru.has(t.targetId)||(this.ru.set(t.targetId,t),this.Pu()?this.Vu():this.fu.ma()&&this.bu(t))},Gc.prototype.vu=function(t){this.ru.delete(t),this.fu.ma()&&this.Su(t),0===this.ru.size&&(this.fu.ma()?this.fu.Pa():this.cu()&&this._u.set("Unknown"))},Gc.prototype.Me=function(t){return this.ru.get(t)||null},Gc.prototype.$e=function(t){return this.Du.$e(t)},Gc.prototype.bu=function(t){this.ou.de(t.targetId),this.fu.xa(t)},Gc.prototype.Su=function(t){this.ou.de(t),this.fu.$a(t)},Gc.prototype.Vu=function(){this.ou=new eo(this),this.fu.start(),this._u.Ja()},Gc.prototype.Pu=function(){return this.cu()&&!this.fu.Ia()&&0<this.ru.size},Gc.prototype.cu=function(){return 0===this.hu.size},Gc.prototype.pu=function(){this.ou=null},Gc.prototype.du=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.ru.forEach(function(t,e){n.bu(t)}),[2]})})},Gc.prototype.wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.pu(),this.Pu()?(this._u.tu(e),this.Vu()):this._u.set("Unknown"),[2]})})},Gc.prototype.Tu=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this._u.set("Online"),!(i instanceof Wi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.Nu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Xi?this.ou.Pe(i):i instanceof Hi?this.ou.De(i):this.ou.ye(i),o.isEqual($r.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.nu.ro()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.Nu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Gc.prototype.Nu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Sa(n))throw n;return this.hu.add(1),[4,this.yu()];case 1:return t.sent(),this._u.set("Offline"),r=r||function(){return e.nu.ro()},this.ti.Vi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.hu.delete(1),[4,this.Ru()];case 2:return t.sent(),[2]}})})}),[2]}})})},Gc.prototype.ku=function(e){var n=this;return e().catch(function(t){return n.Nu(t,e)})},Gc.prototype.Fu=function(r){var i=this,t=this.ou.Fe(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.H()&&(n=i.ru.get(e))&&i.ru.set(e,n.tt(t.resumeToken,r))}),t.Wt.forEach(function(t){var e,n=i.ru.get(t);n&&(i.ru.set(t,n.tt(bi.Y,n.X)),i.Su(t),e=new Ai(n.target,t,1,n.sequenceNumber),i.bu(e))}),this.Du.Ch(t)},Gc.prototype.Cu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.ru.has(i)?[4,this.Du.xu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.ru.delete(i),this.ou.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Gc.prototype.gu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.iu.length?this.iu[this.iu.length-1].batchId:-1,t.label=1;case 1:if(!this.$u())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.nu.xh(e)];case 3:return null===(n=t.sent())?(0===this.iu.length&&this.Eu.Pa(),[3,7]):(e=n.batchId,this.Mu(n),[3,6]);case 4:return r=t.sent(),[4,this.Nu(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ou()&&this.Lu(),[2]}})})},Gc.prototype.$u=function(){return this.cu()&&this.iu.length<10},Gc.prototype.qu=function(){return this.iu.length},Gc.prototype.Mu=function(t){this.iu.push(t),this.Eu.ma()&&this.Eu.Oa&&this.Eu.La(t.mutations)},Gc.prototype.Ou=function(){return this.cu()&&!this.Eu.Ia()&&0<this.iu.length},Gc.prototype.Lu=function(){this.Eu.start()},Gc.prototype.Iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Eu.Ua(),[2]})})},Gc.prototype.Au=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.iu;e<n.length;e++)r=n[e],this.Eu.La(r.mutations);return[2]})})},Gc.prototype.qa=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.iu.shift(),n=na.from(e,i,o),[4,this.ku(function(){return r.Du.Bu(n)})];case 1:return t.sent(),[4,this.gu()];case 2:return t.sent(),[2]}})})},Gc.prototype.mu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.Eu.Oa?[4,this.Uu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ou()&&this.Lu(),[2]}})})},Gc.prototype.Uu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Di(n=i.code)&&n!==Qr.ABORTED?(e=this.iu.shift(),this.Eu.Ra(),[4,this.ku(function(){return r.Du.Qu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.gu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Gc.prototype.lu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu.add(4),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),this.Eu.Ra(),this.fu.Ra(),this.hu.delete(4),[4,this.Ru()];case 2:return t.sent(),[2]}})})},Gc.prototype.Wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ti.pi(),Sr("RemoteStore","RemoteStore received new credentials"),this.hu.add(3),[4,this.yu()];case 1:return t.sent(),this._u.set("Unknown"),[4,this.Du.Wu(e)];case 2:return t.sent(),this.hu.delete(3),[4,this.Ru()];case 3:return t.sent(),[2]}})})},Gc.prototype.ju=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.hu.delete(2),[4,this.Ru()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.hu.add(2),[4,this.yu()]);case 3:t.sent(),this._u.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Gc);function Gc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.nu=t,this.su=e,this.ti=n,this.iu=[],this.ru=new Map,this.ou=null,this.hu=new Set,this.au=i,this.au.uu(function(t){n.hi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.cu()?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,this.lu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this._u=new jc(n,r),this.fu=(h=this.su,c=n,f={Na:this.du.bind(this),ba:this.wu.bind(this),ka:this.Tu.bind(this)},(l=h).Wa(),new Vc(c,l.da,l.credentials,l.serializer,f)),this.Eu=(o=this.su,s=n,u={Na:this.Iu.bind(this),ba:this.mu.bind(this),Ba:this.Au.bind(this),qa:this.qa.bind(this)},(a=o).Wa(),new Mc(s,a.da,a.credentials,a.serializer,u))}function Bc(t,e){this.ti=t,this.Ga=e,this.state="Unknown",this.za=0,this.Ha=null,this.Ya=!0}function zc(t,e,n){var r=this;return(r=xc.call(this)||this).credentials=t,r.da=e,r.serializer=n,r.Qa=!1,r}function Kc(t,e,n,r,i){var o=this;return(o=kc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Ma=!1,o}function Xc(t,e,n,r,i){var o=this;return(o=Oc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Hc(t,e,n,r,i,o){this.Es=t,this.fa=n,this.da=r,this.wa=i,this.listener=o,this.state=0,this.Ta=0,this.Ea=null,this.stream=null,this.wi=new ba(t,e)}function Wc(t,e){this.ca=t,this.la=e}function Qc(t,e){this.ca=t,this.la=e,this.type="FirstParty",this.user=Nc.ta}function Yc(t){var e=this;this.oa=null,this.currentUser=Nc.UNAUTHENTICATED,this.ha=!1,this.aa=0,this.na=null,this.forceRefresh=!1,this.oa=function(){e.aa++,e.currentUser=e.ua(),e.ha=!0,e.na&&e.na(e.currentUser)},this.aa=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oa):(this.oa(null),t.get().then(function(t){e.auth=t,e.oa&&e.auth.addAuthTokenListener(e.oa)},function(){}))}function Jc(){this.na=null}function $c(t,e){return"firestore_clients_"+t+"_"+e}function Zc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function tf(t,e){return"firestore_targets_"+t+"_"+e}function ef(t){this.key=t}function nf(t){this.key=t}function rf(t,e,n){this.query=t,this.targetId=e,this.view=n}function of(t){this.key=t,this.el=!1}var sf=(Tf.Ku=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Yr(r.error.code,r.error.message)),i?new Tf(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Tf.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Tf),uf=(If.Ku=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Yr(n.error.code,n.error.message)),r?new If(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},If.prototype.Gu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},If),af=(Ef.Ku=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki,o=0;r&&o<n.activeTargetIds.length;++o)r=di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Ef(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Ef),hf=(bf.Ku=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new bf(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},bf),cf=(wf.prototype.zu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},wf.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},wf.prototype.Gu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},wf),ff=(mf.Fs=function(t){return!(!t||!t.localStorage)},mf.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.Du.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Yu&&(o=this.getItem($c(this.persistenceKey,i)))&&(s=af.Ku(i,o))&&(this.Zu=this.Zu.nt(s.clientId,s));for(this.hc(),(u=this.storage.getItem(this.oc))&&(a=this.ac(u))&&this.uc(a),h=0,c=this.tc;h<c.length;h++)f=c[h],this.Xu(f);return this.tc=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},mf.prototype.ws=function(t){this.setItem(this.nc,JSON.stringify(t))},mf.prototype.cc=function(){return this.lc(this.Zu)},mf.prototype._c=function(n){var r=!1;return this.Zu.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},mf.prototype.fc=function(t){this.dc(t,"pending")},mf.prototype.wc=function(t,e,n){this.dc(t,e,n),this.Tc(t)},mf.prototype.Ec=function(t){var e,n,r="not-current";return this._c(t)&&(!(e=this.storage.getItem(tf(this.persistenceKey,t)))||(n=uf.Ku(t,e))&&(r=n.state)),this.Ic.zu(t),this.hc(),r},mf.prototype.mc=function(t){this.Ic.Hu(t),this.hc()},mf.prototype.Ac=function(t){return this.Ic.activeTargetIds.has(t)},mf.prototype.Rc=function(t){this.removeItem(tf(this.persistenceKey,t))},mf.prototype.Pc=function(t,e,n){this.Vc(t,e,n)},mf.prototype.Vh=function(t,e,n){var r=this;e.forEach(function(t){r.Tc(t)}),this.currentUser=t,n.forEach(function(t){r.fc(t)})},mf.prototype.gc=function(t){this.yc(t)},mf.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.Ju),this.removeItem(this.ec),this.tr=!1)},mf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},mf.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},mf.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},mf.prototype.Xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Sr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.ec)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Es.Vi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.sc.test(u.key)){if(null==u.newValue)return e=this.pc(u.key),[2,this.bc(e,null)];if(n=this.vc(u.key,u.newValue))return[2,this.bc(n.clientId,n)]}else if(this.ic.test(u.key)){if(null!==u.newValue&&(r=this.Sc(u.key,u.newValue)))return[2,this.Dc(r)]}else if(this.rc.test(u.key)){if(null!==u.newValue&&(i=this.Cc(u.key,u.newValue)))return[2,this.Nc(i)]}else if(u.key===this.oc){if(null!==u.newValue&&(o=this.ac(u.newValue)))return[2,this.uc(o)]}else u.key===this.nc&&(s=function(t){var e=ha.Ts;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==ha.Ts&&this._s(s)}else this.tc.push(u);return[2]})})})}},Object.defineProperty(mf.prototype,"Ic",{get:function(){return this.Zu.get(this.Yu)},enumerable:!1,configurable:!0}),mf.prototype.hc=function(){this.setItem(this.ec,this.Ic.Gu())},mf.prototype.dc=function(t,e,n){var r=new sf(this.currentUser,t,e,n),i=Zc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Gu())},mf.prototype.Tc=function(t){var e=Zc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},mf.prototype.yc=function(t){var e={clientId:this.Yu,onlineState:t};this.storage.setItem(this.oc,JSON.stringify(e))},mf.prototype.Vc=function(t,e,n){var r=tf(this.persistenceKey,t),i=new uf(t,e,n);this.setItem(r,i.Gu())},mf.prototype.pc=function(t){var e=this.sc.exec(t);return e?e[1]:null},mf.prototype.vc=function(t,e){var n=this.pc(t);return af.Ku(n,e)},mf.prototype.Sc=function(t,e){var n=this.ic.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return sf.Ku(new Nc(i),r,e)},mf.prototype.Cc=function(t,e){var n=this.rc.exec(t),r=Number(n[1]);return uf.Ku(r,e)},mf.prototype.ac=function(t){return hf.Ku(t)},mf.prototype.Dc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Du.Fc(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},mf.prototype.Nc=function(t){return this.Du.kc(t.targetId,t.state,t.error)},mf.prototype.bc=function(t,e){var n=this,r=e?this.Zu.nt(t,e):this.Zu.remove(t),i=this.lc(this.Zu),o=this.lc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Du.xc(s,u).then(function(){n.Zu=r})},mf.prototype.uc=function(t){this.Zu.get(t.clientId)&&this.Ga(t.onlineState)},mf.prototype.lc=function(t){var n=Ki;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},mf),lf=(gf.prototype.fc=function(t){},gf.prototype.wc=function(t,e,n){},gf.prototype.Ec=function(t){return this.$c.zu(t),this.Mc[t]||"not-current"},gf.prototype.Pc=function(t,e,n){this.Mc[t]=e},gf.prototype.mc=function(t){this.$c.Hu(t)},gf.prototype.Ac=function(t){return this.$c.activeTargetIds.has(t)},gf.prototype.Rc=function(t){delete this.Mc[t]},gf.prototype.cc=function(){return this.$c.activeTargetIds},gf.prototype._c=function(t){return this.$c.activeTargetIds.has(t)},gf.prototype.start=function(){return this.$c=new cf,Promise.resolve()},gf.prototype.Vh=function(t,e,n){},gf.prototype.gc=function(t){},gf.prototype.th=function(){},gf.prototype.ws=function(t){},gf),pf=(Object.defineProperty(vf.prototype,"Qc",{get:function(){return this.Oc},enumerable:!1,configurable:!0}),vf.prototype.Wc=function(t,e){var u=this,a=e?e.jc:new Yi,h=e?e.Uc:this.Uc,c=e?e.Lt:this.Lt,f=h,l=!1,p=this.query.hn()&&h.size===this.query.limit?h.last():null,d=this.query.an()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof ru?e:null)&&(Tu(u.query,r)?r:null),i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Kc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Bc(r,p)||d&&u.Bc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{Uc:f,jc:a,Gc:l,Lt:c}},vf.prototype.Kc=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},vf.prototype.Bn=function(t,e,n){var o=this,r=this.Uc;this.Uc=t.Uc,this.Lt=t.Lt;var i=t.jc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Bc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.zc(n);var s=e?this.Hc():[],u=0===this.qc.size&&this.Ht?1:0,a=u!==this.Lc;return this.Lc=u,0!==i.length||a?{snapshot:new Ji(this.query,t.Uc,r,i,t.Lt,0==u,a,!1),Yc:s}:{Yc:s}},vf.prototype.Jc=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.Bn({Uc:this.Uc,jc:new Yi,Lt:this.Lt,Gc:!1},!1)):{Yc:[]}},vf.prototype.Xc=function(t){return!this.Oc.has(t)&&!!this.Uc.has(t)&&!this.Uc.get(t).Ke},vf.prototype.zc=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Oc=e.Oc.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Oc=e.Oc.delete(t)}),this.Ht=t.Ht)},vf.prototype.Hc=function(){var e=this;if(!this.Ht)return[];var n=this.qc;this.qc=zi(),this.Uc.forEach(function(t){e.Xc(t.key)&&(e.qc=e.qc.add(t.key))});var r=[];return n.forEach(function(t){e.qc.has(t)||r.push(new nf(t))}),this.qc.forEach(function(t){n.has(t)||r.push(new ef(t))}),r},vf.prototype.Zc=function(t){this.Oc=t.qh,this.qc=zi();var e=this.Wc(t.documents);return this.Bn(e,!0)},vf.prototype.tl=function(){return Ji.Ut(this.query,this.Uc,this.Lt,0===this.Lc)},vf),df=(Object.defineProperty(yf.prototype,"Tl",{get:function(){return!0===this.wl},enumerable:!1,configurable:!0}),yf.prototype.subscribe=function(t){this.rl=t},yf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.El("listen()"),(r=this.ol.get(s))?(e=r.targetId,this.sl.Ec(e),n=r.view.tl(),[3,4]):[3,1];case 1:return[4,this.nu.Mh(vu(s))];case 2:return i=t.sent(),o=this.sl.Ec(i.targetId),e=i.targetId,[4,this.Il(s,e,"current"===o)];case 3:n=t.sent(),this.Tl&&this.nl.listen(i),t.label=4;case 4:return[2,n]}})})},yf.prototype.Il=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.nu.Lh(u,!0)];case 1:return e=t.sent(),n=new pf(u,e.qh),r=n.Wc(e.documents),i=Zi.zt(a,h&&"Offline"!==this.onlineState),o=n.Bn(r,this.Tl,i),this.ml(a,o.Yc),s=new rf(u,a,n),[2,(this.ol.set(u,s),this.hl.has(a)?this.hl.get(a).push(u):this.hl.set(a,[u]),o.snapshot)]}})})},yf.prototype.vu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.El("unlisten()"),e=this.ol.get(i),1<(n=this.hl.get(e.targetId)).length?[2,(this.hl.set(e.targetId,n.filter(function(t){return!bu(t,i)})),void this.ol.delete(i))]:this.Tl?(this.sl.mc(e.targetId),this.sl._c(e.targetId)?[3,2]:[4,this.nu.Oh(e.targetId,!1).then(function(){r.sl.Rc(e.targetId),r.nl.vu(e.targetId),r.Al(e.targetId)}).catch(Ec)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Al(e.targetId),[4,this.nu.Oh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},yf.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.El("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.nu.bh(i)];case 2:return e=t.sent(),this.sl.fc(e.batchId),this.Rl(e.batchId,o),[4,this.Pl(e.Nn)];case 3:return t.sent(),[4,this.nl.gu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Ga(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},yf.prototype.Ch=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.El("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Ch(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.cl.get(e);n&&(Lr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.el=!0:0<t.Jt.size?Lr(n.el):0<t.Xt.size&&(Lr(n.el),n.el=!1))}),[4,this.Pl(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ec(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yf.prototype.Jc=function(r,t){var i;(this.Tl&&0===t||!this.Tl&&1===t)&&(this.El("applyOnlineStateChange()"),i=[],this.ol.forEach(function(t,e){var n=e.view.Jc(r);n.snapshot&&i.push(n.snapshot)}),this.rl.Vl(r),this.rl.ka(i),this.onlineState=r,this.Tl&&this.sl.gc(r))},yf.prototype.xu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.El("rejectListens()"),this.sl.Pc(u,"rejected",a),e=this.cl.get(u),(n=e&&e.key)?(r=(r=new xi(ri.P)).nt(n,new iu(n,$r.min())),i=zi().add(n),o=new $i($r.min(),new Map,new Ui(Ur),r,i),[4,this.Ch(o)]):[3,2];case 1:return t.sent(),this.ul=this.ul.remove(n),this.cl.delete(u),this.gl(),[3,4];case 2:return[4,this.nu.Oh(u,!1).then(function(){return s.Al(u,a)}).catch(Ec)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},yf.prototype.Bu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.El("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.vh(r)];case 2:return n=t.sent(),this.yl(e,null),this.pl(e),this.sl.wc(e,"acknowledged"),[4,this.Pl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ec(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yf.prototype.Qu=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.El("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.nu.Dh(n)];case 2:return e=t.sent(),this.yl(n,r),this.pl(n),this.sl.wc(n,"rejected",r),[4,this.Pl(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ec(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},yf.prototype.bl=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.nl.cu()||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.nu.gr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.fl.get(e)||[]).push(o),this.fl.set(e,n),[3,4]);case 3:return r=t.sent(),i=Ga(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},yf.prototype.pl=function(t){(this.fl.get(t)||[]).forEach(function(t){t.resolve()}),this.fl.delete(t)},yf.prototype.vl=function(e){this.fl.forEach(function(t){t.forEach(function(t){t.reject(new Yr(Qr.CANCELLED,e))})}),this.fl.clear()},yf.prototype.Rl=function(t,e){var n=(n=(n=this._l[this.currentUser.Xh()])||new xi(Ur)).nt(t,e);this._l[this.currentUser.Xh()]=n},yf.prototype.yl=function(t,e){var n,r=this._l[this.currentUser.Xh()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this._l[this.currentUser.Xh()]=r)},yf.prototype.Al=function(t,e){var n=this;void 0===e&&(e=null),this.sl.mc(t);for(var r=0,i=this.hl.get(t);r<i.length;r++){var o=i[r];this.ol.delete(o),e&&this.rl.Sl(o,e)}this.hl.delete(t),this.Tl&&this.ll.zh(t).forEach(function(t){n.ll.Nr(t)||n.Dl(t)})},yf.prototype.Dl=function(t){var e=this.ul.get(t);null!==e&&(this.nl.vu(e),this.ul=this.ul.remove(t),this.cl.delete(e),this.gl())},yf.prototype.ml=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof ef?(this.ll.Eo(i.key,t),this.Cl(i)):i instanceof nf?(Sr("SyncEngine","Document no longer in limbo: "+i.key),this.ll.mo(i.key,t),this.ll.Nr(i.key)||this.Dl(i.key)):Pr()}},yf.prototype.Cl=function(t){var e=t.key;this.ul.get(e)||(Sr("SyncEngine","New document in limbo: "+e),this.al.push(e),this.gl())},yf.prototype.gl=function(){for(;0<this.al.length&&this.ul.size<this.il;){var t=this.al.shift(),e=this.dl.next();this.cl.set(e,new of(t)),this.ul=this.ul.nt(t,e),this.nl.listen(new Ai(vu(pu(t.path)),e,2,ha.Ts))}},yf.prototype.Nl=function(){return this.ul},yf.prototype.Fl=function(){return this.al},yf.prototype.Pl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ol.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Wc(r);return n.Gc?u.nu.Lh(i.query,!1).then(function(t){var e=t.documents;return i.view.Wc(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.Bn(t,u.Tl,n);u.ml(i.targetId,r.Yc),r.snapshot&&(u.Tl&&u.sl.Pc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=aa.ls(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.rl.ka(o),[4,this.nu.kh(s)];case 2:return t.sent(),[2]}})})},yf.prototype.El=function(t){},yf.prototype.Wu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Sr("SyncEngine","User change. New user:",n.Xh()),[4,this.nu.Vh(n)]);case 1:return e=t.sent(),this.currentUser=n,this.vl("'waitForPendingWrites' promise is rejected due to a user change."),this.sl.Vh(n,e.yh,e.ph),[4,this.Pl(e.gh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},yf.prototype.$e=function(t){var e=this.cl.get(t);if(e&&e.el)return zi().add(e.key);var n=zi(),r=this.hl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.ol.get(s),n=n.Ct(u.view.Qc);return n},yf);function yf(t,e,n,r,i,o){this.nu=t,this.nl=e,this.su=n,this.sl=r,this.currentUser=i,this.il=o,this.rl=null,this.ol=new Wr(Eu,bu),this.hl=new Map,this.al=[],this.ul=new xi(ri.P),this.cl=new Map,this.ll=new Ic,this._l={},this.fl=new Map,this.dl=Zh.eo(),this.onlineState="Unknown",this.wl=void 0}function vf(t,e){this.query=t,this.Oc=e,this.Lc=null,this.Ht=!1,this.qc=zi(),this.Lt=zi(),this.Bc=Nu(t),this.Uc=new Qi(this.Bc)}function gf(){this.$c=new cf,this.Mc={},this.Ga=null,this._s=null}function mf(t,e,n,r,i){this.window=t,this.Es=e,this.persistenceKey=n,this.Yu=r,this.Du=null,this.Ga=null,this._s=null,this.Ju=this.Xu.bind(this),this.Zu=new xi(Ur),this.tr=!1,this.tc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ec=$c(this.persistenceKey,this.Yu),this.nc="firestore_sequence_number_"+this.persistenceKey,this.Zu=this.Zu.nt(this.Yu,new cf),this.sc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.ic=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.rc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.oc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.Ju)}function wf(){this.activeTargetIds=Ki}function bf(t,e){this.clientId=t,this.onlineState=e}function Ef(t,e){this.clientId=t,this.activeTargetIds=e}function If(t,e,n){this.targetId=t,this.state=e,this.error=n}function Tf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Nf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.hl.get(s))&&0!==a.length?[4,e.nu.Mh(vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.ol.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=i).nu.Lh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Zc(n),[2,(e.Tl&&e.ml(o.targetId,r.Yc),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,bc(e.nu,s)];case 8:return d=t.sent(),[4,e.nu.Mh(d)];case 9:return u=t.sent(),[4,e.Il(Af(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.rl.ka(r),n)]}})})}function Af(t){return lu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function _f(){this.kl=void 0,this.listeners=[]}var Df,Sf=(Vf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.xl.get(e))||(n=!0,r=new _f),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Du.listen(e)];case 2:return i.kl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ga(o,"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.xl.set(e,r),r.listeners.push(u),u.Jc(this.onlineState),r.kl&&u.Ml(r.kl)&&this.Ol(),[2]}})})},Vf.prototype.vu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.xl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.xl.delete(e),this.Du.vu(e))]:[2]})})},Vf.prototype.ka=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.xl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ml(i)&&(e=!0);s.kl=i}}e&&this.Ol()},Vf.prototype.Sl=function(t,e){var n=this.xl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.xl.delete(t)},Vf.prototype.Vl=function(i){this.onlineState=i;var o=!1;this.xl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Jc(i)&&(o=!0)}),o&&this.Ol()},Vf.prototype.Ll=function(t){this.$l.add(t),t.next()},Vf.prototype.ql=function(t){this.$l.delete(t)},Vf.prototype.Ol=function(){this.$l.forEach(function(t){t.next()})},Vf),xf=(Uf.prototype.Ml=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ji(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.Ul?this.Wl(t)&&(this.Bl.next(t),o=!0):this.jl(t,this.onlineState)&&(this.Kl(t),o=!0),this.Ql=t,o},Uf.prototype.onError=function(t){this.Bl.error(t)},Uf.prototype.Jc=function(t){this.onlineState=t;var e=!1;return this.Ql&&!this.Ul&&this.jl(this.Ql,t)&&(this.Kl(this.Ql),e=!0),e},Uf.prototype.jl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Gl&&n||t.docs._()&&"Offline"!==e)},Uf.prototype.Wl=function(t){if(0<t.docChanges.length)return!0;var e=this.Ql&&this.Ql.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},Uf.prototype.Kl=function(t){t=Ji.Ut(t.query,t.docs,t.Lt,t.fromCache),this.Ul=!0,this.Bl.next(t)},Uf),kf=(Cf.prototype.Ph=function(t){this.zl=t},Cf.prototype.es=function(e,r,i,o){var s=this;return r.on()||i.isEqual($r.min())?this.Hl(e,r):this.zl.Xn(e,o).next(function(t){var n=s.Yl(r,t);return(r.hn()||r.an())&&s.Gc(r.en,n,o,i)?s.Hl(e,r):(Dr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.zl.es(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Cf.prototype.Yl=function(n,t){var r=new Ui(Nu(n));return t.forEach(function(t,e){e instanceof ru&&Tu(n,e)&&(r=r.add(e))}),r},Cf.prototype.Gc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Cf.prototype.Hl=function(t,e){return Dr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.zl.es(t,e,$r.min())},Cf),Of=(Rf.prototype.Ir=function(t){return ra.resolve(0===this.Kn.length)},Rf.prototype.mr=function(t,e,n,r){var i=this.Jl;this.Jl++,0<this.Kn.length&&this.Kn[this.Kn.length-1];var o=new ea(i,e,n,r);this.Kn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Xl=this.Xl.add(new Tc(a.key,i)),this.Gn.Ar(t,a.key.path.p())}return ra.resolve(o)},Rf.prototype.Rr=function(t,e){return ra.resolve(this.Zl(e))},Rf.prototype.Vr=function(t,e){var n=e+1,r=this.t_(n),i=r<0?0:r;return ra.resolve(this.Kn.length>i?this.Kn[i]:null)},Rf.prototype.gr=function(){return ra.resolve(0===this.Kn.length?-1:this.Jl-1)},Rf.prototype.yr=function(t){return ra.resolve(this.Kn.slice())},Rf.prototype.Hn=function(t,e){var n=this,r=new Tc(e,0),i=new Tc(e,Number.POSITIVE_INFINITY),o=[];return this.Xl.vt([r,i],function(t){var e=n.Zl(t.Jh);o.push(e)}),ra.resolve(o)},Rf.prototype.ts=function(t,e){var r=this,i=new Ui(Ur);return e.forEach(function(t){var e=new Tc(t,0),n=new Tc(t,Number.POSITIVE_INFINITY);r.Xl.vt([e,n],function(t){i=i.add(t.Jh)})}),ra.resolve(this.e_(i))},Rf.prototype.hs=function(t,e){var n=e.path,r=n.length+1,i=n;ri.W(i)||(i=i.child(""));var o=new Tc(new ri(i),0),s=new Ui(Ur);return this.Xl.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.Jh)),!0)},o),ra.resolve(this.e_(s))},Rf.prototype.e_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Zl(t);null!==e&&r.push(e)}),r},Rf.prototype.br=function(n,r){var i=this;Lr(0===this.n_(r.batchId,"removed")),this.Kn.shift();var o=this.Xl;return ra.forEach(r.mutations,function(t){var e=new Tc(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.Xl=o})},Rf.prototype.Sr=function(t){},Rf.prototype.Nr=function(t,e){var n=new Tc(e,0),r=this.Xl.Dt(n);return ra.resolve(e.isEqual(r&&r.key))},Rf.prototype.Cr=function(t){return this.Kn.length,ra.resolve()},Rf.prototype.n_=function(t,e){return this.t_(t)},Rf.prototype.t_=function(t){return 0===this.Kn.length?0:t-this.Kn[0].batchId},Rf.prototype.Zl=function(t){var e=this.t_(t);return e<0||e>=this.Kn.length?null:this.Kn[e]},Rf),Pf=(Lf.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.s_(e);return this.docs=this.docs.nt(r,{Mr:e,size:s,readTime:n}),this.size+=s-o,this.Gn.Ar(t,r.path.p())},Lf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Lf.prototype.On=function(t,e){var n=this.docs.get(e);return ra.resolve(n?n.Mr:null)},Lf.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Mr:null)}),ra.resolve(r)},Lf.prototype.es=function(t,e,n){for(var r=qi,i=new ri(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.Mr,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof ru&&Tu(e,h)&&(r=r.nt(h.key,h))}return ra.resolve(r)},Lf.prototype.i_=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},Lf.prototype.jr=function(t){return new Lf.Kr(this)},Lf.prototype.zr=function(t){return ra.resolve(this.size)},Lf);function Lf(t,e){this.Gn=t,this.s_=e,this.docs=new xi(ri.P),this.size=0}function Rf(t,e){this.Gn=t,this.dr=e,this.Kn=[],this.Jl=1,this.Xl=new Ui(Tc.Uh)}function Cf(){}function Uf(t,e,n){this.query=t,this.Bl=e,this.Ul=!1,this.Ql=null,this.onlineState="Unknown",this.options=n||{}}function Vf(t){this.Du=t,this.xl=new Wr(Eu,bu),this.onlineState="Unknown",this.$l=new Set,this.Du.subscribe(this)}function Mf(t){var e=this;return(e=Df.call(this)||this).Hr=t,e}Pf.Kr=(n(Mf,Df=ia),Mf.prototype.Bn=function(n){var r=this,i=[];return this.Nn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),ra.Dn(i)},Mf.prototype.Ln=function(t,e){return this.Hr.On(t,e)},Mf.prototype.qn=function(t,e){return this.Hr.getEntries(t,e)},Mf);var Ff,jf,qf=(il.prototype.pe=function(t,n){return this.r_.forEach(function(t,e){return n(e)}),ra.resolve()},il.prototype.ro=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},il.prototype.oo=function(t){return ra.resolve(this.o_)},il.prototype.no=function(t){return this.highestTargetId=this.a_.next(),ra.resolve(this.highestTargetId)},il.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.o_&&(this.o_=e),ra.resolve()},il.prototype.uo=function(t){this.r_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.a_=new Zh(e),this.highestTargetId=e),t.sequenceNumber>this.o_&&(this.o_=t.sequenceNumber)},il.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,ra.resolve()},il.prototype.lo=function(t,e){return this.uo(e),ra.resolve()},il.prototype._o=function(t,e){return this.r_.delete(e.target),this.h_.zh(e.targetId),--this.targetCount,ra.resolve()},il.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.r_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.r_.delete(t),u.push(o.fo(n,e.targetId)),s++)}),ra.Dn(u).next(function(){return s})},il.prototype.do=function(t){return ra.resolve(this.targetCount)},il.prototype.wo=function(t,e){var n=this.r_.get(e)||null;return ra.resolve(n)},il.prototype.To=function(t,e,n){return this.h_.jh(e,n),ra.resolve()},il.prototype.Io=function(e,t,n){this.h_.Gh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),ra.Dn(i)},il.prototype.fo=function(t,e){return this.h_.zh(e),ra.resolve()},il.prototype.Ao=function(t,e){var n=this.h_.Yh(e);return ra.resolve(n)},il.prototype.Nr=function(t,e){return ra.resolve(this.h_.Nr(e))},il),Gf=(rl.prototype.start=function(){return Promise.resolve()},rl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(rl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),rl.prototype.Bo=function(){},rl.prototype.Uo=function(){},rl.prototype.uh=function(){return this.Gn},rl.prototype.oh=function(t){var e=this.u_[t.Xh()];return e||(e=new Of(this.Gn,this.dr),this.u_[t.Xh()]=e),e},rl.prototype.hh=function(){return this.ko},rl.prototype.ah=function(){return this.jn},rl.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Bf(this.yo.next());return this.dr.l_(),n(i).next(function(t){return r.dr.__(i).next(function(){return t})}).vn().then(function(t){return i.Wn(),t})},rl.prototype.f_=function(e,n){return ra.Cn(Object.values(this.u_).map(function(t){return function(){return t.Nr(e,n)}}))},rl),Bf=(n(nl,jf=sa),nl),zf=(el.T_=function(t){return new el(t)},Object.defineProperty(el.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Pr()},enumerable:!1,configurable:!0}),el.prototype.Eo=function(t,e,n){return this.d_.Eo(n,e),this.E_.delete(n),ra.resolve()},el.prototype.mo=function(t,e,n){return this.d_.mo(n,e),this.E_.add(n),ra.resolve()},el.prototype.Dr=function(t,e){return this.E_.add(e),ra.resolve()},el.prototype.removeTarget=function(t,e){var n=this;this.d_.zh(e.targetId).forEach(function(t){return n.E_.add(t)});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return r._o(t,e)})},el.prototype.l_=function(){this.w_=new Set},el.prototype.__=function(t){var n=this,r=this.persistence.ah().jr();return ra.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||r.Mn(e)})}).next(function(){return n.w_=null,r.apply(t)})},el.prototype.wh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},el.prototype.c_=function(t){return 0},el.prototype.I_=function(t,e){var n=this;return ra.Cn([function(){return ra.resolve(n.d_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.f_(t,e)}])},el),Kf=(tl.prototype.Na=function(t){this.R_=t},tl.prototype.ba=function(t){this.P_=t},tl.prototype.onMessage=function(t){this.V_=t},tl.prototype.close=function(){this.A_()},tl.prototype.send=function(t){this.m_(t)},tl.prototype.g_=function(){this.R_()},tl.prototype.y_=function(t){this.P_(t)},tl.prototype.p_=function(t){this.V_(t)},tl),Xf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Hf=(Zf.prototype.ja=function(e,t,n,r){var i=this.D_(e,t);Sr("RestConnection","Sending: ",i,n);var o={};return this.C_(o,r),this.N_(e,i,o,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Zf.prototype.Ka=function(t,e,n,r){return this.ja(t,e,n,r)},Zf.prototype.C_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.18.0",t["Content-Type"]="text/plain",e)for(var n in e.ea)e.ea.hasOwnProperty(n)&&(t[n]=e.ea[n])},Zf.prototype.D_=function(t,e){var n=Xf[t];return this.v_+"/v1/"+e+":"+n},n($f,Ff=Zf),$f.prototype.N_=function(a,e,n,r){return new Promise(function(o,s){var u=new Tr;u.listenOnce(Er.COMPLETE,function(){try{switch(u.getLastErrorCode()){case br.NO_ERROR:var t=u.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:Sr("Connection",'RPC "'+a+'" timed out'),s(new Yr(Qr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=u.getStatus();Sr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Qr).indexOf(i)?i:Qr.UNKNOWN,s(new Yr(n,e.message))):s(new Yr(Qr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Yr(Qr.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Sr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},$f.prototype.Fa=function(t,e){var n,r,i=[this.v_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.C_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Sr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Kf({m_:function(t){f?Sr("Connection","Not sending because WebChannel is closed:",t):(c||(Sr("Connection","Opening WebChannel transport."),h.open(),c=!0),Sr("Connection","WebChannel sending:",t),h.send(t))},A_:function(){return h.close()}});return a(Ir.EventType.OPEN,function(){f||Sr("Connection","WebChannel transport opened.")}),a(Ir.EventType.CLOSE,function(){f||(f=!0,Sr("Connection","WebChannel transport closed"),l.y_())}),a(Ir.EventType.ERROR,function(t){f||(f=!0,kr("Connection","WebChannel transport errored:",t),l.y_(new Yr(Qr.UNAVAILABLE,"The operation could not be completed")))}),a(Ir.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Lr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Sr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ti[i];if(void 0!==t)return Si(t)}(),s=r.message,void 0===o&&(o=Qr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.y_(new Yr(o,s)),h.close()):(Sr("Connection","WebChannel received:",n),l.p_(n)))}),setTimeout(function(){l.g_()},0),l},$f),Wf=(Jf.prototype.uu=function(t){this.O_.push(t)},Jf.prototype.th=function(){window.removeEventListener("online",this.F_),window.removeEventListener("offline",this.x_)},Jf.prototype.L_=function(){window.addEventListener("online",this.F_),window.addEventListener("offline",this.x_)},Jf.prototype.k_=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(0)},Jf.prototype.M_=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.O_;t<e.length;t++)(0,e[t])(1)},Jf.Fs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Jf),Qf=(Yf.prototype.uu=function(t){},Yf.prototype.th=function(){},Yf);function Yf(){}function Jf(){var t=this;this.F_=function(){return t.k_()},this.x_=function(){return t.M_()},this.O_=[],this.L_()}function $f(t){var e=this;return(e=Ff.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Zf(t){this.b_=t,this.s=t.s;var e=t.ssl?"https":"http";this.v_=e+"://"+t.host,this.S_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function tl(t){this.m_=t.m_,this.A_=t.A_}function el(t){this.persistence=t,this.d_=new Ic,this.w_=null}function nl(t){var e=this;return(e=jf.call(this)||this).Ro=t,e}function rl(t){var e=this;this.u_={},this.yo=new ha(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new qf(this),this.Gn=new Dh,this.jn=new Pf(this.Gn,function(t){return e.dr.c_(t)})}function il(t){this.persistence=t,this.r_=new Wr(gi,mi),this.lastRemoteSnapshotVersion=$r.min(),this.highestTargetId=0,this.o_=0,this.h_=new Ic,this.targetCount=0,this.a_=Zh.to()}function ol(t){return new Po(t,!0)}var sl,ul,al="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",hl=(yl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.sl=this.q_(e),this.persistence=this.B_(e),[4,this.persistence.start()];case 1:return t.sent(),this.U_=this.Q_(e),this.nu=this.W_(e),[2]}})})},yl.prototype.Q_=function(t){return null},yl.prototype.W_=function(t){return e=this.persistence,n=new kf,r=t.j_,new mc(e,n,r);var e,n,r},yl.prototype.B_=function(t){if(t.G_.K_)throw new Yr(Qr.FAILED_PRECONDITION,al);return new Gf(zf.T_)},yl.prototype.q_=function(t){return new lf},yl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.sl.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},yl.prototype.clearPersistence=function(t,e){throw new Yr(Qr.FAILED_PRECONDITION,al)},yl),cl=(n(dl,ul=hl),dl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,ul.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.nu)];case 2:return t.sent(),[2]}})})},dl.prototype.Q_=function(t){var e=this.persistence.dr.Yi;return new Qa(e,t.ti)},dl.prototype.B_=function(t){var e=gc(t.b_.s,t.b_.persistenceKey),n=ol(t.b_.s);return new hc(t.G_.synchronizeTabs,e,t.clientId,Xa.Ui(t.G_.cacheSizeBytes),t.ti,Ua(),Va(),n,this.sl,t.G_.Vo)},dl.prototype.q_=function(t){return new lf},dl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ea.Fs()?(e=n+"main",[4,Ea.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(gc(t,e))},n(pl,sl=dl),pl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,sl.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.z_.initialize(this,r)];case 2:return t.sent(),e=this.z_.Du,this.sl instanceof ff?(this.sl.Du={Fc:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).El("applyBatchState()"),[4,(e=o.nu,n=a,i=(r=e).Kn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Xn(e,t):ra.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.nl.gu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.yl(a,c||null),o.nu.Kn.Sr(a)):Pr(),t.label=4;case 4:return[4,o.Pl(s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),kc:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).wl?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.hl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.nu,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=$i.Gt(u,"current"===a),[4,n.Pl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.nu.Oh(u,!0)];case 6:return t.sent(),n.Al(u,h),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),xc:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).wl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.hl.has(i)?(Sr("SyncEngine","Adding an already active target "+i),[3,5]):[4,bc(n.nu,i)]):[3,6];case 2:return o=t.sent(),[4,n.nu.Mh(o)];case 3:return s=t.sent(),[4,n.Il(Af(o),s.targetId,!1)];case 4:t.sent(),n.nl.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.hl.has(e)?[4,n.nu.Oh(e,!1).then(function(){n.nl.vu(e),n.Al(e)}).catch(Ec)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.nu.persistence.rh()}.bind(null,e)},[4,this.sl.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.wl?[3,3]:(e=r.sl.cc(),[4,Nf(r,e.N())]);case 1:return i=t.sent(),r.wl=!0,[4,r.nl.ju(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.nl.listen(u);return[3,7];case 3:return!1!==f||!1===r.wl?[3,7]:(a=[],h=Promise.resolve(),r.hl.forEach(function(t,e){r.sl.Ac(e)?a.push(e):h=h.then(function(){return r.Al(e),r.nu.Oh(e,!0)}),r.nl.vu(e)}),[4,h]);case 4:return t.sent(),[4,Nf(r,a)];case 5:return t.sent(),(n=r).cl.forEach(function(t,e){n.nl.vu(e)}),n.ll.Hh(),n.cl=new Map,n.ul=new xi(ri.P),r.wl=!1,[4,r.nl.ju(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.z_.Du,e)];case 1:return t.sent(),this.U_&&(e&&!this.U_.tr?this.U_.start(this.nu):e||this.U_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},pl.prototype.q_=function(t){if(t.G_.K_&&t.G_.synchronizeTabs){var e=Ua();if(!ff.Fs(e))throw new Yr(Qr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=gc(t.b_.s,t.b_.persistenceKey);return new ff(e,t.ti,n,t.clientId,t.j_)}return new lf},pl),fl=(ll.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.nu?[3,3]:(this.nu=n.nu,this.sl=n.sl,this.su=this.H_(r),this.nl=this.Y_(r),this.Du=this.J_(r),this.X_=this.Z_(r),this.sl.Ga=function(t){return e.Du.Jc(t,1)},this.nl.Du=this.Du,[4,this.nl.start()]);case 1:return t.sent(),[4,this.nl.ju(this.Du.Tl)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ll.prototype.Z_=function(t){return new Sf(this.Du)},ll.prototype.H_=function(t){var e,n=ol(t.b_.s),r=(e=t.b_,new Hf(e)),i=t.credentials;return new Fc(i,r,n)},ll.prototype.Y_=function(t){var e=this;return new qc(this.nu,this.su,t.ti,function(t){return e.Du.Jc(t,0)},new(Wf.Fs()?Wf:Qf))},ll.prototype.J_=function(t){return e=this.nu,n=this.nl,r=this.su,i=this.sl,o=t.j_,s=t.il,u=!t.G_.K_||!t.G_.synchronizeTabs,a=new df(e,n,r,i,o,s),u&&(a.wl=!0),a;var e,n,r,i,o,s,u,a},ll.prototype.terminate=function(){return this.nl.th()},ll);function ll(){}function pl(t){var e=this;return(e=sl.call(this)||this).z_=t,e}function dl(){return null!==ul&&ul.apply(this,arguments)||this}function yl(){}function vl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var gl=(ml.prototype.next=function(t){this.observer.next&&this.tf(this.observer.next,t)},ml.prototype.error=function(t){this.observer.error?this.tf(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ml.prototype.ef=function(){this.muted=!0},ml.prototype.tf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ml);function ml(t){this.observer=t,this.muted=!1}function wl(t,e){if(0!==e.length)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Vl(e.length,"argument")+".")}function bl(t,e,n){if(e.length!==n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires "+Vl(n,"argument")+", but was called with "+Vl(e.length,"argument")+".")}function El(t,e,n){if(e.length<n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Vl(n,"argument")+", but was called with "+Vl(e.length,"argument")+".")}function Il(t,e,n,r){if(e.length<n||e.length>r)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Vl(e.length,"argument")+".")}function Tl(t,e,n,r){xl(t,e,Ul(n)+" argument",r)}function Nl(t,e,n,r){void 0!==r&&Tl(t,e,n,r)}function Al(t,e,n,r){xl(t,e,n+" option",r)}function _l(t,e,n,r){void 0!==r&&Al(t,e,n,r)}function Dl(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Ol(s))}var u=Ol(n);throw new Yr(Qr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Sl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid value "+Ol(r)+" provided to function "+t+"() for its "+Ul(n)+" argument. Acceptable values: "+e.join(", "));return r}function xl(t,e,n,r){if(!("object"===e?kl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Ol(r);throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function kl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ol(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Pl(t,e,n){if(void 0===n)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ul(e)+" argument, but it was undefined.")}function Ll(n,t,r){Br(t,function(t,e){if(r.indexOf(t)<0)throw new Yr(Qr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Rl(t,e,n,r){var i=Ol(r);return new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ul(n)+" argument to be a "+e+", but it was: "+i)}function Cl(t,e,n){if(n<=0)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ul(e)+" argument to be a positive number, but it was: "+n+".")}function Ul(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Vl(t,e){return t+" "+e+(1===t?"":"s")}function Ml(){if("undefined"==typeof Uint8Array)throw new Yr(Qr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Fl(){if("undefined"==typeof atob)throw new Yr(Qr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var jl,ql,Gl=(Yl.fromBase64String=function(t){bl("Blob.fromBase64String",arguments,1),Tl("Blob.fromBase64String","string",1,t),Fl();try{return new Yl(bi.fromBase64String(t))}catch(t){throw new Yr(Qr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Yl.fromUint8Array=function(t){if(bl("Blob.fromUint8Array",arguments,1),Ml(),!(t instanceof Uint8Array))throw Rl("Blob.fromUint8Array","Uint8Array",1,t);return new Yl(bi.fromUint8Array(t))},Yl.prototype.toBase64=function(){return bl("Blob.toBase64",arguments,0),Fl(),this.nf.toBase64()},Yl.prototype.toUint8Array=function(){return bl("Blob.toUint8Array",arguments,0),Ml(),this.nf.toUint8Array()},Yl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yl.prototype.isEqual=function(t){return this.nf.isEqual(t.nf)},Yl),Bl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Yr(Qr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Tl("FieldPath","string",e,t[e]),0===t[e].length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.sf=new ni(t)},zl=(n(Ql,ql=Bl),Ql.documentId=function(){return new Ql(ni.L().F())},Ql.prototype.isEqual=function(t){if(!(t instanceof Ql))throw Rl("isEqual","FieldPath",1,t);return this.sf.isEqual(t.sf)},Ql),Kl=new RegExp("[~\\*/\\[\\]]"),Xl=function(){this.if=this},Hl=(n(Wl,jl=Xl),Wl.prototype.hf=function(t){if(2!==t.af)throw 1===t.af?t.uf(this.rf+"() can only appear at the top level of your update data"):t.uf(this.rf+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},Wl.prototype.isEqual=function(t){return t instanceof Wl},Wl);function Wl(t){var e=this;return(e=jl.call(this)||this).rf=t,e}function Ql(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ql.call(this,t)||this}function Yl(t){Fl(),this.nf=t}function Jl(t,e,n){return new Ap({af:3,cf:e.settings.cf,methodName:t.rf,lf:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var $l,Zl,tp,ep,np,rp,ip=(n(Tp,rp=Xl),Tp.prototype.hf=function(t){return new Is(t.path,new us)},Tp.prototype.isEqual=function(t){return t instanceof Tp},Tp),op=(n(Ip,np=Xl),Ip.prototype.hf=function(t){var e=Jl(this,t,!0),n=this._f.map(function(t){return Lp(t,e)}),r=new as(n);return new Is(t.path,r)},Ip.prototype.isEqual=function(t){return this===t},Ip),sp=(n(Ep,ep=Xl),Ep.prototype.hf=function(t){var e=Jl(this,t,!0),n=this._f.map(function(t){return Lp(t,e)}),r=new ps(n);return new Is(t.path,r)},Ep.prototype.isEqual=function(t){return this===t},Ep),up=(n(bp,tp=Xl),bp.prototype.hf=function(t){var e=new gs(t.serializer,Co(t.serializer,this.ff));return new Is(t.path,e)},bp.prototype.isEqual=function(t){return this===t},bp),ap=(n(wp,Zl=Xl),wp.delete=function(){return wl("FieldValue.delete",arguments),new hp(new Hl("FieldValue.delete"))},wp.serverTimestamp=function(){return wl("FieldValue.serverTimestamp",arguments),new hp(new ip("FieldValue.serverTimestamp"))},wp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return El("FieldValue.arrayUnion",arguments,1),new hp(new op("FieldValue.arrayUnion",t))},wp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return El("FieldValue.arrayRemove",arguments,1),new hp(new sp("FieldValue.arrayRemove",t))},wp.increment=function(t){return Tl("FieldValue.increment","number",1,t),bl("FieldValue.increment",arguments,1),new hp(new up("FieldValue.increment",t))},wp),hp=(n(mp,$l=ap),mp.prototype.hf=function(t){return this.if.hf(t)},mp.prototype.isEqual=function(t){return t instanceof mp&&this.if.isEqual(t.if)},mp),cp=(Object.defineProperty(gp.prototype,"latitude",{get:function(){return this.df},enumerable:!1,configurable:!0}),Object.defineProperty(gp.prototype,"longitude",{get:function(){return this.wf},enumerable:!1,configurable:!0}),gp.prototype.isEqual=function(t){return this.df===t.df&&this.wf===t.wf},gp.prototype.T=function(t){return Ur(this.df,t.df)||Ur(this.wf,t.wf)},gp),fp=/^__.*__$/,lp=function(t,e,n){this.Tf=t,this.Ef=e,this.If=n},pp=(vp.prototype.mf=function(t,e){var n=[];return null!==this.Le?n.push(new Cs(t,this.data,this.Le,e)):n.push(new Rs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new js(t,this.fieldTransforms)),n},vp),dp=(yp.prototype.mf=function(t,e){var n=[new Cs(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new js(t,this.fieldTransforms)),n},yp);function yp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function vp(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function gp(t,e){if(bl("GeoPoint",arguments,2),Tl("GeoPoint","number",1,t),Tl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Yr(Qr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Yr(Qr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.df=t,this.wf=e}function mp(t){var e=this;return(e=$l.call(this)||this).if=t,e.rf=t.rf,e}function wp(){return Zl.call(this)||this}function bp(t,e){var n=this;return(n=tp.call(this)||this).rf=t,n.ff=e,n}function Ep(t,e){var n=this;return(n=ep.call(this)||this).rf=t,n._f=e,n}function Ip(t,e){var n=this;return(n=np.call(this)||this).rf=t,n._f=e,n}function Tp(t){var e=this;return(e=rp.call(this)||this).rf=t,e}function Np(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Ap=(Object.defineProperty(Sp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"af",{get:function(){return this.settings.af},enumerable:!1,configurable:!0}),Sp.prototype.Rf=function(t){return new Sp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Sp.prototype.Pf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Vf(t),r},Sp.prototype.gf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rf({path:n,lf:!1});return r.Af(),r},Sp.prototype.yf=function(t){return this.Rf({path:void 0,lf:!0})},Sp.prototype.uf=function(t){return Fp(t,this.settings.methodName,this.settings.pf||!1,this.path,this.settings.cf)},Sp.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Sp.prototype.Af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Vf(this.path.get(t))},Sp.prototype.Vf=function(t){if(0===t.length)throw this.uf("Document fields must not be empty");if(Np(this.af)&&fp.test(t))throw this.uf('Document fields cannot begin and end with "__"')},Sp),_p=(Dp.prototype.bf=function(t,e,n,r){return void 0===r&&(r=!1),new Ap({af:t,methodName:e,cf:n,path:ni.$(),lf:!1,pf:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Dp);function Dp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||ol(t)}function Sp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Af(),this.fieldTransforms=i||[],this.Le=o||[]}function xp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.bf(o.merge||o.mergeFields?2:0,e,n,i);Up("Data must be an object, but it was:",s,r);var u,a,h=Rp(r,s);if(o.merge)u=new Es(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Bl)d=p.sf;else{if("string"!=typeof p)throw Pr();d=Mp(e,p,n)}if(!s.contains(d))throw new Yr(Qr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");jp(c,d)||c.push(d)}u=new Es(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new pp(new Hs(h),u,a)}function kp(t,o,s,e){var u=t.bf(1,o,s);Up("Data must be an object, but it was:",u,e);var a=[],h=new Ws;Br(e,function(t,e){var n,r=Mp(o,t,s),i=u.gf(r);e instanceof Xl&&e.if instanceof Hl?a.push(r):null!=(n=Lp(e,i))&&(a.push(r),h.set(r,n))});var n=new Es(a);return new dp(h.Ge(),n,u.fieldTransforms)}function Op(t,e,n,r,i,o){var s=t.bf(1,e,n),u=[Vp(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(Qr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Vp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Ws,v=u.length-1;0<=v;--v)jp(d,u[v])||(c=u[v],f=a[v],l=s.gf(c),f instanceof Xl&&f.if instanceof Hl?d.push(c):null!=(p=Lp(f,l))&&(d.push(c),y.set(c,p)));var g=new Es(d);return new dp(y.Ge(),g,s.fieldTransforms)}function Pp(t,e,n,r){return void 0===r&&(r=!1),Lp(n,t.bf(r?4:3,e))}function Lp(s,t){if(Cp(s))return Up("Unsupported field value:",t,s),Rp(s,t);if(s instanceof Xl)return function(t,e){if(!Np(e.af))throw e.uf(t.rf+"() can only be used with update() and set()");if(!e.path)throw e.uf(t.rf+"() is not currently supported inside arrays");var n=t.hf(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.lf&&4!==t.af)throw t.uf("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Lp(i[r],t.yf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Jr.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof Jr){var r=new Jr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof cp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gl)return{bytesValue:Vo(e.serializer,t)};if(t instanceof lp){var i=e.s,o=t.Tf;if(!o.isEqual(i))throw e.uf("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Fo(t.Tf||e.s,t.Ef.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.uf("Unsupported field value: "+Ol(t))}(s,t)}function Rp(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Br(t,function(t,e){var n=Lp(e,r.Pf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Cp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Jr||t instanceof cp||t instanceof Gl||t instanceof lp||t instanceof Xl)}function Up(t,e,n){if(!Cp(n)||!kl(n)){var r=Ol(n);throw"an object"===r?e.uf(t+" a custom object"):e.uf(t+" "+r)}}function Vp(t,e,n){if(e instanceof Bl)return e.sf;if("string"==typeof e)return Mp(t,e);throw Fp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Mp(t,e,n){try{return function(e){if(0<=e.search(Kl))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(zl.bind.apply(zl,i([void 0],e.split("."))))}catch(t){throw new Yr(Qr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).sf}catch(e){throw Fp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Fp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Yr(Qr.INVALID_ARGUMENT,(u+=". ")+t+a)}function jp(t,e){return t.some(function(t){return t.isEqual(e)})}var qp=(Xp.prototype.Nf=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),0<this.mutations.length)throw new Yr(Qr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ko((i=u).serializer)+"/documents",n={documents:a.map(function(t){return qo(i.serializer,t)})},[4,i.Ka("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),r=Mo(e.found.updateTime),i=new Hs({mapValue:{fields:e.found.fields}});return new ru(n,r,i,{})}(e,n):"missing"in n?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);var n=Go(t,e.missing),r=Mo(e.readTime);return new iu(n,r)}(e,n):Pr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Lr(!!e),s.push(e)}),s)]}})})}(this.su,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof iu||t instanceof ru?n.kf(t):Pr()}),e)]}})})},Xp.prototype.set=function(t,e){this.write(e.mf(t,this.Ue(t))),this.Cf.add(t)},Xp.prototype.update=function(t,e){try{this.write(e.mf(t,this.xf(t)))}catch(t){this.Df=t}this.Cf.add(t)},Xp.prototype.delete=function(t){this.write([new Ks(t,this.Ue(t))]),this.Cf.add(t)},Xp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ff(),this.Df)throw this.Df;return e=this.vf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ri(ti.k(e));r.mutations.push(new Xs(n,r.Ue(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ko((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Wo(e.serializer,t)})},[4,e.ja("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.su,this.mutations)];case 1:return t.sent(),this.Sf=!0,[2]}})})},Xp.prototype.kf=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw Pr();e=$r.min()}var n=this.vf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Qr.ABORTED,"Document version changed between two reads.")}else this.vf.set(t.key.toString(),e)},Xp.prototype.Ue=function(t){var e=this.vf.get(t.toString());return!this.Cf.has(t)&&e?As.updateTime(e):As.Qe()},Xp.prototype.xf=function(t){var e=this.vf.get(t.toString());if(this.Cf.has(t)||!e)return As.exists(!0);if(e.isEqual($r.min()))throw new Yr(Qr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},Xp.prototype.write=function(t){this.Ff(),this.mutations=this.mutations.concat(t)},Xp.prototype.Ff=function(){},Xp),Gp=(Kp.prototype.run=function(){this.Mf()},Kp.prototype.Mf=function(){var t=this;this.wi.ps(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new qp(this.su),(n=this.Of(e))&&n.then(function(t){r.ti.hi(function(){return e.commit().then(function(){r.si.resolve(t)}).catch(function(t){r.Lf(t)})})}).catch(function(t){r.Lf(t)}),[2]})})})},Kp.prototype.Of=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.si.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.si.reject(t),null}},Kp.prototype.Lf=function(t){var e=this;0<this.$f&&this.qf(t)?(--this.$f,this.ti.hi(function(){return e.Mf(),Promise.resolve()})):this.si.reject(t)},Kp.prototype.qf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Di(e)},Kp),Bp=(zp.prototype.start=function(t,e,n,r){var i=this;this.Uf(),this.b_=t;var o=new ma,s=!1;return this.credentials.ia(function(t){return s?void i.ti.Vi(function(){return i.nl.Wu(t)}):(s=!0,Sr("FirestoreClient","Initializing. user=",t.uid),i.Qf(e,n,r,t,o).then(i.Bf.resolve,i.Bf.reject))}),this.ti.hi(function(){return i.Bf.promise}),o.promise},zp.prototype.enableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!0),t.nl.enableNetwork()})},zp.prototype.Qf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ti:this.ti,b_:this.b_,clientId:this.clientId,credentials:this.credentials,j_:u,il:100,G_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.sl=i.sl,this.nu=i.nu,this.U_=i.U_,this.su=o.su,this.nl=o.nl,this.Du=o.Du,this.Wf=o.X_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.jf(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Qf(new hl,new fl,{K_:!1},u,a))];case 4:return[2]}})})},zp.prototype.jf=function(t){return"FirebaseError"===t.name?t.code===Qr.FAILED_PRECONDITION||t.code===Qr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},zp.prototype.Uf=function(){if(this.ti.Ei)throw new Yr(Qr.FAILED_PRECONDITION,"The client has already been terminated.")},zp.prototype.disableNetwork=function(){var t=this;return this.Uf(),this.ti.enqueue(function(){return t.persistence.Uo(!1),t.nl.disableNetwork()})},zp.prototype.terminate=function(){var t=this;return this.ti.Pi(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.U_&&this.U_.stop(),[4,this.nl.th()];case 1:return t.sent(),[4,this.sl.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.ra(),[2]}})})})},zp.prototype.waitForPendingWrites=function(){var t=this;this.Uf();var e=new ma;return this.ti.hi(function(){return t.Du.bl(e)}),e.promise},zp.prototype.listen=function(t,e,n){var r=this;this.Uf();var i=new gl(n),o=new xf(t,i,e);return this.ti.hi(function(){return r.Wf.listen(o)}),function(){i.ef(),r.ti.hi(function(){return r.Wf.vu(o)})}},zp.prototype.Kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,o,s){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return i=new ma,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o.$h(s)];case 1:return(e=t.sent())instanceof ru?i.resolve(e):e instanceof iu?i.resolve(null):i.reject(new Yr(Qr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Ga(n,"Failed to get document '"+s+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})}(this.ti,this.nu,e))]}})})},zp.prototype.Gf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new ma,s=Hp(e,n,pu(r.path),{includeMetadataChanges:!0,Gl:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Yr(Qr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Qr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},zp.prototype.zf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new ma,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,a.Lh(h,!0)];case 1:return e=t.sent(),n=new pf(h,e.qh),r=n.Wc(e.documents),i=n.Bn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ga(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ti,this.nu,e))]}})})},zp.prototype.Hf=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uf(),[4,this.Bf.promise];case 1:return[2,(t.sent(),e=this.ti,n=this.Wf,r=u,i=a,o=new ma,s=Hp(e,n,r,{includeMetadataChanges:!0,Gl:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Yr(Qr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},zp.prototype.write=function(t){var e=this;this.Uf();var n=new ma;return this.ti.hi(function(){return e.Du.write(t,n)}),n.promise},zp.prototype.s=function(){return this.b_.s},zp.prototype.Ll=function(t){var e=this;this.Uf();var n=new gl(t);return this.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.Ll(n)]})})}),function(){n.ef(),e.ti.hi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Wf.ql(n)]})})})}},Object.defineProperty(zp.prototype,"Yf",{get:function(){return this.ti.Ei},enumerable:!1,configurable:!0}),zp.prototype.transaction=function(t){var e=this;this.Uf();var n=new ma;return this.ti.hi(function(){return new Gp(e.ti,e.su,t,n).run(),Promise.resolve()}),n.promise},zp);function zp(t,e){this.credentials=t,this.ti=e,this.clientId=Rr.t(),this.Bf=new ma}function Kp(t,e,n,r){this.ti=t,this.su=e,this.updateFunction=n,this.si=r,this.$f=5,this.wi=new ba(this.ti,"transaction_retry")}function Xp(t){this.su=t,this.vf=new Map,this.mutations=[],this.Sf=!1,this.Df=null,this.Cf=new Set}function Hp(t,e,n,r,i){var o=new gl(i),s=new xf(n,o,r);return t.hi(function(){return e.listen(s)}),function(){o.ef(),t.hi(function(){return e.vu(s)})}}var Wp,Qp,Yp=(dd.prototype.Zf=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.td(t.timestampValue);case 4:return this.ed(t);case 5:return t.stringValue;case 6:return new Gl(To(t.bytesValue));case 7:return this.nd(t.referenceValue);case 8:return this.sd(t.geoPointValue);case 9:return this.rd(t.arrayValue);case 10:return this.od(t.mapValue);default:throw Pr()}},dd.prototype.od=function(t){var n=this,r={};return Br(t.fields||{},function(t,e){r[t]=n.Zf(e)}),r},dd.prototype.sd=function(t){return new cp(Io(t.latitude),Io(t.longitude))},dd.prototype.rd=function(t){var e=this;return(t.values||[]).map(function(t){return e.Zf(t)})},dd.prototype.ed=function(t){switch(this.Jf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return fo(n)?t(n):n}(t);return null==e?null:this.Zf(e);case"estimate":return this.td(lo(t));default:return null}},dd.prototype.td=function(t){var e=Eo(t),n=new Jr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},dd.prototype.nd=function(t){var e=ti.k(t);Lr(ns(e));var n=new jr(e.get(1),e.get(3)),r=new ri(e.g(5));return n.isEqual(this.s)||xr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Xf(r)},dd),Jp=Xa.ji,$p=(pd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},pd),Zp=(Object.defineProperty(ld.prototype,"Id",{get:function(){return this.md||(this.md=new _p(this.Tf,this.Ed.ignoreUndefinedProperties)),this.md},enumerable:!1,configurable:!0}),ld.prototype.settings=function(t){bl("Firestore.settings",arguments,1),Tl("Firestore.settings","object",1,t);var e=new $p(t);if(this.fd&&!this.Ed.isEqual(e))throw new Yr(Qr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ed=e).credentials&&(this.Td=function(t){if(!t)return new Pc;switch(t.type){case"gapi":var e=t.Ad;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Cc(e,t.la||"0");case"provider":return t.Ad;default:throw new Yr(Qr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},ld.prototype.enableNetwork=function(){return this._d(),this.fd.enableNetwork()},ld.prototype.disableNetwork=function(){return this._d(),this.fd.disableNetwork()},ld.prototype.enablePersistence=function(t){var e,n;if(this.fd)throw new Yr(Qr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Yr(Qr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Rd(this.hd,this.ad,{K_:!0,cacheSizeBytes:this.Ed.cacheSizeBytes,synchronizeTabs:r,Vo:i})},ld.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.fd&&!this.fd.Yf)throw new Yr(Qr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ma,[2,(this.ld.Ii(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.Tf,this.wd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},ld.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(ld.prototype,"Pd",{get:function(){return this._d(),this.fd.Yf},enumerable:!1,configurable:!0}),ld.prototype.waitForPendingWrites=function(){return this._d(),this.fd.waitForPendingWrites()},ld.prototype.onSnapshotsInSync=function(t){if(this._d(),vl(t))return this.fd.Ll(t);Tl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.fd.Ll(e)},ld.prototype._d=function(){return this.fd||this.Rd(new hl,new fl,{K_:!1}),this.fd},ld.prototype.Vd=function(){return new Fr(this.Tf,this.wd,this.Ed.host,this.Ed.ssl,this.Ed.forceLongPolling)},ld.prototype.Rd=function(t,e,n){var r=this.Vd();return this.fd=new Bp(this.Td,this.ld),this.fd.start(r,t,e,n)},ld.dd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Yr(Qr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Yr(Qr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new jr(n)},Object.defineProperty(ld.prototype,"app",{get:function(){if(!this.ud)throw new Yr(Qr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ud},enumerable:!1,configurable:!0}),ld.prototype.collection=function(t){return bl("Firestore.collection",arguments,1),Tl("Firestore.collection","non-empty string",1,t),this._d(),new Id(ti.k(t),this,null)},ld.prototype.doc=function(t){return bl("Firestore.doc",arguments,1),Tl("Firestore.doc","non-empty string",1,t),this._d(),nd.gd(ti.k(t),this,null)},ld.prototype.collectionGroup=function(t){if(bl("Firestore.collectionGroup",arguments,1),Tl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._d(),new bd((e=t,new cu(ti.$(),e)),this,null);var e},ld.prototype.runTransaction=function(e){var n=this;return bl("Firestore.runTransaction",arguments,1),Tl("Firestore.runTransaction","function",1,e),this._d().transaction(function(t){return e(new td(n,t))})},ld.prototype.batch=function(){return this._d(),new ed(this)},Object.defineProperty(ld,"logLevel",{get:function(){switch(Dr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),ld.setLogLevel=function(t){bl("Firestore.setLogLevel",arguments,1),Sl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_r.setLogLevel(t)},ld.prototype.yd=function(){return this.Ed.timestampsInSnapshots},ld),td=(fd.prototype.get=function(t){var n=this;bl("Transaction.get",arguments,1);var r=xd("Transaction.get",t,this.pd);return this.bd.Nf([r.Ef]).then(function(t){if(!t||1!==t.length)return Pr();var e=t[0];if(e instanceof iu)return new id(n.pd,r.Ef,null,!1,!1,r.If);if(e instanceof ru)return new id(n.pd,r.Ef,e,!1,!1,r.If);throw Pr()})},fd.prototype.set=function(t,e,n){Il("Transaction.set",arguments,2,3);var r=xd("Transaction.set",t,this.pd);n=_d("Transaction.set",n);var i=kd(r.If,e,n),o=xp(this.pd.Id,"Transaction.set",r.Ef,i,null!==r.If,n);return this.bd.set(r.Ef,o),this},fd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof zl?(El("Transaction.update",arguments,3),r=xd("Transaction.update",t,this.pd),Op(this.pd.Id,"Transaction.update",r.Ef,e,n,o)):(bl("Transaction.update",arguments,2),r=xd("Transaction.update",t,this.pd),kp(this.pd.Id,"Transaction.update",r.Ef,e)),this.bd.update(r.Ef,i),this},fd.prototype.delete=function(t){bl("Transaction.delete",arguments,1);var e=xd("Transaction.delete",t,this.pd);return this.bd.delete(e.Ef),this},fd),ed=(cd.prototype.set=function(t,e,n){Il("WriteBatch.set",arguments,2,3),this.Dd();var r=xd("WriteBatch.set",t,this.pd);n=_d("WriteBatch.set",n);var i=kd(r.If,e,n),o=xp(this.pd.Id,"WriteBatch.set",r.Ef,i,null!==r.If,n);return this.vd=this.vd.concat(o.mf(r.Ef,As.Qe())),this},cd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Dd(),i="string"==typeof e||e instanceof zl?(El("WriteBatch.update",arguments,3),r=xd("WriteBatch.update",t,this.pd),Op(this.pd.Id,"WriteBatch.update",r.Ef,e,n,o)):(bl("WriteBatch.update",arguments,2),r=xd("WriteBatch.update",t,this.pd),kp(this.pd.Id,"WriteBatch.update",r.Ef,e)),this.vd=this.vd.concat(i.mf(r.Ef,As.exists(!0))),this},cd.prototype.delete=function(t){bl("WriteBatch.delete",arguments,1),this.Dd();var e=xd("WriteBatch.delete",t,this.pd);return this.vd=this.vd.concat(new Ks(e.Ef,As.Qe())),this},cd.prototype.commit=function(){return this.Dd(),this.Sd=!0,0<this.vd.length?this.pd._d().write(this.vd):Promise.resolve()},cd.prototype.Dd=function(){if(this.Sd)throw new Yr(Qr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},cd),nd=(n(hd,Qp=lp),hd.gd=function(t,e,n){if(t.length%2!=0)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new hd(new ri(t),e,n)},Object.defineProperty(hd.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"parent",{get:function(){return new Id(this.Ef.path.p(),this.firestore,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"path",{get:function(){return this.Ef.path.F()},enumerable:!1,configurable:!0}),hd.prototype.collection=function(t){if(bl("DocumentReference.collection",arguments,1),Tl("DocumentReference.collection","non-empty string",1,t),!t)throw new Yr(Qr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ti.k(t);return new Id(this.Ef.path.child(e),this.firestore,null)},hd.prototype.isEqual=function(t){if(!(t instanceof hd))throw Rl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ef.isEqual(t.Ef)&&this.If===t.If},hd.prototype.set=function(t,e){Il("DocumentReference.set",arguments,1,2),e=_d("DocumentReference.set",e);var n=kd(this.If,t,e),r=xp(this.firestore.Id,"DocumentReference.set",this.Ef,n,null!==this.If,e);return this.fd.write(r.mf(this.Ef,As.Qe()))},hd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof zl?(El("DocumentReference.update",arguments,2),Op(this.firestore.Id,"DocumentReference.update",this.Ef,t,e,r)):(bl("DocumentReference.update",arguments,1),kp(this.firestore.Id,"DocumentReference.update",this.Ef,t)),this.fd.write(n.mf(this.Ef,As.exists(!0)))},hd.prototype.delete=function(){return bl("DocumentReference.delete",arguments,0),this.fd.write([new Ks(this.Ef,As.Qe())])},hd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Il("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||vl(i[u])||(Ll("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),_l("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};vl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Tl("DocumentReference.onSnapshot","function",u,i[u]),Nl("DocumentReference.onSnapshot","function",u+1,i[u+1]),Nl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Cd(t))},error:i[u+1],complete:i[u+2]};return this.fd.listen(pu(this.Ef.path),h,c)},hd.prototype.get=function(t){var e=this;Il("DocumentReference.get",arguments,0,1),Sd("DocumentReference.get",t);var n=this.firestore._d();return t&&"cache"===t.source?n.Kf(this.Ef).then(function(t){return new id(e.firestore,e.Ef,t,!0,t instanceof ru&&t.Ke,e.If)}):n.Gf(this.Ef,t).then(function(t){return e.Cd(t)})},hd.prototype.withConverter=function(t){return new hd(this.Ef,this.firestore,t)},hd.prototype.Cd=function(t){var e=t.docs.get(this.Ef);return new id(this.firestore,this.Ef,e,t.fromCache,t.hasPendingWrites,this.If)},hd),rd=(ad.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ad),id=(ud.prototype.data=function(t){var e=this;if(Il("DocumentSnapshot.data",arguments,0,1),t=Dd("DocumentSnapshot.data",t),this.Nd){if(this.If){var n=new od(this.pd,this.Ef,this.Nd,this.Fd,this.kd,null);return this.If.fromFirestore(n,t)}return new Yp(this.pd.Tf,this.pd.yd(),t.serverTimestamps||"none",function(t){return new nd(t,e.pd,null)}).Zf(this.Nd.Ze())}},ud.prototype.get=function(t,e){var n=this;if(Il("DocumentSnapshot.get",arguments,1,2),e=Dd("DocumentSnapshot.get",e),this.Nd){var r=this.Nd.data().field(Vp("DocumentSnapshot.get",t,this.Ef));if(null!==r)return new Yp(this.pd.Tf,this.pd.yd(),e.serverTimestamps||"none",function(t){return new nd(t,n.pd,n.If)}).Zf(r)}},Object.defineProperty(ud.prototype,"id",{get:function(){return this.Ef.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"ref",{get:function(){return new nd(this.Ef,this.pd,this.If)},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"exists",{get:function(){return null!==this.Nd},enumerable:!1,configurable:!0}),Object.defineProperty(ud.prototype,"metadata",{get:function(){return new rd(this.kd,this.Fd)},enumerable:!1,configurable:!0}),ud.prototype.isEqual=function(t){if(!(t instanceof ud))throw Rl("isEqual","DocumentSnapshot",1,t);return this.pd===t.pd&&this.Fd===t.Fd&&this.Ef.isEqual(t.Ef)&&(null===this.Nd?null===t.Nd:this.Nd.isEqual(t.Nd))&&this.If===t.If},ud),od=(n(sd,Wp=id),sd.prototype.data=function(t){return Wp.prototype.data.call(this,t)},sd);function sd(){return null!==Wp&&Wp.apply(this,arguments)||this}function ud(t,e,n,r,i,o){this.pd=t,this.Ef=e,this.Nd=n,this.Fd=r,this.kd=i,this.If=o}function ad(t,e){this.hasPendingWrites=t,this.fromCache=e}function hd(t,e,n){var r=this;return(r=Qp.call(this,e.Tf,t,n)||this).Ef=t,r.firestore=e,r.If=n,r.fd=r.firestore._d(),r}function cd(t){this.pd=t,this.vd=[],this.Sd=!1}function fd(t,e){this.pd=t,this.bd=e}function ld(t,e,n,r){var i=this;if(void 0===n&&(n=new hl),void 0===r&&(r=new fl),this.hd=n,this.ad=r,this.ud=null,this.ld=new Fa,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this._d(),[4,this.fd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.ud=o,this.Tf=ld.dd(o),this.wd=o.name,this.Td=new Lc(e)}else{var s=t;if(!s.projectId)throw new Yr(Qr.INVALID_ARGUMENT,"Must provide projectId");this.Tf=new jr(s.projectId,s.database),this.wd="[DEFAULT]",this.Td=new Pc}this.Ed=new $p({})}function pd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Qr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Al("settings","non-empty string","host",t.host),this.host=t.host,_l("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ll("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),_l("settings","object","credentials",t.credentials),this.credentials=t.credentials,_l("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),_l("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,_l("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Xa.Gi;else{if(t.cacheSizeBytes!==Jp&&t.cacheSizeBytes<Xa.Ki)throw new Yr(Qr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Xa.Ki);this.cacheSizeBytes=t.cacheSizeBytes}_l("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function dd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Jf=n,this.Xf=r}function yd(t,e,n){if("string"==typeof n){if(""===n)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ti.k(n));if(!ri.W(r))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return No(t,new ri(r))}if(n instanceof lp)return No(t,n.Ef);throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ol(n)+".")}function vd(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function gd(t,e,n){if(!n.isEqual(e))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function md(t){if(t.an()&&0===t.tn.length)throw new Yr(Qr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var wd,bd=(Ad.prototype.where=function(t,e,n){var r;bl("Query.where",arguments,3),Pl("Query.where",3,n),r="not-in"===e||"!="===e?e:Sl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Vp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.O()){if("array-contains"===i||"array-contains-any"===i)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){vd(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(yd(n,t,c))}s={arrayValue:{values:u}}}else s=yd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||vd(o,i),s=Pp(e,"Query.where",o,"in"===i||"not-in"===i);var f=_u.create(r,i,s);return function(t,e){if(e.ln()){var n=t.cn();if(null!==n&&!n.isEqual(e.field))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.un();null!==r&&gd(0,e.field,r)}var i=t._n(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.xd,this.firestore.Id,this.firestore.Tf,s,r,n);return new Ad((o=(i=this.xd).filters.concat([u]),new cu(i.path,i.collectionGroup,i.tn.slice(),o,i.limit,i.en,i.startAt,i.endAt)),this.firestore,this.If)},Ad.prototype.orderBy=function(t,e){var n;if(Il("Query.orderBy",arguments,1,2),Nl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Yr(Qr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Vp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new ta(e,n),s=o;return null!==(r=t).un()||null!==(i=r.cn())&&gd(0,i,s.field),o}(this.xd,o,n);return new Ad((i=(r=this.xd).tn.concat([s]),new cu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.If)},Ad.prototype.limit=function(t){return bl("Query.limit",arguments,1),Tl("Query.limit","number",1,t),Cl("Query.limit",1,t),new Ad(gu(this.xd,t,"F"),this.firestore,this.If)},Ad.prototype.limitToLast=function(t){return bl("Query.limitToLast",arguments,1),Tl("Query.limitToLast","number",1,t),Cl("Query.limitToLast",1,t),new Ad(gu(this.xd,t,"L"),this.firestore,this.If)},Ad.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];El("Query.startAt",arguments,1);var r=this.$d("Query.startAt",t,e,!0);return new Ad(mu(this.xd,r),this.firestore,this.If)},Ad.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];El("Query.startAfter",arguments,1);var r=this.$d("Query.startAfter",t,e,!1);return new Ad(mu(this.xd,r),this.firestore,this.If)},Ad.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];El("Query.endBefore",arguments,1);var r=this.$d("Query.endBefore",t,e,!0);return new Ad(wu(this.xd,r),this.firestore,this.If)},Ad.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];El("Query.endAt",arguments,1);var r=this.$d("Query.endAt",t,e,!1);return new Ad(wu(this.xd,r),this.firestore,this.If)},Ad.prototype.isEqual=function(t){if(!(t instanceof Ad))throw Rl("isEqual","Query",1,t);return this.firestore===t.firestore&&bu(this.xd,t.xd)&&this.If===t.If},Ad.prototype.withConverter=function(t){return new Ad(this.xd,this.firestore,t)},Ad.prototype.$d=function(c,t,e,n){if(Pl(c,1,t),t instanceof id)return bl(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Yr(Qr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.O())i.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Yr(Qr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.F();throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(this.xd,this.firestore.Tf,t.Nd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Yr(Qr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.O()){if("string"!=typeof h)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!du(t)&&-1!==h.indexOf("/"))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ti.k(h));if(!ri.W(c))throw new Yr(Qr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new ri(c);u.push(No(e,f))}else{var l=Pp(n,r,h);u.push(l)}}return new Xu(u,o)}(this.xd,this.firestore.Tf,this.firestore.Id,c,r,n)},Ad.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Il("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||vl(i[a])||(Ll("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),_l("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),vl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Tl("Query.onSnapshot","function",a,i[a]),Nl("Query.onSnapshot","function",a+1,i[a+1]),Nl("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new Ed(r.firestore,r.xd,t,r.If))},error:i[a+1],complete:i[a+2]};return md(this.xd),this.firestore._d().listen(this.xd,u,h)},Ad.prototype.get=function(t){var e=this;Il("Query.get",arguments,0,1),Sd("Query.get",t),md(this.xd);var n=this.firestore._d();return(t&&"cache"===t.source?n.zf(this.xd):n.Hf(this.xd,t)).then(function(t){return new Ed(e.firestore,e.xd,t,e.If)})},Ad),Ed=(Object.defineProperty(Nd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"empty",{get:function(){return this.Od.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Nd.prototype,"size",{get:function(){return this.Od.docs.size},enumerable:!1,configurable:!0}),Nd.prototype.forEach=function(e,n){var r=this;Il("QuerySnapshot.forEach",arguments,1,2),Tl("QuerySnapshot.forEach","function",1,e),this.Od.docs.forEach(function(t){e.call(n,r.Bd(t,r.metadata.fromCache,r.Od.Lt.has(t.key)))})},Object.defineProperty(Nd.prototype,"query",{get:function(){return new bd(this.Md,this.pd,this.If)},enumerable:!1,configurable:!0}),Nd.prototype.docChanges=function(t){t&&(Ll("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),_l("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Od.Bt)throw new Yr(Qr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ld&&this.qd===e||(this.Ld=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Od,e,this.Bd.bind(this)),this.qd=e),this.Ld},Nd.prototype.isEqual=function(t){if(!(t instanceof Nd))throw Rl("isEqual","QuerySnapshot",1,t);return this.pd===t.pd&&bu(this.Md,t.Md)&&this.Od.isEqual(t.Od)&&this.If===t.If},Nd.prototype.Bd=function(t,e,n){return new od(this.pd,t.key,t,e,n,this.If)},Nd),Id=(n(Td,wd=bd),Object.defineProperty(Td.prototype,"id",{get:function(){return this.xd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"parent",{get:function(){var t=this.xd.path.p();return t._()?null:new nd(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Td.prototype,"path",{get:function(){return this.xd.path.F()},enumerable:!1,configurable:!0}),Td.prototype.doc=function(t){Il("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Rr.t()),Tl("CollectionReference.doc","non-empty string",1,t);var e=ti.k(t);return nd.gd(this.xd.path.child(e),this.firestore,this.If)},Td.prototype.add=function(t){bl("CollectionReference.add",arguments,1),Tl("CollectionReference.add","object",1,this.If?this.If.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Td.prototype.withConverter=function(t){return new Td(this.Ud,this.firestore,t)},Td);function Td(t,e,n){var r=this;if(((r=wd.call(this,pu(t),e,n)||this).Ud=t).length%2!=1)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Nd(t,e,n,r){this.pd=t,this.Md=e,this.Od=n,this.If=r,this.Ld=null,this.qd=null,this.metadata=new rd(n.hasPendingWrites,n.fromCache)}function Ad(t,e,n){this.xd=t,this.firestore=e,this.If=n}function _d(t,e){if(void 0===e)return{merge:!1};if(Ll(t,e,["merge","mergeFields"]),_l(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ol(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof zl))throw new Yr(Qr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Ol(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Qr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Dd(t,e){return void 0===e?{}:(Ll(t,e,["serverTimestamps"]),Dl(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Sd(t,e){Nl(t,"object",1,e),e&&(Ll(t,e,["source"]),Dl(t,0,"source",e.source,["default","server","cache"]))}function xd(t,e,n){if(e instanceof lp){if(e.firestore!==n)throw new Yr(Qr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Rl(t,"DocumentReference",1,e)}function kd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Od,Pd={Firestore:Zp,GeoPoint:cp,Timestamp:Jr,Blob:Gl,Transaction:td,WriteBatch:ed,DocumentReference:nd,DocumentSnapshot:id,Query:bd,QueryDocumentSnapshot:od,QuerySnapshot:Ed,CollectionReference:Id,FieldPath:zl,FieldValue:ap,setLogLevel:Zp.setLogLevel,CACHE_SIZE_UNLIMITED:Jp};(Od=Ld).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new fl,i=new cl(r),new Zp(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Pd))),Od.registerVersion("@firebase/firestore","1.16.4")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});